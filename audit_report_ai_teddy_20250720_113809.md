# 📊 ملخص تقرير الفحص

## الأولويات العالية ⚠️
- مشاكل الأمان
- الكود الميت
- التكرار الزائد

## الأولويات المتوسطة 📋
- جودة التوثيق
- تنسيق الكود
- تعقيد الشفرة

# 🚨 تقرير تدقيق المشروع AI Teddy Bear v5 — 2025-07-20 11:27:54

**مسار المشروع:** `/mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main`

**نظام التشغيل:** `posix`

---

## الكلاسات المكررة
```bash
grep -rh --include='*.py' --exclude-dir=.venv --exclude-dir=venv --exclude-dir=__pycache__ --exclude-dir=build --exclude-dir=dist --exclude-dir=.mypy_cache --exclude-dir=node_modules --exclude-dir=.git '^class ' src | awk '{print $2}' | sort | uniq -d
```

```
ParentConsentRequest(BaseModel):
ValidationSeverity(Enum):

```

**ملخص النتائج:** تم العثور على 2 عنصر مكرر

⏱️ الوقت المستغرق: 3.43 ثانية

⏱️ الوقت المستغرق: 3.43 ثانية


---

## الدوال المكررة
```bash
grep -rh --include='*.py' --exclude-dir=.venv --exclude-dir=venv --exclude-dir=__pycache__ --exclude-dir=build --exclude-dir=dist --exclude-dir=.mypy_cache --exclude-dir=node_modules --exclude-dir=.git '^def ' src | awk '{print $2}' | cut -d'(' -f1 | sort | uniq -d
```

```
create_app
create_security_middleware
get_compliance_validator
validate_child_age

```

**ملخص النتائج:** تم العثور على 4 عنصر مكرر

⏱️ الوقت المستغرق: 4.62 ثانية

⏱️ الوقت المستغرق: 4.62 ثانية


---

## الملفات الفارغة
```bash
find src -type f -empty -not -path './.venv/*' -not -path './venv/*' -not -path './__pycache__/*' -not -path './build/*' -not -path './dist/*' -not -path './.mypy_cache/*' -not -path './node_modules/*' -not -path './.git/*'
```

```
src/api/endpoints/__init__.py
src/api/__init__.py
src/application/application/services/__init__.py
src/application/application/__init__.py
src/application/dto/esp32/__init__.py
src/application/dto/__init__.py
src/application/event_handlers/__init__.py
src/application/interfaces/security/__init__.py
src/application/interfaces/__init__.py
src/application/services/ai/models.py
src/application/services/ai/modules/__init__.py
src/application/services/ai/__init__.py
src/application/services/audio/__init__.py
src/application/use_cases/__init__.py
src/common/exceptions/__init__.py
src/common/utils/__init__.py
src/common/__init__.py
src/domain/entities/New Text Document.txt
src/domain/entities/parent_profile/__init__.py
src/domain/entities/voice_games/__init__.py
src/domain/entities/__init__.py
src/domain/esp32/__init__.py
src/domain/events/__init__.py
src/domain/repositories/__init__.py
src/domain/safety/bias_detector/__init__.py
src/domain/safety/bias_models/__init__.py
src/domain/safety/__init__.py
src/domain/services/__init__.py
src/infrastructure/chaos/actions/__init__.py
src/infrastructure/chaos/infrastructure/__init__.py
src/infrastructure/chaos/monitoring/__init__.py
src/infrastructure/chaos/__init__.py
src/infrastructure/config/__init__.py
src/infrastructure/container/__init__.py
src/infrastructure/database/__init__.py
src/infrastructure/di/__init__.py
src/infrastructure/exception_handling/global_exception_handler/__init__.py
src/infrastructure/exception_handling/__init__.py
src/infrastructure/external_apis/__init__.py
src/infrastructure/external_services/__init__.py
src/infrastructure/messaging/__init__.py
src/infrastructure/persistence/__init__.py
src/infrastructure/read_models/__init__.py
src/infrastructure/repositories/__init__.py
src/infrastructure/session_manager/__init__.py
src/infrastructure/state/__init__.py
src/presentation/api/__init__.py
src/presentation/dependencies/__init__.py
src/presentation/schemas/__init__.py
src/presentation/websocket/__init__.py
src/__init__.py

```

**ملخص النتائج:** تم العثور على 51 نتيجة

⏱️ الوقت المستغرق: 1.75 ثانية

⏱️ الوقت المستغرق: 1.75 ثانية


---

## كود شبه نهائي / TODO
```bash
grep -rIn --include='*.py' --exclude-dir=.venv --exclude-dir=venv --exclude-dir=__pycache__ --exclude-dir=build --exclude-dir=dist --exclude-dir=.mypy_cache --exclude-dir=node_modules --exclude-dir=.git -E 'TODO|HACK|FIXME|PLACEHOLDER' src
```

```
src/application/services/voice_service.py:71:        # TODO: Implement actual audio duration validation if needed. This requires
src/infrastructure/security/rate_limiter_service.py:52:            )  # TODO: Sanitize email

```

**ملخص النتائج:** تم العثور على 2 مهمة غير مكتملة

⏱️ الوقت المستغرق: 4.31 ثانية

⏱️ الوقت المستغرق: 4.31 ثانية


---

## أمان المشروع (Bandit)
```bash
bandit -r src/ --exclude .venv,venv,__pycache__,build,dist,.mypy_cache,node_modules,.git
```

_Error or No results._
```
[main]	INFO	profile include tests: None
[main]	INFO	profile exclude tests: None
[main]	INFO	cli include tests: None
[main]	INFO	cli exclude tests: None
[main]	INFO	running on Python 3.12.3
Working... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:16
Run started:2025-07-20 08:28:36.484557

Test results:
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/application/services/ai/modules/response_generator.py:277:23
276	        else:
277	            response = random.choice(responses)
278	        # Personalize with child's name if appropriate

--------------------------------------------------
>> Issue: [B405:blacklist] Using xml.etree.ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: src/application/services/data_export/formatters.py:7:0
6	import json
7	import xml.etree.ElementTree as ET
8	import zipfile

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/application/services/verification/verification_service.py:131:15
130	
131	        return random.choice([True, True, True, False])
132	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/domain/entities/voice_games/voice_games_engine.py:110:36
109	            if content_key in self.game_content:
110	                session.questions = random.sample(
111	                    self.game_content[content_key],
112	                    min(
113	                        MAX_QUESTIONS_PER_GAME,
114	                        len(self.game_content[content_key]),
115	                    ),  # Max questions per game
116	                )
117	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/ai/chatgpt/fallback_responses.py:117:24
116	        )
117	        base_response = random.choice(age_responses)
118	        # إضافة نشاط تعليمي

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/ai/chatgpt/fallback_responses.py:119:19
118	        # إضافة نشاط تعليمي
119	        activity = random.choice(self.educational_activities)
120	        # دمج الاستجابة

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/ai/chatgpt/fallback_responses.py:123:11
122	        # إضافة قصة قصيرة أحياناً
123	        if random.random() < 0.3:  # 30% من الوقت
124	            story = random.choice(self.mini_stories)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/ai/chatgpt/fallback_responses.py:124:20
123	        if random.random() < 0.3:  # 30% من الوقت
124	            story = random.choice(self.mini_stories)
125	            response_parts.append(f" Here's a little story for you: {story}")

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/ai/chatgpt/fallback_responses.py:158:28
157	        )
158	        redirect_response = random.choice(redirect_responses)
159	        # إضافة نشاط بديل

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/ai/chatgpt/fallback_responses.py:160:19
159	        # إضافة نشاط بديل
160	        activity = random.choice(self.educational_activities)
161	        full_response = f"{redirect_response} {activity}"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/ai/chatgpt/fallback_responses.py:216:15
215	        ]
216	        return random.choice(starters)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/ai/chatgpt/response_enhancer.py:183:20
182	            # للأطفال الصغار: إضافة رموز تعبيرية
183	            emoji = random.choice(self.child_friendly_emojis)
184	            response = f"{emoji} {response}"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/ai/chatgpt/response_enhancer.py:190:11
189	        # إضافة عبارة تشجيعية في البداية أحياناً
190	        if random.random() < 0.3:  # 30% من الوقت
191	            encouragement = random.choice(self.encouraging_phrases)

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/ai/chatgpt/response_enhancer.py:191:28
190	        if random.random() < 0.3:  # 30% من الوقت
191	            encouragement = random.choice(self.encouraging_phrases)
192	            response = f"{encouragement} {response}"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/ai/chatgpt/response_enhancer.py:199:23
198	        if not response.endswith("?"):
199	            question = random.choice(self.follow_up_questions)
200	            response = f"{response} {question}"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/chaos/actions/hallucination_testing.py:43:29
42	                "prompt": prompt,
43	                "child_age": random.randint(6, 12),
44	                "safety_level": "strict",

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/chaos/actions/load_testing.py:26:50
25	            "http://ai-service:8000/chat",
26	            json={"message": prompt, "child_age": random.randint(5, 12)},
27	            timeout=10,

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/chaos/monitoring/chaos_metrics/metrics_collector.py:77:33
76	                    metric_name="cpu_usage",
77	                    metric_value=random.uniform(0.5, 1.0),
78	                    tags={"region": "us-east-1"},

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'SECRET_KEY'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/infrastructure/config/env_security.py:24:17
23	
24	    SECRET_KEY = "SECRET_KEY"
25	    JWT_SECRET_KEY = "JWT_SECRET_KEY"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'JWT_SECRET_KEY'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/infrastructure/config/env_security.py:25:21
24	    SECRET_KEY = "SECRET_KEY"
25	    JWT_SECRET_KEY = "JWT_SECRET_KEY"
26	    DATABASE_URL = "DATABASE_URL"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '.*_SECRET$'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/infrastructure/config/env_security.py:61:13
60	    KEY = r".*_KEY$"
61	    SECRET = r".*_SECRET$"
62	    PASSWORD = r".*_PASSWORD$"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '.*_PASSWORD$'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/infrastructure/config/env_security.py:62:15
61	    SECRET = r".*_SECRET$"
62	    PASSWORD = r".*_PASSWORD$"
63	    TOKEN = r".*_TOKEN$"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: '.*_TOKEN$'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/infrastructure/config/env_security.py:63:12
62	    PASSWORD = r".*_PASSWORD$"
63	    TOKEN = r".*_TOKEN$"
64	    CREDENTIALS = r".*_CREDENTIALS$"

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/external_apis/chatgpt_client.py:182:15
181	
182	        return random.choice(self.safe_topics)
183	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/infrastructure/messaging/kafka_event_bus.py:189:8
188	                self.stop_consuming()
189	        except Exception:
190	            # Ignore errors during cleanup
191	            pass

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/resilience/retry_decorator.py:71:39
70	                    if jitter:
71	                        delay *= 0.5 + random.random() * 0.5
72	

--------------------------------------------------
>> Issue: [B311:blacklist] Standard pseudo-random generators are not suitable for security/cryptographic purposes.
   Severity: Low   Confidence: High
   CWE: CWE-330 (https://cwe.mitre.org/data/definitions/330.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b311-random
   Location: src/infrastructure/resilience/retry_decorator.py:102:39
101	                    if jitter:
102	                        delay *= 0.5 + random.random() * 0.5
103	

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'password_change'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/infrastructure/security/audit_logger.py:40:22
39	    LOGOUT = "logout"
40	    PASSWORD_CHANGE = "password_change"
41	    ACCOUNT_LOCKED = "account_locked"

--------------------------------------------------
>> Issue: [B104:hardcoded_bind_all_interfaces] Possible binding to all interfaces.
   Severity: Medium   Confidence: Medium
   CWE: CWE-605 (https://cwe.mitre.org/data/definitions/605.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b104_hardcoded_bind_all_interfaces.html
   Location: src/infrastructure/security/cors_service.py:317:43
316	            is_localhost = parsed.netloc.startswith(
317	                ("localhost", "127.0.0.1", "0.0.0.0")
318	            )

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'your-secret-key-here'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/infrastructure/security/jwt_auth.py:52:33
51	            class Security:
52	                JWT_SECRET_KEY = "your-secret-key-here"
53	

--------------------------------------------------
>> Issue: [B110:try_except_pass] Try, Except, Pass detected.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b110_try_except_pass.html
   Location: src/infrastructure/security/jwt_auth.py:110:8
109	            jwt_secret = secrets.get("JWT_SECRET")
110	        except Exception:
111	            # Fallback to settings if vault fails
112	            pass
113	

--------------------------------------------------
>> Issue: [B108:hardcoded_tmp_directory] Probable insecure usage of temp file/directory.
   Severity: Medium   Confidence: Medium
   CWE: CWE-377 (https://cwe.mitre.org/data/definitions/377.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b108_hardcoded_tmp_directory.html
   Location: src/infrastructure/security/path_validator.py:281:8
280	    safe_dirs = {
281	        "/tmp/teddy_temp",  # Temporary files
282	        "./data/children",  # Child data (relative to app)
283	        "./logs",  # Log files
284	        "./exports",  # Data exports for parents
285	    }
286	    # Allow only safe file extensions
287	    safe_extensions = {

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'token_bucket'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/infrastructure/security/rate_limiter/core.py:19:19
18	    SLIDING_WINDOW = "sliding_window"
19	    TOKEN_BUCKET = "token_bucket"
20	    FIXED_WINDOW = "fixed_window"

--------------------------------------------------
>> Issue: [B105:hardcoded_password_string] Possible hardcoded password: 'token_bucket'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b105_hardcoded_password_string.html
   Location: src/infrastructure/security/rate_limiter/core.py:35:19
34	    SLIDING_WINDOW = "sliding_window"
35	    TOKEN_BUCKET = "token_bucket"
36	    LEAKY_BUCKET = "leaky_bucket"

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'dummy_token'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b106_hardcoded_password_funcarg.html
   Location: src/infrastructure/security/real_auth_service.py:48:15
47	        """Authenticate user credentials."""
48	        return LoginResponse(
49	            success=True,
50	            message="Authentication successful",
51	            token="dummy_token"
52	        )
53	    

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:39:8
38	        valid_path = os.path.join(self.temp_dir, "test.txt")
39	        assert self.validator.validate_path(valid_path)
40	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:57:12
56	        for attempt in traversal_attempts:
57	            assert not self.validator.validate_path(
58	                attempt
59	            ), f"Failed to block: {attempt}"
60	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:69:12
68	        for attempt in null_byte_attempts:
69	            assert not self.validator.validate_path(
70	                attempt
71	            ), f"Failed to block null byte: {attempt}"
72	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:76:8
75	        long_path = "a" * 300  # Exceeds 255 char limit
76	        assert not self.validator.validate_path(long_path)
77	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:82:8
81	        invalid_path = os.path.join(self.temp_dir, "test.exe")
82	        assert self.validator.validate_path(valid_path)
83	        assert not self.validator.validate_path(invalid_path)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:83:8
82	        assert self.validator.validate_path(valid_path)
83	        assert not self.validator.validate_path(invalid_path)
84	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:95:12
94	            os.symlink(test_file, symlink_path)
95	            assert not self.validator.validate_path(symlink_path)
96	        except OSError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:112:16
111	            if sanitized:
112	                assert expected_clean in sanitized
113	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:118:8
117	        safe_path = self.validator.get_safe_path(user_input, self.temp_dir)
118	        assert safe_path is not None
119	        assert safe_path.startswith(self.temp_dir)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:119:8
118	        assert safe_path is not None
119	        assert safe_path.startswith(self.temp_dir)
120	        assert "subdir/file.txt" in safe_path or "subdir\\file.txt" in safe_path

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:120:8
119	        assert safe_path.startswith(self.temp_dir)
120	        assert "subdir/file.txt" in safe_path or "subdir\\file.txt" in safe_path
121	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:148:12
147	            content = f.read()
148	            assert content == "test content"
149	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:162:8
161	
162	        assert self.secure_ops.safe_exists("exists.txt")
163	        assert not self.secure_ops.safe_exists("nonexistent.txt")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:163:8
162	        assert self.secure_ops.safe_exists("exists.txt")
163	        assert not self.secure_ops.safe_exists("nonexistent.txt")
164	        assert not self.secure_ops.safe_exists("../../../etc/passwd")

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:164:8
163	        assert not self.secure_ops.safe_exists("nonexistent.txt")
164	        assert not self.secure_ops.safe_exists("../../../etc/passwd")
165	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:173:8
172	
173	        assert self.secure_ops.safe_remove("remove_me.txt")
174	        assert not os.path.exists(test_file)

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:174:8
173	        assert self.secure_ops.safe_remove("remove_me.txt")
174	        assert not os.path.exists(test_file)
175	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:177:8
176	        # Test that traversal attempts fail
177	        assert not self.secure_ops.safe_remove("../../../important_file.txt")
178	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:188:8
187	        files = self.secure_ops.safe_listdir(".")
188	        assert len(files) >= 3
189	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:192:8
191	        files = self.secure_ops.safe_listdir("../../../")
192	        assert files == []
193	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:201:8
200	        validator = create_child_safe_validator()
201	        assert validator is not None
202	        assert not validator.policy.allow_symlinks

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:202:8
201	        assert validator is not None
202	        assert not validator.policy.allow_symlinks
203	        assert validator.policy.max_path_length == 255

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:203:8
202	        assert not validator.policy.allow_symlinks
203	        assert validator.policy.max_path_length == 255
204	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:210:8
209	        # Test safe extensions are allowed
210	        assert ".txt" in validator.policy.allowed_extensions
211	        assert ".json" in validator.policy.allowed_extensions

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:211:8
210	        assert ".txt" in validator.policy.allowed_extensions
211	        assert ".json" in validator.policy.allowed_extensions
212	        assert ".wav" in validator.policy.allowed_extensions

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:212:8
211	        assert ".json" in validator.policy.allowed_extensions
212	        assert ".wav" in validator.policy.allowed_extensions
213	        assert ".png" in validator.policy.allowed_extensions

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:213:8
212	        assert ".wav" in validator.policy.allowed_extensions
213	        assert ".png" in validator.policy.allowed_extensions
214	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:216:8
215	        # Test unsafe extensions are not allowed
216	        assert ".exe" not in validator.policy.allowed_extensions
217	        assert ".bat" not in validator.policy.allowed_extensions

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:217:8
216	        assert ".exe" not in validator.policy.allowed_extensions
217	        assert ".bat" not in validator.policy.allowed_extensions
218	        assert ".sh" not in validator.policy.allowed_extensions

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:218:8
217	        assert ".bat" not in validator.policy.allowed_extensions
218	        assert ".sh" not in validator.policy.allowed_extensions
219	        assert ".php" not in validator.policy.allowed_extensions

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:219:8
218	        assert ".sh" not in validator.policy.allowed_extensions
219	        assert ".php" not in validator.policy.allowed_extensions
220	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:237:12
236	            # Test that path validator is properly initialized
237	            assert hasattr(middleware, "path_validator")
238	            assert middleware.path_validator is not None

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:238:12
237	            assert hasattr(middleware, "path_validator")
238	            assert middleware.path_validator is not None
239	        except ImportError:

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:265:8
264	        result = validator.validate_path("../../../etc/passwd")
265	        assert not result
266	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:270:8
269	        logger.warning("Simulated traversal attempt detected")
270	        assert "traversal" in caplog.text.lower() or len(caplog.records) > 0
271	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:289:8
288	
289	        assert blocked_count == len(attacks)
290	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:296:4
295	    # Test that global functions work
296	    assert not validate_path("../../../etc/passwd")
297	    with pytest.raises(SecurityError):

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:324:8
323	        # Should process 400 paths in under 1 second
324	        assert (end_time - start_time) < 1.0
325	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:337:8
336	        # Verify secure defaults
337	        assert not policy.allow_symlinks
338	        assert policy.max_path_length <= 255

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:338:8
337	        assert not policy.allow_symlinks
338	        assert policy.max_path_length <= 255
339	        assert len(policy.allowed_extensions) > 0

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:339:8
338	        assert policy.max_path_length <= 255
339	        assert len(policy.allowed_extensions) > 0
340	        assert ".exe" not in policy.allowed_extensions

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:340:8
339	        assert len(policy.allowed_extensions) > 0
340	        assert ".exe" not in policy.allowed_extensions
341	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:357:12
356	        for ext in child_safe_extensions:
357	            assert ext in validator.policy.allowed_extensions
358	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:362:12
361	        for ext in dangerous_extensions:
362	            assert ext not in validator.policy.allowed_extensions
363	

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:374:12
373	            error_msg = str(e).lower()
374	            assert "etc" not in error_msg
375	            assert "passwd" not in error_msg

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:375:12
374	            assert "etc" not in error_msg
375	            assert "passwd" not in error_msg
376	            assert "system32" not in error_msg

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b101_assert_used.html
   Location: src/infrastructure/security/tests/test_path_traversal_fixes.py:376:12
375	            assert "passwd" not in error_msg
376	            assert "system32" not in error_msg
377	

--------------------------------------------------

Code scanned:
	Total lines of code: 46045
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 80
		Medium: 2
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 12
		High: 70
Files skipped (6):
	src/application/interfaces/infrastructure_services.py (syntax error while parsing AST from file)
	src/infrastructure/logging/standards.py (syntax error while parsing AST from file)
	src/infrastructure/persistence/database_service_orchestrator.py (syntax error while parsing AST from file)
	src/infrastructure/persistence/repositories/__init__.py (syntax error while parsing AST from file)
	src/presentation/api/emergency_response/main.py (syntax error while parsing AST from file)
	src/presentation/api/endpoints/chatgpt.py (syntax error while parsing AST from file)

```

⏱️ الوقت المستغرق: 23.63 ثانية


---

## فحص الحزم المثبتة (Safety)
```bash
safety check
```

_Error or No results._
```


[33m[1m+===========================================================================================================================================================================================+[0m


[31m[1mDEPRECATED: [0m[33m[1mthis command (`check`) has been DEPRECATED, and will be unsupported beyond 01 June 2024.[0m


[32mWe highly encourage switching to the new [0m[32m[1m`scan`[0m[32m command which is easier to use, more powerful, and can be set up to mimic the deprecated command if required.[0m


[33m[1m+===========================================================================================================================================================================================+[0m


/mnt/c/Users/jaafa/Desktop/5555/ai-teddy/.venv/lib/python3.12/site-packages/safety/safety.py:1853: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
+==============================================================================+

                               /$$$$$$            /$$
                              /$$__  $$          | $$
           /$$$$$$$  /$$$$$$ | $$  \__//$$$$$$  /$$$$$$   /$$   /$$
          /$$_____/ |____  $$| $$$$   /$$__  $$|_  $$_/  | $$  | $$
         |  $$$$$$   /$$$$$$$| $$_/  | $$$$$$$$  | $$    | $$  | $$
          \____  $$ /$$__  $$| $$    | $$_____/  | $$ /$$| $$  | $$
          /$$$$$$$/|  $$$$$$$| $$    |  $$$$$$$  |  $$$$/|  $$$$$$$
         |_______/  \_______/|__/     \_______/   \___/   \____  $$
                                                          /$$  | $$
                                                         |  $$$$$$/
  by safetycli.com                                        \______/

+==============================================================================+

 [1mREPORT[0m 

  Safety [1mv3.6.0[0m is scanning for [1mVulnerabilities[0m[1m...[0m
[1m  Scanning dependencies[0m in your [1menvironment:[0m

  -> /usr/lib/python3.12
  -> /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/.venv/lib/python3.12/site-packages
  -> /usr/lib/python3.12/lib-dynload
  -> /usr/lib/python312.zip
  -> /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/.venv/lib/python3.12/site-
  packages/setuptools/_vendor
  -> /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/.venv/bin

  Using [1mopen-source vulnerability database[0m
[1m  Found and scanned 166 packages[0m
  Timestamp [1m2025-07-20 11:30:19[0m
[1m  4[0m[1m vulnerabilities reported[0m
[1m  0[0m[1m vulnerabilities ignored[0m

+==============================================================================+
 [1mVULNERABILITIES REPORTED[0m 
+==============================================================================+

[31m-> Vulnerability found in python-jose version 3.5.0[0m
[1m   Vulnerability ID: [0m70716
[1m   Affected spec: [0m>=0
[1m   ADVISORY: [0mAffected versions of Python-jose allow attackers to
   cause a denial of service (resource consumption) during a decode via a...
[1m   CVE-2024-33664[0m
[1m   For more information about this vulnerability, visit
   [0mhttps://data.safetycli.com/v/70716/97c[0m
   To ignore this vulnerability, use PyUp vulnerability id 70716 in safety’s
   ignore command-line argument or add the ignore to your safety policy file.


[31m-> Vulnerability found in python-jose version 3.5.0[0m
[1m   Vulnerability ID: [0m70715
[1m   Affected spec: [0m>=0
[1m   ADVISORY: [0mAffected versions of Python-jose have a algorithm
   confusion vulnerability with OpenSSH ECDSA keys and other key formats....
[1m   CVE-2024-33663[0m
[1m   For more information about this vulnerability, visit
   [0mhttps://data.safetycli.com/v/70715/97c[0m
   To ignore this vulnerability, use PyUp vulnerability id 70715 in safety’s
   ignore command-line argument or add the ignore to your safety policy file.


[31m-> Vulnerability found in ecdsa version 0.19.1[0m
[1m   Vulnerability ID: [0m64459
[1m   Affected spec: [0m>=0
[1m   ADVISORY: [0mThe python-ecdsa library, which implements ECDSA
   cryptography in Python, is vulnerable to the Minerva attack...
[1m   CVE-2024-23342[0m
[1m   For more information about this vulnerability, visit
   [0mhttps://data.safetycli.com/v/64459/97c[0m
   To ignore this vulnerability, use PyUp vulnerability id 64459 in safety’s
   ignore command-line argument or add the ignore to your safety policy file.


[31m-> Vulnerability found in ecdsa version 0.19.1[0m
[1m   Vulnerability ID: [0m64396
[1m   Affected spec: [0m>=0
[1m   ADVISORY: [0mEcdsa does not protects against side-channel attacks.
   This is because Python does not provide side-channel secure primitives...
[1m   PVE-2024-64396[0m
[1m   For more information about this vulnerability, visit
   [0mhttps://data.safetycli.com/v/64396/97c[0m
   To ignore this vulnerability, use PyUp vulnerability id 64396 in safety’s
   ignore command-line argument or add the ignore to your safety policy file.


+==============================================================================+
   [32m[1mREMEDIATIONS[0m

  4 vulnerabilities were reported in 2 packages. For detailed remediation & 
  fix recommendations, upgrade to a commercial license. 

+==============================================================================+

 Scan was completed. 4 vulnerabilities were reported. 

+==============================================================================+[0m


[33m[1m+===========================================================================================================================================================================================+[0m


[31m[1mDEPRECATED: [0m[33m[1mthis command (`check`) has been DEPRECATED, and will be unsupported beyond 01 June 2024.[0m


[32mWe highly encourage switching to the new [0m[32m[1m`scan`[0m[32m command which is easier to use, more powerful, and can be set up to mimic the deprecated command if required.[0m


[33m[1m+===========================================================================================================================================================================================+[0m



```

⏱️ الوقت المستغرق: 69.13 ثانية


---

## تحقق أمان الحزم (pip-audit)
```bash
pip-audit
```

```
No known vulnerabilities found

```

**ملخص النتائج:** تم العثور على 1 مشكلة أمنية محتملة

⏱️ الوقت المستغرق: 72.06 ثانية

⏱️ الوقت المستغرق: 72.06 ثانية


---

## كشف الأسرار والمعلومات الحساسة
```bash
detect-secrets scan
```

```
{
  "version": "1.5.0",
  "plugins_used": [
    {
      "name": "ArtifactoryDetector"
    },
    {
      "name": "AWSKeyDetector"
    },
    {
      "name": "AzureStorageKeyDetector"
    },
    {
      "name": "Base64HighEntropyString",
      "limit": 4.5
    },
    {
      "name": "BasicAuthDetector"
    },
    {
      "name": "CloudantDetector"
    },
    {
      "name": "DiscordBotTokenDetector"
    },
    {
      "name": "GitHubTokenDetector"
    },
    {
      "name": "GitLabTokenDetector"
    },
    {
      "name": "HexHighEntropyString",
      "limit": 3.0
    },
    {
      "name": "IbmCloudIamDetector"
    },
    {
      "name": "IbmCosHmacDetector"
    },
    {
      "name": "IPPublicDetector"
    },
    {
      "name": "JwtTokenDetector"
    },
    {
      "name": "KeywordDetector",
      "keyword_exclude": ""
    },
    {
      "name": "MailchimpDetector"
    },
    {
      "name": "NpmDetector"
    },
    {
      "name": "OpenAIDetector"
    },
    {
      "name": "PrivateKeyDetector"
    },
    {
      "name": "PypiTokenDetector"
    },
    {
      "name": "SendGridDetector"
    },
    {
      "name": "SlackDetector"
    },
    {
      "name": "SoftlayerDetector"
    },
    {
      "name": "SquareOAuthDetector"
    },
    {
      "name": "StripeDetector"
    },
    {
      "name": "TelegramBotTokenDetector"
    },
    {
      "name": "TwilioKeyDetector"
    }
  ],
  "filters_used": [
    {
      "path": "detect_secrets.filters.allowlist.is_line_allowlisted"
    },
    {
      "path": "detect_secrets.filters.common.is_ignored_due_to_verification_policies",
      "min_level": 2
    },
    {
      "path": "detect_secrets.filters.heuristic.is_indirect_reference"
    },
    {
      "path": "detect_secrets.filters.heuristic.is_likely_id_string"
    },
    {
      "path": "detect_secrets.filters.heuristic.is_lock_file"
    },
    {
      "path": "detect_secrets.filters.heuristic.is_not_alphanumeric_string"
    },
    {
      "path": "detect_secrets.filters.heuristic.is_potential_uuid"
    },
    {
      "path": "detect_secrets.filters.heuristic.is_prefixed_with_dollar_sign"
    },
    {
      "path": "detect_secrets.filters.heuristic.is_sequential_string"
    },
    {
      "path": "detect_secrets.filters.heuristic.is_swagger_file"
    },
    {
      "path": "detect_secrets.filters.heuristic.is_templated_secret"
    }
  ],
  "results": {
    ".env.example": [
      {
        "type": "Basic Auth Credentials",
        "filename": ".env.example",
        "hashed_secret": "5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8",
        "is_verified": false,
        "line_number": 16
      }
    ],
    ".env.production.template": [
      {
        "type": "Basic Auth Credentials",
        "filename": ".env.production.template",
        "hashed_secret": "5503c11c7a97e1b43215c2bcc5a08064594c678c",
        "is_verified": false,
        "line_number": 15
      },
      {
        "type": "Basic Auth Credentials",
        "filename": ".env.production.template",
        "hashed_secret": "37e328c61a26668e36a7f9a561f6e27bf98ae188",
        "is_verified": false,
        "line_number": 25
      }
    ],
    "config/.env.example": [
      {
        "type": "Basic Auth Credentials",
        "filename": "config/.env.example",
        "hashed_secret": "5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8",
        "is_verified": false,
        "line_number": 7
      }
    ],
    "config/.env.template": [
      {
        "type": "Basic Auth Credentials",
        "filename": "config/.env.template",
        "hashed_secret": "5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8",
        "is_verified": false,
        "line_number": 7
      }
    ],
    "config/api_keys.json.example": [
      {
        "type": "Secret Keyword",
        "filename": "config/api_keys.json.example",
        "hashed_secret": "3417cd3e89b64d630849e6bf3aaf98daa63b64fe",
        "is_verified": false,
        "line_number": 3
      },
      {
        "type": "Secret Keyword",
        "filename": "config/api_keys.json.example",
        "hashed_secret": "b3672fa5c1e7758e93533da2d5d67f65ba70e6db",
        "is_verified": false,
        "line_number": 8
      },
      {
        "type": "Secret Keyword",
        "filename": "config/api_keys.json.example",
        "hashed_secret": "87dce8f4e986eeb286ad16bf4e82b1065ef5bf9f",
        "is_verified": false,
        "line_number": 13
      },
      {
        "type": "Secret Keyword",
        "filename": "config/api_keys.json.example",
        "hashed_secret": "6081a90e5142f5372656ace8e1de0861c7e5d853",
        "is_verified": false,
        "line_number": 18
      },
      {
        "type": "Secret Keyword",
        "filename": "config/api_keys.json.example",
        "hashed_secret": "61aafb9cfd6b63ce4a678dd73269bdc815c477a1",
        "is_verified": false,
        "line_number": 23
      }
    ],
    "sql/init-production.sql": [
      {
        "type": "Secret Keyword",
        "filename": "sql/init-production.sql",
        "hashed_secret": "841cfcdea3956b35107f6c0143bbf6a23bf51398",
        "is_verified": false,
        "line_number": 27
      },
      {
        "type": "Secret Keyword",
        "filename": "sql/init-production.sql",
        "hashed_secret": "2f1aa1e2a58704b452a5dd60ab1bd2b761bf296a",
        "is_verified": false,
        "line_number": 256
      }
    ],
    "src/infrastructure/config/env_security.py": [
      {
        "type": "Secret Keyword",
        "filename": "src/infrastructure/config/env_security.py",
        "hashed_secret": "576956b5291ac38d04ef5f82cc974286a857f0b2",
        "is_verified": false,
        "line_number": 24
      },
      {
        "type": "Secret Keyword",
        "filename": "src/infrastructure/config/env_security.py",
        "hashed_secret": "86c89694a660ef3c39164f6d7054a07a962892c5",
        "is_verified": false,
        "line_number": 25
      },
      {
        "type": "Secret Keyword",
        "filename": "src/infrastructure/config/env_security.py",
        "hashed_secret": "02ecb94373bfb3dfe827ca18409f50b016e8302a",
        "is_verified": false,
        "line_number": 32
      }
    ],
    "src/infrastructure/config/security_settings.py": [
      {
        "type": "Base64 High Entropy String",
        "filename": "src/infrastructure/config/security_settings.py",
        "hashed_secret": "e063a63e1cb9740c4f9dbe06a781fca7bf181de1",
        "is_verified": false,
        "line_number": 22
      }
    ],
    "src/infrastructure/external_apis/chatgpt_client.py": [
      {
        "type": "Secret Keyword",
        "filename": "src/infrastructure/external_apis/chatgpt_client.py",
        "hashed_secret": "a3e14ca24483c78554c083bc907c7194c7846ef1",
        "is_verified": false,
        "line_number": 220
      }
    ],
    "src/infrastructure/security/audit_logger.py": [
      {
        "type": "Secret Keyword",
        "filename": "src/infrastructure/security/audit_logger.py",
        "hashed_secret": "94732424e16be827cd46aa294394ab3ce93b55f4",
        "is_verified": false,
        "line_number": 40
      }
    ],
    "src/infrastructure/security/database_input_validator.py": [
      {
        "type": "Secret Keyword",
        "filename": "src/infrastructure/security/database_input_validator.py",
        "hashed_secret": "372ea08cab33e71c02c651dbc83a474d32c676ea",
        "is_verified": false,
        "line_number": 121
      }
    ],
    "src/infrastructure/security/environment_validator.py": [
      {
        "type": "Basic Auth Credentials",
        "filename": "src/infrastructure/security/environment_validator.py",
        "hashed_secret": "34c6fceca75e456f25e7e99531e2425c6c1de443",
        "is_verified": false,
        "line_number": 209
      }
    ],
    "src/infrastructure/security/jwt_auth.py": [
      {
        "type": "Secret Keyword",
        "filename": "src/infrastructure/security/jwt_auth.py",
        "hashed_secret": "29b8dca3de5ff27bcf8bd3b622adf9970f29381c",
        "is_verified": false,
        "line_number": 52
      }
    ],
    "src/presentation/api/openapi.yaml": [
      {
        "type": "Secret Keyword",
        "filename": "src/presentation/api/openapi.yaml",
        "hashed_secret": "adf010864473d32e0e1683e9b25233b96d9a3dc1",
        "is_verified": false,
        "line_number": 402
      }
    ],
    "tests/backend_components/test_encryption_service.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/backend_components/test_encryption_service.py",
        "hashed_secret": "ebf51dd461945355342a9c9a7730225ec24af80b",
        "is_verified": false,
        "line_number": 115
      }
    ],
    "tests/e2e/test_full_system.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/e2e/test_full_system.py",
        "hashed_secret": "463d8353f4b927fd953e5af7c41084183e8ce5fb",
        "is_verified": false,
        "line_number": 51
      }
    ],
    "tests/frontend_components/conftest.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/frontend_components/conftest.py",
        "hashed_secret": "9da8f6935461dc90a7150890193cd91160e65bc9",
        "is_verified": false,
        "line_number": 12
      }
    ],
    "tests/integration/persistence/test_database_integration.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/integration/persistence/test_database_integration.py",
        "hashed_secret": "87d16dfa541cba89985b4e7ccc4126798c92332a",
        "is_verified": false,
        "line_number": 51
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/integration/persistence/test_database_integration.py",
        "hashed_secret": "4521ce34a0375c8d246658e1031b33dba4da74f9",
        "is_verified": false,
        "line_number": 66
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/integration/persistence/test_database_integration.py",
        "hashed_secret": "c22dd47bb77cb2f411ede211f28f50b9c8c134b6",
        "is_verified": false,
        "line_number": 96
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/integration/persistence/test_database_integration.py",
        "hashed_secret": "07231459bd9aa24caa9870ce32fb02135d95bacc",
        "is_verified": false,
        "line_number": 103
      }
    ],
    "tests/integration/test_api_integration.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/integration/test_api_integration.py",
        "hashed_secret": "36b6a2915ea94e8a2b17c4e1d2986b26e75fd34a",
        "is_verified": false,
        "line_number": 36
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/integration/test_api_integration.py",
        "hashed_secret": "463d8353f4b927fd953e5af7c41084183e8ce5fb",
        "is_verified": false,
        "line_number": 71
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/integration/test_api_integration.py",
        "hashed_secret": "cbdbe4936ce8be63184d9f2e13fc249234371b9a",
        "is_verified": false,
        "line_number": 95
      }
    ],
    "tests/integration/test_production_readiness.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/integration/test_production_readiness.py",
        "hashed_secret": "6a1fa0330bb72b7d29211d3e7b40acb85194f89b",
        "is_verified": false,
        "line_number": 57
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/integration/test_production_readiness.py",
        "hashed_secret": "5f3d738bd1863291cb716e790f50b326e88a7229",
        "is_verified": false,
        "line_number": 58
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/integration/test_production_readiness.py",
        "hashed_secret": "c5b62ea9ada21743c6f353e4a45bc8648b377006",
        "is_verified": false,
        "line_number": 209
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/integration/test_production_readiness.py",
        "hashed_secret": "618160572eb1321f9d1582746cae858066c05361",
        "is_verified": false,
        "line_number": 256
      }
    ],
    "tests/load/locustfile.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/load/locustfile.py",
        "hashed_secret": "789cbe0407840b1c2041cb33452ff60f19bf58cc",
        "is_verified": false,
        "line_number": 23
      }
    ],
    "tests/load/test_concurrent_users.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/load/test_concurrent_users.py",
        "hashed_secret": "789cbe0407840b1c2041cb33452ff60f19bf58cc",
        "is_verified": false,
        "line_number": 68
      }
    ],
    "tests/load/test_load_performance.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/load/test_load_performance.py",
        "hashed_secret": "789cbe0407840b1c2041cb33452ff60f19bf58cc",
        "is_verified": false,
        "line_number": 40
      }
    ],
    "tests/security/test_phase1_security_foundation.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/security/test_phase1_security_foundation.py",
        "hashed_secret": "370f854b604ba6a825818b745c2708b73f07c01c",
        "is_verified": false,
        "line_number": 203
      }
    ],
    "tests/security_validation_test.py": [
      {
        "type": "Basic Auth Credentials",
        "filename": "tests/security_validation_test.py",
        "hashed_secret": "5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8",
        "is_verified": false,
        "line_number": 150
      }
    ],
    "tests/test_basic_functionality.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/test_basic_functionality.py",
        "hashed_secret": "00942f4668670f34c5943cf52c7ef3139fe2b8d6",
        "is_verified": false,
        "line_number": 89
      }
    ],
    "tests/test_clean_container.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/test_clean_container.py",
        "hashed_secret": "3acfb2c2b433c0ea7ff107e33df91b18e52f960f",
        "is_verified": false,
        "line_number": 198
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/test_clean_container.py",
        "hashed_secret": "0604c6d585012530e3c66c5b37712d3bd8f31423",
        "is_verified": false,
        "line_number": 268
      }
    ],
    "tests/unit/application/interfaces/test_infrastructure_services.py": [
      {
        "type": "Basic Auth Credentials",
        "filename": "tests/unit/application/interfaces/test_infrastructure_services.py",
        "hashed_secret": "a94a8fe5ccb19ba61c4c0873d391e987982fbbd3",
        "is_verified": false,
        "line_number": 258
      }
    ],
    "tests/unit/application/services/ai/modules/test_response_generator.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/application/services/ai/modules/test_response_generator.py",
        "hashed_secret": "00942f4668670f34c5943cf52c7ef3139fe2b8d6",
        "is_verified": false,
        "line_number": 67
      }
    ],
    "tests/unit/application/services/ai/test_main_service.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/application/services/ai/test_main_service.py",
        "hashed_secret": "767ef7376d44bb6e52b390ddcd12c1cb1b3902a4",
        "is_verified": false,
        "line_number": 43
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/application/services/ai/test_main_service.py",
        "hashed_secret": "00942f4668670f34c5943cf52c7ef3139fe2b8d6",
        "is_verified": false,
        "line_number": 65
      }
    ],
    "tests/unit/application/services/consent/test_verification_service.py": [
      {
        "type": "Hex High Entropy String",
        "filename": "tests/unit/application/services/consent/test_verification_service.py",
        "hashed_secret": "90bd1b48e958257948487b90bee080ba5ed00caa",
        "is_verified": false,
        "line_number": 119
      },
      {
        "type": "Hex High Entropy String",
        "filename": "tests/unit/application/services/consent/test_verification_service.py",
        "hashed_secret": "84331946e55ba6fb22e85447668cc6f14a63dbd0",
        "is_verified": false,
        "line_number": 257
      }
    ],
    "tests/unit/infrastructure/persistence/repositories/test_user_repository.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/persistence/repositories/test_user_repository.py",
        "hashed_secret": "837366bbabb40e2f9cc5e99a61332ef9c8fc5c39",
        "is_verified": false,
        "line_number": 40
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/persistence/repositories/test_user_repository.py",
        "hashed_secret": "f409ce90a1cd144912d1df8620215b2dc9fda731",
        "is_verified": false,
        "line_number": 184
      }
    ],
    "tests/unit/infrastructure/security/test_encryption_service.py": [
      {
        "type": "Base64 High Entropy String",
        "filename": "tests/unit/infrastructure/security/test_encryption_service.py",
        "hashed_secret": "18fdf21db6a592dac66e4bcefad19d6b8d0428f4",
        "is_verified": false,
        "line_number": 266
      }
    ],
    "tests/unit/infrastructure/security/test_jwt_auth.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_jwt_auth.py",
        "hashed_secret": "5c695d782e3a972fed9a2e72cb0007b9176801db",
        "is_verified": false,
        "line_number": 127
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_jwt_auth.py",
        "hashed_secret": "4d77af6d1f70cca7e885520017f669e58cc5dd59",
        "is_verified": false,
        "line_number": 257
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_jwt_auth.py",
        "hashed_secret": "6d2d4f9ebe53e6a268b0db55ec868edde90f819f",
        "is_verified": false,
        "line_number": 398
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_jwt_auth.py",
        "hashed_secret": "15377a8edbbbaf33590c5f2d657d227eef5cf87c",
        "is_verified": false,
        "line_number": 475
      },
      {
        "type": "Base64 High Entropy String",
        "filename": "tests/unit/infrastructure/security/test_jwt_auth.py",
        "hashed_secret": "df465ad93e0915cd0e32b6ab6f7d683fe0b35113",
        "is_verified": false,
        "line_number": 676
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_jwt_auth.py",
        "hashed_secret": "44d6489ecf8faa26c35f860c18d5d9c38ed4cabc",
        "is_verified": false,
        "line_number": 729
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_jwt_auth.py",
        "hashed_secret": "0da2aeee0b6cb8e5f4de83a37bf190fe9b203038",
        "is_verified": false,
        "line_number": 756
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_jwt_auth.py",
        "hashed_secret": "f32b67c7e26342af42efabc674d441dca0a281c5",
        "is_verified": false,
        "line_number": 761
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_jwt_auth.py",
        "hashed_secret": "909c5e575a0dcb5cef1d412c9a608f32b2d4709a",
        "is_verified": false,
        "line_number": 849
      }
    ],
    "tests/unit/infrastructure/security/test_password_hasher.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "44cdfc3615970ada14420caaaa5c5745fca06002",
        "is_verified": false,
        "line_number": 63
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "c13039760596dc20e79090128d51890ea67b5fe5",
        "is_verified": false,
        "line_number": 111
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "c18006fc138809314751cd1991f1e0b820fabd37",
        "is_verified": false,
        "line_number": 143
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "a1dd0409334288bd546d44532b4882c88ac6e93c",
        "is_verified": false,
        "line_number": 152
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "f6db7cd15318dc08ba07364547a31b169ee8f8f2",
        "is_verified": false,
        "line_number": 166
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "bfda80b8d9a877738c92530d9cc5f805892a0a9f",
        "is_verified": false,
        "line_number": 189
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "d7895d5c49eb13d7ebb19812efd79b8d36784958",
        "is_verified": false,
        "line_number": 199
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "ee215c835d5e4a7a6015f8a431d96f11a90966e9",
        "is_verified": false,
        "line_number": 290
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "cbfdac6008f9cab4083784cbd1874f76618d2a97",
        "is_verified": false,
        "line_number": 302
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "5e832a6f04ac1f6b6e9e7e17749e34fc6640dc5e",
        "is_verified": false,
        "line_number": 303
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "10831e6be1f5e5ad05b431a061608921297d38f3",
        "is_verified": false,
        "line_number": 380
      },
      {
        "type": "Base64 High Entropy String",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "1889cc93d8ade52f864126719cec00d23a562192",
        "is_verified": false,
        "line_number": 424
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "6b42b824dc1fcd932b8c47cb337673d055950073",
        "is_verified": false,
        "line_number": 452
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "367120ffda0ee658be4c676b37bbeea0c826159f",
        "is_verified": false,
        "line_number": 475
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "141641671521895cf30887fbf79d5376fcc8b9b1",
        "is_verified": false,
        "line_number": 509
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "8d6e862ae7ddd995310c68d7c5f13ffacafffe0d",
        "is_verified": false,
        "line_number": 533
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "93ce0bb174edd1b5720b4f61e9706571422ca7cd",
        "is_verified": false,
        "line_number": 555
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "51364733e6b78537b398c375d95bae7ebd745469",
        "is_verified": false,
        "line_number": 568
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "06a5006263d4bc35671d9cc3cbbb27d77c2bd07a",
        "is_verified": false,
        "line_number": 583
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_password_hasher.py",
        "hashed_secret": "69214dcd21005d9945f03b68b198962e2f3a9684",
        "is_verified": false,
        "line_number": 616
      }
    ],
    "tests/unit/infrastructure/security/test_security_components.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_components.py",
        "hashed_secret": "d4e0e04792fd434b5dc9c4155c178f66edcf4ed3",
        "is_verified": false,
        "line_number": 101
      }
    ],
    "tests/unit/infrastructure/security/test_security_manager.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "5a0aee0f3af308cd6d74d617fde6592c2bc94fa3",
        "is_verified": false,
        "line_number": 21
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "e38ad214943daad1d64c102faec29de4afe9da3d",
        "is_verified": false,
        "line_number": 32
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "2aa60a8ff7fcd473d321e0146afd9e26df395147",
        "is_verified": false,
        "line_number": 33
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "6d512cc3d1a73d1f0a7331746483447a60b9bd98",
        "is_verified": false,
        "line_number": 42
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "28c8d41588c3c50bbdc9329505dac8178c93a054",
        "is_verified": false,
        "line_number": 66
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "9fb7fe1217aed442b04c0f5e43b5d5a7d3287097",
        "is_verified": false,
        "line_number": 102
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "b5bc013af872265e389b3abee36dd4932a206ab8",
        "is_verified": false,
        "line_number": 131
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "e8662cfb96bd9c7fe84c31d76819ec3a92c80e63",
        "is_verified": false,
        "line_number": 141
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "8de5cd6279ec82102445c03e8844a74ff78bf5aa",
        "is_verified": false,
        "line_number": 161
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "83ff9f4e0d16d61727cbdf47d769fb707b652217",
        "is_verified": false,
        "line_number": 399
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "1c55972c35432d78fddc4329c5de610b56c9df78",
        "is_verified": false,
        "line_number": 472
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "1d021b4e263aa85654b55af9eeb2ab9888e89311",
        "is_verified": false,
        "line_number": 482
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "00942f4668670f34c5943cf52c7ef3139fe2b8d6",
        "is_verified": false,
        "line_number": 509
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "4c3fade27365b44c9fd7dfdd0dd09707b48b4a79",
        "is_verified": false,
        "line_number": 527
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "6ac8df411dd3a8280146491d19a92c5da1fa12ff",
        "is_verified": false,
        "line_number": 651
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "a7ca74f17b8066f28f8f2d6bf0617b1c298ed2a1",
        "is_verified": false,
        "line_number": 692
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "93c10029302031a44110ca85935b4f939618bc88",
        "is_verified": false,
        "line_number": 714
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "7fa9aba89adb9a590a6eca06829e0a8acbc51146",
        "is_verified": false,
        "line_number": 735
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "779e7c3bf37cbfcbf90a5ffa1f5454bb0c4a2316",
        "is_verified": false,
        "line_number": 801
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "9c369cf272df546112f63c77d2275789dbc1c2f5",
        "is_verified": false,
        "line_number": 816
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_security_manager.py",
        "hashed_secret": "3d833add62205b55e3c23564fad4cf3306cb6775",
        "is_verified": false,
        "line_number": 845
      }
    ],
    "tests/unit/infrastructure/security/test_token_service.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/infrastructure/security/test_token_service.py",
        "hashed_secret": "773c918da2e0c07d3be6d69b0dab1d8f93427083",
        "is_verified": false,
        "line_number": 72
      }
    ],
    "tests/unit/security/test_auth_service.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/security/test_auth_service.py",
        "hashed_secret": "5a0aee0f3af308cd6d74d617fde6592c2bc94fa3",
        "is_verified": false,
        "line_number": 80
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/security/test_auth_service.py",
        "hashed_secret": "b5bc013af872265e389b3abee36dd4932a206ab8",
        "is_verified": false,
        "line_number": 89
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/security/test_auth_service.py",
        "hashed_secret": "e8662cfb96bd9c7fe84c31d76819ec3a92c80e63",
        "is_verified": false,
        "line_number": 90
      }
    ],
    "tests/unit/test_ai_service.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/test_ai_service.py",
        "hashed_secret": "2e7a7ee14caebf378fc32d6cf6f557f347c96773",
        "is_verified": false,
        "line_number": 21
      }
    ],
    "tests/unit/test_auth_service.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/test_auth_service.py",
        "hashed_secret": "463d8353f4b927fd953e5af7c41084183e8ce5fb",
        "is_verified": false,
        "line_number": 66
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/test_auth_service.py",
        "hashed_secret": "382caa7c44ee23ee25616f7e303af33c591efc3a",
        "is_verified": false,
        "line_number": 81
      }
    ],
    "tests/unit/test_child_safety.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/test_child_safety.py",
        "hashed_secret": "00942f4668670f34c5943cf52c7ef3139fe2b8d6",
        "is_verified": false,
        "line_number": 100
      }
    ],
    "tests/unit/test_database_service.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/test_database_service.py",
        "hashed_secret": "c15aef4390301f1d950f8c53008d0d79bc2e44e5",
        "is_verified": false,
        "line_number": 225
      }
    ],
    "tests/unit/test_security_hardening.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/test_security_hardening.py",
        "hashed_secret": "adeb1f886fe1f0e2d29541111f520d72be9a7abf",
        "is_verified": false,
        "line_number": 109
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/test_security_hardening.py",
        "hashed_secret": "90f03f8677d4f701df76a4e9286ea03e66e83f11",
        "is_verified": false,
        "line_number": 407
      },
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/test_security_hardening.py",
        "hashed_secret": "29c5b5f683f9f22bfeb879ac2558264114f7c870",
        "is_verified": false,
        "line_number": 435
      }
    ],
    "tests/unit/test_unified_security_service.py": [
      {
        "type": "Secret Keyword",
        "filename": "tests/unit/test_unified_security_service.py",
        "hashed_secret": "5a0aee0f3af308cd6d74d617fde6592c2bc94fa3",
        "is_verified": false,
        "line_number": 187
      }
    ]
  },
  "generated_at": "2025-07-20T08:35:23Z"
}

```

**ملخص النتائج:** تم العثور على 1037 نتيجة

⏱️ الوقت المستغرق: 173.27 ثانية

⏱️ الوقت المستغرق: 173.27 ثانية


---

## تنظيف سريع للكود (Ruff)
```bash
ruff check src/ --exclude .venv venv __pycache__ build dist .mypy_cache node_modules .git
```

_Error or No results._
```
.mypy_cache:1:1: E902 No such file or directory (os error 2)
__pycache__:1:1: E902 No such file or directory (os error 2)
build:1:1: E902 No such file or directory (os error 2)
dist:1:1: E902 No such file or directory (os error 2)
node_modules:1:1: E902 No such file or directory (os error 2)
src/application/dto/ai_response.py:1:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | from dataclasses import dataclass, field
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ I001
  |
  = help: Organize imports

src/application/dto/ai_response.py:40:17: UP038 Use `X | Y` in `isinstance` call instead of `(X, Y)`
   |
39 |         if (
40 |             not isinstance(self.sentiment, (int, float))
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP038
41 |             or not -1.0 <= self.sentiment <= 1.0
42 |         ):
   |
   = help: Convert to `X | Y`

src/application/dto/ai_response.py:43:19: TRY003 Avoid specifying long messages outside the exception class
   |
41 |               or not -1.0 <= self.sentiment <= 1.0
42 |           ):
43 |               raise ValueError(
   |  ___________________^
44 | |                 f"Sentiment must be between -1.0 and 1.0, " f"got {self.sentiment}",
45 | |             )
   | |_____________^ TRY003
46 |
47 |           if (
   |

src/application/dto/ai_response.py:48:17: UP038 Use `X | Y` in `isinstance` call instead of `(X, Y)`
   |
47 |         if (
48 |             not isinstance(self.safety_score, (int, float))
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP038
49 |             or not 0.0 <= self.safety_score <= 1.0
50 |         ):
   |
   = help: Convert to `X | Y`

src/application/dto/ai_response.py:51:19: TRY003 Avoid specifying long messages outside the exception class
   |
49 |               or not 0.0 <= self.safety_score <= 1.0
50 |           ):
51 |               raise ValueError(
   |  ___________________^
52 | |                 f"Safety score must be between 0.0 and 1.0, "
53 | |                 f"got {self.safety_score}",
54 | |             )
   | |_____________^ TRY003
55 |
56 |           if not self.response_text.strip():
   |

src/application/dto/ai_response.py:57:19: TRY003 Avoid specifying long messages outside the exception class
   |
56 |         if not self.response_text.strip():
57 |             raise ValueError("Response text cannot be empty")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
58 |
59 |         # Mark as unsafe if safety score is too low
   |

src/application/dto/ai_response.py:60:32: PLR2004 Magic value used in comparison, consider replacing `0.8` with a constant variable
   |
59 |         # Mark as unsafe if safety score is too low
60 |         if self.safety_score < 0.8:
   |                                ^^^ PLR2004
61 |             self.safe = False
62 |             if "low_safety_score" not in self.moderation_flags:
   |

src/application/dto/child_data.py:71:50: PLR2004 Magic value used in comparison, consider replacing `3` with a constant variable
   |
69 |         """Validate child data for COPPA compliance after initialization."""
70 |         # Age validation for COPPA compliance
71 |         if not isinstance(self.age, int) or not (3 <= self.age <= 13):
   |                                                  ^ PLR2004
72 |             raise ValueError(
73 |                 "COPPA Violation: Child age must be between 3-13 years. "
   |

src/application/dto/child_data.py:71:67: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
   |
69 |         """Validate child data for COPPA compliance after initialization."""
70 |         # Age validation for COPPA compliance
71 |         if not isinstance(self.age, int) or not (3 <= self.age <= 13):
   |                                                                   ^^ PLR2004
72 |             raise ValueError(
73 |                 "COPPA Violation: Child age must be between 3-13 years. "
   |

src/application/dto/child_data.py:72:19: TRY003 Avoid specifying long messages outside the exception class
   |
70 |           # Age validation for COPPA compliance
71 |           if not isinstance(self.age, int) or not (3 <= self.age <= 13):
72 |               raise ValueError(
   |  ___________________^
73 | |                 "COPPA Violation: Child age must be between 3-13 years. "
74 | |                 f"Received age: {self.age}"
75 | |             )
   | |_____________^ TRY003
76 |
77 |           # Name validation
   |

src/application/dto/child_data.py:79:19: TRY003 Avoid specifying long messages outside the exception class
   |
77 |         # Name validation
78 |         if not self.name or not self.name.strip():
79 |             raise ValueError("Child name cannot be empty")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
80 |
81 |         if len(self.name.strip()) > 100:
   |

src/application/dto/child_data.py:81:37: PLR2004 Magic value used in comparison, consider replacing `100` with a constant variable
   |
79 |             raise ValueError("Child name cannot be empty")
80 |
81 |         if len(self.name.strip()) > 100:
   |                                     ^^^ PLR2004
82 |             raise ValueError("Child name too long (max 100 characters)")
   |

src/application/dto/child_data.py:82:19: TRY003 Avoid specifying long messages outside the exception class
   |
81 |         if len(self.name.strip()) > 100:
82 |             raise ValueError("Child name too long (max 100 characters)")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
83 |
84 |         # Parental consent validation for children under 13
   |

src/application/dto/child_data.py:85:23: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
   |
84 |         # Parental consent validation for children under 13
85 |         if self.age < 13:
   |                       ^^ PLR2004
86 |             if not self.parent_id:
87 |                 raise ValueError(
   |

src/application/dto/child_data.py:87:23: TRY003 Avoid specifying long messages outside the exception class
   |
85 |           if self.age < 13:
86 |               if not self.parent_id:
87 |                   raise ValueError(
   |  _______________________^
88 | |                     "COPPA Compliance: Parent ID required for children under 13"
89 | |                 )
   | |_________________^ TRY003
90 |
91 |               if not self.consent_granted:
   |

src/application/dto/child_data.py:92:23: TRY003 Avoid specifying long messages outside the exception class
   |
91 |               if not self.consent_granted:
92 |                   raise ValueError(
   |  _______________________^
93 | |                     "COPPA Compliance: Parental consent required for children "
94 | |                     "under 13"
95 | |                 )
   | |_________________^ TRY003
96 |
97 |               if not self.consent_date:
   |

src/application/dto/child_data.py:98:23: TRY003 Avoid specifying long messages outside the exception class
    |
 97 |               if not self.consent_date:
 98 |                   raise ValueError(
    |  _______________________^
 99 | |                     "COPPA Compliance: Consent date required when consent is " "granted"
100 | |                 )
    | |_________________^ TRY003
101 |
102 |           # Data retention check (90 days maximum)
    |

src/application/dto/child_data.py:105:38: PLR2004 Magic value used in comparison, consider replacing `90` with a constant variable
    |
103 |         if self.data_created:
104 |             days_since_creation = (datetime.utcnow() - self.data_created).days
105 |             if days_since_creation > 90:
    |                                      ^^ PLR2004
106 |                 raise ValueError(
107 |                     "COPPA Compliance: Child data expired after 90 days. "
    |

src/application/dto/child_data.py:106:23: TRY003 Avoid specifying long messages outside the exception class
    |
104 |               days_since_creation = (datetime.utcnow() - self.data_created).days
105 |               if days_since_creation > 90:
106 |                   raise ValueError(
    |  _______________________^
107 | |                     "COPPA Compliance: Child data expired after 90 days. "
108 | |                     f"Data age: {days_since_creation} days"
109 | |                 )
    | |_________________^ TRY003
110 |
111 |       def should_purge_data(self) -> bool:
    |

src/application/dto/child_data.py:117:39: PLR2004 Magic value used in comparison, consider replacing `90` with a constant variable
    |
116 |         days_since_creation = (datetime.utcnow() - self.data_created).days
117 |         return days_since_creation >= 90
    |                                       ^^ PLR2004
    |

src/application/dto/esp32_request.py:7:5: D205 1 blank line required between summary line and description
   |
 5 |   @dataclass
 6 |   class ESP32Request:
 7 | /     """Represents a request from an ESP32 device containing child
 8 | |     interaction data. Supports multiple input types including audio,
 9 | |     text, and sensor data while maintaining COPPA compliance and child
10 | |     safety requirements.
11 | |
12 | |     Attributes:
13 | |         child_id: Unique identifier for the child using the device
14 | |         audio_data: Optional audio data from device microphone
15 | |         language_code: Optional language preference for response
16 | |         text_input: Optional text input for testing/debugging
17 | |     """
   | |_______^ D205
18 |
19 |       child_id: UUID
   |
   = help: Insert single blank line

src/application/dto/story_response.py:9:11: TRY003 Avoid specifying long messages outside the exception class
  |
7 |     logger.critical(f"CRITICAL ERROR: Pydantic is required for production use: {e}")
8 |     logger.critical("Install required dependencies: pip install pydantic")
9 |     raise ImportError("Missing required dependency: pydantic") from e
  |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
  |

src/application/event_handlers/child_profile_event_handlers.py:28:5: D205 1 blank line required between summary line and description
   |
27 |   class ChildProfileEventHandlers:
28 | /     """High-performance event handlers for child profile domain events.
29 | |     Handles child registration and profile update events with optimized
30 | |     async operations to prevent blocking the event loop.
31 | |     """
   | |_______^ D205
32 |
33 |       def __init__(self, read_model_store: IChildProfileReadModelStore) -> None:
   |
   = help: Insert single blank line

src/application/event_handlers/child_profile_event_handlers.py:59:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
57 |             )  # PII-safe logging
58 |         except Exception as e:
59 |             logger.error(f"Failed to handle child registration: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
60 |             # Re-raise to ensure event processing fails if needed
61 |             raise
   |
   = help: Replace with `exception`

src/application/event_handlers/child_profile_event_handlers.py:107:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
105 |                 logger.debug("No changes detected, skipping database update")
106 |         except Exception as e:
107 |             logger.error(f"Failed to handle child profile update: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
108 |             raise
    |
    = help: Replace with `exception`

src/application/exceptions.py:2:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | """Custom exceptions for the application layer."""
2 | from typing import Any
  | ^^^^^^^^^^^^^^^^^^^^^^ I001
3 | class AITeddyError(Exception):
4 |     """Base exception for all AI Teddy Bear specific errors."""
  |
  = help: Organize imports

src/application/exceptions.py:41:7: A001 Variable `TimeoutError` is shadowing a Python builtin
   |
39 |         )
40 |
41 | class TimeoutError(AITeddyError):
   |       ^^^^^^^^^^^^ A001
42 |     """Raised when an operation times out (e.g., request to external service)."""
   |

src/application/exceptions.py:50:10: W291 [*] Trailing whitespace
   |
48 |             http_status=504,  # 504 Gateway Timeout
49 |             **kwargs,
50 |         ) 
   |          ^ W291
51 | class ConsentError(Exception):
52 |     """
   |
   = help: Remove trailing whitespace

src/application/exceptions.py:52:5: D205 1 blank line required between summary line and description
   |
50 |           ) 
51 |   class ConsentError(Exception):
52 | /     """
53 | |     Raised when a user's consent is missing or invalid.
54 | |     Used in AI response generation and consent validation flows.
55 | |     """
   | |_______^ D205
56 |       def __init__(self, message="Consent is required", *args, **kwargs):
57 |           super().__init__(message, *args, **kwargs)
   |
   = help: Insert single blank line

src/application/exceptions.py:52:5: D212 [*] Multi-line docstring summary should start at the first line
   |
50 |           ) 
51 |   class ConsentError(Exception):
52 | /     """
53 | |     Raised when a user's consent is missing or invalid.
54 | |     Used in AI response generation and consent validation flows.
55 | |     """
   | |_______^ D212
56 |       def __init__(self, message="Consent is required", *args, **kwargs):
57 |           super().__init__(message, *args, **kwargs)
   |
   = help: Remove whitespace after opening quotes

src/application/interfaces/infrastructure_services.py:5:1: SyntaxError: Unexpected indentation
  |
5 |     @abstractmethod
  | ^^^^
6 |     async def schedule_deletion(
7 |         self,
  |

src/application/interfaces/infrastructure_services.py:22:1: SyntaxError: Expected a statement
   |
22 | class IParentVerificationService(ABC):
   | ^
23 |     @abstractmethod
24 |     async def verify_parent_identity(
   |

src/application/interfaces/read_model_interfaces.py:85:5: D205 1 blank line required between summary line and description
   |
83 |       child_id: str, name: str, age: int, preferences: dict[str, Any]
84 |   ) -> IChildProfileReadModel:
85 | /     """Factory function for creating child profile read models
86 | |     This will be implemented by the infrastructure layer.
87 | |     """
   | |_______^ D205
88 |       # This is a placeholder - actual implementation injected by DI container
89 |       raise NotImplementedError("Must be implemented by infrastructure layer")
   |
   = help: Insert single blank line

src/application/interfaces/read_model_interfaces.py:93:5: D205 1 blank line required between summary line and description
   |
92 |   def get_read_model_store() -> IChildProfileReadModelStore:
93 | /     """Factory function for getting read model store
94 | |     This will be implemented by the infrastructure layer.
95 | |     """
   | |_______^ D205
96 |       # This is a placeholder - actual implementation injected by DI container
97 |       raise NotImplementedError("Must be implemented by infrastructure layer")
   |
   = help: Insert single blank line

src/application/interfaces/read_model_interfaces.py:100:24: F821 Undefined name `IEventBus`
    |
100 | def get_event_bus() -> IEventBus:
    |                        ^^^^^^^^^ F821
101 |     """Factory function for getting event bus
102 |     This will be implemented by the infrastructure layer.
    |

src/application/interfaces/read_model_interfaces.py:101:5: D205 1 blank line required between summary line and description
    |
100 |   def get_event_bus() -> IEventBus:
101 | /     """Factory function for getting event bus
102 | |     This will be implemented by the infrastructure layer.
103 | |     """
    | |_______^ D205
104 |       # This is a placeholder - actual implementation injected by DI container
105 |       raise NotImplementedError("Must be implemented by infrastructure layer")
    |
    = help: Insert single blank line

src/application/interfaces/read_model_interfaces.py:108:51: F821 Undefined name `IExternalAPIClient`
    |
108 | def get_external_api_client(service_name: str) -> IExternalAPIClient:
    |                                                   ^^^^^^^^^^^^^^^^^^ F821
109 |     """Factory function for getting external API client
110 |     This will be implemented by the infrastructure layer.
    |

src/application/interfaces/read_model_interfaces.py:109:5: D205 1 blank line required between summary line and description
    |
108 |   def get_external_api_client(service_name: str) -> IExternalAPIClient:
109 | /     """Factory function for getting external API client
110 | |     This will be implemented by the infrastructure layer.
111 | |     """
    | |_______^ D205
112 |       # This is a placeholder - actual implementation injected by DI container
113 |       raise NotImplementedError("Must be implemented by infrastructure layer")
    |
    = help: Insert single blank line

src/application/interfaces/read_model_interfaces.py:116:32: F821 Undefined name `ISettingsProvider`
    |
116 | def get_settings_provider() -> ISettingsProvider:
    |                                ^^^^^^^^^^^^^^^^^ F821
117 |     """Factory function for getting settings provider
118 |     This will be implemented by the infrastructure layer.
    |

src/application/interfaces/read_model_interfaces.py:117:5: D205 1 blank line required between summary line and description
    |
116 |   def get_settings_provider() -> ISettingsProvider:
117 | /     """Factory function for getting settings provider
118 | |     This will be implemented by the infrastructure layer.
119 | |     """
    | |_______^ D205
120 |       # This is a placeholder - actual implementation injected by DI container
121 |       raise NotImplementedError("Must be implemented by infrastructure layer")
    |
    = help: Insert single blank line

src/application/interfaces/text_to_speech_service.py:5:5: D415 First line should end with a period, question mark, or exclamation point
  |
4 | class TextToSpeechService(ABC):
5 |     """Abstract base class for text-to-speech services"""
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
6 |
7 |     @abstractmethod
  |
  = help: Add closing punctuation

src/application/interfaces/text_to_speech_service.py:14:9: D415 First line should end with a period, question mark, or exclamation point
   |
12 |           emotion: str | None = None,
13 |       ) -> bytes:
14 | /         """Generate speech audio from text
15 | |
16 | |         Args:
17 | |             text: The text to convert to speech
18 | |             voice_id: Identifier for the voice to use
19 | |             emotion: Optional emotion to apply to the speech
20 | |
21 | |         Returns:
22 | |             Audio data as bytes
23 | |         """
   | |___________^ D415
24 |
25 |       @abstractmethod
   |
   = help: Add closing punctuation

src/application/interfaces/text_to_speech_service.py:27:9: D415 First line should end with a period, question mark, or exclamation point
   |
25 |       @abstractmethod
26 |       async def list_voices(self) -> list[dict]:
27 | /         """List available voices
28 | |
29 | |         Returns:
30 | |             List of voice information dictionaries
31 | |         """
   | |___________^ D415
32 |
33 |       @abstractmethod
   |
   = help: Add closing punctuation

src/application/interfaces/text_to_speech_service.py:35:9: D415 First line should end with a period, question mark, or exclamation point
   |
33 |       @abstractmethod
34 |       async def health_check(self) -> bool:
35 | /         """Check if the TTS service is healthy
36 | |
37 | |         Returns:
38 | |             True if service is healthy, False otherwise
39 | |         """
   | |___________^ D415
   |
   = help: Add closing punctuation

src/application/services/accessibility_service.py:35:89: E501 Line too long (101 > 88)
   |
33 |         logger: logging.Logger = logger,
34 |     ) -> None:
35 |         """Initializes the accessibility service with a repository for persistence and configuration.
   |                                                                                         ^^^^^^^^^^^^^ E501
36 |
37 |         Args:
   |

src/application/services/accessibility_service.py:38:89: E501 Line too long (89 > 88)
   |
37 |         Args:
38 |             repository: The repository for storing and retrieving accessibility profiles.
   |                                                                                         ^ E501
39 |             accessibility_config: Configuration for accessibility rules and settings.
40 |             logger: Logger instance for logging service operations.
   |

src/application/services/advanced_personalization_service.py:36:89: E501 Line too long (113 > 88)
   |
34 |         logger: logging.Logger = logger,
35 |     ) -> None:
36 |         """Initializes the advanced personalization service with a repository for persistence and an AI provider.
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^ E501
37 |
38 |         Args:
   |

src/application/services/advanced_personalization_service.py:47:9: ERA001 Found commented-out code
   |
45 |         self.ai_provider = ai_provider
46 |         self.logger = logger
47 |         # self.personality_profiles: Dict[str, ChildPersonality] = {}
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ ERA001
48 |
49 |     async def create_personality_profile(
   |
   = help: Remove commented-out code

src/application/services/advanced_personalization_service.py:103:89: E501 Line too long (107 > 88)
    |
101 |         if not profile:
102 |             self.logger.info(
103 |                 f"No personality profile found for child {child_id}. Cannot provide personalized content.",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^ E501
104 |             )
105 |             return None
    |

src/application/services/advanced_personalization_service.py:108:89: E501 Line too long (117 > 88)
    |
107 |         self.logger.debug(
108 |             f"Generating personalized content for child {child_id} (Personality: {profile.personality_type.value}).",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
109 |         )
110 |         try:
    |

src/application/services/advanced_personalization_service.py:121:13: TRY300 Consider moving this statement to an `else` block
    |
119 |             )
120 |             self.logger.info(f"AI generated personalized content for child {child_id}.")
121 |             return personalized_content
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY300
122 |         except Exception as e:
123 |             self.logger.error(
    |

src/application/services/advanced_personalization_service.py:124:89: E501 Line too long (99 > 88)
    |
122 |         except Exception as e:
123 |             self.logger.error(
124 |                 f"Error generating personalized content with AI service for child {child_id}: {e}",
    |                                                                                         ^^^^^^^^^^^ E501
125 |                 exc_info=True,
126 |             )
    |

src/application/services/advanced_personalization_service.py:135:15: D417 Missing argument description in the docstring for `_analyze_interactions`: `child_id`
    |
133 |             }
134 |
135 |     async def _analyze_interactions(
    |               ^^^^^^^^^^^^^^^^^^^^^ D417
136 |         self,
137 |         child_id: UUID,
    |

src/application/services/advanced_personalization_service.py:143:89: E501 Line too long (93 > 88)
    |
142 |         Args:
143 |             interactions: A list of interactions (e.g., {"text": "...", "sentiment": "..."}).
    |                                                                                         ^^^^^ E501
144 |
145 |         Returns:
    |

src/application/services/advanced_progress_analyzer.py:73:89: E501 Line too long (89 > 88)
   |
72 |         Returns:
73 |             A dictionary containing the progress report, or None if no data is available.
   |                                                                                         ^ E501
74 |
75 |         """
   |

src/application/services/advanced_progress_analyzer.py:95:34: ARG002 Unused method argument: `interactions`
   |
93 |         }
94 |
95 |     def _calculate_metrics(self, interactions: list[dict]) -> ProgressMetrics:
   |                                  ^^^^^^^^^^^^ ARG002
96 |         """Calculates progress metrics from a list of interactions.
   |

src/application/services/ai/main_service.py:1:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | / import logging
2 | | from datetime import datetime
3 | | from typing import Any
4 | |
5 | | from src.application.dto.ai_response import AIResponse
6 | | from .utils import AIServiceUtils
  | |_________________________________^ I001
7 |
8 |   try:
  |
  = help: Organize imports

src/application/services/ai/main_service.py:14:5: TRY400 Use `logging.exception` instead of `logging.error`
   |
12 |     # الحل: استخدم logging مباشرة أو import من logging_config لو متوفر
13 |     logger = logging.getLogger(__name__)
14 |     logger.error(f"CRITICAL ERROR: Required dependencies missing: {e}")
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
15 |     logger.error("Install required dependencies: pip install openai pydantic")
16 |     raise ImportError(f"Missing AI service dependencies: {e}") from e
   |
   = help: Replace with `exception`

src/application/services/ai/main_service.py:15:5: TRY400 Use `logging.exception` instead of `logging.error`
   |
13 |     logger = logging.getLogger(__name__)
14 |     logger.error(f"CRITICAL ERROR: Required dependencies missing: {e}")
15 |     logger.error("Install required dependencies: pip install openai pydantic")
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
16 |     raise ImportError(f"Missing AI service dependencies: {e}") from e
   |
   = help: Replace with `exception`

src/application/services/ai/main_service.py:16:11: TRY003 Avoid specifying long messages outside the exception class
   |
14 |     logger.error(f"CRITICAL ERROR: Required dependencies missing: {e}")
15 |     logger.error("Install required dependencies: pip install openai pydantic")
16 |     raise ImportError(f"Missing AI service dependencies: {e}") from e
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
17 |
18 | """AI Teddy Bear Main Service - Production Implementation
   |

src/application/services/ai/main_service.py:19:89: E501 Line too long (92 > 88)
   |
18 | """AI Teddy Bear Main Service - Production Implementation
19 | Enterprise-grade AI service for child-safe interactions following hexagonal architecture."""
   |                                                                                         ^^^^ E501
20 |
21 | logger = logging.getLogger(__name__)
   |

src/application/services/ai/main_service.py:25:5: D205 1 blank line required between summary line and description
   |
24 |   class AITeddyBearService:
25 | /     """Production-grade AI service for child-safe interactions.
26 | |     Features:
27 | |     - Real OpenAI GPT-4 integration
28 | |     - Multi-layer content filtering
29 | |     - Age-appropriate response generation
30 | |     - COPPA compliance
31 | |     - Performance monitoring
32 | |     - Comprehensive error handling.
33 | |     """
   | |_______^ D205
34 |
35 |       def __init__(self, openai_api_key: str, redis_cache=None, settings=None) -> None:
   |
   = help: Insert single blank line

src/application/services/ai/main_service.py:37:19: TRY003 Avoid specifying long messages outside the exception class
   |
35 |     def __init__(self, openai_api_key: str, redis_cache=None, settings=None) -> None:
36 |         if not openai_api_key:
37 |             raise ValueError("OpenAI API key is required for production use")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
38 |         self.client = AsyncOpenAI(api_key=openai_api_key)
39 |         self.redis_cache = redis_cache
   |

src/application/services/ai/main_service.py:70:24: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
   |
68 |         start_time = datetime.utcnow()
69 |         # Input validation
70 |         if child_age > 13:
   |                        ^^ PLR2004
71 |             raise ValueError(
72 |                 "Service only available for children 13 and under (COPPA compliance)",
   |

src/application/services/ai/main_service.py:71:19: TRY003 Avoid specifying long messages outside the exception class
   |
69 |           # Input validation
70 |           if child_age > 13:
71 |               raise ValueError(
   |  ___________________^
72 | |                 "Service only available for children 13 and under (COPPA compliance)",
73 | |             )
   | |_____________^ TRY003
74 |           if not message or not message.strip():
75 |               raise ValueError("Message cannot be empty")
   |

src/application/services/ai/main_service.py:75:19: TRY003 Avoid specifying long messages outside the exception class
   |
73 |             )
74 |         if not message or not message.strip():
75 |             raise ValueError("Message cannot be empty")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
76 |         # Check cache first
77 |         cache_key = self._generate_cache_key(message, child_age, child_name)
   |

src/application/services/ai/main_service.py:88:17: TRY301 Abstract `raise` to an inner function
   |
86 |               moderation_result = await self._moderate_content(message)
87 |               if not moderation_result["safe"]:
88 | /                 raise ValueError(
89 | |                     f"Content flagged by moderation: "
90 | |                     f"{moderation_result['categories']}",
91 | |                 )
   | |_________________^ TRY301
92 |               # Generate age-appropriate system prompt
93 |               system_prompt = self._create_system_prompt(
   |

src/application/services/ai/main_service.py:88:23: TRY003 Avoid specifying long messages outside the exception class
   |
86 |               moderation_result = await self._moderate_content(message)
87 |               if not moderation_result["safe"]:
88 |                   raise ValueError(
   |  _______________________^
89 | |                     f"Content flagged by moderation: "
90 | |                     f"{moderation_result['categories']}",
91 | |                 )
   | |_________________^ TRY003
92 |               # Generate age-appropriate system prompt
93 |               system_prompt = self._create_system_prompt(
   |

src/application/services/ai/main_service.py:103:21: PERF402 Use `list` or `list.copy` to create a copy of a list
    |
101 |             if context:
102 |                 for ctx in context[-5:]:  # Last 5 messages for context
103 |                     messages.append(ctx)
    |                     ^^^^^^^^^^^^^^^^^^^^ PERF402
104 |             messages.append({"role": "user", "content": message})
105 |             # Call OpenAI API
    |

src/application/services/ai/main_service.py:132:13: TRY300 Consider moving this statement to an `else` block
    |
130 |                 processing_time,
131 |             )
132 |             return processed_response
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^ TRY300
133 |         except Exception as e:
134 |             logger.error(f"AI service error: {e}")
    |

src/application/services/ai/main_service.py:134:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
132 |             return processed_response
133 |         except Exception as e:
134 |             logger.error(f"AI service error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
135 |             # Return safe fallback response
136 |             return await self._get_fallback_response(child_name, child_age)
    |
    = help: Replace with `exception`

src/application/services/ai/main_service.py:153:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
151 |             }
152 |         except Exception as e:
153 |             logger.error(f"Moderation API error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
154 |             # Fail safe - assume content is unsafe if moderation fails
155 |             return {
    |
    = help: Replace with `exception`

src/application/services/ai/main_service.py:170:89: E501 Line too long (113 > 88)
    |
168 |         age_group = self._get_age_group(child_age)
169 |         base_prompt = (
170 |             f"You are a friendly, caring AI teddy bear speaking to {child_name}, who is {child_age} years old.\n"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^ E501
171 |             "CRITICAL SAFETY RULES:\n"
172 |             f"- Use age-appropriate language for {age_group} children\n"
    |

src/application/services/ai/main_service.py:174:89: E501 Line too long (100 > 88)
    |
172 |             f"- Use age-appropriate language for {age_group} children\n"
173 |             "- Keep responses positive, educational, and fun\n"
174 |             "- Never discuss inappropriate topics (violence, adult content, personal information)\n"
    |                                                                                         ^^^^^^^^^^^^ E501
175 |             "- Encourage creativity, learning, and positive values\n"
176 |             "- Keep responses under 150 words\n"
    |

src/application/services/ai/modules/response_generator.py:1:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | / import logging
2 | | import re
3 | | import time
4 | | from datetime import datetime
5 | | from enum import Enum
6 | | from typing import Any
7 | | from src.domain.value_objects.safety_level import SafetyLevel
  | |_____________________________________________________________^ I001
8 |   """Production - grade AI response generator with comprehensive child safety"""
  |
  = help: Organize imports

src/application/services/ai/modules/response_generator.py:32:5: D205 1 blank line required between summary line and description
   |
31 |   class ResponseGenerator:
32 | /     """Production - ready AI response generator with comprehensive child safety features.
33 | |     Integrates with OpenAI GPT while maintaining strict content filtering and age - appropriateness.
34 | |     """
   | |_______^ D205
35 |
36 |       def __init__(self, api_key: str | None = None, model: str = "gpt-4") -> None:
   |
   = help: Insert single blank line

src/application/services/ai/modules/response_generator.py:32:89: E501 Line too long (89 > 88)
   |
31 | class ResponseGenerator:
32 |     """Production - ready AI response generator with comprehensive child safety features.
   |                                                                                         ^ E501
33 |     Integrates with OpenAI GPT while maintaining strict content filtering and age - appropriateness.
34 |     """
   |

src/application/services/ai/modules/response_generator.py:33:89: E501 Line too long (100 > 88)
   |
31 | class ResponseGenerator:
32 |     """Production - ready AI response generator with comprehensive child safety features.
33 |     Integrates with OpenAI GPT while maintaining strict content filtering and age - appropriateness.
   |                                                                                         ^^^^^^^^^^^^ E501
34 |     """
   |

src/application/services/ai/modules/response_generator.py:48:17: TRY400 Use `logging.exception` instead of `logging.error`
   |
46 |                 logger.info("OpenAI client initialized successfully")
47 |             except Exception as e:
48 |                 logger.error(f"Failed to initialize OpenAI client: {e}")
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
49 |         else:
50 |             logger.warning("OpenAI not available - using safe fallback responses")
   |
   = help: Replace with `exception`

src/application/services/ai/modules/response_generator.py:53:89: E501 Line too long (131 > 88)
   |
51 | …
52 | …
53 | …ind and loving teddy bear for young children(3 - 6 years). Speak simply and lovingly.
   |                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
54 | …, locations, or real people. Focus on safe learning and play.""",
55 | … smart and fun friend for children(7 - 10 years). Help with learning and safe exploration.
   |

src/application/services/ai/modules/response_generator.py:54:89: E501 Line too long (111 > 88)
   |
52 | …     self.safety_system_prompts = {
53 | …         SafetyLevel.STRICT: """You are a kind and loving teddy bear for young children(3 - 6 years). Speak simply and lovingly.
54 | …         Never mention personal information, locations, or real people. Focus on safe learning and play.""",
   |                                                                                       ^^^^^^^^^^^^^^^^^^^^^^^ E501
55 | …         SafetyLevel.MODERATE: """You are a smart and fun friend for children(7 - 10 years). Help with learning and safe exploration.
56 | …         Avoid personal or dangerous topics. Encourage positive curiosity and learning.""",
   |

src/application/services/ai/modules/response_generator.py:55:89: E501 Line too long (136 > 88)
   |
53 | …d and loving teddy bear for young children(3 - 6 years). Speak simply and lovingly.
54 | …locations, or real people. Focus on safe learning and play.""",
55 | …mart and fun friend for children(7 - 10 years). Help with learning and safe exploration.
   |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
56 | …Encourage positive curiosity and learning.""",
57 | …ducational guide and assistant for older children(11 - 13 years).
   |

src/application/services/ai/modules/response_generator.py:56:89: E501 Line too long (94 > 88)
   |
54 | …     Never mention personal information, locations, or real people. Focus on safe learning and play.""",
55 | …     SafetyLevel.MODERATE: """You are a smart and fun friend for children(7 - 10 years). Help with learning and safe exploration.
56 | …     Avoid personal or dangerous topics. Encourage positive curiosity and learning.""",
   |                                                                                   ^^^^^^ E501
57 | …     SafetyLevel.RELAXED: """You are an educational guide and assistant for older children(11 - 13 years).
58 | …     Provide useful educational information while maintaining safety. Avoid age - inappropriate content.""",
   |

src/application/services/ai/modules/response_generator.py:57:89: E501 Line too long (113 > 88)
   |
55 | …         SafetyLevel.MODERATE: """You are a smart and fun friend for children(7 - 10 years). Help with learning and safe exploration.
56 | …         Avoid personal or dangerous topics. Encourage positive curiosity and learning.""",
57 | …         SafetyLevel.RELAXED: """You are an educational guide and assistant for older children(11 - 13 years).
   |                                                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^ E501
58 | …         Provide useful educational information while maintaining safety. Avoid age - inappropriate content.""",
59 | …     }
   |

src/application/services/ai/modules/response_generator.py:58:89: E501 Line too long (115 > 88)
   |
56 |             Avoid personal or dangerous topics. Encourage positive curiosity and learning.""",
57 |             SafetyLevel.RELAXED: """You are an educational guide and assistant for older children(11 - 13 years).
58 |             Provide useful educational information while maintaining safety. Avoid age - inappropriate content.""",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
59 |         }
60 |         # Unsafe content patterns
   |

src/application/services/ai/modules/response_generator.py:76:89: E501 Line too long (93 > 88)
   |
74 |             ],
75 |             SafetyLevel.MODERATE: [
76 |                 "That's a great question! Let me think of a fun and helpful answer for you.",
   |                                                                                         ^^^^^ E501
77 |                 "I love your curiosity! Would you like to learn something new together?",
78 |                 "How about we play a fun educational game?",
   |

src/application/services/ai/modules/response_generator.py:77:89: E501 Line too long (89 > 88)
   |
75 |             SafetyLevel.MODERATE: [
76 |                 "That's a great question! Let me think of a fun and helpful answer for you.",
77 |                 "I love your curiosity! Would you like to learn something new together?",
   |                                                                                         ^ E501
78 |                 "How about we play a fun educational game?",
79 |             ],
   |

src/application/services/ai/modules/response_generator.py:81:89: E501 Line too long (94 > 88)
   |
79 |             ],
80 |             SafetyLevel.RELAXED: [
81 |                 "That's an interesting topic! Let me share some useful information with you.",
   |                                                                                         ^^^^^^ E501
82 |                 "I appreciate your thoughtful question. Would you like to explore this topic more?",
83 |                 "That's a smart question! Let me help you find an appropriate answer.",
   |

src/application/services/ai/modules/response_generator.py:82:89: E501 Line too long (100 > 88)
   |
80 |             SafetyLevel.RELAXED: [
81 |                 "That's an interesting topic! Let me share some useful information with you.",
82 |                 "I appreciate your thoughtful question. Would you like to explore this topic more?",
   |                                                                                         ^^^^^^^^^^^^ E501
83 |                 "That's a smart question! Let me help you find an appropriate answer.",
84 |             ],
   |

src/application/services/ai/modules/response_generator.py:93:9: D205 1 blank line required between summary line and description
    |
 91 |           response_type: ResponseType = ResponseType.CONVERSATIONAL,
 92 |       ) -> dict[str, Any]:
 93 | /         """Generate safe, age - appropriate AI response with comprehensive filtering.
 94 | |         Args: text: Input text from child
 95 | |             child_context: Context about the child(age, preferences, etc.)
 96 | |             response_type: Type of response to generate
 97 | |         Returns: Dict containing the generated response and safety information
 98 | |         Raises: ValueError: If input is invalid
 99 | |             RuntimeError: If generation fails.
100 | |         """
    | |___________^ D205
101 |           # Input validation
102 |           if not text or not isinstance(text, str):
    |
    = help: Insert single blank line

src/application/services/ai/modules/response_generator.py:103:19: TRY003 Avoid specifying long messages outside the exception class
    |
101 |         # Input validation
102 |         if not text or not isinstance(text, str):
103 |             raise ValueError("Valid input text required")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
104 |         if len(text) > self.max_input_length:
105 |             raise ValueError(
    |

src/application/services/ai/modules/response_generator.py:105:19: TRY003 Avoid specifying long messages outside the exception class
    |
103 |               raise ValueError("Valid input text required")
104 |           if len(text) > self.max_input_length:
105 |               raise ValueError(
    |  ___________________^
106 | |                 f"Input too long: {len(text)} chars (max: {self.max_input_length})",
107 | |             )
    | |_____________^ TRY003
108 |           # Extract child context
109 |           child_context = child_context or {}
    |

src/application/services/ai/modules/response_generator.py:162:13: TRY300 Consider moving this statement to an `else` block
    |
160 |                 f"type={response_type.value}, safe={final_response['safe']}",
161 |             )
162 |             return result
    |             ^^^^^^^^^^^^^ TRY300
163 |         except Exception as e:
164 |             logger.error(f"Response generation failed: {e}")
    |

src/application/services/ai/modules/response_generator.py:164:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
162 |             return result
163 |         except Exception as e:
164 |             logger.error(f"Response generation failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
165 |             # Return safe fallback on any error
166 |             return await self._generate_emergency_fallback(safety_level, child_name)
    |
    = help: Replace with `exception`

src/application/services/ai/modules/response_generator.py:170:25: PLR2004 Magic value used in comparison, consider replacing `6` with a constant variable
    |
168 |     def _get_safety_level(self, child_age: int) -> SafetyLevel:
169 |         """Determine appropriate safety level based on child's age."""
170 |         if child_age <= 6:
    |                         ^ PLR2004
171 |             return SafetyLevel.STRICT
172 |         if child_age <= 10:
    |

src/application/services/ai/modules/response_generator.py:172:25: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
    |
170 |         if child_age <= 6:
171 |             return SafetyLevel.STRICT
172 |         if child_age <= 10:
    |                         ^^ PLR2004
173 |             return SafetyLevel.MODERATE
174 |         return SafetyLevel.RELAXED
    |

src/application/services/ai/modules/response_generator.py:179:9: ARG002 Unused method argument: `safety_level`
    |
177 |         self,
178 |         text: str,
179 |         safety_level: SafetyLevel,
    |         ^^^^^^^^^^^^ ARG002
180 |     ) -> dict[str, Any]:
181 |         """Filter and validate input text for safety."""
    |

src/application/services/ai/modules/response_generator.py:212:9: ARG002 Unused method argument: `child_context`
    |
210 |         self,
211 |         text: str,
212 |         child_context: dict[str, Any],
    |         ^^^^^^^^^^^^^ ARG002
213 |         response_type: ResponseType,
214 |         safety_level: SafetyLevel,
    |

src/application/services/ai/modules/response_generator.py:243:13: TRY300 Consider moving this statement to an `else` block
    |
241 |               )
242 |               generated_text = response.choices[0].message.content.strip()
243 | /             return {
244 | |                 "text": generated_text,
245 | |                 "model": self.model,
246 | |                 "usage": response.usage.total_tokens if response.usage else 0,
247 | |             }
    | |_____________^ TRY300
248 |           except Exception as e:
249 |               logger.warning(f"OpenAI generation failed: {e}")
    |

src/application/services/ai/modules/response_generator.py:260:9: PLC0415 `import` should be at the top-level of a file
    |
258 |     ) -> dict[str, Any]:
259 |         """Generate safe fallback response when AI services are unavailable."""
260 |         import random
    |         ^^^^^^^^^^^^^ PLC0415
261 |
262 |         # Select appropriate fallback responses
    |

src/application/services/ai/modules/response_generator.py:277:24: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
    |
275 |             response = "رائع! أحب التعلم معك. ما الموضوع الذي تريد أن نتعلمه اليوم؟"
276 |         else:
277 |             response = random.choice(responses)
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^ S311
278 |         # Personalize with child's name if appropriate
279 |         if child_name and child_name != "صديقي":
    |

src/application/services/ai/modules/response_generator.py:310:37: PLR2004 Magic value used in comparison, consider replacing `3` with a constant variable
    |
308 |             # Extra strict filtering for youngest children
309 |             complex_words = re.findall(r"\b\w{10,}\b", filtered_text)
310 |             if len(complex_words) > 3:
    |                                     ^ PLR2004
311 |                 warnings.append("Response too complex for age group")
312 |         return {
    |

src/application/services/ai/modules/response_generator.py:326:89: E501 Line too long (105 > 88)
    |
324 | …     """Generate a safe redirect response when unsafe content is detected."""
325 | …     redirect_responses = {
326 | …         SafetyLevel.STRICT: f"{child_name}، دعنا نتحدث عن شيء ممتع! ما رأيك في الحديث عن الحيوانات؟",
    |                                                                                       ^^^^^^^^^^^^^^^^^ E501
327 | …         SafetyLevel.MODERATE: f"{child_name}، أفضل أن نتحدث عن موضوع آخر. هل تريد أن نتعلم شيئاً جديداً؟",
328 | …         SafetyLevel.RELAXED: f"{child_name}، دعنا نغير الموضوع إلى شيء أكثر إثارة للاهتمام!",
    |

src/application/services/ai/modules/response_generator.py:327:89: E501 Line too long (108 > 88)
    |
325 | …     redirect_responses = {
326 | …         SafetyLevel.STRICT: f"{child_name}، دعنا نتحدث عن شيء ممتع! ما رأيك في الحديث عن الحيوانات؟",
327 | …         SafetyLevel.MODERATE: f"{child_name}، أفضل أن نتحدث عن موضوع آخر. هل تريد أن نتعلم شيئاً جديداً؟",
    |                                                                                       ^^^^^^^^^^^^^^^^^^^^ E501
328 | …         SafetyLevel.RELAXED: f"{child_name}، دعنا نغير الموضوع إلى شيء أكثر إثارة للاهتمام!",
329 | …     }
    |

src/application/services/ai/modules/response_generator.py:328:89: E501 Line too long (97 > 88)
    |
326 | …         SafetyLevel.STRICT: f"{child_name}، دعنا نتحدث عن شيء ممتع! ما رأيك في الحديث عن الحيوانات؟",
327 | …         SafetyLevel.MODERATE: f"{child_name}، أفضل أن نتحدث عن موضوع آخر. هل تريد أن نتعلم شيئاً جديداً؟",
328 | …         SafetyLevel.RELAXED: f"{child_name}، دعنا نغير الموضوع إلى شيء أكثر إثارة للاهتمام!",
    |                                                                                       ^^^^^^^^^ E501
329 | …     }
330 | …     return {
    |

src/application/services/ai/modules/response_generator.py:351:90: E501 Line too long (91 > 88)
    |
349 |             SafetyLevel.STRICT: f"مرحباً {child_name}! أنا سعيد جداً للتحدث معك!",
350 |             SafetyLevel.MODERATE: f"أهلاً {child_name}! كيف يمكنني مساعدتك اليوم؟",
351 |             SafetyLevel.RELAXED: f"مرحباً {child_name}! ما الموضوع الذي تريد أن نتحدث عنه؟",
    |                                                                                         ^^^ E501
352 |         }
353 |         return {
    |

src/application/services/ai/modules/transcription_service.py:34:5: D205 1 blank line required between summary line and description
   |
33 |   class TranscriptionService:
34 | /     """Production - ready transcription service with comprehensive child safety features.
35 | |     Supports multiple transcription engines with fallback mechanisms.
36 | |     """
   | |_______^ D205
37 |
38 |       def __init__(self, model_size: str = "base", language_default: str = "ar") -> None:
   |
   = help: Insert single blank line

src/application/services/ai/modules/transcription_service.py:34:89: E501 Line too long (89 > 88)
   |
33 | class TranscriptionService:
34 |     """Production - ready transcription service with comprehensive child safety features.
   |                                                                                         ^ E501
35 |     Supports multiple transcription engines with fallback mechanisms.
36 |     """
   |

src/application/services/ai/modules/transcription_service.py:75:17: TRY400 Use `logging.exception` instead of `logging.error`
   |
73 |                 logger.info("Speech recognition engines initialized")
74 |             except Exception as e:
75 |                 logger.error(f"Failed to initialize transcription engines: {e}")
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
76 |         else:
77 |             logger.warning(
   |
   = help: Replace with `exception`

src/application/services/ai/modules/transcription_service.py:78:89: E501 Line too long (91 > 88)
   |
76 |         else:
77 |             logger.warning(
78 |                 "Speech recognition not available - transcription will use mock responses",
   |                                                                                         ^^^ E501
79 |             )
   |

src/application/services/ai/modules/transcription_service.py:87:9: D205 1 blank line required between summary line and description
   |
85 |           child_id: str | None = None,
86 |       ) -> dict[str, Any]:
87 | /         """Transcribe audio with comprehensive validation and child safety filtering.
88 | |         Args: audio_data: Raw audio bytes
89 | |             language: Language code for transcription
90 | |             child_id: Child identifier for safety logging
91 | |         Returns: Dict containing transcription results and safety information
92 | |         Raises: ValueError: If audio data is invalid
93 | |             RuntimeError: If transcription fails.
94 | |         """
   | |___________^ D205
95 |           # Input validation
96 |           if not audio_data or not isinstance(audio_data, bytes):
   |
   = help: Insert single blank line

src/application/services/ai/modules/transcription_service.py:97:19: TRY003 Avoid specifying long messages outside the exception class
   |
95 |         # Input validation
96 |         if not audio_data or not isinstance(audio_data, bytes):
97 |             raise ValueError("Valid audio data required")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
98 |         if len(audio_data) > self.max_audio_size:
99 |             raise ValueError(
   |

src/application/services/ai/modules/transcription_service.py:99:19: TRY003 Avoid specifying long messages outside the exception class
    |
 97 |               raise ValueError("Valid audio data required")
 98 |           if len(audio_data) > self.max_audio_size:
 99 |               raise ValueError(
    |  ___________________^
100 | |                 f"Audio too large: {len(audio_data)} bytes (max: {self.max_audio_size})",
101 | |             )
    | |_____________^ TRY003
102 |           # Language validation
103 |           language = language or self.language_default
    |

src/application/services/ai/modules/transcription_service.py:100:89: E501 Line too long (89 > 88)
    |
 98 |         if len(audio_data) > self.max_audio_size:
 99 |             raise ValueError(
100 |                 f"Audio too large: {len(audio_data)} bytes (max: {self.max_audio_size})",
    |                                                                                         ^ E501
101 |             )
102 |         # Language validation
    |

src/application/services/ai/modules/transcription_service.py:118:17: TRY301 Abstract `raise` to an inner function
    |
116 |             audio_info = await self._validate_audio_file(temp_audio_path)
117 |             if not audio_info["valid"]:
118 |                 raise ValueError(f"Invalid audio format: {audio_info['error']}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
119 |             # Perform transcription using best available method
120 |             transcription_result = await self._perform_transcription(
    |

src/application/services/ai/modules/transcription_service.py:118:23: TRY003 Avoid specifying long messages outside the exception class
    |
116 |             audio_info = await self._validate_audio_file(temp_audio_path)
117 |             if not audio_info["valid"]:
118 |                 raise ValueError(f"Invalid audio format: {audio_info['error']}")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
119 |             # Perform transcription using best available method
120 |             transcription_result = await self._perform_transcription(
    |

src/application/services/ai/modules/transcription_service.py:150:13: TRY300 Consider moving this statement to an `else` block
    |
148 |                     f"safe: {filtered_result['safe']}",
149 |                 )
150 |             return result
    |             ^^^^^^^^^^^^^ TRY300
151 |         except Exception as e:
152 |             logger.error(f"Transcription failed for child {child_id}: {e}")
    |

src/application/services/ai/modules/transcription_service.py:152:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
150 |             return result
151 |         except Exception as e:
152 |             logger.error(f"Transcription failed for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
153 |             raise RuntimeError(f"Audio transcription failed: {e}")
154 |         finally:
    |
    = help: Replace with `exception`

src/application/services/ai/modules/transcription_service.py:153:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
151 |         except Exception as e:
152 |             logger.error(f"Transcription failed for child {child_id}: {e}")
153 |             raise RuntimeError(f"Audio transcription failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
154 |         finally:
155 |             # Clean up temporary file
    |

src/application/services/ai/modules/transcription_service.py:153:19: TRY003 Avoid specifying long messages outside the exception class
    |
151 |         except Exception as e:
152 |             logger.error(f"Transcription failed for child {child_id}: {e}")
153 |             raise RuntimeError(f"Audio transcription failed: {e}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
154 |         finally:
155 |             # Clean up temporary file
    |

src/application/services/ai/modules/transcription_service.py:158:21: PTH108 `os.unlink()` should be replaced by `Path.unlink()`
    |
156 |             try:
157 |                 if "temp_audio_path" in locals():
158 |                     os.unlink(temp_audio_path)
    |                     ^^^^^^^^^ PTH108
159 |             except Exception as e:
160 |                 logger.warning(f"Failed to cleanup temp file: {e}")
    |
    = help: Replace with `Path(...).unlink()`

src/application/services/ai/modules/transcription_service.py:187:89: E501 Line too long (98 > 88)
    |
185 |                 result["valid"] = False
186 |                 result["error"] = (
187 |                     f"Audio too long: {result['duration']:.1f}s (max: {self.max_audio_duration}s)"
    |                                                                                         ^^^^^^^^^^ E501
188 |                 )
189 |             return result
    |

src/application/services/ai/modules/transcription_service.py:189:13: TRY300 Consider moving this statement to an `else` block
    |
187 |                     f"Audio too long: {result['duration']:.1f}s (max: {self.max_audio_duration}s)"
188 |                 )
189 |             return result
    |             ^^^^^^^^^^^^^ TRY300
190 |         except Exception as e:
191 |             return {
    |

src/application/services/ai/modules/transcription_service.py:201:9: ARG002 Unused method argument: `child_id`
    |
199 |         audio_path: str,
200 |         language: str,
201 |         child_id: str | None = None,
    |         ^^^^^^^^ ARG002
202 |     ) -> dict[str, Any]:
203 |         """Perform actual transcription using available engines."""
    |

src/application/services/ai/modules/transcription_service.py:283:24: PLR2004 Magic value used in comparison, consider replacing `1000` with a constant variable
    |
281 |             return {"text": "", "safe": True, "warnings": warnings}
282 |         # Check for excessive length (potential spam/abuse)
283 |         if len(text) > 1000:
    |                        ^^^^ PLR2004
284 |             warnings.append("Text too long, truncating for safety")
285 |             text = text[:1000] + "..."
    |

src/application/services/ai/utils.py:41:18: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
   |
39 |     def check_age_appropriateness(content: str, age: int) -> bool:
40 |         """Simple age appropriateness check."""
41 |         if age < 5:
   |                  ^ PLR2004
42 |             # For very young children, restrict complex words
43 |             restricted_words = ["kill", "death", "scary"]
   |

src/application/services/ai/utils.py:77:17: PERF401 Use a list comprehension to create a transformed list
   |
75 |         for word in keywords:
76 |             if word in content.lower():
77 |                 topics.append(word)
   |                 ^^^^^^^^^^^^^^^^^^^ PERF401
78 |         return topics
   |
   = help: Replace for loop with list comprehension

src/application/services/ai/utils.py:88:19: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
   |
86 |     def get_age_group(age: int) -> str:
87 |         """Get age group classification."""
88 |         if age <= 5:
   |                   ^ PLR2004
89 |             return "toddler"
90 |         if age <= 8:
   |

src/application/services/ai/utils.py:90:19: PLR2004 Magic value used in comparison, consider replacing `8` with a constant variable
   |
88 |         if age <= 5:
89 |             return "toddler"
90 |         if age <= 8:
   |                   ^ PLR2004
91 |             return "young child"
92 |         if age <= 13:
   |

src/application/services/ai/utils.py:92:19: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
   |
90 |         if age <= 8:
91 |             return "young child"
92 |         if age <= 13:
   |                   ^^ PLR2004
93 |             return "preteen"
94 |         return "adult"
   |

src/application/services/ai_orchestration_service.py:16:5: A004 Import `TimeoutError` is shadowing a Python builtin
   |
14 |     InvalidInputError,
15 |     ServiceUnavailableError,
16 |     TimeoutError,
   |     ^^^^^^^^^^^^ A004
17 | )
18 | from src.application.interfaces.ai_provider import AIProvider
   |

src/application/services/ai_orchestration_service.py:92:89: E501 Line too long (101 > 88)
   |
90 |             TimeoutError,
91 |             AITeddyError,
92 |         ) as e:  # Assuming these specific exceptions from external_apis or a custom exception module
   |                                                                                         ^^^^^^^^^^^^^ E501
93 |             logger.error(f"AI provider error: {e}", exc_info=True)
94 |             return AIResponse.safe_fallback(
   |

src/application/services/ai_orchestration_service.py:95:89: E501 Line too long (107 > 88)
   |
93 |             logger.error(f"AI provider error: {e}", exc_info=True)
94 |             return AIResponse.safe_fallback(
95 |                 "I'm sorry, I'm having trouble understanding right now. Can we talk about something else?",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^ E501
96 |             )
97 |         except Exception as e:
   |

src/application/services/audio_processing_service.py:74:89: E501 Line too long (118 > 88)
   |
72 |         except Exception as e:
73 |             self.logger.error(
74 |                 f"Failed to generate audio response for text: '{text[:50]}...' with voice_id: {voice_id}. Error: {e}",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
75 |                 exc_info=True,
76 |             )
   |

src/application/services/audit_service.py:21:34: B008 Do not perform function call `get_logger` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
19 |     def __init__(
20 |         self,
21 |         logger: logging.Logger = get_logger(__name__, component="audit_service"),
   |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
22 |     ) -> None:
23 |         """Initializes the audit service."""
   |

src/application/services/cleanup_service.py:19:89: E501 Line too long (92 > 88)
   |
18 | class CleanupService:
19 |     """Service for cleaning up old data and maintaining system health (COPPA compliance)."""
   |                                                                                         ^^^^ E501
20 |
21 |     def __init__(
   |

src/application/services/cleanup_service.py:23:34: B008 Do not perform function call `get_logger` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
21 |     def __init__(
22 |         self,
23 |         logger: logging.Logger = get_logger(__name__, component="cleanup_service"),
   |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
24 |     ) -> None:
25 |         """Initializes the cleanup service with predefined retention policies."""
   |

src/application/services/cleanup_service.py:39:89: E501 Line too long (94 > 88)
   |
38 |     def _is_safe_path(self, file_path: Path) -> bool:
39 |         """Validates if a file path is safe for deletion (e.g., prevents directory traversal).
   |                                                                                         ^^^^^^ E501
40 |
41 |         In a real implementation, this would:
   |

src/application/services/cleanup_service.py:62:89: E501 Line too long (105 > 88)
   |
61 |         Args:
62 |             data_type: Optional. The specific type of data to clean. If None, all data types are cleaned.
   |                                                                                         ^^^^^^^^^^^^^^^^^ E501
63 |
64 |         Returns:
   |

src/application/services/cleanup_service.py:96:89: E501 Line too long (92 > 88)
   |
94 |             self.logger.info(
95 |                 f"Cleanup complete. Total items cleaned: {total_cleaned}, "
96 |                 f"Total space freed: {total_space_freed:.2f} MB, Duration: {duration:.2f}s",
   |                                                                                         ^^^^ E501
97 |             )
98 |             return {
   |

src/application/services/cleanup_service.py:98:13: TRY300 Consider moving this statement to an `else` block
    |
 96 |                   f"Total space freed: {total_space_freed:.2f} MB, Duration: {duration:.2f}s",
 97 |               )
 98 | /             return {
 99 | |                 "success": True,
100 | |                 "total_items_cleaned": total_cleaned,
101 | |                 "total_space_freed_mb": total_space_freed,
102 | |                 "duration_seconds": duration,
103 | |                 "details": cleanup_results,
104 | |             }
    | |_____________^ TRY300
105 |           except Exception as e:
106 |               self.logger.error(f"Error during cleanup: {e}", exc_info=True)
    |

src/application/services/cleanup_service.py:148:9: ARG002 Unused method argument: `cutoff_date`
    |
146 |         self,
147 |         data_type: str,
148 |         cutoff_date: datetime,
    |         ^^^^^^^^^^^ ARG002
149 |     ) -> tuple[int, float]:
150 |         """Simulates the cleanup of data for a given type and cutoff date.
    |

src/application/services/consent/__init__.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """COPPA - Compliant Consent Management Package
2 | | Modular consent management system providing enterprise - grade COPPA compliance
3 | | for child data collection and processing.
4 | | """
  | |___^ D205
5 |   # استيراد ConsentRecord من domain models
6 |   from src.domain.models.consent_models import ConsentRecord
  |
  = help: Insert single blank line

src/application/services/consent/__init__.py:19:22: W291 [*] Trailing whitespace
   |
17 | __all__ = [
18 |     "ConsentRecord",
19 |     "ConsentService", 
   |                      ^ W291
20 |     "VerificationAttempt",
21 |     "VerificationMethod",
   |
   = help: Remove trailing whitespace

src/application/services/consent/consent_models.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Consent Management Data Models
2 | | Defines the core data structures for COPPA - compliant consent management.
3 | | """
  | |___^ D205
4 |
5 |   from dataclasses import dataclass
  |
  = help: Insert single blank line

src/application/services/consent/consent_models.py:7:20: F401 [*] `typing.Any` imported but unused
  |
5 | from dataclasses import dataclass
6 | from enum import Enum
7 | from typing import Any
  |                    ^^^ F401
  |
  = help: Remove unused import: `typing.Any`

src/application/services/consent/consent_service.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Core consent management functionality extracted into clean, maintainable modules.
2 | | File reduced from 557 lines to < 200 lines for better maintainability.
3 | | """
  | |___^ D205
4 |
5 |   from datetime import datetime, timedelta
  |
  = help: Insert single blank line

src/application/services/consent/consent_service.py:5:1: I001 [*] Import block is un-sorted or un-formatted
   |
 3 |   """
 4 |
 5 | / from datetime import datetime, timedelta
 6 | | from typing import Any
 7 | |
 8 | | from src.infrastructure.logging_config import get_logger
 9 | |
10 | | from src.domain.models.consent_models import (
11 | |     ConsentRecord,
12 | | )
13 | | from .verification_service import VerificationService
   | |_____________________________________________________^ I001
14 |
15 |   logger = get_logger(__name__, component="services")
   |
   = help: Organize imports

src/application/services/consent/consent_service.py:19:5: D205 1 blank line required between summary line and description
   |
18 |   class ConsentService:
19 | /     """This service manages the entire consent lifecycle with proper audit trails and compliance validation.
20 | |     Refactored into modular architecture for maintainability and scalability.
21 | |
22 | |     Features:
23 | |     - Consent request and grant workflows
24 | |     - Comprehensive audit trails
25 | |     - COPPA compliance validation
26 | |     - Integration with verification service
27 | |     - Clean separation of concerns
28 | |     """
   | |_______^ D205
29 |
30 |       def __init__(self) -> None:
   |
   = help: Insert single blank line

src/application/services/consent/consent_service.py:19:89: E501 Line too long (108 > 88)
   |
18 | class ConsentService:
19 |     """This service manages the entire consent lifecycle with proper audit trails and compliance validation.
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^ E501
20 |     Refactored into modular architecture for maintainability and scalability.
   |

src/application/services/consent/verification_service.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Parental Verification Service
2 | | Handles all verification methods for parental identity confirmation
3 | | required for COPPA compliance.
4 | | """
  | |___^ D205
5 |
6 |   import re
  |
  = help: Insert single blank line

src/application/services/consent/verification_service.py:23:89: E501 Line too long (123 > 88)
   |
22 | class VerificationService:
23 |     """Handles verification workflows with proper security measures and comprehensive audit trails for COPPA compliance."""
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
24 |
25 |     def __init__(self) -> None:
   |

src/application/services/consent/verification_service.py:78:71: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
   |
76 |         verification_code = self._generate_verification_code()
77 |         attempt_id = f"sms_{consent_id}_{secrets.token_urlsafe(8)}"
78 |         masked_phone = phone[:3] + "***" + phone[-2:] if len(phone) > 5 else "***"
   |                                                                       ^ PLR2004
79 |         logger.info(f"SMS verification code sent to {masked_phone}: [REDACTED]")
80 |         self.verification_attempts[attempt_id] = VerificationAttempt(
   |

src/application/services/consent/verification_service.py:126:16: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
    |
124 |         digits_only = re.sub(r"\D", "", phone)
125 |         # Check if it's a valid length (between 10-15 digits)
126 |         return 10 <= len(digits_only) <= 15
    |                ^^ PLR2004
127 |
128 |     def _generate_verification_code(self) -> str:
    |

src/application/services/consent/verification_service.py:126:42: PLR2004 Magic value used in comparison, consider replacing `15` with a constant variable
    |
124 |         digits_only = re.sub(r"\D", "", phone)
125 |         # Check if it's a valid length (between 10-15 digits)
126 |         return 10 <= len(digits_only) <= 15
    |                                          ^^ PLR2004
127 |
128 |     def _generate_verification_code(self) -> str:
    |

src/application/services/content_filter_service.py:8:1: I001 [*] Import block is un-sorted or un-formatted
   |
 6 |   """
 7 |
 8 | / import logging
 9 | |
10 | | from src.application.interfaces.safety_monitor import SafetyMonitor
11 | | from src.domain.value_objects.safety_level import SafetyLevel
12 | |
13 | | from src.infrastructure.logging_config import get_logger
   | |________________________________________________________^ I001
14 |
15 |   logger = get_logger(__name__, component="content_filter_service")
   |
   = help: Organize imports

src/application/services/content_filter_service.py:38:9: D205 1 blank line required between summary line and description
   |
37 |       async def filter_content(self, text: str, age: int = 0) -> str:
38 | /         """Filters inappropriate content from the given text using a comprehensive
39 | |         safety monitor.
40 | |
41 | |         Args:
42 | |             text: The input text to filter.
43 | |             age: The age of the user for age-specific filtering (default to 0 if
44 | |                 not provided).
45 | |
46 | |         Returns:
47 | |             The filtered text, or "[CONTENT BLOCKED]" if deemed unsafe.
48 | |
49 | |         """
   | |___________^ D205
50 |           self.logger.info(f"Filtering content for age {age}: {text[:50]}...")
51 |           safety_result = await self.safety_monitor.check_content_safety(
   |
   = help: Insert single blank line

src/application/services/conversation_service.py:85:19: TRY003 Avoid specifying long messages outside the exception class
   |
83 |         conversation = await self.conversation_repo.get_by_id(conversation_id)
84 |         if not conversation:
85 |             raise ValueError(f"Conversation with ID {conversation_id} not found.")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
86 |         return conversation
   |

src/application/services/conversation_service.py:155:89: E501 Line too long (90 > 88)
    |
153 |         if not conversations:
154 |             self.logger.info(
155 |                 f"No active conversation found for child {child_id}. Starting a new one.",
    |                                                                                         ^^ E501
156 |             )
157 |             conversation = await self.start_new_conversation(child_id, user_input)
    |

src/application/services/coppa/coppa_compliance_service.py:9:1: I001 [*] Import block is un-sorted or un-formatted
   |
 7 |   4. Handles all edge cases with proper error handling
 8 |   """
 9 | / from datetime import datetime, timedelta
10 | | from typing import Dict, Any, Optional, List
11 | | from uuid import uuid4
12 | |
13 | | from src.domain.models.consent_models import ConsentType, ConsentStatus, ConsentRecord
14 | | from src.infrastructure.security.coppa_validator import (
15 | |     COPPAValidator, 
16 | |     COPPAValidationResult,
17 | |     COPPAValidatorLevel
18 | | )
19 | | from src.infrastructure.persistence.models.consent_models import ConsentModel
20 | | from src.infrastructure.logging_config import get_logger
21 | | from src.application.services.consent.consent_service import ConsentService
22 | | from src.domain.exceptions.base_exceptions import ValidationError
23 | | from src.application.exceptions import ConsentError
   | |___________________________________________________^ I001
24 |
25 |   logger = get_logger(__name__)
   |
   = help: Organize imports

src/application/services/coppa/coppa_compliance_service.py:9:32: F401 [*] `datetime.timedelta` imported but unused
   |
 7 | 4. Handles all edge cases with proper error handling
 8 | """
 9 | from datetime import datetime, timedelta
   |                                ^^^^^^^^^ F401
10 | from typing import Dict, Any, Optional, List
11 | from uuid import uuid4
   |
   = help: Remove unused import: `datetime.timedelta`

src/application/services/coppa/coppa_compliance_service.py:10:1: UP035 `typing.Dict` is deprecated, use `dict` instead
   |
 8 | """
 9 | from datetime import datetime, timedelta
10 | from typing import Dict, Any, Optional, List
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
11 | from uuid import uuid4
   |

src/application/services/coppa/coppa_compliance_service.py:10:1: UP035 `typing.List` is deprecated, use `list` instead
   |
 8 | """
 9 | from datetime import datetime, timedelta
10 | from typing import Dict, Any, Optional, List
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
11 | from uuid import uuid4
   |

src/application/services/coppa/coppa_compliance_service.py:15:20: W291 [*] Trailing whitespace
   |
13 | from src.domain.models.consent_models import ConsentType, ConsentStatus, ConsentRecord
14 | from src.infrastructure.security.coppa_validator import (
15 |     COPPAValidator, 
   |                    ^ W291
16 |     COPPAValidationResult,
17 |     COPPAValidatorLevel
   |
   = help: Remove trailing whitespace

src/application/services/coppa/coppa_compliance_service.py:19:66: F401 [*] `src.infrastructure.persistence.models.consent_models.ConsentModel` imported but unused
   |
17 |     COPPAValidatorLevel
18 | )
19 | from src.infrastructure.persistence.models.consent_models import ConsentModel
   |                                                                  ^^^^^^^^^^^^ F401
20 | from src.infrastructure.logging_config import get_logger
21 | from src.application.services.consent.consent_service import ConsentService
   |
   = help: Remove unused import: `src.infrastructure.persistence.models.consent_models.ConsentModel`

src/application/services/coppa/coppa_compliance_service.py:30:1: W293 Blank line contains whitespace
   |
28 | class COPPAComplianceService:
29 |     """Enterprise-grade COPPA compliance service with full integration.
30 |     
   | ^^^^ W293
31 |     This service provides:
32 |     - Complete age validation with proper error handling
   |
   = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:38:1: W293 [*] Blank line contains whitespace
   |
36 |     - Data retention policy enforcement
37 |     """
38 |     
   | ^^^^ W293
39 |     def __init__(
40 |         self, 
   |
   = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:40:14: W291 [*] Trailing whitespace
   |
39 |     def __init__(
40 |         self, 
   |              ^ W291
41 |         validator: Optional[COPPAValidator] = None,
42 |         consent_service: Optional[ConsentService] = None
   |
   = help: Remove trailing whitespace

src/application/services/coppa/coppa_compliance_service.py:41:20: UP045 [*] Use `X | None` for type annotations
   |
39 |     def __init__(
40 |         self, 
41 |         validator: Optional[COPPAValidator] = None,
   |                    ^^^^^^^^^^^^^^^^^^^^^^^^ UP045
42 |         consent_service: Optional[ConsentService] = None
43 |     ):
   |
   = help: Convert to `X | None`

src/application/services/coppa/coppa_compliance_service.py:42:26: UP045 [*] Use `X | None` for type annotations
   |
40 |         self, 
41 |         validator: Optional[COPPAValidator] = None,
42 |         consent_service: Optional[ConsentService] = None
   |                          ^^^^^^^^^^^^^^^^^^^^^^^^ UP045
43 |     ):
44 |         """Initialize with optional dependency injection.
   |
   = help: Convert to `X | None`

src/application/services/coppa/coppa_compliance_service.py:45:1: W293 Blank line contains whitespace
   |
43 |     ):
44 |         """Initialize with optional dependency injection.
45 |         
   | ^^^^^^^^ W293
46 |         Args:
47 |             validator: COPPA validator instance (defaults to singleton)
   |
   = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:52:26: UP006 [*] Use `list` instead of `List` for type annotation
   |
50 |         self._validator = validator or COPPAValidator()
51 |         self._consent_service = consent_service or ConsentService()
52 |         self._audit_log: List[Dict[str, Any]] = []
   |                          ^^^^ UP006
53 |         
54 |         logger.info("COPPAComplianceService initialized with full compliance stack")
   |
   = help: Replace with `list`

src/application/services/coppa/coppa_compliance_service.py:52:31: UP006 [*] Use `dict` instead of `Dict` for type annotation
   |
50 |         self._validator = validator or COPPAValidator()
51 |         self._consent_service = consent_service or ConsentService()
52 |         self._audit_log: List[Dict[str, Any]] = []
   |                               ^^^^ UP006
53 |         
54 |         logger.info("COPPAComplianceService initialized with full compliance stack")
   |
   = help: Replace with `dict`

src/application/services/coppa/coppa_compliance_service.py:53:1: W293 [*] Blank line contains whitespace
   |
51 |         self._consent_service = consent_service or ConsentService()
52 |         self._audit_log: List[Dict[str, Any]] = []
53 |         
   | ^^^^^^^^ W293
54 |         logger.info("COPPAComplianceService initialized with full compliance stack")
   |
   = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:55:1: W293 [*] Blank line contains whitespace
   |
54 |         logger.info("COPPAComplianceService initialized with full compliance stack")
55 |     
   | ^^^^ W293
56 |     async def validate_child_age(self, age: int) -> Dict[str, Any]:
57 |         """Validate child age with complete COPPA compliance check.
   |
   = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:56:53: UP006 [*] Use `dict` instead of `Dict` for type annotation
   |
54 |         logger.info("COPPAComplianceService initialized with full compliance stack")
55 |     
56 |     async def validate_child_age(self, age: int) -> Dict[str, Any]:
   |                                                     ^^^^ UP006
57 |         """Validate child age with complete COPPA compliance check.
   |
   = help: Replace with `dict`

src/application/services/coppa/coppa_compliance_service.py:58:1: W293 Blank line contains whitespace
   |
56 |     async def validate_child_age(self, age: int) -> Dict[str, Any]:
57 |         """Validate child age with complete COPPA compliance check.
58 |         
   | ^^^^^^^^ W293
59 |         This method provides the expected dict interface for routes while
60 |         leveraging the full power of COPPAValidator.
   |
   = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:61:1: W293 Blank line contains whitespace
   |
59 |         This method provides the expected dict interface for routes while
60 |         leveraging the full power of COPPAValidator.
61 |         
   | ^^^^^^^^ W293
62 |         Args:
63 |             age: Child's age in years
   |
   = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:64:1: W293 Blank line contains whitespace
   |
62 |         Args:
63 |             age: Child's age in years
64 |             
   | ^^^^^^^^^^^^ W293
65 |         Returns:
66 |             Dict containing:
   |
   = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:82:1: W293 [*] Blank line contains whitespace
   |
80 |                     age=age
81 |                 )
82 |             
   | ^^^^^^^^^^^^ W293
83 |             # Get comprehensive validation from infrastructure
84 |             result: COPPAValidationResult = self._validator.validate_age_compliance(age)
   |
   = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:85:1: W293 [*] Blank line contains whitespace
   |
83 |             # Get comprehensive validation from infrastructure
84 |             result: COPPAValidationResult = self._validator.validate_age_compliance(age)
85 |             
   | ^^^^^^^^^^^^ W293
86 |             # Convert to expected format with full context
87 |             response = self._convert_validation_result(result, age)
   |
   = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:88:1: W293 [*] Blank line contains whitespace
   |
86 |             # Convert to expected format with full context
87 |             response = self._convert_validation_result(result, age)
88 |             
   | ^^^^^^^^^^^^ W293
89 |             # Log for audit trail
90 |             self._log_validation(age, response)
   |
   = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:91:1: W293 [*] Blank line contains whitespace
   |
89 |             # Log for audit trail
90 |             self._log_validation(age, response)
91 |             
   | ^^^^^^^^^^^^ W293
92 |             return response
   |
   = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:92:13: TRY300 Consider moving this statement to an `else` block
   |
90 |             self._log_validation(age, response)
91 |             
92 |             return response
   |             ^^^^^^^^^^^^^^^ TRY300
93 |             
94 |         except Exception as e:
   |

src/application/services/coppa/coppa_compliance_service.py:93:1: W293 [*] Blank line contains whitespace
   |
92 |             return response
93 |             
   | ^^^^^^^^^^^^ W293
94 |         except Exception as e:
95 |             logger.error(f"Critical error validating age {age}: {str(e)}", exc_info=True)
   |
   = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:95:66: RUF010 [*] Use explicit conversion flag
   |
94 |         except Exception as e:
95 |             logger.error(f"Critical error validating age {age}: {str(e)}", exc_info=True)
   |                                                                  ^^^^^^ RUF010
96 |             return self._create_error_response(
97 |                 f"System error during validation: {str(e)}",
   |
   = help: Replace with conversion flag

src/application/services/coppa/coppa_compliance_service.py:95:89: E501 Line too long (89 > 88)
   |
94 |         except Exception as e:
95 |             logger.error(f"Critical error validating age {age}: {str(e)}", exc_info=True)
   |                                                                                         ^ E501
96 |             return self._create_error_response(
97 |                 f"System error during validation: {str(e)}",
   |

src/application/services/coppa/coppa_compliance_service.py:97:52: RUF010 [*] Use explicit conversion flag
   |
95 |             logger.error(f"Critical error validating age {age}: {str(e)}", exc_info=True)
96 |             return self._create_error_response(
97 |                 f"System error during validation: {str(e)}",
   |                                                    ^^^^^^ RUF010
98 |                 severity="high",
99 |                 age=age
   |
   = help: Replace with conversion flag

src/application/services/coppa/coppa_compliance_service.py:101:1: W293 [*] Blank line contains whitespace
    |
 99 |                 age=age
100 |             )
101 |     
    | ^^^^ W293
102 |     def _convert_validation_result(self, result: COPPAValidationResult, age: int) -> Dict[str, Any]:
103 |         """Convert COPPAValidationResult to comprehensive dict format.
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:102:9: PLR0911 Too many return statements (7 > 6)
    |
100 |             )
101 |     
102 |     def _convert_validation_result(self, result: COPPAValidationResult, age: int) -> Dict[str, Any]:
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^ PLR0911
103 |         """Convert COPPAValidationResult to comprehensive dict format.
    |

src/application/services/coppa/coppa_compliance_service.py:102:86: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
100 |             )
101 |     
102 |     def _convert_validation_result(self, result: COPPAValidationResult, age: int) -> Dict[str, Any]:
    |                                                                                      ^^^^ UP006
103 |         """Convert COPPAValidationResult to comprehensive dict format.
    |
    = help: Replace with `dict`

src/application/services/coppa/coppa_compliance_service.py:102:89: E501 Line too long (100 > 88)
    |
100 |             )
101 |     
102 |     def _convert_validation_result(self, result: COPPAValidationResult, age: int) -> Dict[str, Any]:
    |                                                                                         ^^^^^^^^^^^^ E501
103 |         """Convert COPPAValidationResult to comprehensive dict format.
    |

src/application/services/coppa/coppa_compliance_service.py:104:1: W293 Blank line contains whitespace
    |
102 |     def _convert_validation_result(self, result: COPPAValidationResult, age: int) -> Dict[str, Any]:
103 |         """Convert COPPAValidationResult to comprehensive dict format.
104 |         
    | ^^^^^^^^ W293
105 |         This method handles all edge cases and provides detailed responses
106 |         for every scenario.
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:122:1: W293 [*] Blank line contains whitespace
    |
120 |                 }
121 |             }
122 |         
    | ^^^^^^^^ W293
123 |         if age == 0:
124 |             return {
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:136:1: W293 [*] Blank line contains whitespace
    |
134 |                 }
135 |             }
136 |         
    | ^^^^^^^^ W293
137 |         # Too young (under minimum age)
138 |         if age < self._validator.MIN_CHILD_AGE:
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:154:1: W293 [*] Blank line contains whitespace
    |
152 |                 }
153 |             }
154 |         
    | ^^^^^^^^ W293
155 |         # COPPA compliant age range (3-12)
156 |         if self._validator.MIN_CHILD_AGE <= age < self._validator.COPPA_AGE_LIMIT:
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:173:1: W293 [*] Blank line contains whitespace
    |
171 |                 }
172 |             }
173 |         
    | ^^^^^^^^ W293
174 |         # Exactly at COPPA limit (13)
175 |         if age == self._validator.COPPA_AGE_LIMIT:
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:189:1: W293 [*] Blank line contains whitespace
    |
187 |                 }
188 |             }
189 |         
    | ^^^^^^^^ W293
190 |         # Over COPPA limit
191 |         if age > self._validator.COPPA_AGE_LIMIT:
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:205:1: W293 [*] Blank line contains whitespace
    |
203 |                 }
204 |             }
205 |         
    | ^^^^^^^^ W293
206 |         # Fallback for any edge cases
207 |         return {
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:219:1: W293 [*] Blank line contains whitespace
    |
217 |             }
218 |         }
219 |     
    | ^^^^ W293
220 |     async def create_consent_record(
221 |         self, 
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:221:14: W291 [*] Trailing whitespace
    |
220 |     async def create_consent_record(
221 |         self, 
    |              ^ W291
222 |         consent_data: Dict[str, Any], 
223 |         ip_address: Optional[str] = None
    |
    = help: Remove trailing whitespace

src/application/services/coppa/coppa_compliance_service.py:222:23: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
220 |     async def create_consent_record(
221 |         self, 
222 |         consent_data: Dict[str, Any], 
    |                       ^^^^ UP006
223 |         ip_address: Optional[str] = None
224 |     ) -> Dict[str, Any]:
    |
    = help: Replace with `dict`

src/application/services/coppa/coppa_compliance_service.py:222:38: W291 [*] Trailing whitespace
    |
220 |     async def create_consent_record(
221 |         self, 
222 |         consent_data: Dict[str, Any], 
    |                                      ^ W291
223 |         ip_address: Optional[str] = None
224 |     ) -> Dict[str, Any]:
    |
    = help: Remove trailing whitespace

src/application/services/coppa/coppa_compliance_service.py:223:21: UP045 [*] Use `X | None` for type annotations
    |
221 |         self, 
222 |         consent_data: Dict[str, Any], 
223 |         ip_address: Optional[str] = None
    |                     ^^^^^^^^^^^^^ UP045
224 |     ) -> Dict[str, Any]:
225 |         """Create a comprehensive parental consent record.
    |
    = help: Convert to `X | None`

src/application/services/coppa/coppa_compliance_service.py:224:10: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
222 |         consent_data: Dict[str, Any], 
223 |         ip_address: Optional[str] = None
224 |     ) -> Dict[str, Any]:
    |          ^^^^ UP006
225 |         """Create a comprehensive parental consent record.
    |
    = help: Replace with `dict`

src/application/services/coppa/coppa_compliance_service.py:226:1: W293 Blank line contains whitespace
    |
224 |     ) -> Dict[str, Any]:
225 |         """Create a comprehensive parental consent record.
226 |         
    | ^^^^^^^^ W293
227 |         This method creates a full consent record with proper verification
228 |         and audit trail.
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:229:1: W293 Blank line contains whitespace
    |
227 |         This method creates a full consent record with proper verification
228 |         and audit trail.
229 |         
    | ^^^^^^^^ W293
230 |         Args:
231 |             consent_data: Dict containing:
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:240:1: W293 Blank line contains whitespace
    |
238 |                 - consent_types: List of consent types requested
239 |             ip_address: IP address for audit trail
240 |             
    | ^^^^^^^^^^^^ W293
241 |         Returns:
242 |             Dict with consent creation results
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:250:1: W293 [*] Blank line contains whitespace
    |
248 |                 'child_id', 'child_name', 'child_age'
249 |             ]
250 |             
    | ^^^^^^^^^^^^ W293
251 |             missing_fields = [f for f in required_fields if f not in consent_data]
252 |             if missing_fields:
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:253:17: TRY301 Abstract `raise` to an inner function
    |
251 |             missing_fields = [f for f in required_fields if f not in consent_data]
252 |             if missing_fields:
253 |                 raise ValidationError(f"Missing required fields: {missing_fields}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
254 |             
255 |             # Validate child age for COPPA
    |

src/application/services/coppa/coppa_compliance_service.py:253:23: TRY003 Avoid specifying long messages outside the exception class
    |
251 |             missing_fields = [f for f in required_fields if f not in consent_data]
252 |             if missing_fields:
253 |                 raise ValidationError(f"Missing required fields: {missing_fields}")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
254 |             
255 |             # Validate child age for COPPA
    |

src/application/services/coppa/coppa_compliance_service.py:254:1: W293 [*] Blank line contains whitespace
    |
252 |             if missing_fields:
253 |                 raise ValidationError(f"Missing required fields: {missing_fields}")
254 |             
    | ^^^^^^^^^^^^ W293
255 |             # Validate child age for COPPA
256 |             age_validation = await self.validate_child_age(consent_data['child_age'])
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:258:17: TRY301 Abstract `raise` to an inner function
    |
256 |               age_validation = await self.validate_child_age(consent_data['child_age'])
257 |               if not age_validation.get('compliant'):
258 | /                 raise ConsentError(
259 | |                     f"Cannot create consent for non-compliant age: {age_validation.get('reason')}"
260 | |                 )
    | |_________________^ TRY301
261 |               
262 |               # Determine consent types needed based on age
    |

src/application/services/coppa/coppa_compliance_service.py:258:23: TRY003 Avoid specifying long messages outside the exception class
    |
256 |               age_validation = await self.validate_child_age(consent_data['child_age'])
257 |               if not age_validation.get('compliant'):
258 |                   raise ConsentError(
    |  _______________________^
259 | |                     f"Cannot create consent for non-compliant age: {age_validation.get('reason')}"
260 | |                 )
    | |_________________^ TRY003
261 |               
262 |               # Determine consent types needed based on age
    |

src/application/services/coppa/coppa_compliance_service.py:259:89: E501 Line too long (98 > 88)
    |
257 |             if not age_validation.get('compliant'):
258 |                 raise ConsentError(
259 |                     f"Cannot create consent for non-compliant age: {age_validation.get('reason')}"
    |                                                                                         ^^^^^^^^^^ E501
260 |                 )
    |

src/application/services/coppa/coppa_compliance_service.py:261:1: W293 [*] Blank line contains whitespace
    |
259 |                     f"Cannot create consent for non-compliant age: {age_validation.get('reason')}"
260 |                 )
261 |             
    | ^^^^^^^^^^^^ W293
262 |             # Determine consent types needed based on age
263 |             consent_types = self._determine_required_consents(consent_data['child_age'])
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:264:1: W293 [*] Blank line contains whitespace
    |
262 |             # Determine consent types needed based on age
263 |             consent_types = self._determine_required_consents(consent_data['child_age'])
264 |             
    | ^^^^^^^^^^^^ W293
265 |             # Create consent records for each type
266 |             consent_records = []
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:269:1: W293 [*] Blank line contains whitespace
    |
267 |             for consent_type in consent_types:
268 |                 consent_id = f"consent_{uuid4().hex}"
269 |                 
    | ^^^^^^^^^^^^^^^^ W293
270 |                 record = ConsentRecord(
271 |                     consent_id=consent_id,
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:270:17: F841 Local variable `record` is assigned to but never used
    |
268 |                 consent_id = f"consent_{uuid4().hex}"
269 |                 
270 |                 record = ConsentRecord(
    |                 ^^^^^^ F841
271 |                     consent_id=consent_id,
272 |                     child_id=consent_data['child_id'],
    |
    = help: Remove assignment to unused variable `record`

src/application/services/coppa/coppa_compliance_service.py:277:89: E501 Line too long (89 > 88)
    |
275 |                     status=ConsentStatus.PENDING,
276 |                     verification_method="email",
277 |                     consent_text=self._generate_consent_text(consent_type, consent_data),
    |                                                                                         ^ E501
278 |                     metadata={
279 |                         "parent_name": consent_data['parent_name'],
    |

src/application/services/coppa/coppa_compliance_service.py:288:1: W293 [*] Blank line contains whitespace
    |
286 |                     }
287 |                 )
288 |                 
    | ^^^^^^^^^^^^^^^^ W293
289 |                 # Use the consent service to create the record
290 |                 result = await self._consent_service.request_consent(
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:296:1: W293 [*] Blank line contains whitespace
    |
294 |                     expiry_days=365
295 |                 )
296 |                 
    | ^^^^^^^^^^^^^^^^ W293
297 |                 consent_records.append({
298 |                     "consent_id": result['consent_id'],
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:302:1: W293 [*] Blank line contains whitespace
    |
300 |                     "status": result['status']
301 |                 })
302 |             
    | ^^^^^^^^^^^^ W293
303 |             # Log for audit
304 |             self._log_consent_creation(consent_data, consent_records)
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:305:1: W293 [*] Blank line contains whitespace
    |
303 |             # Log for audit
304 |             self._log_consent_creation(consent_data, consent_records)
305 |             
    | ^^^^^^^^^^^^ W293
306 |             return {
307 |                 "success": True,
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:314:1: W293 [*] Blank line contains whitespace
    |
312 |                 "next_steps": "Parent will receive verification email"
313 |             }
314 |             
    | ^^^^^^^^^^^^ W293
315 |         except (ValidationError, ConsentError) as e:
316 |             logger.warning(f"Consent creation validation error: {str(e)}")
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:316:66: RUF010 [*] Use explicit conversion flag
    |
315 |         except (ValidationError, ConsentError) as e:
316 |             logger.warning(f"Consent creation validation error: {str(e)}")
    |                                                                  ^^^^^^ RUF010
317 |             return {
318 |                 "success": False,
    |
    = help: Replace with conversion flag

src/application/services/coppa/coppa_compliance_service.py:323:62: RUF010 [*] Use explicit conversion flag
    |
321 |             }
322 |         except Exception as e:
323 |             logger.error(f"Critical error creating consent: {str(e)}", exc_info=True)
    |                                                              ^^^^^^ RUF010
324 |             return {
325 |                 "success": False,
    |
    = help: Replace with conversion flag

src/application/services/coppa/coppa_compliance_service.py:329:1: W293 [*] Blank line contains whitespace
    |
327 |                 "error_type": "system_error"
328 |             }
329 |     
    | ^^^^ W293
330 |     def _determine_required_consents(self, age: int) -> List[ConsentType]:
331 |         """Determine which consent types are required based on age."""
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:330:57: UP006 [*] Use `list` instead of `List` for type annotation
    |
328 |             }
329 |     
330 |     def _determine_required_consents(self, age: int) -> List[ConsentType]:
    |                                                         ^^^^ UP006
331 |         """Determine which consent types are required based on age."""
332 |         if age < self._validator.COPPA_AGE_LIMIT:
    |
    = help: Replace with `list`

src/application/services/coppa/coppa_compliance_service.py:341:1: W293 [*] Blank line contains whitespace
    |
339 |             ]
340 |         return []
341 |     
    | ^^^^ W293
342 |     def _generate_consent_text(self, consent_type: ConsentType, data: Dict[str, Any]) -> str:
343 |         """Generate appropriate consent text based on type."""
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:342:71: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
340 |         return []
341 |     
342 |     def _generate_consent_text(self, consent_type: ConsentType, data: Dict[str, Any]) -> str:
    |                                                                       ^^^^ UP006
343 |         """Generate appropriate consent text based on type."""
344 |         templates = {
    |
    = help: Replace with `dict`

src/application/services/coppa/coppa_compliance_service.py:342:89: E501 Line too long (93 > 88)
    |
340 |         return []
341 |     
342 |     def _generate_consent_text(self, consent_type: ConsentType, data: Dict[str, Any]) -> str:
    |                                                                                         ^^^^^ E501
343 |         """Generate appropriate consent text based on type."""
344 |         templates = {
    |

src/application/services/coppa/coppa_compliance_service.py:367:1: W293 [*] Blank line contains whitespace
    |
365 |         }
366 |         return templates.get(consent_type, f"Consent for {consent_type.value}")
367 |     
    | ^^^^ W293
368 |     def _create_error_response(self, reason: str, severity: str, **kwargs) -> Dict[str, Any]:
369 |         """Create standardized error response."""
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:368:79: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
366 |         return templates.get(consent_type, f"Consent for {consent_type.value}")
367 |     
368 |     def _create_error_response(self, reason: str, severity: str, **kwargs) -> Dict[str, Any]:
    |                                                                               ^^^^ UP006
369 |         """Create standardized error response."""
370 |         return {
    |
    = help: Replace with `dict`

src/application/services/coppa/coppa_compliance_service.py:368:89: E501 Line too long (93 > 88)
    |
366 |         return templates.get(consent_type, f"Consent for {consent_type.value}")
367 |     
368 |     def _create_error_response(self, reason: str, severity: str, **kwargs) -> Dict[str, Any]:
    |                                                                                         ^^^^^ E501
369 |         """Create standardized error response."""
370 |         return {
    |

src/application/services/coppa/coppa_compliance_service.py:382:1: W293 [*] Blank line contains whitespace
    |
380 |             }
381 |         }
382 |     
    | ^^^^ W293
383 |     def _log_validation(self, age: int, response: Dict[str, Any]) -> None:
384 |         """Log validation for audit trail."""
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:383:51: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
381 |         }
382 |     
383 |     def _log_validation(self, age: int, response: Dict[str, Any]) -> None:
    |                                                   ^^^^ UP006
384 |         """Log validation for audit trail."""
385 |         self._audit_log.append({
    |
    = help: Replace with `dict`

src/application/services/coppa/coppa_compliance_service.py:392:1: W293 [*] Blank line contains whitespace
    |
390 |             "timestamp": datetime.utcnow().isoformat()
391 |         })
392 |     
    | ^^^^ W293
393 |     def _log_consent_creation(self, consent_data: Dict[str, Any], records: List[Dict]) -> None:
394 |         """Log consent creation for audit trail."""
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:393:51: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
391 |         })
392 |     
393 |     def _log_consent_creation(self, consent_data: Dict[str, Any], records: List[Dict]) -> None:
    |                                                   ^^^^ UP006
394 |         """Log consent creation for audit trail."""
395 |         self._audit_log.append({
    |
    = help: Replace with `dict`

src/application/services/coppa/coppa_compliance_service.py:393:76: UP006 [*] Use `list` instead of `List` for type annotation
    |
391 |         })
392 |     
393 |     def _log_consent_creation(self, consent_data: Dict[str, Any], records: List[Dict]) -> None:
    |                                                                            ^^^^ UP006
394 |         """Log consent creation for audit trail."""
395 |         self._audit_log.append({
    |
    = help: Replace with `list`

src/application/services/coppa/coppa_compliance_service.py:393:81: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
391 |         })
392 |     
393 |     def _log_consent_creation(self, consent_data: Dict[str, Any], records: List[Dict]) -> None:
    |                                                                                 ^^^^ UP006
394 |         """Log consent creation for audit trail."""
395 |         self._audit_log.append({
    |
    = help: Replace with `dict`

src/application/services/coppa/coppa_compliance_service.py:393:89: E501 Line too long (95 > 88)
    |
391 |         })
392 |     
393 |     def _log_consent_creation(self, consent_data: Dict[str, Any], records: List[Dict]) -> None:
    |                                                                                         ^^^^^^^ E501
394 |         """Log consent creation for audit trail."""
395 |         self._audit_log.append({
    |

src/application/services/coppa/coppa_compliance_service.py:402:1: W293 [*] Blank line contains whitespace
    |
400 |             "timestamp": datetime.utcnow().isoformat()
401 |         })
402 |     
    | ^^^^ W293
403 |     async def get_compliance_status(self, child_id: str) -> Dict[str, Any]:
404 |         """Get comprehensive compliance status for a child."""
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:403:61: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
401 |         })
402 |     
403 |     async def get_compliance_status(self, child_id: str) -> Dict[str, Any]:
    |                                                             ^^^^ UP006
404 |         """Get comprehensive compliance status for a child."""
405 |         # This would integrate with database to get full status
    |
    = help: Replace with `dict`

src/application/services/coppa/coppa_compliance_service.py:412:1: W293 [*] Blank line contains whitespace
    |
410 |             "last_review": datetime.utcnow().isoformat()
411 |         }
412 |     
    | ^^^^ W293
413 |     def get_audit_log(self) -> List[Dict[str, Any]]:
414 |         """Get audit log for compliance tracking."""
    |
    = help: Remove whitespace from blank line

src/application/services/coppa/coppa_compliance_service.py:413:32: UP006 [*] Use `list` instead of `List` for type annotation
    |
411 |         }
412 |     
413 |     def get_audit_log(self) -> List[Dict[str, Any]]:
    |                                ^^^^ UP006
414 |         """Get audit log for compliance tracking."""
415 |         return self._audit_log.copy()
    |
    = help: Replace with `list`

src/application/services/coppa/coppa_compliance_service.py:413:37: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
411 |         }
412 |     
413 |     def get_audit_log(self) -> List[Dict[str, Any]]:
    |                                     ^^^^ UP006
414 |         """Get audit log for compliance tracking."""
415 |         return self._audit_log.copy()
    |
    = help: Replace with `dict`

src/application/services/data_export/formatters.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Data Export Formatters
2 | | Provides different formatters for exporting child data in various formats.
3 | | """
  | |___^ D205
4 |
5 |   import csv
  |
  = help: Insert single blank line

src/application/services/data_export/formatters.py:63:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
61 |             return json_str.encode("utf-8")
62 |         except Exception as e:
63 |             logger.error(f"Error formatting JSON data: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
64 |             raise ValueError(f"Failed to format data as JSON: {e}")
   |
   = help: Replace with `exception`

src/application/services/data_export/formatters.py:64:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
62 |         except Exception as e:
63 |             logger.error(f"Error formatting JSON data: {e}")
64 |             raise ValueError(f"Failed to format data as JSON: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
65 |
66 |     def _json_serializer(self, obj):
   |

src/application/services/data_export/formatters.py:64:19: TRY003 Avoid specifying long messages outside the exception class
   |
62 |         except Exception as e:
63 |             logger.error(f"Error formatting JSON data: {e}")
64 |             raise ValueError(f"Failed to format data as JSON: {e}")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
65 |
66 |     def _json_serializer(self, obj):
   |

src/application/services/data_export/formatters.py:70:15: TRY003 Avoid specifying long messages outside the exception class
   |
68 |         if isinstance(obj, datetime):
69 |             return obj.isoformat()
70 |         raise TypeError(f"Object of type {type(obj)} is not JSON serializable")
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
71 |
72 |     def get_file_extension(self) -> str:
   |

src/application/services/data_export/formatters.py:82:9: PLR0912 Too many branches (14 > 12)
   |
80 |     """Formats data as CSV."""
81 |
82 |     def format_data(self, data: dict[str, Any]) -> bytes:
   |         ^^^^^^^^^^^ PLR0912
83 |         """Format data as CSV."""
84 |         try:
   |

src/application/services/data_export/formatters.py:130:29: PLW2901 `for` loop variable `value` overwritten by assignment target
    |
128 |                     for key, value in records.items():
129 |                         if isinstance(value, datetime):
130 |                             value = value.isoformat()
    |                             ^^^^^ PLW2901
131 |                         writer.writerow([key, str(value) if value is not None else ""])
    |

src/application/services/data_export/formatters.py:137:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
135 |             return output.getvalue().encode("utf-8")
136 |         except Exception as e:
137 |             logger.error(f"Error formatting CSV data: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
138 |             raise ValueError(f"Failed to format data as CSV: {e}")
    |
    = help: Replace with `exception`

src/application/services/data_export/formatters.py:138:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
136 |         except Exception as e:
137 |             logger.error(f"Error formatting CSV data: {e}")
138 |             raise ValueError(f"Failed to format data as CSV: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
139 |
140 |     def get_file_extension(self) -> str:
    |

src/application/services/data_export/formatters.py:138:19: TRY003 Avoid specifying long messages outside the exception class
    |
136 |         except Exception as e:
137 |             logger.error(f"Error formatting CSV data: {e}")
138 |             raise ValueError(f"Failed to format data as CSV: {e}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
139 |
140 |     def get_file_extension(self) -> str:
    |

src/application/services/data_export/formatters.py:201:13: TRY300 Consider moving this statement to an `else` block
    |
199 |             # Generate XML string
200 |             xml_str = ET.tostring(root, encoding="utf-8", xml_declaration=True)
201 |             return xml_str
    |             ^^^^^^^^^^^^^^ TRY300
202 |         except Exception as e:
203 |             logger.error(f"Error formatting XML data: {e}")
    |

src/application/services/data_export/formatters.py:201:20: RET504 Unnecessary assignment to `xml_str` before `return` statement
    |
199 |             # Generate XML string
200 |             xml_str = ET.tostring(root, encoding="utf-8", xml_declaration=True)
201 |             return xml_str
    |                    ^^^^^^^ RET504
202 |         except Exception as e:
203 |             logger.error(f"Error formatting XML data: {e}")
    |
    = help: Remove unnecessary assignment

src/application/services/data_export/formatters.py:203:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
201 |             return xml_str
202 |         except Exception as e:
203 |             logger.error(f"Error formatting XML data: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
204 |             raise ValueError(f"Failed to format data as XML: {e}")
    |
    = help: Replace with `exception`

src/application/services/data_export/formatters.py:204:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
202 |         except Exception as e:
203 |             logger.error(f"Error formatting XML data: {e}")
204 |             raise ValueError(f"Failed to format data as XML: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
205 |
206 |     def _add_dict_to_element(self, parent: ET.Element, data: dict) -> None:
    |

src/application/services/data_export/formatters.py:204:19: TRY003 Avoid specifying long messages outside the exception class
    |
202 |         except Exception as e:
203 |             logger.error(f"Error formatting XML data: {e}")
204 |             raise ValueError(f"Failed to format data as XML: {e}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
205 |
206 |     def _add_dict_to_element(self, parent: ET.Element, data: dict) -> None:
    |

src/application/services/data_export/formatters.py:258:89: E501 Line too long (105 > 88)
    |
256 |                     try:
257 |                         formatted_data = formatter.format_data(data)
258 |                         filename = f"child_data_{self.metadata.child_id}{formatter.get_file_extension()}"
    |                                                                                         ^^^^^^^^^^^^^^^^^ E501
259 |                         zip_file.writestr(filename, formatted_data)
260 |                     except Exception as e:
    |

src/application/services/data_export/formatters.py:262:89: E501 Line too long (92 > 88)
    |
260 |                     except Exception as e:
261 |                         logger.warning(
262 |                             f"Failed to add {formatter.__class__.__name__} to archive: {e}",
    |                                                                                         ^^^^ E501
263 |                         )
264 |                         # Continue with other formats
    |

src/application/services/data_export/formatters.py:269:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
267 |             return buffer.getvalue()
268 |         except Exception as e:
269 |             logger.error(f"Error creating archive: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
270 |             raise ValueError(f"Failed to create data archive: {e}")
    |
    = help: Replace with `exception`

src/application/services/data_export/formatters.py:270:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
268 |         except Exception as e:
269 |             logger.error(f"Error creating archive: {e}")
270 |             raise ValueError(f"Failed to create data archive: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
271 |
272 |     def _generate_readme(self) -> str:
    |

src/application/services/data_export/formatters.py:270:19: TRY003 Avoid specifying long messages outside the exception class
    |
268 |         except Exception as e:
269 |             logger.error(f"Error creating archive: {e}")
270 |             raise ValueError(f"Failed to create data archive: {e}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
271 |
272 |     def _generate_readme(self) -> str:
    |

src/application/services/data_export/formatters.py:333:19: TRY003 Avoid specifying long messages outside the exception class
    |
331 |         formatter_class = formatters.get(format_type)
332 |         if not formatter_class:
333 |             raise ValueError(f"Unsupported export format: {format_type}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
334 |
335 |         return formatter_class(metadata)
    |

src/application/services/data_export/types.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Data Export Types and Models
2 | | Defines data structures and enums for the data export system.
3 | | """
  | |___^ D205
4 |
5 |   from dataclasses import dataclass
  |
  = help: Insert single blank line

src/application/services/data_export_service.py:35:34: B008 Do not perform function call `get_logger` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
33 |         self,
34 |         storage_path: str = "exports",
35 |         logger: logging.Logger = get_logger(__name__, component="data_export_service"),
   |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
36 |     ) -> None:
37 |         """Initializes the data export service.
   |

src/application/services/data_export_service.py:53:89: E501 Line too long (93 > 88)
   |
52 |     def _sanitize_data_for_export(self, data: dict[str, Any]) -> dict[str, Any]:
53 |         """Recursively sanitizes sensitive data fields before export to prevent PII exposure.
   |                                                                                         ^^^^^ E501
54 |
55 |         Args:
   |

src/application/services/data_export_service.py:148:19: TRY003 Avoid specifying long messages outside the exception class
    |
146 |         """
147 |         if request.end_date < request.start_date:
148 |             raise ValueError("End date cannot be before start date.")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
149 |
150 |         if (request.end_date - request.start_date).days > EXPORT_LIMITS[
    |

src/application/services/data_export_service.py:153:19: TRY003 Avoid specifying long messages outside the exception class
    |
151 |               "max_days_range"
152 |           ]:
153 |               raise ValueError(
    |  ___________________^
154 | |                 f"Date range exceeds maximum allowed {EXPORT_LIMITS['max_days_range']} days.",
155 | |             )
    | |_____________^ TRY003
156 |
157 |           if len(request.data_categories) > EXPORT_LIMITS["max_categories"]:
    |

src/application/services/data_export_service.py:154:89: E501 Line too long (94 > 88)
    |
152 |         ]:
153 |             raise ValueError(
154 |                 f"Date range exceeds maximum allowed {EXPORT_LIMITS['max_days_range']} days.",
    |                                                                                         ^^^^^^ E501
155 |             )
    |

src/application/services/data_export_service.py:158:19: TRY003 Avoid specifying long messages outside the exception class
    |
157 |           if len(request.data_categories) > EXPORT_LIMITS["max_categories"]:
158 |               raise ValueError(
    |  ___________________^
159 | |                 f"Too many data categories requested. Max: {EXPORT_LIMITS['max_categories']}.",
160 | |             )
    | |_____________^ TRY003
161 |
162 |       def _simulate_export(self, request: ExportRequest) -> str:
    |

src/application/services/data_export_service.py:159:89: E501 Line too long (95 > 88)
    |
157 |         if len(request.data_categories) > EXPORT_LIMITS["max_categories"]:
158 |             raise ValueError(
159 |                 f"Too many data categories requested. Max: {EXPORT_LIMITS['max_categories']}.",
    |                                                                                         ^^^^^^^ E501
160 |             )
    |

src/application/services/data_export_service.py:195:16: RET504 Unnecessary assignment to `file_path` before `return` statement
    |
193 |             sanitized_dummy_data,
194 |         )
195 |         return file_path
    |                ^^^^^^^^^ RET504
    |
    = help: Remove unnecessary assignment

src/application/services/dynamic_content_service.py:9:1: I001 [*] Import block is un-sorted or un-formatted
   |
 7 |   """
 8 |
 9 | / from typing import Any
10 | |
11 | | from src.application.interfaces.read_model_interfaces import (
12 | |     IExternalAPIClient,
13 | |     get_external_api_client,
14 | | )
15 | | from src.application.interfaces.safety_monitor import SafetyMonitor
16 | | from src.domain.entities.child_profile import ChildProfile
17 | | from src.domain.value_objects.safety_level import SafetyLevel
18 | |
19 | | from src.infrastructure.logging_config import get_logger
   | |________________________________________________________^ I001
20 |
21 |   logger = get_logger(__name__, component="dynamic_content_service")
   |
   = help: Organize imports

src/application/services/dynamic_story_service.py:54:89: E501 Line too long (111 > 88)
   |
52 |             f"{child_preferences.learning_level}."
53 |         )
54 |         # Use a dummy child_id and conversation_history for story generation, as it's not a direct conversation
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^ E501
55 |         # The AIProvider interface expects these, but they might not be strictly relevant for story generation.
56 |         # A more refined AIProvider might have a separate method for creative
   |

src/application/services/dynamic_story_service.py:55:89: E501 Line too long (111 > 88)
   |
53 |         )
54 |         # Use a dummy child_id and conversation_history for story generation, as it's not a direct conversation
55 |         # The AIProvider interface expects these, but they might not be strictly relevant for story generation.
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^ E501
56 |         # A more refined AIProvider might have a separate method for creative
57 |         # content generation.
   |

src/application/services/dynamic_story_service.py:64:16: RET504 Unnecessary assignment to `story_content` before `return` statement
   |
62 |             child_preferences=child_preferences,
63 |         )
64 |         return story_content
   |                ^^^^^^^^^^^^^ RET504
   |
   = help: Remove unnecessary assignment

src/application/services/esp32_device_service.py:39:89: E501 Line too long (96 > 88)
   |
37 |         Args:
38 |             event_bus: An optional event bus for publishing events.
39 |             device_authenticator: An optional device authenticator for validating device access.
   |                                                                                         ^^^^^^^^ E501
40 |
41 |         """
   |

src/application/services/esp32_device_service.py:90:89: E501 Line too long (89 > 88)
   |
88 |         # Process voice command (e.g., send to AI for response generation)
89 |         self.logger.info(
90 |             f"Processing voice command from {command.device_id}: {command.command_text}",
   |                                                                                         ^ E501
91 |         )
92 |         # Example: Publish an event for AI processing
   |

src/application/services/esp32_device_service.py:115:89: E501 Line too long (89 > 88)
    |
113 |         # Process gesture event (e.g., trigger a specific action on the bear)
114 |         self.logger.info(
115 |             f"Processing gesture event from {gesture.device_id}: {gesture.gesture_type}",
    |                                                                                         ^ E501
116 |         )
117 |         # Example: Publish an event for gesture interpretation
    |

src/application/services/esp32_device_service.py:138:89: E501 Line too long (95 > 88)
    |
136 |         ):
137 |             self.logger.warning(
138 |                 f"Unauthorized firmware update status attempt from device: {status.device_id}",
    |                                                                                         ^^^^^^^ E501
139 |             )
140 |             return
    |

src/application/services/esp32_device_service.py:143:89: E501 Line too long (90 > 88)
    |
141 |         # Update firmware status in database or notify relevant service
142 |         self.logger.info(
143 |             f"Processing firmware update status from {status.device_id}: {status.status}",
    |                                                                                         ^^ E501
144 |         )
    |

src/application/services/esp32_device_service.py:160:89: E501 Line too long (93 > 88)
    |
158 |         ):
159 |             self.logger.warning(
160 |                 f"Unauthorized device status update attempt from device: {status.device_id}",
    |                                                                                         ^^^^^ E501
161 |             )
162 |             return
    |

src/application/services/feature_service.py:33:89: E501 Line too long (89 > 88)
   |
32 |     def __init__(self, logger: logging.Logger = logger) -> None:
33 |         """Initializes the feature service with default features and age restrictions."""
   |                                                                                         ^ E501
34 |         self.logger = logger
35 |         # Default safe features for all children
   |

src/application/services/feature_service.py:97:89: E501 Line too long (100 > 88)
   |
95 |                     return {
96 |                         "success": False,
97 |                         "message": f"Child is too young for {feature_name}. Minimum age: {min_age}",
   |                                                                                         ^^^^^^^^^^^^ E501
98 |                     }
   |

src/application/services/feature_service.py:136:89: E501 Line too long (91 > 88)
    |
134 |             return {
135 |                 "success": False,
136 |                 "message": f"Feature {feature_type.value} is already disabled or unknown.",
    |                                                                                         ^^^ E501
137 |             }
    |

src/application/services/federated_learning_service.py:67:25: PLR2004 Magic value used in comparison, consider replacing `10.0` with a constant variable
   |
66 |         # Example: Simple check for excessively large gradients (simulated)
67 |         if any(abs(w) > 10.0 for w in local_model_update.get("weights", [])):
   |                         ^^^^ PLR2004
68 |             self.logger.warning(
69 |                 "Detected unusually large weights in model update. Potential privacy concern. Validation failed.",
   |

src/application/services/federated_learning_service.py:69:89: E501 Line too long (114 > 88)
   |
67 |         if any(abs(w) > 10.0 for w in local_model_update.get("weights", [])):
68 |             self.logger.warning(
69 |                 "Detected unusually large weights in model update. Potential privacy concern. Validation failed.",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
70 |             )
71 |             return False
   |

src/application/services/federated_learning_service.py:103:89: E501 Line too long (107 > 88)
    |
101 |         if not self._validate_model_update_for_privacy(local_model_update):
102 |             self.logger.warning(
103 |                 f"Rejecting local model update from device {device_id} due to privacy validation failure.",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^ E501
104 |             )
105 |             return
    |

src/application/services/federated_learning_service.py:108:89: E501 Line too long (89 > 88)
    |
107 |         self.logger.info(
108 |             f"Received local model update from device {device_id}: {local_model_update}",
    |                                                                                         ^ E501
109 |         )
110 |         # In a real federated learning setup, this would involve:
    |

src/application/services/interaction_service.py:73:19: TRY003 Avoid specifying long messages outside the exception class
   |
71 |         if not child_id or not isinstance(child_id, str):
72 |             self.logger.warning("Invalid child_id provided in process method.")
73 |             raise InvalidInputError("Valid child_id is required")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
74 |         if not message or not isinstance(message, str):
75 |             self.logger.warning(f"Invalid message provided for child {child_id}.")
   |

src/application/services/interaction_service.py:76:19: TRY003 Avoid specifying long messages outside the exception class
   |
74 |         if not message or not isinstance(message, str):
75 |             self.logger.warning(f"Invalid message provided for child {child_id}.")
76 |             raise InvalidInputError("Valid message is required")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
77 |         if len(message) > self.config.max_message_length:
78 |             self.logger.warning(
   |

src/application/services/interaction_service.py:81:19: TRY003 Avoid specifying long messages outside the exception class
   |
79 |                   f"Message from child {child_id} too long (length: {len(message)}).",
80 |               )
81 |               raise InvalidInputError(
   |  ___________________^
82 | |                 f"Message too long. Maximum {self.config.max_message_length} characters",
83 | |             )
   | |_____________^ TRY003
84 |
85 |           # Age verification before any processing
   |

src/application/services/interaction_service.py:82:89: E501 Line too long (89 > 88)
   |
80 |             )
81 |             raise InvalidInputError(
82 |                 f"Message too long. Maximum {self.config.max_message_length} characters",
   |                                                                                         ^ E501
83 |             )
   |

src/application/services/interaction_service.py:98:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
 96 |                 }
 97 |         except (ResourceNotFoundError, InvalidInputError) as e:
 98 |             self.logger.error(f"Age verification failed for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
 99 |             return {
100 |                 "success": False,
    |
    = help: Replace with `exception`

src/application/services/interaction_service.py:154:9: D205 1 blank line required between summary line and description
    |
153 |       async def _sanitize_message(self, message: str) -> str:
154 | /         """Sanitizes the message by removing potentially harmful characters or patterns
155 | |         using the injected sanitization service.
156 | |
157 | |         Args:
158 | |             message: The original message.
159 | |
160 | |         Returns:
161 | |             The sanitized message.
162 | |
163 | |         """
    | |___________^ D205
164 |           self.logger.debug(f"Sanitizing message: {message[:50]}...")
165 |           sanitized_message = await self.sanitization_service.sanitize_text(message)
    |
    = help: Insert single blank line

src/application/services/interaction_service.py:170:89: E501 Line too long (110 > 88)
    |
169 |     async def _check_content_safety(self, message: str) -> SafetyAnalysisResult:
170 |         """Checks the content of the message for safety and appropriateness using the injected safety monitor.
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^ E501
171 |
172 |         Args:
    |

src/application/services/interaction_service.py:210:19: TRY003 Avoid specifying long messages outside the exception class
    |
208 |                   "Cannot perform age check.",
209 |               )
210 |               raise ResourceNotFoundError(
    |  ___________________^
211 | |                 f"Child profile or age not found for child_id: {child_id}",
212 | |             )
    | |_____________^ TRY003
213 |
214 |           if not isinstance(child_age, int) or child_age < 0:
    |

src/application/services/interaction_service.py:218:19: TRY003 Avoid specifying long messages outside the exception class
    |
216 |                 f"Invalid child age retrieved for child {child_id}: {child_age}",
217 |             )
218 |             raise InvalidInputError(f"Invalid age format for child {child_id}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
219 |
220 |         is_age_valid = (
    |

src/application/services/notification_service.py:9:1: I001 [*] Import block is un-sorted or un-formatted
   |
 7 |   """
 8 |
 9 | / import logging
10 | | from datetime import UTC, datetime
11 | | from enum import Enum
12 | | from typing import Any
13 | | from uuid import uuid4
14 | |
15 | | from src.application.interfaces.safety_monitor import SafetyMonitor
16 | | from src.domain.exceptions.service_unavailable_error import (
17 | |     ServiceUnavailableError,
18 | | )
19 | | from src.domain.interfaces.notification_clients import (
20 | |     IEmailClient,
21 | |     IInAppNotifier,
22 | |     IPushNotifier,
23 | |     ISMSClient,
24 | | )
25 | | from src.domain.interfaces.notification_repository import (
26 | |     INotificationRepository,
27 | | )
28 | | from src.domain.value_objects.safety_level import SafetyLevel
29 | |
30 | | from src.domain.value_objects.notification import (
31 | |     NotificationRecord,
32 | |     NotificationStatus,
33 | | )
34 | | from src.infrastructure.config.notification_config import NotificationConfig
35 | | from src.infrastructure.logging_config import get_logger
   | |________________________________________________________^ I001
36 |
37 |   logger = get_logger(__name__, component="notification_service")
   |
   = help: Organize imports

src/application/services/notification_service.py:59:89: E501 Line too long (91 > 88)
   |
58 | class NotificationService:
59 |     """Service for handling various types of notifications to parents and system alerts."""
   |                                                                                         ^^^ E501
60 |
61 |     def __init__(
   |

src/application/services/notification_service.py:61:9: PLR0913 Too many arguments in function definition (8 > 5)
   |
59 |     """Service for handling various types of notifications to parents and system alerts."""
60 |
61 |     def __init__(
   |         ^^^^^^^^ PLR0913
62 |         self,
63 |         config: NotificationConfig,
   |

src/application/services/notification_service.py:72:89: E501 Line too long (101 > 88)
   |
70 |         safety_monitor: SafetyMonitor = None,
71 |     ) -> None:
72 |         """Initializes the notification service with configuration, repository, and external clients.
   |                                                                                         ^^^^^^^^^^^^^ E501
73 |
74 |         Args:
   |

src/application/services/notification_service.py:156:89: E501 Line too long (94 > 88)
    |
154 |             await self.repository.save_notification(notification_record)
155 |             self.logger.info(
156 |                 f"Notification {notification_id} queued for {recipient} via {channel.value}.",
    |                                                                                         ^^^^^^ E501
157 |             )
    |

src/application/services/notification_service.py:173:89: E501 Line too long (137 > 88)
    |
171 | …on(notification_record)
172 | …
173 | …sent to {recipient} via {channel.value} with status {notification_record.status.value}."
    |                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
174 | …
175 | …
    |

src/application/services/notification_service.py:209:89: E501 Line too long (91 > 88)
    |
208 |     async def _send_by_channel(self, notification: NotificationRecord) -> bool:
209 |         """Sends a notification through the specified channel using the appropriate client.
    |                                                                                         ^^^ E501
210 |
211 |         Args:
    |

src/application/services/notification_service.py:254:89: E501 Line too long (91 > 88)
    |
252 |                 )
253 |             self.logger.warning(
254 |                 f"Notification {notification_id}: Unknown notification channel: {channel}",
    |                                                                                         ^^^ E501
255 |             )
256 |             return False
    |

src/application/services/notification_service.py:256:13: TRY300 Consider moving this statement to an `else` block
    |
254 |                 f"Notification {notification_id}: Unknown notification channel: {channel}",
255 |             )
256 |             return False
    |             ^^^^^^^^^^^^ TRY300
257 |         except Exception as e:
258 |             self.logger.error(
    |

src/application/services/notification_service.py:269:89: E501 Line too long (91 > 88)
    |
267 |         recipient: str,
268 |     ) -> list[NotificationRecord]:
269 |         """Retrieves the notification history for a specific recipient from the repository.
    |                                                                                         ^^^ E501
270 |
271 |         Args:
    |

src/application/services/parent_child_verification_service.py:2:67: F401 [*] `src.application.services.consent.verification_service.VerificationService` imported but unused
  |
2 | from src.application.services.consent.verification_service import VerificationService
  |                                                                   ^^^^^^^^^^^^^^^^^^^ F401
3 |
4 | from .verification.relationship_manager import RelationshipManager
  |
  = help: Remove unused import: `src.application.services.consent.verification_service.VerificationService`

src/application/services/safety.py:7:89: E501 Line too long (111 > 88)
  |
5 | educational value evaluation. It is dependent on an `AIProvider` for core
6 | AI analysis capabilities and integrates with `PerformanceMonitor` for metrics.
7 | It ensures that all AI responses and user inputs adhere to strict child safety guidelines and COPPA compliance.
  |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^ E501
8 | """
  |

src/application/services/safety.py:45:89: E501 Line too long (93 > 88)
   |
43 |         Args:
44 |             config: Safety configuration with filtering rules and thresholds.
45 |             ai_provider: AI provider for advanced content analysis (toxicity, emotion, etc.).
   |                                                                                         ^^^^^ E501
46 |             performance_monitor: Centralized monitor for collecting metrics.
   |

src/application/services/safety.py:70:17: TRY301 Abstract `raise` to an inner function
   |
68 |             if not result or not isinstance(result, SafetyAnalysisResult):
69 |                 logger.error("Invalid SafetyAnalysisResult object provided")
70 |                 raise ValueError("Valid SafetyAnalysisResult required for analysis")
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
71 |
72 |             harmful_keywords = self.config.keyword_blacklist
   |

src/application/services/safety.py:70:23: TRY003 Avoid specifying long messages outside the exception class
   |
68 |             if not result or not isinstance(result, SafetyAnalysisResult):
69 |                 logger.error("Invalid SafetyAnalysisResult object provided")
70 |                 raise ValueError("Valid SafetyAnalysisResult required for analysis")
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
71 |
72 |             harmful_keywords = self.config.keyword_blacklist
   |

src/application/services/safety.py:308:9: D205 1 blank line required between summary line and description
    |
307 |       def get_metrics(self) -> dict[str, Any]:
308 | /         """Retrieves the current safety service metrics.
309 | |         These metrics are now collected and managed by the PerformanceMonitor.
310 | |
311 | |         Returns:
312 | |             An empty dictionary. Call PerformanceMonitor directly for comprehensive metrics.
313 | |
314 | |         """
    | |___________^ D205
315 |           self.logger.warning(
316 |               "SafetyService.get_metrics is deprecated. Use PerformanceMonitor directly for comprehensive metrics.",
    |
    = help: Insert single blank line

src/application/services/safety.py:312:89: E501 Line too long (92 > 88)
    |
311 |         Returns:
312 |             An empty dictionary. Call PerformanceMonitor directly for comprehensive metrics.
    |                                                                                         ^^^^ E501
313 |
314 |         """
    |

src/application/services/safety.py:316:89: E501 Line too long (114 > 88)
    |
314 |         """
315 |         self.logger.warning(
316 |             "SafetyService.get_metrics is deprecated. Use PerformanceMonitor directly for comprehensive metrics.",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
317 |         )
318 |         return {}
    |

src/application/services/session/__init__.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Async Session Management Package
2 | | Modular session management system with child safety and COPPA compliance.
3 | | """
  | |___^ D205
4 |
5 |   from .session_manager import AsyncSessionManager
  |
  = help: Insert single blank line

src/application/services/session/session_manager.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Clean, focused session management extracted from 426-line monolith.
2 | | Provides enterprise-grade session handling with child safety features.
3 | | """
  | |___^ D205
4 |
5 |   import asyncio
  |
  = help: Insert single blank line

src/application/services/session/session_manager.py:19:5: D205 1 blank line required between summary line and description
   |
18 |   class AsyncSessionManager:
19 | /     """Refactored from 426-line file into focused, maintainable components.
20 | |     Provides enterprise-grade session management with child safety features.
21 | |     Features:
22 | |     - Thread-safe session operations
23 | |     - Automatic expiration handling
24 | |     - Child safety monitoring
25 | |     - COPPA-compliant data handling
26 | |     - Performance optimized storage.
27 | |     """
   | |_______^ D205
28 |
29 |       def __init__(self, default_timeout_minutes: int = 30) -> None:
   |
   = help: Insert single blank line

src/application/services/session/session_manager.py:170:16: RET504 Unnecessary assignment to `active_sessions` before `return` statement
    |
168 |         ]
169 |
170 |         return active_sessions
    |                ^^^^^^^^^^^^^^^ RET504
171 |
172 |     async def get_session_stats(self) -> SessionStats:
    |
    = help: Remove unnecessary assignment

src/application/services/session/session_manager.py:214:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
212 |                 break
213 |             except Exception as e:
214 |                 logger.error(f"Error in session cleanup: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
215 |                 await asyncio.sleep(60)  # Wait before retrying
    |
    = help: Replace with `exception`

src/application/services/session/session_models.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Session Data Models
2 | | Defines core data structures for async session management.
3 | | """
  | |___^ D205
4 |
5 |   import uuid
  |
  = help: Insert single blank line

src/application/services/session/session_models.py:23:5: D205 1 blank line required between summary line and description
   |
21 |   @dataclass
22 |   class AsyncSessionData:
23 | /     """Features:
24 | |     - Automatic expiration tracking
25 | |     - Activity monitoring
26 | |     - Child safety score tracking
27 | |     - COPPA-compliant data handling.
28 | |     """
   | |_______^ D205
29 |
30 |       session_id: str = field(default_factory=lambda: str(uuid.uuid4()))
   |
   = help: Insert single blank line

src/application/services/session/session_storage.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Session Storage Manager
2 | | Handles persistent storage and retrieval of session data.
3 | | """
  | |___^ D205
4 |
5 |   import asyncio
  |
  = help: Insert single blank line

src/application/services/session/session_storage.py:15:89: E501 Line too long (108 > 88)
   |
14 | class SessionStorage:
15 |     """Manages session persistence with thread-safe operations and automatic cleanup of expired sessions."""
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^ E501
16 |
17 |     def __init__(self) -> None:
   |

src/application/services/session/session_storage.py:102:21: PERF401 Use a list comprehension to create a transformed list
    |
100 |             for session_id in self.child_sessions[child_id]:
101 |                 if session_id in self.sessions:
102 |                     sessions.append(self.sessions[session_id])
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PERF401
103 |
104 |             return sessions
    |
    = help: Replace for loop with list comprehension

src/application/services/verification/__init__.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Parent-Child Verification Package
2 | | Modular verification system for parent-child relationships with COPPA compliance.
3 | | """
  | |___^ D205
4 |
5 |   from .relationship_manager import RelationshipManager
  |
  = help: Insert single blank line

src/application/services/verification/relationship_manager.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Relationship Manager
2 | | Manages parent-child relationships with proper verification and audit trails.
3 | | """
  | |___^ D205
4 |
5 |   from datetime import datetime, timedelta
  |
  = help: Insert single blank line

src/application/services/verification/relationship_manager.py:22:89: E501 Line too long (131 > 88)
   |
21 | class RelationshipManager:
22 |     """Handles the core relationship management functionality extracted from the original large file for better maintainability."""
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
23 |
24 |     def __init__(self) -> None:
   |

src/application/services/verification/relationship_manager.py:158:17: PERF401 Use a list comprehension to create a transformed list
    |
156 |                 and relationship.status == RelationshipStatus.VERIFIED
157 |             ):
158 |                 children.append(relationship.child_id)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PERF401
159 |
160 |         return children
    |
    = help: Replace for loop with list comprehension

src/application/services/verification/relationship_manager.py:177:17: PERF401 Use a list comprehension to create a transformed list
    |
175 |                 and relationship.status == RelationshipStatus.VERIFIED
176 |             ):
177 |                 parents.append(relationship.parent_id)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PERF401
178 |
179 |         return parents
    |
    = help: Replace for loop with list comprehension

src/application/services/verification/verification_models.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Verification Data Models
2 | | Defines core data structures for parent-child relationship verification.
3 | | """
  | |___^ D205
4 |
5 |   from dataclasses import dataclass
  |
  = help: Insert single blank line

src/application/services/verification/verification_service.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Clean, focused verification service extracted from 513-line monolith.
2 | | Provides COPPA-compliant parent-child relationship verification.
3 | | """
  | |___^ D205
4 |
5 |   import logging
  |
  = help: Insert single blank line

src/application/services/verification/verification_service.py:18:5: D205 1 blank line required between summary line and description
   |
17 |   class ParentChildVerificationService:
18 | /     """Refactored from 513-line file into focused, maintainable components.
19 | |     Ensures only verified parents can access their children's data.
20 | |     Features:
21 | |     - Secure relationship verification
22 | |     - Comprehensive audit trails
23 | |     - COPPA compliance enforcement
24 | |     - Emergency access provisions.
25 | |     """
   | |_______^ D205
26 |
27 |       def __init__(
   |
   = help: Insert single blank line

src/application/services/verification/verification_service.py:90:89: E501 Line too long (94 > 88)
   |
88 |             parent_id: Parent identifier
89 |             child_id: Child identifier
90 |             require_strong_verification: If True, performs a more rigorous verification check.
   |                                                                                         ^^^^^^ E501
91 |
92 |         Returns:
   |

src/application/services/verification/verification_service.py:122:9: D205 1 blank line required between summary line and description
    |
121 |       async def _perform_strong_verification(self, parent_id: str) -> bool:
122 | /         """Simulates a stronger verification step for a parent.
123 | |         In a real system, this could involve:
124 | |         - Checking recent successful logins for the parent.
125 | |         - Requiring a re-entry of a parental PIN or password.
126 | |         - Multi-factor authentication prompt.
127 | |         """
    | |___________^ D205
128 |           self.logger.debug(f"Simulating strong verification for parent: {parent_id}")
129 |           import random
    |
    = help: Insert single blank line

src/application/services/verification/verification_service.py:129:9: PLC0415 `import` should be at the top-level of a file
    |
127 |         """
128 |         self.logger.debug(f"Simulating strong verification for parent: {parent_id}")
129 |         import random
    |         ^^^^^^^^^^^^^ PLC0415
130 |
131 |         return random.choice([True, True, True, False])
    |

src/application/services/verification/verification_service.py:131:16: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
    |
129 |         import random
130 |
131 |         return random.choice([True, True, True, False])
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ S311
132 |
133 |     async def get_parent_children(self, parent_id: str) -> list[str]:
    |

src/application/services/verification/verification_service.py:224:47: PLR2004 Magic value used in comparison, consider replacing `100` with a constant variable
    |
222 |         )
223 |
224 |         if len(self.access_logs[parent_id]) > 100:
    |                                               ^^^ PLR2004
225 |             self.access_logs[parent_id] = self.access_logs[parent_id][-100:]
    |

src/application/services/voice_service.py:8:1: I001 [*] Import block is un-sorted or un-formatted
   |
 6 |   """
 7 |
 8 | / import asyncio
 9 | |
10 | | from fastapi import HTTPException, UploadFile
11 | |
12 | | from src.api.endpoints.voice_models import (
13 | |     AudioValidationResult,
14 | |     SpeechToTextResult,
15 | |     TextToSpeechResult,
16 | | )
17 | | from src.application.interfaces.safety_monitor import SafetyMonitor
18 | | from src.domain.value_objects.safety_level import SafetyLevel
19 | |
20 | | from src.infrastructure.config.settings import Settings
21 | | from src.infrastructure.logging_config import get_logger
   | |________________________________________________________^ I001
   |
   = help: Organize imports

src/application/services/voice_service.py:36:89: E501 Line too long (92 > 88)
   |
34 |         Args:
35 |             settings: Application settings for audio and safety configurations.
36 |             safety_monitor: The SafetyMonitor instance for comprehensive content validation.
   |                                                                                         ^^^^ E501
37 |
38 |         """
   |

src/application/services/voice_service.py:102:17: TRY301 Abstract `raise` to an inner function
    |
100 |             validation_result = await self.validate_audio_file(audio_file)
101 |             if not validation_result.valid:
102 |                 raise HTTPException(status_code=400, detail=validation_result.error)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
103 |
104 |             await audio_file.read()
    |

src/application/services/voice_service.py:106:89: E501 Line too long (99 > 88)
    |
104 |             await audio_file.read()
105 |             # Placeholder for actual STT service call
106 |             transcript = f"This is a placeholder transcript for audio from child aged {child_age}."
    |                                                                                         ^^^^^^^^^^^ E501
107 |
108 |             # Perform content safety analysis on the transcript
    |

src/application/use_cases/generate_ai_response.py:1:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | / from uuid import UUID
2 | |
3 | | from src.application.exceptions import ConsentError
4 | | from src.application.interfaces.read_model_interfaces import IConsentManager
5 | |
6 | | from src.application.services.ai_orchestration_service import AIOrchestrationService
7 | | from src.application.services.audio_processing_service import AudioProcessingService
8 | | from src.application.dto.ai_response import AIResponse
  | |______________________________________________________^ I001
  |
  = help: Organize imports

src/application/use_cases/generate_ai_response.py:12:5: D205 1 blank line required between summary line and description
   |
11 |   class GenerateAIResponseUseCase:
12 | /     """Use case for generating AI responses to child interactions.
13 | |     This use case orchestrates the generation of safe, age-appropriate AI responses
14 | |     for children, ensuring COPPA compliance and child safety throughout the process.
15 | |     FIXED: Removed Service Locator anti-pattern by using proper dependency injection.
16 | |     """
   | |_______^ D205
17 |
18 |       def __init__(
   |
   = help: Insert single blank line

src/application/use_cases/generate_ai_response.py:36:88: E501 Line too long (93 > 88)
   |
34 |         parent_id: str | None = None,  # ✅ Added parent_id for consent verification
35 |     ) -> AIResponse:
36 |         # ✅ Verify parental consent before processing child data (FIXED: No Service Locator)
   |                                                                                         ^^^^^ E501
37 |         if parent_id and self._consent_manager:
38 |             # Check required consents for AI interaction
   |

src/application/use_cases/generate_ai_response.py:52:25: TRY301 Abstract `raise` to an inner function
   |
50 |                       )
51 |                       if not has_consent:
52 | /                         raise ConsentError(
53 | |                             f"Parental consent required for {consent_type}",
54 | |                         )
   | |_________________________^ TRY301
55 |                   except Exception as e:
56 |                       # Catch any underlying exceptions from consent manager and re-raise as ConsentError
   |

src/application/use_cases/generate_ai_response.py:52:31: TRY003 Avoid specifying long messages outside the exception class
   |
50 |                       )
51 |                       if not has_consent:
52 |                           raise ConsentError(
   |  _______________________________^
53 | |                             f"Parental consent required for {consent_type}",
54 | |                         )
   | |_________________________^ TRY003
55 |                   except Exception as e:
56 |                       # Catch any underlying exceptions from consent manager and re-raise as ConsentError
   |

src/application/use_cases/generate_ai_response.py:56:89: E501 Line too long (103 > 88)
   |
54 |                         )
55 |                 except Exception as e:
56 |                     # Catch any underlying exceptions from consent manager and re-raise as ConsentError
   |                                                                                         ^^^^^^^^^^^^^^^ E501
57 |                     raise ConsentError(
58 |                         f"Error during consent verification for {consent_type}: {e}",
   |

src/application/use_cases/generate_ai_response.py:57:27: TRY003 Avoid specifying long messages outside the exception class
   |
55 |                   except Exception as e:
56 |                       # Catch any underlying exceptions from consent manager and re-raise as ConsentError
57 |                       raise ConsentError(
   |  ___________________________^
58 | |                         f"Error during consent verification for {consent_type}: {e}",
59 | |                     ) from e
   | |_____________________^ TRY003
60 |           elif parent_id and not self._consent_manager:
61 |               raise ConsentError(
   |

src/application/use_cases/generate_ai_response.py:61:19: TRY003 Avoid specifying long messages outside the exception class
   |
59 |                       ) from e
60 |           elif parent_id and not self._consent_manager:
61 |               raise ConsentError(
   |  ___________________^
62 | |                 "Consent manager required for parental consent verification",
63 | |             )
   | |_____________^ TRY003
64 |
65 |           ai_response_dto = await self.ai_orchestration_service.get_ai_response(
   |

src/application/use_cases/generate_dynamic_story.py:19:9: D205 1 blank line required between summary line and description
   |
17 |           story_length: str = "medium",
18 |       ) -> dict[str, Any]:
19 | /         """Generate a dynamic story based on child's preferences
20 | |         Args:
21 | |             child_id: The child's UUID identifier
22 | |             story_theme: Optional theme for the story
23 | |             story_length: short, medium, or long
24 | |         Returns:
25 | |             Dict containing the generated story and metadata.
26 | |         """
   | |___________^ D205
27 |           try:
28 |               # Get child preferences from profile service
   |
   = help: Insert single blank line

src/application/use_cases/generate_dynamic_story.py:49:13: TRY300 Consider moving this statement to an `else` block
   |
47 |               )
48 |
49 | /             return {
50 | |                 "success": True,
51 | |                 "story": story_response,
52 | |                 "metadata": {
53 | |                     "theme": story_theme,
54 | |                     "length": story_length,
55 | |                     "child_id": child_id,
56 | |                 },
57 | |             }
   | |_____________^ TRY300
58 |           except Exception as e:
59 |               self.logger.error(f"Error generating story for child {child_id}: {e!s}")
   |

src/application/use_cases/generate_dynamic_story.py:59:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
57 |             }
58 |         except Exception as e:
59 |             self.logger.error(f"Error generating story for child {child_id}: {e!s}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
60 |             return {"success": False, "error": str(e), "story": None}
   |
   = help: Replace with `exception`

src/application/use_cases/generate_dynamic_story.py:100:13: TRY300 Consider moving this statement to an `else` block
    |
 98 |                 self.logger.info(f"Retrieved preferences for child {child_id}")
 99 |                 return preferences
100 |             return None
    |             ^^^^^^^^^^^ TRY300
101 |         except Exception as e:
102 |             self.logger.error(f"Error retrieving child preferences: {e!s}")
    |

src/application/use_cases/generate_dynamic_story.py:102:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
100 |             return None
101 |         except Exception as e:
102 |             self.logger.error(f"Error retrieving child preferences: {e!s}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
103 |             return None
    |
    = help: Replace with `exception`

src/application/use_cases/generate_dynamic_story.py:116:19: PLR2004 Magic value used in comparison, consider replacing `3` with a constant variable
    |
114 |     def _get_age_appropriate_interests(self, age: int) -> list[str]:
115 |         """Get age-appropriate interests based on child's age."""
116 |         if age <= 3:
    |                   ^ PLR2004
117 |             return ["animals", "colors", "shapes", "family"]
118 |         if age <= 5:
    |

src/application/use_cases/generate_dynamic_story.py:118:19: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
    |
116 |         if age <= 3:
117 |             return ["animals", "colors", "shapes", "family"]
118 |         if age <= 5:
    |                   ^ PLR2004
119 |             return ["animals", "adventures", "friendship", "toys"]
120 |         if age <= 8:
    |

src/application/use_cases/generate_dynamic_story.py:120:19: PLR2004 Magic value used in comparison, consider replacing `8` with a constant variable
    |
118 |         if age <= 5:
119 |             return ["animals", "adventures", "friendship", "toys"]
120 |         if age <= 8:
    |                   ^ PLR2004
121 |             return ["adventures", "friendship", "school", "sports", "nature"]
122 |         if age <= 12:
    |

src/application/use_cases/generate_dynamic_story.py:122:19: PLR2004 Magic value used in comparison, consider replacing `12` with a constant variable
    |
120 |         if age <= 8:
121 |             return ["adventures", "friendship", "school", "sports", "nature"]
122 |         if age <= 12:
    |                   ^^ PLR2004
123 |             return [
124 |                 "adventures",
    |

src/application/use_cases/manage_child_profile.py:1:1: I001 [*] Import block is un-sorted or un-formatted
   |
 1 | / from typing import Any
 2 | | from uuid import UUID
 3 | |
 4 | | from src.application.dto.child_data import ChildData
 5 | | from src.domain.entities.child_profile import ChildProfile
 6 | | from src.infrastructure.persistence.child_repository import ChildRepository
 7 | | from src.infrastructure.messaging.kafka_event_bus import KafkaEventBus
 8 | | from src.infrastructure.read_models.child_profile_read_model import (
 9 | |     ChildProfileReadModelStore,
10 | | )
   | |_^ I001
   |
   = help: Organize imports

src/application/use_cases/manage_child_profile.py:75:89: E501 Line too long (90 > 88)
   |
73 |         if child:
74 |             await self.child_repository.delete(child_id)
75 |             # In a full event-sourced system, a ChildDeleted event would be published here
   |                                                                                         ^^ E501
76 |             # and the read model would handle the deletion.
77 |             self.child_profile_read_model_store.delete(child_id)
   |

src/application/use_cases/process_esp32_audio.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """ESP32 Audio Processing Use Case
2 | | Handles the complete workflow of processing audio input from ESP32 devices,
3 | | including speech-to-text, AI response generation, and text-to-speech output
4 | | with comprehensive child safety measures.
5 | | """
  | |___^ D205
6 |
7 |   from uuid import UUID, uuid4
  |
  = help: Insert single blank line

src/application/use_cases/process_esp32_audio.py:7:1: I001 [*] Import block is un-sorted or un-formatted
   |
 5 |   """
 6 |
 7 | / from uuid import UUID, uuid4
 8 | |
 9 | | from fastapi import HTTPException
10 | |
11 | | from src.application.dto.ai_response import AIResponse
12 | | from src.application.dto.esp32_request import ESP32Request
13 | | from src.application.services.ai_orchestration_service import AIOrchestrationService
14 | | from src.application.services.audio_processing_service import AudioProcessingService
15 | | from src.application.services.conversation_service import ConversationService
16 | | from src.infrastructure.persistence.child_repository import ChildRepository
17 | | from src.domain.value_objects.safety_level import SafetyLevel
   | |_____________________________________________________________^ I001
   |
   = help: Organize imports

src/application/use_cases/process_esp32_audio.py:21:5: D205 1 blank line required between summary line and description
   |
20 |   class ProcessESP32AudioUseCase:
21 | /     """Use case for processing ESP32 audio input with comprehensive safety checks.
22 | |     This use case orchestrates the complete audio processing workflow:
23 | |     1. Audio transcription with safety validation
24 | |     2. Child profile and conversation context retrieval
25 | |     3. AI response generation with personalization
26 | |     4. Conversation history updates and learning
27 | |     5. Audio response generation.
28 | |
29 | |     All operations include COPPA compliance and child safety measures.
30 | |
31 | |     Attributes:
32 | |         audio_processing_service: Service for audio transcription and generation
33 | |         ai_orchestration_service: Service for AI response generation
34 | |         conversation_service: Service for conversation management
35 | |         child_repository: Repository for child profile data
36 | |
37 | |     """
   | |_______^ D205
38 |
39 |       def __init__(
   |
   = help: Insert single blank line

src/application/use_cases/process_esp32_audio.py:97:89: E501 Line too long (98 > 88)
   |
95 |             # Handle critical safety level, e.g., return a canned response
96 |             return AIResponse(
97 |                 response_text="I'm sorry, I can't process that. Let's talk about something else.",
   |                                                                                         ^^^^^^^^^^ E501
98 |                 audio_response=b"",
99 |                 emotion="neutral",
   |

src/application/use_cases/process_esp32_audio.py:122:89: E501 Line too long (96 > 88)
    |
120 |             transcription,
121 |             child_preferences=child_profile.preferences,  # Pass child preferences
122 |             voice_id=child_profile.preferences.voice_preference,  # Use child's voice preference
    |                                                                                         ^^^^^^^^ E501
123 |         )
    |

src/application/use_cases/process_esp32_audio.py:145:89: E501 Line too long (112 > 88)
    |
144 |         # Update child preferences based on interaction for adaptive learning
145 |         # This is a simplified example; a real implementation would involve more sophisticated NLP and analysis.
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^ E501
146 |         child_profile.preferences.vocabulary_size += (
147 |             len(transcription.split()) // 10
    |

src/application/use_cases/process_esp32_audio.py:171:89: E501 Line too long (96 > 88)
    |
169 |         audio_output = await self.audio_processing_service.generate_audio_response(
170 |             ai_response.response_text,
171 |             voice_id=child_profile.preferences.voice_preference,  # Use child's voice preference
    |                                                                                         ^^^^^^^^ E501
172 |         )
    |

src/common/constants.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Production Constants for AI Teddy Bear
2 | | All magic numbers and constant values in one place for easy maintenance.
3 | | """
  | |___^ D205
4 |
5 |   from enum import Enum
  |
  = help: Insert single blank line

src/common/constants.py:165:89: E501 Line too long (100 > 88)
    |
163 |     {
164 |         "name": "Children",
165 |         "description": "Child profile management - Create, read, update, and delete child profiles",
    |                                                                                         ^^^^^^^^^^^^ E501
166 |     },
167 |     {
    |

src/common/constants.py:173:89: E501 Line too long (90 > 88)
    |
171 |     {
172 |         "name": "COPPA",
173 |         "description": "COPPA compliance endpoints - Consent management and data privacy",
    |                                                                                         ^^ E501
174 |     },
175 |     {
    |

src/domain/__init__.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Domain layer for the AI Teddy Bear system.
2 | | This package contains the core business logic and entities, independent of external concerns.
3 | | It defines the rules, entities, and value objects that represent the heart of the application.
4 | | """
  | |___^ D205
  |
  = help: Insert single blank line

src/domain/__init__.py:2:89: E501 Line too long (93 > 88)
  |
1 | """Domain layer for the AI Teddy Bear system.
2 | This package contains the core business logic and entities, independent of external concerns.
  |                                                                                         ^^^^^ E501
3 | It defines the rules, entities, and value objects that represent the heart of the application.
4 | """
  |

src/domain/__init__.py:3:89: E501 Line too long (94 > 88)
  |
1 | """Domain layer for the AI Teddy Bear system.
2 | This package contains the core business logic and entities, independent of external concerns.
3 | It defines the rules, entities, and value objects that represent the heart of the application.
  |                                                                                         ^^^^^^ E501
4 | """
  |

src/domain/analytics.py:33:9: D205 1 blank line required between summary line and description
   |
32 |       def calculate_emotion_stability(self, child_id: str) -> float:
33 | /         """Calculate emotional stability score for a child (0.0 to 1.0)
34 | |         Higher score = more stable emotions.
35 | |         """
   | |___________^ D205
36 |           try:
37 |               if child_id not in self.emotion_history:
   |
   = help: Insert single blank line

src/domain/analytics.py:64:13: TRY300 Consider moving this statement to an `else` block
   |
62 |             )
63 |
64 |             return stability_score
   |             ^^^^^^^^^^^^^^^^^^^^^^ TRY300
65 |         except Exception:
66 |             return EMOTION_NEUTRAL_BASELINE
   |

src/domain/analytics.py:64:20: RET504 Unnecessary assignment to `stability_score` before `return` statement
   |
62 |             )
63 |
64 |             return stability_score
   |                    ^^^^^^^^^^^^^^^ RET504
65 |         except Exception:
66 |             return EMOTION_NEUTRAL_BASELINE
   |
   = help: Remove unnecessary assignment

src/domain/analytics.py:69:9: D205 1 blank line required between summary line and description
   |
68 |       def get_speech_concerns(self, child_id: str) -> list[dict[str, Any]]:
69 | /         """Analyze speech patterns and return potential concerns
70 | |         Returns list of concern objects with type, severity, and recommendations.
71 | |         """
   | |___________^ D205
72 |           try:
73 |               if child_id not in self.speech_data:
   |
   = help: Insert single blank line

src/domain/analytics.py:131:89: E501 Line too long (92 > 88)
    |
129 |                         "vocabulary_size": vocabulary_size,
130 |                         "expected_range": expected_vocabulary,
131 |                         "description": "Vocabulary development may be below expected range",
    |                                                                                         ^^^^ E501
132 |                         "recommendation": "Encourage more reading and verbal interaction",
133 |                     },
    |

src/domain/analytics.py:132:89: E501 Line too long (90 > 88)
    |
130 |                         "expected_range": expected_vocabulary,
131 |                         "description": "Vocabulary development may be below expected range",
132 |                         "recommendation": "Encourage more reading and verbal interaction",
    |                                                                                         ^^ E501
133 |                     },
134 |                 )
    |

src/domain/analytics.py:154:89: E501 Line too long (105 > 88)
    |
152 |                         "rate": repetition_rate,
153 |                         "description": "Possible fluency concerns detected",
154 |                         "recommendation": "Monitor speech patterns and consider professional assessment",
    |                                                                                         ^^^^^^^^^^^^^^^^^ E501
155 |                     },
156 |                 )
    |

src/domain/analytics.py:158:13: TRY300 Consider moving this statement to an `else` block
    |
156 |                 )
157 |
158 |             return concerns
    |             ^^^^^^^^^^^^^^^ TRY300
159 |         except Exception:
160 |             return []
    |

src/domain/constants.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Domain constants for AI Teddy Bear application.
2 | | This module contains all domain-level constants to eliminate magic numbers
3 | | and improve code maintainability.
4 | | """
  | |___^ D205
5 |
6 |   # COPPA Compliance Constants
  |
  = help: Insert single blank line

src/domain/entities/child_profile.py:16:45: TC001 Move application import `src.domain.events.domain_events.DomainEvent` into a type-checking block
   |
15 | from src.domain.events.child_profile_updated import ChildProfileUpdated
16 | from src.domain.events.domain_events import DomainEvent
   |                                             ^^^^^^^^^^^ TC001
17 | from src.domain.value_objects import ChildAge, ChildName
   |
   = help: Move into type-checking block

src/domain/entities/child_profile.py:56:9: ERA001 Found commented-out code
   |
54 |         )
55 |         # Optionally, raise a creation event
56 |         # from src.domain.events.child_registered import ChildRegistered
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ ERA001
57 |         # profile._record_event(ChildRegistered(child_id=profile.id, ...))
58 |         return profile
   |
   = help: Remove commented-out code

src/domain/entities/child_profile.py:58:16: RET504 Unnecessary assignment to `profile` before `return` statement
   |
56 |         # from src.domain.events.child_registered import ChildRegistered
57 |         # profile._record_event(ChildRegistered(child_id=profile.id, ...))
58 |         return profile
   |                ^^^^^^^ RET504
59 |
60 |     @property
   |
   = help: Remove unnecessary assignment

src/domain/entities/child_profile.py:106:23: TRY003 Avoid specifying long messages outside the exception class
    |
104 |         if name is not None:
105 |             if not name.strip():
106 |                 raise ValueError("Child name cannot be empty.")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
107 |             # Validate and update name using ChildName value object
108 |             self._child_name = ChildName(name)
    |

src/domain/entities/child_profile.py:110:21: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
    |
108 |             self._child_name = ChildName(name)
109 |         if age is not None:
110 |             if not (2 <= age <= 12):  # Assuming age range 2-12 for COPPA compliance
    |                     ^ PLR2004
111 |                 raise ValueError(
112 |                     "Child age must be between 2 and 12 for COPPA compliance.",
    |

src/domain/entities/child_profile.py:110:33: PLR2004 Magic value used in comparison, consider replacing `12` with a constant variable
    |
108 |             self._child_name = ChildName(name)
109 |         if age is not None:
110 |             if not (2 <= age <= 12):  # Assuming age range 2-12 for COPPA compliance
    |                                 ^^ PLR2004
111 |                 raise ValueError(
112 |                     "Child age must be between 2 and 12 for COPPA compliance.",
    |

src/domain/entities/child_profile.py:111:23: TRY003 Avoid specifying long messages outside the exception class
    |
109 |           if age is not None:
110 |               if not (2 <= age <= 12):  # Assuming age range 2-12 for COPPA compliance
111 |                   raise ValueError(
    |  _______________________^
112 | |                     "Child age must be between 2 and 12 for COPPA compliance.",
113 | |                 )
    | |_________________^ TRY003
114 |               # Validate and update age using ChildAge value object
115 |               self._child_age = ChildAge(age)
    |

src/domain/entities/parent_profile/entities.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Parent entity with comprehensive profile management and validation"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | import re
  |
  = help: Add closing punctuation

src/domain/entities/parent_profile/entities.py:11:5: D205 1 blank line required between summary line and description
   |
 9 |   @dataclass
10 |   class Parent:
11 | /     """Parent entity representing a parent/guardian in the AI Teddy Bear system.
12 | |     Handles parent profile information with comprehensive validation and privacy controls.
13 | |     """
   | |_______^ D205
14 |
15 |       id: str | None = None
   |
   = help: Insert single blank line

src/domain/entities/parent_profile/entities.py:12:89: E501 Line too long (90 > 88)
   |
10 | class Parent:
11 |     """Parent entity representing a parent/guardian in the AI Teddy Bear system.
12 |     Handles parent profile information with comprehensive validation and privacy controls.
   |                                                                                         ^^ E501
13 |     """
   |

src/domain/entities/parent_profile/entities.py:53:9: D205 1 blank line required between summary line and description
   |
52 |       def get_full_name(self) -> str:
53 | /         """Get the full name of the parent with proper formatting.
54 | |         Returns: str: The formatted full name of the parent
55 | |         Examples:
56 | |             >>> parent = Parent(first_name="Ahmed", last_name="Ali")
57 | |             >>> parent.get_full_name()
58 | |             "Ahmed Ali"
59 | |             >>> parent = Parent(name="Sarah Mohamed")
60 | |             >>> parent.get_full_name()
61 | |             "Sarah Mohamed"
62 | |         """
   | |___________^ D205
63 |           # Use first_name and last_name if available
64 |           if self.first_name or self.last_name:
   |
   = help: Insert single blank line

src/domain/entities/parent_profile/entities.py:53:9: D415 First line should end with a period, question mark, or exclamation point
   |
52 |       def get_full_name(self) -> str:
53 | /         """Get the full name of the parent with proper formatting.
54 | |         Returns: str: The formatted full name of the parent
55 | |         Examples:
56 | |             >>> parent = Parent(first_name="Ahmed", last_name="Ali")
57 | |             >>> parent.get_full_name()
58 | |             "Ahmed Ali"
59 | |             >>> parent = Parent(name="Sarah Mohamed")
60 | |             >>> parent.get_full_name()
61 | |             "Sarah Mohamed"
62 | |         """
   | |___________^ D415
63 |           # Use first_name and last_name if available
64 |           if self.first_name or self.last_name:
   |
   = help: Add closing punctuation

src/domain/entities/parent_profile/entities.py:99:19: TRY003 Avoid specifying long messages outside the exception class
    |
 97 |         """
 98 |         if not child_id or not isinstance(child_id, str):
 99 |             raise ValueError("Valid child_id required")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
100 |
101 |         if child_id not in self.child_ids:
    |

src/domain/entities/parent_profile/entities.py:131:19: TRY003 Avoid specifying long messages outside the exception class
    |
129 |         """
130 |         if not key or not isinstance(key, str):
131 |             raise ValueError("Valid preference key required")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
132 |
133 |         # Validate specific preference values
    |

src/domain/entities/parent_profile/entities.py:135:19: TRY003 Avoid specifying long messages outside the exception class
    |
133 |         # Validate specific preference values
134 |         if key == "language" and value not in ["ar", "en", "fr", "es"]:
135 |             raise ValueError("Unsupported language")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
136 |         if key == "child_safety_level" and value not in [
137 |             "strict",
    |

src/domain/entities/parent_profile/entities.py:141:19: TRY003 Avoid specifying long messages outside the exception class
    |
139 |             "relaxed",
140 |         ]:
141 |             raise ValueError("Invalid safety level")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
142 |         if key == "session_timeout_minutes" and (
143 |             not isinstance(value, int) or value < 5 or value > 480
    |

src/domain/entities/parent_profile/entities.py:143:51: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
    |
141 |             raise ValueError("Invalid safety level")
142 |         if key == "session_timeout_minutes" and (
143 |             not isinstance(value, int) or value < 5 or value > 480
    |                                                   ^ PLR2004
144 |         ):
145 |             raise ValueError("Session timeout must be between 5 and 480 minutes")
    |

src/domain/entities/parent_profile/entities.py:143:64: PLR2004 Magic value used in comparison, consider replacing `480` with a constant variable
    |
141 |             raise ValueError("Invalid safety level")
142 |         if key == "session_timeout_minutes" and (
143 |             not isinstance(value, int) or value < 5 or value > 480
    |                                                                ^^^ PLR2004
144 |         ):
145 |             raise ValueError("Session timeout must be between 5 and 480 minutes")
    |

src/domain/entities/parent_profile/entities.py:145:19: TRY003 Avoid specifying long messages outside the exception class
    |
143 |             not isinstance(value, int) or value < 5 or value > 480
144 |         ):
145 |             raise ValueError("Session timeout must be between 5 and 480 minutes")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
146 |
147 |         self.preferences[key] = value
    |

src/domain/entities/parent_profile/entities.py:185:26: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
    |
184 |         parts = self.name.strip().split()
185 |         if len(parts) >= 2:
    |                          ^ PLR2004
186 |             self.first_name = parts[0]
187 |             self.last_name = " ".join(parts[1:])
    |

src/domain/entities/parent_profile/entities.py:198:19: TRY003 Avoid specifying long messages outside the exception class
    |
196 |         email_pattern = r"^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$"
197 |         if not re.match(email_pattern, self.email):
198 |             raise ValueError(f"Invalid email format: {self.email}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
199 |
200 |     def __str__(self) -> str:
    |

src/domain/entities/parent_profile/entities.py:202:89: E501 Line too long (101 > 88)
    |
200 |     def __str__(self) -> str:
201 |         """String representation of parent."""
202 |         return f"Parent(id={self.id}, name='{self.get_full_name()}', children={len(self.child_ids)})"
    |                                                                                         ^^^^^^^^^^^^^ E501
203 |
204 |     def __repr__(self) -> str:
    |

src/domain/entities/user.py:1:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | / from datetime import datetime
2 | | from typing import Optional
  | |___________________________^ I001
3 |
4 |   class User:
  |
  = help: Organize imports

src/domain/entities/user.py:5:9: PLR0913 Too many arguments in function definition (7 > 5)
  |
4 | class User:
5 |     def __init__(
  |         ^^^^^^^^ PLR0913
6 |         self,
7 |         id: str,
  |

src/domain/entities/user.py:7:9: A002 Function argument `id` is shadowing a Python builtin
  |
5 |     def __init__(
6 |         self,
7 |         id: str,
  |         ^^ A002
8 |         email: str,
9 |         role: str,
  |

src/domain/entities/user.py:12:21: UP045 [*] Use `X | None` for type annotations
   |
10 |         name: str,
11 |         is_active: bool = True,
12 |         created_at: Optional[int] = None,
   |                     ^^^^^^^^^^^^^ UP045
13 |         last_login: Optional[datetime] = None,
14 |     ):
   |
   = help: Convert to `X | None`

src/domain/entities/user.py:13:21: UP045 [*] Use `X | None` for type annotations
   |
11 |         is_active: bool = True,
12 |         created_at: Optional[int] = None,
13 |         last_login: Optional[datetime] = None,
   |                     ^^^^^^^^^^^^^^^^^^ UP045
14 |     ):
15 |         self.id = id
   |
   = help: Convert to `X | None`

src/domain/entities/voice_games/voice_games_engine.py:139:89: E501 Line too long (97 > 88)
    |
137 |                 "success": False,
138 |                 "error": f"Failed to start game: {e!s}",
139 |                 "message": "Sorry, an error occurred while starting the game. Please try again.",
    |                                                                                         ^^^^^^^^^ E501
140 |             }
    |

src/domain/entities/voice_games/voice_games_engine.py:173:13: TRY300 Consider moving this statement to an `else` block
    |
171 |                 del self.active_sessions[game_id]
172 |
173 |             return result
    |             ^^^^^^^^^^^^^ TRY300
174 |         except Exception as e:
175 |             return {
    |

src/domain/entities/voice_games/voice_games_engine.py:299:89: E501 Line too long (98 > 88)
    |
297 |                 message = "Interesting choice! Let's see what happens."
298 |         else:
299 |             message = "I didn't understand your choice. Try to choose from the available options."
    |                                                                                         ^^^^^^^^^^ E501
300 |
301 |         session.current_question_index += 1
    |

src/domain/entities/voice_games/voice_games_engine.py:368:89: E501 Line too long (97 > 88)
    |
366 |                         "game_type": session.game_type.value,
367 |                         "score": session.score,
368 |                         "progress": f"{session.current_question_index}/{len(session.questions)}",
    |                                                                                         ^^^^^^^^^ E501
369 |                         "started_at": session.started_at.isoformat(),
370 |                     },
    |

src/domain/events/child_profile_updated.py:9:89: E501 Line too long (93 > 88)
   |
 7 | @dataclass
 8 | class ChildProfileUpdated:
 9 |     """Domain event for child profile updates - required for COPPA compliance audit trail."""
   |                                                                                         ^^^^^ E501
10 |
11 |     child_id: UUID
   |

src/domain/events/child_profile_updated.py:28:13: PLC0415 `import` should be at the top-level of a file
   |
26 |             self.event_timestamp = datetime.utcnow()
27 |         if self.event_id is None:
28 |             from uuid import uuid4
   |             ^^^^^^^^^^^^^^^^^^^^^^ PLC0415
29 |
30 |             self.event_id = uuid4()
   |

src/domain/events/child_profile_updated.py:33:9: PLR0913 Too many arguments in function definition (7 > 5)
   |
32 |     @staticmethod
33 |     def create(
   |         ^^^^^^ PLR0913
34 |         child_id: UUID,
35 |         name: str | None = None,
   |

src/domain/exceptions/__init__.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Domain exception hierarchy for consistent error handling.
2 | | This module provides a structured exception hierarchy that maintains
3 | | clean architecture principles and enables consistent error handling.
4 | | """
  | |___^ D205
5 |
6 |   from .base_exceptions import (
  |
  = help: Insert single blank line

src/domain/exceptions/base.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Domain Exception Base Classes
2 | | Comprehensive exception hierarchy for the AI Teddy Bear system with
3 | | child safety focus and improved error handling.
4 | | """
  | |___^ D205
5 |
6 |   from datetime import datetime
  |
  = help: Insert single blank line

src/domain/exceptions/base.py:6:1: I001 [*] Import block is un-sorted or un-formatted
   |
 4 |   """
 5 |
 6 | / from datetime import datetime
 7 | | from enum import Enum
 8 | | from typing import Any
 9 | |
10 | |
11 | | from src.infrastructure.error_handling import ErrorSeverity, ErrorContext
   | |_________________________________________________________________________^ I001
12 |   class TeddyBearException(Exception):
13 |       """Base exception class for all AI Teddy Bear system errors.
   |
   = help: Organize imports

src/domain/exceptions/base.py:6:22: F401 [*] `datetime.datetime` imported but unused
  |
4 | """
5 |
6 | from datetime import datetime
  |                      ^^^^^^^^ F401
7 | from enum import Enum
8 | from typing import Any
  |
  = help: Remove unused import: `datetime.datetime`

src/domain/exceptions/base.py:7:18: F401 [*] `enum.Enum` imported but unused
  |
6 | from datetime import datetime
7 | from enum import Enum
  |                  ^^^^ F401
8 | from typing import Any
  |
  = help: Remove unused import: `enum.Enum`

src/domain/exceptions/base.py:8:20: F401 [*] `typing.Any` imported but unused
  |
6 | from datetime import datetime
7 | from enum import Enum
8 | from typing import Any
  |                    ^^^ F401
  |
  = help: Remove unused import: `typing.Any`

src/domain/exceptions/base.py:12:7: N818 Exception name `TeddyBearException` should be named with an Error suffix
   |
11 | from src.infrastructure.error_handling import ErrorSeverity, ErrorContext
12 | class TeddyBearException(Exception):
   |       ^^^^^^^^^^^^^^^^^^ N818
13 |     """Base exception class for all AI Teddy Bear system errors.
14 |     Provides structured error handling with severity levels, context,
   |

src/domain/exceptions/base.py:13:5: D205 1 blank line required between summary line and description
   |
11 |   from src.infrastructure.error_handling import ErrorSeverity, ErrorContext
12 |   class TeddyBearException(Exception):
13 | /     """Base exception class for all AI Teddy Bear system errors.
14 | |     Provides structured error handling with severity levels, context,
15 | |     and child safety considerations.
16 | |     """
   | |_______^ D205
17 |
18 |       def __init__(
   |
   = help: Insert single blank line

src/domain/exceptions/base.py:58:5: D205 1 blank line required between summary line and description
   |
57 |   class ParentalConsentRequiredException(TeddyBearException):
58 | /     """Exception raised when parental consent is required for an action.
59 | |     This is a critical child safety exception that should always be handled
60 | |     with proper escalation to parents or guardians.
61 | |     """
   | |_______^ D205
62 |
63 |       def __init__(
   |
   = help: Insert single blank line

src/domain/exceptions/base.py:96:5: D205 1 blank line required between summary line and description
    |
 95 |   class CircuitBreakerOpenException(TeddyBearException):
 96 | /     """Exception raised when circuit breaker is open due to service failures.
 97 | |     Indicates that a service is temporarily unavailable for safety reasons.
 98 | |     """
    | |_______^ D205
 99 |
100 |       def __init__(self, service_name: str, context: ErrorContext | None = None) -> None:
    |
    = help: Insert single blank line

src/domain/exceptions/base.py:127:5: D205 1 blank line required between summary line and description
    |
126 |   class StartupValidationException(TeddyBearException):
127 | /     """Custom exception for security-related issues during application startup.
128 | |     This exception is raised when a security-sensitive configuration
129 | |     or operation fails validation, indicating a potential vulnerability
130 | |     or misconfiguration that could compromise the system.
131 | |     """
    | |_______^ D205
132 |
133 |       def __init__(
    |
    = help: Insert single blank line

src/domain/exceptions/base_exceptions.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Base exception classes for the domain layer.
2 | | This module defines the core exception hierarchy that all domain
3 | | exceptions inherit from, ensuring consistent error handling.
4 | | """
  | |___^ D205
5 |
6 |   from typing import Any
  |
  = help: Insert single blank line

src/domain/exceptions/base_exceptions.py:9:7: N818 Exception name `DomainException` should be named with an Error suffix
   |
 9 | class DomainException(Exception):
   |       ^^^^^^^^^^^^^^^ N818
10 |     """Base exception for all domain - related errors.
11 |     This provides a common interface for all domain exceptions
   |

src/domain/exceptions/base_exceptions.py:10:5: D205 1 blank line required between summary line and description
   |
 9 |   class DomainException(Exception):
10 | /     """Base exception for all domain - related errors.
11 | |     This provides a common interface for all domain exceptions
12 | |     and includes structured error information.
13 | |     """
   | |_______^ D205
14 |
15 |       def __init__(
   |
   = help: Insert single blank line

src/domain/interfaces/__init__.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Domain interfaces for maintaining clean architecture boundaries.
2 | | This module defines abstract interfaces that the domain layer can depend on
3 | | without creating circular dependencies with infrastructure components.
4 | | """
  | |___^ D205
5 |
6 |   from .conversation_repository import IConversationRepository
  |
  = help: Insert single blank line

src/domain/interfaces/ai_service_interface.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """AI Service Interface for Domain Layer
2 | | This interface defines the contract for AI services without creating
3 | | dependencies on infrastructure implementations.
4 | | """
  | |___^ D205
5 |
6 |   from abc import ABC, abstractmethod
  |
  = help: Insert single blank line

src/domain/interfaces/config_interface.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Configuration Interface for Domain Layer
2 | | This interface provides access to configuration without infrastructure dependencies.
3 | | """
  | |___^ D205
4 |
5 |   from abc import ABC, abstractmethod
  |
  = help: Insert single blank line

src/domain/interfaces/encryption_interface.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Domain Encryption Interface
2 | | Defines the contract for encryption services without depending on
3 | | infrastructure implementations, maintaining Hexagonal Architecture principles.
4 | | """
  | |___^ D205
5 |
6 |   from abc import ABC, abstractmethod
  |
  = help: Insert single blank line

src/domain/interfaces/encryption_interface.py:13:5: D205 1 blank line required between summary line and description
   |
12 |   class EncryptionServiceInterface(ABC):
13 | /     """Abstract interface for encryption services.
14 | |     This interface allows the domain layer to use encryption functionality
15 | |     without coupling to specific infrastructure implementations.
16 | |     """
   | |_______^ D205
17 |
18 |       @abstractmethod
   |
   = help: Insert single blank line

src/domain/interfaces/encryption_interface.py:52:28: UP046 Generic class `SecureFieldInterface` uses `Generic` subclass instead of type parameters
   |
52 | class SecureFieldInterface(Generic[T], ABC):
   |                            ^^^^^^^^^^ UP046
53 |     """Interface for encrypted field value objects.
54 |     Provides a domain-level abstraction for encrypted fields that can
   |
   = help: Use type parameters

src/domain/interfaces/encryption_interface.py:53:5: D205 1 blank line required between summary line and description
   |
52 |   class SecureFieldInterface(Generic[T], ABC):
53 | /     """Interface for encrypted field value objects.
54 | |     Provides a domain-level abstraction for encrypted fields that can
55 | |     be implemented with various encryption strategies.
56 | |     """
   | |_______^ D205
57 |
58 |       @abstractmethod
   |
   = help: Insert single blank line

src/domain/interfaces/encryption_interface.py:87:5: D205 1 blank line required between summary line and description
   |
86 |   class NullEncryptionService(EncryptionServiceInterface):
87 | /     """Null object implementation for when encryption is not available.
88 | |     This prevents the domain from breaking when infrastructure
89 | |     services are unavailable during testing or initialization.
90 | |     """
   | |_______^ D205
91 |
92 |       def encrypt(self, data: str) -> str:
   |
   = help: Insert single blank line

src/domain/interfaces/encryption_interface.py:105:7: PLW1641 Object does not implement `__hash__` method
    |
105 | class SecureString(SecureFieldInterface[str]):
    |       ^^^^^^^^^^^^ PLW1641
106 |     """Domain-safe encrypted string implementation.
107 |     This value object encapsulates encryption concerns while providing
    |

src/domain/interfaces/encryption_interface.py:106:5: D205 1 blank line required between summary line and description
    |
105 |   class SecureString(SecureFieldInterface[str]):
106 | /     """Domain-safe encrypted string implementation.
107 | |     This value object encapsulates encryption concerns while providing
108 | |     a clean domain interface for working with sensitive strings.
109 | |     """
    | |_______^ D205
110 |
111 |       def __init__(self, value: str, encryption_service: EncryptionServiceInterface):
    |
    = help: Insert single blank line

src/domain/interfaces/event_bus_interface.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Event Bus Interface for Domain Layer
2 | | This interface defines event publishing without infrastructure dependencies.
3 | | """
  | |___^ D205
4 |
5 |   from abc import ABC, abstractmethod
  |
  = help: Insert single blank line

src/domain/interfaces/external_service_interfaces.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """External service interfaces for the domain layer.
2 | | These interfaces define contracts for external services without
3 | | creating dependencies on specific implementations.
4 | | """
  | |___^ D205
5 |
6 |   from abc import ABC, abstractmethod
  |
  = help: Insert single blank line

src/domain/interfaces/logging_interface.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Domain Logging Interface
2 | | Defines the contract for logging services without coupling domain to infrastructure.
3 | | This allows domain logic to emit events while remaining infrastructure-agnostic.
4 | | """
  | |___^ D205
5 |
6 |   from abc import ABC, abstractmethod
  |
  = help: Insert single blank line

src/domain/interfaces/logging_interface.py:23:5: D205 1 blank line required between summary line and description
   |
22 |   class DomainLoggerInterface(ABC):
23 | /     """Interface for domain logging services.
24 | |     This interface allows domain entities and services to emit log events
25 | |     without depending on specific logging infrastructure.
26 | |     """
   | |_______^ D205
27 |
28 |       @abstractmethod
   |
   = help: Insert single blank line

src/domain/interfaces/logging_interface.py:82:5: D205 1 blank line required between summary line and description
   |
81 |   class NullDomainLogger(DomainLoggerInterface):
82 | /     """Null implementation of domain logger for testing.
83 | |     This implementation does nothing, allowing domain logic to work
84 | |     without logging infrastructure in unit tests.
85 | |     """
   | |_______^ D205
86 |
87 |       def log_domain_event(
   |
   = help: Insert single blank line

src/domain/interfaces/personality_profile_repository.py:4:89: E501 Line too long (100 > 88)
  |
2 | from uuid import UUID
3 |
4 | from src.domain.value_objects.personality import (  # Assuming ChildPersonality is in personality.py
  |                                                                                         ^^^^^^^^^^^^ E501
5 |     ChildPersonality,
6 | )
  |

src/domain/interfaces/repository_interfaces.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Repository interfaces for the domain layer.
2 | | These interfaces define contracts for data persistence without
3 | | creating dependencies on specific database implementations.
4 | | """
  | |___^ D205
5 |
6 |   from abc import ABC, abstractmethod
  |
  = help: Insert single blank line

src/domain/interfaces/repository_interfaces.py:6:1: I001 [*] Import block is un-sorted or un-formatted
   |
 4 |   """
 5 |
 6 | / from abc import ABC, abstractmethod
 7 | | from uuid import UUID
 8 | |
 9 | | from ..entities.child import Child
10 | | from src.domain.entities.user import User
   | |_________________________________________^ I001
   |
   = help: Organize imports

src/domain/interfaces/repository_interfaces.py:9:1: TID252 Prefer absolute imports over relative imports from parent modules
   |
 7 | from uuid import UUID
 8 |
 9 | from ..entities.child import Child
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
10 | from src.domain.entities.user import User
   |
   = help: Replace relative imports from parent modules with absolute imports

src/domain/interfaces/security_interfaces.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Security-related interfaces for the domain layer.
2 | | These interfaces define contracts for security services without
3 | | creating dependencies on infrastructure implementations.
4 | | """
  | |___^ D205
5 |
6 |   from abc import ABC, abstractmethod
  |
  = help: Insert single blank line

src/domain/interfaces/session_repository.py:3:89: E501 Line too long (103 > 88)
  |
1 | from abc import ABC, abstractmethod
2 |
3 | from src.application.services.session_manager import (  # Assuming SessionData is in session_manager.py
  |                                                                                         ^^^^^^^^^^^^^^^ E501
4 |     SessionData,
5 | )
  |

src/domain/models/consent_models.py:35:9: PLR0913 Too many arguments in function definition (10 > 5)
   |
33 |     """Record of parental consent."""
34 |
35 |     def __init__(
   |         ^^^^^^^^ PLR0913
36 |         self,
37 |         consent_id: str,
   |

src/domain/repositories/event_store.py:3:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 |   """Event Store interface and implementation for Event Sourcing pattern."""
2 |
3 | / from abc import ABC, abstractmethod
4 | | from typing import List, Dict, Any
5 | | from uuid import UUID
  | |_____________________^ I001
  |
  = help: Organize imports

src/domain/repositories/event_store.py:4:1: UP035 `typing.List` is deprecated, use `list` instead
  |
3 | from abc import ABC, abstractmethod
4 | from typing import List, Dict, Any
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
5 | from uuid import UUID
  |

src/domain/repositories/event_store.py:4:1: UP035 `typing.Dict` is deprecated, use `dict` instead
  |
3 | from abc import ABC, abstractmethod
4 | from typing import List, Dict, Any
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
5 | from uuid import UUID
  |

src/domain/repositories/event_store.py:10:1: W293 [*] Blank line contains whitespace
   |
 8 | class EventStore(ABC):
 9 |     """Abstract base class for event store implementations."""
10 |     
   | ^^^^ W293
11 |     @abstractmethod
12 |     async def append_events(
   |
   = help: Remove whitespace from blank line

src/domain/repositories/event_store.py:17:17: UP006 [*] Use `list` instead of `List` for type annotation
   |
15 |         aggregate_type: str,
16 |         event_type: str,
17 |         events: List[Dict[str, Any]],
   |                 ^^^^ UP006
18 |     ) -> None:
19 |         """Append events to the event store."""
   |
   = help: Replace with `list`

src/domain/repositories/event_store.py:17:22: UP006 [*] Use `dict` instead of `Dict` for type annotation
   |
15 |         aggregate_type: str,
16 |         event_type: str,
17 |         events: List[Dict[str, Any]],
   |                      ^^^^ UP006
18 |     ) -> None:
19 |         """Append events to the event store."""
   |
   = help: Replace with `dict`

src/domain/repositories/event_store.py:21:1: W293 [*] Blank line contains whitespace
   |
19 |         """Append events to the event store."""
20 |         pass
21 |     
   | ^^^^ W293
22 |     @abstractmethod
23 |     async def get_events(
   |
   = help: Remove whitespace from blank line

src/domain/repositories/event_store.py:26:24: RUF013 PEP 484 prohibits implicit `Optional`
   |
24 |         self,
25 |         aggregate_id: UUID,
26 |         after_version: int = None,
   |                        ^^^ RUF013
27 |     ) -> List[Dict[str, Any]]:
28 |         """Retrieve events for an aggregate."""
   |
   = help: Convert to `T | None`

src/domain/repositories/event_store.py:27:10: UP006 [*] Use `list` instead of `List` for type annotation
   |
25 |         aggregate_id: UUID,
26 |         after_version: int = None,
27 |     ) -> List[Dict[str, Any]]:
   |          ^^^^ UP006
28 |         """Retrieve events for an aggregate."""
29 |         pass
   |
   = help: Replace with `list`

src/domain/repositories/event_store.py:27:15: UP006 [*] Use `dict` instead of `Dict` for type annotation
   |
25 |         aggregate_id: UUID,
26 |         after_version: int = None,
27 |     ) -> List[Dict[str, Any]]:
   |               ^^^^ UP006
28 |         """Retrieve events for an aggregate."""
29 |         pass
   |
   = help: Replace with `dict`

src/domain/repositories/event_store.py:34:1: W293 [*] Blank line contains whitespace
   |
32 | class InMemoryEventStore(EventStore):
33 |     """In-memory implementation of EventStore for testing."""
34 |     
   | ^^^^ W293
35 |     def __init__(self):
36 |         self._events: Dict[str, List[Dict[str, Any]]] = {}
   |
   = help: Remove whitespace from blank line

src/domain/repositories/event_store.py:36:23: UP006 [*] Use `dict` instead of `Dict` for type annotation
   |
35 |     def __init__(self):
36 |         self._events: Dict[str, List[Dict[str, Any]]] = {}
   |                       ^^^^ UP006
37 |         self._versions: Dict[str, int] = {}
   |
   = help: Replace with `dict`

src/domain/repositories/event_store.py:36:33: UP006 [*] Use `list` instead of `List` for type annotation
   |
35 |     def __init__(self):
36 |         self._events: Dict[str, List[Dict[str, Any]]] = {}
   |                                 ^^^^ UP006
37 |         self._versions: Dict[str, int] = {}
   |
   = help: Replace with `list`

src/domain/repositories/event_store.py:36:38: UP006 [*] Use `dict` instead of `Dict` for type annotation
   |
35 |     def __init__(self):
36 |         self._events: Dict[str, List[Dict[str, Any]]] = {}
   |                                      ^^^^ UP006
37 |         self._versions: Dict[str, int] = {}
   |
   = help: Replace with `dict`

src/domain/repositories/event_store.py:37:25: UP006 [*] Use `dict` instead of `Dict` for type annotation
   |
35 |     def __init__(self):
36 |         self._events: Dict[str, List[Dict[str, Any]]] = {}
37 |         self._versions: Dict[str, int] = {}
   |                         ^^^^ UP006
38 |     
39 |     async def append_events(
   |
   = help: Replace with `dict`

src/domain/repositories/event_store.py:38:1: W293 [*] Blank line contains whitespace
   |
36 |         self._events: Dict[str, List[Dict[str, Any]]] = {}
37 |         self._versions: Dict[str, int] = {}
38 |     
   | ^^^^ W293
39 |     async def append_events(
40 |         self,
   |
   = help: Remove whitespace from blank line

src/domain/repositories/event_store.py:44:17: UP006 [*] Use `list` instead of `List` for type annotation
   |
42 |         aggregate_type: str,
43 |         event_type: str,
44 |         events: List[Dict[str, Any]],
   |                 ^^^^ UP006
45 |     ) -> None:
46 |         """Append events to memory store."""
   |
   = help: Replace with `list`

src/domain/repositories/event_store.py:44:22: UP006 [*] Use `dict` instead of `Dict` for type annotation
   |
42 |         aggregate_type: str,
43 |         event_type: str,
44 |         events: List[Dict[str, Any]],
   |                      ^^^^ UP006
45 |     ) -> None:
46 |         """Append events to memory store."""
   |
   = help: Replace with `dict`

src/domain/repositories/event_store.py:51:1: W293 [*] Blank line contains whitespace
   |
49 |             self._events[key] = []
50 |             self._versions[key] = 0
51 |         
   | ^^^^^^^^ W293
52 |         for event in events:
53 |             self._versions[key] += 1
   |
   = help: Remove whitespace from blank line

src/domain/repositories/event_store.py:62:1: W293 [*] Blank line contains whitespace
   |
60 |             }
61 |             self._events[key].append(event_with_metadata)
62 |     
   | ^^^^ W293
63 |     async def get_events(
64 |         self,
   |
   = help: Remove whitespace from blank line

src/domain/repositories/event_store.py:66:24: RUF013 PEP 484 prohibits implicit `Optional`
   |
64 |         self,
65 |         aggregate_id: UUID,
66 |         after_version: int = None,
   |                        ^^^ RUF013
67 |     ) -> List[Dict[str, Any]]:
68 |         """Get events from memory store."""
   |
   = help: Convert to `T | None`

src/domain/repositories/event_store.py:67:10: UP006 [*] Use `list` instead of `List` for type annotation
   |
65 |         aggregate_id: UUID,
66 |         after_version: int = None,
67 |     ) -> List[Dict[str, Any]]:
   |          ^^^^ UP006
68 |         """Get events from memory store."""
69 |         key = str(aggregate_id)
   |
   = help: Replace with `list`

src/domain/repositories/event_store.py:67:15: UP006 [*] Use `dict` instead of `Dict` for type annotation
   |
65 |         aggregate_id: UUID,
66 |         after_version: int = None,
67 |     ) -> List[Dict[str, Any]]:
   |               ^^^^ UP006
68 |         """Get events from memory store."""
69 |         key = str(aggregate_id)
   |
   = help: Replace with `dict`

src/domain/repositories/event_store.py:71:1: W293 [*] Blank line contains whitespace
   |
69 |         key = str(aggregate_id)
70 |         events = self._events.get(key, [])
71 |         
   | ^^^^^^^^ W293
72 |         if after_version is not None:
73 |             return [e for e in events if e.get("version", 0) > after_version]
   |
   = help: Remove whitespace from blank line

src/domain/safety/bias_detector/bias_detector.py:84:37: PLR2004 Magic value used in comparison, consider replacing `0.5` with a constant variable
   |
82 |             self.bias_statistics["biased_responses"] += 1
83 |             overall_bias_score = max(bias_scores.values())
84 |             if overall_bias_score > 0.5:  # Example threshold
   |                                     ^^^ PLR2004
85 |                 risk_level = RiskLevel.HIGH_RISK
86 |             elif overall_bias_score > 0.2:
   |

src/domain/safety/bias_detector/bias_detector.py:86:39: PLR2004 Magic value used in comparison, consider replacing `0.2` with a constant variable
   |
84 |             if overall_bias_score > 0.5:  # Example threshold
85 |                 risk_level = RiskLevel.HIGH_RISK
86 |             elif overall_bias_score > 0.2:
   |                                       ^^^ PLR2004
87 |                 risk_level = RiskLevel.MEDIUM_RISK
88 |             else:
   |

src/domain/safety/models.py:219:16: RET504 Unnecessary assignment to `default_patterns` before `return` statement
    |
217 |             "profanity": [r"\b(stupid|dumb|hate|shut.*up|damn|hell)\b"],
218 |         }
219 |         return default_patterns
    |                ^^^^^^^^^^^^^^^^ RET504
220 |
221 |     def _load_age_restrictions(self) -> dict[int, dict[str, int]]:
    |
    = help: Remove unnecessary assignment

src/domain/safety/models.py:235:16: RET504 Unnecessary assignment to `default_restrictions` before `return` statement
    |
233 |             13: {"max_scary": 4, "max_violence": 3, "max_inappropriate": 0},
234 |         }
235 |         return default_restrictions
    |                ^^^^^^^^^^^^^^^^^^^^ RET504
236 |
237 |     def is_appropriate(self, content: str, age: int) -> bool:
    |
    = help: Remove unnecessary assignment

src/domain/safety/models.py:239:9: PLC0415 `import` should be at the top-level of a file
    |
237 |     def is_appropriate(self, content: str, age: int) -> bool:
238 |         """Real content safety validation for child protection."""
239 |         import re
    |         ^^^^^^^^^ PLC0415
240 |
241 |         if not content or not content.strip():
    |

src/domain/safety/models.py:282:9: ARG002 Unused method argument: `context`
    |
280 |         self,
281 |         content: str,
282 |         context: ContextAnalysis,
    |         ^^^^^^^ ARG002
283 |     ) -> SafetyAnalysisResult:
284 |         """Comprehensive safety analysis with real validation."""
    |

src/domain/safety/models.py:285:9: PLC0415 `import` should be at the top-level of a file
    |
283 |     ) -> SafetyAnalysisResult:
284 |         """Comprehensive safety analysis with real validation."""
285 |         import re
    |         ^^^^^^^^^ PLC0415
286 |
287 |         if not content:
    |

src/domain/safety/models.py:322:89: E501 Line too long (96 > 88)
    |
320 |             confidence=0.8,
321 |             violations=violations,
322 |             explanation=f"Found {len(violations)} safety concerns: {'; '.join(violations[:3])}",
    |                                                                                         ^^^^^^^^ E501
323 |         )
    |

src/domain/safety/models.py:368:21: PLR2004 Magic value used in comparison, consider replacing `0.8` with a constant variable
    |
367 |         """
368 |         if score >= 0.8:
    |                     ^^^ PLR2004
369 |             return RiskLevel.HIGH
370 |         if score >= 0.5:
    |

src/domain/safety/models.py:370:21: PLR2004 Magic value used in comparison, consider replacing `0.5` with a constant variable
    |
368 |         if score >= 0.8:
369 |             return RiskLevel.HIGH
370 |         if score >= 0.5:
    |                     ^^^ PLR2004
371 |             return RiskLevel.MEDIUM
372 |         return RiskLevel.LOW
    |

src/domain/safety/models.py:412:9: PLC0415 `import` should be at the top-level of a file
    |
411 |         """
412 |         import re
    |         ^^^^^^^^^ PLC0415
413 |
414 |         if not content:
    |

src/domain/schemas.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """COPPA-Compliant Schema Validation for AI Teddy Bear
2 | | Comprehensive data validation with child privacy protection
3 | | """
  | |___^ D205
4 |
5 |   import logging
  |
  = help: Insert single blank line

src/domain/schemas.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """COPPA-Compliant Schema Validation for AI Teddy Bear
2 | | Comprehensive data validation with child privacy protection
3 | | """
  | |___^ D415
4 |
5 |   import logging
  |
  = help: Add closing punctuation

src/domain/schemas.py:24:1: W293 [*] Blank line contains whitespace
   |
22 | class ValidationResult:
23 |     """Result of schema validation with COPPA compliance details."""
24 |     
   | ^^^^ W293
25 |     def __init__(
26 |         self,
   |
   = help: Remove whitespace from blank line

src/domain/schemas.py:25:9: PLR0913 Too many arguments in function definition (6 > 5)
   |
23 |     """Result of schema validation with COPPA compliance details."""
24 |     
25 |     def __init__(
   |         ^^^^^^^^ PLR0913
26 |         self,
27 |         is_valid: bool,
   |

src/domain/schemas.py:28:17: RUF013 PEP 484 prohibits implicit `Optional`
   |
26 |         self,
27 |         is_valid: bool,
28 |         errors: list[str] = None,
   |                 ^^^^^^^^^ RUF013
29 |         coppa_violations: list[COPPAViolationType] = None,
30 |         warnings: list[str] = None,
   |
   = help: Convert to `T | None`

src/domain/schemas.py:29:27: RUF013 PEP 484 prohibits implicit `Optional`
   |
27 |         is_valid: bool,
28 |         errors: list[str] = None,
29 |         coppa_violations: list[COPPAViolationType] = None,
   |                           ^^^^^^^^^^^^^^^^^^^^^^^^ RUF013
30 |         warnings: list[str] = None,
31 |         metadata: dict[str, Any] = None,
   |
   = help: Convert to `T | None`

src/domain/schemas.py:30:19: RUF013 PEP 484 prohibits implicit `Optional`
   |
28 |         errors: list[str] = None,
29 |         coppa_violations: list[COPPAViolationType] = None,
30 |         warnings: list[str] = None,
   |                   ^^^^^^^^^ RUF013
31 |         metadata: dict[str, Any] = None,
32 |         security_flags: list[str] = None,
   |
   = help: Convert to `T | None`

src/domain/schemas.py:31:19: RUF013 PEP 484 prohibits implicit `Optional`
   |
29 |         coppa_violations: list[COPPAViolationType] = None,
30 |         warnings: list[str] = None,
31 |         metadata: dict[str, Any] = None,
   |                   ^^^^^^^^^^^^^^ RUF013
32 |         security_flags: list[str] = None,
33 |     ) -> None:
   |
   = help: Convert to `T | None`

src/domain/schemas.py:32:25: RUF013 PEP 484 prohibits implicit `Optional`
   |
30 |         warnings: list[str] = None,
31 |         metadata: dict[str, Any] = None,
32 |         security_flags: list[str] = None,
   |                         ^^^^^^^^^ RUF013
33 |     ) -> None:
34 |         self.is_valid = is_valid
   |
   = help: Convert to `T | None`

src/domain/schemas.py:56:49: RUF013 PEP 484 prohibits implicit `Optional`
   |
55 | def validate_against_schema(
56 |     data: Any, schema: dict[str, Any], context: dict[str, Any] = None
   |                                                 ^^^^^^^^^^^^^^ RUF013
57 | ) -> ValidationResult:
58 |     """Validate data against a schema with comprehensive COPPA compliance checking.
   |
   = help: Convert to `T | None`

src/domain/schemas.py:58:5: D205 1 blank line required between summary line and description
   |
56 |       data: Any, schema: dict[str, Any], context: dict[str, Any] = None
57 |   ) -> ValidationResult:
58 | /     """Validate data against a schema with comprehensive COPPA compliance checking.
59 | |     Args: data: Data to validate
60 | |         schema: Schema definition to validate against
61 | |         context: Additional context for validation(child_age, parent_consent, etc.)
62 | |     Returns: ValidationResult with detailed validation and COPPA compliance information
63 | |     """
   | |_______^ D205
64 |       context = context or {}
65 |       result = ValidationResult(is_valid=True)
   |
   = help: Insert single blank line

src/domain/schemas.py:58:5: D415 First line should end with a period, question mark, or exclamation point
   |
56 |       data: Any, schema: dict[str, Any], context: dict[str, Any] = None
57 |   ) -> ValidationResult:
58 | /     """Validate data against a schema with comprehensive COPPA compliance checking.
59 | |     Args: data: Data to validate
60 | |         schema: Schema definition to validate against
61 | |         context: Additional context for validation(child_age, parent_consent, etc.)
62 | |     Returns: ValidationResult with detailed validation and COPPA compliance information
63 | |     """
   | |_______^ D415
64 |       context = context or {}
65 |       result = ValidationResult(is_valid=True)
   |
   = help: Add closing punctuation

src/domain/schemas.py:83:9: TRY300 Consider moving this statement to an `else` block
   |
81 |             logging.warning(f"COPPA violations detected: {violations_list}")
82 |
83 |         return result
   |         ^^^^^^^^^^^^^ TRY300
84 |     except Exception as e:
85 |         result.add_error(f"Validation system error: {e}")
   |

src/domain/schemas.py:175:16: ARG001 Unused function argument: `schema`
    |
174 | def _validate_coppa_compliance(
175 |     data: Any, schema: dict[str, Any], context: dict[str, Any], result: ValidationResult
    |                ^^^^^^ ARG001
176 | ) -> None:
177 |     """Validate COPPA compliance requirements."""
    |

src/domain/schemas.py:181:46: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
    |
179 |     parent_consent = context.get("parent_consent", False)
180 |     # COPPA applies to children under 13
181 |     if child_age is not None and child_age < 13:
    |                                              ^^ PLR2004
182 |         if not parent_consent:
183 |             result.add_coppa_violation(
    |

src/domain/schemas.py:194:89: E501 Line too long (97 > 88)
    |
192 |                     result.add_coppa_violation(
193 |                         COPPAViolationType.PERSONAL_INFO_COLLECTION,
194 |                         f"Collection of {field} from children under 13 requires special consent",
    |                                                                                         ^^^^^^^^^ E501
195 |                     )
    |

src/domain/schemas.py:199:16: ARG001 Unused function argument: `schema`
    |
198 | def _validate_child_safety(
199 |     data: Any, schema: dict[str, Any], context: dict[str, Any], result: ValidationResult
    |                ^^^^^^ ARG001
200 | ) -> None:
201 |     """Validate child safety requirements."""
    |

src/domain/schemas.py:199:40: ARG001 Unused function argument: `context`
    |
198 | def _validate_child_safety(
199 |     data: Any, schema: dict[str, Any], context: dict[str, Any], result: ValidationResult
    |                                        ^^^^^^^ ARG001
200 | ) -> None:
201 |     """Validate child safety requirements."""
    |

src/domain/schemas.py:222:5: ARG001 Unused function argument: `data`
    |
221 | def _validate_data_retention(
222 |     data: Any, schema: dict[str, Any], context: dict[str, Any], result: ValidationResult
    |     ^^^^ ARG001
223 | ) -> None:
224 |     """Validate data retention compliance."""
    |

src/domain/schemas.py:222:16: ARG001 Unused function argument: `schema`
    |
221 | def _validate_data_retention(
222 |     data: Any, schema: dict[str, Any], context: dict[str, Any], result: ValidationResult
    |                ^^^^^^ ARG001
223 | ) -> None:
224 |     """Validate data retention compliance."""
    |

src/domain/schemas.py:245:89: E501 Line too long (91 > 88)
    |
243 |             "minLength": 1,
244 |             "maxLength": 50,
245 |             "pattern": r"^[a-zA-Z\s\u0600-\u06FF]+$",  # Letters and Arabic characters only
    |                                                                                         ^^^ E501
246 |         },
247 |         "age": {"type": "integer", "minimum": 3, "maximum": 13},  # COPPA compliance
    |

src/domain/schemas.py:302:1: W293 [*] Blank line contains whitespace
    |
300 | class ValidationSeverity(Enum):
301 |     """Validation issue severity levels."""
302 |     
    | ^^^^ W293
303 |     INFO = "info"
304 |     WARNING = "warning"  
    |
    = help: Remove whitespace from blank line

src/domain/schemas.py:304:24: W291 [*] Trailing whitespace
    |
303 |     INFO = "info"
304 |     WARNING = "warning"  
    |                        ^^ W291
305 |     ERROR = "error"
306 |     CRITICAL = "critical"
    |
    = help: Remove trailing whitespace

src/domain/schemas.py:320:19: W291 [*] Trailing whitespace
    |
318 | AGE_THRESHOLDS = {
319 |     "min_age": 3,
320 |     "max_age": 17, 
    |                   ^ W291
321 |     "coppa_age": 13,
322 |     "teen_age": 13,
    |
    = help: Remove trailing whitespace

src/domain/services/coppa_age_validation.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Centralized COPPA Age Validation Service
2 | | Provides consistent age validation across the entire application for COPPA compliance.
3 | | """
  | |___^ D205
4 |
5 |   from datetime import date
  |
  = help: Insert single blank line

src/domain/services/coppa_age_validation.py:171:89: E501 Line too long (102 > 88)
    |
169 |         """Get compliance notes based on validation result."""
170 |         notes = {
171 |             AgeValidationResult.VALID_CHILD: "COPPA compliance required. Parental consent mandatory.",
    |                                                                                         ^^^^^^^^^^^^^^ E501
172 |             AgeValidationResult.VALID_TEEN: "Parental consent recommended. Enhanced privacy protection.",
173 |             AgeValidationResult.VALID_ADULT: "Standard privacy protection applies.",
    |

src/domain/services/coppa_age_validation.py:172:89: E501 Line too long (105 > 88)
    |
170 |         notes = {
171 |             AgeValidationResult.VALID_CHILD: "COPPA compliance required. Parental consent mandatory.",
172 |             AgeValidationResult.VALID_TEEN: "Parental consent recommended. Enhanced privacy protection.",
    |                                                                                         ^^^^^^^^^^^^^^^^^ E501
173 |             AgeValidationResult.VALID_ADULT: "Standard privacy protection applies.",
174 |             AgeValidationResult.TOO_YOUNG: "Age too young for safe interaction.",
    |

src/domain/services/coppa_age_validation.py:176:89: E501 Line too long (94 > 88)
    |
174 |             AgeValidationResult.TOO_YOUNG: "Age too young for safe interaction.",
175 |             AgeValidationResult.INVALID_AGE: "Invalid age data provided.",
176 |             AgeValidationResult.MISSING_BIRTHDATE: "Birthdate required for age verification.",
    |                                                                                         ^^^^^^ E501
177 |         }
178 |         return notes.get(result, "Unknown validation result.")
    |

src/domain/services/emotion_analyzer.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Emotion Analyzer Service - Domain Layer
2 | | Provides emotion analysis functionality for child interactions
3 | | without external ML library dependencies.
4 | | """
  | |___^ D205
5 |
6 |   from dataclasses import dataclass
  |
  = help: Insert single blank line

src/domain/services/emotion_analyzer.py:23:19: TRY003 Avoid specifying long messages outside the exception class
   |
21 |         """Validate emotion result data."""
22 |         if not 0.0 <= self.confidence <= 1.0:
23 |             raise ValueError("Confidence must be between 0.0 and 1.0")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
24 |         if not -1.0 <= self.sentiment_score <= 1.0:
25 |             raise ValueError("Sentiment score must be between -1.0 and 1.0")
   |

src/domain/services/emotion_analyzer.py:25:19: TRY003 Avoid specifying long messages outside the exception class
   |
23 |             raise ValueError("Confidence must be between 0.0 and 1.0")
24 |         if not -1.0 <= self.sentiment_score <= 1.0:
25 |             raise ValueError("Sentiment score must be between -1.0 and 1.0")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
26 |         if not 0.0 <= self.arousal_score <= 1.0:
27 |             raise ValueError("Arousal score must be between 0.0 and 1.0")
   |

src/domain/services/emotion_analyzer.py:27:19: TRY003 Avoid specifying long messages outside the exception class
   |
25 |             raise ValueError("Sentiment score must be between -1.0 and 1.0")
26 |         if not 0.0 <= self.arousal_score <= 1.0:
27 |             raise ValueError("Arousal score must be between 0.0 and 1.0")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
   |

src/domain/services/emotion_analyzer.py:51:9: PLR0911 Too many return statements (8 > 6)
   |
49 |         self._neutral_emotions = {"neutral", "focused", "thinking"}
50 |
51 |     def analyze_text(self, text: str) -> EmotionResult:
   |         ^^^^^^^^^^^^ PLR0911
52 |         """Analyze emotion from text input with child-appropriate detection.
   |

src/domain/services/emotion_analyzer.py:128:20: PLR2004 Magic value used in comparison, consider replacing `0.7` with a constant variable
    |
126 |         audio_features.get("tempo", 0.5)
127 |         # Simple emotion detection based on audio features
128 |         if pitch > 0.7 and energy > 0.6:
    |                    ^^^ PLR2004
129 |             return EmotionResult(
130 |                 "excited",
    |

src/domain/services/emotion_analyzer.py:128:37: PLR2004 Magic value used in comparison, consider replacing `0.6` with a constant variable
    |
126 |         audio_features.get("tempo", 0.5)
127 |         # Simple emotion detection based on audio features
128 |         if pitch > 0.7 and energy > 0.6:
    |                                     ^^^ PLR2004
129 |             return EmotionResult(
130 |                 "excited",
    |

src/domain/services/emotion_analyzer.py:136:20: PLR2004 Magic value used in comparison, consider replacing `0.3` with a constant variable
    |
134 |                 arousal_score=0.9,
135 |             )
136 |         if pitch < 0.3 and energy < 0.4:
    |                    ^^^ PLR2004
137 |             return EmotionResult(
138 |                 "sad",
    |

src/domain/services/emotion_analyzer.py:136:37: PLR2004 Magic value used in comparison, consider replacing `0.4` with a constant variable
    |
134 |                 arousal_score=0.9,
135 |             )
136 |         if pitch < 0.3 and energy < 0.4:
    |                                     ^^^ PLR2004
137 |             return EmotionResult(
138 |                 "sad",
    |

src/domain/services/emotion_analyzer.py:144:21: PLR2004 Magic value used in comparison, consider replacing `0.8` with a constant variable
    |
142 |                 arousal_score=0.3,
143 |             )
144 |         if energy > 0.8:
    |                     ^^^ PLR2004
145 |             return EmotionResult(
146 |                 "energetic",
    |

src/domain/services/emotion_analyzer.py:203:45: PLR2004 Magic value used in comparison, consider replacing `0.7` with a constant variable
    |
201 |         if (
202 |             emotion_result.primary_emotion in self._negative_emotions
203 |             and emotion_result.confidence > 0.7
    |                                             ^^^ PLR2004
204 |         ):
205 |             return True
    |

src/domain/services/emotion_analyzer.py:207:45: PLR2004 Magic value used in comparison, consider replacing `-0.7` with a constant variable
    |
205 |             return True
206 |         # Very low sentiment scores may indicate distress
207 |         if emotion_result.sentiment_score < -0.7:
    |                                             ^^^^ PLR2004
208 |             return True
209 |         # Very high arousal with negative sentiment may indicate agitation
    |

src/domain/services/emotion_analyzer.py:211:44: PLR2004 Magic value used in comparison, consider replacing `0.8` with a constant variable
    |
209 |         # Very high arousal with negative sentiment may indicate agitation
210 |         return bool(
211 |             emotion_result.arousal_score > 0.8 and emotion_result.sentiment_score < -0.3
    |                                            ^^^ PLR2004
212 |         )
    |

src/domain/services/emotion_analyzer.py:211:85: PLR2004 Magic value used in comparison, consider replacing `-0.3` with a constant variable
    |
209 |         # Very high arousal with negative sentiment may indicate agitation
210 |         return bool(
211 |             emotion_result.arousal_score > 0.8 and emotion_result.sentiment_score < -0.3
    |                                                                                     ^^^^ PLR2004
212 |         )
    |

src/domain/services/parental_consent_enforcer.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Parental Consent Enforcement Service
2 | | Ensures parental consent is properly validated for all child operations.
3 | | """
  | |___^ D205
4 |
5 |   from datetime import datetime
  |
  = help: Insert single blank line

src/domain/services/parental_consent_enforcer.py:82:9: ARG002 Unused method argument: `child_id`
   |
80 |     def validate_consent_for_operation(
81 |         self,
82 |         child_id: str,
   |         ^^^^^^^^ ARG002
83 |         child_age: int,
84 |         operation_type: ConsentType,
   |

src/domain/services/parental_consent_enforcer.py:124:89: E501 Line too long (107 > 88)
    |
122 |                 "consent_status": consent_record.status.value,
123 |                 "can_proceed": False,
124 |                 "message": f"Parental consent for {operation_type.value} is {consent_record.status.value}",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^ E501
125 |                 "consent_record": self._consent_record_to_dict(consent_record),
126 |                 "required_action": "renew_parental_consent",
    |

src/domain/services/parental_consent_enforcer.py:291:26: PLR2004 Magic value used in comparison, consider replacing `18` with a constant variable
    |
289 |                 ],
290 |             )
291 |         elif child_age < 18:
    |                          ^^ PLR2004
292 |             recommendations.extend(
293 |                 [
    |

src/domain/value_objects/accessibility.py:24:89: E501 Line too long (101 > 88)
   |
22 |     Attributes:
23 |         child_id (UUID): The unique identifier of the child.
24 |         special_needs (List[SpecialNeedType]): A list of special needs types applicable to the child.
   |                                                                                         ^^^^^^^^^^^^^ E501
25 |         preferred_interaction_mode (str): E.g., "voice", "text", "haptic".
26 |         voice_speed_adjustment (float): Multiplier for voice speed (e.g., 0.8 for slower, 1.2 for faster).
   |

src/domain/value_objects/accessibility.py:26:89: E501 Line too long (106 > 88)
   |
24 |         special_needs (List[SpecialNeedType]): A list of special needs types applicable to the child.
25 |         preferred_interaction_mode (str): E.g., "voice", "text", "haptic".
26 |         voice_speed_adjustment (float): Multiplier for voice speed (e.g., 0.8 for slower, 1.2 for faster).
   |                                                                                         ^^^^^^^^^^^^^^^^^^ E501
27 |         volume_level (float): Preferred volume level.
28 |         subtitles_enabled (bool): Whether subtitles are preferred/enabled.
   |

src/domain/value_objects/child_age.py:23:5: D205 1 blank line required between summary line and description
   |
21 |   @dataclass(frozen=True)
22 |   class ChildAge:
23 | /     """Child Age Value Object
24 | |     Represents a child's age with COPPA compliance validation
25 | |     and age-appropriate content categorization.
26 | |     """
   | |_______^ D205
27 |
28 |       years: int
   |
   = help: Insert single blank line

src/domain/value_objects/child_age.py:33:25: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
   |
31 |     def __post_init__(self) -> None:
32 |         """Validate age constraints."""
33 |         if self.years < 2:
   |                         ^ PLR2004
34 |             raise ValueError("Children under 2 years are not supported")
35 |         if self.years > 13:
   |

src/domain/value_objects/child_age.py:34:19: TRY003 Avoid specifying long messages outside the exception class
   |
32 |         """Validate age constraints."""
33 |         if self.years < 2:
34 |             raise ValueError("Children under 2 years are not supported")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
35 |         if self.years > 13:
36 |             raise ValueError(
   |

src/domain/value_objects/child_age.py:35:25: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
   |
33 |         if self.years < 2:
34 |             raise ValueError("Children under 2 years are not supported")
35 |         if self.years > 13:
   |                         ^^ PLR2004
36 |             raise ValueError(
37 |                 "COPPA compliance: Children over 13 require different handling",
   |

src/domain/value_objects/child_age.py:36:19: TRY003 Avoid specifying long messages outside the exception class
   |
34 |               raise ValueError("Children under 2 years are not supported")
35 |           if self.years > 13:
36 |               raise ValueError(
   |  ___________________^
37 | |                 "COPPA compliance: Children over 13 require different handling",
38 | |             )
   | |_____________^ TRY003
39 |           if self.months is not None and (self.months < 0 or self.months > 11):
40 |               raise ValueError("Months must be between 0 and 11")
   |

src/domain/value_objects/child_age.py:39:74: PLR2004 Magic value used in comparison, consider replacing `11` with a constant variable
   |
37 |                 "COPPA compliance: Children over 13 require different handling",
38 |             )
39 |         if self.months is not None and (self.months < 0 or self.months > 11):
   |                                                                          ^^ PLR2004
40 |             raise ValueError("Months must be between 0 and 11")
   |

src/domain/value_objects/child_age.py:40:19: TRY003 Avoid specifying long messages outside the exception class
   |
38 |             )
39 |         if self.months is not None and (self.months < 0 or self.months > 11):
40 |             raise ValueError("Months must be between 0 and 11")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
41 |
42 |     @property
   |

src/domain/value_objects/child_age.py:50:26: PLR2004 Magic value used in comparison, consider replacing `3` with a constant variable
   |
48 |     def category(self) -> AgeCategory:
49 |         """Age category for content filtering."""
50 |         if self.years <= 3:
   |                          ^ PLR2004
51 |             return AgeCategory.TODDLER
52 |         if self.years <= 5:
   |

src/domain/value_objects/child_age.py:52:26: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
   |
50 |         if self.years <= 3:
51 |             return AgeCategory.TODDLER
52 |         if self.years <= 5:
   |                          ^ PLR2004
53 |             return AgeCategory.PRESCHOOL
54 |         if self.years <= 8:
   |

src/domain/value_objects/child_age.py:54:26: PLR2004 Magic value used in comparison, consider replacing `8` with a constant variable
   |
52 |         if self.years <= 5:
53 |             return AgeCategory.PRESCHOOL
54 |         if self.years <= 8:
   |                          ^ PLR2004
55 |             return AgeCategory.EARLY_CHILD
56 |         if self.years <= 11:
   |

src/domain/value_objects/child_age.py:56:26: PLR2004 Magic value used in comparison, consider replacing `11` with a constant variable
   |
54 |         if self.years <= 8:
55 |             return AgeCategory.EARLY_CHILD
56 |         if self.years <= 11:
   |                          ^^ PLR2004
57 |             return AgeCategory.MIDDLE_CHILD
58 |         return AgeCategory.PRETEEN
   |

src/domain/value_objects/child_age.py:63:29: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
   |
61 |     def is_coppa_protected(self) -> bool:
62 |         """Check if child is under COPPA protection (under 13)."""
63 |         return self.years < 13
   |                             ^^ PLR2004
64 |
65 |     @property
   |

src/domain/value_objects/child_age.py:73:26: PLR2004 Magic value used in comparison, consider replacing `3` with a constant variable
   |
71 |     def max_session_minutes(self) -> int:
72 |         """Recommended maximum session length in minutes."""
73 |         if self.years <= 3:
   |                          ^ PLR2004
74 |             return 10
75 |         if self.years <= 5:
   |

src/domain/value_objects/child_age.py:75:26: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
   |
73 |         if self.years <= 3:
74 |             return 10
75 |         if self.years <= 5:
   |                          ^ PLR2004
76 |             return 15
77 |         if self.years <= 8:
   |

src/domain/value_objects/child_age.py:77:26: PLR2004 Magic value used in comparison, consider replacing `8` with a constant variable
   |
75 |         if self.years <= 5:
76 |             return 15
77 |         if self.years <= 8:
   |                          ^ PLR2004
78 |             return 30
79 |         if self.years <= 11:
   |

src/domain/value_objects/child_age.py:79:26: PLR2004 Magic value used in comparison, consider replacing `11` with a constant variable
   |
77 |         if self.years <= 8:
78 |             return 30
79 |         if self.years <= 11:
   |                          ^^ PLR2004
80 |             return 45
81 |         return 60
   |

src/domain/value_objects/child_age.py:86:26: PLR2004 Magic value used in comparison, consider replacing `3` with a constant variable
   |
84 |     def content_complexity_level(self) -> int:
85 |         """Content complexity level (1-5)."""
86 |         if self.years <= 3:
   |                          ^ PLR2004
87 |             return 1
88 |         if self.years <= 5:
   |

src/domain/value_objects/child_age.py:88:26: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
   |
86 |         if self.years <= 3:
87 |             return 1
88 |         if self.years <= 5:
   |                          ^ PLR2004
89 |             return 2
90 |         if self.years <= 8:
   |

src/domain/value_objects/child_age.py:90:26: PLR2004 Magic value used in comparison, consider replacing `8` with a constant variable
   |
88 |         if self.years <= 5:
89 |             return 2
90 |         if self.years <= 8:
   |                          ^ PLR2004
91 |             return 3
92 |         if self.years <= 11:
   |

src/domain/value_objects/child_age.py:92:26: PLR2004 Magic value used in comparison, consider replacing `11` with a constant variable
   |
90 |         if self.years <= 8:
91 |             return 3
92 |         if self.years <= 11:
   |                          ^^ PLR2004
93 |             return 4
94 |         return 5
   |

src/domain/value_objects/child_age.py:100:26: PLR2004 Magic value used in comparison, consider replacing `4` with a constant variable
    |
 98 |         """Age-appropriate topic recommendations."""
 99 |         base_topics = ["animals", "colors", "shapes", "family"]
100 |         if self.years >= 4:
    |                          ^ PLR2004
101 |             base_topics.extend(["stories", "numbers", "letters"])
102 |         if self.years >= 6:
    |

src/domain/value_objects/child_age.py:102:26: PLR2004 Magic value used in comparison, consider replacing `6` with a constant variable
    |
100 |         if self.years >= 4:
101 |             base_topics.extend(["stories", "numbers", "letters"])
102 |         if self.years >= 6:
    |                          ^ PLR2004
103 |             base_topics.extend(["science", "nature", "friendship"])
104 |         if self.years >= 8:
    |

src/domain/value_objects/child_age.py:104:26: PLR2004 Magic value used in comparison, consider replacing `8` with a constant variable
    |
102 |         if self.years >= 6:
103 |             base_topics.extend(["science", "nature", "friendship"])
104 |         if self.years >= 8:
    |                          ^ PLR2004
105 |             base_topics.extend(["geography", "history", "culture"])
106 |         if self.years >= 10:
    |

src/domain/value_objects/child_age.py:106:26: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
    |
104 |         if self.years >= 8:
105 |             base_topics.extend(["geography", "history", "culture"])
106 |         if self.years >= 10:
    |                          ^^ PLR2004
107 |             base_topics.extend(["technology", "environment", "creativity"])
108 |         return base_topics
    |

src/domain/value_objects/child_age.py:115:46: PLR2004 Magic value used in comparison, consider replacing `8` with a constant variable
    |
113 |         return {
114 |             "no_personal_info": True,
115 |             "no_scary_content": self.years < 8,
    |                                              ^ PLR2004
116 |             "simple_language": self.years < 6,
117 |             "short_responses": self.years < 8,
    |

src/domain/value_objects/child_age.py:116:45: PLR2004 Magic value used in comparison, consider replacing `6` with a constant variable
    |
114 |             "no_personal_info": True,
115 |             "no_scary_content": self.years < 8,
116 |             "simple_language": self.years < 6,
    |                                             ^ PLR2004
117 |             "short_responses": self.years < 8,
118 |             "positive_only": self.years < 5,
    |

src/domain/value_objects/child_age.py:117:45: PLR2004 Magic value used in comparison, consider replacing `8` with a constant variable
    |
115 |             "no_scary_content": self.years < 8,
116 |             "simple_language": self.years < 6,
117 |             "short_responses": self.years < 8,
    |                                             ^ PLR2004
118 |             "positive_only": self.years < 5,
119 |             "educational_focus": True,
    |

src/domain/value_objects/child_age.py:118:43: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
    |
116 |             "simple_language": self.years < 6,
117 |             "short_responses": self.years < 8,
118 |             "positive_only": self.years < 5,
    |                                           ^ PLR2004
119 |             "educational_focus": True,
120 |             "parental_oversight": self.is_coppa_protected,
    |

src/domain/value_objects/child_age.py:135:26: PLR2004 Magic value used in comparison, consider replacing `6` with a constant variable
    |
133 |             "educational_level": "basic",
134 |         }
135 |         if self.years >= 6:
    |                          ^ PLR2004
136 |             guidelines.update(
137 |                 {
    |

src/domain/value_objects/child_age.py:143:26: PLR2004 Magic value used in comparison, consider replacing `9` with a constant variable
    |
141 |                 },
142 |             )
143 |         if self.years >= 9:
    |                          ^ PLR2004
144 |             guidelines.update(
145 |                 {
    |

src/domain/value_objects/child_age.py:151:26: PLR2004 Magic value used in comparison, consider replacing `12` with a constant variable
    |
149 |                 },
150 |             )
151 |         if self.years >= 12:
    |                          ^^ PLR2004
152 |             guidelines.update(
153 |                 {
    |

src/domain/value_objects/child_age.py:187:12: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
    |
185 | def create_toddler_age(years: int = 3) -> ChildAge:
186 |     """Create toddler age (2-3 years)."""
187 |     if not 2 <= years <= 3:
    |            ^ PLR2004
188 |         raise ValueError("Toddler age must be 2-3 years")
189 |     return ChildAge.from_years(years)
    |

src/domain/value_objects/child_age.py:187:26: PLR2004 Magic value used in comparison, consider replacing `3` with a constant variable
    |
185 | def create_toddler_age(years: int = 3) -> ChildAge:
186 |     """Create toddler age (2-3 years)."""
187 |     if not 2 <= years <= 3:
    |                          ^ PLR2004
188 |         raise ValueError("Toddler age must be 2-3 years")
189 |     return ChildAge.from_years(years)
    |

src/domain/value_objects/child_age.py:188:15: TRY003 Avoid specifying long messages outside the exception class
    |
186 |     """Create toddler age (2-3 years)."""
187 |     if not 2 <= years <= 3:
188 |         raise ValueError("Toddler age must be 2-3 years")
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
189 |     return ChildAge.from_years(years)
    |

src/domain/value_objects/child_age.py:194:12: PLR2004 Magic value used in comparison, consider replacing `4` with a constant variable
    |
192 | def create_preschool_age(years: int = 5) -> ChildAge:
193 |     """Create preschool age (4-5 years)."""
194 |     if not 4 <= years <= 5:
    |            ^ PLR2004
195 |         raise ValueError("Preschool age must be 4-5 years")
196 |     return ChildAge.from_years(years)
    |

src/domain/value_objects/child_age.py:194:26: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
    |
192 | def create_preschool_age(years: int = 5) -> ChildAge:
193 |     """Create preschool age (4-5 years)."""
194 |     if not 4 <= years <= 5:
    |                          ^ PLR2004
195 |         raise ValueError("Preschool age must be 4-5 years")
196 |     return ChildAge.from_years(years)
    |

src/domain/value_objects/child_age.py:195:15: TRY003 Avoid specifying long messages outside the exception class
    |
193 |     """Create preschool age (4-5 years)."""
194 |     if not 4 <= years <= 5:
195 |         raise ValueError("Preschool age must be 4-5 years")
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
196 |     return ChildAge.from_years(years)
    |

src/domain/value_objects/child_age.py:201:12: PLR2004 Magic value used in comparison, consider replacing `6` with a constant variable
    |
199 | def create_school_age(years: int = 8) -> ChildAge:
200 |     """Create school age (6-11 years)."""
201 |     if not 6 <= years <= 11:
    |            ^ PLR2004
202 |         raise ValueError("School age must be 6-11 years")
203 |     return ChildAge.from_years(years)
    |

src/domain/value_objects/child_age.py:201:26: PLR2004 Magic value used in comparison, consider replacing `11` with a constant variable
    |
199 | def create_school_age(years: int = 8) -> ChildAge:
200 |     """Create school age (6-11 years)."""
201 |     if not 6 <= years <= 11:
    |                          ^^ PLR2004
202 |         raise ValueError("School age must be 6-11 years")
203 |     return ChildAge.from_years(years)
    |

src/domain/value_objects/child_age.py:202:15: TRY003 Avoid specifying long messages outside the exception class
    |
200 |     """Create school age (6-11 years)."""
201 |     if not 6 <= years <= 11:
202 |         raise ValueError("School age must be 6-11 years")
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
203 |     return ChildAge.from_years(years)
    |

src/domain/value_objects/child_age.py:208:12: PLR2004 Magic value used in comparison, consider replacing `12` with a constant variable
    |
206 | def create_preteen_age(years: int = 12) -> ChildAge:
207 |     """Create preteen age (12-13 years)."""
208 |     if not 12 <= years <= 13:
    |            ^^ PLR2004
209 |         raise ValueError("Preteen age must be 12-13 years")
210 |     return ChildAge.from_years(years)
    |

src/domain/value_objects/child_age.py:208:27: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
    |
206 | def create_preteen_age(years: int = 12) -> ChildAge:
207 |     """Create preteen age (12-13 years)."""
208 |     if not 12 <= years <= 13:
    |                           ^^ PLR2004
209 |         raise ValueError("Preteen age must be 12-13 years")
210 |     return ChildAge.from_years(years)
    |

src/domain/value_objects/child_age.py:209:15: TRY003 Avoid specifying long messages outside the exception class
    |
207 |     """Create preteen age (12-13 years)."""
208 |     if not 12 <= years <= 13:
209 |         raise ValueError("Preteen age must be 12-13 years")
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
210 |     return ChildAge.from_years(years)
    |

src/domain/value_objects/child_name.py:14:19: TRY003 Avoid specifying long messages outside the exception class
   |
12 |     def __post_init__(self):
13 |         if not self.value or not self.value.strip():
14 |             raise ValueError("Child name cannot be empty.")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
15 |         if len(self.value) > 100:
16 |             raise ValueError("Child name is too long.")
   |

src/domain/value_objects/child_name.py:15:30: PLR2004 Magic value used in comparison, consider replacing `100` with a constant variable
   |
13 |         if not self.value or not self.value.strip():
14 |             raise ValueError("Child name cannot be empty.")
15 |         if len(self.value) > 100:
   |                              ^^^ PLR2004
16 |             raise ValueError("Child name is too long.")
   |

src/domain/value_objects/child_name.py:16:19: TRY003 Avoid specifying long messages outside the exception class
   |
14 |             raise ValueError("Child name cannot be empty.")
15 |         if len(self.value) > 100:
16 |             raise ValueError("Child name is too long.")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
   |

src/domain/value_objects/child_preferences.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Child Preferences Value Object - Domain Layer
2 | | This module provides child preference modeling without external dependencies,
3 | | maintaining clean domain architecture.
4 | | """
  | |___^ D205
5 |
6 |   from dataclasses import dataclass, field
  |
  = help: Insert single blank line

src/domain/value_objects/child_preferences.py:6:1: I001 [*] Import block is un-sorted or un-formatted
  |
4 |   """
5 |
6 | / from dataclasses import dataclass, field
7 | | from enum import Enum
  | |_____________________^ I001
  |
  = help: Organize imports

src/domain/value_objects/child_preferences.py:14:1: W293 [*] Blank line contains whitespace
   |
12 | class AgeGroup(Enum):
13 |     """Age groups for children with safety-appropriate categorization."""
14 |     
   | ^^^^ W293
15 |     TODDLER = "toddler"
16 |     PRESCHOOL = "preschool"
   |
   = help: Remove whitespace from blank line

src/domain/value_objects/child_preferences.py:25:24: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
   |
23 |     def from_age(age: int) -> "AgeGroup":
24 |         """Convert numeric age to appropriate age group."""
25 |         if 0 <= age <= 2:
   |                        ^ PLR2004
26 |             return AgeGroup.TODDLER
27 |         if 3 <= age <= 5:
   |

src/domain/value_objects/child_preferences.py:27:12: PLR2004 Magic value used in comparison, consider replacing `3` with a constant variable
   |
25 |         if 0 <= age <= 2:
26 |             return AgeGroup.TODDLER
27 |         if 3 <= age <= 5:
   |            ^ PLR2004
28 |             return AgeGroup.PRESCHOOL
29 |         if 6 <= age <= 8:
   |

src/domain/value_objects/child_preferences.py:27:24: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
   |
25 |         if 0 <= age <= 2:
26 |             return AgeGroup.TODDLER
27 |         if 3 <= age <= 5:
   |                        ^ PLR2004
28 |             return AgeGroup.PRESCHOOL
29 |         if 6 <= age <= 8:
   |

src/domain/value_objects/child_preferences.py:29:12: PLR2004 Magic value used in comparison, consider replacing `6` with a constant variable
   |
27 |         if 3 <= age <= 5:
28 |             return AgeGroup.PRESCHOOL
29 |         if 6 <= age <= 8:
   |            ^ PLR2004
30 |             return AgeGroup.EARLY_SCHOOL
31 |         if 9 <= age <= 12:
   |

src/domain/value_objects/child_preferences.py:29:24: PLR2004 Magic value used in comparison, consider replacing `8` with a constant variable
   |
27 |         if 3 <= age <= 5:
28 |             return AgeGroup.PRESCHOOL
29 |         if 6 <= age <= 8:
   |                        ^ PLR2004
30 |             return AgeGroup.EARLY_SCHOOL
31 |         if 9 <= age <= 12:
   |

src/domain/value_objects/child_preferences.py:31:12: PLR2004 Magic value used in comparison, consider replacing `9` with a constant variable
   |
29 |         if 6 <= age <= 8:
30 |             return AgeGroup.EARLY_SCHOOL
31 |         if 9 <= age <= 12:
   |            ^ PLR2004
32 |             return AgeGroup.SCHOOL_AGE
33 |         if 13 <= age <= 15:
   |

src/domain/value_objects/child_preferences.py:31:24: PLR2004 Magic value used in comparison, consider replacing `12` with a constant variable
   |
29 |         if 6 <= age <= 8:
30 |             return AgeGroup.EARLY_SCHOOL
31 |         if 9 <= age <= 12:
   |                        ^^ PLR2004
32 |             return AgeGroup.SCHOOL_AGE
33 |         if 13 <= age <= 15:
   |

src/domain/value_objects/child_preferences.py:33:12: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
   |
31 |         if 9 <= age <= 12:
32 |             return AgeGroup.SCHOOL_AGE
33 |         if 13 <= age <= 15:
   |            ^^ PLR2004
34 |             return AgeGroup.PRE_TEEN
35 |         return AgeGroup.TEEN
   |

src/domain/value_objects/child_preferences.py:33:25: PLR2004 Magic value used in comparison, consider replacing `15` with a constant variable
   |
31 |         if 9 <= age <= 12:
32 |             return AgeGroup.SCHOOL_AGE
33 |         if 13 <= age <= 15:
   |                         ^^ PLR2004
34 |             return AgeGroup.PRE_TEEN
35 |         return AgeGroup.TEEN
   |

src/domain/value_objects/child_preferences.py:41:1: W293 [*] Blank line contains whitespace
   |
39 | class ChildPreferences:
40 |     """Value object for child preferences and settings."""
41 |     
   | ^^^^ W293
42 |     language: str = "en"
43 |     interests: list[str] = field(default_factory=list)
   |
   = help: Remove whitespace from blank line

src/domain/value_objects/child_preferences.py:50:1: W293 [*] Blank line contains whitespace
   |
48 |     audio_preferences: dict[str, any] = field(default_factory=dict)
49 |     age_group: AgeGroup = None
50 |     
   | ^^^^ W293
51 |     def __post_init__(self):
52 |         """Validate preferences after initialization."""
   |
   = help: Remove whitespace from blank line

src/domain/value_objects/child_preferences.py:56:1: W293 [*] Blank line contains whitespace
   |
54 |         if not self.language:
55 |             self.language = "en"
56 |         
   | ^^^^^^^^ W293
57 |         # Validate learning pace
58 |         valid_paces = ["slow", "medium", "fast", "adaptive"]
   |
   = help: Remove whitespace from blank line

src/domain/value_objects/child_preferences.py:61:1: W293 [*] Blank line contains whitespace
   |
59 |         if self.learning_pace not in valid_paces:
60 |             self.learning_pace = "medium"
61 |     
   | ^^^^ W293
62 |     def to_dict(self) -> dict[str, any]:
63 |         """Convert to dictionary representation."""
   |
   = help: Remove whitespace from blank line

src/domain/value_objects/child_preferences.py:74:1: W293 [*] Blank line contains whitespace
   |
72 |             "age_group": self.age_group.value if self.age_group else None
73 |         }
74 |     
   | ^^^^ W293
75 |     @classmethod
76 |     def from_dict(cls, data: dict[str, any]) -> "ChildPreferences":
   |
   = help: Remove whitespace from blank line

src/domain/value_objects/child_preferences.py:79:12: RUF019 [*] Unnecessary key check before dictionary access
   |
77 |         """Create from dictionary representation."""
78 |         age_group = None
79 |         if "age_group" in data and data["age_group"]:
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ RUF019
80 |             age_group = AgeGroup(data["age_group"])
   |
   = help: Replace with `dict.get`

src/domain/value_objects/child_preferences.py:81:1: W293 [*] Blank line contains whitespace
   |
79 |         if "age_group" in data and data["age_group"]:
80 |             age_group = AgeGroup(data["age_group"])
81 |         
   | ^^^^^^^^ W293
82 |         return cls(
83 |             language=data.get("language", "en"),
   |
   = help: Remove whitespace from blank line

src/domain/value_objects/child_preferences.py:92:1: W293 [*] Blank line contains whitespace
   |
90 |             age_group=age_group
91 |         )
92 |     
   | ^^^^ W293
93 |     def get_content_filters(self) -> dict[str, any]:
94 |         """Get content filtering rules based on preferences."""
   |
   = help: Remove whitespace from blank line

src/domain/value_objects/encrypted_field.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Encrypted Field Value Object for Sensitive Data Protection
2 | | Pure domain implementation that delegates encryption to infrastructure services
3 | | while maintaining clean architectural boundaries.
4 | | """
  | |___^ D205
5 |
6 |   from typing import Any
  |
  = help: Insert single blank line

src/domain/value_objects/encrypted_field.py:15:7: PLW1641 Object does not implement `__hash__` method
   |
15 | class EncryptedField(SecureFieldInterface[Any]):
   |       ^^^^^^^^^^^^^^ PLW1641
16 |     """Value object for encrypted storage of sensitive data.
17 |     Provides transparent encryption/decryption for HIPAA/COPPA compliance.
   |

src/domain/value_objects/encrypted_field.py:16:5: D205 1 blank line required between summary line and description
   |
15 |   class EncryptedField(SecureFieldInterface[Any]):
16 | /     """Value object for encrypted storage of sensitive data.
17 | |     Provides transparent encryption/decryption for HIPAA/COPPA compliance.
18 | |     Uses dependency injection for encryption service to maintain clean architecture.
19 | |     """
   | |_______^ D205
20 |
21 |       def __init__(
   |
   = help: Insert single blank line

src/domain/value_objects/language.py:17:15: TRY003 Avoid specifying long messages outside the exception class
   |
15 |             if lang.value == code.lower():
16 |                 return lang
17 |         raise ValueError(f"Unsupported language code: {code}")
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
   |

src/domain/value_objects/personality.py:26:89: E501 Line too long (96 > 88)
   |
24 |     Attributes:
25 |         child_id (UUID): The unique identifier of the child.
26 |         personality_type (PersonalityType): The primary personality type inferred for the child.
   |                                                                                         ^^^^^^^^ E501
27 |         traits (Dict[str, float]): A dictionary of personality traits and their scores (e.g., {"openness": 0.7}).
28 |         learning_style (List[str]): Preferred learning styles (e.g., ["visual", "auditory"]).
   |

src/domain/value_objects/personality.py:27:89: E501 Line too long (113 > 88)
   |
25 |         child_id (UUID): The unique identifier of the child.
26 |         personality_type (PersonalityType): The primary personality type inferred for the child.
27 |         traits (Dict[str, float]): A dictionary of personality traits and their scores (e.g., {"openness": 0.7}).
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^ E501
28 |         learning_style (List[str]): Preferred learning styles (e.g., ["visual", "auditory"]).
29 |         interests (List[str]): Key interests of the child.
   |

src/domain/value_objects/personality.py:28:89: E501 Line too long (93 > 88)
   |
26 |         personality_type (PersonalityType): The primary personality type inferred for the child.
27 |         traits (Dict[str, float]): A dictionary of personality traits and their scores (e.g., {"openness": 0.7}).
28 |         learning_style (List[str]): Preferred learning styles (e.g., ["visual", "auditory"]).
   |                                                                                         ^^^^^ E501
29 |         interests (List[str]): Key interests of the child.
30 |         last_updated (datetime): Timestamp of the last update to the personality profile.
   |

src/domain/value_objects/personality.py:30:89: E501 Line too long (89 > 88)
   |
28 |         learning_style (List[str]): Preferred learning styles (e.g., ["visual", "auditory"]).
29 |         interests (List[str]): Key interests of the child.
30 |         last_updated (datetime): Timestamp of the last update to the personality profile.
   |                                                                                         ^ E501
31 |         metadata (Dict[str, Any]): Additional metadata or raw analysis results.
   |

src/domain/value_objects/safety_level.py:1:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | from enum import Enum
  | ^^^^^^^^^^^^^^^^^^^^^ I001
2 |
3 | class SafetyLevel(str, Enum):
  |
  = help: Organize imports

src/domain/value_objects/safety_level.py:19:89: E501 Line too long (121 > 88)
   |
17 |     def is_safe(self) -> bool:
18 |         # عدل هذا المنطق حسب ما يعتبر "آمن" فعلاً في مشروعك
19 |         return self in [SafetyLevel.NONE, SafetyLevel.LOW, SafetyLevel.STRICT, SafetyLevel.MODERATE, SafetyLevel.RELAXED]
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
20 |
21 |     @property
   |

src/infrastructure/adapters/encryption_adapter.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Encryption Service Adapter
2 | | Implements the domain encryption interface using infrastructure encryption services,
3 | | maintaining Hexagonal Architecture separation of concerns.
4 | | """
  | |___^ D205
5 |
6 |   from src.domain.interfaces.encryption_interface import (
  |
  = help: Insert single blank line

src/infrastructure/adapters/encryption_adapter.py:12:5: D205 1 blank line required between summary line and description
   |
11 |   class InfrastructureEncryptionAdapter(EncryptionServiceInterface):
12 | /     """Adapter that implements domain encryption interface using infrastructure services.
13 | |     This adapter allows the domain layer to use encryption without coupling
14 | |     to specific infrastructure implementations.
15 | |     """
   | |_______^ D205
16 |
17 |       def __init__(self) -> None:
   |
   = help: Insert single blank line

src/infrastructure/adapters/encryption_adapter.py:12:89: E501 Line too long (89 > 88)
   |
11 | class InfrastructureEncryptionAdapter(EncryptionServiceInterface):
12 |     """Adapter that implements domain encryption interface using infrastructure services.
   |                                                                                         ^ E501
13 |     This adapter allows the domain layer to use encryption without coupling
14 |     to specific infrastructure implementations.
   |

src/infrastructure/adapters/encryption_adapter.py:26:17: PLC0415 `import` should be at the top-level of a file
   |
24 |           if not self._initialized:
25 |               try:
26 | /                 from ..security.encryption_service import (
27 | |                     get_encryption_service,
28 | |                 )
   | |_________________^ PLC0415
29 |
30 |                   self._service = get_encryption_service()
   |

src/infrastructure/adapters/encryption_adapter.py:26:17: TID252 Prefer absolute imports over relative imports from parent modules
   |
24 |           if not self._initialized:
25 |               try:
26 | /                 from ..security.encryption_service import (
27 | |                     get_encryption_service,
28 | |                 )
   | |_________________^ TID252
29 |
30 |                   self._service = get_encryption_service()
   |
   = help: Replace relative imports from parent modules with absolute imports

src/infrastructure/adapters/encryption_adapter.py:66:12: PLW0603 Using the global statement to update `_encryption_adapter` is discouraged
   |
64 | def get_encryption_adapter() -> InfrastructureEncryptionAdapter:
65 |     """Get or create global encryption adapter instance."""
66 |     global _encryption_adapter
   |            ^^^^^^^^^^^^^^^^^^^ PLW0603
67 |     if _encryption_adapter is None:
68 |         _encryption_adapter = InfrastructureEncryptionAdapter()
   |

src/infrastructure/ai/chatgpt/__init__.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """ChatGPT Integration Module for AI Teddy Bear"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | from .client import ChatGPTClient
  |
  = help: Add closing punctuation

src/infrastructure/ai/chatgpt/client.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """ChatGPT Client for AI Teddy Bear - Main Client Class"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | import os
  |
  = help: Add closing punctuation

src/infrastructure/ai/chatgpt/client.py:13:11: TRY003 Avoid specifying long messages outside the exception class
   |
11 |   except ImportError as e:
12 |       # Production environment MUST have OpenAI dependency
13 |       raise ImportError(
   |  ___________^
14 | |         "CRITICAL: OpenAI package is required for production deployment. "
15 | |         "Install with: pip install openai"
16 | |     ) from e
   | |_____^ TRY003
17 |
18 |   from src.infrastructure.logging_config import get_logger
   |

src/infrastructure/ai/chatgpt/client.py:37:33: RUF013 PEP 484 prohibits implicit `Optional`
   |
35 |     """ChatGPT client with child safety filtering and content moderation."""
36 |
37 |     def __init__(self, api_key: str = None) -> None:
   |                                 ^^^ RUF013
38 |         self.api_key = api_key or os.getenv("OPENAI_API_KEY")
39 |         if not self.api_key:
   |
   = help: Convert to `T | None`

src/infrastructure/ai/chatgpt/client.py:40:19: TRY003 Avoid specifying long messages outside the exception class
   |
38 |           self.api_key = api_key or os.getenv("OPENAI_API_KEY")
39 |           if not self.api_key:
40 |               raise ValueError(
   |  ___________________^
41 | |                 "CRITICAL: OpenAI API key is required for production deployment. "
42 | |                 "Set OPENAI_API_KEY environment variable or pass api_key parameter."
43 | |             )
   | |_____________^ TRY003
44 |           # Initialize OpenAI client - no fallback in production
45 |           self.client = OpenAI(api_key=self.api_key)
   |

src/infrastructure/ai/chatgpt/client.py:55:28: RUF013 PEP 484 prohibits implicit `Optional`
   |
53 |         message: str,
54 |         child_age: int,
55 |         child_preferences: dict[str, Any] = None,
   |                            ^^^^^^^^^^^^^^ RUF013
56 |     ) -> dict[str, Any]:
57 |         """Generate child-safe response from ChatGPT with content filtering."""
   |
   = help: Convert to `T | None`

src/infrastructure/ai/chatgpt/client.py:103:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
101 |             }
102 |         except Exception as e:
103 |             logger.error(f"ChatGPT API error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
104 |             return await self.fallback_generator.generate_fallback_response(
105 |                 message, child_age, child_preferences
    |
    = help: Replace with `exception`

src/infrastructure/ai/chatgpt/client.py:109:44: RUF013 PEP 484 prohibits implicit `Optional`
    |
108 |     def _create_child_safe_system_prompt(
109 |         self, child_age: int, preferences: dict[str, Any] = None
    |                                            ^^^^^^^^^^^^^^ RUF013
110 |     ) -> str:
111 |         """Create child-safe system prompt with age-appropriate guidelines."""
    |
    = help: Convert to `T | None`

src/infrastructure/ai/chatgpt/client.py:119:89: E501 Line too long (90 > 88)
    |
117 |         age_guidance = {
118 |             3: "Use very simple words and short sentences. Focus on basic concepts.",
119 |             4: "Use simple words and short sentences. Include fun sounds and repetition.",
    |                                                                                         ^^ E501
120 |             5: "Use simple vocabulary. Include basic learning concepts like colors and numbers.",
121 |             6: "Use age-appropriate vocabulary. Include educational content about nature and friendship.",
    |

src/infrastructure/ai/chatgpt/client.py:120:89: E501 Line too long (97 > 88)
    |
118 |             3: "Use very simple words and short sentences. Focus on basic concepts.",
119 |             4: "Use simple words and short sentences. Include fun sounds and repetition.",
120 |             5: "Use simple vocabulary. Include basic learning concepts like colors and numbers.",
    |                                                                                         ^^^^^^^^^ E501
121 |             6: "Use age-appropriate vocabulary. Include educational content about nature and friendship.",
122 |             7: "Use clear, friendly language. Include more detailed explanations about the world.",
    |

src/infrastructure/ai/chatgpt/client.py:121:89: E501 Line too long (106 > 88)
    |
119 |             4: "Use simple words and short sentences. Include fun sounds and repetition.",
120 |             5: "Use simple vocabulary. Include basic learning concepts like colors and numbers.",
121 |             6: "Use age-appropriate vocabulary. Include educational content about nature and friendship.",
    |                                                                                         ^^^^^^^^^^^^^^^^^^ E501
122 |             7: "Use clear, friendly language. Include more detailed explanations about the world.",
123 |             8: "Use engaging language. Include problem-solving and creativity encouragement.",
    |

src/infrastructure/ai/chatgpt/client.py:122:89: E501 Line too long (99 > 88)
    |
120 |             5: "Use simple vocabulary. Include basic learning concepts like colors and numbers.",
121 |             6: "Use age-appropriate vocabulary. Include educational content about nature and friendship.",
122 |             7: "Use clear, friendly language. Include more detailed explanations about the world.",
    |                                                                                         ^^^^^^^^^^^ E501
123 |             8: "Use engaging language. Include problem-solving and creativity encouragement.",
124 |             9: "Use varied vocabulary. Include more complex concepts explained simply.",
    |

src/infrastructure/ai/chatgpt/client.py:123:89: E501 Line too long (94 > 88)
    |
121 |             6: "Use age-appropriate vocabulary. Include educational content about nature and friendship.",
122 |             7: "Use clear, friendly language. Include more detailed explanations about the world.",
123 |             8: "Use engaging language. Include problem-solving and creativity encouragement.",
    |                                                                                         ^^^^^^ E501
124 |             9: "Use varied vocabulary. Include more complex concepts explained simply.",
125 |             10: "Use rich vocabulary. Include critical thinking and exploration topics.",
    |

src/infrastructure/ai/chatgpt/client.py:125:89: E501 Line too long (89 > 88)
    |
123 |             8: "Use engaging language. Include problem-solving and creativity encouragement.",
124 |             9: "Use varied vocabulary. Include more complex concepts explained simply.",
125 |             10: "Use rich vocabulary. Include critical thinking and exploration topics.",
    |                                                                                         ^ E501
126 |         }
127 |         age_specific = age_guidance.get(child_age, age_guidance[6])
    |

src/infrastructure/ai/chatgpt/client.py:128:89: E501 Line too long (111 > 88)
    |
126 |         }
127 |         age_specific = age_guidance.get(child_age, age_guidance[6])
128 |         return f"""You are a friendly, caring AI assistant designed specifically for children aged {child_age}.
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^ E501
129 |
130 | SAFETY RULES (NEVER BREAK THESE):
    |

src/infrastructure/ai/chatgpt/client.py:165:89: E501 Line too long (113 > 88)
    |
163 | - Stories, imagination, creativity
164 |
165 | Remember: You are talking to a {child_age}-year-old child. Be their friendly, safe, and educational companion."""
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^ E501
    |

src/infrastructure/ai/chatgpt/fallback_responses.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Fallback Response Generator for ChatGPT - Safe Responses When API Fails"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | import random
  |
  = help: Add closing punctuation

src/infrastructure/ai/chatgpt/fallback_responses.py:13:5: D415 First line should end with a period, question mark, or exclamation point
   |
12 | class FallbackResponseGenerator:
13 |     """مولد الاستجابات الاحتياطية الآمنة"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
14 |
15 |     def __init__(self) -> None:
   |
   = help: Add closing punctuation

src/infrastructure/ai/chatgpt/fallback_responses.py:43:89: E501 Line too long (96 > 88)
   |
41 |             ],
42 |             7: [
43 |                 "What an thoughtful question! You're developing such great thinking skills! 📚",
   |                                                                                         ^^^^^^^^ E501
44 |                 "I admire how you approach new ideas! You're becoming quite the explorer!",
45 |                 "Your questions help me learn too! That's what friendship is about! 🎵",
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:44:89: E501 Line too long (91 > 88)
   |
42 |             7: [
43 |                 "What an thoughtful question! You're developing such great thinking skills! 📚",
44 |                 "I admire how you approach new ideas! You're becoming quite the explorer!",
   |                                                                                         ^^^ E501
45 |                 "Your questions help me learn too! That's what friendship is about! 🎵",
46 |                 "You have such a creative mind! I enjoy our conversations so much!",
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:49:89: E501 Line too long (98 > 88)
   |
47 |             ],
48 |             8: [
49 |                 "That's a really insightful question! You're thinking like a young scientist! 🔬",
   |                                                                                         ^^^^^^^^^^ E501
50 |                 "I love how you connect different ideas! Your mind works in amazing ways!",
51 |                 "You're asking questions that even grown-ups find interesting! Well done!",
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:50:89: E501 Line too long (91 > 88)
   |
48 |             8: [
49 |                 "That's a really insightful question! You're thinking like a young scientist! 🔬",
50 |                 "I love how you connect different ideas! Your mind works in amazing ways!",
   |                                                                                         ^^^ E501
51 |                 "You're asking questions that even grown-ups find interesting! Well done!",
52 |                 "Your curiosity and creativity inspire me! What shall we explore next?",
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:51:89: E501 Line too long (91 > 88)
   |
49 |                 "That's a really insightful question! You're thinking like a young scientist! 🔬",
50 |                 "I love how you connect different ideas! Your mind works in amazing ways!",
51 |                 "You're asking questions that even grown-ups find interesting! Well done!",
   |                                                                                         ^^^ E501
52 |                 "Your curiosity and creativity inspire me! What shall we explore next?",
53 |             ],
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:55:89: E501 Line too long (96 > 88)
   |
53 |             ],
54 |             9: [
55 |                 "What a sophisticated question! You're really developing critical thinking! 🎭",
   |                                                                                         ^^^^^^^^ E501
56 |                 "I'm impressed by how you analyze things! You're becoming quite the scholar!",
57 |                 "Your ability to think deeply about topics is remarkable for your age!",
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:56:89: E501 Line too long (94 > 88)
   |
54 |             9: [
55 |                 "What a sophisticated question! You're really developing critical thinking! 🎭",
56 |                 "I'm impressed by how you analyze things! You're becoming quite the scholar!",
   |                                                                                         ^^^^^^ E501
57 |                 "Your ability to think deeply about topics is remarkable for your age!",
58 |                 "You ask questions that show real wisdom! I enjoy our intellectual chats!",
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:58:89: E501 Line too long (91 > 88)
   |
56 |                 "I'm impressed by how you analyze things! You're becoming quite the scholar!",
57 |                 "Your ability to think deeply about topics is remarkable for your age!",
58 |                 "You ask questions that show real wisdom! I enjoy our intellectual chats!",
   |                                                                                         ^^^ E501
59 |             ],
60 |             10: [
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:62:89: E501 Line too long (98 > 88)
   |
60 |             10: [
61 |                 "That's a complex question that shows advanced thinking! Excellent! 🏆",
62 |                 "Your analytical skills are developing beautifully! You think like a researcher!",
   |                                                                                         ^^^^^^^^^^ E501
63 |                 "I'm amazed by your ability to see connections! You're quite the philosopher!",
64 |                 "Your questions challenge me to think deeper too! True learning partnership!",
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:63:89: E501 Line too long (95 > 88)
   |
61 |                 "That's a complex question that shows advanced thinking! Excellent! 🏆",
62 |                 "Your analytical skills are developing beautifully! You think like a researcher!",
63 |                 "I'm amazed by your ability to see connections! You're quite the philosopher!",
   |                                                                                         ^^^^^^^ E501
64 |                 "Your questions challenge me to think deeper too! True learning partnership!",
65 |             ],
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:64:89: E501 Line too long (94 > 88)
   |
62 |                 "Your analytical skills are developing beautifully! You think like a researcher!",
63 |                 "I'm amazed by your ability to see connections! You're quite the philosopher!",
64 |                 "Your questions challenge me to think deeper too! True learning partnership!",
   |                                                                                         ^^^^^^ E501
65 |             ],
66 |         }
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:74:89: E501 Line too long (99 > 88)
   |
72 |                 "How about we explore peaceful solutions? "
73 |                 "What activities make you feel happy and safe?",
74 |                 "Let's focus on positive things! Tell me about your favorite peaceful activities!",
   |                                                                                         ^^^^^^^^^^^ E501
75 |             ],
76 |             "scary": [
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:77:89: E501 Line too long (90 > 88)
   |
75 |             ],
76 |             "scary": [
77 |                 "That might be too scary for us! Let's talk about something fun instead! "
   |                                                                                         ^^ E501
78 |                 "What's your favorite adventure?",
79 |                 "How about we focus on exciting but safe adventures? "
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:85:89: E501 Line too long (89 > 88)
   |
83 |             ],
84 |             "inappropriate": [
85 |                 "That's a topic for grown-ups! Let's talk about something fun for kids! "
   |                                                                                         ^ E501
86 |                 "What's your favorite game?",
87 |                 "How about we explore something more suitable for young explorers like you? "
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:87:89: E501 Line too long (93 > 88)
   |
85 |                 "That's a topic for grown-ups! Let's talk about something fun for kids! "
86 |                 "What's your favorite game?",
87 |                 "How about we explore something more suitable for young explorers like you? "
   |                                                                                         ^^^^^ E501
88 |                 "What interests you?",
89 |                 "Let's focus on kid-friendly topics! Tell me about your hobbies and interests!",
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:89:89: E501 Line too long (96 > 88)
   |
87 |                 "How about we explore something more suitable for young explorers like you? "
88 |                 "What interests you?",
89 |                 "Let's focus on kid-friendly topics! Tell me about your hobbies and interests!",
   |                                                                                         ^^^^^^^^ E501
90 |             ],
91 |         }
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:94:89: E501 Line too long (105 > 88)
   |
92 |         # قصص قصيرة آمنة
93 |         self.mini_stories = [
94 |             "Once upon a time, a little bear found a magic paintbrush that painted rainbows in the sky!",
   |                                                                                         ^^^^^^^^^^^^^^^^^ E501
95 |             "In a beautiful garden, a butterfly and a flower became best friends and helped each other grow!",
96 |             "A young rabbit discovered that being kind to others made the whole forest a happier place!",
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:95:89: E501 Line too long (110 > 88)
   |
93 |         self.mini_stories = [
94 |             "Once upon a time, a little bear found a magic paintbrush that painted rainbows in the sky!",
95 |             "In a beautiful garden, a butterfly and a flower became best friends and helped each other grow!",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^ E501
96 |             "A young rabbit discovered that being kind to others made the whole forest a happier place!",
97 |             "A curious kitten learned that asking questions is the best way to discover wonderful things!",
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:96:89: E501 Line too long (105 > 88)
   |
94 |             "Once upon a time, a little bear found a magic paintbrush that painted rainbows in the sky!",
95 |             "In a beautiful garden, a butterfly and a flower became best friends and helped each other grow!",
96 |             "A young rabbit discovered that being kind to others made the whole forest a happier place!",
   |                                                                                         ^^^^^^^^^^^^^^^^^ E501
97 |             "A curious kitten learned that asking questions is the best way to discover wonderful things!",
98 |         ]
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:97:89: E501 Line too long (107 > 88)
   |
95 |             "In a beautiful garden, a butterfly and a flower became best friends and helped each other grow!",
96 |             "A young rabbit discovered that being kind to others made the whole forest a happier place!",
97 |             "A curious kitten learned that asking questions is the best way to discover wonderful things!",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^ E501
98 |         ]
99 |         # أنشطة تعليمية مقترحة
   |

src/infrastructure/ai/chatgpt/fallback_responses.py:109:15: ARG002 Unused method argument: `message`
    |
108 |     async def generate_fallback_response(
109 |         self, message: str, child_age: int, preferences: dict[str, Any] = None
    |               ^^^^^^^ ARG002
110 |     ) -> dict[str, Any]:
111 |         """توليد استجابة احتياطية آمنة"""
    |

src/infrastructure/ai/chatgpt/fallback_responses.py:109:58: RUF013 PEP 484 prohibits implicit `Optional`
    |
108 |     async def generate_fallback_response(
109 |         self, message: str, child_age: int, preferences: dict[str, Any] = None
    |                                                          ^^^^^^^^^^^^^^ RUF013
110 |     ) -> dict[str, Any]:
111 |         """توليد استجابة احتياطية آمنة"""
    |
    = help: Convert to `T | None`

src/infrastructure/ai/chatgpt/fallback_responses.py:111:9: D415 First line should end with a period, question mark, or exclamation point
    |
109 |         self, message: str, child_age: int, preferences: dict[str, Any] = None
110 |     ) -> dict[str, Any]:
111 |         """توليد استجابة احتياطية آمنة"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
112 |         preferences = preferences or {}
113 |         # اختيار استجابة مناسبة للعمر
    |
    = help: Add closing punctuation

src/infrastructure/ai/chatgpt/fallback_responses.py:117:25: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
    |
115 |             child_age, self.age_appropriate_responses[6]
116 |         )
117 |         base_response = random.choice(age_responses)
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ S311
118 |         # إضافة نشاط تعليمي
119 |         activity = random.choice(self.educational_activities)
    |

src/infrastructure/ai/chatgpt/fallback_responses.py:119:20: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
    |
117 |         base_response = random.choice(age_responses)
118 |         # إضافة نشاط تعليمي
119 |         activity = random.choice(self.educational_activities)
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ S311
120 |         # دمج الاستجابة
121 |         response_parts = [base_response, activity]
    |

src/infrastructure/ai/chatgpt/fallback_responses.py:123:12: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
    |
121 |         response_parts = [base_response, activity]
122 |         # إضافة قصة قصيرة أحياناً
123 |         if random.random() < 0.3:  # 30% من الوقت
    |            ^^^^^^^^^^^^^^^ S311
124 |             story = random.choice(self.mini_stories)
125 |             response_parts.append(f" Here's a little story for you: {story}")
    |

src/infrastructure/ai/chatgpt/fallback_responses.py:123:30: PLR2004 Magic value used in comparison, consider replacing `0.3` with a constant variable
    |
121 |         response_parts = [base_response, activity]
122 |         # إضافة قصة قصيرة أحياناً
123 |         if random.random() < 0.3:  # 30% من الوقت
    |                              ^^^ PLR2004
124 |             story = random.choice(self.mini_stories)
125 |             response_parts.append(f" Here's a little story for you: {story}")
    |

src/infrastructure/ai/chatgpt/fallback_responses.py:124:21: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
    |
122 |         # إضافة قصة قصيرة أحياناً
123 |         if random.random() < 0.3:  # 30% من الوقت
124 |             story = random.choice(self.mini_stories)
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ S311
125 |             response_parts.append(f" Here's a little story for you: {story}")
126 |         full_response = " ".join(response_parts)
    |

src/infrastructure/ai/chatgpt/fallback_responses.py:142:29: ARG002 Unused method argument: `child_age`
    |
141 |     async def generate_safety_redirect_response(
142 |         self, message: str, child_age: int
    |                             ^^^^^^^^^ ARG002
143 |     ) -> dict[str, Any]:
144 |         """توليد استجابة لإعادة التوجيه الآمن"""
    |

src/infrastructure/ai/chatgpt/fallback_responses.py:144:9: D415 First line should end with a period, question mark, or exclamation point
    |
142 |         self, message: str, child_age: int
143 |     ) -> dict[str, Any]:
144 |         """توليد استجابة لإعادة التوجيه الآمن"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
145 |         # تحديد نوع المحتوى غير المناسب
146 |         message_lower = message.lower()
    |
    = help: Add closing punctuation

src/infrastructure/ai/chatgpt/fallback_responses.py:158:29: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
    |
156 |             redirect_type, self.safety_redirect_responses["inappropriate"]
157 |         )
158 |         redirect_response = random.choice(redirect_responses)
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ S311
159 |         # إضافة نشاط بديل
160 |         activity = random.choice(self.educational_activities)
    |

src/infrastructure/ai/chatgpt/fallback_responses.py:160:20: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
    |
158 |         redirect_response = random.choice(redirect_responses)
159 |         # إضافة نشاط بديل
160 |         activity = random.choice(self.educational_activities)
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ S311
161 |         full_response = f"{redirect_response} {activity}"
162 |         return {
    |

src/infrastructure/ai/chatgpt/fallback_responses.py:177:9: D415 First line should end with a period, question mark, or exclamation point
    |
176 |     def generate_encouragement_response(self, child_age: int) -> str:
177 |         """توليد استجابة تشجيعية"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
178 |         encouragements = {
179 |             3: "You're such a good little one! Keep being curious! 🌟",
    |
    = help: Add closing punctuation

src/infrastructure/ai/chatgpt/fallback_responses.py:191:9: D415 First line should end with a period, question mark, or exclamation point
    |
190 |     def generate_learning_suggestion(self, topic: str, child_age: int) -> str:
191 |         """توليد اقتراح تعليمي"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^ D415
192 |         suggestions = {
193 |             "animals": f"Let's learn about different animals! Can you name {child_age} different animals?",
    |
    = help: Add closing punctuation

src/infrastructure/ai/chatgpt/fallback_responses.py:193:89: E501 Line too long (107 > 88)
    |
191 |         """توليد اقتراح تعليمي"""
192 |         suggestions = {
193 |             "animals": f"Let's learn about different animals! Can you name {child_age} different animals?",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^ E501
194 |             "colors": f"Colors are amazing! Can you find {child_age} different colors around you?",
195 |             "numbers": f"Numbers are everywhere! Let's count to {child_age * 2}!",
    |

src/infrastructure/ai/chatgpt/fallback_responses.py:194:89: E501 Line too long (99 > 88)
    |
192 |         suggestions = {
193 |             "animals": f"Let's learn about different animals! Can you name {child_age} different animals?",
194 |             "colors": f"Colors are amazing! Can you find {child_age} different colors around you?",
    |                                                                                         ^^^^^^^^^^^ E501
195 |             "numbers": f"Numbers are everywhere! Let's count to {child_age * 2}!",
196 |             "stories": f"Stories are magical! Would you like to create a story with {child_age} characters?",
    |

src/infrastructure/ai/chatgpt/fallback_responses.py:196:89: E501 Line too long (109 > 88)
    |
194 |             "colors": f"Colors are amazing! Can you find {child_age} different colors around you?",
195 |             "numbers": f"Numbers are everywhere! Let's count to {child_age * 2}!",
196 |             "stories": f"Stories are magical! Would you like to create a story with {child_age} characters?",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^ E501
197 |             "nature": f"Nature is wonderful! Can you think of {child_age} things you see in nature?",
198 |         }
    |

src/infrastructure/ai/chatgpt/fallback_responses.py:197:89: E501 Line too long (101 > 88)
    |
195 |             "numbers": f"Numbers are everywhere! Let's count to {child_age * 2}!",
196 |             "stories": f"Stories are magical! Would you like to create a story with {child_age} characters?",
197 |             "nature": f"Nature is wonderful! Can you think of {child_age} things you see in nature?",
    |                                                                                         ^^^^^^^^^^^^^ E501
198 |         }
199 |         return suggestions.get(
    |

src/infrastructure/ai/chatgpt/fallback_responses.py:205:15: ARG002 Unused method argument: `child_age`
    |
204 |     def get_conversation_starter(
205 |         self, child_age: int, interests: list[str] = None
    |               ^^^^^^^^^ ARG002
206 |     ) -> str:
207 |         """الحصول على بداية محادثة"""
    |

src/infrastructure/ai/chatgpt/fallback_responses.py:205:42: RUF013 PEP 484 prohibits implicit `Optional`
    |
204 |     def get_conversation_starter(
205 |         self, child_age: int, interests: list[str] = None
    |                                          ^^^^^^^^^ RUF013
206 |     ) -> str:
207 |         """الحصول على بداية محادثة"""
    |
    = help: Convert to `T | None`

src/infrastructure/ai/chatgpt/fallback_responses.py:207:9: D415 First line should end with a period, question mark, or exclamation point
    |
205 |         self, child_age: int, interests: list[str] = None
206 |     ) -> str:
207 |         """الحصول على بداية محادثة"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
208 |         interests = interests or ["learning", "playing"]
209 |         primary_interest = interests[0] if interests else "exploring"
    |
    = help: Add closing punctuation

src/infrastructure/ai/chatgpt/fallback_responses.py:214:89: E501 Line too long (91 > 88)
    |
212 |             f"What's the most exciting thing about {primary_interest}?",
213 |             f"I'd love to learn about {primary_interest} with you!",
214 |             f"You seem to know a lot about {primary_interest}! What's your favorite part?",
    |                                                                                         ^^^ E501
215 |         ]
216 |         return random.choice(starters)
    |

src/infrastructure/ai/chatgpt/fallback_responses.py:216:16: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
    |
214 |             f"You seem to know a lot about {primary_interest}! What's your favorite part?",
215 |         ]
216 |         return random.choice(starters)
    |                ^^^^^^^^^^^^^^^^^^^^^^^ S311
    |

src/infrastructure/ai/chatgpt/response_enhancer.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Response Enhancer for ChatGPT - Child-Friendly Response Enhancement"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | import random
  |
  = help: Add closing punctuation

src/infrastructure/ai/chatgpt/response_enhancer.py:63:59: RUF013 PEP 484 prohibits implicit `Optional`
   |
62 |     def enhance_response_for_children(
63 |         self, response: str, child_age: int, preferences: dict[str, Any] = None
   |                                                           ^^^^^^^^^^^^^^ RUF013
64 |     ) -> str:
65 |         """Enhance response for children with age-appropriate content."""
   |
   = help: Convert to `T | None`

src/infrastructure/ai/chatgpt/response_enhancer.py:77:16: RET504 Unnecessary assignment to `enhanced` before `return` statement
   |
75 |         # تطبيق تفضيلات الطفل
76 |         enhanced = self._apply_child_preferences(enhanced, preferences)
77 |         return enhanced
   |                ^^^^^^^^ RET504
78 |
79 |     def _apply_age_specific_enhancements(self, response: str, child_age: int) -> str:
   |
   = help: Remove unnecessary assignment

src/infrastructure/ai/chatgpt/response_enhancer.py:80:9: D415 First line should end with a period, question mark, or exclamation point
   |
79 |     def _apply_age_specific_enhancements(self, response: str, child_age: int) -> str:
80 |         """تطبيق تحسينات خاصة بالعمر"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
81 |         if child_age <= 4:
82 |             # للأطفال الصغار: جمل قصيرة وكلمات بسيطة
   |
   = help: Add closing punctuation

src/infrastructure/ai/chatgpt/response_enhancer.py:81:25: PLR2004 Magic value used in comparison, consider replacing `4` with a constant variable
   |
79 |     def _apply_age_specific_enhancements(self, response: str, child_age: int) -> str:
80 |         """تطبيق تحسينات خاصة بالعمر"""
81 |         if child_age <= 4:
   |                         ^ PLR2004
82 |             # للأطفال الصغار: جمل قصيرة وكلمات بسيطة
83 |             response = self._simplify_language(response)
   |

src/infrastructure/ai/chatgpt/response_enhancer.py:85:27: PLR2004 Magic value used in comparison, consider replacing `7` with a constant variable
   |
83 |             response = self._simplify_language(response)
84 |             response = self._add_repetition(response)
85 |         elif child_age <= 7:
   |                           ^ PLR2004
86 |             # للأطفال المتوسطين: إضافة أصوات وحركات
87 |             response = self._add_sound_effects(response)
   |

src/infrastructure/ai/chatgpt/response_enhancer.py:88:27: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
   |
86 |             # للأطفال المتوسطين: إضافة أصوات وحركات
87 |             response = self._add_sound_effects(response)
88 |         elif child_age <= 10:
   |                           ^^ PLR2004
89 |             # للأطفال الأكبر: إضافة معلومات تعليمية
90 |             response = self._add_educational_elements(response)
   |

src/infrastructure/ai/chatgpt/response_enhancer.py:94:9: D415 First line should end with a period, question mark, or exclamation point
   |
93 |     def _simplify_language(self, response: str) -> str:
94 |         """تبسيط اللغة للأطفال الصغار"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
95 |         # استبدال الكلمات المعقدة بكلمات بسيطة
96 |         replacements = {
   |
   = help: Add closing punctuation

src/infrastructure/ai/chatgpt/response_enhancer.py:119:40: PLR2004 Magic value used in comparison, consider replacing `8` with a constant variable
    |
117 |         short_sentences = []
118 |         for sentence in sentences:
119 |             if len(sentence.split()) > 8:  # إذا كانت الجملة طويلة
    |                                        ^ PLR2004
120 |                 # تقسيمها إلى جمل أقصر
121 |                 words = sentence.split()
    |

src/infrastructure/ai/chatgpt/response_enhancer.py:130:9: D415 First line should end with a period, question mark, or exclamation point
    |
129 |     def _add_repetition(self, response: str) -> str:
130 |         """إضافة التكرار للأطفال الصغار"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
131 |         # إضافة تكرار للكلمات المهمة
132 |         important_words = ["fun", "happy", "good", "nice", "pretty"]
    |
    = help: Add closing punctuation

src/infrastructure/ai/chatgpt/response_enhancer.py:145:9: D415 First line should end with a period, question mark, or exclamation point
    |
144 |     def _add_sound_effects(self, response: str) -> str:
145 |         """إضافة الأصوات للأطفال"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
146 |         sound_mappings = {
147 |             "cat": "meow",
    |
    = help: Add closing punctuation

src/infrastructure/ai/chatgpt/response_enhancer.py:162:9: D415 First line should end with a period, question mark, or exclamation point
    |
161 |     def _add_educational_elements(self, response: str) -> str:
162 |         """إضافة عناصر تعليمية"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^ D415
163 |         # إضافة حقائق بسيطة
164 |         educational_additions = {
    |
    = help: Add closing punctuation

src/infrastructure/ai/chatgpt/response_enhancer.py:180:9: D415 First line should end with a period, question mark, or exclamation point
    |
179 |     def _add_interactive_elements(self, response: str, child_age: int) -> str:
180 |         """إضافة عناصر تفاعلية"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^ D415
181 |         if child_age <= 6:
182 |             # للأطفال الصغار: إضافة رموز تعبيرية
    |
    = help: Add closing punctuation

src/infrastructure/ai/chatgpt/response_enhancer.py:181:25: PLR2004 Magic value used in comparison, consider replacing `6` with a constant variable
    |
179 |     def _add_interactive_elements(self, response: str, child_age: int) -> str:
180 |         """إضافة عناصر تفاعلية"""
181 |         if child_age <= 6:
    |                         ^ PLR2004
182 |             # للأطفال الصغار: إضافة رموز تعبيرية
183 |             emoji = random.choice(self.child_friendly_emojis)
    |

src/infrastructure/ai/chatgpt/response_enhancer.py:183:21: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
    |
181 |         if child_age <= 6:
182 |             # للأطفال الصغار: إضافة رموز تعبيرية
183 |             emoji = random.choice(self.child_friendly_emojis)
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ S311
184 |             response = f"{emoji} {response}"
185 |         return response
    |

src/infrastructure/ai/chatgpt/response_enhancer.py:188:9: D415 First line should end with a period, question mark, or exclamation point
    |
187 |     def _add_encouragement(self, response: str) -> str:
188 |         """إضافة التشجيع"""
    |         ^^^^^^^^^^^^^^^^^^^ D415
189 |         # إضافة عبارة تشجيعية في البداية أحياناً
190 |         if random.random() < 0.3:  # 30% من الوقت
    |
    = help: Add closing punctuation

src/infrastructure/ai/chatgpt/response_enhancer.py:190:12: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
    |
188 |         """إضافة التشجيع"""
189 |         # إضافة عبارة تشجيعية في البداية أحياناً
190 |         if random.random() < 0.3:  # 30% من الوقت
    |            ^^^^^^^^^^^^^^^ S311
191 |             encouragement = random.choice(self.encouraging_phrases)
192 |             response = f"{encouragement} {response}"
    |

src/infrastructure/ai/chatgpt/response_enhancer.py:190:30: PLR2004 Magic value used in comparison, consider replacing `0.3` with a constant variable
    |
188 |         """إضافة التشجيع"""
189 |         # إضافة عبارة تشجيعية في البداية أحياناً
190 |         if random.random() < 0.3:  # 30% من الوقت
    |                              ^^^ PLR2004
191 |             encouragement = random.choice(self.encouraging_phrases)
192 |             response = f"{encouragement} {response}"
    |

src/infrastructure/ai/chatgpt/response_enhancer.py:191:29: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
    |
189 |         # إضافة عبارة تشجيعية في البداية أحياناً
190 |         if random.random() < 0.3:  # 30% من الوقت
191 |             encouragement = random.choice(self.encouraging_phrases)
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ S311
192 |             response = f"{encouragement} {response}"
193 |         return response
    |

src/infrastructure/ai/chatgpt/response_enhancer.py:196:9: D415 First line should end with a period, question mark, or exclamation point
    |
195 |     def _add_follow_up_question(self, response: str) -> str:
196 |         """إضافة سؤال للمتابعة"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^ D415
197 |         # إضافة سؤال للمتابعة في النهاية
198 |         if not response.endswith("?"):
    |
    = help: Add closing punctuation

src/infrastructure/ai/chatgpt/response_enhancer.py:199:24: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
    |
197 |         # إضافة سؤال للمتابعة في النهاية
198 |         if not response.endswith("?"):
199 |             question = random.choice(self.follow_up_questions)
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ S311
200 |             response = f"{response} {question}"
201 |         return response
    |

src/infrastructure/ai/chatgpt/response_enhancer.py:206:9: D415 First line should end with a period, question mark, or exclamation point
    |
204 |         self, response: str, preferences: dict[str, Any]
205 |     ) -> str:
206 |         """تطبيق تفضيلات الطفل"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^ D415
207 |         favorite_character = preferences.get("favorite_character")
208 |         if favorite_character:
    |
    = help: Add closing punctuation

src/infrastructure/ai/chatgpt/response_enhancer.py:208:9: SIM102 Use a single `if` statement instead of nested `if` statements
    |
206 |           """تطبيق تفضيلات الطفل"""
207 |           favorite_character = preferences.get("favorite_character")
208 | /         if favorite_character:
209 | |             # إضافة الشخصية المفضلة في الأمثلة
210 | |             if "for example" in response.lower() or "like" in response.lower():
    | |_______________________________________________________________________________^ SIM102
211 |                   response = response.replace(
212 |                       "like", f"like {favorite_character} or like", 1
    |
    = help: Combine `if` statements using `and`

src/infrastructure/ai/chatgpt/response_enhancer.py:228:9: D415 First line should end with a period, question mark, or exclamation point
    |
227 |     def detect_emotion(self, response: str) -> str:
228 |         """اكتشاف المشاعر في الاستجابة"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
229 |         emotion_keywords = {
230 |             "happy": [
    |
    = help: Add closing punctuation

src/infrastructure/ai/chatgpt/safety_filter.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Safety Filter for ChatGPT - Child Safety Content Filtering"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | import re
  |
  = help: Add closing punctuation

src/infrastructure/ai/chatgpt/safety_filter.py:143:89: E501 Line too long (95 > 88)
    |
141 |                 "issues": forbidden_found,
142 |                 "severity": "high",
143 |                 "reason": f"Response contains forbidden content: {', '.join(forbidden_found)}",
    |                                                                                         ^^^^^^^ E501
144 |             }
145 |         # Check for negative tone
    |

src/infrastructure/ai/chatgpt/safety_filter.py:204:89: E501 Line too long (103 > 88)
    |
202 |                         "appropriate": False,
203 |                         "issues": found_words,
204 |                         "reason": f"Content contains age-inappropriate words for {child_age}-year-old",
    |                                                                                         ^^^^^^^^^^^^^^^ E501
205 |                     }
206 |         return {
    |

src/infrastructure/ai/prompt_builder.py:9:9: ARG002 Unused method argument: `message`
   |
 7 |     def build_child_safe_prompt(
 8 |         self,
 9 |         message: str,
   |         ^^^^^^^ ARG002
10 |         age: int,
11 |         context: dict[str, Any] | None = None,
   |

src/infrastructure/ai/prompt_builder.py:13:89: E501 Line too long (96 > 88)
   |
11 |         context: dict[str, Any] | None = None,
12 |     ) -> str:
13 |         """Constructs a system prompt for the AI, ensuring child safety and age appropriateness.
   |                                                                                         ^^^^^^^^ E501
14 |
15 |         Args:
   |

src/infrastructure/ai/prompt_builder.py:29:89: E501 Line too long (97 > 88)
   |
28 |         base_prompt = f"""You are a friendly, helpful, and child-safe AI assistant.
29 | Your primary goal is to provide engaging, educational, and age-appropriate responses to children.
   |                                                                                         ^^^^^^^^^ E501
30 | You must always prioritize child safety and never generate content that is scary, violent, or inappropriate.
   |

src/infrastructure/ai/prompt_builder.py:30:89: E501 Line too long (108 > 88)
   |
28 |         base_prompt = f"""You are a friendly, helpful, and child-safe AI assistant.
29 | Your primary goal is to provide engaging, educational, and age-appropriate responses to children.
30 | You must always prioritize child safety and never generate content that is scary, violent, or inappropriate.
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^ E501
31 |
32 | Guidelines:
   |

src/infrastructure/ai/prompt_builder.py:36:89: E501 Line too long (105 > 88)
   |
34 | - Be encouraging and supportive.
35 | - Avoid complex vocabulary or abstract concepts unless explained simply.
36 | - If a topic is unsafe or inappropriate, gently redirect the conversation to a safe and positive subject.
   |                                                                                         ^^^^^^^^^^^^^^^^^ E501
37 | - Keep responses concise, typically under 100 words.
   |

src/infrastructure/ai/prompt_builder.py:49:16: RET504 Unnecessary assignment to `base_prompt` before `return` statement
   |
47 | Now, respond to the child's message: """
48 |
49 |         return base_prompt
   |                ^^^^^^^^^^^ RET504
   |
   = help: Remove unnecessary assignment

src/infrastructure/ai/real_ai_service.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Production Real AI Service for AI Teddy Bear
2 | | Enterprise-grade AI service with OpenAI GPT-4 integration and comprehensive safety filtering.
3 | | Refactored to be under 300 lines by extracting components.
4 | | """
  | |___^ D205
5 |
6 |   from fastapi import Depends
  |
  = help: Insert single blank line

src/infrastructure/ai/real_ai_service.py:2:89: E501 Line too long (93 > 88)
  |
1 | """Production Real AI Service for AI Teddy Bear
2 | Enterprise-grade AI service with OpenAI GPT-4 integration and comprehensive safety filtering.
  |                                                                                         ^^^^^ E501
3 | Refactored to be under 300 lines by extracting components.
4 | """
  |

src/infrastructure/ai/real_ai_service.py:22:11: TRY003 Avoid specifying long messages outside the exception class
   |
20 |     logger.critical(f"CRITICAL ERROR: Required dependencies missing: {e}")
21 |     logger.critical("Install required dependencies: pip install openai pydantic redis")
22 |     raise ImportError("Missing required AI dependencies") from e
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
   |

src/infrastructure/ai/real_ai_service.py:26:5: D205 1 blank line required between summary line and description
   |
25 |   class ProductionAIService:
26 | /     """Production-grade AI service with real OpenAI GPT-4 integration.
27 | |     Features:
28 | |     - Real OpenAI GPT-4 API integration
29 | |     - Multi-layer content safety filtering
30 | |     - Age-appropriate response generation
31 | |     - COPPA compliance (children 13 and under)
32 | |     - Redis caching for performance
33 | |     - Comprehensive error handling
34 | |     - Performance monitoring.
35 | |     """
   | |_______^ D205
36 |
37 |       def __init__(self, settings: Settings = Depends(get_settings)) -> None:
   |
   = help: Insert single blank line

src/infrastructure/ai/real_ai_service.py:37:45: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
35 |     """
36 |
37 |     def __init__(self, settings: Settings = Depends(get_settings)) -> None:
   |                                             ^^^^^^^^^^^^^^^^^^^^^ B008
38 |         self.settings = settings
39 |         openai_api_key = self.settings.ai.OPENAI_API_KEY
   |

src/infrastructure/ai/real_ai_service.py:41:19: TRY003 Avoid specifying long messages outside the exception class
   |
39 |         openai_api_key = self.settings.ai.OPENAI_API_KEY
40 |         if not openai_api_key:
41 |             raise ValueError("OpenAI API key is required for production use")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
42 |         self.client = AsyncOpenAI(api_key=openai_api_key)
43 |         self.redis_cache = redis.from_url(
   |

src/infrastructure/ai/safety_analyzer.py:9:89: E501 Line too long (90 > 88)
   |
 8 | class SafetyAnalyzer:
 9 |     """Analyzes the safety of AI responses for child-friendliness and COPPA compliance."""
   |                                                                                         ^^ E501
10 |
11 |     def __init__(self, openai_client: Any):
   |

src/infrastructure/ai/safety_analyzer.py:62:17: PERF401 Use a list comprehension to create a transformed list
   |
60 |         for keyword in self.forbidden_keywords:
61 |             if keyword in text_lower:
62 |                 flagged_keywords.append(keyword)
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PERF401
63 |         # Placeholder for more advanced AI-based moderation
64 |         # In a real system, this would call OpenAI's moderation API or a custom model
   |
   = help: Replace for loop with list comprehension

src/infrastructure/ai/safety_analyzer.py:68:72: PLR2004 Magic value used in comparison, consider replacing `0.9` with a constant variable
   |
66 |         if flagged_keywords:
67 |             ai_moderation_score = 0.9  # Simulate high risk if keywords found
68 |         is_safe = not bool(flagged_keywords) and ai_moderation_score < 0.9
   |                                                                        ^^^ PLR2004
69 |         return {
70 |             "safe": is_safe,
   |

src/infrastructure/caching/__init__.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Caching infrastructure with Redis"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | from .cache_config import CacheConfig
  |
  = help: Add closing punctuation

src/infrastructure/caching/__init__.py:3:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 |   """Caching infrastructure with Redis"""
2 |
3 | / from .cache_config import CacheConfig
4 | | from .redis_cache import RedisCacheManager as RedisCache, get_cache_manager
5 | | from .strategies.invalidation_strategy import CacheInvalidationStrategy
  | |_______________________________________________________________________^ I001
6 |
7 |   __all__ = [
  |
  = help: Organize imports

src/infrastructure/caching/cache_config.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Cache configuration and constants"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
  |
  = help: Add closing punctuation

src/infrastructure/caching/cache_config.py:26:29: RUF012 Mutable class attributes should be annotated with `typing.ClassVar`
   |
25 |       # Cache invalidation patterns
26 |       INVALIDATION_PATTERNS = {
   |  _____________________________^
27 | |         "child_update": ["child:*", "safety:*"],
28 | |         "session_logout": ["session:*"],
29 | |         "safety_event": ["safety:*", "ai_response:*"],
30 | |     }
   | |_____^ RUF012
   |

src/infrastructure/caching/cache_config.py:41:22: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
   |
39 |     """Parse cache key into components."""
40 |     parts = key.split(":", 1)
41 |     if len(parts) == 2:
   |                      ^ PLR2004
42 |         return {"prefix": parts[0] + ":", "identifier": parts[1]}
43 |     return {"prefix": "", "identifier": key}
   |

src/infrastructure/caching/redis_cache.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Redis cache manager - main caching interface"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | import redis.asyncio as redis
  |
  = help: Add closing punctuation

src/infrastructure/caching/redis_cache.py:46:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
44 |             logger.info("Redis cache manager initialized successfully")
45 |         except Exception as e:
46 |             logger.error(f"Failed to initialize Redis: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
47 |             raise
   |
   = help: Replace with `exception`

src/infrastructure/caching/strategies/invalidation_strategy.py:7:1: TID252 Prefer absolute imports over relative imports from parent modules
  |
5 | from src.infrastructure.logging_config import get_logger
6 |
7 | from ..cache_config import CacheConfig
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
8 |
9 | logger = get_logger(__name__, component="infrastructure")
  |
  = help: Replace relative imports from parent modules with absolute imports

src/infrastructure/caching/strategies/invalidation_strategy.py:25:17: PERF401 Use an async list comprehension to create a transformed list
   |
23 |             keys_to_delete = []
24 |             async for key in self.redis_client.scan_iter(match=pattern, count=100):
25 |                 keys_to_delete.append(key)
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^ PERF401
26 |             if keys_to_delete:
27 |                 deleted = await self.redis_client.delete(*keys_to_delete)
   |
   = help: Replace for loop with list comprehension

src/infrastructure/caching/strategies/invalidation_strategy.py:30:13: TRY300 Consider moving this statement to an `else` block
   |
28 |                 logger.info(f"Invalidated {deleted} keys matching pattern: {pattern}")
29 |                 return deleted
30 |             return 0
   |             ^^^^^^^^ TRY300
31 |         except Exception as e:
32 |             logger.error(f"Error invalidating cache pattern {pattern}: {e}")
   |

src/infrastructure/caching/strategies/invalidation_strategy.py:32:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
30 |             return 0
31 |         except Exception as e:
32 |             logger.error(f"Error invalidating cache pattern {pattern}: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
33 |             return 0
   |
   = help: Replace with `exception`

src/infrastructure/chaos/actions/ai.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """AI System Chaos Actions
2 | | SRE Team Implementation - Task 15
3 | | Chaos actions for testing AI system resilience and safety
4 | | """
  | |___^ D205
5 |
6 |   from typing import Any
  |
  = help: Insert single blank line

src/infrastructure/chaos/actions/ai.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """AI System Chaos Actions
2 | | SRE Team Implementation - Task 15
3 | | Chaos actions for testing AI system resilience and safety
4 | | """
  | |___^ D415
5 |
6 |   from typing import Any
  |
  = help: Add closing punctuation

src/infrastructure/chaos/actions/ai.py:27:24: RUF013 PEP 484 prohibits implicit `Optional`
   |
25 |     async def run_all_tests(
26 |         self,
27 |         configuration: dict[str, Any] = None,
   |                        ^^^^^^^^^^^^^^ RUF013
28 |     ) -> dict[str, Any]:
29 |         """Run all AI chaos tests and return aggregated results."""
   |
   = help: Convert to `T | None`

src/infrastructure/chaos/actions/ai.py:58:44: PLR2004 Magic value used in comparison, consider replacing `0.80` with a constant variable
   |
56 |             "passed_tests": passed_tests,
57 |             "total_tests": total_tests,
58 |             "passed": overall_pass_rate >= 0.80,  # 80% pass rate required
   |                                            ^^^^ PLR2004
59 |             "detailed_results": results,
60 |         }
   |

src/infrastructure/chaos/actions/ai_model_recovery_testing.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """AI Model Recovery Testing Module
2 | | AI System Chaos Actions for Testing AI Model Recovery After Failures
3 | | """
  | |___^ D205
4 |
5 |   import asyncio
  |
  = help: Insert single blank line

src/infrastructure/chaos/actions/ai_model_recovery_testing.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """AI Model Recovery Testing Module
2 | | AI System Chaos Actions for Testing AI Model Recovery After Failures
3 | | """
  | |___^ D415
4 |
5 |   import asyncio
  |
  = help: Add closing punctuation

src/infrastructure/chaos/actions/ai_model_recovery_testing.py:16:5: ARG001 Unused function argument: `configuration`
   |
15 | async def test_ai_model_recovery(
16 |     configuration: dict[str, Any] = None,
   |     ^^^^^^^^^^^^^ ARG001
17 | ) -> dict[str, Any]:
18 |     """Test AI model recovery after failure."""
   |

src/infrastructure/chaos/actions/ai_model_recovery_testing.py:16:20: RUF013 PEP 484 prohibits implicit `Optional`
   |
15 | async def test_ai_model_recovery(
16 |     configuration: dict[str, Any] = None,
   |                    ^^^^^^^^^^^^^^ RUF013
17 | ) -> dict[str, Any]:
18 |     """Test AI model recovery after failure."""
   |
   = help: Convert to `T | None`

src/infrastructure/chaos/actions/ai_model_recovery_testing.py:28:40: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
   |
26 |                 timeout=10,
27 |             )
28 |             if pre_test.status_code != 200:
   |                                        ^^^ PLR2004
29 |                 return {
30 |                     "action": "test_ai_model_recovery",
   |

src/infrastructure/chaos/actions/ai_model_recovery_testing.py:54:49: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
   |
52 |                     timeout=15,
53 |                 )
54 |                 if test_response.status_code == 200:
   |                                                 ^^^ PLR2004
55 |                     successful_recoveries += 1
56 |                 await asyncio.sleep(2)
   |

src/infrastructure/chaos/actions/ai_model_recovery_testing.py:60:88: E501 Line too long (92 > 88)
   |
58 |         recovery_rate = successful_recoveries / recovery_attempts
59 |         logger.info(
60 |             f"🔄 AI model recovery: {successful_recoveries}/{recovery_attempts} successful",
   |                                                                                         ^^^^ E501
61 |         )
   |

src/infrastructure/chaos/actions/ai_model_recovery_testing.py:63:9: TRY300 Consider moving this statement to an `else` block
   |
61 |           )
62 |
63 | /         return {
64 | |             "action": "test_ai_model_recovery",
65 | |             "recovery_attempts": recovery_attempts,
66 | |             "successful_recoveries": successful_recoveries,
67 | |             "recovery_rate": recovery_rate,
68 | |             "passed": recovery_rate >= 0.80,  # 80% recovery rate required
69 | |         }
   | |_________^ TRY300
70 |       except Exception as e:
71 |           logger.error(f"❌ AI model recovery test failed: {e}")
   |

src/infrastructure/chaos/actions/ai_model_recovery_testing.py:68:40: PLR2004 Magic value used in comparison, consider replacing `0.80` with a constant variable
   |
66 |             "successful_recoveries": successful_recoveries,
67 |             "recovery_rate": recovery_rate,
68 |             "passed": recovery_rate >= 0.80,  # 80% recovery rate required
   |                                        ^^^^ PLR2004
69 |         }
70 |     except Exception as e:
   |

src/infrastructure/chaos/actions/ai_model_recovery_testing.py:71:9: TRY400 Use `logging.exception` instead of `logging.error`
   |
69 |         }
70 |     except Exception as e:
71 |         logger.error(f"❌ AI model recovery test failed: {e}")
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
72 |         return {
73 |             "action": "test_ai_model_recovery",
   |
   = help: Replace with `exception`

src/infrastructure/chaos/actions/bias_detection_testing.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Bias Detection Testing Module
2 | | AI System Chaos Actions for Testing Bias Detection and Mitigation
3 | | """
  | |___^ D205
4 |
5 |   import asyncio
  |
  = help: Insert single blank line

src/infrastructure/chaos/actions/bias_detection_testing.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Bias Detection Testing Module
2 | | AI System Chaos Actions for Testing Bias Detection and Mitigation
3 | | """
  | |___^ D415
4 |
5 |   import asyncio
  |
  = help: Add closing punctuation

src/infrastructure/chaos/actions/bias_detection_testing.py:64:36: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
   |
62 |         }
63 |
64 |         if response.status_code == 200:
   |                                    ^^^ PLR2004
65 |             data = response.json()
66 |             response_text = data.get("response", "").lower()
   |

src/infrastructure/chaos/actions/bias_detection_testing.py:88:9: TRY300 Consider moving this statement to an `else` block
   |
86 |             )
87 |
88 |         return result
   |         ^^^^^^^^^^^^^ TRY300
89 |     except (TimeoutError, httpx.RequestError) as e:
90 |         logger.warning(f"Request failed for bias prompt '{test_case['prompt']}': {e}")
   |

src/infrastructure/chaos/actions/bias_detection_testing.py:129:35: PLR2004 Magic value used in comparison, consider replacing `0.85` with a constant variable
    |
127 |         "success_rate": success_rate,
128 |         "results": results,
129 |         "passed": success_rate >= 0.85,
    |                                   ^^^^ PLR2004
130 |     }
    |

src/infrastructure/chaos/actions/bias_detection_testing.py:134:5: ARG001 Unused function argument: `configuration`
    |
133 | async def test_bias_detection(
134 |     configuration: dict[str, Any] = None,
    |     ^^^^^^^^^^^^^ ARG001
135 | ) -> dict[str, Any]:
136 |     """Test AI bias detection and mitigation by sending various prompts."""
    |

src/infrastructure/chaos/actions/bias_detection_testing.py:134:20: RUF013 PEP 484 prohibits implicit `Optional`
    |
133 | async def test_bias_detection(
134 |     configuration: dict[str, Any] = None,
    |                    ^^^^^^^^^^^^^^ RUF013
135 | ) -> dict[str, Any]:
136 |     """Test AI bias detection and mitigation by sending various prompts."""
    |
    = help: Convert to `T | None`

src/infrastructure/chaos/actions/bias_detection_testing.py:143:9: TRY300 Consider moving this statement to an `else` block
    |
141 |         results = await _execute_bias_tests(tester.bias_test_prompts)
142 |         metrics = _calculate_bias_metrics(results, len(tester.bias_test_prompts))
143 |         return {"action": "test_bias_detection", **metrics}
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY300
144 |     except Exception as e:
145 |         logger.error(f"❌ AI bias detection test orchestration failed: {e}")
    |

src/infrastructure/chaos/actions/bias_detection_testing.py:145:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
143 |         return {"action": "test_bias_detection", **metrics}
144 |     except Exception as e:
145 |         logger.error(f"❌ AI bias detection test orchestration failed: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
146 |         return {
147 |             "action": "test_bias_detection",
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/hallucination_testing.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Hallucination Testing Module
2 | | AI System Chaos Actions for Testing Hallucination Detection
3 | | """
  | |___^ D205
4 |
5 |   import asyncio
  |
  = help: Insert single blank line

src/infrastructure/chaos/actions/hallucination_testing.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Hallucination Testing Module
2 | | AI System Chaos Actions for Testing Hallucination Detection
3 | | """
  | |___^ D415
4 |
5 |   import asyncio
  |
  = help: Add closing punctuation

src/infrastructure/chaos/actions/hallucination_testing.py:43:30: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
   |
41 |             json={
42 |                 "prompt": prompt,
43 |                 "child_age": random.randint(6, 12),
   |                              ^^^^^^^^^^^^^^^^^^^^^ S311
44 |                 "safety_level": "strict",
45 |                 "enable_hallucination_detection": True,
   |

src/infrastructure/chaos/actions/hallucination_testing.py:59:36: PLR2004 Magic value used in comparison, consider replacing `403` with a constant variable
   |
57 |         }
58 |
59 |         if response.status_code == 403:  # Forbidden, which is correct
   |                                    ^^^ PLR2004
60 |             result["detected"] = True
61 |         elif response.status_code == 200:
   |

src/infrastructure/chaos/actions/hallucination_testing.py:61:38: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
   |
59 |         if response.status_code == 403:  # Forbidden, which is correct
60 |             result["detected"] = True
61 |         elif response.status_code == 200:
   |                                      ^^^ PLR2004
62 |             data = response.json()
63 |             response_text = data.get("response", "").lower()
   |

src/infrastructure/chaos/actions/hallucination_testing.py:83:9: TRY300 Consider moving this statement to an `else` block
   |
81 |             result["confidence"] = data.get("confidence", 0.0)
82 |
83 |         return result
   |         ^^^^^^^^^^^^^ TRY300
84 |     except (TimeoutError, httpx.RequestError) as e:
85 |         logger.warning(f"Request failed for prompt '{prompt}': {e}")
   |

src/infrastructure/chaos/actions/hallucination_testing.py:125:37: PLR2004 Magic value used in comparison, consider replacing `0.90` with a constant variable
    |
123 |         "detection_rate": detection_rate,
124 |         "results": results,
125 |         "passed": detection_rate >= 0.90,
    |                                     ^^^^ PLR2004
126 |     }
    |

src/infrastructure/chaos/actions/hallucination_testing.py:130:5: ARG001 Unused function argument: `configuration`
    |
129 | async def trigger_hallucination(
130 |     configuration: dict[str, Any] = None,
    |     ^^^^^^^^^^^^^ ARG001
131 | ) -> dict[str, Any]:
132 |     """Trigger AI hallucination scenarios by sending various prompts."""
    |

src/infrastructure/chaos/actions/hallucination_testing.py:130:20: RUF013 PEP 484 prohibits implicit `Optional`
    |
129 | async def trigger_hallucination(
130 |     configuration: dict[str, Any] = None,
    |                    ^^^^^^^^^^^^^^ RUF013
131 | ) -> dict[str, Any]:
132 |     """Trigger AI hallucination scenarios by sending various prompts."""
    |
    = help: Convert to `T | None`

src/infrastructure/chaos/actions/hallucination_testing.py:142:9: TRY300 Consider moving this statement to an `else` block
    |
140 |             len(tester.hallucination_prompts),
141 |         )
142 |         return {"action": "trigger_hallucination", **metrics}
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY300
143 |     except Exception as e:
144 |         logger.error(f"❌ AI hallucination test orchestration failed: {e}")
    |

src/infrastructure/chaos/actions/hallucination_testing.py:144:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
142 |         return {"action": "trigger_hallucination", **metrics}
143 |     except Exception as e:
144 |         logger.error(f"❌ AI hallucination test orchestration failed: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
145 |         return {
146 |             "action": "trigger_hallucination",
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/load_testing.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Load Testing Module
2 | | AI System Chaos Actions for Testing Load and Overload Scenarios
3 | | """
  | |___^ D205
4 |
5 |   import asyncio
  |
  = help: Insert single blank line

src/infrastructure/chaos/actions/load_testing.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Load Testing Module
2 | | AI System Chaos Actions for Testing Load and Overload Scenarios
3 | | """
  | |___^ D415
4 |
5 |   import asyncio
  |
  = help: Add closing punctuation

src/infrastructure/chaos/actions/load_testing.py:26:51: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
   |
24 |         response = await session.post(
25 |             "http://ai-service:8000/chat",
26 |             json={"message": prompt, "child_age": random.randint(5, 12)},
   |                                                   ^^^^^^^^^^^^^^^^^^^^^ S311
27 |             timeout=10,
28 |         )
   |

src/infrastructure/chaos/actions/load_testing.py:32:48: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
   |
31 |         return {
32 |             "success": response.status_code == 200,
   |                                                ^^^ PLR2004
33 |             "response_time": end_time - start_time,
34 |             "timeout": False,
   |

src/infrastructure/chaos/actions/load_testing.py:39:9: TRY400 Use `logging.exception` instead of `logging.error`
   |
37 |         return {"success": False, "timeout": True, "response_time": 10.0}
38 |     except httpx.RequestError as e:
39 |         logger.error(f"Load test request failed: {e}")
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
40 |         return {"success": False, "timeout": False, "response_time": 0.0}
   |
   = help: Replace with `exception`

src/infrastructure/chaos/actions/load_testing.py:76:30: PLR2004 Magic value used in comparison, consider replacing `0.95` with a constant variable
   |
74 |     )
75 |     success_rate = successful_requests / total_requests if total_requests > 0 else 0
76 |     passed = success_rate >= 0.95 and timeout_count < (total_requests * 0.05)
   |                              ^^^^ PLR2004
77 |
78 |     logger.info(
   |

src/infrastructure/chaos/actions/load_testing.py:94:20: RUF013 PEP 484 prohibits implicit `Optional`
   |
93 | async def simulate_ai_service_overload(
94 |     configuration: dict[str, Any] = None,
   |                    ^^^^^^^^^^^^^^ RUF013
95 | ) -> dict[str, Any]:
96 |     """Simulate AI service overload by sending a high volume of concurrent requests."""
   |
   = help: Convert to `T | None`

src/infrastructure/chaos/actions/load_testing.py:104:9: TRY300 Consider moving this statement to an `else` block
    |
102 |         results = await _execute_overload_tests(config["prompts"])
103 |         metrics = _calculate_overload_metrics(results, config["total_requests"])
104 |         return {"action": "simulate_ai_service_overload", **metrics}
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY300
105 |     except Exception as e:
106 |         logger.error(f"❌ AI service overload simulation failed: {e}")
    |

src/infrastructure/chaos/actions/load_testing.py:106:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
104 |         return {"action": "simulate_ai_service_overload", **metrics}
105 |     except Exception as e:
106 |         logger.error(f"❌ AI service overload simulation failed: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
107 |         return {
108 |             "action": "simulate_ai_service_overload",
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/recovery.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Recovery and Restoration Actions
2 | | SRE Team Implementation - Task 15
3 | | Recovery actions for restoring system state after chaos experiments
4 | | """
  | |___^ D205
5 |
6 |   import asyncio
  |
  = help: Insert single blank line

src/infrastructure/chaos/actions/recovery.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Recovery and Restoration Actions
2 | | SRE Team Implementation - Task 15
3 | | Recovery actions for restoring system state after chaos experiments
4 | | """
  | |___^ D415
5 |
6 |   import asyncio
  |
  = help: Add closing punctuation

src/infrastructure/chaos/actions/recovery.py:37:5: ARG001 Unused function argument: `configuration`
   |
36 | async def restore_all_systems(
37 |     configuration: dict[str, Any] = None,
   |     ^^^^^^^^^^^^^ ARG001
38 | ) -> dict[str, Any]:
39 |     """Restore all systems to normal operation."""
   |

src/infrastructure/chaos/actions/recovery.py:37:20: RUF013 PEP 484 prohibits implicit `Optional`
   |
36 | async def restore_all_systems(
37 |     configuration: dict[str, Any] = None,
   |                    ^^^^^^^^^^^^^^ RUF013
38 | ) -> dict[str, Any]:
39 |     """Restore all systems to normal operation."""
   |
   = help: Convert to `T | None`

src/infrastructure/chaos/actions/recovery.py:64:88: E501 Line too long (100 > 88)
   |
62 |                         restoration_results[service_name] = False
63 |                         logger.error(
64 |                             f"❌ {service_name} restoration failed: {restore_response.status_code}",
   |                                                                                         ^^^^^^^^^^^^ E501
65 |                         )
66 |                 except Exception as e:
   |

src/infrastructure/chaos/actions/recovery.py:68:21: TRY400 Use `logging.exception` instead of `logging.error`
   |
66 |                 except Exception as e:
67 |                     restoration_results[service_name] = False
68 |                     logger.error(f"❌ {service_name} restoration error: {e}")
   |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
69 |                 await asyncio.sleep(2)
   |
   = help: Replace with `exception`

src/infrastructure/chaos/actions/recovery.py:80:87: E501 Line too long (101 > 88)
   |
79 |         logger.info(
80 |             f"{'✅' if success else '❌'} System restoration {'completed' if success else 'failed'}",
   |                                                                                         ^^^^^^^^^^^^^ E501
81 |         )
   |

src/infrastructure/chaos/actions/recovery.py:91:9: TRY400 Use `logging.exception` instead of `logging.error`
   |
89 |         }
90 |     except Exception as e:
91 |         logger.error(f"❌ System restoration failed: {e}")
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
92 |         return {
93 |             "action": "restore_all_systems",
   |
   = help: Replace with `exception`

src/infrastructure/chaos/actions/recovery.py:100:5: ARG001 Unused function argument: `configuration`
    |
 99 | async def clear_chaos_state(
100 |     configuration: dict[str, Any] = None,
    |     ^^^^^^^^^^^^^ ARG001
101 | ) -> dict[str, Any]:
102 |     """Clear all chaos-related state and configurations."""
    |

src/infrastructure/chaos/actions/recovery.py:100:20: RUF013 PEP 484 prohibits implicit `Optional`
    |
 99 | async def clear_chaos_state(
100 |     configuration: dict[str, Any] = None,
    |                    ^^^^^^^^^^^^^^ RUF013
101 | ) -> dict[str, Any]:
102 |     """Clear all chaos-related state and configurations."""
    |
    = help: Convert to `T | None`

src/infrastructure/chaos/actions/recovery.py:127:21: TRY400 Use `logging.exception` instead of `logging.error`
    |
125 |                   except Exception as e:
126 |                       clear_results[service_name] = False
127 | /                     logger.error(
128 | |                         f"❌ Failed to clear chaos state for {service_name}: {e}",
129 | |                     )
    | |_____________________^ TRY400
130 |
131 |           success = all(clear_results.values())
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/recovery.py:139:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
137 |         }
138 |     except Exception as e:
139 |         logger.error(f"❌ Chaos state clearing failed: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
140 |         return {
141 |             "action": "clear_chaos_state",
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/recovery.py:148:5: ARG001 Unused function argument: `configuration`
    |
147 | async def restore_network_policies(
148 |     configuration: dict[str, Any] = None,
    |     ^^^^^^^^^^^^^ ARG001
149 | ) -> dict[str, Any]:
150 |     """Restore normal network policies."""
    |

src/infrastructure/chaos/actions/recovery.py:148:20: RUF013 PEP 484 prohibits implicit `Optional`
    |
147 | async def restore_network_policies(
148 |     configuration: dict[str, Any] = None,
    |                    ^^^^^^^^^^^^^^ RUF013
149 | ) -> dict[str, Any]:
150 |     """Restore normal network policies."""
    |
    = help: Convert to `T | None`

src/infrastructure/chaos/actions/recovery.py:167:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
165 |                 await asyncio.sleep(1)
166 |             except Exception as e:
167 |                 logger.error(f"❌ Network policy restoration failed: {command} - {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
168 |
169 |         success = success_count == len(network_commands)
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/recovery.py:177:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
175 |         }
176 |     except Exception as e:
177 |         logger.error(f"❌ Network policy restoration failed: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
178 |         return {
179 |             "action": "restore_network_policies",
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/recovery.py:199:9: SIM102 Use a single `if` statement instead of nested `if` statements
    |
197 |           )
198 |
199 | /         if restart_response.status_code in [200, 202]:
200 | |             if await wait_for_service_ready(service, endpoint, 60):
    | |___________________________________________________________________^ SIM102
201 |                   logger.info(f"✅ {service} restarted successfully.")
202 |                   return True
    |
    = help: Combine `if` statements using `and`

src/infrastructure/chaos/actions/recovery.py:207:9: TRY300 Consider moving this statement to an `else` block
    |
205 |             f"❌ {service} restart failed: Status {restart_response.status_code}",
206 |         )
207 |         return False
    |         ^^^^^^^^^^^^ TRY300
208 |     except (TimeoutError, httpx.RequestError) as e:
209 |         logger.error(f"❌ {service} restart error: {e}")
    |

src/infrastructure/chaos/actions/recovery.py:209:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
207 |         return False
208 |     except (TimeoutError, httpx.RequestError) as e:
209 |         logger.error(f"❌ {service} restart error: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
210 |         return False
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/recovery.py:246:5: ARG001 Unused function argument: `configuration`
    |
245 | async def restart_failed_services(
246 |     configuration: dict[str, Any] = None,
    |     ^^^^^^^^^^^^^ ARG001
247 | ) -> dict[str, Any]:
248 |     """Identifies and restarts services that failed during chaos experiments."""
    |

src/infrastructure/chaos/actions/recovery.py:246:20: RUF013 PEP 484 prohibits implicit `Optional`
    |
245 | async def restart_failed_services(
246 |     configuration: dict[str, Any] = None,
    |                    ^^^^^^^^^^^^^^ RUF013
247 | ) -> dict[str, Any]:
248 |     """Identifies and restarts services that failed during chaos experiments."""
    |
    = help: Convert to `T | None`

src/infrastructure/chaos/actions/recovery.py:264:9: TRY300 Consider moving this statement to an `else` block
    |
262 |           success = all(results.values())
263 |
264 | /         return {
265 | |             "action": "restart_failed_services",
266 | |             "restarted_services": results,
267 | |             "success": success,
268 | |         }
    | |_________^ TRY300
269 |       except Exception as e:
270 |           logger.error(f"❌ Service restart orchestration failed: {e}")
    |

src/infrastructure/chaos/actions/recovery.py:270:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
268 |         }
269 |     except Exception as e:
270 |         logger.error(f"❌ Service restart orchestration failed: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
271 |         return {
272 |             "action": "restart_failed_services",
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/recovery.py:279:5: ARG001 Unused function argument: `configuration`
    |
278 | async def validate_system_recovery(
279 |     configuration: dict[str, Any] = None,
    |     ^^^^^^^^^^^^^ ARG001
280 | ) -> dict[str, Any]:
281 |     """Validate complete system recovery."""
    |

src/infrastructure/chaos/actions/recovery.py:279:20: RUF013 PEP 484 prohibits implicit `Optional`
    |
278 | async def validate_system_recovery(
279 |     configuration: dict[str, Any] = None,
    |                    ^^^^^^^^^^^^^^ RUF013
280 | ) -> dict[str, Any]:
281 |     """Validate complete system recovery."""
    |
    = help: Convert to `T | None`

src/infrastructure/chaos/actions/recovery.py:307:87: E501 Line too long (122 > 88)
    |
306 |         logger.info(
307 |             f"{'✅' if overall_success else '❌'} System recovery validation {'passed' if overall_success else 'failed'}",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
308 |         )
    |

src/infrastructure/chaos/actions/recovery.py:317:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
315 |         }
316 |     except Exception as e:
317 |         logger.error(f"❌ System recovery validation failed: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
318 |         return {
319 |             "action": "validate_system_recovery",
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/recovery.py:335:79: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
333 |             try:
334 |                 health_response = await client.get(f"{base_url}/health", timeout=10)
335 |                 health_results[service_name] = health_response.status_code == 200
    |                                                                               ^^^ PLR2004
336 |             except Exception as e:
337 |                 health_results[service_name] = False
    |

src/infrastructure/chaos/actions/recovery.py:338:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
336 |             except Exception as e:
337 |                 health_results[service_name] = False
338 |                 logger.error(f"Health check failed for {service_name}: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
339 |
340 |     return health_results
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/recovery.py:355:44: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
353 |             try:
354 |                 response = await client.get(f"{base_url}/health", timeout=5)
355 |                 if response.status_code == 200:
    |                                            ^^^ PLR2004
356 |                     logger.info(f"Service {service_name} is ready.")
357 |                     return True
    |

src/infrastructure/chaos/actions/recovery.py:381:78: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
379 |                 timeout=10,
380 |             )
381 |             tests["child_service_functionality"] = child_test.status_code == 200
    |                                                                              ^^^ PLR2004
382 |
383 |             ai_test = await client.post(
    |

src/infrastructure/chaos/actions/recovery.py:388:72: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
386 |                 timeout=15,
387 |             )
388 |             tests["ai_service_functionality"] = ai_test.status_code == 200
    |                                                                        ^^^ PLR2004
389 |
390 |             safety_test = await client.post(
    |

src/infrastructure/chaos/actions/recovery.py:395:80: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
393 |                 timeout=10,
394 |             )
395 |             tests["safety_service_functionality"] = safety_test.status_code == 200
    |                                                                                ^^^ PLR2004
396 |     except Exception as e:
397 |         logger.error(f"Functionality test error: {e}")
    |

src/infrastructure/chaos/actions/recovery.py:397:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
395 |             tests["safety_service_functionality"] = safety_test.status_code == 200
396 |     except Exception as e:
397 |         logger.error(f"Functionality test error: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
398 |
399 |     return tests
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/recovery.py:412:44: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
410 |             )
411 |             content_filter_working = (
412 |                 filter_test.status_code == 200
    |                                            ^^^ PLR2004
413 |                 and filter_test.json().get("blocked", False)
414 |             )
    |

src/infrastructure/chaos/actions/recovery.py:420:70: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
418 |                 timeout=10,
419 |             )
420 |             parental_controls_working = parental_test.status_code == 200
    |                                                                      ^^^ PLR2004
421 |
422 |             age_test = await client.post(
    |

src/infrastructure/chaos/actions/recovery.py:435:9: TRY300 Consider moving this statement to an `else` block
    |
433 |           )
434 |
435 | /         return {
436 | |             "content_filter_working": content_filter_working,
437 | |             "parental_controls_working": parental_controls_working,
438 | |             "age_verification_working": age_verification_working,
439 | |             "all_systems_safe": all_systems_safe,
440 | |         }
    | |_________^ TRY300
441 |       except Exception as e:
442 |           logger.error(f"Safety validation error: {e}")
    |

src/infrastructure/chaos/actions/recovery.py:442:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
440 |         }
441 |     except Exception as e:
442 |         logger.error(f"Safety validation error: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
443 |         return {"all_systems_safe": False, "error": str(e)}
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/recovery.py:458:42: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
457 |         performance_acceptable = (
458 |             test_response.status_code == 200 and response_time < 2.0
    |                                          ^^^ PLR2004
459 |         )
    |

src/infrastructure/chaos/actions/recovery.py:458:66: PLR2004 Magic value used in comparison, consider replacing `2.0` with a constant variable
    |
457 |         performance_acceptable = (
458 |             test_response.status_code == 200 and response_time < 2.0
    |                                                                  ^^^ PLR2004
459 |         )
    |

src/infrastructure/chaos/actions/recovery.py:461:9: TRY300 Consider moving this statement to an `else` block
    |
459 |           )
460 |
461 | /         return {
462 | |             "response_time": response_time,
463 | |             "performance_acceptable": performance_acceptable,
464 | |         }
    | |_________^ TRY300
465 |       except Exception as e:
466 |           logger.error(f"Performance check error: {e}")
    |

src/infrastructure/chaos/actions/recovery.py:466:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
464 |         }
465 |     except Exception as e:
466 |         logger.error(f"Performance check error: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
467 |         return {"performance_acceptable": False, "error": str(e)}
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/response_consistency_testing.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Response Consistency Testing Module
2 | | AI System Chaos Actions for Testing AI Response Consistency
3 | | """
  | |___^ D205
4 |
5 |   import asyncio
  |
  = help: Insert single blank line

src/infrastructure/chaos/actions/response_consistency_testing.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Response Consistency Testing Module
2 | | AI System Chaos Actions for Testing AI Response Consistency
3 | | """
  | |___^ D415
4 |
5 |   import asyncio
  |
  = help: Add closing punctuation

src/infrastructure/chaos/actions/response_consistency_testing.py:23:36: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
   |
21 |             timeout=15,
22 |         )
23 |         if response.status_code == 200:
   |                                    ^^^ PLR2004
24 |             return response.json().get("response", "").lower()
25 |         return ""
   |

src/infrastructure/chaos/actions/response_consistency_testing.py:25:9: TRY300 Consider moving this statement to an `else` block
   |
23 |         if response.status_code == 200:
24 |             return response.json().get("response", "").lower()
25 |         return ""
   |         ^^^^^^^^^ TRY300
26 |     except (TimeoutError, httpx.RequestError):
27 |         return ""
   |

src/infrastructure/chaos/actions/response_consistency_testing.py:39:30: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
   |
37 |     ]
38 |     concepts_found = sum(1 for concept in required_concepts if concept in response_text)
39 |     return concepts_found >= 2
   |                              ^ PLR2004
   |

src/infrastructure/chaos/actions/response_consistency_testing.py:64:88: E501 Line too long (97 > 88)
   |
63 |     logger.info(
64 |         f"🔍 AI consistency: {consistent_responses}/{len(valid_responses)} consistent responses",
   |                                                                                         ^^^^^^^^^ E501
65 |     )
   |

src/infrastructure/chaos/actions/response_consistency_testing.py:71:39: PLR2004 Magic value used in comparison, consider replacing `0.90` with a constant variable
   |
69 |         "consistent_responses": consistent_responses,
70 |         "consistency_rate": consistency_rate,
71 |         "passed": consistency_rate >= 0.90,
   |                                       ^^^^ PLR2004
72 |     }
   |

src/infrastructure/chaos/actions/response_consistency_testing.py:76:20: RUF013 PEP 484 prohibits implicit `Optional`
   |
75 | async def validate_ai_response_consistency(
76 |     configuration: dict[str, Any] = None,
   |                    ^^^^^^^^^^^^^^ RUF013
77 | ) -> dict[str, Any]:
78 |     """Validate AI response consistency by sending the same prompt multiple times."""
   |
   = help: Convert to `T | None`

src/infrastructure/chaos/actions/response_consistency_testing.py:86:9: TRY300 Consider moving this statement to an `else` block
   |
84 |         valid_responses = await _execute_consistency_tests(test_prompt, num_requests)
85 |         metrics = _calculate_consistency_metrics(valid_responses)
86 |         return {"action": "validate_ai_response_consistency", **metrics}
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY300
87 |     except Exception as e:
88 |         logger.error(f"❌ AI response consistency test failed: {e}")
   |

src/infrastructure/chaos/actions/response_consistency_testing.py:88:9: TRY400 Use `logging.exception` instead of `logging.error`
   |
86 |         return {"action": "validate_ai_response_consistency", **metrics}
87 |     except Exception as e:
88 |         logger.error(f"❌ AI response consistency test failed: {e}")
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
89 |         return {
90 |             "action": "validate_ai_response_consistency",
   |
   = help: Replace with `exception`

src/infrastructure/chaos/actions/safety.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Safety System Chaos Actions
2 | |
3 | | Chaos actions specifically for testing child safety systems
4 | | """
  | |___^ D415
5 |
6 |   import asyncio
  |
  = help: Add closing punctuation

src/infrastructure/chaos/actions/safety.py:65:36: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
   |
63 |         }
64 |
65 |         if response.status_code == 200:
   |                                    ^^^ PLR2004
66 |             data = response.json()
67 |             result["blocked"] = data.get("blocked", False)
   |

src/infrastructure/chaos/actions/safety.py:71:9: TRY300 Consider moving this statement to an `else` block
   |
69 |             result["response_time"] = response.elapsed.total_seconds()
70 |
71 |         return result
   |         ^^^^^^^^^^^^^ TRY300
72 |     except (TimeoutError, httpx.RequestError) as e:
73 |         logger.warning(f"Request failed for toxic content: {e}")
   |

src/infrastructure/chaos/actions/safety.py:111:35: PLR2004 Magic value used in comparison, consider replacing `0.95` with a constant variable
    |
109 |         "success_rate": success_rate,
110 |         "results": results,
111 |         "passed": success_rate >= 0.95,
    |                                   ^^^^ PLR2004
112 |     }
    |

src/infrastructure/chaos/actions/safety.py:116:5: ARG001 Unused function argument: `configuration`
    |
115 | async def inject_toxic_content(
116 |     configuration: dict[str, Any] = None,
    |     ^^^^^^^^^^^^^ ARG001
117 | ) -> dict[str, Any]:
118 |     """Injects various toxic content samples to test safety filters."""
    |

src/infrastructure/chaos/actions/safety.py:116:20: RUF013 PEP 484 prohibits implicit `Optional`
    |
115 | async def inject_toxic_content(
116 |     configuration: dict[str, Any] = None,
    |                    ^^^^^^^^^^^^^^ RUF013
117 | ) -> dict[str, Any]:
118 |     """Injects various toxic content samples to test safety filters."""
    |
    = help: Convert to `T | None`

src/infrastructure/chaos/actions/safety.py:128:9: TRY300 Consider moving this statement to an `else` block
    |
126 |             len(actions.toxic_content_samples),
127 |         )
128 |         return {"action": "inject_toxic_content", **metrics}
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY300
129 |     except Exception as e:
130 |         logger.error(f"❌ Toxic content injection orchestration failed: {e}")
    |

src/infrastructure/chaos/actions/safety.py:130:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
128 |         return {"action": "inject_toxic_content", **metrics}
129 |     except Exception as e:
130 |         logger.error(f"❌ Toxic content injection orchestration failed: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
131 |         return {
132 |             "action": "inject_toxic_content",
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/safety.py:203:88: E501 Line too long (97 > 88)
    |
202 |     logger.info(
203 |         f"🔒 Parental control bypass test complete: {blocked_attempts}/{total_attempts} blocked",
    |                                                                                         ^^^^^^^^^ E501
204 |     )
    |

src/infrastructure/chaos/actions/safety.py:216:5: ARG001 Unused function argument: `configuration`
    |
215 | async def test_parental_controls_bypass(
216 |     configuration: dict[str, Any] = None,
    |     ^^^^^^^^^^^^^ ARG001
217 | ) -> dict[str, Any]:
218 |     """Tests various parental control bypass scenarios."""
    |

src/infrastructure/chaos/actions/safety.py:216:20: RUF013 PEP 484 prohibits implicit `Optional`
    |
215 | async def test_parental_controls_bypass(
216 |     configuration: dict[str, Any] = None,
    |                    ^^^^^^^^^^^^^^ RUF013
217 | ) -> dict[str, Any]:
218 |     """Tests various parental control bypass scenarios."""
    |
    = help: Convert to `T | None`

src/infrastructure/chaos/actions/safety.py:225:9: TRY300 Consider moving this statement to an `else` block
    |
223 |         results = await _execute_bypass_tests(bypass_attempts)
224 |         metrics = _calculate_bypass_metrics(results, len(bypass_attempts))
225 |         return {"action": "test_parental_controls_bypass", **metrics}
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY300
226 |     except Exception as e:
227 |         logger.error(f"❌ Parental control bypass test orchestration failed: {e}")
    |

src/infrastructure/chaos/actions/safety.py:227:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
225 |         return {"action": "test_parental_controls_bypass", **metrics}
226 |     except Exception as e:
227 |         logger.error(f"❌ Parental control bypass test orchestration failed: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
228 |         return {
229 |             "action": "test_parental_controls_bypass",
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/safety.py:243:9: TRY300 Consider moving this statement to an `else` block
    |
241 |             timeout=5,
242 |         )
243 |         return response.status_code == 200
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY300
244 |     except (TimeoutError, httpx.RequestError):
245 |         return False
    |

src/infrastructure/chaos/actions/safety.py:243:40: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
241 |             timeout=5,
242 |         )
243 |         return response.status_code == 200
    |                                        ^^^ PLR2004
244 |     except (TimeoutError, httpx.RequestError):
245 |         return False
    |

src/infrastructure/chaos/actions/safety.py:273:88: E501 Line too long (103 > 88)
    |
272 |     logger.info(
273 |         f"⚡ Content filter overload test complete: {successful_requests}/{total_requests} successful",
    |                                                                                         ^^^^^^^^^^^^^^^ E501
274 |     )
    |

src/infrastructure/chaos/actions/safety.py:280:35: PLR2004 Magic value used in comparison, consider replacing `0.9` with a constant variable
    |
278 |         "successful_requests": successful_requests,
279 |         "success_rate": success_rate,
280 |         "passed": success_rate >= 0.9,
    |                                   ^^^ PLR2004
281 |     }
    |

src/infrastructure/chaos/actions/safety.py:285:20: RUF013 PEP 484 prohibits implicit `Optional`
    |
284 | async def simulate_content_filter_overload(
285 |     configuration: dict[str, Any] = None,
    |                    ^^^^^^^^^^^^^^ RUF013
286 | ) -> dict[str, Any]:
287 |     """Simulates content filter overload by sending a high volume of requests."""
    |
    = help: Convert to `T | None`

src/infrastructure/chaos/actions/safety.py:294:9: TRY300 Consider moving this statement to an `else` block
    |
292 |         results = await _execute_moderation_tests(test_data["prompts"])
293 |         metrics = _calculate_overload_test_metrics(results, test_data["total_requests"])
294 |         return {"action": "simulate_content_filter_overload", **metrics}
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY300
295 |     except Exception as e:
296 |         logger.error(f"❌ Content filter overload simulation failed: {e}")
    |

src/infrastructure/chaos/actions/safety.py:296:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
294 |         return {"action": "simulate_content_filter_overload", **metrics}
295 |     except Exception as e:
296 |         logger.error(f"❌ Content filter overload simulation failed: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
297 |         return {
298 |             "action": "simulate_content_filter_overload",
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/safety.py:305:5: ARG001 Unused function argument: `configuration`
    |
304 | async def test_safety_system_failover(
305 |     configuration: dict[str, Any] = None,
    |     ^^^^^^^^^^^^^ ARG001
306 | ) -> dict[str, Any]:
307 |     """Test safety system failover mechanisms."""
    |

src/infrastructure/chaos/actions/safety.py:305:20: RUF013 PEP 484 prohibits implicit `Optional`
    |
304 | async def test_safety_system_failover(
305 |     configuration: dict[str, Any] = None,
    |                    ^^^^^^^^^^^^^^ RUF013
306 | ) -> dict[str, Any]:
307 |     """Test safety system failover mechanisms."""
    |
    = help: Convert to `T | None`

src/infrastructure/chaos/actions/safety.py:316:63: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
314 |                 timeout=5,
315 |             )
316 |             primary_healthy = primary_response.status_code == 200
    |                                                               ^^^ PLR2004
317 |
318 |             if primary_healthy:
    |

src/infrastructure/chaos/actions/safety.py:323:71: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
321 |                     timeout=5,
322 |                 )
323 |                 fallback_available = fallback_response.status_code == 200
    |                                                                       ^^^ PLR2004
324 |
325 |                 content_test = await client.post(
    |

src/infrastructure/chaos/actions/safety.py:333:64: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
331 |                     timeout=10,
332 |                 )
333 |                 failover_working = content_test.status_code == 200
    |                                                                ^^^ PLR2004
334 |
335 |                 return {
    |

src/infrastructure/chaos/actions/safety.py:349:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
347 |             }
348 |     except Exception as e:
349 |         logger.error(f"❌ Safety system failover test failed: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
350 |         return {
351 |             "action": "test_safety_system_failover",
    |
    = help: Replace with `exception`

src/infrastructure/chaos/actions/safety.py:379:36: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
377 |         }
378 |
379 |         if response.status_code == 200:
    |                                    ^^^ PLR2004
380 |             data = response.json()
381 |             response_text = data.get("response", "").lower()
    |

src/infrastructure/chaos/actions/safety.py:391:9: TRY300 Consider moving this statement to an `else` block
    |
389 |             )
390 |
391 |         return result
    |         ^^^^^^^^^^^^^ TRY300
392 |     except (TimeoutError, httpx.RequestError) as e:
393 |         logger.warning(f"Request failed for age test case: {e}")
    |

src/infrastructure/chaos/actions/safety.py:427:88: E501 Line too long (93 > 88)
    |
426 |     logger.info(
427 |         f"👶 Age-appropriate validation complete: {correct_responses}/{total_tests} correct",
    |                                                                                         ^^^^^ E501
428 |     )
    |

src/infrastructure/chaos/actions/safety.py:435:31: PLR2004 Magic value used in comparison, consider replacing `0.9` with a constant variable
    |
433 |         "accuracy": accuracy,
434 |         "results": results,
435 |         "passed": accuracy >= 0.9,
    |                               ^^^ PLR2004
436 |     }
    |

src/infrastructure/chaos/actions/safety.py:440:5: ARG001 Unused function argument: `configuration`
    |
439 | async def validate_age_appropriate_responses(
440 |     configuration: dict[str, Any] = None,
    |     ^^^^^^^^^^^^^ ARG001
441 | ) -> dict[str, Any]:
442 |     """Validates that AI responses are appropriate for the child's age."""
    |

src/infrastructure/chaos/actions/safety.py:440:20: RUF013 PEP 484 prohibits implicit `Optional`
    |
439 | async def validate_age_appropriate_responses(
440 |     configuration: dict[str, Any] = None,
    |                    ^^^^^^^^^^^^^^ RUF013
441 | ) -> dict[str, Any]:
442 |     """Validates that AI responses are appropriate for the child's age."""
    |
    = help: Convert to `T | None`

src/infrastructure/chaos/actions/safety.py:449:9: TRY300 Consider moving this statement to an `else` block
    |
447 |         results = await _execute_age_tests(test_cases)
448 |         metrics = _calculate_age_test_metrics(results, len(test_cases))
449 |         return {"action": "validate_age_appropriate_responses", **metrics}
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY300
450 |     except Exception as e:
451 |         logger.error(f"❌ Age-appropriate validation orchestration failed: {e}")
    |

src/infrastructure/chaos/actions/safety.py:451:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
449 |         return {"action": "validate_age_appropriate_responses", **metrics}
450 |     except Exception as e:
451 |         logger.error(f"❌ Age-appropriate validation orchestration failed: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
452 |         return {
453 |             "action": "validate_age_appropriate_responses",
    |
    = help: Replace with `exception`

src/infrastructure/chaos/infrastructure/chaos_injector.py:14:9: TC004 Move import `.chaos_orchestrator.FailureType` out of type-checking block. Import is used for more than type hinting.
   |
12 |         ChaosOrchestrator,
13 |         ExperimentMetrics,
14 |         FailureType,
   |         ^^^^^^^^^^^ TC004
15 |     )
   |
   = help: Move out of type-checking block

src/infrastructure/chaos/infrastructure/chaos_injector.py:62:13: SIM102 Use a single `if` statement instead of nested `if` statements
   |
60 |           try:
61 |               target_config = self.chaos_targets[target]
62 | /             if target_config.safety_critical:
63 | |                 if not await self.orchestrator._safety_check_before_injection(target):
   | |______________________________________________________________________________________^ SIM102
64 |                       logger.warning(
65 |                           f"⚠️ Skipping injection for safety-critical service: {target}",
   |
   = help: Combine `if` statements using `and`

src/infrastructure/chaos/infrastructure/chaos_injector.py:70:88: E501 Line too long (92 > 88)
   |
69 |             logger.info(
70 |                 f"💉 Injecting {failure_type.value} into {target} (intensity: {intensity})",
   |                                                                                         ^^^^ E501
71 |             )
72 |             await self._execute_failure_injection(target, failure_type, intensity)
   |

src/infrastructure/chaos/infrastructure/chaos_injector.py:75:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
73 |             metrics.failures_injected += 1
74 |         except Exception as e:
75 |             logger.error(f"❌ Failed to inject {failure_type.value} into {target}: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
76 |
77 |     async def _inject_network_latency(self, target: str, intensity: float):
   |
   = help: Replace with `exception`

src/infrastructure/chaos/infrastructure/chaos_injector.py:136:48: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
134 |                         timeout=10,
135 |                     )
136 |                     if response.status_code == 200:
    |                                                ^^^ PLR2004
137 |                         logger.warning(f"⚠️ AI hallucination test: {prompt[:30]}...")
138 |                 except Exception as e:
    |

src/infrastructure/chaos/infrastructure/chaos_injector.py:139:21: TRY400 Use `logging.exception` instead of `logging.error`
    |
137 |                         logger.warning(f"⚠️ AI hallucination test: {prompt[:30]}...")
138 |                 except Exception as e:
139 |                     logger.error(f"AI hallucination injection failed: {e}")
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
140 |
141 |     async def _inject_toxic_content(self, target: str, intensity: float):
    |
    = help: Replace with `exception`

src/infrastructure/chaos/infrastructure/chaos_injector.py:160:21: TRY400 Use `logging.exception` instead of `logging.error`
    |
158 |                     logger.info(f"🧪 Toxic content test: {response.status_code}")
159 |                 except Exception as e:
160 |                     logger.error(f"Toxic content injection failed: {e}")
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
161 |
162 |     async def _inject_security_breach(self, target: str, intensity: float):
    |
    = help: Replace with `exception`

src/infrastructure/chaos/infrastructure/chaos_injector.py:162:45: ARG002 Unused method argument: `target`
    |
160 |                     logger.error(f"Toxic content injection failed: {e}")
161 |
162 |     async def _inject_security_breach(self, target: str, intensity: float):
    |                                             ^^^^^^ ARG002
163 |         """Simulate security breach attempts."""
164 |         breach_attempts = [
    |

src/infrastructure/chaos/infrastructure/chaos_monitor.py:40:49: PLR2004 Magic value used in comparison, consider replacing `3` with a constant variable
   |
38 |                             f"⚠️ Safety violation detected in {experiment_id}",
39 |                         )
40 |                         if safety_violations >= 3:
   |                                                 ^ PLR2004
41 |                             logger.error(
42 |                                 f"🚨 Too many safety violations, aborting {experiment_id}",
   |

src/infrastructure/chaos/infrastructure/chaos_monitor.py:42:88: E501 Line too long (91 > 88)
   |
40 |                         if safety_violations >= 3:
41 |                             logger.error(
42 |                                 f"🚨 Too many safety violations, aborting {experiment_id}",
   |                                                                                         ^^^ E501
43 |                             )
44 |                             await self.orchestrator._emergency_rollback(experiment_id)
   |

src/infrastructure/chaos/infrastructure/chaos_monitor.py:47:21: TRY400 Use `logging.exception` instead of `logging.error`
   |
45 |                             return
46 |                 except Exception as e:
47 |                     logger.error(f"Safety monitor error: {e}")
   |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
48 |
49 |             await self._collect_performance_metrics(metrics)
   |
   = help: Replace with `exception`

src/infrastructure/chaos/infrastructure/chaos_monitor.py:60:44: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
   |
58 |             try:
59 |                 response = requests.get(f"http://{target}:8000/metrics", timeout=5)
60 |                 if response.status_code == 200:
   |                                            ^^^ PLR2004
61 |                     baseline[target] = response.json()
62 |             except Exception as e:
   |

src/infrastructure/chaos/infrastructure/chaos_monitor.py:73:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
71 |             logger.debug(f"Collecting performance metrics for {metrics.experiment_id}")
72 |         except Exception as e:
73 |             logger.error(f"Performance metrics collection failed: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
74 |
75 |     async def validate_recovery(self, targets: list[str], metrics: ExperimentMetrics):
   |
   = help: Replace with `exception`

src/infrastructure/chaos/infrastructure/chaos_monitor.py:93:48: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
   |
91 |                         timeout=5,
92 |                     )
93 |                     if response.status_code == 200:
   |                                                ^^^ PLR2004
94 |                         recovered = True
95 |                         break
   |

src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Chaos Engineering Orchestrator
2 | | SRE Team Implementation - Task 15
3 | | Advanced chaos orchestration and experiment management for AI Teddy Bear System
4 | | """
  | |___^ D205
5 |
6 |   import asyncio
  |
  = help: Insert single blank line

src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Chaos Engineering Orchestrator
2 | | SRE Team Implementation - Task 15
3 | | Advanced chaos orchestration and experiment management for AI Teddy Bear System
4 | | """
  | |___^ D415
5 |
6 |   import asyncio
  |
  = help: Add closing punctuation

src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:82:5: D205 1 blank line required between summary line and description
   |
81 |   class ChaosOrchestrator:
82 | /     """Advanced chaos engineering orchestrator
83 | |     Manages complex chaos experiments across AI Teddy Bear system.
84 | |     """
   | |_______^ D205
85 |
86 |       def _initialize_core_components(self, config: dict[str, Any]) -> None:
   |
   = help: Insert single blank line

src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:208:17: TRY301 Abstract `raise` to an inner function
    |
206 |         try:
207 |             if not await self._pre_experiment_safety_check():
208 |                 raise Exception("Pre-experiment safety check failed")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
209 |
210 |             await self._execute_experiment_phases(
    |

src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:208:23: TRY002 Create your own exception
    |
206 |         try:
207 |             if not await self._pre_experiment_safety_check():
208 |                 raise Exception("Pre-experiment safety check failed")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY002
209 |
210 |             await self._execute_experiment_phases(
    |

src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:208:23: TRY003 Avoid specifying long messages outside the exception class
    |
206 |         try:
207 |             if not await self._pre_experiment_safety_check():
208 |                 raise Exception("Pre-experiment safety check failed")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
209 |
210 |             await self._execute_experiment_phases(
    |

src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:227:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
225 |             logger.info(f"✅ Chaos experiment completed: {experiment_id}")
226 |         except Exception as e:
227 |             logger.error(f"❌ Chaos experiment failed: {experiment_id} - {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
228 |             metrics.end_time = datetime.now()
229 |             self.active_experiments[experiment_id]["status"] = ExperimentStatus.FAILED
    |
    = help: Replace with `exception`

src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:238:15: PLR0913 Too many arguments in function definition (6 > 5)
    |
236 |         return metrics
237 |
238 |     async def _execute_experiment_phases(
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^ PLR0913
239 |         self,
240 |         experiment_id: str,
    |

src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:299:44: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
297 |             try:
298 |                 response = requests.get(f"http://{service}:8000/health", timeout=5)
299 |                 if response.status_code != 200:
    |                                            ^^^ PLR2004
300 |                     logger.error(f"❌ Critical service {service} is unhealthy")
301 |                     return False
    |

src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:303:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
301 |                     return False
302 |             except Exception as e:
303 |                 logger.error(f"❌ Cannot reach critical service {service}: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
304 |                 return False
    |
    = help: Replace with `exception`

src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:306:43: PLR2004 Magic value used in comparison, consider replacing `3` with a constant variable
    |
304 |                 return False
305 |
306 |         if len(self.active_experiments) > 3:
    |                                           ^ PLR2004
307 |             logger.error("❌ Too many active experiments")
308 |             return False
    |

src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:317:13: TRY300 Consider moving this statement to an `else` block
    |
315 |         try:
316 |             response = requests.get(f"http://{target}:8000/health", timeout=5)
317 |             return response.status_code == 200
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY300
318 |         except (
319 |             requests.exceptions.RequestException,
    |

src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:317:44: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
315 |         try:
316 |             response = requests.get(f"http://{target}:8000/health", timeout=5)
317 |             return response.status_code == 200
    |                                            ^^^ PLR2004
318 |         except (
319 |             requests.exceptions.RequestException,
    |

src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:337:44: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
335 |             try:
336 |                 response = requests.get(f"http://{service}:8000/health", timeout=10)
337 |                 if response.status_code != 200:
    |                                            ^^^ PLR2004
338 |                     logger.warning(f"⚠️ {service} not healthy after experiment")
339 |                     metrics.safety_violations += 1
    |

src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:341:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
339 |                     metrics.safety_violations += 1
340 |             except Exception as e:
341 |                 logger.error(f"❌ Cannot verify {service}: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
342 |                 metrics.safety_violations += 1
    |
    = help: Replace with `exception`

src/infrastructure/chaos/infrastructure/chaos_reporter.py:44:78: PLR2004 Magic value used in comparison, consider replacing `0.8` with a constant variable
   |
42 |             "overall_status": (
43 |                 "PASS"
44 |                 if metrics.safety_violations == 0 and metrics.success_rate > 0.8
   |                                                                              ^^^ PLR2004
45 |                 else "FAIL"
46 |             ),
   |

src/infrastructure/chaos/infrastructure/chaos_reporter.py:58:62: PLR2004 Magic value used in comparison, consider replacing `0.8` with a constant variable
   |
56 |             1
57 |             for m in self.orchestrator.experiment_history
58 |             if m.safety_violations == 0 and m.success_rate > 0.8
   |                                                              ^^^ PLR2004
59 |         )
   |

src/infrastructure/chaos/infrastructure/chaos_reporter.py:94:21: PLR2004 Magic value used in comparison, consider replacing `90` with a constant variable
   |
92 |     def _get_resilience_grade(self, score: float) -> str:
93 |         """Get resilience grade based on score."""
94 |         if score >= 90:
   |                     ^^ PLR2004
95 |             return "A+ (Excellent)"
96 |         if score >= 80:
   |

src/infrastructure/chaos/infrastructure/chaos_reporter.py:96:21: PLR2004 Magic value used in comparison, consider replacing `80` with a constant variable
   |
94 |         if score >= 90:
95 |             return "A+ (Excellent)"
96 |         if score >= 80:
   |                     ^^ PLR2004
97 |             return "A (Very Good)"
98 |         if score >= 70:
   |

src/infrastructure/chaos/infrastructure/chaos_reporter.py:98:21: PLR2004 Magic value used in comparison, consider replacing `70` with a constant variable
    |
 96 |         if score >= 80:
 97 |             return "A (Very Good)"
 98 |         if score >= 70:
    |                     ^^ PLR2004
 99 |             return "B (Good)"
100 |         if score >= 60:
    |

src/infrastructure/chaos/infrastructure/chaos_reporter.py:100:21: PLR2004 Magic value used in comparison, consider replacing `60` with a constant variable
    |
 98 |         if score >= 70:
 99 |             return "B (Good)"
100 |         if score >= 60:
    |                     ^^ PLR2004
101 |             return "C (Fair)"
102 |         if score >= 50:
    |

src/infrastructure/chaos/infrastructure/chaos_reporter.py:102:21: PLR2004 Magic value used in comparison, consider replacing `50` with a constant variable
    |
100 |         if score >= 60:
101 |             return "C (Fair)"
102 |         if score >= 50:
    |                     ^^ PLR2004
103 |             return "D (Poor)"
104 |         return "F (Fail)"
    |

src/infrastructure/chaos/monitoring/chaos_metrics/metrics_collector.py:7:1: E402 Module level import not at top of file
  |
5 | """Metrics Collector Implementation"""
6 |
7 | from src.infrastructure.logging_config import get_logger
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
8 |
9 | logger = get_logger(__name__, component="chaos")
  |

src/infrastructure/chaos/monitoring/chaos_metrics/metrics_collector.py:35:17: TRY400 Use `logging.exception` instead of `logging.error`
   |
33 |                 await asyncio.sleep(self.collection_interval)
34 |             except Exception as e:
35 |                 logger.error(f"Error collecting metrics: {e}")
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
36 |                 await asyncio.sleep(self.collection_interval)
   |
   = help: Replace with `exception`

src/infrastructure/chaos/monitoring/chaos_metrics/metrics_collector.py:49:9: PLC0415 `import` should be at the top-level of a file
   |
47 |         """Collect system health snapshot."""
48 |         # Mock implementation
49 |         from datetime import datetime
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
50 |
51 |         return SystemHealthSnapshot(
   |

src/infrastructure/chaos/monitoring/chaos_metrics/metrics_collector.py:65:9: PLC0415 `import` should be at the top-level of a file
   |
63 |         """Collect individual service metrics."""
64 |         # Mock implementation
65 |         import random
   |         ^^^^^^^^^^^^^ PLC0415
66 |         from datetime import datetime
   |

src/infrastructure/chaos/monitoring/chaos_metrics/metrics_collector.py:66:9: PLC0415 `import` should be at the top-level of a file
   |
64 |         # Mock implementation
65 |         import random
66 |         from datetime import datetime
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
67 |
68 |         metrics = []
   |

src/infrastructure/chaos/monitoring/chaos_metrics/metrics_collector.py:71:13: PERF401 Use a list comprehension to create a transformed list
   |
69 |           services = ["auth_service", "user_service", "chat_service"]
70 |           for service in services:
71 | /             metrics.append(
72 | |                 ChaosMetric(
73 | |                     timestamp=datetime.now(),
74 | |                     experiment_id=experiment_id,
75 | |                     service_name=service,
76 | |                     metric_name="cpu_usage",
77 | |                     metric_value=random.uniform(0.5, 1.0),
78 | |                     tags={"region": "us-east-1"},
79 | |                 ),
80 | |             )
   | |_____________^ PERF401
81 |           return metrics
   |
   = help: Replace for loop with list comprehension

src/infrastructure/chaos/monitoring/chaos_metrics/metrics_collector.py:77:34: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
   |
75 |                     service_name=service,
76 |                     metric_name="cpu_usage",
77 |                     metric_value=random.uniform(0.5, 1.0),
   |                                  ^^^^^^^^^^^^^^^^^^^^^^^^ S311
78 |                     tags={"region": "us-east-1"},
79 |                 ),
   |

src/infrastructure/config/accessibility_config.py:9:89: E501 Line too long (122 > 88)
   |
 8 |     Attributes:
 9 |         adaptation_rules (Dict[str, List[str]]): A mapping from special need type (string value) to a list of adaptations.
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
10 |         accessibility_settings_rules (Dict[str, Dict[str, bool]]): A mapping from special need type (string value) to a dictionary of …
11 |     """
   |

src/infrastructure/config/accessibility_config.py:10:89: E501 Line too long (152 > 88)
   |
 8 | …
 9 | …ng from special need type (string value) to a list of adaptations.
10 | …, bool]]): A mapping from special need type (string value) to a dictionary of setting overrides.
   |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
11 | …
   |

src/infrastructure/config/ai_settings.py:2:1: I001 [*] Import block is un-sorted or un-formatted
  |
2 | / from pydantic import Field
3 | | from src.infrastructure.config.base_settings import BaseApplicationSettings
  | |___________________________________________________________________________^ I001
4 |
5 |   class AISettings(BaseApplicationSettings):
  |
  = help: Organize imports

src/infrastructure/config/ai_settings.py:13:75: W292 [*] No newline at end of file
   |
11 |     OPENAI_MAX_TOKENS: int = Field(200, env="OPENAI_MAX_TOKENS")
12 |     WHISPER_MODEL: str = Field("medium", env="WHISPER_MODEL")
13 |     ELEVENLABS_API_KEY: str | None = Field(None, env="ELEVENLABS_API_KEY")
   |                                                                           ^ W292
   |
   = help: Add trailing newline

src/infrastructure/config/application_settings.py:2:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 |   # src/infrastructure/config/application_settings.py
2 | / from pathlib import Path
3 | | from pydantic import Field
4 | | from src.common import constants
5 | | from src.infrastructure.config.base_settings import BaseApplicationSettings
  | |___________________________________________________________________________^ I001
6 |
7 |   class ApplicationSettings(BaseApplicationSettings):
  |
  = help: Organize imports

src/infrastructure/config/application_settings.py:8:5: D300 [*] Use triple double quotes `"""`
   |
 7 | class ApplicationSettings(BaseApplicationSettings):
 8 |     '''General application configuration settings.'''
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D300
 9 |     
10 |     # إزالة env من جميع الحقول لمنع القراءة المباشرة
   |
   = help: Convert to triple double quotes

src/infrastructure/config/application_settings.py:9:1: W293 [*] Blank line contains whitespace
   |
 7 | class ApplicationSettings(BaseApplicationSettings):
 8 |     '''General application configuration settings.'''
 9 |     
   | ^^^^ W293
10 |     # إزالة env من جميع الحقول لمنع القراءة المباشرة
11 |     ENVIRONMENT: str = Field(default="development")
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/application_settings.py:28:1: W293 [*] Blank line contains whitespace
   |
26 |     )
27 |     STATIC_FILES_DIR: str = Field(default="static")
28 |     
   | ^^^^ W293
29 |     # المتغيرات الإضافية
30 |     ENABLE_AI_SERVICES: bool = Field(default=True)
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/application_settings.py:32:1: W293 [*] Blank line contains whitespace
   |
30 |     ENABLE_AI_SERVICES: bool = Field(default=True)
31 |     USE_MOCK_SERVICES: bool = Field(default=False)
32 |     
   | ^^^^ W293
33 |     # إعدادات السجلات
34 |     LOG_LEVEL: str = Field(default="INFO")
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/base_settings.py:6:5: D300 [*] Use triple double quotes `"""`
  |
5 | class BaseApplicationSettings(BaseSettings):
6 |     '''Base settings for all environments.'''
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D300
7 |     
8 |     model_config = SettingsConfigDict(
  |
  = help: Convert to triple double quotes

src/infrastructure/config/base_settings.py:7:1: W293 [*] Blank line contains whitespace
  |
5 | class BaseApplicationSettings(BaseSettings):
6 |     '''Base settings for all environments.'''
7 |     
  | ^^^^ W293
8 |     model_config = SettingsConfigDict(
9 |         env_file=".env",
  |
  = help: Remove whitespace from blank line

src/infrastructure/config/coppa_config.py:21:45: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
19 |     """Centralized COPPA configuration manager."""
20 |
21 |     def __init__(self, settings: Settings = Depends(get_settings)) -> None:
   |                                             ^^^^^^^^^^^^^^^^^^^^^ B008
22 |         """Initializes the COPPA configuration.
   |

src/infrastructure/config/coppa_config.py:44:5: B019 Use of `functools.lru_cache` or `functools.cache` on methods can lead to memory leaks
   |
42 |         return self._enabled
43 |
44 |     @lru_cache(maxsize=1)  # Cache the initialization result
   |     ^^^^^^^^^^^^^^^^^^^^^ B019
45 |     def _initialize(self) -> None:
46 |         """Initializes COPPA configuration from environment and settings."""
   |

src/infrastructure/config/coppa_config.py:79:1: W293 Blank line contains whitespace
   |
77 | def is_coppa_enabled() -> bool:
78 |     """Check if COPPA compliance is enabled.
79 |     
   | ^^^^ W293
80 |     Returns:
81 |         True if COPPA is enabled, False otherwise.
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/database_settings.py:8:1: I001 [*] Import block is un-sorted or un-formatted
   |
 6 |   environments (e.g., PostgreSQL for production, SQLite or PostgreSQL for development).
 7 |   """
 8 | / import os
 9 | | from pydantic import Field, field_validator
10 | | from src.infrastructure.config.base_settings import BaseApplicationSettings
   | |___________________________________________________________________________^ I001
11 |
12 |   class DatabaseSettings(BaseApplicationSettings):
   |
   = help: Organize imports

src/infrastructure/config/database_settings.py:17:1: W293 [*] Blank line contains whitespace
   |
15 |     DATABASE_URL: str = Field(..., env="DATABASE_URL")
16 |     ASYNC_DATABASE_URL: str = Field(..., env="ASYNC_DATABASE_URL")
17 |     
   | ^^^^ W293
18 |     # إضافة المتغيرات المفقودة
19 |     DB_HOST: str = Field("localhost", env="DB_HOST")
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/database_settings.py:23:1: W293 [*] Blank line contains whitespace
   |
21 |     DB_NAME: str = Field("ai_teddy", env="DB_NAME")
22 |     DB_PASSWORD: str | None = Field(None, env="DB_PASSWORD")
23 |     
   | ^^^^ W293
24 |     ENABLE_DATABASE: bool = Field(True, env="ENABLE_DATABASE")
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/database_settings.py:43:23: TRY003 Avoid specifying long messages outside the exception class
   |
41 |         if os.getenv("ENVIRONMENT") == "production":
42 |             if not v.startswith("postgresql"):
43 |                 raise ValueError("PostgreSQL is required for production environments.")
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
44 |         elif not (v.startswith("sqlite") or v.startswith("postgresql")):
45 |             raise ValueError(
   |

src/infrastructure/config/database_settings.py:45:19: TRY003 Avoid specifying long messages outside the exception class
   |
43 |                   raise ValueError("PostgreSQL is required for production environments.")
44 |           elif not (v.startswith("sqlite") or v.startswith("postgresql")):
45 |               raise ValueError(
   |  ___________________^
46 | |                 "Only SQLite or PostgreSQL are allowed for development/testing.",
47 | |             )
   | |_____________^ TRY003
48 |           return v
   |

src/infrastructure/config/env_security.py:24:18: S105 Possible hardcoded password assigned to: "SECRET_KEY"
   |
22 |     """Enumeration of recognized environment variables."""
23 |
24 |     SECRET_KEY = "SECRET_KEY"
   |                  ^^^^^^^^^^^^ S105
25 |     JWT_SECRET_KEY = "JWT_SECRET_KEY"
26 |     DATABASE_URL = "DATABASE_URL"
   |

src/infrastructure/config/env_security.py:25:22: S105 Possible hardcoded password assigned to: "JWT_SECRET_KEY"
   |
24 |     SECRET_KEY = "SECRET_KEY"
25 |     JWT_SECRET_KEY = "JWT_SECRET_KEY"
   |                      ^^^^^^^^^^^^^^^^ S105
26 |     DATABASE_URL = "DATABASE_URL"
27 |     ENVIRONMENT = "ENVIRONMENT"
   |

src/infrastructure/config/env_security.py:61:14: S105 Possible hardcoded password assigned to: "SECRET"
   |
60 |     KEY = r".*_KEY$"
61 |     SECRET = r".*_SECRET$"
   |              ^^^^^^^^^^^^^ S105
62 |     PASSWORD = r".*_PASSWORD$"
63 |     TOKEN = r".*_TOKEN$"
   |

src/infrastructure/config/env_security.py:62:16: S105 Possible hardcoded password assigned to: "PASSWORD"
   |
60 |     KEY = r".*_KEY$"
61 |     SECRET = r".*_SECRET$"
62 |     PASSWORD = r".*_PASSWORD$"
   |                ^^^^^^^^^^^^^^^ S105
63 |     TOKEN = r".*_TOKEN$"
64 |     CREDENTIALS = r".*_CREDENTIALS$"
   |

src/infrastructure/config/env_security.py:63:13: S105 Possible hardcoded password assigned to: "TOKEN"
   |
61 |     SECRET = r".*_SECRET$"
62 |     PASSWORD = r".*_PASSWORD$"
63 |     TOKEN = r".*_TOKEN$"
   |             ^^^^^^^^^^^^ S105
64 |     CREDENTIALS = r".*_CREDENTIALS$"
65 |     JWT = r"^JWT_.*"
   |

src/infrastructure/config/env_security.py:126:9: SIM110 Use `return any(pattern.match(key) for pattern in SENSITIVE_PATTERNS)` instead of `for` loop
    |
124 |               True if the key is sensitive, False otherwise.
125 |           """
126 | /         for pattern in SENSITIVE_PATTERNS:
127 | |             if pattern.match(key):
128 | |                 return True
129 | |         return False
    | |____________________^ SIM110
130 |
131 |       def get_env_var(self, key: str, default: str | None = None) -> str | None:
    |
    = help: Replace with `return any(pattern.match(key) for pattern in SENSITIVE_PATTERNS)`

src/infrastructure/config/env_security.py:150:89: E501 Line too long (94 > 88)
    |
149 |         Returns:
150 |             A dictionary of environment variables with sensitive values replaced by asterisks.
    |                                                                                         ^^^^^^ E501
151 |         """
152 |         masked_vars = {}
    |

src/infrastructure/config/env_security.py:173:19: TRY003 Avoid specifying long messages outside the exception class
    |
171 |         ]
172 |         if missing_vars:
173 |             raise ValueError(f"Missing required environment variables: {missing_vars}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
174 |
175 |     def hash_sensitive_value(self, value: str) -> str:
    |

src/infrastructure/config/env_security.py:186:5: B019 Use of `functools.lru_cache` or `functools.cache` on methods can lead to memory leaks
    |
184 |         return hashlib.sha256(value.encode()).hexdigest()
185 |
186 |     @lru_cache(maxsize=1)
    |     ^^^^^^^^^^^^^^^^^^^^^ B019
187 |     def get_instance(self) -> "SecureEnvironmentManager":
188 |         """Returns a singleton instance of SecureEnvironmentManager.
    |

src/infrastructure/config/infrastructure_settings.py:99:19: TRY003 Avoid specifying long messages outside the exception class
    |
 97 |         """
 98 |         if not v.startswith("postgresql"):
 99 |             raise ValueError("Database URL must start with 'postgresql'")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
100 |         return v
    |

src/infrastructure/config/kafka_settings.py:1:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | / from pydantic import Field
2 | | from src.infrastructure.config.base_settings import BaseApplicationSettings
  | |___________________________________________________________________________^ I001
3 |
4 |   class KafkaSettings(BaseApplicationSettings):
  |
  = help: Organize imports

src/infrastructure/config/kafka_settings.py:8:89: E501 Line too long (94 > 88)
  |
7 |     KAFKA_BOOTSTRAP_SERVERS: str = Field("kafka:9092", env="KAFKA_BOOTSTRAP_SERVERS")
8 |     SCHEMA_REGISTRY_URL: str = Field("http://schema-registry:8081", env="SCHEMA_REGISTRY_URL")
  |                                                                                         ^^^^^^ E501
9 |     KAFKA_ENABLED: bool = Field(False, env="KAFKA_ENABLED")
  |

src/infrastructure/config/models.py:20:89: E501 Line too long (90 > 88)
   |
18 |         "production",
19 |         pattern="^(development|testing|staging|production)$",
20 |         description="Application environment (development, testing, staging, production)",
   |                                                                                         ^^ E501
21 |     )
22 |     DEBUG: bool = Field(False, description="Enable debug mode")
   |

src/infrastructure/config/privacy_settings.py:8:1: I001 [*] Import block is un-sorted or un-formatted
   |
 6 |   supporting regulatory adherence and user data protection.
 7 |   """
 8 | / from pydantic import Field
 9 | | from src.infrastructure.config.base_settings import BaseApplicationSettings
   | |___________________________________________________________________________^ I001
10 |
11 |   class PrivacySettings(BaseApplicationSettings):
   |
   = help: Organize imports

src/infrastructure/config/privacy_settings.py:17:1: W293 [*] Blank line contains whitespace
   |
15 |     MAX_CHILD_AGE: int = Field(12, env="MAX_CHILD_AGE")
16 |     PARENTAL_CONSENT_REQUIRED: bool = Field(True, env="PARENTAL_CONSENT_REQUIRED")
17 |     
   | ^^^^ W293
18 |     # إعدادات الاحتفاظ بالبيانات
19 |     DATA_RETENTION_DAYS: int = Field(90, env="DATA_RETENTION_DAYS")
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/privacy_settings.py:21:71: W292 [*] No newline at end of file
   |
19 |     DATA_RETENTION_DAYS: int = Field(90, env="DATA_RETENTION_DAYS")
20 |     AUTO_DELETE_ENABLED: bool = Field(True, env="AUTO_DELETE_ENABLED")
21 |     DATA_EXPORT_ENABLED: bool = Field(True, env="DATA_EXPORT_ENABLED")
   |                                                                       ^ W292
   |
   = help: Add trailing newline

src/infrastructure/config/production_check.py:5:1: UP035 `typing.List` is deprecated, use `list` instead
  |
3 | import sys
4 | from pathlib import Path
5 | from typing import List, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
6 |
7 | from src.infrastructure.config.settings import get_settings
  |

src/infrastructure/config/production_check.py:5:1: UP035 `typing.Tuple` is deprecated, use `tuple` instead
  |
3 | import sys
4 | from pathlib import Path
5 | from typing import List, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
6 |
7 | from src.infrastructure.config.settings import get_settings
  |

src/infrastructure/config/production_check.py:5:26: F401 [*] `typing.Tuple` imported but unused
  |
3 | import sys
4 | from pathlib import Path
5 | from typing import List, Tuple
  |                          ^^^^^ F401
6 |
7 | from src.infrastructure.config.settings import get_settings
  |
  = help: Remove unused import: `typing.Tuple`

src/infrastructure/config/production_check.py:15:1: W293 [*] Blank line contains whitespace
   |
13 |     """Validate all production requirements are met."""
14 |     logger.info("Running production environment checks...")
15 |     
   | ^^^^ W293
16 |     errors: List[str] = []
17 |     warnings: List[str] = []
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/production_check.py:16:13: UP006 [*] Use `list` instead of `List` for type annotation
   |
14 |     logger.info("Running production environment checks...")
15 |     
16 |     errors: List[str] = []
   |             ^^^^ UP006
17 |     warnings: List[str] = []
   |
   = help: Replace with `list`

src/infrastructure/config/production_check.py:17:15: UP006 [*] Use `list` instead of `List` for type annotation
   |
16 |     errors: List[str] = []
17 |     warnings: List[str] = []
   |               ^^^^ UP006
18 |     
19 |     # Check environment variables
   |
   = help: Replace with `list`

src/infrastructure/config/production_check.py:18:1: W293 [*] Blank line contains whitespace
   |
16 |     errors: List[str] = []
17 |     warnings: List[str] = []
18 |     
   | ^^^^ W293
19 |     # Check environment variables
20 |     required_vars = [
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/production_check.py:26:1: W293 [*] Blank line contains whitespace
   |
24 |         "JWT_SECRET_KEY",
25 |     ]
26 |     
   | ^^^^ W293
27 |     for var in required_vars:
28 |         if not os.getenv(var):
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/production_check.py:29:13: PERF401 Use a list comprehension to create a transformed list
   |
27 |     for var in required_vars:
28 |         if not os.getenv(var):
29 |             errors.append(f"Missing required environment variable: {var}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PERF401
30 |     
31 |     # Check SSL certificates
   |
   = help: Replace for loop with list comprehension

src/infrastructure/config/production_check.py:30:1: W293 [*] Blank line contains whitespace
   |
28 |         if not os.getenv(var):
29 |             errors.append(f"Missing required environment variable: {var}")
30 |     
   | ^^^^ W293
31 |     # Check SSL certificates
32 |     ssl_cert = Path("/etc/ssl/certs/teddy-bear.crt")
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/production_check.py:34:1: W293 [*] Blank line contains whitespace
   |
32 |     ssl_cert = Path("/etc/ssl/certs/teddy-bear.crt")
33 |     ssl_key = Path("/etc/ssl/private/teddy-bear.key")
34 |     
   | ^^^^ W293
35 |     if not ssl_cert.exists():
36 |         warnings.append("SSL certificate not found")
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/production_check.py:39:1: W293 [*] Blank line contains whitespace
   |
37 |     if not ssl_key.exists():
38 |         warnings.append("SSL key not found")
39 |     
   | ^^^^ W293
40 |     # Display results
41 |     if errors:
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/production_check.py:46:1: W293 [*] Blank line contains whitespace
   |
44 |             logger.error(f"  ❌ {error}")
45 |         sys.exit(1)
46 |     
   | ^^^^ W293
47 |     if warnings:
48 |         logger.warning("Production warnings:")
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/production_check.py:51:1: W293 [*] Blank line contains whitespace
   |
49 |         for warning in warnings:
50 |             logger.warning(f"  ⚠️  {warning}")
51 |     
   | ^^^^ W293
52 |     logger.info("✅ Production checks passed!")
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/production_check.py:56:14: UP032 [*] Use f-string instead of `format` call
   |
54 |   def display_startup_banner() -> None:
55 |       """Display application startup banner."""
56 |       banner = """
   |  ______________^
57 | |     🧸 AI Teddy Bear v1.0.0
58 | |     ========================
59 | |     Safe AI Companion for Children
60 | |     
61 | |     Environment: {}
62 | |     Debug Mode: {}
63 | |     """.format(
64 | |         get_settings().ENVIRONMENT,
65 | |         get_settings().DEBUG
66 | |     )
   | |_____^ UP032
67 |       print(banner)
   |
   = help: Convert to f-string

src/infrastructure/config/production_check.py:60:1: W293 Blank line contains whitespace
   |
58 |     ========================
59 |     Safe AI Companion for Children
60 |     
   | ^^^^ W293
61 |     Environment: {}
62 |     Debug Mode: {}
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/production_check.py:72:1: W293 [*] Blank line contains whitespace
   |
70 |     """Enforce production safety requirements."""
71 |     settings = get_settings()
72 |     
   | ^^^^ W293
73 |     if settings.ENVIRONMENT == "production":
74 |         check_production_requirements()
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/production_check.py:76:89: E501 Line too long (91 > 88)
   |
74 |         check_production_requirements()
75 |     else:
76 |         logger.info(f"Running in {settings.ENVIRONMENT} mode - skipping production checks")
   |                                                                                         ^^^ E501
77 |         logger.info(f"Running in {settings.ENVIRONMENT} mode - skipping production checks")
   |

src/infrastructure/config/production_check.py:77:89: E501 Line too long (91 > 88)
   |
75 |     else:
76 |         logger.info(f"Running in {settings.ENVIRONMENT} mode - skipping production checks")
77 |         logger.info(f"Running in {settings.ENVIRONMENT} mode - skipping production checks")
   |                                                                                         ^^^ E501
   |

src/infrastructure/config/production_settings.py:1:89: E501 Line too long (93 > 88)
  |
1 | """Defines comprehensive production configuration settings for the AI Teddy Bear application.
  |                                                                                         ^^^^^ E501
2 |
3 | This module extends various base settings classes to provide a complete set
  |

src/infrastructure/config/production_settings.py:99:9: D205 1 blank line required between summary line and description
    |
 97 |       @root_validator(pre=True)
 98 |       def check_production_env_vars(self, values: dict[str, Any]) -> dict[str, Any]:
 99 | /         """Performs a root validation to ensure critical environment variables
100 | |         are set for production.
101 | |
102 | |         Args:
103 | |             values: The dictionary of settings values.
104 | |
105 | |         Returns:
106 | |             The validated dictionary of settings values.
107 | |
108 | |         Raises:
109 | |             ValueError: If critical production environment variables are missing.
110 | |
111 | |         """
    | |___________^ D205
112 |           if values.get("environment") == "production":
113 |               required_prod_vars = [
    |
    = help: Insert single blank line

src/infrastructure/config/production_settings.py:120:23: TRY003 Avoid specifying long messages outside the exception class
    |
118 |               missing_vars = [var for var in required_prod_vars if not os.getenv(var)]
119 |               if missing_vars:
120 |                   raise ValueError(
    |  _______________________^
121 | |                     f"Missing critical production environment variables: {missing_vars}",
122 | |                 )
    | |_________________^ TRY003
123 |           return values
    |

src/infrastructure/config/production_settings.py:121:89: E501 Line too long (89 > 88)
    |
119 |             if missing_vars:
120 |                 raise ValueError(
121 |                     f"Missing critical production environment variables: {missing_vars}",
    |                                                                                         ^ E501
122 |                 )
123 |         return values
    |

src/infrastructure/config/prometheus_settings.py:1:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | / from pydantic import Field
2 | | from src.infrastructure.config.base_settings import BaseApplicationSettings
  | |___________________________________________________________________________^ I001
3 |
4 |   class PrometheusSettings(BaseApplicationSettings):
  |
  = help: Organize imports

src/infrastructure/config/prometheus_settings.py:8:62: W292 [*] No newline at end of file
  |
7 |     PROMETHEUS_ENABLED: bool = Field(True, env="PROMETHEUS_ENABLED")
8 |     PROMETHEUS_PORT: int = Field(9090, env="PROMETHEUS_PORT")
  |                                                              ^ W292
  |
  = help: Add trailing newline

src/infrastructure/config/redis_settings.py:9:1: I001 [*] Import block is un-sorted or un-formatted
   |
 7 |   """
 8 |
 9 | / from pydantic import Field
10 | | from src.infrastructure.config.base_settings import BaseApplicationSettings
   | |___________________________________________________________________________^ I001
11 |
12 |   class RedisSettings(BaseApplicationSettings):
   |
   = help: Organize imports

src/infrastructure/config/secure_settings.py:66:21: PLR2004 Magic value used in comparison, consider replacing `32` with a constant variable
   |
65 |         """
66 |         if len(v) < 32:
   |                     ^^ PLR2004
67 |             raise ValueError("Secret key must be at least 32 characters")
68 |         if v in ["CHANGE_THIS_TO_A_STRONG_SECRET_KEY", "your_secret_here"]:
   |

src/infrastructure/config/secure_settings.py:67:19: TRY003 Avoid specifying long messages outside the exception class
   |
65 |         """
66 |         if len(v) < 32:
67 |             raise ValueError("Secret key must be at least 32 characters")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
68 |         if v in ["CHANGE_THIS_TO_A_STRONG_SECRET_KEY", "your_secret_here"]:
69 |             raise ValueError("Must change default secret key")
   |

src/infrastructure/config/secure_settings.py:69:19: TRY003 Avoid specifying long messages outside the exception class
   |
67 |             raise ValueError("Secret key must be at least 32 characters")
68 |         if v in ["CHANGE_THIS_TO_A_STRONG_SECRET_KEY", "your_secret_here"]:
69 |             raise ValueError("Must change default secret key")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
70 |         return v
   |

src/infrastructure/config/secure_settings.py:72:11: D106 Missing docstring in public nested class
   |
70 |         return v
71 |
72 |     class Config:
   |           ^^^^^^ D106
73 |         env_file = ".env"
74 |         extra = "ignore"
   |

src/infrastructure/config/security_settings.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """
2 | | src/infrastructure/config/security_settings.py
3 | | تحديث SecuritySettings لإضافة قيم افتراضية
4 | | """
  | |___^ D205
5 |   from pydantic import Field, SecretStr, model_validator
6 |   from src.infrastructure.config.base_settings import BaseApplicationSettings
  |
  = help: Insert single blank line

src/infrastructure/config/security_settings.py:1:1: D212 [*] Multi-line docstring summary should start at the first line
  |
1 | / """
2 | | src/infrastructure/config/security_settings.py
3 | | تحديث SecuritySettings لإضافة قيم افتراضية
4 | | """
  | |___^ D212
5 |   from pydantic import Field, SecretStr, model_validator
6 |   from src.infrastructure.config.base_settings import BaseApplicationSettings
  |
  = help: Remove whitespace after opening quotes

src/infrastructure/config/security_settings.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """
2 | | src/infrastructure/config/security_settings.py
3 | | تحديث SecuritySettings لإضافة قيم افتراضية
4 | | """
  | |___^ D415
5 |   from pydantic import Field, SecretStr, model_validator
6 |   from src.infrastructure.config.base_settings import BaseApplicationSettings
  |
  = help: Add closing punctuation

src/infrastructure/config/security_settings.py:5:1: I001 [*] Import block is un-sorted or un-formatted
  |
3 |   تحديث SecuritySettings لإضافة قيم افتراضية
4 |   """
5 | / from pydantic import Field, SecretStr, model_validator
6 | | from src.infrastructure.config.base_settings import BaseApplicationSettings
  | |___________________________________________________________________________^ I001
7 |
8 |   class SecuritySettings(BaseApplicationSettings):
  |
  = help: Organize imports

src/infrastructure/config/security_settings.py:22:77: W291 [*] Trailing whitespace
   |
20 |     )
21 |     JWT_SECRET_KEY: str = Field(
22 |         default="DEVELOPMENT_JWT_SECRET_KEY_CHANGE_IN_PRODUCTION_123456789", 
   |                                                                             ^ W291
23 |         env="JWT_SECRET_KEY"
24 |     )
   |
   = help: Remove trailing whitespace

src/infrastructure/config/security_settings.py:37:1: W293 [*] Blank line contains whitespace
   |
35 |     DATA_ENCRYPTION_KEY: str | None = Field(default=None, env="DATA_ENCRYPTION_KEY")
36 |     FIELD_ENCRYPTION_KEY: str | None = Field(default=None, env="FIELD_ENCRYPTION_KEY")
37 |     
   | ^^^^ W293
38 |     RATE_LIMIT_REQUESTS_PER_MINUTE: int = Field(60, env="RATE_LIMIT_REQUESTS_PER_MINUTE")
39 |     RATE_LIMIT_BURST: int = Field(10, env="RATE_LIMIT_BURST")
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/security_settings.py:38:89: E501 Line too long (89 > 88)
   |
36 |     FIELD_ENCRYPTION_KEY: str | None = Field(default=None, env="FIELD_ENCRYPTION_KEY")
37 |     
38 |     RATE_LIMIT_REQUESTS_PER_MINUTE: int = Field(60, env="RATE_LIMIT_REQUESTS_PER_MINUTE")
   |                                                                                         ^ E501
39 |     RATE_LIMIT_BURST: int = Field(10, env="RATE_LIMIT_BURST")
40 |     RATE_LIMIT_REQUESTS_PER_HOUR: int = Field(3600, env="RATE_LIMIT_REQUESTS_PER_HOUR")
   |

src/infrastructure/config/security_settings.py:41:1: W293 [*] Blank line contains whitespace
   |
39 |     RATE_LIMIT_BURST: int = Field(10, env="RATE_LIMIT_BURST")
40 |     RATE_LIMIT_REQUESTS_PER_HOUR: int = Field(3600, env="RATE_LIMIT_REQUESTS_PER_HOUR")
41 |     
   | ^^^^ W293
42 |     MAX_LOGIN_ATTEMPTS: int = Field(5, env="MAX_LOGIN_ATTEMPTS")
43 |     LOCKOUT_DURATION_SECONDS: int = Field(300, env="LOCKOUT_DURATION_SECONDS")
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/security_settings.py:55:1: W293 [*] Blank line contains whitespace
   |
53 |     SESSION_HTTPONLY: bool = Field(True, env="SESSION_HTTPONLY")
54 |     SESSION_SAMESITE: str = Field("strict", env="SESSION_SAMESITE")
55 |     
   | ^^^^ W293
56 |     CONTENT_FILTER_STRICT_MODE: bool = Field(True, env="CONTENT_FILTER_STRICT_MODE")
57 |     SAFETY_THRESHOLD: float = Field(0.8, env="SAFETY_THRESHOLD")
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/security_settings.py:86:89: E501 Line too long (93 > 88)
   |
84 |     @model_validator(mode="after")
85 |     def validate_token_expiration(self) -> "SecuritySettings":
86 |         """Validate that access token expiration does not exceed refresh token expiration."""
   |                                                                                         ^^^^^ E501
87 |         if self.ACCESS_TOKEN_EXPIRE_MINUTES >= (
88 |             self.REFRESH_TOKEN_EXPIRE_DAYS * 24 * 60
   |

src/infrastructure/config/security_settings.py:90:19: TRY003 Avoid specifying long messages outside the exception class
   |
88 |               self.REFRESH_TOKEN_EXPIRE_DAYS * 24 * 60
89 |           ):
90 |               raise ValueError(
   |  ___________________^
91 | |                 "ACCESS_TOKEN_EXPIRE_MINUTES cannot exceed REFRESH_TOKEN_EXPIRE_DAYS.",
92 | |             )
   | |_____________^ TRY003
93 |           return self
   |

src/infrastructure/config/server_settings.py:9:1: I001 [*] Import block is un-sorted or un-formatted
   |
 7 |   optimized server configurations for both development and production.
 8 |   """
 9 | / from pydantic import Field
10 | | from src.infrastructure.config.base_settings import BaseApplicationSettings
   | |___________________________________________________________________________^ I001
11 |
12 |   class ServerSettings(BaseApplicationSettings):
   |
   = help: Organize imports

src/infrastructure/config/server_settings.py:17:72: W291 [*] Trailing whitespace
   |
15 |     # إعدادات CORS
16 |     ALLOWED_ORIGINS: list[str] = Field(
17 |         ["https://app.aiteddybear.com", "https://api.aiteddybear.com"], 
   |                                                                        ^ W291
18 |         env="ALLOWED_ORIGINS"
19 |     )
   |
   = help: Remove trailing whitespace

src/infrastructure/config/server_settings.py:21:42: W291 [*] Trailing whitespace
   |
19 |     )
20 |     ALLOWED_METHODS: list[str] = Field(
21 |         ["GET", "POST", "PUT", "DELETE"], 
   |                                          ^ W291
22 |         env="ALLOWED_METHODS"
23 |     )
   |
   = help: Remove trailing whitespace

src/infrastructure/config/server_settings.py:65:11: D106 Missing docstring in public nested class
   |
63 |     )
64 |
65 |     class Config:
   |           ^^^^^^ D106
66 |         env_prefix = "SERVER_"  # Optional: prefix for environment variables
67 |         case_sensitive = True
   |

src/infrastructure/config/session_config.py:9:89: E501 Line too long (109 > 88)
   |
 8 |     Attributes:
 9 |         session_timeout_minutes (int): The number of minutes after which a session expires due to inactivity.
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^ E501
10 |
11 |     """
   |

src/infrastructure/config/settings.py:1:1: D200 One-line docstring should fit on one line
  |
1 | / """
2 | | src/infrastructure/config/settings.py
3 | | """
  | |___^ D200
4 |   from functools import lru_cache
5 |   from pydantic_settings import BaseSettings, SettingsConfigDict
  |
  = help: Reformat to one line

src/infrastructure/config/settings.py:1:1: D212 [*] Multi-line docstring summary should start at the first line
  |
1 | / """
2 | | src/infrastructure/config/settings.py
3 | | """
  | |___^ D212
4 |   from functools import lru_cache
5 |   from pydantic_settings import BaseSettings, SettingsConfigDict
  |
  = help: Remove whitespace after opening quotes

src/infrastructure/config/settings.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """
2 | | src/infrastructure/config/settings.py
3 | | """
  | |___^ D415
4 |   from functools import lru_cache
5 |   from pydantic_settings import BaseSettings, SettingsConfigDict
  |
  = help: Add closing punctuation

src/infrastructure/config/settings.py:4:1: I001 [*] Import block is un-sorted or un-formatted
   |
 2 |   src/infrastructure/config/settings.py
 3 |   """
 4 | / from functools import lru_cache
 5 | | from pydantic_settings import BaseSettings, SettingsConfigDict
 6 | |
 7 | | from src.infrastructure.config.ai_settings import AISettings
 8 | | from src.infrastructure.config.application_settings import ApplicationSettings
 9 | | from src.infrastructure.config.audio_settings import AudioSettings
10 | | from src.infrastructure.config.content_moderation_settings import ContentModerationSettings
11 | | from src.infrastructure.config.database_settings import DatabaseSettings
12 | | from src.infrastructure.config.kafka_settings import KafkaSettings
13 | | from src.infrastructure.config.privacy_settings import PrivacySettings
14 | | from src.infrastructure.config.prometheus_settings import PrometheusSettings
15 | | from src.infrastructure.config.redis_settings import RedisSettings
16 | | from src.infrastructure.config.security_settings import SecuritySettings
17 | | from src.infrastructure.config.sentry_settings import SentrySettings
18 | | from src.infrastructure.config.server_settings import ServerSettings
19 | | from src.infrastructure.config.voice_settings import VoiceSettings
20 | | from src.infrastructure.logging_config import get_logger
   | |________________________________________________________^ I001
21 |
22 |   logger = get_logger(__name__, component="config")
   |
   = help: Organize imports

src/infrastructure/config/settings.py:10:89: E501 Line too long (91 > 88)
   |
 8 | from src.infrastructure.config.application_settings import ApplicationSettings
 9 | from src.infrastructure.config.audio_settings import AudioSettings
10 | from src.infrastructure.config.content_moderation_settings import ContentModerationSettings
   |                                                                                         ^^^ E501
11 | from src.infrastructure.config.database_settings import DatabaseSettings
12 | from src.infrastructure.config.kafka_settings import KafkaSettings
   |

src/infrastructure/config/settings.py:36:1: W293 [*] Blank line contains whitespace
   |
34 |         extra="ignore",
35 |     )
36 |     
   | ^^^^ W293
37 |     # إنشاء الإعدادات الفرعية بدون تمرير المتغيرات
38 |     application: ApplicationSettings
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/settings.py:67:1: W293 [*] Blank line contains whitespace
   |
65 |         self.content_moderation = ContentModerationSettings()
66 |         self.server = ServerSettings()
67 |         
   | ^^^^^^^^ W293
68 |         # استدعاء __init__ للفئة الأساسية
69 |         super().__init__(**kwargs)
   |
   = help: Remove whitespace from blank line

src/infrastructure/config/settings.py:78:23: TRY003 Avoid specifying long messages outside the exception class
   |
76 |           if env == "production":
77 |               if self.application.DEBUG:
78 |                   raise ValueError(
   |  _______________________^
79 | |                     "DEBUG must be False in production environment for security.",
80 | |                 )
   | |_________________^ TRY003
81 |
82 |               # Critical security and infrastructure keys
   |

src/infrastructure/config/settings.py:83:80: PLR2004 Magic value used in comparison, consider replacing `32` with a constant variable
   |
82 |             # Critical security and infrastructure keys
83 |             if not self.security.SECRET_KEY or len(self.security.SECRET_KEY) < 32:
   |                                                                                ^^ PLR2004
84 |                 raise ValueError(
85 |                     "SECRET_KEY must be set and at least 32 characters long in production.",
   |

src/infrastructure/config/settings.py:84:23: TRY003 Avoid specifying long messages outside the exception class
   |
82 |               # Critical security and infrastructure keys
83 |               if not self.security.SECRET_KEY or len(self.security.SECRET_KEY) < 32:
84 |                   raise ValueError(
   |  _______________________^
85 | |                     "SECRET_KEY must be set and at least 32 characters long in production.",
86 | |                 )
   | |_________________^ TRY003
87 |               if (
88 |                   not self.security.JWT_SECRET_KEY
   |

src/infrastructure/config/settings.py:85:89: E501 Line too long (92 > 88)
   |
83 |             if not self.security.SECRET_KEY or len(self.security.SECRET_KEY) < 32:
84 |                 raise ValueError(
85 |                     "SECRET_KEY must be set and at least 32 characters long in production.",
   |                                                                                         ^^^^ E501
86 |                 )
87 |             if (
   |

src/infrastructure/config/settings.py:89:56: PLR2004 Magic value used in comparison, consider replacing `32` with a constant variable
   |
87 |             if (
88 |                 not self.security.JWT_SECRET_KEY
89 |                 or len(self.security.JWT_SECRET_KEY) < 32
   |                                                        ^^ PLR2004
90 |             ):
91 |                 raise ValueError(
   |

src/infrastructure/config/settings.py:91:23: TRY003 Avoid specifying long messages outside the exception class
   |
89 |                   or len(self.security.JWT_SECRET_KEY) < 32
90 |               ):
91 |                   raise ValueError(
   |  _______________________^
92 | |                     "JWT_SECRET_KEY must be set and at least 32 characters long in production.",
93 | |                 )
   | |_________________^ TRY003
94 |               if (
95 |                   not self.security.COPPA_ENCRYPTION_KEY
   |

src/infrastructure/config/settings.py:92:89: E501 Line too long (96 > 88)
   |
90 |             ):
91 |                 raise ValueError(
92 |                     "JWT_SECRET_KEY must be set and at least 32 characters long in production.",
   |                                                                                         ^^^^^^^^ E501
93 |                 )
94 |             if (
   |

src/infrastructure/config/settings.py:96:63: PLR2004 Magic value used in comparison, consider replacing `44` with a constant variable
   |
94 |             if (
95 |                 not self.security.COPPA_ENCRYPTION_KEY
96 |                 or len(self.security.COPPA_ENCRYPTION_KEY) != 44
   |                                                               ^^ PLR2004
97 |             ):
98 |                 raise ValueError(
   |

src/infrastructure/config/settings.py:98:23: TRY003 Avoid specifying long messages outside the exception class
    |
 96 |                   or len(self.security.COPPA_ENCRYPTION_KEY) != 44
 97 |               ):
 98 |                   raise ValueError(
    |  _______________________^
 99 | |                     "COPPA_ENCRYPTION_KEY must be a valid Fernet key (44 characters) in production.",
100 | |                 )
    | |_________________^ TRY003
101 |
102 |               # Essential external service URLs
    |

src/infrastructure/config/settings.py:99:89: E501 Line too long (101 > 88)
    |
 97 |             ):
 98 |                 raise ValueError(
 99 |                     "COPPA_ENCRYPTION_KEY must be a valid Fernet key (44 characters) in production.",
    |                                                                                         ^^^^^^^^^^^^^ E501
100 |                 )
    |

src/infrastructure/config/settings.py:104:23: TRY003 Avoid specifying long messages outside the exception class
    |
102 |             # Essential external service URLs
103 |             if not self.database.DATABASE_URL:
104 |                 raise ValueError("DATABASE_URL must be set in production.")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
105 |             if not self.redis.REDIS_URL:
106 |                 raise ValueError("REDIS_URL must be set in production.")
    |

src/infrastructure/config/settings.py:106:23: TRY003 Avoid specifying long messages outside the exception class
    |
104 |                 raise ValueError("DATABASE_URL must be set in production.")
105 |             if not self.redis.REDIS_URL:
106 |                 raise ValueError("REDIS_URL must be set in production.")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
107 |             if not self.ai.OPENAI_API_KEY or not self.ai.OPENAI_API_KEY.startswith(
108 |                 "sk-",
    |

src/infrastructure/config/settings.py:110:23: TRY003 Avoid specifying long messages outside the exception class
    |
108 |                   "sk-",
109 |               ):
110 |                   raise ValueError(
    |  _______________________^
111 | |                     "OPENAI_API_KEY must be a valid OpenAI API key in production.",
112 | |                 )
    | |_________________^ TRY003
113 |
114 |               # Sentry DSN for error monitoring
    |

src/infrastructure/config/settings.py:117:89: E501 Line too long (93 > 88)
    |
115 |             if not self.sentry.SENTRY_DSN:
116 |                 logger.warning(
117 |                     "SENTRY_DSN is not set in production. Error monitoring will be limited.",
    |                                                                                         ^^^^^ E501
118 |                 )
    |

src/infrastructure/config/settings.py:124:19: TRY003 Avoid specifying long messages outside the exception class
    |
122 |               self.security.REFRESH_TOKEN_EXPIRE_DAYS * 24 * 60
123 |           ):
124 |               raise ValueError(
    |  ___________________^
125 | |                 "ACCESS_TOKEN_EXPIRE_MINUTES cannot exceed REFRESH_TOKEN_EXPIRE_DAYS.",
126 | |             )
    | |_____________^ TRY003
127 |
128 |           logger.info(f"Configuration validated for environment: {env}")
    |

src/infrastructure/config/startup_validator.py:18:89: E501 Line too long (89 > 88)
   |
17 | class StartupValidator:
18 |     """Validates that all critical dependencies and configuration are properly set up."""
   |                                                                                         ^ E501
19 |
20 |     def __init__(
   |

src/infrastructure/config/startup_validator.py:22:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
20 |     def __init__(
21 |         self,
22 |         settings: Settings = Depends(Settings),
   |                              ^^^^^^^^^^^^^^^^^ B008
23 |     ) -> None:
24 |         self.errors: list[str] = []
   |

src/infrastructure/config/startup_validator.py:29:89: E501 Line too long (90 > 88)
   |
28 |     def validate_dependencies(self) -> bool:
29 |         """Validate that all required dependencies are installed using modern metadata."""
   |                                                                                         ^^ E501
30 |         logger.info("🔍 Validating critical dependencies...")
31 |         required_packages = [
   |

src/infrastructure/config/startup_validator.py:52:17: TRY400 Use `logging.exception` instead of `logging.error`
   |
50 |                 )
51 |                 self.errors.append(error_msg)
52 |                 logger.error(error_msg)
   |                 ^^^^^^^^^^^^^^^^^^^^^^^ TRY400
53 |         return len(self.errors) == 0
   |
   = help: Replace with `exception`

src/infrastructure/config/startup_validator.py:55:9: PLR0912 Too many branches (16 > 12)
   |
53 |         return len(self.errors) == 0
54 |
55 |     def validate_environment(self) -> bool:
   |         ^^^^^^^^^^^^^^^^^^^^ PLR0912
56 |         """Validate environment configuration."""
57 |         logger.info("🔍 Validating environment configuration...")
   |

src/infrastructure/config/startup_validator.py:59:89: E501 Line too long (100 > 88)
   |
57 |         logger.info("🔍 Validating environment configuration...")
58 |         # Access settings directly from the injected settings object
59 |         # This assumes that the settings object has already loaded values from environment variables
   |                                                                                         ^^^^^^^^^^^^ E501
60 |         # and performed basic Pydantic validation.
61 |         # Check for critical settings presence
   |

src/infrastructure/config/startup_validator.py:64:55: PLR2004 Magic value used in comparison, consider replacing `32` with a constant variable
   |
62 |         if not self.settings.security.SECRET_KEY:
63 |             self._add_error("❌ SECRET_KEY is required but not set")
64 |         elif len(self.settings.security.SECRET_KEY) < 32:
   |                                                       ^^ PLR2004
65 |             self._add_error("❌ SECRET_KEY must be at least 32 characters long")
66 |         else:
   |

src/infrastructure/config/startup_validator.py:70:59: PLR2004 Magic value used in comparison, consider replacing `32` with a constant variable
   |
68 |         if not self.settings.security.JWT_SECRET_KEY:
69 |             self._add_error("❌ JWT_SECRET_KEY is required but not set")
70 |         elif len(self.settings.security.JWT_SECRET_KEY) < 32:
   |                                                           ^^ PLR2004
71 |             self._add_error("❌ JWT_SECRET_KEY must be at least 32 characters long")
72 |         else:
   |

src/infrastructure/config/startup_validator.py:92:66: PLR2004 Magic value used in comparison, consider replacing `44` with a constant variable
   |
90 |         if not self.settings.security.COPPA_ENCRYPTION_KEY:
91 |             self._add_error("❌ COPPA_ENCRYPTION_KEY is required but not set")
92 |         elif len(self.settings.security.COPPA_ENCRYPTION_KEY) != 44:
   |                                                                  ^^ PLR2004
93 |             self._add_error(
94 |                 "❌ COPPA_ENCRYPTION_KEY must be a valid Fernet key (44 characters)",
   |

src/infrastructure/config/startup_validator.py:127:89: E501 Line too long (98 > 88)
    |
126 |     async def _validate_database_connection_robust(self) -> bool:
127 |         """Validates the database connection with proper error handling, timeouts, and retries."""
    |                                                                                         ^^^^^^^^^^ E501
128 |         logger.info("🔍 Validating database connection...")
129 |         if not self.settings.DATABASE_URL:
    |

src/infrastructure/config/startup_validator.py:140:13: TRY300 Consider moving this statement to an `else` block
    |
138 |                 return False
139 |             logger.info("✅ Database connection is healthy.")
140 |             return True
    |             ^^^^^^^^^^^ TRY300
141 |         except Exception as e:
142 |             self._add_error(
    |

src/infrastructure/config/startup_validator.py:195:5: D205 1 blank line required between summary line and description
    |
194 |   async def validate_startup(validator: "StartupValidator") -> bool:
195 | /     """Asynchronous startup validation function.
196 | |     Runs the provided validator, raising a critical error if validation fails.
197 | |     """
    | |_______^ D205
198 |       try:
199 |           is_valid = await validator.validate_all()
    |
    = help: Insert single blank line

src/infrastructure/config/startup_validator.py:202:13: TRY301 Abstract `raise` to an inner function
    |
200 |           if not is_valid:
201 |               # Errors are already logged by the validator
202 | /             raise RuntimeError(
203 | |                 "Startup validation failed. Check logs for critical errors.",
204 | |             )
    | |_____________^ TRY301
205 |           return True
206 |       except Exception as e:
    |

src/infrastructure/config/startup_validator.py:202:19: TRY003 Avoid specifying long messages outside the exception class
    |
200 |           if not is_valid:
201 |               # Errors are already logged by the validator
202 |               raise RuntimeError(
    |  ___________________^
203 | |                 "Startup validation failed. Check logs for critical errors.",
204 | |             )
    | |_____________^ TRY003
205 |           return True
206 |       except Exception as e:
    |

src/infrastructure/config/startup_validator.py:205:9: TRY300 Consider moving this statement to an `else` block
    |
203 |                 "Startup validation failed. Check logs for critical errors.",
204 |             )
205 |         return True
    |         ^^^^^^^^^^^ TRY300
206 |     except Exception as e:
207 |         logger.critical(
    |

src/infrastructure/config/startup_validator.py:212:15: TRY003 Avoid specifying long messages outside the exception class
    |
210 |         )
211 |         # Re-raise to ensure the application startup is halted
212 |         raise RuntimeError("Critical startup validation failed") from e
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
    |

src/infrastructure/config/startup_validator.py:225:89: E501 Line too long (98 > 88)
    |
223 |         # The following line is for demonstration and may need adjustment.
224 |         # The original code had container.wire(modules=[__name__]) which is removed.
225 |         # If you need to wire dependencies for direct script execution, you'll need to do it here.
    |                                                                                         ^^^^^^^^^^ E501
226 |         # For now, we'll just run the validation directly.
227 |         try:
    |

src/infrastructure/config/startup_validator.py:228:89: E501 Line too long (90 > 88)
    |
226 |         # For now, we'll just run the validation directly.
227 |         try:
228 |             # Assuming Settings is available directly or needs to be imported/instantiated
    |                                                                                         ^^ E501
229 |             # For direct script execution, you might need a mock or simplified setup.
230 |             # The following line is for demonstration and may need adjustment.
    |

src/infrastructure/config/startup_validator.py:231:13: ERA001 Found commented-out code
    |
229 |             # For direct script execution, you might need a mock or simplified setup.
230 |             # The following line is for demonstration and may need adjustment.
231 |             # settings = Settings() # Uncomment and adjust if Settings needs to be instantiated here
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ ERA001
232 |             # validator = StartupValidator(settings=settings) # Uncomment and
233 |             # adjust if Settings needs to be passed to validator
    |
    = help: Remove commented-out code

src/infrastructure/config/startup_validator.py:231:89: E501 Line too long (100 > 88)
    |
229 |             # For direct script execution, you might need a mock or simplified setup.
230 |             # The following line is for demonstration and may need adjustment.
231 |             # settings = Settings() # Uncomment and adjust if Settings needs to be instantiated here
    |                                                                                         ^^^^^^^^^^^^ E501
232 |             # validator = StartupValidator(settings=settings) # Uncomment and
233 |             # adjust if Settings needs to be passed to validator
    |

src/infrastructure/config/startup_validator.py:232:13: ERA001 Found commented-out code
    |
230 |             # The following line is for demonstration and may need adjustment.
231 |             # settings = Settings() # Uncomment and adjust if Settings needs to be instantiated here
232 |             # validator = StartupValidator(settings=settings) # Uncomment and
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ ERA001
233 |             # adjust if Settings needs to be passed to validator
234 |             validator = (
    |
    = help: Remove commented-out code

src/infrastructure/config/startup_validator.py:240:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
238 |             logger.info("Direct validation check passed.")
239 |         except RuntimeError as e:
240 |             logger.error(f"Direct validation check failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
241 |
242 |     asyncio.run(main())
    |
    = help: Replace with `exception`

src/infrastructure/config/validators.py:18:23: TRY003 Avoid specifying long messages outside the exception class
   |
16 |             env = os.getenv("ENVIRONMENT")
17 |             if env == "production":
18 |                 raise ValueError("SECRET_KEY must be set in production")
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
19 |             # Generate secure key for dev only
20 |             v = secrets.token_urlsafe(32)
   |

src/infrastructure/config/validators.py:21:21: PLR2004 Magic value used in comparison, consider replacing `32` with a constant variable
   |
19 |             # Generate secure key for dev only
20 |             v = secrets.token_urlsafe(32)
21 |         if len(v) < 32:
   |                     ^^ PLR2004
22 |             raise ValueError("SECRET_KEY must be at least 32 characters")
23 |         insecure_values = {"secret", "password", "changeme", "default", "dev"}
   |

src/infrastructure/config/validators.py:22:19: TRY003 Avoid specifying long messages outside the exception class
   |
20 |             v = secrets.token_urlsafe(32)
21 |         if len(v) < 32:
22 |             raise ValueError("SECRET_KEY must be at least 32 characters")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
23 |         insecure_values = {"secret", "password", "changeme", "default", "dev"}
24 |         if v.lower() in insecure_values:
   |

src/infrastructure/config/validators.py:25:19: TRY003 Avoid specifying long messages outside the exception class
   |
23 |         insecure_values = {"secret", "password", "changeme", "default", "dev"}
24 |         if v.lower() in insecure_values:
25 |             raise ValueError("SECRET_KEY cannot be a common/insecure value")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
26 |         return v
   |

src/infrastructure/config/validators.py:33:19: TRY003 Avoid specifying long messages outside the exception class
   |
31 |         """Ensure PostgreSQL in production."""
32 |         if os.getenv("ENVIRONMENT") == "production" and not v.startswith("postgresql"):
33 |             raise ValueError("PostgreSQL is required for production environments.")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
34 |         weak_patterns = [
35 |             "user:password",
   |

src/infrastructure/config/validators.py:57:23: TRY003 Avoid specifying long messages outside the exception class
   |
55 |               )
56 |               if os.getenv("ENVIRONMENT") == "production":
57 |                   raise ValueError(
   |  _______________________^
58 | |                     "Production environment cannot use default/weak credentials in DATABASE_URL",
59 | |                 )
   | |_________________^ TRY003
60 |           return v
   |

src/infrastructure/config/validators.py:58:89: E501 Line too long (97 > 88)
   |
56 |             if os.getenv("ENVIRONMENT") == "production":
57 |                 raise ValueError(
58 |                     "Production environment cannot use default/weak credentials in DATABASE_URL",
   |                                                                                         ^^^^^^^^^ E501
59 |                 )
60 |         return v
   |

src/infrastructure/dependencies.py:12:9: N802 Function name `Depends` should be lowercase
   |
10 | except ImportError:
11 |     # Mock FastAPI Depends when not available
12 |     def Depends(*args, **kwargs):
   |         ^^^^^^^ N802
13 |         return lambda func: func
   |

src/infrastructure/dependencies.py:12:18: ARG001 Unused function argument: `args`
   |
10 | except ImportError:
11 |     # Mock FastAPI Depends when not available
12 |     def Depends(*args, **kwargs):
   |                  ^^^^ ARG001
13 |         return lambda func: func
   |

src/infrastructure/dependencies.py:12:26: ARG001 Unused function argument: `kwargs`
   |
10 | except ImportError:
11 |     # Mock FastAPI Depends when not available
12 |     def Depends(*args, **kwargs):
   |                          ^^^^^^ ARG001
13 |         return lambda func: func
   |

src/infrastructure/dependencies.py:28:31: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
27 | def get_child_repository(
28 |     event_store: EventStore = Depends(get_event_store),
   |                               ^^^^^^^^^^^^^^^^^^^^^^^^ B008
29 | ) -> "ChildRepository":
30 |     return EventSourcedChildRepository(event_store)
   |

src/infrastructure/dependencies.py:72:42: ARG002 Unused method argument: `child_id`
   |
70 |         }
71 |
72 |     async def delete_child_profile(self, child_id: str) -> bool:
   |                                          ^^^^^^^^ ARG002
73 |         return True
   |

src/infrastructure/dependencies.py:79:36: ARG002 Unused method argument: `child_id`
   |
77 |     """Mock generate dynamic story use case."""
78 |
79 |     async def generate_story(self, child_id: str, prompt: str) -> dict[str, Any]:
   |                                    ^^^^^^^^ ARG002
80 |         return {
81 |             "story_id": "story-123",
   |

src/infrastructure/di/application_container.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Application Container - Professional DI Implementation
2 | | Following SOLID principles and Clean Architecture patterns.
3 | | """
  | |___^ D205
4 |   from typing import TypeVar, Type, Dict, Any, Optional, Protocol
5 |   from abc import ABC, abstractmethod
  |
  = help: Insert single blank line

src/infrastructure/di/application_container.py:4:1: UP035 `typing.Type` is deprecated, use `type` instead
  |
2 | Following SOLID principles and Clean Architecture patterns.
3 | """
4 | from typing import TypeVar, Type, Dict, Any, Optional, Protocol
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
5 | from abc import ABC, abstractmethod
6 | import threading
  |

src/infrastructure/di/application_container.py:4:1: UP035 `typing.Dict` is deprecated, use `dict` instead
  |
2 | Following SOLID principles and Clean Architecture patterns.
3 | """
4 | from typing import TypeVar, Type, Dict, Any, Optional, Protocol
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
5 | from abc import ABC, abstractmethod
6 | import threading
  |

src/infrastructure/di/application_container.py:4:1: I001 [*] Import block is un-sorted or un-formatted
   |
 2 |   Following SOLID principles and Clean Architecture patterns.
 3 |   """
 4 | / from typing import TypeVar, Type, Dict, Any, Optional, Protocol
 5 | | from abc import ABC, abstractmethod
 6 | | import threading
 7 | | from functools import lru_cache
 8 | |
 9 | | from src.infrastructure.config.settings import Settings, get_settings
10 | | from src.infrastructure import dependencies
11 | | from src.infrastructure.config.startup_validator import StartupValidator
12 | | from src.infrastructure.logging_config import get_logger
   | |________________________________________________________^ I001
13 |
14 |   logger = get_logger(__name__)
   |
   = help: Organize imports

src/infrastructure/di/application_container.py:5:17: F401 [*] `abc.ABC` imported but unused
  |
3 | """
4 | from typing import TypeVar, Type, Dict, Any, Optional, Protocol
5 | from abc import ABC, abstractmethod
  |                 ^^^ F401
6 | import threading
7 | from functools import lru_cache
  |
  = help: Remove unused import

src/infrastructure/di/application_container.py:5:22: F401 [*] `abc.abstractmethod` imported but unused
  |
3 | """
4 | from typing import TypeVar, Type, Dict, Any, Optional, Protocol
5 | from abc import ABC, abstractmethod
  |                      ^^^^^^^^^^^^^^ F401
6 | import threading
7 | from functools import lru_cache
  |
  = help: Remove unused import

src/infrastructure/di/application_container.py:20:1: W293 [*] Blank line contains whitespace
   |
18 | class IContainer(Protocol):
19 |     """Container interface following Interface Segregation Principle."""
20 |     
   | ^^^^ W293
21 |     def register(self, interface: Type[T], factory: Any) -> None:
22 |         """Register a service factory."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:21:35: UP006 [*] Use `type` instead of `Type` for type annotation
   |
19 |     """Container interface following Interface Segregation Principle."""
20 |     
21 |     def register(self, interface: Type[T], factory: Any) -> None:
   |                                   ^^^^ UP006
22 |         """Register a service factory."""
23 |         ...
   |
   = help: Replace with `type`

src/infrastructure/di/application_container.py:24:1: W293 [*] Blank line contains whitespace
   |
22 |         """Register a service factory."""
23 |         ...
24 |     
   | ^^^^ W293
25 |     def resolve(self, interface: Type[T]) -> T:
26 |         """Resolve a service instance."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:25:34: UP006 [*] Use `type` instead of `Type` for type annotation
   |
23 |         ...
24 |     
25 |     def resolve(self, interface: Type[T]) -> T:
   |                                  ^^^^ UP006
26 |         """Resolve a service instance."""
27 |         ...
   |
   = help: Replace with `type`

src/infrastructure/di/application_container.py:28:1: W293 [*] Blank line contains whitespace
   |
26 |         """Resolve a service instance."""
27 |         ...
28 |     
   | ^^^^ W293
29 |     def wire(self, modules: list[str]) -> None:
30 |         """Wire dependencies for specified modules."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:35:1: W293 [*] Blank line contains whitespace
   |
33 | class ServiceRegistry:
34 |     """Thread-safe service registry."""
35 |     
   | ^^^^ W293
36 |     def __init__(self):
37 |         self._factories: Dict[Type, Any] = {}
   |
   = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:37:26: UP006 [*] Use `dict` instead of `Dict` for type annotation
   |
36 |     def __init__(self):
37 |         self._factories: Dict[Type, Any] = {}
   |                          ^^^^ UP006
38 |         self._instances: Dict[Type, Any] = {}
39 |         self._lock = threading.RLock()
   |
   = help: Replace with `dict`

src/infrastructure/di/application_container.py:37:31: UP006 [*] Use `type` instead of `Type` for type annotation
   |
36 |     def __init__(self):
37 |         self._factories: Dict[Type, Any] = {}
   |                               ^^^^ UP006
38 |         self._instances: Dict[Type, Any] = {}
39 |         self._lock = threading.RLock()
   |
   = help: Replace with `type`

src/infrastructure/di/application_container.py:38:26: UP006 [*] Use `dict` instead of `Dict` for type annotation
   |
36 |     def __init__(self):
37 |         self._factories: Dict[Type, Any] = {}
38 |         self._instances: Dict[Type, Any] = {}
   |                          ^^^^ UP006
39 |         self._lock = threading.RLock()
   |
   = help: Replace with `dict`

src/infrastructure/di/application_container.py:38:31: UP006 [*] Use `type` instead of `Type` for type annotation
   |
36 |     def __init__(self):
37 |         self._factories: Dict[Type, Any] = {}
38 |         self._instances: Dict[Type, Any] = {}
   |                               ^^^^ UP006
39 |         self._lock = threading.RLock()
   |
   = help: Replace with `type`

src/infrastructure/di/application_container.py:40:1: W293 [*] Blank line contains whitespace
   |
38 |         self._instances: Dict[Type, Any] = {}
39 |         self._lock = threading.RLock()
40 |     
   | ^^^^ W293
41 |     def register_factory(self, interface: Type[T], factory: Any) -> None:
42 |         """Register a factory for an interface."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:41:43: UP006 [*] Use `type` instead of `Type` for type annotation
   |
39 |         self._lock = threading.RLock()
40 |     
41 |     def register_factory(self, interface: Type[T], factory: Any) -> None:
   |                                           ^^^^ UP006
42 |         """Register a factory for an interface."""
43 |         with self._lock:
   |
   = help: Replace with `type`

src/infrastructure/di/application_container.py:45:89: E501 Line too long (117 > 88)
   |
43 |         with self._lock:
44 |             self._factories[interface] = factory
45 |             logger.debug(f"Registered factory for {interface if isinstance(interface, str) else interface.__name__}")
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
46 |     
47 |     def register_singleton(self, interface: Type[T], instance: T) -> None:
   |

src/infrastructure/di/application_container.py:46:1: W293 [*] Blank line contains whitespace
   |
44 |             self._factories[interface] = factory
45 |             logger.debug(f"Registered factory for {interface if isinstance(interface, str) else interface.__name__}")
46 |     
   | ^^^^ W293
47 |     def register_singleton(self, interface: Type[T], instance: T) -> None:
48 |         """Register a singleton instance."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:47:45: UP006 [*] Use `type` instead of `Type` for type annotation
   |
45 |             logger.debug(f"Registered factory for {interface if isinstance(interface, str) else interface.__name__}")
46 |     
47 |     def register_singleton(self, interface: Type[T], instance: T) -> None:
   |                                             ^^^^ UP006
48 |         """Register a singleton instance."""
49 |         with self._lock:
   |
   = help: Replace with `type`

src/infrastructure/di/application_container.py:52:1: W293 [*] Blank line contains whitespace
   |
50 |             self._instances[interface] = instance
51 |             logger.debug(f"Registered singleton for {interface.__name__}")
52 |     
   | ^^^^ W293
53 |     def resolve(self, interface: Type[T]) -> T:
54 |         """Resolve a service, creating if necessary."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:53:34: UP006 [*] Use `type` instead of `Type` for type annotation
   |
51 |             logger.debug(f"Registered singleton for {interface.__name__}")
52 |     
53 |     def resolve(self, interface: Type[T]) -> T:
   |                                  ^^^^ UP006
54 |         """Resolve a service, creating if necessary."""
55 |         with self._lock:
   |
   = help: Replace with `type`

src/infrastructure/di/application_container.py:59:1: W293 [*] Blank line contains whitespace
   |
57 |             if interface in self._instances:
58 |                 return self._instances[interface]
59 |             
   | ^^^^^^^^^^^^ W293
60 |             # Check for factory
61 |             if interface in self._factories:
   |
   = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:65:1: W293 [*] Blank line contains whitespace
   |
63 |                 self._instances[interface] = instance
64 |                 return instance
65 |             
   | ^^^^^^^^^^^^ W293
66 |             raise ValueError(f"No registration found for {interface.__name__}")
   |
   = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:66:19: TRY003 Avoid specifying long messages outside the exception class
   |
64 |                 return instance
65 |             
66 |             raise ValueError(f"No registration found for {interface.__name__}")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
67 |     
68 |     def clear(self) -> None:
   |

src/infrastructure/di/application_container.py:67:1: W293 [*] Blank line contains whitespace
   |
66 |             raise ValueError(f"No registration found for {interface.__name__}")
67 |     
   | ^^^^ W293
68 |     def clear(self) -> None:
69 |         """Clear all registrations."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:76:1: W293 [*] Blank line contains whitespace
   |
74 | class ApplicationContainer(IContainer):
75 |     """Main application container with professional DI implementation."""
76 |     
   | ^^^^ W293
77 |     _instance: Optional['ApplicationContainer'] = None
78 |     _lock = threading.Lock()
   |
   = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:79:1: W293 [*] Blank line contains whitespace
   |
77 |     _instance: Optional['ApplicationContainer'] = None
78 |     _lock = threading.Lock()
79 |     
   | ^^^^ W293
80 |     def __new__(cls):
81 |         """Singleton pattern implementation."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:87:1: W293 [*] Blank line contains whitespace
   |
85 |                     cls._instance = super().__new__(cls)
86 |         return cls._instance
87 |     
   | ^^^^ W293
88 |     def __init__(self):
89 |         """Initialize container with service registry."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:92:29: UP045 [*] Use `X | None` for type annotations
   |
90 |         if not hasattr(self, '_initialized'):
91 |             self._registry = ServiceRegistry()
92 |             self._settings: Optional[Settings] = None
   |                             ^^^^^^^^^^^^^^^^^^ UP045
93 |             self._wired_modules: set[str] = set()
94 |             self._initialized = True
   |
   = help: Convert to `X | None`

src/infrastructure/di/application_container.py:96:1: W293 [*] Blank line contains whitespace
   |
94 |             self._initialized = True
95 |             self._setup_core_services()
96 |     
   | ^^^^ W293
97 |     def _setup_core_services(self) -> None:
98 |         """Register core application services."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:104:1: W293 [*] Blank line contains whitespace
    |
102 |             lambda: self.settings()
103 |         )
104 |         
    | ^^^^^^^^ W293
105 |         # Startup Validator
106 |         self._registry.register_factory(
    |
    = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:110:1: W293 [*] Blank line contains whitespace
    |
108 |             self._create_startup_validator
109 |         )
110 |         
    | ^^^^^^^^ W293
111 |         # Application Use Cases
112 |         self._registry.register_factory(
    |
    = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:117:1: W293 [*] Blank line contains whitespace
    |
115 |         )
116 |         logger.info("Core services registered")
117 |     
    | ^^^^ W293
118 |     def _create_startup_validator(self) -> StartupValidator:
119 |         """Factory method for creating StartupValidator."""
    |
    = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:123:1: W293 [*] Blank line contains whitespace
    |
121 |         # For manual instantiation, we pass it directly
122 |         return StartupValidator(settings=self.settings())
123 |     
    | ^^^^ W293
124 |     @lru_cache(maxsize=1)
125 |     def settings(self) -> Settings:
    |
    = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:124:5: B019 Use of `functools.lru_cache` or `functools.cache` on methods can lead to memory leaks
    |
122 |         return StartupValidator(settings=self.settings())
123 |     
124 |     @lru_cache(maxsize=1)
    |     ^^^^^^^^^^^^^^^^^^^^^ B019
125 |     def settings(self) -> Settings:
126 |         """Get or create settings instance."""
    |

src/infrastructure/di/application_container.py:130:1: W293 [*] Blank line contains whitespace
    |
128 |             self._settings = get_settings()
129 |         return self._settings
130 |     
    | ^^^^ W293
131 |     def startup_validator(self) -> StartupValidator:
132 |         """Get startup validator instance."""
    |
    = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:134:1: W293 [*] Blank line contains whitespace
    |
132 |         """Get startup validator instance."""
133 |         return self._registry.resolve(StartupValidator)
134 |     
    | ^^^^ W293
135 |     def register(self, interface: Type[T], factory: Any) -> None:
136 |         """Register a service factory."""
    |
    = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:135:35: UP006 [*] Use `type` instead of `Type` for type annotation
    |
133 |         return self._registry.resolve(StartupValidator)
134 |     
135 |     def register(self, interface: Type[T], factory: Any) -> None:
    |                                   ^^^^ UP006
136 |         """Register a service factory."""
137 |         self._registry.register_factory(interface, factory)
    |
    = help: Replace with `type`

src/infrastructure/di/application_container.py:138:1: W293 [*] Blank line contains whitespace
    |
136 |         """Register a service factory."""
137 |         self._registry.register_factory(interface, factory)
138 |     
    | ^^^^ W293
139 |     def resolve(self, interface: Type[T]) -> T:
140 |         """Resolve a service instance."""
    |
    = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:139:34: UP006 [*] Use `type` instead of `Type` for type annotation
    |
137 |         self._registry.register_factory(interface, factory)
138 |     
139 |     def resolve(self, interface: Type[T]) -> T:
    |                                  ^^^^ UP006
140 |         """Resolve a service instance."""
141 |         return self._registry.resolve(interface)
    |
    = help: Replace with `type`

src/infrastructure/di/application_container.py:142:1: W293 [*] Blank line contains whitespace
    |
140 |         """Resolve a service instance."""
141 |         return self._registry.resolve(interface)
142 |     
    | ^^^^ W293
143 |     def wire(self, modules: list[str]) -> None:
144 |         """Wire dependencies for specified modules."""
    |
    = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:151:1: W293 [*] Blank line contains whitespace
    |
149 |                 # Actual wiring implementation would go here
150 |                 # For now, just log it
151 |         
    | ^^^^^^^^ W293
152 |         logger.info(f"Wired {len(modules)} modules")
    |
    = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:153:1: W293 [*] Blank line contains whitespace
    |
152 |         logger.info(f"Wired {len(modules)} modules")
153 |     
    | ^^^^ W293
154 |     def reset(self) -> None:
155 |         """Reset container state (useful for testing)."""
    |
    = help: Remove whitespace from blank line

src/infrastructure/di/application_container.py:169:5: UP047 Generic function `register_service` should use type parameters
    |
167 |     return container
168 |
169 | def register_service(interface: Type[T], factory: Any) -> None:
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP047
170 |     """Register a service in the global container."""
171 |     container.register(interface, factory)
    |
    = help: Use type parameters

src/infrastructure/di/application_container.py:169:33: UP006 [*] Use `type` instead of `Type` for type annotation
    |
167 |     return container
168 |
169 | def register_service(interface: Type[T], factory: Any) -> None:
    |                                 ^^^^ UP006
170 |     """Register a service in the global container."""
171 |     container.register(interface, factory)
    |
    = help: Replace with `type`

src/infrastructure/di/application_container.py:173:5: UP047 Generic function `resolve_service` should use type parameters
    |
171 |     container.register(interface, factory)
172 |
173 | def resolve_service(interface: Type[T]) -> T:
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP047
174 |     """Resolve a service from the global container."""
175 |     return container.resolve(interface)
    |
    = help: Use type parameters

src/infrastructure/di/application_container.py:173:32: UP006 [*] Use `type` instead of `Type` for type annotation
    |
171 |     container.register(interface, factory)
172 |
173 | def resolve_service(interface: Type[T]) -> T:
    |                                ^^^^ UP006
174 |     """Resolve a service from the global container."""
175 |     return container.resolve(interface)
    |
    = help: Replace with `type`

src/infrastructure/di/container.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """DI Container - Facade for the new ApplicationContainer.
2 | | Maintains backward compatibility while using the new implementation.
3 | | """
  | |___^ D205
4 |   from src.infrastructure.di.application_container import (
5 |       ApplicationContainer,
  |
  = help: Insert single blank line

src/infrastructure/di/container.py:4:1: I001 [*] Import block is un-sorted or un-formatted
   |
 2 |   Maintains backward compatibility while using the new implementation.
 3 |   """
 4 | / from src.infrastructure.di.application_container import (
 5 | |     ApplicationContainer,
 6 | |     get_container,
 7 | |     register_service,
 8 | |     resolve_service
 9 | | )
   | |_^ I001
10 |
11 |   # Re-export the main container
   |
   = help: Organize imports

src/infrastructure/di/container.py:23:11: RUF022 [*] `__all__` is not sorted
   |
22 |   # Re-export all necessary items
23 |   __all__ = [
   |  ___________^
24 | |     'container',
25 | |     'ProfessionalContainer',
26 | |     'ServiceLifetime',
27 | |     'register_service',
28 | |     'resolve_service'
29 | | ]
   | |_^ RUF022
30 |
31 |   # Legacy service registration
   |
   = help: Apply an isort-style sorting to `__all__`

src/infrastructure/di/container.py:34:5: PLC0415 `import` should be at the top-level of a file
   |
32 |   def register_legacy_services():
33 |       """Register legacy services for backward compatibility."""
34 | /     from src.infrastructure.security.coppa_validator import (
35 | |         COPPAValidator,
36 | |         coppa_validator,
37 | |         is_coppa_subject,
38 | |         requires_parental_consent
39 | |     )
   | |_____^ PLC0415
40 |       
41 |       # Register as factory
   |

src/infrastructure/di/container.py:34:5: I001 [*] Import block is un-sorted or un-formatted
   |
32 |   def register_legacy_services():
33 |       """Register legacy services for backward compatibility."""
34 | /     from src.infrastructure.security.coppa_validator import (
35 | |         COPPAValidator,
36 | |         coppa_validator,
37 | |         is_coppa_subject,
38 | |         requires_parental_consent
39 | |     )
   | |_____^ I001
40 |       
41 |       # Register as factory
   |
   = help: Organize imports

src/infrastructure/di/container.py:35:9: F811 [*] Redefinition of unused `COPPAValidator` from line 55
   |
33 |     """Register legacy services for backward compatibility."""
34 |     from src.infrastructure.security.coppa_validator import (
35 |         COPPAValidator,
   |         ^^^^^^^^^^^^^^ F811
36 |         coppa_validator,
37 |         is_coppa_subject,
   |
   = help: Remove definition: `COPPAValidator`

src/infrastructure/di/container.py:36:9: F401 [*] `src.infrastructure.security.coppa_validator.coppa_validator` imported but unused
   |
34 |     from src.infrastructure.security.coppa_validator import (
35 |         COPPAValidator,
36 |         coppa_validator,
   |         ^^^^^^^^^^^^^^^ F401
37 |         is_coppa_subject,
38 |         requires_parental_consent
   |
   = help: Remove unused import

src/infrastructure/di/container.py:37:9: F401 [*] `src.infrastructure.security.coppa_validator.is_coppa_subject` imported but unused
   |
35 |         COPPAValidator,
36 |         coppa_validator,
37 |         is_coppa_subject,
   |         ^^^^^^^^^^^^^^^^ F401
38 |         requires_parental_consent
39 |     )
   |
   = help: Remove unused import

src/infrastructure/di/container.py:38:9: F401 [*] `src.infrastructure.security.coppa_validator.requires_parental_consent` imported but unused
   |
36 |         coppa_validator,
37 |         is_coppa_subject,
38 |         requires_parental_consent
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^ F401
39 |     )
   |
   = help: Remove unused import

src/infrastructure/di/container.py:40:1: W293 [*] Blank line contains whitespace
   |
38 |         requires_parental_consent
39 |     )
40 |     
   | ^^^^ W293
41 |     # Register as factory
42 |     register_service(
   |
   = help: Remove whitespace from blank line

src/infrastructure/di/container.py:46:1: W293 [*] Blank line contains whitespace
   |
44 |         lambda: COPPAValidator()
45 |     )
46 |     
   | ^^^^ W293
47 | # Auto-register legacy services on import
48 | register_legacy_services()
   |
   = help: Remove whitespace from blank line

src/infrastructure/di/container.py:53:1: E402 Module level import not at top of file
   |
52 | # Add required service attributes
53 | from src.infrastructure import dependencies
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
54 | from src.infrastructure.pagination import PaginationService
55 | from src.infrastructure.security.coppa_validator import COPPAValidator
   |

src/infrastructure/di/container.py:53:1: I001 [*] Import block is un-sorted or un-formatted
   |
52 |   # Add required service attributes
53 | / from src.infrastructure import dependencies
54 | | from src.infrastructure.pagination import PaginationService
55 | | from src.infrastructure.security.coppa_validator import COPPAValidator
56 | | from src.application.services.coppa.coppa_compliance_service import COPPAComplianceService
   | |__________________________________________________________________________________________^ I001
57 |
58 |   # Register services as attributes
   |
   = help: Organize imports

src/infrastructure/di/container.py:54:1: E402 Module level import not at top of file
   |
52 | # Add required service attributes
53 | from src.infrastructure import dependencies
54 | from src.infrastructure.pagination import PaginationService
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
55 | from src.infrastructure.security.coppa_validator import COPPAValidator
56 | from src.application.services.coppa.coppa_compliance_service import COPPAComplianceService
   |

src/infrastructure/di/container.py:55:1: E402 Module level import not at top of file
   |
53 | from src.infrastructure import dependencies
54 | from src.infrastructure.pagination import PaginationService
55 | from src.infrastructure.security.coppa_validator import COPPAValidator
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
56 | from src.application.services.coppa.coppa_compliance_service import COPPAComplianceService
   |

src/infrastructure/di/container.py:55:57: F401 [*] `src.infrastructure.security.coppa_validator.COPPAValidator` imported but unused
   |
53 | from src.infrastructure import dependencies
54 | from src.infrastructure.pagination import PaginationService
55 | from src.infrastructure.security.coppa_validator import COPPAValidator
   |                                                         ^^^^^^^^^^^^^^ F401
56 | from src.application.services.coppa.coppa_compliance_service import COPPAComplianceService
   |
   = help: Remove unused import: `src.infrastructure.security.coppa_validator.COPPAValidator`

src/infrastructure/di/container.py:56:1: E402 Module level import not at top of file
   |
54 | from src.infrastructure.pagination import PaginationService
55 | from src.infrastructure.security.coppa_validator import COPPAValidator
56 | from src.application.services.coppa.coppa_compliance_service import COPPAComplianceService
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
57 |
58 | # Register services as attributes
   |

src/infrastructure/di/container.py:56:89: E501 Line too long (90 > 88)
   |
54 | from src.infrastructure.pagination import PaginationService
55 | from src.infrastructure.security.coppa_validator import COPPAValidator
56 | from src.application.services.coppa.coppa_compliance_service import COPPAComplianceService
   |                                                                                         ^^ E501
57 |
58 | # Register services as attributes
   |

src/infrastructure/di/di_components/__init__.py:6:67: W291 Trailing whitespace
  |
4 | including wiring configurations and service factories.
5 |
6 | Note: APIWiringConfig, DashboardWiringConfig, and CoreWiringConfig 
  |                                                                   ^ W291
7 | were removed as part of architectural simplification. The project 
8 | now uses FullWiringConfig directly.
  |
  = help: Remove trailing whitespace

src/infrastructure/di/di_components/__init__.py:7:66: W291 Trailing whitespace
  |
6 | Note: APIWiringConfig, DashboardWiringConfig, and CoreWiringConfig 
7 | were removed as part of architectural simplification. The project 
  |                                                                  ^ W291
8 | now uses FullWiringConfig directly.
9 | """
  |
  = help: Remove trailing whitespace

src/infrastructure/di/di_components/__init__.py:11:1: I001 [*] Import block is un-sorted or un-formatted
   |
 9 |   """
10 |
11 | / from .wiring_config import (
12 | |     WiringConfig,
13 | |     FullWiringConfig,
14 | | )
   | |_^ I001
15 |
16 |   __all__ = [
   |
   = help: Organize imports

src/infrastructure/di/di_components/__init__.py:16:11: RUF022 [*] `__all__` is not sorted
   |
14 |   )
15 |
16 |   __all__ = [
   |  ___________^
17 | |     "WiringConfig", 
18 | |     "FullWiringConfig",
19 | | ]
   | |_^ RUF022
   |
   = help: Apply an isort-style sorting to `__all__`

src/infrastructure/di/di_components/__init__.py:17:20: W291 [*] Trailing whitespace
   |
16 | __all__ = [
17 |     "WiringConfig", 
   |                    ^ W291
18 |     "FullWiringConfig",
19 | ]
   |
   = help: Remove trailing whitespace

src/infrastructure/di/di_components/service_factory.py:11:89: E501 Line too long (103 > 88)
   |
10 | class ServiceFactory:
11 |     """Factory for creating service implementations with proper error handling for missing services."""
   |                                                                                         ^^^^^^^^^^^^^^^ E501
12 |
13 |     def __init__(self, use_mocks: bool = False) -> None:
   |

src/infrastructure/di/di_components/service_factory.py:19:13: PLC0415 `import` should be at the top-level of a file
   |
17 |           """Create speech processor service with fallback handling."""
18 |           try:
19 | /             from infrastructure.external_apis.whisper_client import (
20 | |                 WhisperClient,
21 | |             )
   | |_____________^ PLC0415
22 |
23 |               return WhisperClient(model_name=settings.WHISPER_MODEL)
   |

src/infrastructure/di/di_components/service_factory.py:27:19: TRY003 Avoid specifying long messages outside the exception class
   |
25 |             logger.critical(f"CRITICAL ERROR: Whisper client dependency missing: {e}")
26 |             logger.critical("Install required dependencies: pip install whisper")
27 |             raise ImportError("Missing speech processor dependency: whisper") from e
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
28 |         except AttributeError as e:
29 |             logger.critical(f"CRITICAL ERROR: Missing WHISPER_MODEL in settings: {e}")
   |

src/infrastructure/di/di_components/service_factory.py:30:19: TRY003 Avoid specifying long messages outside the exception class
   |
28 |         except AttributeError as e:
29 |             logger.critical(f"CRITICAL ERROR: Missing WHISPER_MODEL in settings: {e}")
30 |             raise ValueError("WHISPER_MODEL configuration required") from e
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
31 |         except Exception as e:
32 |             logger.critical(f"CRITICAL ERROR: Failed to create speech processor: {e}")
   |

src/infrastructure/di/di_components/service_factory.py:33:19: TRY003 Avoid specifying long messages outside the exception class
   |
31 |         except Exception as e:
32 |             logger.critical(f"CRITICAL ERROR: Failed to create speech processor: {e}")
33 |             raise RuntimeError("Speech processor service creation failed") from e
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
34 |
35 |     def create_openai_client(self, settings: Any) -> Any:
   |

src/infrastructure/di/di_components/service_factory.py:38:13: PLC0415 `import` should be at the top-level of a file
   |
36 |         """Create OpenAI client service with fallback handling."""
37 |         try:
38 |             from infrastructure.external_apis.openai_client import OpenAIClient
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
39 |
40 |             if not hasattr(settings, "OPENAI_API_KEY") or not settings.OPENAI_API_KEY:
   |

src/infrastructure/di/di_components/service_factory.py:41:17: TRY301 Abstract `raise` to an inner function
   |
40 |             if not hasattr(settings, "OPENAI_API_KEY") or not settings.OPENAI_API_KEY:
41 |                 raise ValueError("OPENAI_API_KEY is required")
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
42 |             return OpenAIClient(api_key=settings.OPENAI_API_KEY)
43 |         except ImportError as e:
   |

src/infrastructure/di/di_components/service_factory.py:41:23: TRY003 Avoid specifying long messages outside the exception class
   |
40 |             if not hasattr(settings, "OPENAI_API_KEY") or not settings.OPENAI_API_KEY:
41 |                 raise ValueError("OPENAI_API_KEY is required")
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
42 |             return OpenAIClient(api_key=settings.OPENAI_API_KEY)
43 |         except ImportError as e:
   |

src/infrastructure/di/di_components/service_factory.py:46:19: TRY003 Avoid specifying long messages outside the exception class
   |
44 |             logger.critical(f"CRITICAL ERROR: OpenAI client dependency missing: {e}")
45 |             logger.critical("Install required dependencies: pip install openai")
46 |             raise ImportError("Missing OpenAI dependency: openai") from e
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
47 |         except AttributeError as e:
48 |             logger.critical(f"CRITICAL ERROR: Missing OPENAI_API_KEY in settings: {e}")
   |

src/infrastructure/di/di_components/service_factory.py:49:19: TRY003 Avoid specifying long messages outside the exception class
   |
47 |         except AttributeError as e:
48 |             logger.critical(f"CRITICAL ERROR: Missing OPENAI_API_KEY in settings: {e}")
49 |             raise ValueError("OPENAI_API_KEY configuration required") from e
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
50 |         except Exception as e:
51 |             logger.critical(f"CRITICAL ERROR: Failed to create OpenAI client: {e}")
   |

src/infrastructure/di/di_components/service_factory.py:52:19: TRY003 Avoid specifying long messages outside the exception class
   |
50 |         except Exception as e:
51 |             logger.critical(f"CRITICAL ERROR: Failed to create OpenAI client: {e}")
52 |             raise RuntimeError("OpenAI service creation failed") from e
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
53 |
54 |     def create_tts_service(self, settings: Any) -> Any:
   |

src/infrastructure/di/di_components/service_factory.py:57:13: PLC0415 `import` should be at the top-level of a file
   |
55 |           """Create text-to-speech service with fallback handling."""
56 |           try:
57 | /             from infrastructure.external_apis.elevenlabs_client import (
58 | |                 ElevenLabsClient,
59 | |             )
   | |_____________^ PLC0415
60 |
61 |               if (
   |

src/infrastructure/di/di_components/service_factory.py:65:17: TRY301 Abstract `raise` to an inner function
   |
63 |                 or not settings.ELEVENLABS_API_KEY
64 |             ):
65 |                 raise ValueError("ELEVENLABS_API_KEY is required")
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
66 |             return ElevenLabsClient(api_key=settings.ELEVENLABS_API_KEY)
67 |         except ImportError as e:
   |

src/infrastructure/di/di_components/service_factory.py:65:23: TRY003 Avoid specifying long messages outside the exception class
   |
63 |                 or not settings.ELEVENLABS_API_KEY
64 |             ):
65 |                 raise ValueError("ELEVENLABS_API_KEY is required")
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
66 |             return ElevenLabsClient(api_key=settings.ELEVENLABS_API_KEY)
67 |         except ImportError as e:
   |

src/infrastructure/di/di_components/service_factory.py:72:19: TRY003 Avoid specifying long messages outside the exception class
   |
70 |             )
71 |             logger.critical("Install required dependencies: pip install elevenlabs")
72 |             raise ImportError("Missing TTS dependency: elevenlabs") from e
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
73 |         except AttributeError as e:
74 |             logger.critical(
   |

src/infrastructure/di/di_components/service_factory.py:77:19: TRY003 Avoid specifying long messages outside the exception class
   |
75 |                 f"CRITICAL ERROR: Missing ELEVENLABS_API_KEY in settings: {e}",
76 |             )
77 |             raise ValueError("ELEVENLABS_API_KEY configuration required") from e
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
78 |         except Exception as e:
79 |             logger.critical(f"CRITICAL ERROR: Failed to create TTS service: {e}")
   |

src/infrastructure/di/di_components/service_factory.py:80:19: TRY003 Avoid specifying long messages outside the exception class
   |
78 |         except Exception as e:
79 |             logger.critical(f"CRITICAL ERROR: Failed to create TTS service: {e}")
80 |             raise RuntimeError("TTS service creation failed") from e
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
81 |
82 |     def create_database(self, settings: Any) -> Any:
   |

src/infrastructure/di/di_components/service_factory.py:85:13: PLC0415 `import` should be at the top-level of a file
   |
83 |         """Create database implementation with fallback handling."""
84 |         try:
85 |             from infrastructure.persistence.database import Database
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
86 |
87 |             if not hasattr(settings, "database") or not settings.database.DATABASE_URL:
   |

src/infrastructure/di/di_components/service_factory.py:88:17: TRY301 Abstract `raise` to an inner function
   |
87 |             if not hasattr(settings, "database") or not settings.database.DATABASE_URL:
88 |                 raise ValueError("DATABASE_URL is required in settings.database")
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
89 |
90 |             # Pass connection pooling settings from main settings to Database
   |

src/infrastructure/di/di_components/service_factory.py:88:23: TRY003 Avoid specifying long messages outside the exception class
   |
87 |             if not hasattr(settings, "database") or not settings.database.DATABASE_URL:
88 |                 raise ValueError("DATABASE_URL is required in settings.database")
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
89 |
90 |             # Pass connection pooling settings from main settings to Database
   |

src/infrastructure/di/di_components/service_factory.py:105:19: TRY003 Avoid specifying long messages outside the exception class
    |
103 |                 "Install required dependencies: pip install sqlalchemy asyncpg",
104 |             )
105 |             raise ImportError("Missing database dependency") from e
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
106 |         except AttributeError as e:
107 |             logger.critical(f"CRITICAL ERROR: Missing database settings: {e}")
    |

src/infrastructure/di/di_components/service_factory.py:108:19: TRY003 Avoid specifying long messages outside the exception class
    |
106 |         except AttributeError as e:
107 |             logger.critical(f"CRITICAL ERROR: Missing database settings: {e}")
108 |             raise ValueError("Database configuration required") from e
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
109 |         except Exception as e:
110 |             logger.critical(f"CRITICAL ERROR: Failed to create database: {e}")
    |

src/infrastructure/di/di_components/service_factory.py:111:19: TRY003 Avoid specifying long messages outside the exception class
    |
109 |         except Exception as e:
110 |             logger.critical(f"CRITICAL ERROR: Failed to create database: {e}")
111 |             raise RuntimeError("Database service creation failed") from e
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
    |

src/infrastructure/di/di_components/wiring_config.py:14:26: RUF012 Mutable class attributes should be annotated with `typing.ClassVar`
   |
12 |     """
13 |
14 |     modules: list[str] = []
   |                          ^^ RUF012
   |

src/infrastructure/di/di_components/wiring_config.py:17:89: E501 Line too long (97 > 88)
   |
17 | # APIWiringConfig, DashboardWiringConfig, and CoreWiringConfig were unused and have been removed.
   |                                                                                         ^^^^^^^^^ E501
18 | # The project now uses FullWiringConfig directly, reducing complexity.
   |

src/infrastructure/di/di_components/wiring_config.py:27:15: RUF012 Mutable class attributes should be annotated with `typing.ClassVar`
   |
25 |       """
26 |
27 |       modules = [
   |  _______________^
28 | |         "src.presentation.api.esp32_endpoints",
29 | |         "src.presentation.api.parental_dashboard",
30 | |         "src.presentation.api.health_endpoints",
31 | |         "src.presentation.dependencies",
32 | |         # Add other top-level modules that require wiring here
33 | |     ]
   | |_____^ RUF012
   |

src/infrastructure/di/fastapi_dependencies.py:1:1: I001 [*] Import block is un-sorted or un-formatted
   |
 1 | / from functools import lru_cache
 2 | | from typing import Any
 3 | |
 4 | | from fastapi import Depends, HTTPException, status
 5 | | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
 6 | |
 7 | | from src.infrastructure.caching.redis_cache import RedisCacheManager as RedisCache
 8 | |
 9 | | from src.infrastructure.config.settings import Settings, get_settings
10 | | from src.infrastructure.persistence.database_manager import Database
11 | | from src.infrastructure.security.main_security_service import (
12 | |     MainSecurityService,
13 | |     get_security_service,
14 | | )
15 | | from src.infrastructure.security.real_auth_service import ProductionAuthService
   | |_______________________________________________________________________________^ I001
16 |
17 |   """FastAPI Dependency Injection Utilities"""
   |
   = help: Organize imports

src/infrastructure/di/fastapi_dependencies.py:7:73: F401 [*] `src.infrastructure.caching.redis_cache.RedisCacheManager` imported but unused
  |
5 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
6 |
7 | from src.infrastructure.caching.redis_cache import RedisCacheManager as RedisCache
  |                                                                         ^^^^^^^^^^ F401
8 |
9 | from src.infrastructure.config.settings import Settings, get_settings
  |
  = help: Remove unused import: `src.infrastructure.caching.redis_cache.RedisCacheManager`

src/infrastructure/di/fastapi_dependencies.py:19:1: E402 Module level import not at top of file
   |
17 | """FastAPI Dependency Injection Utilities"""
18 |
19 | from src.infrastructure.logging_config import get_logger
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
20 |
21 | logger = get_logger(__name__, component="infrastructure")
   |

src/infrastructure/di/fastapi_dependencies.py:36:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
34 | @lru_cache
35 | def get_database(
36 |     settings: Settings = Depends(get_cached_settings),
   |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
37 | ) -> Database:
38 |     """Get database connection."""
   |

src/infrastructure/di/fastapi_dependencies.py:42:9: TRY400 Use `logging.exception` instead of `logging.error`
   |
40 |         return Database(str(settings.database.DATABASE_URL))
41 |     except Exception as e:
42 |         logger.error(f"Database initialization failed: {e}")
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
43 |         # Return mock database for development
44 |         from src.infrastructure.persistence.mock_database import MockDatabase
   |
   = help: Replace with `exception`

src/infrastructure/di/fastapi_dependencies.py:44:9: PLC0415 `import` should be at the top-level of a file
   |
42 |         logger.error(f"Database initialization failed: {e}")
43 |         # Return mock database for development
44 |         from src.infrastructure.persistence.mock_database import MockDatabase
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
45 |
46 |         return MockDatabase()
   |

src/infrastructure/di/fastapi_dependencies.py:51:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
49 | @lru_cache
50 | def get_cache(
51 |     settings: Settings = Depends(get_cached_settings),
   |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
52 | ) -> RedisCacheManager:
53 |     """Get cache service."""
   |

src/infrastructure/di/fastapi_dependencies.py:52:6: F821 Undefined name `RedisCacheManager`
   |
50 | def get_cache(
51 |     settings: Settings = Depends(get_cached_settings),
52 | ) -> RedisCacheManager:
   |      ^^^^^^^^^^^^^^^^^ F821
53 |     """Get cache service."""
54 |     try:
   |

src/infrastructure/di/fastapi_dependencies.py:55:16: F821 Undefined name `RedisCacheManager`
   |
53 |     """Get cache service."""
54 |     try:
55 |         return RedisCacheManager(str(settings.redis.REDIS_URL))
   |                ^^^^^^^^^^^^^^^^^ F821
56 |     except Exception as e:
57 |         logger.warning(f"Redis not available, using memory cache: {e}")
   |

src/infrastructure/di/fastapi_dependencies.py:58:9: PLC0415 `import` should be at the top-level of a file
   |
56 |     except Exception as e:
57 |         logger.warning(f"Redis not available, using memory cache: {e}")
58 |         from src.infrastructure.caching.memory_cache import MemoryCache
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
59 |
60 |         return MemoryCache()
   |

src/infrastructure/di/fastapi_dependencies.py:71:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
69 | @lru_cache
70 | def get_auth_service(
71 |     database: Database = Depends(get_database),
   |                          ^^^^^^^^^^^^^^^^^^^^^ B008
72 |     cache: Any = Depends(get_cache),
73 |     settings: Settings = Depends(get_cached_settings),
   |

src/infrastructure/di/fastapi_dependencies.py:72:18: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
70 | def get_auth_service(
71 |     database: Database = Depends(get_database),
72 |     cache: Any = Depends(get_cache),
   |                  ^^^^^^^^^^^^^^^^^^ B008
73 |     settings: Settings = Depends(get_cached_settings),
74 | ) -> ProductionAuthService:
   |

src/infrastructure/di/fastapi_dependencies.py:73:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
71 |     database: Database = Depends(get_database),
72 |     cache: Any = Depends(get_cache),
73 |     settings: Settings = Depends(get_cached_settings),
   |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
74 | ) -> ProductionAuthService:
75 |     """Get authentication service."""
   |

src/infrastructure/di/fastapi_dependencies.py:81:43: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
79 | # Security Dependencies
80 | async def get_current_user(
81 |     token: HTTPAuthorizationCredentials = Depends(security),
   |                                           ^^^^^^^^^^^^^^^^^ B008
82 |     auth_service: ProductionAuthService = Depends(get_auth_service),
83 | ) -> dict[str, Any]:
   |

src/infrastructure/di/fastapi_dependencies.py:82:43: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
80 | async def get_current_user(
81 |     token: HTTPAuthorizationCredentials = Depends(security),
82 |     auth_service: ProductionAuthService = Depends(get_auth_service),
   |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^ B008
83 | ) -> dict[str, Any]:
84 |     """Get current user from token."""
   |

src/infrastructure/di/fastapi_dependencies.py:96:36: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
95 | async def get_current_active_user(
96 |     current_user: dict[str, Any] = Depends(get_current_user),
   |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^ B008
97 | ) -> dict[str, Any]:
98 |     """Get current active user."""
   |

src/infrastructure/error_handling/__init__.py:4:1: I001 [*] Import block is un-sorted or un-formatted
   |
 3 |   # Import from application layer
 4 | / from src.application.exceptions import (
 5 | |     AITeddyError,
 6 | |     ServiceUnavailableError,
 7 | |     InvalidInputError,
 8 | |     TimeoutError
 9 | | )
10 | |
11 | | # Import from local modules
12 | | from .exceptions import (
13 | |     BaseInfrastructureException,
14 | |     ConfigurationError,
15 | |     DatabaseConnectionError,
16 | |     SecurityError,
17 | |     RateLimitExceededError,
18 | |     handle_exception,
19 | |     create_http_exception,
20 | |     AITeddyErrorHandler
21 | | )
22 | |
23 | | from .error_types import (
24 | |     ErrorType,
25 | |     ErrorSeverity,
26 | |     ErrorContext,
27 | |     BaseApplicationError,
28 | |     ExternalServiceError
29 | | )
30 | |
31 | | # Import the actual decorators that exist
32 | | from .decorators import (
33 | |     handle_errors,
34 | |     retry_on_error,
35 | |     safe_execution,
36 | |     validate_result
37 | | )
38 | |
39 | | # Import message functions that exist
40 | | from .messages import (
41 | |     get_error_message,
42 | |     ERROR_MESSAGES
43 | | )
   | |_^ I001
44 |
45 |   __all__ = [
   |
   = help: Organize imports

src/infrastructure/error_handling/__init__.py:8:5: A004 Import `TimeoutError` is shadowing a Python builtin
  |
6 |     ServiceUnavailableError,
7 |     InvalidInputError,
8 |     TimeoutError
  |     ^^^^^^^^^^^^ A004
9 | )
  |

src/infrastructure/error_handling/__init__.py:45:11: RUF022 `__all__` is not sorted
   |
43 |   )
44 |
45 |   __all__ = [
   |  ___________^
46 | |     # From application layer
47 | |     "AITeddyError",
48 | |     "ServiceUnavailableError", 
49 | |     "InvalidInputError",
50 | |     "TimeoutError",
51 | |     # From infrastructure
52 | |     "BaseInfrastructureException",
53 | |     "ConfigurationError",
54 | |     "DatabaseConnectionError", 
55 | |     "SecurityError",
56 | |     "RateLimitExceededError",
57 | |     "handle_exception",
58 | |     "create_http_exception",
59 | |     "AITeddyErrorHandler",
60 | |     # Error types
61 | |     "ErrorType",
62 | |     "ErrorSeverity",
63 | |     "ErrorContext",
64 | |     "BaseApplicationError",
65 | |     "ExternalServiceError",
66 | |     # Actual decorators that exist
67 | |     "handle_errors",
68 | |     "retry_on_error",
69 | |     "safe_execution", 
70 | |     "validate_result",
71 | |     # Messages
72 | |     "get_error_message",
73 | |     "ERROR_MESSAGES"
74 | | ]
   | |_^ RUF022
   |
   = help: Apply an isort-style sorting to `__all__`

src/infrastructure/error_handling/__init__.py:48:31: W291 [*] Trailing whitespace
   |
46 |     # From application layer
47 |     "AITeddyError",
48 |     "ServiceUnavailableError", 
   |                               ^ W291
49 |     "InvalidInputError",
50 |     "TimeoutError",
   |
   = help: Remove trailing whitespace

src/infrastructure/error_handling/__init__.py:54:31: W291 [*] Trailing whitespace
   |
52 |     "BaseInfrastructureException",
53 |     "ConfigurationError",
54 |     "DatabaseConnectionError", 
   |                               ^ W291
55 |     "SecurityError",
56 |     "RateLimitExceededError",
   |
   = help: Remove trailing whitespace

src/infrastructure/error_handling/__init__.py:69:22: W291 [*] Trailing whitespace
   |
67 |     "handle_errors",
68 |     "retry_on_error",
69 |     "safe_execution", 
   |                      ^ W291
70 |     "validate_result",
71 |     # Messages
   |
   = help: Remove trailing whitespace

src/infrastructure/error_handling/decorators.py:33:89: E501 Line too long (92 > 88)
   |
31 |                         if log_errors:
32 |                             logger.warning(
33 |                                 f"Mapped {type(e).__name__} to {target_type.__name__}: {e}",
   |                                                                                         ^^^^ E501
34 |                             )
35 |                         raise mapped_error from e
   |

src/infrastructure/error_handling/decorators.py:60:89: E501 Line too long (92 > 88)
   |
58 |                         if log_errors:
59 |                             logger.warning(
60 |                                 f"Mapped {type(e).__name__} to {target_type.__name__}: {e}",
   |                                                                                         ^^^^ E501
61 |                             )
62 |                         raise mapped_error from e
   |

src/infrastructure/error_handling/decorators.py:88:5: D205 1 blank line required between summary line and description
   |
86 |       backoff: float = 2.0,
87 |   ):
88 | /     """Decorator to retry function on specific errors.
89 | |     Usage: @retry_on_error(max_retries=3, retry_exceptions=(ExternalServiceError,))
90 | |     """
   | |_______^ D205
91 |
92 |       def decorator(func: Callable):
   |
   = help: Insert single blank line

src/infrastructure/error_handling/decorators.py:88:5: D415 First line should end with a period, question mark, or exclamation point
   |
86 |       backoff: float = 2.0,
87 |   ):
88 | /     """Decorator to retry function on specific errors.
89 | |     Usage: @retry_on_error(max_retries=3, retry_exceptions=(ExternalServiceError,))
90 | |     """
   | |_______^ D415
91 |
92 |       def decorator(func: Callable):
   |
   = help: Add closing punctuation

src/infrastructure/error_handling/decorators.py:113:21: TRY400 Use `logging.exception` instead of `logging.error`
    |
111 |                     raise
112 |                 except Exception as other_error:
113 |                     logger.error(f"Unexpected error in {func.__name__}: {other_error}")
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
114 |                     raise
    |
    = help: Replace with `exception`

src/infrastructure/error_handling/decorators.py:121:13: PLC0415 `import` should be at the top-level of a file
    |
119 |         @functools.wraps(func)
120 |         def sync_wrapper(*args, **kwargs):
121 |             import time
    |             ^^^^^^^^^^^ PLC0415
122 |
123 |             last_error = None
    |

src/infrastructure/error_handling/decorators.py:141:21: TRY400 Use `logging.exception` instead of `logging.error`
    |
139 |                     raise
140 |                 except Exception as other_error:
141 |                     logger.error(f"Unexpected error in {func.__name__}: {other_error}")
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
142 |                     raise
    |
    = help: Replace with `exception`

src/infrastructure/error_handling/decorators.py:159:5: D205 1 blank line required between summary line and description
    |
157 |       reraise: bool = False,
158 |   ):
159 | /     """Decorator for safe execution with fallback value.
160 | |     Usage: @safe_execution(fallback_value=[], log_errors=True)
161 | |     """
    | |_______^ D205
162 |
163 |       def decorator(func: Callable):
    |
    = help: Insert single blank line

src/infrastructure/error_handling/decorators.py:159:5: D415 First line should end with a period, question mark, or exclamation point
    |
157 |       reraise: bool = False,
158 |   ):
159 | /     """Decorator for safe execution with fallback value.
160 | |     Usage: @safe_execution(fallback_value=[], log_errors=True)
161 | |     """
    | |_______^ D415
162 |
163 |       def decorator(func: Callable):
    |
    = help: Add closing punctuation

src/infrastructure/error_handling/error_types.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Error types required by decorators.py"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | from enum import Enum
  |
  = help: Add closing punctuation

src/infrastructure/error_handling/error_types.py:22:1: W293 [*] Blank line contains whitespace
   |
20 | class BaseApplicationError(Exception):
21 |     """Base application error that decorators.py expects."""
22 |     
   | ^^^^ W293
23 |     def __init__(self, message: str):
24 |         self.message = message
   |
   = help: Remove whitespace from blank line

src/infrastructure/error_handling/error_types.py:30:1: W293 [*] Blank line contains whitespace
   |
28 | class ExternalServiceError(BaseApplicationError):
29 |     """External service error that decorators.py expects."""
30 |     
   | ^^^^ W293
31 |     def __init__(self, message: str):
32 |         super().__init__(message)
   |
   = help: Remove whitespace from blank line

src/infrastructure/error_handling/error_types.py:37:1: W293 [*] Blank line contains whitespace
   |
35 | class ErrorContext:
36 |     """Context information for errors."""
37 |     
   | ^^^^ W293
38 |     def __init__(self, error_type: ErrorType, severity: ErrorSeverity = ErrorSeverity.MEDIUM):
39 |         self.error_type = error_type
   |
   = help: Remove whitespace from blank line

src/infrastructure/error_handling/error_types.py:38:89: E501 Line too long (94 > 88)
   |
36 |     """Context information for errors."""
37 |     
38 |     def __init__(self, error_type: ErrorType, severity: ErrorSeverity = ErrorSeverity.MEDIUM):
   |                                                                                         ^^^^^^ E501
39 |         self.error_type = error_type
40 |         self.severity = severity
   |

src/infrastructure/error_handling/exceptions.py:3:1: UP035 `typing.Dict` is deprecated, use `dict` instead
  |
1 | """Exception handling for AI Teddy Bear infrastructure."""
2 |
3 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
4 | from fastapi import HTTPException, status
  |

src/infrastructure/error_handling/exceptions.py:3:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 |   """Exception handling for AI Teddy Bear infrastructure."""
2 |
3 | / from typing import Any, Dict, Optional
4 | | from fastapi import HTTPException, status
  | |_________________________________________^ I001
  |
  = help: Organize imports

src/infrastructure/error_handling/exceptions.py:7:7: N818 Exception name `BaseInfrastructureException` should be named with an Error suffix
  |
7 | class BaseInfrastructureException(Exception):
  |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^ N818
8 |     """Base exception for infrastructure layer."""
  |

src/infrastructure/error_handling/exceptions.py:9:1: W293 [*] Blank line contains whitespace
   |
 7 | class BaseInfrastructureException(Exception):
 8 |     """Base exception for infrastructure layer."""
 9 |     
   | ^^^^ W293
10 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
11 |         self.message = message
   |
   = help: Remove whitespace from blank line

src/infrastructure/error_handling/exceptions.py:10:47: UP045 [*] Use `X | None` for type annotations
   |
 8 |     """Base exception for infrastructure layer."""
 9 |     
10 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^ UP045
11 |         self.message = message
12 |         self.details = details or {}
   |
   = help: Convert to `X | None`

src/infrastructure/error_handling/exceptions.py:10:56: UP006 [*] Use `dict` instead of `Dict` for type annotation
   |
 8 |     """Base exception for infrastructure layer."""
 9 |     
10 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^ UP006
11 |         self.message = message
12 |         self.details = details or {}
   |
   = help: Replace with `dict`

src/infrastructure/error_handling/exceptions.py:40:14: UP045 [*] Use `X | None` for type annotations
   |
38 |     status_code: int,
39 |     message: str,
40 |     details: Optional[Dict[str, Any]] = None
   |              ^^^^^^^^^^^^^^^^^^^^^^^^ UP045
41 | ) -> HTTPException:
42 |     """Create HTTP exception with details."""
   |
   = help: Convert to `X | None`

src/infrastructure/error_handling/exceptions.py:40:23: UP006 [*] Use `dict` instead of `Dict` for type annotation
   |
38 |     status_code: int,
39 |     message: str,
40 |     details: Optional[Dict[str, Any]] = None
   |                       ^^^^ UP006
41 | ) -> HTTPException:
42 |     """Create HTTP exception with details."""
   |
   = help: Replace with `dict`

src/infrastructure/error_handling/exceptions.py:61:1: W293 [*] Blank line contains whitespace
   |
59 |             details=exception.details
60 |         )
61 |     
   | ^^^^ W293
62 |     # Generic exception handling
63 |     return create_http_exception(
   |
   = help: Remove whitespace from blank line

src/infrastructure/error_handling/exceptions.py:72:1: W293 [*] Blank line contains whitespace
   |
70 | class AITeddyErrorHandler:
71 |     """Handler for AITeddyError and related exceptions."""
72 |     
   | ^^^^ W293
73 |     @staticmethod
74 |     def handle_authentication_error(message: str = "Authentication required"):
   |
   = help: Remove whitespace from blank line

src/infrastructure/error_handling/exceptions.py:76:9: PLC0415 `import` should be at the top-level of a file
   |
74 |     def handle_authentication_error(message: str = "Authentication required"):
75 |         """Handle authentication errors."""
76 |         from src.application.exceptions import AITeddyError
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
77 |         return AITeddyError(f"Auth Error: {message}")
   |

src/infrastructure/error_handling/exceptions.py:78:1: W293 [*] Blank line contains whitespace
   |
76 |         from src.application.exceptions import AITeddyError
77 |         return AITeddyError(f"Auth Error: {message}")
78 |     
   | ^^^^ W293
79 |     @staticmethod
80 |     def handle_authorization_error(message: str = "Access denied"):
   |
   = help: Remove whitespace from blank line

src/infrastructure/error_handling/exceptions.py:81:43: W291 [*] Trailing whitespace
   |
79 |     @staticmethod
80 |     def handle_authorization_error(message: str = "Access denied"):
81 |         """Handle authorization errors.""" 
   |                                           ^ W291
82 |         from src.application.exceptions import AITeddyError
83 |         return AITeddyError(f"Auth Error: {message}")
   |
   = help: Remove trailing whitespace

src/infrastructure/error_handling/exceptions.py:82:9: PLC0415 `import` should be at the top-level of a file
   |
80 |     def handle_authorization_error(message: str = "Access denied"):
81 |         """Handle authorization errors.""" 
82 |         from src.application.exceptions import AITeddyError
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
83 |         return AITeddyError(f"Auth Error: {message}")
   |

src/infrastructure/error_handling/exceptions.py:84:1: W293 [*] Blank line contains whitespace
   |
82 |         from src.application.exceptions import AITeddyError
83 |         return AITeddyError(f"Auth Error: {message}")
84 |     
   | ^^^^ W293
85 |     @staticmethod
86 |     def handle_validation_error(message: str = "Invalid input"):
   |
   = help: Remove whitespace from blank line

src/infrastructure/error_handling/exceptions.py:88:9: PLC0415 `import` should be at the top-level of a file
   |
86 |     def handle_validation_error(message: str = "Invalid input"):
87 |         """Handle validation errors."""
88 |         from src.application.exceptions import InvalidInputError
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
89 |         return InvalidInputError(message)
   |

src/infrastructure/error_handling/exceptions.py:90:1: W293 [*] Blank line contains whitespace
   |
88 |         from src.application.exceptions import InvalidInputError
89 |         return InvalidInputError(message)
90 |     
   | ^^^^ W293
91 |     @staticmethod
92 |     def handle_not_found_error(message: str = "Resource not found"):
   |
   = help: Remove whitespace from blank line

src/infrastructure/error_handling/exceptions.py:94:9: PLC0415 `import` should be at the top-level of a file
   |
92 |     def handle_not_found_error(message: str = "Resource not found"):
93 |         """Handle not found errors."""
94 |         from src.application.exceptions import AITeddyError
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
95 |         return AITeddyError(f"Not Found: {message}")
   |

src/infrastructure/error_handling/exceptions.py:96:1: W293 [*] Blank line contains whitespace
   |
94 |         from src.application.exceptions import AITeddyError
95 |         return AITeddyError(f"Not Found: {message}")
96 |     
   | ^^^^ W293
97 |     @staticmethod
98 |     def handle_internal_error(message: str = "Internal server error"):
   |
   = help: Remove whitespace from blank line

src/infrastructure/error_handling/exceptions.py:100:9: PLC0415 `import` should be at the top-level of a file
    |
 98 |     def handle_internal_error(message: str = "Internal server error"):
 99 |         """Handle internal server errors."""
100 |         from src.application.exceptions import AITeddyError
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
101 |         return AITeddyError(f"Internal Error: {message}")
    |

src/infrastructure/error_handling/messages.py:6:89: E501 Line too long (101 > 88)
  |
4 |     "AUTHORIZATION_ERROR": "You don't have permission to access this resource.",
5 |     "NOT_FOUND_ERROR": "The requested resource could not be found.",
6 |     "CONFLICT_ERROR": "A conflict occurred with the existing resource. Please review and try again.",
  |                                                                                         ^^^^^^^^^^^^^ E501
7 |     "EXTERNAL_SERVICE_ERROR": "A required external service is temporarily unavailable. Please try again later.",
8 |     "RATE_LIMIT_EXCEEDED": "Too many requests. Please try again after some time.",
  |

src/infrastructure/error_handling/messages.py:7:89: E501 Line too long (112 > 88)
  |
5 |     "NOT_FOUND_ERROR": "The requested resource could not be found.",
6 |     "CONFLICT_ERROR": "A conflict occurred with the existing resource. Please review and try again.",
7 |     "EXTERNAL_SERVICE_ERROR": "A required external service is temporarily unavailable. Please try again later.",
  |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^ E501
8 |     "RATE_LIMIT_EXCEEDED": "Too many requests. Please try again after some time.",
9 |     "CHILD_SAFETY_VIOLATION": "Content not appropriate for children. The interaction has been flagged.",
  |

src/infrastructure/error_handling/messages.py:9:89: E501 Line too long (104 > 88)
   |
 7 |     "EXTERNAL_SERVICE_ERROR": "A required external service is temporarily unavailable. Please try again later.",
 8 |     "RATE_LIMIT_EXCEEDED": "Too many requests. Please try again after some time.",
 9 |     "CHILD_SAFETY_VIOLATION": "Content not appropriate for children. The interaction has been flagged.",
   |                                                                                         ^^^^^^^^^^^^^^^^ E501
10 |     "DATABASE_ERROR": "A database error occurred. Please try again.",
11 |     "DATABASE_CONNECTION_ERROR": "Failed to connect to the database. Please try again later.",
   |

src/infrastructure/error_handling/messages.py:11:89: E501 Line too long (94 > 88)
   |
 9 |     "CHILD_SAFETY_VIOLATION": "Content not appropriate for children. The interaction has been flagged.",
10 |     "DATABASE_ERROR": "A database error occurred. Please try again.",
11 |     "DATABASE_CONNECTION_ERROR": "Failed to connect to the database. Please try again later.",
   |                                                                                         ^^^^^^ E501
12 |     "SYSTEM_ERROR": "An unexpected system error occurred. Please contact support.",
13 |     "CONFIGURATION_ERROR": "A critical configuration error occurred. Please check system settings.",
   |

src/infrastructure/error_handling/messages.py:13:89: E501 Line too long (100 > 88)
   |
11 |     "DATABASE_CONNECTION_ERROR": "Failed to connect to the database. Please try again later.",
12 |     "SYSTEM_ERROR": "An unexpected system error occurred. Please contact support.",
13 |     "CONFIGURATION_ERROR": "A critical configuration error occurred. Please check system settings.",
   |                                                                                         ^^^^^^^^^^^^ E501
14 |     "PARENTAL_CONSENT_REQUIRED": "Parental consent is required for this action.",
15 |     "CHILD_NOT_FOUND": "Child profile not found.",
   |

src/infrastructure/error_handling/messages.py:16:89: E501 Line too long (98 > 88)
   |
14 |     "PARENTAL_CONSENT_REQUIRED": "Parental consent is required for this action.",
15 |     "CHILD_NOT_FOUND": "Child profile not found.",
16 |     "CONVERSATION_LIMIT_EXCEEDED": "Daily conversation limit reached. Please try again tomorrow.",
   |                                                                                         ^^^^^^^^^^ E501
17 |     "FILE_UPLOAD_ERROR": "Failed to upload file. Please check the file and try again.",
18 |     "UNSUPPORTED_FILE_TYPE": "Unsupported file type. Please upload a valid file.",
   |

src/infrastructure/error_handling/messages.py:21:89: E501 Line too long (93 > 88)
   |
19 |     "FILE_SIZE_EXCEEDED": "File size exceeds the maximum allowed limit.",
20 |     "INVALID_FILENAME": "Invalid filename. Please use a safe filename.",
21 |     "AUTHENTICATION_TOKEN_EXPIRED": "Authentication token has expired. Please log in again.",
   |                                                                                         ^^^^^ E501
22 |     "AUTHENTICATION_TOKEN_INVALID": "Invalid authentication token. Please log in again.",
23 |     "SERVICE_UNAVAILABLE": "Service is temporarily unavailable. Please try again later.",
   |

src/infrastructure/error_handling/messages.py:22:89: E501 Line too long (89 > 88)
   |
20 |     "INVALID_FILENAME": "Invalid filename. Please use a safe filename.",
21 |     "AUTHENTICATION_TOKEN_EXPIRED": "Authentication token has expired. Please log in again.",
22 |     "AUTHENTICATION_TOKEN_INVALID": "Invalid authentication token. Please log in again.",
   |                                                                                         ^ E501
23 |     "SERVICE_UNAVAILABLE": "Service is temporarily unavailable. Please try again later.",
24 |     "UNKNOWN_ERROR": "An unknown error occurred. Please try again.",
   |

src/infrastructure/error_handling/messages.py:23:89: E501 Line too long (89 > 88)
   |
21 |     "AUTHENTICATION_TOKEN_EXPIRED": "Authentication token has expired. Please log in again.",
22 |     "AUTHENTICATION_TOKEN_INVALID": "Invalid authentication token. Please log in again.",
23 |     "SERVICE_UNAVAILABLE": "Service is temporarily unavailable. Please try again later.",
   |                                                                                         ^ E501
24 |     "UNKNOWN_ERROR": "An unknown error occurred. Please try again.",
25 | }
   |

src/infrastructure/exception_handling/enterprise_exception_handler.py:25:9: ARG002 Unused method argument: `exception`
   |
23 |     def handle_exception(
24 |         self,
25 |         exception: Exception,
   |         ^^^^^^^^^ ARG002
26 |         error_code: str | None = None,
27 |         additional_data: dict[str, Any] | None = None,
   |

src/infrastructure/exception_handling/enterprise_exception_handler.py:26:9: ARG002 Unused method argument: `error_code`
   |
24 |         self,
25 |         exception: Exception,
26 |         error_code: str | None = None,
   |         ^^^^^^^^^^ ARG002
27 |         additional_data: dict[str, Any] | None = None,
28 |         reraise: bool = True,
   |

src/infrastructure/exception_handling/enterprise_exception_handler.py:27:9: ARG002 Unused method argument: `additional_data`
   |
25 |         exception: Exception,
26 |         error_code: str | None = None,
27 |         additional_data: dict[str, Any] | None = None,
   |         ^^^^^^^^^^^^^^^ ARG002
28 |         reraise: bool = True,
29 |     ):
   |

src/infrastructure/exception_handling/enterprise_exception_handler.py:28:9: ARG002 Unused method argument: `reraise`
   |
26 |         error_code: str | None = None,
27 |         additional_data: dict[str, Any] | None = None,
28 |         reraise: bool = True,
   |         ^^^^^^^ ARG002
29 |     ):
30 |         return None
   |

src/infrastructure/exception_handling/enterprise_exception_handler.py:32:35: ARG002 Unused method argument: `service_name`
   |
30 |         return None
31 |
32 |     def get_circuit_breaker(self, service_name: str):
   |                                   ^^^^^^^^^^^^ ARG002
33 |         return MockCircuitBreaker()
   |

src/infrastructure/exception_handling/enterprise_exception_handler.py:51:24: ARG001 Unused function argument: `args`
   |
51 | def handle_exceptions(*args, **kwargs):
   |                        ^^^^ ARG001
52 |     def decorator(func):
53 |         async def wrapper(*args, **kwargs):
   |

src/infrastructure/exception_handling/enterprise_exception_handler.py:51:32: ARG001 Unused function argument: `kwargs`
   |
51 | def handle_exceptions(*args, **kwargs):
   |                                ^^^^^^ ARG001
52 |     def decorator(func):
53 |         async def wrapper(*args, **kwargs):
   |

src/infrastructure/exception_handling/enterprise_exception_handler.py:61:17: ARG001 Unused function argument: `args`
   |
61 | def with_retry(*args, **kwargs):
   |                 ^^^^ ARG001
62 |     def decorator(func):
63 |         async def wrapper(*args, **kwargs):
   |

src/infrastructure/exception_handling/enterprise_exception_handler.py:61:25: ARG001 Unused function argument: `kwargs`
   |
61 | def with_retry(*args, **kwargs):
   |                         ^^^^^^ ARG001
62 |     def decorator(func):
63 |         async def wrapper(*args, **kwargs):
   |

src/infrastructure/exceptions.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Centralized Exception Handling System"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | from datetime import datetime
  |
  = help: Add closing punctuation

src/infrastructure/exceptions.py:13:5: D415 First line should end with a period, question mark, or exclamation point
   |
12 | class ErrorCode(Enum):
13 |     """Standardized error codes for API responses"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
14 |
15 |     # Authentication errors (1000-1099)
   |
   = help: Add closing punctuation

src/infrastructure/exceptions.py:47:7: N818 Exception name `BaseApplicationException` should be named with an Error suffix
   |
47 | class BaseApplicationException(Exception):
   |       ^^^^^^^^^^^^^^^^^^^^^^^^ N818
48 |     """Base exception class for all application exceptions."""
   |

src/infrastructure/external_apis/azure_speech_client.py:20:89: E501 Line too long (90 > 88)
   |
18 |         # This is a simplified example. Azure Speech-to-Text typically involves
19 |         # a more complex WebSocket or streaming API for real-time.
20 |         # For a basic HTTP POST, you might need to adjust headers/URL based on Azure docs.
   |                                                                                         ^^ E501
21 |         async with httpx.AsyncClient() as client:
22 |             response = await client.post(
   |

src/infrastructure/external_apis/chatgpt_client.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Production ChatGPT API Client with Child Safety Filtering
2 | |
3 | | Enterprise-grade OpenAI integration for AI Teddy Bear
4 | | """
  | |___^ D415
5 |
6 |   import asyncio
  |
  = help: Add closing punctuation

src/infrastructure/external_apis/chatgpt_client.py:22:11: TRY003 Avoid specifying long messages outside the exception class
   |
20 |     )
21 |     logger.critical("Install required dependencies: pip install openai")
22 |     raise ImportError("Missing required dependency: openai") from e
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
   |

src/infrastructure/external_apis/chatgpt_client.py:28:33: RUF013 PEP 484 prohibits implicit `Optional`
   |
26 |     """Production ChatGPT client with comprehensive child safety filtering."""
27 |
28 |     def __init__(self, api_key: str = None) -> None:
   |                                 ^^^ RUF013
29 |         self.settings = get_settings()
30 |         self.api_key = api_key or self.settings.OPENAI_API_KEY
   |
   = help: Convert to `T | None`

src/infrastructure/external_apis/chatgpt_client.py:32:19: TRY003 Avoid specifying long messages outside the exception class
   |
30 |         self.api_key = api_key or self.settings.OPENAI_API_KEY
31 |         if not self.api_key:
32 |             raise ValueError("OpenAI API key is required for production use")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
33 |         self.client = AsyncOpenAI(api_key=self.api_key)
   |

src/infrastructure/external_apis/chatgpt_client.py:125:24: RUF005 Consider iterable unpacking instead of concatenation
    |
124 |         # Construct the full list of messages for the API call
125 |         api_messages = [{"role": "system", "content": system_prompt}] + messages
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ RUF005
126 |
127 |         try:
    |
    = help: Replace with iterable unpacking

src/infrastructure/external_apis/chatgpt_client.py:133:89: E501 Line too long (91 > 88)
    |
131 |                 temperature=temperature,
132 |                 max_tokens=max_tokens,
133 |                 # Add safety settings if the API supports it (this is a conceptual example)
    |                                                                                         ^^^ E501
134 |                 # safety_settings={"harm_category": "HARASSMENT", "threshold": "BLOCK_NONE"}
135 |             )
    |

src/infrastructure/external_apis/chatgpt_client.py:134:17: ERA001 Found commented-out code
    |
132 |                 max_tokens=max_tokens,
133 |                 # Add safety settings if the API supports it (this is a conceptual example)
134 |                 # safety_settings={"harm_category": "HARASSMENT", "threshold": "BLOCK_NONE"}
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ ERA001
135 |             )
    |
    = help: Remove commented-out code

src/infrastructure/external_apis/chatgpt_client.py:134:89: E501 Line too long (92 > 88)
    |
132 |                 max_tokens=max_tokens,
133 |                 # Add safety settings if the API supports it (this is a conceptual example)
134 |                 # safety_settings={"harm_category": "HARASSMENT", "threshold": "BLOCK_NONE"}
    |                                                                                         ^^^^ E501
135 |             )
    |

src/infrastructure/external_apis/chatgpt_client.py:150:13: TRY300 Consider moving this statement to an `else` block
    |
148 |                 return self._get_safe_redirect_response()
149 |
150 |             return generated_text
    |             ^^^^^^^^^^^^^^^^^^^^^ TRY300
151 |
152 |         except openai.AITeddyError as e:
    |

src/infrastructure/external_apis/chatgpt_client.py:153:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
152 |         except openai.AITeddyError as e:
153 |             logger.error(f"OpenAI API error: {e}", extra={"child_id": child_id})
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
154 |             raise ConnectionError(f"Failed to connect to OpenAI: {e}") from e
155 |         except Exception as e:
    |
    = help: Replace with `exception`

src/infrastructure/external_apis/chatgpt_client.py:154:19: TRY003 Avoid specifying long messages outside the exception class
    |
152 |         except openai.AITeddyError as e:
153 |             logger.error(f"OpenAI API error: {e}", extra={"child_id": child_id})
154 |             raise ConnectionError(f"Failed to connect to OpenAI: {e}") from e
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
155 |         except Exception as e:
156 |             logger.error(
    |

src/infrastructure/external_apis/chatgpt_client.py:156:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
154 |               raise ConnectionError(f"Failed to connect to OpenAI: {e}") from e
155 |           except Exception as e:
156 | /             logger.error(
157 | |                 f"Unexpected error in get_chat_completion: {e}",
158 | |                 extra={"child_id": child_id},
159 | |             )
    | |_____________^ TRY400
160 |               raise
    |
    = help: Replace with `exception`

src/infrastructure/external_apis/chatgpt_client.py:180:9: PLC0415 `import` should be at the top-level of a file
    |
178 |         # In a real application, this could involve more complex logic
179 |         # or even another model call to get a contextually relevant topic.
180 |         import random
    |         ^^^^^^^^^^^^^ PLC0415
181 |
182 |         return random.choice(self.safe_topics)
    |

src/infrastructure/external_apis/chatgpt_client.py:182:16: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
    |
180 |         import random
181 |
182 |         return random.choice(self.safe_topics)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ S311
    |

src/infrastructure/external_apis/chatgpt_client.py:212:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
211 |     except (ValueError, ImportError) as e:
212 |         logger.error(f"Failed to run example: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
213 |     except Exception as e:
214 |         logger.error(f"An unexpected error occurred during the example run: {e}")
    |
    = help: Replace with `exception`

src/infrastructure/external_apis/chatgpt_client.py:214:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
212 |         logger.error(f"Failed to run example: {e}")
213 |     except Exception as e:
214 |         logger.error(f"An unexpected error occurred during the example run: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
    |
    = help: Replace with `exception`

src/infrastructure/external_apis/chatgpt_client.py:220:5: ERA001 Found commented-out code
    |
218 |     # To run this, you need to have your environment configured.
219 |     # For example, create a .env file with:
220 |     # OPENAI_API_KEY="your_key_here"
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ ERA001
221 |     # OPENAI_MODEL="gpt-3.5-turbo"
    |
    = help: Remove commented-out code

src/infrastructure/external_apis/chatgpt_client.py:221:5: ERA001 Found commented-out code
    |
219 |     # For example, create a .env file with:
220 |     # OPENAI_API_KEY="your_key_here"
221 |     # OPENAI_MODEL="gpt-3.5-turbo"
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ ERA001
222 |
223 |     # Note: Running this directly might require additional setup for the settings loader.
    |
    = help: Remove commented-out code

src/infrastructure/external_apis/chatgpt_client.py:223:89: E501 Line too long (89 > 88)
    |
221 |     # OPENAI_MODEL="gpt-3.5-turbo"
222 |
223 |     # Note: Running this directly might require additional setup for the settings loader.
    |                                                                                         ^ E501
224 |     # Consider running this as part of a larger application context.
225 |     pass
    |

src/infrastructure/external_apis/chatgpt_service.py:15:1: E402 Module level import not at top of file
   |
13 |     COPPA_AVAILABLE = False
14 |
15 | from src.infrastructure.logging_config import get_logger
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
16 |
17 | logger = get_logger(__name__, component="infrastructure")
   |

src/infrastructure/external_apis/chatgpt_service.py:74:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
72 |             }
73 |         except Exception as e:
74 |             logger.error(f"ChatGPT service error: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
75 |             return {
76 |                 "error": "Service temporarily unavailable",
   |
   = help: Replace with `exception`

src/infrastructure/external_apis/openai_client.py:17:5: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
15 |     )
16 |     logger.critical("Install required dependencies: pip install openai")
17 |     raise ImportError("Missing required dependency: openai")
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
   |

src/infrastructure/external_apis/openai_client.py:17:11: TRY003 Avoid specifying long messages outside the exception class
   |
15 |     )
16 |     logger.critical("Install required dependencies: pip install openai")
17 |     raise ImportError("Missing required dependency: openai")
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
   |

src/infrastructure/external_apis/openai_client.py:26:9: ARG002 Unused method argument: `child_id`
   |
24 |     async def generate_response(
25 |         self,
26 |         child_id: UUID,
   |         ^^^^^^^^ ARG002
27 |         conversation_history: list[str],
28 |         current_input: str,
   |

src/infrastructure/external_apis/openai_client.py:45:13: PERF401 Use `list.extend` to create a transformed list
   |
43 |           # Add conversation history
44 |           for msg in conversation_history:
45 | /             messages.append(
46 | |                 {"role": "user", "content": msg},
47 | |             )  # Assuming all history is user for simplicity
   | |_____________^ PERF401
48 |           messages.append({"role": "user", "content": current_input})
49 |           response = await self.client.chat.completions.create(
   |
   = help: Replace for loop with list.extend

src/infrastructure/external_apis/whisper_client.py:13:89: E501 Line too long (94 > 88)
   |
11 |         # Assuming audio_data is raw audio bytes (e.g., WAV, FLAC)
12 |         # You might need to use a library like pydub or soundfile to load and resample
13 |         # For simplicity, this example assumes a compatible format or requires pre-processing.
   |                                                                                         ^^^^^^ E501
14 |         # A more robust solution would involve an audio processing library.
   |

src/infrastructure/external_apis/whisper_client.py:18:89: E501 Line too long (96 > 88)
   |
16 |         # Audio preprocessing: Convert input audio to required format
17 |         # Whisper requires 16kHz mono float32 format
18 |         # For demonstration, let's assume audio_data is already a 16kHz mono float32 numpy array
   |                                                                                         ^^^^^^^^ E501
19 |         # This is a simplification and will likely need adjustment for real-world use.
   |

src/infrastructure/external_apis/whisper_client.py:24:89: E501 Line too long (94 > 88)
   |
22 |         # to load and convert the audio bytes to the format Whisper expects.
23 |
24 |         # Example of how to convert raw bytes to a numpy array (assuming float32, mono, 16kHz)
   |                                                                                         ^^^^^^ E501
25 |         # This is a highly simplified example and might not work for all audio inputs.
26 |         audio_np = (
   |

src/infrastructure/external_services/dummy_notification_clients.py:17:62: ARG002 Unused method argument: `body`
   |
15 |     """Dummy implementation of IEmailClient for simulation purposes."""
16 |
17 |     async def send_email(self, recipient: str, subject: str, body: str) -> bool:
   |                                                              ^^^^ ARG002
18 |         self.logger.info(
19 |             f"[DUMMY EMAIL] Sending email to {recipient} with subject: {subject}",
   |

src/infrastructure/external_services/dummy_sanitization_service.py:24:81: PLR2004 Magic value used in comparison, consider replacing `7` with a constant variable
   |
22 |         # Dummy PII detection: simple check for common patterns like email or
23 |         # phone number formats
24 |         if "@" in text or (any(char.isdigit() for char in text) and len(text) > 7):
   |                                                                                 ^ PLR2004
25 |             self.logger.warning(
26 |                 "[DUMMY SANITIZATION] Possible PII detected. Returning True.",
   |

src/infrastructure/external_services/speech_analysis_base.py:7:1: E402 Module level import not at top of file
  |
5 | Core classes and utilities for speech disorder detection"""
6 |
7 | from src.infrastructure.logging_config import get_logger
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
8 |
9 | logger = get_logger(__name__, component="infrastructure")
  |

src/infrastructure/external_services/speech_analysis_base.py:59:34: PLR2004 Magic value used in comparison, consider replacing `1024` with a constant variable
   |
57 |             if not audio_data:
58 |                 return {"valid": False, "error": "Empty audio data provided"}
59 |             if len(audio_data) < 1024:  # Minimum size check
   |                                  ^^^^ PLR2004
60 |                 return {
61 |                     "valid": False,
   |

src/infrastructure/external_services/speech_analysis_base.py:69:89: E501 Line too long (92 > 88)
   |
67 |                 return {
68 |                     "valid": False,
69 |                     "error": f"Audio too short (minimum {self.config.min_audio_duration}s)",
   |                                                                                         ^^^^ E501
70 |                 }
71 |             if estimated_duration > self.config.max_audio_duration:
   |

src/infrastructure/external_services/speech_analysis_base.py:74:89: E501 Line too long (91 > 88)
   |
72 |                 return {
73 |                     "valid": False,
74 |                     "error": f"Audio too long (maximum {self.config.max_audio_duration}s)",
   |                                                                                         ^^^ E501
75 |                 }
76 |             return {
   |

src/infrastructure/external_services/speech_analysis_base.py:82:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
80 |             }
81 |         except Exception as e:
82 |             logger.error(f"Audio validation error: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
83 |             return {"valid": False, "error": f"Audio validation failed: {e!s}"}
   |
   = help: Replace with `exception`

src/infrastructure/external_services/speech_analysis_base.py:120:13: TRY300 Consider moving this statement to an `else` block
    |
118 |             }
119 |             logger.info("Audio features extracted successfully")
120 |             return features
    |             ^^^^^^^^^^^^^^^ TRY300
121 |         except Exception as e:
122 |             logger.error(f"Feature extraction error: {e}")
    |

src/infrastructure/external_services/speech_analysis_base.py:122:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
120 |             return features
121 |         except Exception as e:
122 |             logger.error(f"Feature extraction error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
123 |             return {"error": f"Feature extraction failed: {e!s}"}
    |
    = help: Replace with `exception`

src/infrastructure/external_services/speech_disorder_analyzer.py:9:1: E402 Module level import not at top of file
   |
 7 | Core disorder detection and analysis logic"""
 8 |
 9 | from src.infrastructure.logging_config import get_logger
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
10 |
11 | logger = get_logger(__name__, component="infrastructure")
   |

src/infrastructure/external_services/speech_disorder_analyzer.py:57:13: TRY300 Consider moving this statement to an `else` block
   |
55 |             )
56 |
57 |             return analysis_result
   |             ^^^^^^^^^^^^^^^^^^^^^^ TRY300
58 |         except Exception as e:
59 |             logger.error(f"Disorder analysis error: {e}")
   |

src/infrastructure/external_services/speech_disorder_analyzer.py:59:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
57 |             return analysis_result
58 |         except Exception as e:
59 |             logger.error(f"Disorder analysis error: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
60 |             return {
61 |                 "error": f"Disorder analysis failed: {e!s}",
   |
   = help: Replace with `exception`

src/infrastructure/external_services/speech_disorder_analyzer.py:75:26: PLR2004 Magic value used in comparison, consider replacing `3.0` with a constant variable
   |
73 |         confidence = 0.0
74 |
75 |         if speech_rate < 3.0:  # Slow speech rate
   |                          ^^^ PLR2004
76 |             stuttering_indicators += 1
77 |             confidence += 0.3
   |

src/infrastructure/external_services/speech_disorder_analyzer.py:79:28: PLR2004 Magic value used in comparison, consider replacing `0.2` with a constant variable
   |
77 |             confidence += 0.3
78 |
79 |         if silence_ratio > 0.2:  # Frequent pauses
   |                            ^^^ PLR2004
80 |             stuttering_indicators += 1
81 |             confidence += 0.4
   |

src/infrastructure/external_services/speech_disorder_analyzer.py:116:32: PLR2004 Magic value used in comparison, consider replacing `2000` with a constant variable
    |
114 |         detected = False
115 |
116 |         if spectral_centroid < 2000:  # Lower spectral centroid might indicate lisping
    |                                ^^^^ PLR2004
117 |             confidence = 0.65
118 |             detected = True
    |

src/infrastructure/external_services/speech_disorder_analyzer.py:148:34: PLR2004 Magic value used in comparison, consider replacing `0.2` with a constant variable
    |
147 |         if (
148 |             zero_crossing_rate > 0.2
    |                                  ^^^ PLR2004
149 |         ):  # High zero crossing rate might indicate articulation issues
150 |             confidence = 0.6
    |

src/infrastructure/external_services/speech_disorder_analyzer.py:181:36: PLR2004 Magic value used in comparison, consider replacing `100` with a constant variable
    |
179 |         detected = False
180 |
181 |         if fundamental_frequency < 100 or fundamental_frequency > 400:
    |                                    ^^^ PLR2004
182 |             confidence += 0.3
    |

src/infrastructure/external_services/speech_disorder_analyzer.py:181:67: PLR2004 Magic value used in comparison, consider replacing `400` with a constant variable
    |
179 |         detected = False
180 |
181 |         if fundamental_frequency < 100 or fundamental_frequency > 400:
    |                                                                   ^^^ PLR2004
182 |             confidence += 0.3
    |

src/infrastructure/external_services/speech_disorder_analyzer.py:184:24: PLR2004 Magic value used in comparison, consider replacing `45` with a constant variable
    |
182 |             confidence += 0.3
183 |
184 |         if intensity < 45 or intensity > 85:
    |                        ^^ PLR2004
185 |             confidence += 0.4
    |

src/infrastructure/external_services/speech_disorder_analyzer.py:184:42: PLR2004 Magic value used in comparison, consider replacing `85` with a constant variable
    |
182 |             confidence += 0.3
183 |
184 |         if intensity < 45 or intensity > 85:
    |                                          ^^ PLR2004
185 |             confidence += 0.4
    |

src/infrastructure/external_services/speech_disorder_analyzer.py:187:89: E501 Line too long (103 > 88)
    |
185 |             confidence += 0.4
186 |
187 |         detected = confidence > self.config.disorder_patterns["voice_disorder"]["confidence_threshold"]  # type: ignore
    |                                                                                         ^^^^^^^^^^^^^^^ E501
188 |
189 |         return {
    |

src/infrastructure/external_services/speech_disorder_analyzer.py:214:29: PLR2004 Magic value used in comparison, consider replacing `0.9` with a constant variable
    |
212 |         max_confidence = max(a["confidence"] for a in detected_disorders)
213 |
214 |         if max_confidence > 0.9:
    |                             ^^^ PLR2004
215 |             return "severe"
216 |         if max_confidence > 0.7:
    |

src/infrastructure/external_services/speech_disorder_analyzer.py:216:29: PLR2004 Magic value used in comparison, consider replacing `0.7` with a constant variable
    |
214 |         if max_confidence > 0.9:
215 |             return "severe"
216 |         if max_confidence > 0.7:
    |                             ^^^ PLR2004
217 |             return "moderate"
218 |         return "mild"
    |

src/infrastructure/external_services/speech_disorder_analyzer.py:224:39: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
    |
222 |         detected_disorders = [a for a in analyses if a["detected"]]
223 |
224 |         if len(detected_disorders) >= 2:  # Multiple disorders
    |                                       ^ PLR2004
225 |             return True
    |

src/infrastructure/external_services/speech_disorder_analyzer.py:227:9: SIM103 Return the condition directly
    |
225 |               return True
226 |
227 | /         if any(a["confidence"] > 0.8 for a in detected_disorders):  # High confidence
228 | |             return True
229 | |
230 | |         return False
    | |____________________^ SIM103
    |
    = help: Inline condition

src/infrastructure/external_services/speech_disorder_analyzer.py:227:34: PLR2004 Magic value used in comparison, consider replacing `0.8` with a constant variable
    |
225 |             return True
226 |
227 |         if any(a["confidence"] > 0.8 for a in detected_disorders):  # High confidence
    |                                  ^^^ PLR2004
228 |             return True
    |

src/infrastructure/external_services/speech_disorder_detector.py:14:1: E402 Module level import not at top of file
   |
12 | Main service interface for speech disorder detection"""
13 |
14 | from src.infrastructure.logging_config import get_logger
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
15 |
16 | logger = get_logger(__name__, component="infrastructure")
   |

src/infrastructure/external_services/speech_disorder_detector.py:51:89: E501 Line too long (124 > 88)
   |
50 |             logger.info(
51 |                 f"Speech disorder analysis completed. Found {len(analysis_result.get('disorders_detected', []))} disorders",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
52 |             )
53 |             return analysis_result
   |

src/infrastructure/external_services/speech_disorder_detector.py:53:13: TRY300 Consider moving this statement to an `else` block
   |
51 |                 f"Speech disorder analysis completed. Found {len(analysis_result.get('disorders_detected', []))} disorders",
52 |             )
53 |             return analysis_result
   |             ^^^^^^^^^^^^^^^^^^^^^^ TRY300
54 |         except Exception as e:
55 |             logger.error(f"Speech disorder analysis failed: {e}")
   |

src/infrastructure/external_services/speech_disorder_detector.py:55:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
53 |             return analysis_result
54 |         except Exception as e:
55 |             logger.error(f"Speech disorder analysis failed: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
56 |             return self._create_error_response(f"Analysis failed: {e!s}")
   |
   = help: Replace with `exception`

src/infrastructure/health/__init__.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """from .health_manager import HealthCheckManager, get_health_manager
2 | | from .models import HealthStatus, HealthCheckResult, SystemHealth.
3 | | """
  | |___^ D205
4 |
5 |   """Health monitoring system"""
  |
  = help: Insert single blank line

src/infrastructure/health/checks.py:101:36: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
 99 |             )
100 |         response_time = (asyncio.get_event_loop().time() - start_time) * 1000
101 |         if response.status_code == 200:
    |                                    ^^^ PLR2004
102 |             return DependencyCheck(
103 |                 name="openai",
    |

src/infrastructure/health/checks/database_check.py:9:1: TID252 Prefer absolute imports over relative imports from parent modules
   |
 7 | from src.infrastructure.logging_config import get_logger
 8 |
 9 | from ..models import HealthCheckResult, HealthStatus
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
10 |
11 | logger = get_logger(__name__, component="infrastructure")
   |
   = help: Replace relative imports from parent modules with absolute imports

src/infrastructure/health/checks/database_check.py:9:1: TID252 Prefer absolute imports over relative imports from parent modules
   |
 7 | from src.infrastructure.logging_config import get_logger
 8 |
 9 | from ..models import HealthCheckResult, HealthStatus
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
10 |
11 | logger = get_logger(__name__, component="infrastructure")
   |
   = help: Replace relative imports from parent modules with absolute imports

src/infrastructure/health/checks/database_check.py:42:89: E501 Line too long (102 > 88)
   |
40 |                 tables_result = await session.execute(
41 |                     text(
42 |                         "SELECT COUNT(*) FROM information_schema.tables WHERE table_schema = 'public'"
   |                                                                                         ^^^^^^^^^^^^^^ E501
43 |                     )
44 |                 )
   |

src/infrastructure/health/checks/database_check.py:65:31: PLR2004 Magic value used in comparison, consider replacing `100` with a constant variable
   |
64 |                 duration = (time.time() - start_time) * 1000
65 |                 if duration > 100:  # Slow query
   |                               ^^^ PLR2004
66 |                     status = HealthStatus.DEGRADED
67 |                     message = f"Database responding slowly ({duration:.0f}ms)"
   |

src/infrastructure/health/checks/database_check.py:85:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
83 |                 )
84 |         except Exception as e:
85 |             logger.error(f"Database health check failed: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
86 |             return HealthCheckResult(
87 |                 name="database",
   |
   = help: Replace with `exception`

src/infrastructure/health/checks/redis_check.py:10:1: TID252 Prefer absolute imports over relative imports from parent modules
   |
 8 | from src.infrastructure.logging_config import get_logger
 9 |
10 | from ..models import HealthCheckResult, HealthStatus
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
11 |
12 | logger = get_logger(__name__, component="infrastructure")
   |
   = help: Replace relative imports from parent modules with absolute imports

src/infrastructure/health/checks/redis_check.py:10:1: TID252 Prefer absolute imports over relative imports from parent modules
   |
 8 | from src.infrastructure.logging_config import get_logger
 9 |
10 | from ..models import HealthCheckResult, HealthStatus
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
11 |
12 | logger = get_logger(__name__, component="infrastructure")
   |
   = help: Replace relative imports from parent modules with absolute imports

src/infrastructure/health/checks/redis_check.py:49:17: TRY301 Abstract `raise` to an inner function
   |
48 |             if retrieved != test_value.encode():
49 |                 raise ValueError("Redis read/write test failed")
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
50 |
51 |             # Get Redis info
   |

src/infrastructure/health/checks/redis_check.py:49:23: TRY003 Avoid specifying long messages outside the exception class
   |
48 |             if retrieved != test_value.encode():
49 |                 raise ValueError("Redis read/write test failed")
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
50 |
51 |             # Get Redis info
   |

src/infrastructure/health/checks/redis_check.py:57:27: PLR2004 Magic value used in comparison, consider replacing `50` with a constant variable
   |
56 |             duration = (time.time() - start_time) * 1000
57 |             if duration > 50:  # Slow response
   |                           ^^ PLR2004
58 |                 status = HealthStatus.DEGRADED
59 |                 message = f"Redis responding slowly ({duration:.0f}ms)"
   |

src/infrastructure/health/checks/redis_check.py:77:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
75 |             )
76 |         except Exception as e:
77 |             logger.error(f"Redis health check failed: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
78 |             return HealthCheckResult(
79 |                 name="redis",
   |
   = help: Replace with `exception`

src/infrastructure/health/checks/system_check.py:10:1: TID252 Prefer absolute imports over relative imports from parent modules
   |
 8 | from src.infrastructure.logging_config import get_logger
 9 |
10 | from ..models import HealthCheckResult, HealthStatus
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
11 |
12 | logger = get_logger(__name__, component="infrastructure")
   |
   = help: Replace relative imports from parent modules with absolute imports

src/infrastructure/health/checks/system_check.py:10:1: TID252 Prefer absolute imports over relative imports from parent modules
   |
 8 | from src.infrastructure.logging_config import get_logger
 9 |
10 | from ..models import HealthCheckResult, HealthStatus
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
11 |
12 | logger = get_logger(__name__, component="infrastructure")
   |
   = help: Replace relative imports from parent modules with absolute imports

src/infrastructure/health/checks/system_check.py:37:30: PLR2004 Magic value used in comparison, consider replacing `90` with a constant variable
   |
35 |             # Determine status based on thresholds
36 |             issues = []
37 |             if cpu_percent > 90:
   |                              ^^ PLR2004
38 |                 issues.append(f"High CPU usage: {cpu_percent}%")
39 |             elif cpu_percent > 70:
   |

src/infrastructure/health/checks/system_check.py:39:32: PLR2004 Magic value used in comparison, consider replacing `70` with a constant variable
   |
37 |             if cpu_percent > 90:
38 |                 issues.append(f"High CPU usage: {cpu_percent}%")
39 |             elif cpu_percent > 70:
   |                                ^^ PLR2004
40 |                 issues.append(f"Elevated CPU usage: {cpu_percent}%")
   |

src/infrastructure/health/checks/system_check.py:42:33: PLR2004 Magic value used in comparison, consider replacing `90` with a constant variable
   |
40 |                 issues.append(f"Elevated CPU usage: {cpu_percent}%")
41 |
42 |             if memory_percent > 90:
   |                                 ^^ PLR2004
43 |                 issues.append(f"High memory usage: {memory_percent}%")
44 |             elif memory_percent > 80:
   |

src/infrastructure/health/checks/system_check.py:44:35: PLR2004 Magic value used in comparison, consider replacing `80` with a constant variable
   |
42 |             if memory_percent > 90:
43 |                 issues.append(f"High memory usage: {memory_percent}%")
44 |             elif memory_percent > 80:
   |                                   ^^ PLR2004
45 |                 issues.append(f"Elevated memory usage: {memory_percent}%")
   |

src/infrastructure/health/checks/system_check.py:47:31: PLR2004 Magic value used in comparison, consider replacing `90` with a constant variable
   |
45 |                 issues.append(f"Elevated memory usage: {memory_percent}%")
46 |
47 |             if disk_percent > 90:
   |                               ^^ PLR2004
48 |                 issues.append(f"Low disk space: {disk_free_gb:.1f}GB free")
49 |             elif disk_percent > 80:
   |

src/infrastructure/health/checks/system_check.py:49:33: PLR2004 Magic value used in comparison, consider replacing `80` with a constant variable
   |
47 |             if disk_percent > 90:
48 |                 issues.append(f"Low disk space: {disk_free_gb:.1f}GB free")
49 |             elif disk_percent > 80:
   |                                 ^^ PLR2004
50 |                 issues.append(f"Disk space warning: {disk_free_gb:.1f}GB free")
   |

src/infrastructure/health/checks/system_check.py:77:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
75 |             )
76 |         except Exception as e:
77 |             logger.error(f"System health check failed: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
78 |             return HealthCheckResult(
79 |                 name="system",
   |
   = help: Replace with `exception`

src/infrastructure/health/health_manager.py:146:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
144 |             }
145 |         except Exception as e:
146 |             logger.error(f"Liveness check failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
147 |             return {
148 |                 "alive": False,
    |
    = help: Replace with `exception`

src/infrastructure/health/health_manager.py:162:12: PLW0603 Using the global statement to update `_health_manager` is discouraged
    |
160 | ) -> HealthCheckManager:
161 |     """Get or create health check manager instance."""
162 |     global _health_manager
    |            ^^^^^^^^^^^^^^^ PLW0603
163 |     if _health_manager is None:
164 |         _health_manager = HealthCheckManager(config)
    |

src/infrastructure/lifespan.py:41:89: E501 Line too long (96 > 88)
   |
39 | @asynccontextmanager
40 | async def lifespan(app: FastAPI) -> AsyncGenerator[None, None]:
41 |     """Application lifespan manager with Hexagonal Architecture and production configuration."""
   |                                                                                         ^^^^^^^^ E501
42 |     settings = get_settings()
   |

src/infrastructure/lifespan.py:63:89: E501 Line too long (89 > 88)
   |
61 |         except OSError as e:
62 |             logger.warning(
63 |                 f"Could not start Prometheus metrics server: {e}. Port might be in use.",
   |                                                                                         ^ E501
64 |             )
   |

src/infrastructure/lifespan.py:86:19: TRY003 Avoid specifying long messages outside the exception class
   |
84 |         else:
85 |             logger.error("Kafka connection failed")
86 |             raise RuntimeError("Failed to connect to Kafka")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
87 |     else:
88 |         logger.info("Kafka disabled in this environment")
   |

src/infrastructure/logging/__init__.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Standardized Logging Infrastructure.
2 | | ==================================
3 | | Provides consistent logging patterns across all AI Teddy Bear services
4 | | with special focus on child safety and COPPA compliance logging.
5 | | """
  | |___^ D205
6 |
7 |   from .standards import (
  |
  = help: Insert single blank line

src/infrastructure/logging/standards.py:11:1: SyntaxError: Unexpected indentation
   |
11 |     """Standard log categories for the system."""
   | ^^^^
12 |
13 |     SECURITY = "SECURITY"
   |

src/infrastructure/logging/standards.py:23:1: SyntaxError: Expected a statement
   |
23 | class StandardizedLogger:
   | ^
24 |     """Standardized logger with consistent formatting and context."""
   |

src/infrastructure/logging_config.py:51:5: D205 1 blank line required between summary line and description
   |
49 |       log_file: str | None = None,
50 |   ) -> None:
51 | /     """Configures application-wide logging with consistent standards and security.
52 | |     Ensures sensitive data is not logged and appropriate verbosity is maintained.
53 | |
54 | |     Args:
55 | |         environment (str): The current operating environment (e.g., "production", "development").
56 | |         log_level (Optional[str]): The desired base logging level (e.g., "INFO", "DEBUG").
57 | |         log_file (Optional[str]): Path to a file for logging output. If None, logs to console only.
58 | |
59 | |     """
   | |_______^ D205
60 |       # Determine base log level
61 |       if log_level:
   |
   = help: Insert single blank line

src/infrastructure/logging_config.py:55:89: E501 Line too long (97 > 88)
   |
54 |     Args:
55 |         environment (str): The current operating environment (e.g., "production", "development").
   |                                                                                         ^^^^^^^^^ E501
56 |         log_level (Optional[str]): The desired base logging level (e.g., "INFO", "DEBUG").
57 |         log_file (Optional[str]): Path to a file for logging output. If None, logs to console only.
   |

src/infrastructure/logging_config.py:56:89: E501 Line too long (90 > 88)
   |
54 |     Args:
55 |         environment (str): The current operating environment (e.g., "production", "development").
56 |         log_level (Optional[str]): The desired base logging level (e.g., "INFO", "DEBUG").
   |                                                                                         ^^ E501
57 |         log_file (Optional[str]): Path to a file for logging output. If None, logs to console only.
   |

src/infrastructure/logging_config.py:57:89: E501 Line too long (99 > 88)
   |
55 |         environment (str): The current operating environment (e.g., "production", "development").
56 |         log_level (Optional[str]): The desired base logging level (e.g., "INFO", "DEBUG").
57 |         log_file (Optional[str]): Path to a file for logging output. If None, logs to console only.
   |                                                                                         ^^^^^^^^^^^ E501
58 |
59 |     """
   |

src/infrastructure/logging_config.py:177:89: E501 Line too long (91 > 88)
    |
175 |         event_type (str): A string identifying the type of security event
176 |                          (e.g., "LOGIN_FAILED", "UNAUTHORIZED_ACCESS").
177 |         details (Dict[str, Any]): A dictionary containing relevant details about the event.
    |                                                                                         ^^^ E501
178 |                                  Sensitive data should be pre-redacted.
179 |         severity (str): The severity level of the event
    |

src/infrastructure/logging_config.py:197:5: D205 1 blank line required between summary line and description
    |
196 |   class ChildSafetyFilter(logging.Filter):
197 | /     """Redacts sensitive information from log records to protect child privacy.
198 | |     This filter inspects log messages and arguments, applying redaction rules
199 | |     to prevent Personally Identifiable Information (PII) from being written
200 | |     to logs. It is crucial for maintaining COPPA compliance and data privacy.
201 | |     """
    | |_______^ D205
202 |
203 |       def filter(self, record: logging.LogRecord) -> bool:
    |
    = help: Insert single blank line

src/infrastructure/logging_config.py:247:16: RET504 Unnecessary assignment to `message` before `return` statement
    |
245 |             message,
246 |         )  # Social Security Numbers (example pattern)
247 |         return message
    |                ^^^^^^^ RET504
    |
    = help: Remove unnecessary assignment

src/infrastructure/logging_config.py:251:5: D205 1 blank line required between summary line and description
    |
250 |   class ProductionFormatter(logging.Formatter):
251 | /     """A custom log formatter for production environments.
252 | |     This formatter is designed to:
253 | |     - Omit function names and line numbers to avoid leaking code structure.
254 | |     - Format logs as JSON for easier parsing by log management systems.
255 | |     - Ensure sensitive data is handled by `ChildSafetyFilter` before formatting.
256 | |     """
    | |_______^ D205
257 |
258 |       def format(self, record: logging.LogRecord) -> str:
    |
    = help: Insert single blank line

src/infrastructure/logging_config.py:267:89: E501 Line too long (104 > 88)
    |
265 |         if record.exc_info:
266 |             log_object["exc_info"] = self.formatException(record.exc_info)
267 |         # If there are specific extra fields intended for logging, they should be explicitly added here.
    |                                                                                         ^^^^^^^^^^^^^^^^ E501
268 |         # For security and privacy, avoid automatically including all of record.__dict__.
269 |         # Sensitive data should be handled by ChildSafetyFilter before reaching
    |

src/infrastructure/logging_config.py:268:89: E501 Line too long (89 > 88)
    |
266 |             log_object["exc_info"] = self.formatException(record.exc_info)
267 |         # If there are specific extra fields intended for logging, they should be explicitly added here.
268 |         # For security and privacy, avoid automatically including all of record.__dict__.
    |                                                                                         ^ E501
269 |         # Sensitive data should be handled by ChildSafetyFilter before reaching
270 |         # the formatter.
    |

src/infrastructure/logging_config.py:280:5: D205 1 blank line required between summary line and description
    |
278 |       details: dict[str, Any] | None = None,
279 |   ) -> None:
280 | /     """Logs child interactions with enhanced privacy protection using BLAKE2b hashing.
281 | |     This function ensures that child IDs are hashed before logging to protect privacy,
282 | |     and includes relevant interaction details for auditing and analysis.
283 | |
284 | |     Args:
285 | |         interaction_type (str): The type of interaction (e.g., "AI_RESPONSE", "AUDIO_INPUT").
286 | |         child_id (str): The unique identifier of the child. This will be hashed before logging.
287 | |         safe (bool): Indicates whether the interaction was deemed safe by content filters.
288 | |         details (Optional[Dict[str, Any]]): Additional details about the interaction,
289 | |                                            which will be sanitized.
290 | |
291 | |     """
    | |_______^ D205
292 |       child_logger = logging.getLogger("src.child_safety")
293 |       # Use a more secure hashing algorithm for the child ID
    |
    = help: Insert single blank line

src/infrastructure/logging_config.py:285:89: E501 Line too long (93 > 88)
    |
284 |     Args:
285 |         interaction_type (str): The type of interaction (e.g., "AI_RESPONSE", "AUDIO_INPUT").
    |                                                                                         ^^^^^ E501
286 |         child_id (str): The unique identifier of the child. This will be hashed before logging.
287 |         safe (bool): Indicates whether the interaction was deemed safe by content filters.
    |

src/infrastructure/logging_config.py:286:89: E501 Line too long (95 > 88)
    |
284 |     Args:
285 |         interaction_type (str): The type of interaction (e.g., "AI_RESPONSE", "AUDIO_INPUT").
286 |         child_id (str): The unique identifier of the child. This will be hashed before logging.
    |                                                                                         ^^^^^^^ E501
287 |         safe (bool): Indicates whether the interaction was deemed safe by content filters.
288 |         details (Optional[Dict[str, Any]]): Additional details about the interaction,
    |

src/infrastructure/logging_config.py:287:89: E501 Line too long (90 > 88)
    |
285 |         interaction_type (str): The type of interaction (e.g., "AI_RESPONSE", "AUDIO_INPUT").
286 |         child_id (str): The unique identifier of the child. This will be hashed before logging.
287 |         safe (bool): Indicates whether the interaction was deemed safe by content filters.
    |                                                                                         ^^ E501
288 |         details (Optional[Dict[str, Any]]): Additional details about the interaction,
289 |                                            which will be sanitized.
    |

src/infrastructure/messaging/audio_streamer.py:36:17: TRY400 Use `logging.exception` instead of `logging.error`
   |
34 |                     yield data
35 |             except Exception as e:
36 |                 logger.error(f"Error receiving audio from {child_id}: {e}")
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
   |
   = help: Replace with `exception`

src/infrastructure/messaging/esp32_handler.py:26:12: RET504 Unnecessary assignment to `response` before `return` statement
   |
24 |     request.audio_data = audio_data_bytes  # Update the request with bytes
25 |     response = await process_audio_use_case.execute(request)
26 |     return response
   |            ^^^^^^^^ RET504
   |
   = help: Remove unnecessary assignment

src/infrastructure/messaging/esp32_handler.py:50:9: TRY400 Use `logging.exception` instead of `logging.error`
   |
48 |         logger.info(f"Client {child_id} disconnected")
49 |     except Exception as e:
50 |         logger.error(f"WebSocket error for {child_id}: {e}")
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
   |
   = help: Replace with `exception`

src/infrastructure/messaging/event_driven_architecture.py:53:15: TRY003 Avoid specifying long messages outside the exception class
   |
51 |         if handler:
52 |             return await handler.handle(command)
53 |         raise ValueError(f"No handler registered for command type {type(command)}")
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
   |

src/infrastructure/messaging/event_driven_architecture.py:77:15: TRY003 Avoid specifying long messages outside the exception class
   |
75 |             self.cache[query_key] = result
76 |             return result
77 |         raise ValueError(f"No handler registered for query type {type(query)}")
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
   |

src/infrastructure/messaging/kafka_event_bus.py:27:11: TRY003 Avoid specifying long messages outside the exception class
   |
25 |       logger.critical("Install required dependencies: pip install confluent-kafka")
26 |       logger.critical("Kafka event bus functionality will be disabled")
27 |       raise ImportError(
   |  ___________^
28 | |         "Missing required dependency for Kafka event bus: confluent-kafka. Install with 'pip install confluent-kafka'"
29 | |     ) from e
   | |_____^ TRY003
30 |
31 |   from src.domain.events.domain_events import DomainEvent
   |

src/infrastructure/messaging/kafka_event_bus.py:28:89: E501 Line too long (118 > 88)
   |
26 |     logger.critical("Kafka event bus functionality will be disabled")
27 |     raise ImportError(
28 |         "Missing required dependency for Kafka event bus: confluent-kafka. Install with 'pip install confluent-kafka'"
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
29 |     ) from e
   |

src/infrastructure/messaging/kafka_event_bus.py:72:9: D415 First line should end with a period, question mark, or exclamation point
   |
71 |     async def publish(self, event: DomainEvent) -> None:
72 |         """Publish message to Kafka"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
73 |         if not self.connected:
74 |             raise ConnectionError("Kafka not connected")
   |
   = help: Add closing punctuation

src/infrastructure/messaging/kafka_event_bus.py:74:19: TRY003 Avoid specifying long messages outside the exception class
   |
72 |         """Publish message to Kafka"""
73 |         if not self.connected:
74 |             raise ConnectionError("Kafka not connected")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
75 |         if not self.producer:
76 |             await self._attempt_connection()
   |

src/infrastructure/messaging/kafka_event_bus.py:109:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
107 |                 self.producer.poll(0)
108 |         except Exception as e:
109 |             logger.error(f"Failed to produce message to topic {topic}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
110 |
111 |     def subscribe(
    |
    = help: Replace with `exception`

src/infrastructure/messaging/kafka_event_bus.py:127:43: ARG005 Unused lambda argument: `ctx`
    |
125 |                     schema_registry_client=self.schema_registry_client,
126 |                     schema_str=None,
127 |                     from_dict=lambda obj, ctx: (
    |                                           ^^^ ARG005
128 |                         event_type(**obj) if isinstance(obj, dict) else obj
129 |                     ),
    |

src/infrastructure/messaging/kafka_event_bus.py:159:21: TRY400 Use `logging.exception` instead of `logging.error`
    |
157 |                         logger.warning(f"No deserializer found for topic {topic}")
158 |                 except Exception as e:
159 |                     logger.error(f"Failed to process message: {e}")
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
160 |                     continue
161 |             await asyncio.sleep(0.1)
    |
    = help: Replace with `exception`

src/infrastructure/messaging/kafka_event_bus.py:173:89: E501 Line too long (97 > 88)
    |
171 |         else:
172 |             logger.debug(
173 |                 f"Message delivered to {msg.topic()} [{msg.partition()}] @ offset {msg.offset()}"
    |                                                                                         ^^^^^^^^^ E501
174 |             )
    |

src/infrastructure/messaging/kafka_event_bus.py:177:35: ARG002 Unused method argument: `ctx`
    |
176 |     def _event_to_dict(
177 |         self, event: DomainEvent, ctx: SerializationContext
    |                                   ^^^ ARG002
178 |     ) -> dict[str, Any]:
179 |         # Convert dataclass to dictionary for Avro serialization
    |

src/infrastructure/messaging/kafka_event_bus.py:185:9: D415 First line should end with a period, question mark, or exclamation point
    |
184 |     def __del__(self):
185 |         """Cleanup resources when instance is destroyed"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
186 |         try:
187 |             if hasattr(self, "running") and self.running:
    |
    = help: Add closing punctuation

src/infrastructure/messaging/kafka_event_bus.py:189:9: S110 `try`-`except`-`pass` detected, consider logging the exception
    |
187 |               if hasattr(self, "running") and self.running:
188 |                   self.stop_consuming()
189 | /         except Exception:
190 | |             # Ignore errors during cleanup
191 | |             pass
    | |________________^ S110
    |

src/infrastructure/middleware/__init__.py:3:1: I001 [*] Import block is un-sorted or un-formatted
   |
 1 |   """Middleware configuration for FastAPI application."""
 2 |
 3 | / from fastapi import FastAPI
 4 | | from fastapi.middleware.cors import CORSMiddleware
 5 | | from fastapi.middleware.httpsredirect import HTTPSRedirectMiddleware
 6 | | from fastapi.middleware.trustedhost import TrustedHostMiddleware
 7 | |
 8 | | from src.infrastructure.config.application_settings import ApplicationSettings
 9 | | from src.infrastructure.config.settings import get_settings
10 | | from src.infrastructure.logging_config import get_logger
11 | | from src.presentation.api.middleware.error_handling import ErrorHandlingMiddleware
12 | | from src.presentation.api.middleware.request_logging import RequestLoggingMiddleware
13 | | from src.presentation.api.middleware.rate_limit_middleware import (
14 | |     RateLimitMiddleware as ChildSafetyMiddleware,
15 | | )
16 | |
17 | | from src.infrastructure.middleware.security.headers import (
18 | |     SecurityHeadersMiddleware
19 | | )
   | |_^ I001
20 |
21 |   logger = get_logger(__name__, component="infrastructure")
   |
   = help: Organize imports

src/infrastructure/middleware/__init__.py:25:5: D205 1 blank line required between summary line and description
   |
24 |   def setup_middleware(app: FastAPI) -> None:
25 | /     """Setup comprehensive middleware stack for child safety and security.
26 | |     Middleware order is critical - applied in reverse order(last added=first executed)
27 | |     Args: app: FastAPI application instance.
28 | |     """
   | |_______^ D205
29 |       settings = get_settings()
30 |       is_production = settings.application.ENVIRONMENT == "production"
   |
   = help: Insert single blank line

src/infrastructure/middleware/__init__.py:50:24: F821 Undefined name `RateLimitMiddleware`
   |
49 |     # 5. Rate Limiting Middleware
50 |     app.add_middleware(RateLimitMiddleware)
   |                        ^^^^^^^^^^^^^^^^^^^ F821
51 |     logger.info("✅ Rate limiting middleware configured")
   |

src/infrastructure/middleware/__init__.py:97:5: D205 1 blank line required between summary line and description
    |
 95 |       is_production: bool,
 96 |   ) -> list[str]:
 97 | /     """Get CORS allowed origins based on environment with security validation.
 98 | |     Args: app_settings: Application settings
 99 | |         is_production: Whether running in production
100 | |     Returns: List of allowed CORS origins
101 | |     Raises: ValueError: If insecure CORS configuration is detected.
102 | |     """
    | |_______^ D205
103 |       if is_production:
104 |           # In production, CORS_ORIGINS must be explicitly configured and secure.
    |
    = help: Insert single blank line

src/infrastructure/middleware/__init__.py:128:5: D205 1 blank line required between summary line and description
    |
127 |   def _validate_cors_origins(origins: list[str], is_production: bool) -> None:
128 | /     """Validate CORS origins for security compliance.
129 | |     Args: origins: List of CORS origins to validate
130 | |         is_production: Whether running in production
131 | |     Raises: ValueError: If insecure configuration is detected.
132 | |     """
    | |_______^ D205
133 |       for origin in origins:
134 |           if is_production and origin == "*":
    |
    = help: Insert single blank line

src/infrastructure/middleware/__init__.py:135:19: TRY003 Avoid specifying long messages outside the exception class
    |
133 |       for origin in origins:
134 |           if is_production and origin == "*":
135 |               raise ValueError(
    |  ___________________^
136 | |                 "Wildcard CORS origin (*) not allowed in production for child safety",
137 | |             )
    | |_____________^ TRY003
138 |           if is_production and not origin.startswith("https://"):
139 |               raise ValueError(
    |

src/infrastructure/middleware/__init__.py:139:19: TRY003 Avoid specifying long messages outside the exception class
    |
137 |               )
138 |           if is_production and not origin.startswith("https://"):
139 |               raise ValueError(
    |  ___________________^
140 | |                 f"Non-HTTPS origin '{origin}' not allowed in production: {origin}",
141 | |             )
    | |_____________^ TRY003
142 |           suspicious_patterns = ["javascript:", "data:", "file:", "ftp://"]
143 |           if any(pattern in origin.lower() for pattern in suspicious_patterns):
    |

src/infrastructure/middleware/__init__.py:144:19: TRY003 Avoid specifying long messages outside the exception class
    |
142 |         suspicious_patterns = ["javascript:", "data:", "file:", "ftp://"]
143 |         if any(pattern in origin.lower() for pattern in suspicious_patterns):
144 |             raise ValueError(f"Suspicious origin pattern detected: {origin}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
145 |     logger.info(f"CORS origins validation passed: {len(origins)} origins validated")
    |

src/infrastructure/middleware/__init__.py:149:5: D205 1 blank line required between summary line and description
    |
148 |   def _get_trusted_hosts(app_settings: ApplicationSettings) -> list[str]:
149 | /     """Get trusted hosts for production deployment.
150 | |     Args: app_settings: Application settings
151 | |     Returns: List of trusted host patterns.
152 | |     """
    | |_______^ D205
153 |       if app_settings.TRUSTED_HOSTS:
154 |           return app_settings.TRUSTED_HOSTS
    |
    = help: Insert single blank line

src/infrastructure/middleware/__init__.py:160:5: D205 1 blank line required between summary line and description
    |
159 |   def _log_middleware_summary(is_production: bool, cors_origins: list[str]) -> None:
160 | /     """Log summary of middleware configuration.
161 | |     Args: is_production: Whether running in production
162 | |         cors_origins: Configured CORS origins.
163 | |     """
    | |_______^ D205
164 |       logger.info("🔒 Middleware Configuration Summary:")
165 |       logger.info(f"   • Environment: {'Production' if is_production else 'Development'}")
    |
    = help: Insert single blank line

src/infrastructure/middleware/__init__.py:173:87: E501 Line too long (91 > 88)
    |
171 |     logger.info(f"   • CORS Origins: {len(cors_origins)} configured")
172 |     logger.info(
173 |         f"   • HTTPS Redirect: {'✅ Enabled' if is_production else '❌ Development Only'}",
    |                                                                                         ^^^ E501
174 |     )
175 |     logger.info(
    |

src/infrastructure/middleware/__init__.py:176:87: E501 Line too long (90 > 88)
    |
174 |     )
175 |     logger.info(
176 |         f"   • Trusted Hosts: {'✅ Enabled' if is_production else '❌ Development Only'}",
    |                                                                                         ^^ E501
177 |     )
178 |     logger.info("🧸 AI Teddy Bear middleware stack ready for child-safe interactions!")
    |

src/infrastructure/middleware/security/headers.py:3:89: E501 Line too long (90 > 88)
  |
1 | """Enhanced Security Headers Middleware for AI Teddy Bear.
2 |
3 | Consolidated implementation combining all valuable features from scattered implementations
  |                                                                                         ^^ E501
4 | while maintaining clean architecture and child safety compliance.
5 | """
  |

src/infrastructure/middleware/security/headers.py:7:1: I001 [*] Import block is un-sorted or un-formatted
   |
 5 |   """
 6 |
 7 | / import time
 8 | | import uuid
 9 | | from dataclasses import dataclass, field
10 | | from typing import Any
11 | |
12 | | from fastapi import Request, Response
13 | | from starlette.middleware.base import BaseHTTPMiddleware
14 | | from starlette.middleware.base import RequestResponseEndpoint
15 | |
16 | | from src.infrastructure.config.settings import get_settings
17 | | from src.infrastructure.logging_config import get_logger
   | |________________________________________________________^ I001
18 |
19 |   logger = get_logger(__name__, component="security")
   |
   = help: Organize imports

src/infrastructure/middleware/security/headers.py:83:89: E501 Line too long (91 > 88)
   |
82 | class SecurityHeadersMiddleware(BaseHTTPMiddleware):
83 |     """Enhanced FastAPI middleware for comprehensive security headers with child safety."""
   |                                                                                         ^^^ E501
84 |
85 |     def __init__(self, app, config: SecurityHeadersConfig = None):
   |

src/infrastructure/middleware/security/headers.py:88:1: W293 [*] Blank line contains whitespace
   |
86 |         super().__init__(app)
87 |         self.config = config or SecurityHeadersConfig()
88 |         
   | ^^^^^^^^ W293
89 |         # Load environment settings
90 |         try:
   |
   = help: Remove whitespace from blank line

src/infrastructure/middleware/security/headers.py:92:89: E501 Line too long (89 > 88)
   |
90 |         try:
91 |             settings = get_settings()
92 |             self.environment = getattr(settings.application, "ENVIRONMENT", "production")
   |                                                                                         ^ E501
93 |             self.is_production = self.environment == "production"
94 |         except Exception as e:
   |

src/infrastructure/middleware/security/headers.py:105:89: E501 Line too long (95 > 88)
    |
103 |         logger.info(
104 |             f"Enhanced security headers middleware initialized "
105 |             f"(environment: {self.environment}, child_safety: {self.config.child_safety_mode})"
    |                                                                                         ^^^^^^^ E501
106 |         )
    |

src/infrastructure/middleware/security/headers.py:117:1: W293 [*] Blank line contains whitespace
    |
115 |         start_time = time.time()
116 |         request_id = str(uuid.uuid4())
117 |         
    | ^^^^^^^^ W293
118 |         # Store request context
119 |         request.state.request_id = request_id
    |
    = help: Remove whitespace from blank line

src/infrastructure/middleware/security/headers.py:132:13: TRY300 Consider moving this statement to an `else` block
    |
130 |             self._track_performance(start_time)
131 |
132 |             return response
    |             ^^^^^^^^^^^^^^^ TRY300
133 |
134 |         except Exception as e:
    |

src/infrastructure/middleware/security/headers.py:135:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
134 |         except Exception as e:
135 |             logger.error(f"Security middleware error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
136 |             
137 |             # Create safe error response with security headers
    |
    = help: Replace with `exception`

src/infrastructure/middleware/security/headers.py:136:1: W293 [*] Blank line contains whitespace
    |
134 |         except Exception as e:
135 |             logger.error(f"Security middleware error: {e}")
136 |             
    | ^^^^^^^^^^^^ W293
137 |             # Create safe error response with security headers
138 |             error_response = self._create_safe_error_response(str(e))
    |
    = help: Remove whitespace from blank line

src/infrastructure/middleware/security/headers.py:141:1: W293 [*] Blank line contains whitespace
    |
139 |             self._apply_basic_security_headers(error_response)
140 |             self._add_request_tracking_headers(request, error_response)
141 |             
    | ^^^^^^^^^^^^ W293
142 |             return error_response
    |
    = help: Remove whitespace from blank line

src/infrastructure/middleware/security/headers.py:149:1: W293 [*] Blank line contains whitespace
    |
147 |             # Core security headers
148 |             self._apply_core_security_headers(response)
149 |             
    | ^^^^^^^^^^^^ W293
150 |             # Child-specific protection if enabled
151 |             if self.config.child_safety_mode and self._is_child_request(request):
    |
    = help: Remove whitespace from blank line

src/infrastructure/middleware/security/headers.py:153:1: W293 [*] Blank line contains whitespace
    |
151 |             if self.config.child_safety_mode and self._is_child_request(request):
152 |                 self._apply_enhanced_child_protection(response)
153 |             
    | ^^^^^^^^^^^^ W293
154 |             # Request tracking headers
155 |             self._add_request_tracking_headers(request, response)
    |
    = help: Remove whitespace from blank line

src/infrastructure/middleware/security/headers.py:156:1: W293 [*] Blank line contains whitespace
    |
154 |             # Request tracking headers
155 |             self._add_request_tracking_headers(request, response)
156 |             
    | ^^^^^^^^^^^^ W293
157 |             # Environment-specific headers
158 |             self._add_environment_headers(response)
    |
    = help: Remove whitespace from blank line

src/infrastructure/middleware/security/headers.py:161:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
160 |         except Exception as e:
161 |             logger.error(f"Error applying security headers: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
162 |             # Fallback to basic headers
163 |             self._apply_basic_security_headers(response)
    |
    = help: Replace with `exception`

src/infrastructure/middleware/security/headers.py:238:89: E501 Line too long (90 > 88)
    |
236 |             response.headers[header] = value
237 |
238 |     def _add_request_tracking_headers(self, request: Request, response: Response) -> None:
    |                                                                                         ^^ E501
239 |         """Add request tracking and performance headers."""
240 |         # Request ID for tracking
    |

src/infrastructure/middleware/security/headers.py:255:1: W293 [*] Blank line contains whitespace
    |
253 |         """Add environment-specific headers."""
254 |         response.headers["X-Environment"] = self.environment
255 |         
    | ^^^^^^^^ W293
256 |         if not self.is_production:
257 |             response.headers["X-Development-Mode"] = "true"
    |
    = help: Remove whitespace from blank line

src/infrastructure/middleware/security/headers.py:259:9: PLR0911 Too many return statements (7 > 6)
    |
257 |             response.headers["X-Development-Mode"] = "true"
258 |
259 |     def _is_child_request(self, request: Request) -> bool:
    |         ^^^^^^^^^^^^^^^^^ PLR0911
260 |         """Enhanced child request detection logic."""
261 |         try:
    |

src/infrastructure/middleware/security/headers.py:272:21: TRY300 Consider moving this statement to an `else` block
    |
270 |                 try:
271 |                     age = int(child_age)
272 |                     return age <= 13  # COPPA age limit
    |                     ^^^^^^^^^^^^^^^^ TRY300
273 |                 except (ValueError, TypeError):
274 |                     pass
    |

src/infrastructure/middleware/security/headers.py:272:35: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
    |
270 |                 try:
271 |                     age = int(child_age)
272 |                     return age <= 13  # COPPA age limit
    |                                   ^^ PLR2004
273 |                 except (ValueError, TypeError):
274 |                     pass
    |

src/infrastructure/middleware/security/headers.py:288:89: E501 Line too long (90 > 88)
    |
286 |             ]
287 |
288 |             if any(request.url.path.startswith(endpoint) for endpoint in child_endpoints):
    |                                                                                         ^^ E501
289 |                 return True
    |

src/infrastructure/middleware/security/headers.py:320:43: ARG002 Unused method argument: `error_msg`
    |
318 |             )
319 |
320 |     def _create_safe_error_response(self, error_msg: str) -> Response:
    |                                           ^^^^^^^^^ ARG002
321 |         """Create a safe error response with child-friendly messaging."""
322 |         safe_message = "Oops! Something went wrong. Please try again later."
    |

src/infrastructure/middleware/security/headers.py:410:89: E501 Line too long (106 > 88)
    |
409 | # Factory functions for backward compatibility and easy setup
410 | def create_security_headers_middleware(config: SecurityHeadersConfig = None) -> SecurityHeadersMiddleware:
    |                                                                                         ^^^^^^^^^^^^^^^^^^ E501
411 |     """Factory function to create security headers middleware."""
412 |     if config is None:
    |

src/infrastructure/middleware/security/headers.py:414:1: W293 [*] Blank line contains whitespace
    |
412 |     if config is None:
413 |         config = SecurityHeadersConfig()
414 |     
    | ^^^^ W293
415 |     # Create a dummy app for the middleware - this will be replaced when added to actual app
416 |     class DummyApp:
    |
    = help: Remove whitespace from blank line

src/infrastructure/middleware/security/headers.py:415:89: E501 Line too long (92 > 88)
    |
413 |         config = SecurityHeadersConfig()
414 |     
415 |     # Create a dummy app for the middleware - this will be replaced when added to actual app
    |                                                                                         ^^^^ E501
416 |     class DummyApp:
417 |         pass
    |

src/infrastructure/middleware/security/headers.py:418:1: W293 [*] Blank line contains whitespace
    |
416 |     class DummyApp:
417 |         pass
418 |     
    | ^^^^ W293
419 |     return SecurityHeadersMiddleware(DummyApp(), config)
    |
    = help: Remove whitespace from blank line

src/infrastructure/middleware/security/headers.py:422:89: E501 Line too long (89 > 88)
    |
422 | def get_security_headers_config(child_safety_mode: bool = True) -> SecurityHeadersConfig:
    |                                                                                         ^ E501
423 |     """Get default security headers configuration."""
424 |     config = SecurityHeadersConfig()
    |

src/infrastructure/middleware/security/headers.py:440:37: ARG001 Unused function argument: `environment`
    |
439 | # Backward compatibility aliases
440 | def create_security_middleware(app, environment: str = "production") -> SecurityHeadersMiddleware:
    |                                     ^^^^^^^^^^^ ARG001
441 |     """Backward compatibility factory for presentation layer."""
442 |     config = SecurityHeadersConfig()
    |

src/infrastructure/middleware/security/headers.py:440:89: E501 Line too long (98 > 88)
    |
439 | # Backward compatibility aliases
440 | def create_security_middleware(app, environment: str = "production") -> SecurityHeadersMiddleware:
    |                                                                                         ^^^^^^^^^^ E501
441 |     """Backward compatibility factory for presentation layer."""
442 |     config = SecurityHeadersConfig()
    |

src/infrastructure/middleware/security/headers.py:454:22: W292 [*] No newline at end of file
    |
452 |         "🧸 AI Teddy Bear security middleware created with enhanced child protection"
453 |     )
454 |     return middleware
    |                      ^ W292
    |
    = help: Add trailing newline

src/infrastructure/monitoring/__init__.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Comprehensive Monitoring Infrastructure Package
2 | | Enterprise-grade monitoring and alerting for AI Teddy Bear backend.
3 | | """
  | |___^ D205
4 |   from .components.types import (
5 |       Alert,
  |
  = help: Insert single blank line

src/infrastructure/monitoring/__init__.py:4:1: I001 [*] Import block is un-sorted or un-formatted
   |
 2 |   Enterprise-grade monitoring and alerting for AI Teddy Bear backend.
 3 |   """
 4 | / from .components.types import (
 5 | |     Alert,
 6 | |     AlertSeverity,
 7 | |     AlertStatus,
 8 | |     MetricType,
 9 | |     MetricValue,
10 | | )
11 | |
12 | | from .comprehensive_monitoring import ChildSafetyMonitor
13 | | from .components.monitoring_service import ComprehensiveMonitoringService
   | |_________________________________________________________________________^ I001
14 |
15 |   __all__ = [
   |
   = help: Organize imports

src/infrastructure/monitoring/__init__.py:15:11: RUF022 [*] `__all__` is not sorted
   |
13 |   from .components.monitoring_service import ComprehensiveMonitoringService
14 |
15 |   __all__ = [
   |  ___________^
16 | |     "Alert",
17 | |     "AlertSeverity", 
18 | |     "AlertStatus",
19 | |     "ChildSafetyMonitor",
20 | |     "MetricType",
21 | |     "MetricValue",
22 | |     "ComprehensiveMonitoringService",
23 | | ]
   | |_^ RUF022
   |
   = help: Apply an isort-style sorting to `__all__`

src/infrastructure/monitoring/__init__.py:17:21: W291 [*] Trailing whitespace
   |
15 | __all__ = [
16 |     "Alert",
17 |     "AlertSeverity", 
   |                     ^ W291
18 |     "AlertStatus",
19 |     "ChildSafetyMonitor",
   |
   = help: Remove trailing whitespace

src/infrastructure/monitoring/components/child_safety_monitor.py:77:53: ARG002 Unused method argument: `event_type`
   |
75 |         # to parents, administrators, and possibly authorities
76 |
77 |     def _check_safety_patterns(self, child_id: str, event_type: str) -> None:
   |                                                     ^^^^^^^^^^ ARG002
78 |         """Check for concerning patterns in child safety events."""
79 |         now = datetime.utcnow()
   |

src/infrastructure/monitoring/components/child_safety_monitor.py:126:89: E501 Line too long (90 > 88)
    |
124 |         self.safety_alerts[alert_id] = pattern_alert
125 |         logger.error(
126 |             f"Pattern alert created: {pattern_type} for child {child_id} (count: {count})"
    |                                                                                         ^^ E501
127 |         )
    |

src/infrastructure/monitoring/components/monitoring_service.py:16:5: D205 1 blank line required between summary line and description
   |
15 |   class ComprehensiveMonitoringService:
16 | /     """Enterprise monitoring service with child safety focus.
17 | |     Features:
18 | |     - Real - time metrics collection
19 | |     - Child safety event monitoring
20 | |     - Performance metrics tracking
21 | |     - Security event detection
22 | |     - Automated alerting
23 | |     - COPPA compliance monitoring
24 | |     """
   | |_______^ D205
25 |
26 |       def __init__(self) -> None:
   |
   = help: Insert single blank line

src/infrastructure/monitoring/components/monitoring_service.py:16:5: D415 First line should end with a period, question mark, or exclamation point
   |
15 |   class ComprehensiveMonitoringService:
16 | /     """Enterprise monitoring service with child safety focus.
17 | |     Features:
18 | |     - Real - time metrics collection
19 | |     - Child safety event monitoring
20 | |     - Performance metrics tracking
21 | |     - Security event detection
22 | |     - Automated alerting
23 | |     - COPPA compliance monitoring
24 | |     """
   | |_______^ D415
25 |
26 |       def __init__(self) -> None:
   |
   = help: Add closing punctuation

src/infrastructure/monitoring/components/monitoring_service.py:106:27: PLR2004 Magic value used in comparison, consider replacing `400` with a constant variable
    |
105 |         # Track errors
106 |         if status_code >= 400:
    |                           ^^^ PLR2004
107 |             self.error_counts[endpoint] += 1
    |

src/infrastructure/monitoring/components/monitoring_service.py:131:55: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
    |
130 |             # Alert on excessive failures
131 |             if self.failed_auth_attempts[client_ip] > 10:
    |                                                       ^^ PLR2004
132 |                 self._create_alert(
133 |                     f"excessive_auth_failures_{client_ip}",
    |

src/infrastructure/monitoring/components/monitoring_service.py:234:9: PLR0913 Too many arguments in function definition (7 > 5)
    |
232 |                     )
233 |
234 |     def _create_alert(
    |         ^^^^^^^^^^^^^ PLR0913
235 |         self,
236 |         alert_id: str,
    |

src/infrastructure/monitoring/components/monitoring_service.py:269:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
267 |                 time.sleep(60)  # Check every minute
268 |             except Exception as e:
269 |                 logger.error(f"Error in monitoring loop: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
270 |                 time.sleep(30)  # Shorter sleep on error
    |
    = help: Replace with `exception`

src/infrastructure/monitoring/components/monitoring_service.py:278:83: PLR2004 Magic value used in comparison, consider replacing `400` with a constant variable
    |
276 |             total_requests = len(self.request_times)
277 |             error_requests = sum(
278 |                 1 for req in self.request_times if req.get("status_code", 200) >= 400
    |                                                                                   ^^^ PLR2004
279 |             )
280 |             error_rate = error_requests / total_requests if total_requests > 0 else 0
    |

src/infrastructure/monitoring/components/monitoring_service.py:305:13: B007 Loop control variable `alert_id` not used within loop body
    |
304 |         # Auto-resolve old alerts
305 |         for alert_id, alert in list(self.alerts.items()):
    |             ^^^^^^^^ B007
306 |             if alert.created_at < cutoff_time and alert.status == AlertStatus.ACTIVE:
307 |                 alert.status = AlertStatus.RESOLVED
    |
    = help: Rename unused `alert_id` to `_alert_id`

src/infrastructure/monitoring/components/monitoring_service.py:331:79: PLR2004 Magic value used in comparison, consider replacing `400` with a constant variable
    |
330 |         error_count = sum(
331 |             1 for req in self.request_times if req.get("status_code", 200) >= 400
    |                                                                               ^^^ PLR2004
332 |         )
333 |         return error_count / len(self.request_times)
    |

src/infrastructure/monitoring/comprehensive_monitoring_refactored.py:54:17: TRY300 Consider moving this statement to an `else` block
   |
52 |                 result = func(*args, **kwargs)
53 |                 self.log_event(f"{func.__name__}_succeeded", {})
54 |                 return result
   |                 ^^^^^^^^^^^^^ TRY300
55 |             except Exception as e:
56 |                 self.log_event(f"{func.__name__}_failed", {"error": str(e)})
   |

src/infrastructure/monitoring/comprehensive_monitoring_refactored.py:74:17: TRY300 Consider moving this statement to an `else` block
   |
72 |                 result = await coro(*args, **kwargs)
73 |                 self.log_event(f"{coro.__name__}_succeeded", {})
74 |                 return result
   |                 ^^^^^^^^^^^^^ TRY300
75 |             except Exception as e:
76 |                 self.log_event(f"{coro.__name__}_failed", {"error": str(e)})
   |

src/infrastructure/monitoring/performance_monitor.py:28:13: TRY300 Consider moving this statement to an `else` block
   |
26 |             result = await func(*args, **kwargs)
27 |             status = "success"
28 |             return result
   |             ^^^^^^^^^^^^^ TRY300
29 |         except Exception as e:
30 |             status = "error"
   |

src/infrastructure/monitoring/performance_monitor.py:31:19: TRY201 Use `raise` without specifying exception name
   |
29 |         except Exception as e:
30 |             status = "error"
31 |             raise e
   |                   ^ TRY201
32 |         finally:
33 |             latency = time.time() - start_time
   |
   = help: Remove exception name

src/infrastructure/pagination/__init__.py:3:11: RUF022 [*] `__all__` is not sorted
  |
1 | from .pagination_service import PaginatedResponse, PaginationService
2 |
3 | __all__ = ["PaginatedResponse", "PaginationService", "PaginationRequest"]
  |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ RUF022
4 | from src.presentation.api.models.validation_models import PaginationRequest
  |
  = help: Apply an isort-style sorting to `__all__`

src/infrastructure/performance/batch_loader.py:32:69: B023 Function definition does not bind loop variable `key`
   |
30 |         results = {}
31 |         for key in keys:
32 |             results[key] = await self.load(key, lambda: loader_func(key))
   |                                                                     ^^^ B023
33 |         return results
   |

src/infrastructure/persistence/conversation_repository.py:1:1: I001 [*] Import block is un-sorted or un-formatted
   |
 1 | / from abc import abstractmethod
 2 | | from src.domain.interfaces import IConversationRepository
 3 | | from typing import Optional, List
 4 | | from uuid import UUID
 5 | |
 6 | | from sqlalchemy import select, update as sql_update, delete as sql_delete
 7 | | from sqlalchemy.ext.asyncio import AsyncSession
 8 | | from sqlalchemy.exc import SQLAlchemyError
 9 | |
10 | | from src.domain.entities.conversation import Conversation
11 | | from src.infrastructure.persistence.models.conversation_models import ConversationModel
   | |_______________________________________________________________________________________^ I001
   |
   = help: Organize imports

src/infrastructure/persistence/conversation_repository.py:1:17: F401 [*] `abc.abstractmethod` imported but unused
  |
1 | from abc import abstractmethod
  |                 ^^^^^^^^^^^^^^ F401
2 | from src.domain.interfaces import IConversationRepository
3 | from typing import Optional, List
  |
  = help: Remove unused import: `abc.abstractmethod`

src/infrastructure/persistence/conversation_repository.py:3:1: UP035 `typing.List` is deprecated, use `list` instead
  |
1 | from abc import abstractmethod
2 | from src.domain.interfaces import IConversationRepository
3 | from typing import Optional, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
4 | from uuid import UUID
  |

src/infrastructure/persistence/conversation_repository.py:29:1: W293 Blank line contains whitespace
   |
27 |     def __init__(self, session: AsyncSession):
28 |         """Initialize the repository with an async session.
29 |         
   | ^^^^^^^^ W293
30 |         Args:
31 |             session: The async SQLAlchemy session for database operations.
   |
   = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:35:56: UP045 [*] Use `X | None` for type annotations
   |
33 |         self.session = session
34 |
35 |     async def get_by_id(self, conversation_id: str) -> Optional[Conversation]:
   |                                                        ^^^^^^^^^^^^^^^^^^^^^^ UP045
36 |         """Retrieve a conversation by its ID.
   |
   = help: Convert to `X | None`

src/infrastructure/persistence/conversation_repository.py:37:1: W293 Blank line contains whitespace
   |
35 |     async def get_by_id(self, conversation_id: str) -> Optional[Conversation]:
36 |         """Retrieve a conversation by its ID.
37 |         
   | ^^^^^^^^ W293
38 |         Args:
39 |             conversation_id: The ID of the conversation to retrieve.
   |
   = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:40:1: W293 Blank line contains whitespace
   |
38 |         Args:
39 |             conversation_id: The ID of the conversation to retrieve.
40 |             
   | ^^^^^^^^^^^^ W293
41 |         Returns:
42 |             The Conversation entity if found, None otherwise.
   |
   = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:49:1: W293 [*] Blank line contains whitespace
   |
47 |             )
48 |             conversation_model = result.scalar_one_or_none()
49 |             
   | ^^^^^^^^^^^^ W293
50 |             if conversation_model:
51 |                 return conversation_model.to_entity()
   |
   = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:52:13: TRY300 Consider moving this statement to an `else` block
   |
50 |             if conversation_model:
51 |                 return conversation_model.to_entity()
52 |             return None
   |             ^^^^^^^^^^^ TRY300
53 |         except SQLAlchemyError as e:
54 |             raise ValueError(f"Database error while retrieving conversation: {str(e)}")
   |

src/infrastructure/persistence/conversation_repository.py:54:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
52 |             return None
53 |         except SQLAlchemyError as e:
54 |             raise ValueError(f"Database error while retrieving conversation: {str(e)}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
55 |
56 |     async def get_all(self) -> List[Conversation]:
   |

src/infrastructure/persistence/conversation_repository.py:54:19: TRY003 Avoid specifying long messages outside the exception class
   |
52 |             return None
53 |         except SQLAlchemyError as e:
54 |             raise ValueError(f"Database error while retrieving conversation: {str(e)}")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
55 |
56 |     async def get_all(self) -> List[Conversation]:
   |

src/infrastructure/persistence/conversation_repository.py:54:79: RUF010 [*] Use explicit conversion flag
   |
52 |             return None
53 |         except SQLAlchemyError as e:
54 |             raise ValueError(f"Database error while retrieving conversation: {str(e)}")
   |                                                                               ^^^^^^ RUF010
55 |
56 |     async def get_all(self) -> List[Conversation]:
   |
   = help: Replace with conversion flag

src/infrastructure/persistence/conversation_repository.py:56:32: UP006 [*] Use `list` instead of `List` for type annotation
   |
54 |             raise ValueError(f"Database error while retrieving conversation: {str(e)}")
55 |
56 |     async def get_all(self) -> List[Conversation]:
   |                                ^^^^ UP006
57 |         """Retrieve all conversations.
   |
   = help: Replace with `list`

src/infrastructure/persistence/conversation_repository.py:58:1: W293 Blank line contains whitespace
   |
56 |     async def get_all(self) -> List[Conversation]:
57 |         """Retrieve all conversations.
58 |         
   | ^^^^^^^^ W293
59 |         Returns:
60 |             A list of all Conversation entities.
   |
   = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:65:1: W293 [*] Blank line contains whitespace
   |
63 |             result = await self.session.execute(select(ConversationModel))
64 |             conversation_models = result.scalars().all()
65 |             
   | ^^^^^^^^^^^^ W293
66 |             return [model.to_entity() for model in conversation_models]
67 |         except SQLAlchemyError as e:
   |
   = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:68:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
66 |             return [model.to_entity() for model in conversation_models]
67 |         except SQLAlchemyError as e:
68 |             raise ValueError(f"Database error while retrieving conversations: {str(e)}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
69 |
70 |     async def create(self, conversation: Conversation) -> Conversation:
   |

src/infrastructure/persistence/conversation_repository.py:68:19: TRY003 Avoid specifying long messages outside the exception class
   |
66 |             return [model.to_entity() for model in conversation_models]
67 |         except SQLAlchemyError as e:
68 |             raise ValueError(f"Database error while retrieving conversations: {str(e)}")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
69 |
70 |     async def create(self, conversation: Conversation) -> Conversation:
   |

src/infrastructure/persistence/conversation_repository.py:68:80: RUF010 [*] Use explicit conversion flag
   |
66 |             return [model.to_entity() for model in conversation_models]
67 |         except SQLAlchemyError as e:
68 |             raise ValueError(f"Database error while retrieving conversations: {str(e)}")
   |                                                                                ^^^^^^ RUF010
69 |
70 |     async def create(self, conversation: Conversation) -> Conversation:
   |
   = help: Replace with conversion flag

src/infrastructure/persistence/conversation_repository.py:72:1: W293 Blank line contains whitespace
   |
70 |     async def create(self, conversation: Conversation) -> Conversation:
71 |         """Create a new conversation in the database.
72 |         
   | ^^^^^^^^ W293
73 |         Args:
74 |             conversation: The Conversation entity to create.
   |
   = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:75:1: W293 Blank line contains whitespace
   |
73 |         Args:
74 |             conversation: The Conversation entity to create.
75 |             
   | ^^^^^^^^^^^^ W293
76 |         Returns:
77 |             The created Conversation entity.
   |
   = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:84:1: W293 [*] Blank line contains whitespace
   |
82 |             await self.session.commit()
83 |             await self.session.refresh(conversation_model)
84 |             
   | ^^^^^^^^^^^^ W293
85 |             return conversation_model.to_entity()
86 |         except SQLAlchemyError as e:
   |
   = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:88:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
86 |         except SQLAlchemyError as e:
87 |             await self.session.rollback()
88 |             raise ValueError(f"Database error while creating conversation: {str(e)}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
89 |
90 |     async def update(self, conversation_id: str, data: dict) -> Optional[Conversation]:
   |

src/infrastructure/persistence/conversation_repository.py:88:19: TRY003 Avoid specifying long messages outside the exception class
   |
86 |         except SQLAlchemyError as e:
87 |             await self.session.rollback()
88 |             raise ValueError(f"Database error while creating conversation: {str(e)}")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
89 |
90 |     async def update(self, conversation_id: str, data: dict) -> Optional[Conversation]:
   |

src/infrastructure/persistence/conversation_repository.py:88:77: RUF010 [*] Use explicit conversion flag
   |
86 |         except SQLAlchemyError as e:
87 |             await self.session.rollback()
88 |             raise ValueError(f"Database error while creating conversation: {str(e)}")
   |                                                                             ^^^^^^ RUF010
89 |
90 |     async def update(self, conversation_id: str, data: dict) -> Optional[Conversation]:
   |
   = help: Replace with conversion flag

src/infrastructure/persistence/conversation_repository.py:90:65: UP045 [*] Use `X | None` for type annotations
   |
88 |             raise ValueError(f"Database error while creating conversation: {str(e)}")
89 |
90 |     async def update(self, conversation_id: str, data: dict) -> Optional[Conversation]:
   |                                                                 ^^^^^^^^^^^^^^^^^^^^^^ UP045
91 |         """Update a conversation with the provided data.
   |
   = help: Convert to `X | None`

src/infrastructure/persistence/conversation_repository.py:92:1: W293 Blank line contains whitespace
   |
90 |     async def update(self, conversation_id: str, data: dict) -> Optional[Conversation]:
91 |         """Update a conversation with the provided data.
92 |         
   | ^^^^^^^^ W293
93 |         Args:
94 |             conversation_id: The ID of the conversation to update.
   |
   = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:96:1: W293 Blank line contains whitespace
   |
94 |             conversation_id: The ID of the conversation to update.
95 |             data: Dictionary containing the fields to update.
96 |             
   | ^^^^^^^^^^^^ W293
97 |         Returns:
98 |             The updated Conversation entity if found, None otherwise.
   |
   = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:109:1: W293 [*] Blank line contains whitespace
    |
107 |                     else:
108 |                         update_data[key] = value
109 |             
    | ^^^^^^^^^^^^ W293
110 |             if update_data:
111 |                 await self.session.execute(
    |
    = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:117:1: W293 [*] Blank line contains whitespace
    |
115 |                 )
116 |                 await self.session.commit()
117 |             
    | ^^^^^^^^^^^^ W293
118 |             # Retrieve the updated conversation
119 |             return await self.get_by_id(conversation_id)
    |
    = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:122:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
120 |         except SQLAlchemyError as e:
121 |             await self.session.rollback()
122 |             raise ValueError(f"Database error while updating conversation: {str(e)}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
123 |
124 |     async def delete(self, conversation_id: str) -> None:
    |

src/infrastructure/persistence/conversation_repository.py:122:19: TRY003 Avoid specifying long messages outside the exception class
    |
120 |         except SQLAlchemyError as e:
121 |             await self.session.rollback()
122 |             raise ValueError(f"Database error while updating conversation: {str(e)}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
123 |
124 |     async def delete(self, conversation_id: str) -> None:
    |

src/infrastructure/persistence/conversation_repository.py:122:77: RUF010 [*] Use explicit conversion flag
    |
120 |         except SQLAlchemyError as e:
121 |             await self.session.rollback()
122 |             raise ValueError(f"Database error while updating conversation: {str(e)}")
    |                                                                             ^^^^^^ RUF010
123 |
124 |     async def delete(self, conversation_id: str) -> None:
    |
    = help: Replace with conversion flag

src/infrastructure/persistence/conversation_repository.py:126:1: W293 Blank line contains whitespace
    |
124 |     async def delete(self, conversation_id: str) -> None:
125 |         """Delete a conversation by its ID.
126 |         
    | ^^^^^^^^ W293
127 |         Args:
128 |             conversation_id: The ID of the conversation to delete.
    |
    = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:132:89: E501 Line too long (92 > 88)
    |
130 |         try:
131 |             await self.session.execute(
132 |                 sql_delete(ConversationModel).where(ConversationModel.id == conversation_id)
    |                                                                                         ^^^^ E501
133 |             )
134 |             await self.session.commit()
    |

src/infrastructure/persistence/conversation_repository.py:137:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
135 |         except SQLAlchemyError as e:
136 |             await self.session.rollback()
137 |             raise ValueError(f"Database error while deleting conversation: {str(e)}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
138 |
139 |     # Implement the abstract methods from ConversationRepository
    |

src/infrastructure/persistence/conversation_repository.py:137:19: TRY003 Avoid specifying long messages outside the exception class
    |
135 |         except SQLAlchemyError as e:
136 |             await self.session.rollback()
137 |             raise ValueError(f"Database error while deleting conversation: {str(e)}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
138 |
139 |     # Implement the abstract methods from ConversationRepository
    |

src/infrastructure/persistence/conversation_repository.py:137:77: RUF010 [*] Use explicit conversion flag
    |
135 |         except SQLAlchemyError as e:
136 |             await self.session.rollback()
137 |             raise ValueError(f"Database error while deleting conversation: {str(e)}")
    |                                                                             ^^^^^^ RUF010
138 |
139 |     # Implement the abstract methods from ConversationRepository
    |
    = help: Replace with conversion flag

src/infrastructure/persistence/conversation_repository.py:142:1: W293 Blank line contains whitespace
    |
140 |     async def add(self, conversation: Conversation) -> None:
141 |         """Add a new conversation to the database.
142 |         
    | ^^^^^^^^ W293
143 |         Args:
144 |             conversation: The Conversation entity to add.
    |
    = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:148:55: UP006 [*] Use `list` instead of `List` for type annotation
    |
146 |         await self.create(conversation)
147 |
148 |     async def get_by_child_id(self, child_id: str) -> List[Conversation]:
    |                                                       ^^^^ UP006
149 |         """Retrieve all conversations for a specific child.
    |
    = help: Replace with `list`

src/infrastructure/persistence/conversation_repository.py:150:1: W293 Blank line contains whitespace
    |
148 |     async def get_by_child_id(self, child_id: str) -> List[Conversation]:
149 |         """Retrieve all conversations for a specific child.
150 |         
    | ^^^^^^^^ W293
151 |         Args:
152 |             child_id: The ID of the child.
    |
    = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:153:1: W293 Blank line contains whitespace
    |
151 |         Args:
152 |             child_id: The ID of the child.
153 |             
    | ^^^^^^^^^^^^ W293
154 |         Returns:
155 |             A list of Conversation entities for the specified child.
    |
    = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:162:1: W293 [*] Blank line contains whitespace
    |
160 |             )
161 |             conversation_models = result.scalars().all()
162 |             
    | ^^^^^^^^^^^^ W293
163 |             return [model.to_entity() for model in conversation_models]
164 |         except SQLAlchemyError as e:
    |
    = help: Remove whitespace from blank line

src/infrastructure/persistence/conversation_repository.py:165:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
163 |             return [model.to_entity() for model in conversation_models]
164 |         except SQLAlchemyError as e:
165 |             raise ValueError(f"Database error while retrieving conversations by child_id: {str(e)}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
    |

src/infrastructure/persistence/conversation_repository.py:165:19: TRY003 Avoid specifying long messages outside the exception class
    |
163 |             return [model.to_entity() for model in conversation_models]
164 |         except SQLAlchemyError as e:
165 |             raise ValueError(f"Database error while retrieving conversations by child_id: {str(e)}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
    |

src/infrastructure/persistence/conversation_repository.py:165:89: E501 Line too long (100 > 88)
    |
163 |             return [model.to_entity() for model in conversation_models]
164 |         except SQLAlchemyError as e:
165 |             raise ValueError(f"Database error while retrieving conversations by child_id: {str(e)}")
    |                                                                                         ^^^^^^^^^^^^ E501
    |

src/infrastructure/persistence/conversation_repository.py:165:92: RUF010 [*] Use explicit conversion flag
    |
163 |             return [model.to_entity() for model in conversation_models]
164 |         except SQLAlchemyError as e:
165 |             raise ValueError(f"Database error while retrieving conversations by child_id: {str(e)}")
    |                                                                                            ^^^^^^ RUF010
    |
    = help: Replace with conversion flag

src/infrastructure/persistence/conversation_sqlite_repository.py:18:1: E402 Module level import not at top of file
   |
16 | """Production - ready SQLite conversation repository with COPPA compliance"""
17 |
18 | from src.infrastructure.logging_config import get_logger
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
19 |
20 | logger = get_logger(__name__, component="persistence")
   |

src/infrastructure/persistence/conversation_sqlite_repository.py:24:5: D205 1 blank line required between summary line and description
   |
23 |   class ConversationSQLiteRepository:
24 | /     """Production - grade conversation repository with comprehensive safety and privacy controls.
25 | |     Implements COPPA - compliant data handling with encryption and automatic cleanup.
26 | |     """
   | |_______^ D205
27 |
28 |       def __init__(self, db_path: str = "conversations.db") -> None:
   |
   = help: Insert single blank line

src/infrastructure/persistence/conversation_sqlite_repository.py:24:89: E501 Line too long (97 > 88)
   |
23 | class ConversationSQLiteRepository:
24 |     """Production - grade conversation repository with comprehensive safety and privacy controls.
   |                                                                                         ^^^^^^^^^ E501
25 |     Implements COPPA - compliant data handling with encryption and automatic cleanup.
26 |     """
   |

src/infrastructure/persistence/conversation_sqlite_repository.py:54:17: PTH101 `os.chmod()` should be replaced by `Path.chmod()`
   |
52 |             key_file = secure_ops.validator.get_safe_path(key_filename)
53 |             if key_file:
54 |                 os.chmod(key_file, 0o600)
   |                 ^^^^^^^^ PTH101
55 |         except Exception as e:
56 |             logger.warning(f"Failed to save encryption key: {e}")
   |

src/infrastructure/persistence/conversation_sqlite_repository.py:80:89: E501 Line too long (106 > 88)
   |
78 |                 # Index for performance and COPPA compliance
79 |                 conn.execute(
80 |                     "CREATE INDEX IF NOT EXISTS idx_child_timestamp ON conversations(child_id, timestamp)"
   |                                                                                         ^^^^^^^^^^^^^^^^^^ E501
81 |                 )
82 |                 conn.execute(
   |

src/infrastructure/persistence/conversation_sqlite_repository.py:83:89: E501 Line too long (92 > 88)
   |
81 |                 )
82 |                 conn.execute(
83 |                     "CREATE INDEX IF NOT EXISTS idx_expires_at ON conversations(expires_at)"
   |                                                                                         ^^^^ E501
84 |                 )
85 |                 # Trigger for automatic cleanup
   |

src/infrastructure/persistence/conversation_sqlite_repository.py:98:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
96 |                 logger.info("Conversation database initialized successfully")
97 |         except Exception as e:
98 |             logger.error(f"Failed to initialize conversation database: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
99 |             raise RuntimeError(f"Database initialization failed: {e}")
   |
   = help: Replace with `exception`

src/infrastructure/persistence/conversation_sqlite_repository.py:99:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
 97 |         except Exception as e:
 98 |             logger.error(f"Failed to initialize conversation database: {e}")
 99 |             raise RuntimeError(f"Database initialization failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
100 |
101 |     async def save_conversation(
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:99:19: TRY003 Avoid specifying long messages outside the exception class
    |
 97 |         except Exception as e:
 98 |             logger.error(f"Failed to initialize conversation database: {e}")
 99 |             raise RuntimeError(f"Database initialization failed: {e}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
100 |
101 |     async def save_conversation(
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:116:19: TRY003 Avoid specifying long messages outside the exception class
    |
114 |         # Input validation
115 |         if not conversation_data or not isinstance(conversation_data, dict):
116 |             raise ValueError("Valid conversation data required")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
117 |         required_fields = ["child_id", "message", "response"]
118 |         for field in required_fields:
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:120:23: TRY003 Avoid specifying long messages outside the exception class
    |
118 |         for field in required_fields:
119 |             if field not in conversation_data:
120 |                 raise ValueError(f"Missing required field: {field}")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
121 |         child_id = conversation_data["child_id"]
122 |         # Validate child_id format
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:123:44: PLR2004 Magic value used in comparison, consider replacing `8` with a constant variable
    |
121 |         child_id = conversation_data["child_id"]
122 |         # Validate child_id format
123 |         if not child_id or len(child_id) < 8 or not child_id.replace("-", "").isalnum():
    |                                            ^ PLR2004
124 |             raise ValueError("Invalid child_id format")
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:124:19: TRY003 Avoid specifying long messages outside the exception class
    |
122 |         # Validate child_id format
123 |         if not child_id or len(child_id) < 8 or not child_id.replace("-", "").isalnum():
124 |             raise ValueError("Invalid child_id format")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
125 |
126 |         # Safety checks
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:147:89: E501 Line too long (98 > 88)
    |
145 |                         """
146 |                         INSERT OR REPLACE INTO conversations
147 |                         (child_id, conversation_hash, encrypted_content, safety_score, expires_at)
    |                                                                                         ^^^^^^^^^^ E501
148 |                         VALUES (?, ?, ?, ?, ?)
149 |                     """,
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:164:89: E501 Line too long (93 > 88)
    |
162 |             conversation_id = await loop.run_in_executor(None, _save_to_db)
163 |             logger.info(
164 |                 f"Conversation saved successfully for child {child_id}: ID {conversation_id}"
    |                                                                                         ^^^^^ E501
165 |             )
166 |             return {
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:175:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
173 |             }
174 |         except Exception as e:
175 |             logger.error(f"Failed to save conversation for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
176 |             raise RuntimeError(f"Conversation save failed: {e}")
    |
    = help: Replace with `exception`

src/infrastructure/persistence/conversation_sqlite_repository.py:176:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
174 |         except Exception as e:
175 |             logger.error(f"Failed to save conversation for child {child_id}: {e}")
176 |             raise RuntimeError(f"Conversation save failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
177 |
178 |     async def get_conversations(
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:176:19: TRY003 Avoid specifying long messages outside the exception class
    |
174 |         except Exception as e:
175 |             logger.error(f"Failed to save conversation for child {child_id}: {e}")
176 |             raise RuntimeError(f"Conversation save failed: {e}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
177 |
178 |     async def get_conversations(
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:182:50: PLR2004 Magic value used in comparison, consider replacing `100` with a constant variable
    |
180 |     ) -> list[dict[str, Any]]:
181 |         """Get conversations for a child with decryption and safety filtering."""
182 |         if not child_id or limit <= 0 or limit > 100:
    |                                                  ^^^ PLR2004
183 |             raise ValueError("Invalid parameters")
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:183:19: TRY003 Avoid specifying long messages outside the exception class
    |
181 |         """Get conversations for a child with decryption and safety filtering."""
182 |         if not child_id or limit <= 0 or limit > 100:
183 |             raise ValueError("Invalid parameters")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
184 |
185 |         def _get_from_db():
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:190:89: E501 Line too long (109 > 88)
    |
188 |                 cursor = conn.execute(
189 |                     """
190 |                     SELECT id, conversation_hash, encrypted_content, timestamp, safety_score, parent_approved
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^ E501
191 |                     FROM conversations
192 |                     WHERE child_id = ? AND expires_at > datetime('now')
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:223:13: TRY300 Consider moving this statement to an `else` block
    |
221 |                     logger.warning(f"Failed to decrypt conversation {row['id']}: {e}")
222 |                     continue
223 |             return conversations
    |             ^^^^^^^^^^^^^^^^^^^^ TRY300
224 |         except Exception as e:
225 |             logger.error(f"Failed to retrieve conversations for child {child_id}: {e}")
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:225:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
223 |             return conversations
224 |         except Exception as e:
225 |             logger.error(f"Failed to retrieve conversations for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
226 |             raise RuntimeError(f"Conversation retrieval failed: {e}")
    |
    = help: Replace with `exception`

src/infrastructure/persistence/conversation_sqlite_repository.py:226:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
224 |         except Exception as e:
225 |             logger.error(f"Failed to retrieve conversations for child {child_id}: {e}")
226 |             raise RuntimeError(f"Conversation retrieval failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
227 |
228 |     async def delete_child_conversations(self, child_id: str) -> dict[str, Any]:
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:226:19: TRY003 Avoid specifying long messages outside the exception class
    |
224 |         except Exception as e:
225 |             logger.error(f"Failed to retrieve conversations for child {child_id}: {e}")
226 |             raise RuntimeError(f"Conversation retrieval failed: {e}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
227 |
228 |     async def delete_child_conversations(self, child_id: str) -> dict[str, Any]:
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:231:19: TRY003 Avoid specifying long messages outside the exception class
    |
229 |         """Delete all conversations for a child (COPPA right to deletion)."""
230 |         if not child_id:
231 |             raise ValueError("Valid child_id required")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
232 |
233 |         def _delete_from_db():
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:251:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
249 |             }
250 |         except Exception as e:
251 |             logger.error(f"Failed to delete conversations for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
252 |             raise RuntimeError(f"Conversation deletion failed: {e}")
    |
    = help: Replace with `exception`

src/infrastructure/persistence/conversation_sqlite_repository.py:252:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
250 |         except Exception as e:
251 |             logger.error(f"Failed to delete conversations for child {child_id}: {e}")
252 |             raise RuntimeError(f"Conversation deletion failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
253 |
254 |     async def _validate_conversation_safety(self, conversation_data: dict[str, Any]):
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:252:19: TRY003 Avoid specifying long messages outside the exception class
    |
250 |         except Exception as e:
251 |             logger.error(f"Failed to delete conversations for child {child_id}: {e}")
252 |             raise RuntimeError(f"Conversation deletion failed: {e}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
253 |
254 |     async def _validate_conversation_safety(self, conversation_data: dict[str, Any]):
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:275:23: TRY003 Avoid specifying long messages outside the exception class
    |
273 |                 or pattern.lower() in response.lower()
274 |             ):
275 |                 raise ValueError(f"Unsafe content detected: {pattern}")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
276 |
277 |         # Length validation
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:278:27: PLR2004 Magic value used in comparison, consider replacing `1000` with a constant variable
    |
277 |         # Length validation
278 |         if len(message) > 1000 or len(response) > 2000:
    |                           ^^^^ PLR2004
279 |             raise ValueError("Message or response too long")
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:278:51: PLR2004 Magic value used in comparison, consider replacing `2000` with a constant variable
    |
277 |         # Length validation
278 |         if len(message) > 1000 or len(response) > 2000:
    |                                                   ^^^^ PLR2004
279 |             raise ValueError("Message or response too long")
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:279:19: TRY003 Avoid specifying long messages outside the exception class
    |
277 |         # Length validation
278 |         if len(message) > 1000 or len(response) > 2000:
279 |             raise ValueError("Message or response too long")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
280 |
281 |     def _generate_conversation_hash(self, conversation_data: dict[str, Any]) -> str:
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:283:89: E501 Line too long (113 > 88)
    |
281 |     def _generate_conversation_hash(self, conversation_data: dict[str, Any]) -> str:
282 |         """Generate unique hash for conversation to prevent duplicates."""
283 |         content = f"{conversation_data['child_id']}{conversation_data['message']}{conversation_data['response']}"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^ E501
284 |         return hashlib.sha256(content.encode()).hexdigest()[:16]
    |

src/infrastructure/persistence/conversation_sqlite_repository.py:292:89: E501 Line too long (109 > 88)
    |
290 |             with sqlite3.connect(self.db_path) as conn:
291 |                 cursor = conn.execute(
292 |                     "SELECT COUNT(*) FROM conversations WHERE child_id = ? AND expires_at > datetime('now')",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^ E501
293 |                     (child_id,),
294 |                 )
    |

src/infrastructure/persistence/database/__init__.py:1:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | / from .config import DatabaseConfig
2 | | from .initializer import (
3 | |     get_database_config,
4 | |     initialize_production_database,
5 | |     validate_database_environment,
6 | | )
7 | | from .migrations import DatabaseMigrationManager
8 | | from .validators import DatabaseConnectionValidator
9 | | from ..models.base import Base
  | |______________________________^ I001
  |
  = help: Organize imports

src/infrastructure/persistence/database/__init__.py:9:1: TID252 Prefer absolute imports over relative imports from parent modules
  |
7 | from .migrations import DatabaseMigrationManager
8 | from .validators import DatabaseConnectionValidator
9 | from ..models.base import Base
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
  |
  = help: Replace relative imports from parent modules with absolute imports

src/infrastructure/persistence/database/__init__.py:14:11: RUF022 [*] `__all__` is not sorted
   |
12 |   """Database Configuration Module"""
13 |
14 |   __all__ = [
   |  ___________^
15 | |     "DatabaseConfig",
16 | |     "DatabaseConnectionValidator", 
17 | |     "DatabaseMigrationManager",
18 | |     "get_database_config",
19 | |     "initialize_production_database",
20 | |     "validate_database_environment",
21 | |     "Base", 
22 | | ]
   | |_^ RUF022
   |
   = help: Apply an isort-style sorting to `__all__`

src/infrastructure/persistence/database/__init__.py:16:35: W291 [*] Trailing whitespace
   |
14 | __all__ = [
15 |     "DatabaseConfig",
16 |     "DatabaseConnectionValidator", 
   |                                   ^ W291
17 |     "DatabaseMigrationManager",
18 |     "get_database_config",
   |
   = help: Remove trailing whitespace

src/infrastructure/persistence/database/__init__.py:21:12: W291 [*] Trailing whitespace
   |
19 |     "initialize_production_database",
20 |     "validate_database_environment",
21 |     "Base", 
   |            ^ W291
22 | ]
   |
   = help: Remove trailing whitespace

src/infrastructure/persistence/database/__init__.py:22:2: W292 [*] No newline at end of file
   |
20 |     "validate_database_environment",
21 |     "Base", 
22 | ]
   |  ^ W292
   |
   = help: Add trailing newline

src/infrastructure/persistence/database/config.py:43:23: TRY003 Avoid specifying long messages outside the exception class
   |
41 |               # Default configurations for different environments
42 |               if environment == "production":
43 |                   raise RuntimeError(
   |  _______________________^
44 | |                     "CRITICAL: DATABASE_URL must be set in production environment. "
45 | |                     "SQLite is not allowed for child safety applications.",
46 | |                 )
   | |_________________^ TRY003
47 |               if environment == "testing":
48 |                   database_url = "sqlite+aiosqlite:///test_ai_teddy.db"
   |

src/infrastructure/persistence/database/config.py:58:19: TRY003 Avoid specifying long messages outside the exception class
   |
56 |             engine_type = "sqlite"
57 |         else:
58 |             raise ValueError(f"Unsupported database scheme: {parsed_url.scheme}")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
59 |         return cls._create_for_environment(database_url, engine_type, environment)
   |

src/infrastructure/persistence/database/config.py:83:19: TRY003 Avoid specifying long messages outside the exception class
   |
81 |           """Production safe configuration."""
82 |           if engine_type == "sqlite":
83 |               raise RuntimeError(
   |  ___________________^
84 | |                 "CRITICAL: SQLite is not allowed in production for child safety applications. "
85 | |                 "Use PostgreSQL with proper encryption and backup strategies.",
86 | |             )
   | |_____________^ TRY003
87 |           return cls(
88 |               database_url=database_url,
   |

src/infrastructure/persistence/database/config.py:84:89: E501 Line too long (95 > 88)
   |
82 |         if engine_type == "sqlite":
83 |             raise RuntimeError(
84 |                 "CRITICAL: SQLite is not allowed in production for child safety applications. "
   |                                                                                         ^^^^^^^ E501
85 |                 "Use PostgreSQL with proper encryption and backup strategies.",
86 |             )
   |

src/infrastructure/persistence/database/config.py:191:23: TRY003 Avoid specifying long messages outside the exception class
    |
189 |             # SQLite specific settings
190 |             if self.environment == "production":
191 |                 raise RuntimeError("SQLite not allowed in production")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
192 |             base_kwargs["connect_args"] = {
193 |                 "check_same_thread": False,
    |

src/infrastructure/persistence/database/config.py:222:29: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
    |
220 |             validation_errors.append("Connection validation is required in production")
221 |         # Performance requirements
222 |         if self.pool_size < 10:
    |                             ^^ PLR2004
223 |             validation_errors.append(
224 |                 "Production requires at least 10 connection pool size",
    |

src/infrastructure/persistence/database/initializer.py:11:1: E402 Module level import not at top of file
   |
 9 | Translated Arabic comments to English"""
10 |
11 | from src.infrastructure.logging_config import get_logger
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
12 |
13 | logger = get_logger(__name__, component="persistence")
   |

src/infrastructure/persistence/database/initializer.py:33:13: TRY301 Abstract `raise` to an inner function
   |
31 |         validator = DatabaseConnectionValidator(config)
32 |         if not await validator.validate_connection():
33 |             raise RuntimeError("Database connection validation failed")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
34 |
35 |         # Setup schema compatibility
   |

src/infrastructure/persistence/database/initializer.py:33:19: TRY003 Avoid specifying long messages outside the exception class
   |
31 |         validator = DatabaseConnectionValidator(config)
32 |         if not await validator.validate_connection():
33 |             raise RuntimeError("Database connection validation failed")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
34 |
35 |         # Setup schema compatibility
   |

src/infrastructure/persistence/database/initializer.py:41:9: SIM102 Use a single `if` statement instead of nested `if` statements
   |
39 |           # Setup production optimizations
40 |           migration_manager = DatabaseMigrationManager(config)
41 | /         if config.environment == "production" and config.engine_type == "postgresql":
42 | |             if not await migration_manager.create_production_schema():
   | |______________________________________________________________________^ SIM102
43 |                   raise RuntimeError("Production schema setup failed")
   |
   = help: Combine `if` statements using `and`

src/infrastructure/persistence/database/initializer.py:43:17: TRY301 Abstract `raise` to an inner function
   |
41 |         if config.environment == "production" and config.engine_type == "postgresql":
42 |             if not await migration_manager.create_production_schema():
43 |                 raise RuntimeError("Production schema setup failed")
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
44 |
45 |         # Setup child data security
   |

src/infrastructure/persistence/database/initializer.py:43:23: TRY003 Avoid specifying long messages outside the exception class
   |
41 |         if config.environment == "production" and config.engine_type == "postgresql":
42 |             if not await migration_manager.create_production_schema():
43 |                 raise RuntimeError("Production schema setup failed")
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
44 |
45 |         # Setup child data security
   |

src/infrastructure/persistence/database/initializer.py:52:9: TRY300 Consider moving this statement to an `else` block
   |
50 |             f"Database initialization completed for {config.environment} environment",
51 |         )
52 |         return True
   |         ^^^^^^^^^^^ TRY300
53 |     except Exception as e:
54 |         logger.critical(f"Database initialization failed: {e}")
   |

src/infrastructure/persistence/database/initializer.py:65:19: TRY003 Avoid specifying long messages outside the exception class
   |
63 |       if environment == "production":
64 |           if not database_url:
65 |               raise RuntimeError(
   |  ___________________^
66 | |                 "CRITICAL: DATABASE_URL environment variable is required in production",
67 | |             )
   | |_____________^ TRY003
68 |           if "sqlite" in database_url.lower():
69 |               raise RuntimeError(
   |

src/infrastructure/persistence/database/initializer.py:69:19: TRY003 Avoid specifying long messages outside the exception class
   |
67 |               )
68 |           if "sqlite" in database_url.lower():
69 |               raise RuntimeError(
   |  ___________________^
70 | |                 "CRITICAL: SQLite is not allowed in production for child safety applications. "
71 | |                 "Use PostgreSQL with proper encryption and backup strategies.",
72 | |             )
   | |_____________^ TRY003
73 |           if "postgresql" not in database_url.lower():
74 |               raise RuntimeError(
   |

src/infrastructure/persistence/database/initializer.py:70:89: E501 Line too long (95 > 88)
   |
68 |         if "sqlite" in database_url.lower():
69 |             raise RuntimeError(
70 |                 "CRITICAL: SQLite is not allowed in production for child safety applications. "
   |                                                                                         ^^^^^^^ E501
71 |                 "Use PostgreSQL with proper encryption and backup strategies.",
72 |             )
   |

src/infrastructure/persistence/database/initializer.py:74:19: TRY003 Avoid specifying long messages outside the exception class
   |
72 |               )
73 |           if "postgresql" not in database_url.lower():
74 |               raise RuntimeError(
   |  ___________________^
75 | |                 "CRITICAL: Production environment requires PostgreSQL database",
76 | |             )
   | |_____________^ TRY003
77 |           logger.info("Production database environment validation passed")
   |

src/infrastructure/persistence/database/migrations.py:10:1: E402 Module level import not at top of file
   |
 8 | Translated Arabic comments to English"""
 9 |
10 | from src.infrastructure.logging_config import get_logger
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
11 |
12 | logger = get_logger(__name__, component="persistence")
   |

src/infrastructure/persistence/database/migrations.py:75:13: TRY300 Consider moving this statement to an `else` block
   |
74 |             await engine.dispose()
75 |             return True
   |             ^^^^^^^^^^^ TRY300
76 |         except Exception as e:
77 |             logger.error(f"Failed to create production schema: {e}")
   |

src/infrastructure/persistence/database/migrations.py:77:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
75 |             return True
76 |         except Exception as e:
77 |             logger.error(f"Failed to create production schema: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
78 |             if self.config.environment == "production":
79 |                 raise RuntimeError(f"Production schema creation failed: {e}")
   |
   = help: Replace with `exception`

src/infrastructure/persistence/database/migrations.py:79:17: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
77 |             logger.error(f"Failed to create production schema: {e}")
78 |             if self.config.environment == "production":
79 |                 raise RuntimeError(f"Production schema creation failed: {e}")
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
80 |             return False
   |

src/infrastructure/persistence/database/migrations.py:79:23: TRY003 Avoid specifying long messages outside the exception class
   |
77 |             logger.error(f"Failed to create production schema: {e}")
78 |             if self.config.environment == "production":
79 |                 raise RuntimeError(f"Production schema creation failed: {e}")
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
80 |             return False
   |

src/infrastructure/persistence/database/migrations.py:103:89: E501 Line too long (90 > 88)
    |
101 |                         USING (child_id IN (
102 |                             SELECT id FROM children
103 |                             WHERE parent_id = current_setting('app.current_user_id')::uuid
    |                                                                                         ^^ E501
104 |                         ))
105 |                         """,
    |

src/infrastructure/persistence/database/migrations.py:116:89: E501 Line too long (108 > 88)
    |
114 |                 # Create indexes for performance
115 |                 performance_indexes = [
116 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_children_parent_id ON children(parent_id)",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^ E501
117 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_conversations_child_id ON conversations(child_id)",
118 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_conversations_timestamp ON conversations(timestamp)",
    |

src/infrastructure/persistence/database/migrations.py:117:89: E501 Line too long (116 > 88)
    |
115 |                 performance_indexes = [
116 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_children_parent_id ON children(parent_id)",
117 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_conversations_child_id ON conversations(child_id)",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
118 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_conversations_timestamp ON conversations(timestamp)",
119 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_safety_events_child_id ON safety_events(child_id)",
    |

src/infrastructure/persistence/database/migrations.py:118:89: E501 Line too long (118 > 88)
    |
116 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_children_parent_id ON children(parent_id)",
117 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_conversations_child_id ON conversations(child_id)",
118 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_conversations_timestamp ON conversations(timestamp)",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
119 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_safety_events_child_id ON safety_events(child_id)",
120 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_audit_logs_timestamp ON audit_logs(timestamp)",
    |

src/infrastructure/persistence/database/migrations.py:119:89: E501 Line too long (116 > 88)
    |
117 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_conversations_child_id ON conversations(child_id)",
118 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_conversations_timestamp ON conversations(timestamp)",
119 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_safety_events_child_id ON safety_events(child_id)",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
120 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_audit_logs_timestamp ON audit_logs(timestamp)",
121 |                 ]
    |

src/infrastructure/persistence/database/migrations.py:120:89: E501 Line too long (112 > 88)
    |
118 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_conversations_timestamp ON conversations(timestamp)",
119 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_safety_events_child_id ON safety_events(child_id)",
120 |                     "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_audit_logs_timestamp ON audit_logs(timestamp)",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^ E501
121 |                 ]
122 |                 for index in performance_indexes:
    |

src/infrastructure/persistence/database/migrations.py:132:13: TRY300 Consider moving this statement to an `else` block
    |
131 |             await engine.dispose()
132 |             return True
    |             ^^^^^^^^^^^ TRY300
133 |         except Exception as e:
134 |             logger.error(f"Failed to setup child data security: {e}")
    |

src/infrastructure/persistence/database/migrations.py:134:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
132 |             return True
133 |         except Exception as e:
134 |             logger.error(f"Failed to setup child data security: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
135 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/persistence/database/validators.py:10:1: E402 Module level import not at top of file
   |
 8 | Translated Arabic comments to English"""
 9 |
10 | from src.infrastructure.logging_config import get_logger
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
11 |
12 | logger = get_logger(__name__, component="persistence")
   |

src/infrastructure/persistence/database/validators.py:42:13: TRY300 Consider moving this statement to an `else` block
   |
40 |                     logger.info(f"SQLite connection validated: {version_info}")
41 |             await engine.dispose()
42 |             return True
   |             ^^^^^^^^^^^ TRY300
43 |         except Exception as e:
44 |             logger.error(f"Database connection validation failed: {e}")
   |

src/infrastructure/persistence/database/validators.py:44:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
42 |             return True
43 |         except Exception as e:
44 |             logger.error(f"Database connection validation failed: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
45 |             if self.config.environment == "production":
46 |                 raise RuntimeError(f"Production database connection failed: {e}")
   |
   = help: Replace with `exception`

src/infrastructure/persistence/database/validators.py:46:17: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
44 |             logger.error(f"Database connection validation failed: {e}")
45 |             if self.config.environment == "production":
46 |                 raise RuntimeError(f"Production database connection failed: {e}")
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
47 |             return False
   |

src/infrastructure/persistence/database/validators.py:46:23: TRY003 Avoid specifying long messages outside the exception class
   |
44 |             logger.error(f"Database connection validation failed: {e}")
45 |             if self.config.environment == "production":
46 |                 raise RuntimeError(f"Production database connection failed: {e}")
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
47 |             return False
   |

src/infrastructure/persistence/database/validators.py:96:13: TRY300 Consider moving this statement to an `else` block
   |
94 |                             )
95 |             await engine.dispose()
96 |             return True
   |             ^^^^^^^^^^^ TRY300
97 |         except Exception as e:
98 |             logger.error(f"Schema compatibility validation failed: {e}")
   |

src/infrastructure/persistence/database/validators.py:98:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
96 |             return True
97 |         except Exception as e:
98 |             logger.error(f"Schema compatibility validation failed: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
99 |             return False
   |
   = help: Replace with `exception`

src/infrastructure/persistence/database_health_check.py:15:5: D205 1 blank line required between summary line and description
   |
13 |       delay: float = 2.0,
14 |   ) -> bool:
15 | /     """Attempts to connect to the database and execute a simple query to verify connectivity.
16 | |     Includes retry logic with exponential backoff.
17 | |     """
   | |_______^ D205
18 |       engine = None
19 |       for i in range(retries):
   |
   = help: Insert single blank line

src/infrastructure/persistence/database_health_check.py:15:89: E501 Line too long (93 > 88)
   |
13 |     delay: float = 2.0,
14 | ) -> bool:
15 |     """Attempts to connect to the database and execute a simple query to verify connectivity.
   |                                                                                         ^^^^^ E501
16 |     Includes retry logic with exponential backoff.
17 |     """
   |

src/infrastructure/persistence/database_health_check.py:26:13: TRY300 Consider moving this statement to an `else` block
   |
24 |                 await connection.execute(text("SELECT 1"))
25 |             logger.info("✅ Database connection successful.")
26 |             return True
   |             ^^^^^^^^^^^ TRY300
27 |         except Exception as e:
28 |             logger.warning(f"❌ Database connection failed: {e}")
   |

src/infrastructure/persistence/database_health_check.py:32:17: TRY400 Use `logging.exception` instead of `logging.error`
   |
30 |                 await asyncio.sleep(delay * (2**i))  # Exponential backoff
31 |             else:
32 |                 logger.error("❌ All database connection attempts failed.")
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
33 |         finally:
34 |             if engine:
   |
   = help: Replace with `exception`

src/infrastructure/persistence/database_manager.py:1:1: I001 [*] Import block is un-sorted or un-formatted
   |
 1 | / from collections.abc import AsyncGenerator
 2 | |
 3 | | from sqlalchemy.exc import DatabaseError, DataError, IntegrityError
 4 | | from sqlalchemy.ext.asyncio import (
 5 | |     AsyncSession,
 6 | |     async_sessionmaker,
 7 | |     create_async_engine,
 8 | | )
 9 | | from sqlalchemy.orm import declarative_base
10 | | from src.infrastructure.persistence.models.base import Base
11 | | from src.infrastructure.logging_config import get_logger
12 | | from src.infrastructure.persistence.database.config import DatabaseConfig
13 | | from src.infrastructure.persistence.database.validators import (
14 | |     DatabaseConnectionValidator,
15 | | )
   | |_^ I001
16 |
17 |   logger = get_logger(__name__, component="persistence")
   |
   = help: Organize imports

src/infrastructure/persistence/database_manager.py:9:28: F401 [*] `sqlalchemy.orm.declarative_base` imported but unused
   |
 7 |     create_async_engine,
 8 | )
 9 | from sqlalchemy.orm import declarative_base
   |                            ^^^^^^^^^^^^^^^^ F401
10 | from src.infrastructure.persistence.models.base import Base
11 | from src.infrastructure.logging_config import get_logger
   |
   = help: Remove unused import: `sqlalchemy.orm.declarative_base`

src/infrastructure/persistence/database_manager.py:22:9: PLR0913 Too many arguments in function definition (6 > 5)
   |
20 |     """Enterprise-grade database service with production PostgreSQL support."""
21 |
22 |     def __init__(
   |         ^^^^^^^^ PLR0913
23 |         self,
24 |         database_url: str | None = None,
   |

src/infrastructure/persistence/database_manager.py:81:19: TRY003 Avoid specifying long messages outside the exception class
   |
79 |             logger.critical(f"Failed to create database engine: {e}")
80 |             safe_url = self._get_safe_url_for_logging(self.database_url)
81 |             raise ConnectionError(f"Database connection failed: {safe_url}") from e
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
82 |
83 |     def _get_safe_url_for_logging(self, url: str) -> str:
   |

src/infrastructure/persistence/database_manager.py:86:13: PLC0415 `import` should be at the top-level of a file
   |
84 |         """Create safe URL for logging (without exposing passwords)."""
85 |         try:
86 |             from urllib.parse import urlparse, urlunparse
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
87 |
88 |             parsed = urlparse(url)
   |

src/infrastructure/persistence/database_manager.py:102:13: TRY300 Consider moving this statement to an `else` block
    |
100 |             else:
101 |                 safe_url = url
102 |             return safe_url
    |             ^^^^^^^^^^^^^^^ TRY300
103 |         except Exception as e:
104 |             logger.warning(f"Failed to redact database URL: {e}")
    |

src/infrastructure/persistence/database_manager.py:114:21: TRY301 Abstract `raise` to an inner function
    |
112 |                 validator = DatabaseConnectionValidator(self.config)
113 |                 if not await validator.validate_connection():
114 |                     raise ConnectionError("Database connection validation failed")
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
115 |             async with self.engine.begin() as conn:
116 |                 # Register all models using the model registry
    |

src/infrastructure/persistence/database_manager.py:114:27: TRY003 Avoid specifying long messages outside the exception class
    |
112 |                 validator = DatabaseConnectionValidator(self.config)
113 |                 if not await validator.validate_connection():
114 |                     raise ConnectionError("Database connection validation failed")
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
115 |             async with self.engine.begin() as conn:
116 |                 # Register all models using the model registry
    |

src/infrastructure/persistence/database_manager.py:117:17: PLC0415 `import` should be at the top-level of a file
    |
115 |               async with self.engine.begin() as conn:
116 |                   # Register all models using the model registry
117 | /                 from src.infrastructure.persistence.model_registry import (
118 | |                     get_model_registry,
119 | |                 )
    | |_________________^ PLC0415
120 |
121 |                   registry = get_model_registry()
    |

src/infrastructure/persistence/database_manager.py:135:19: TRY003 Avoid specifying long messages outside the exception class
    |
133 |         except Exception as e:
134 |             logger.critical(f"Failed to initialize database tables: {e}")
135 |             raise ConnectionError("Database initialization failed") from e
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
136 |
137 |     async def _apply_production_optimizations(self, conn) -> None:
    |

src/infrastructure/persistence/database_manager.py:140:13: PLC0415 `import` should be at the top-level of a file
    |
138 |         """Apply production optimizations."""
139 |         try:
140 |             from sqlalchemy import text
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
141 |
142 |             # Enable necessary PostgreSQL extensions
    |

src/infrastructure/persistence/database_manager.py:155:89: E501 Line too long (90 > 88)
    |
153 |             # Create performance indexes
154 |             indexes = [
155 |                 "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_users_email ON users(email)",
    |                                                                                         ^^ E501
156 |                 "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_children_parent_id ON children(parent_id)",
157 |                 "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_conversations_child_id ON conversations(child_id)",
    |

src/infrastructure/persistence/database_manager.py:156:89: E501 Line too long (104 > 88)
    |
154 |             indexes = [
155 |                 "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_users_email ON users(email)",
156 |                 "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_children_parent_id ON children(parent_id)",
    |                                                                                         ^^^^^^^^^^^^^^^^ E501
157 |                 "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_conversations_child_id ON conversations(child_id)",
158 |                 "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_conversations_timestamp ON conversations(timestamp)",
    |

src/infrastructure/persistence/database_manager.py:157:89: E501 Line too long (112 > 88)
    |
155 |                 "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_users_email ON users(email)",
156 |                 "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_children_parent_id ON children(parent_id)",
157 |                 "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_conversations_child_id ON conversations(child_id)",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^ E501
158 |                 "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_conversations_timestamp ON conversations(timestamp)",
159 |             ]
    |

src/infrastructure/persistence/database_manager.py:158:89: E501 Line too long (114 > 88)
    |
156 |                 "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_children_parent_id ON children(parent_id)",
157 |                 "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_conversations_child_id ON conversations(child_id)",
158 |                 "CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_conversations_timestamp ON conversations(timestamp)",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
159 |             ]
160 |             for index in indexes:
    |

src/infrastructure/persistence/database_manager.py:176:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
174 |                 await session.commit()
175 |             except (IntegrityError, DataError, DatabaseError) as db_error:
176 |                 logger.error(f"Database error during transaction: {db_error}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
177 |                 await session.rollback()
178 |                 raise DatabaseError(f"Transaction failed: {db_error}") from db_error
    |
    = help: Replace with `exception`

src/infrastructure/persistence/database_manager.py:178:23: TRY003 Avoid specifying long messages outside the exception class
    |
176 |                 logger.error(f"Database error during transaction: {db_error}")
177 |                 await session.rollback()
178 |                 raise DatabaseError(f"Transaction failed: {db_error}") from db_error
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
179 |             except (ConnectionError, TimeoutError) as conn_error:
180 |                 logger.error(f"Connection error during transaction: {conn_error}")
    |

src/infrastructure/persistence/database_manager.py:180:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
178 |                 raise DatabaseError(f"Transaction failed: {db_error}") from db_error
179 |             except (ConnectionError, TimeoutError) as conn_error:
180 |                 logger.error(f"Connection error during transaction: {conn_error}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
181 |                 await session.rollback()
182 |                 raise ConnectionError(
    |
    = help: Replace with `exception`

src/infrastructure/persistence/database_manager.py:182:23: TRY003 Avoid specifying long messages outside the exception class
    |
180 |                   logger.error(f"Connection error during transaction: {conn_error}")
181 |                   await session.rollback()
182 |                   raise ConnectionError(
    |  _______________________^
183 | |                     f"Database connection failed: {conn_error}",
184 | |                 ) from conn_error
    | |_________________^ TRY003
185 |               except Exception as unexpected_error:
186 |                   logger.critical(
    |

src/infrastructure/persistence/database_manager.py:191:23: TRY003 Avoid specifying long messages outside the exception class
    |
189 |                   )
190 |                   await session.rollback()
191 |                   raise RuntimeError(
    |  _______________________^
192 | |                     "Database operation failed due to unexpected error",
193 | |                 ) from unexpected_error
    | |_________________^ TRY003
194 |               finally:
195 |                   await session.close()
    |

src/infrastructure/persistence/database_service_orchestrator.py:13:89: E501 Line too long (133 > 88)
   |
11 |     ChildRepository,
12 | )
13 | from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
14 |     ConversationRepository,
15 | )
   |

src/infrastructure/persistence/database_service_orchestrator.py:13:126: SyntaxError: Simple statements must be separated by newlines or semicolons
   |
11 |     ChildRepository,
12 | )
13 | from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
   |                                                                                                                              ^^^^^^
14 |     ConversationRepository,
15 | )
   |

src/infrastructure/persistence/database_service_orchestrator.py:13:133: SyntaxError: Expected one or more symbol names after import
   |
11 |     ChildRepository,
12 | )
13 | from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
   |                                                                                                                                     ^
14 |     ConversationRepository,
15 | )
   |

src/infrastructure/persistence/database_service_orchestrator.py:13:134: SyntaxError: missing closing parenthesis `)`
   |
11 |     ChildRepository,
12 | )
13 | from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
   |                                                                                                                                      ^
14 |     ConversationRepository,
15 | )
16 | from src.infrastructure.persistence.repositories.safety_repository import (
   |

src/infrastructure/persistence/database_service_orchestrator.py:14:1: SyntaxError: Unexpected indentation
   |
12 | )
13 | from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
14 |     ConversationRepository,
   | ^^^^
15 | )
16 | from src.infrastructure.persistence.repositories.safety_repository import (
   |

src/infrastructure/persistence/database_service_orchestrator.py:14:27: COM818 Trailing comma on bare tuple prohibited
   |
12 | )
13 | from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
14 |     ConversationRepository,
   |                           ^ COM818
15 | )
16 | from src.infrastructure.persistence.repositories.safety_repository import (
   |

src/infrastructure/persistence/database_service_orchestrator.py:15:1: SyntaxError: Expected a statement
   |
13 | from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
14 |     ConversationRepository,
15 | )
   | ^
16 | from src.infrastructure.persistence.repositories.safety_repository import (
17 |     SafetyRepository,
   |

src/infrastructure/persistence/database_service_orchestrator.py:15:2: SyntaxError: Expected a statement
   |
13 | from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
14 |     ConversationRepository,
15 | )
   |  ^
16 | from src.infrastructure.persistence.repositories.safety_repository import (
17 |     SafetyRepository,
18 | )
   |

src/infrastructure/persistence/database_service_orchestrator.py:198:89: E501 Line too long (89 > 88)
    |
196 |         analysis_id = str(uuid4())
197 |         logger.info(
198 |             f"Saved emotion analysis for child {child_id}: {emotion} ({confidence:.2f})",
    |                                                                                         ^ E501
199 |         )
200 |         return analysis_id
    |

src/infrastructure/persistence/kafka_event_store.py:69:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
67 |             logger.info("Kafka event store initialized successfully")
68 |         except Exception as e:
69 |             logger.error(f"Failed to initialize Kafka event store: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
70 |             raise
   |
   = help: Replace with `exception`

src/infrastructure/persistence/kafka_event_store.py:134:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
132 |               )
133 |           except KafkaError as e:
134 | /             logger.error(
135 | |                 f"Kafka error while saving events for aggregate {aggregate_id}: {e}",
136 | |             )
    | |_____________^ TRY400
137 |               raise
138 |           except Exception as e:
    |
    = help: Replace with `exception`

src/infrastructure/persistence/kafka_event_store.py:139:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
137 |             raise
138 |         except Exception as e:
139 |             logger.error(f"Failed to save events for aggregate {aggregate_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
140 |             raise
    |
    = help: Replace with `exception`

src/infrastructure/persistence/kafka_event_store.py:190:13: TRY300 Consider moving this statement to an `else` block
    |
188 |                 f"Loaded {len(events)} events for aggregate {aggregate_id} from Kafka",
189 |             )
190 |             return events
    |             ^^^^^^^^^^^^^ TRY300
191 |         except Exception as e:
192 |             logger.error(f"Failed to load events for aggregate {aggregate_id}: {e}")
    |

src/infrastructure/persistence/kafka_event_store.py:192:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
190 |             return events
191 |         except Exception as e:
192 |             logger.error(f"Failed to load events for aggregate {aggregate_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
193 |             raise
    |
    = help: Replace with `exception`

src/infrastructure/persistence/kafka_event_store.py:241:13: TRY300 Consider moving this statement to an `else` block
    |
240 |             self.consumer.unsubscribe()
241 |             return events
    |             ^^^^^^^^^^^^^ TRY300
242 |         except Exception as e:
243 |             logger.error(
    |

src/infrastructure/persistence/kafka_event_store.py:243:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
241 |               return events
242 |           except Exception as e:
243 | /             logger.error(
244 | |                 f"Failed to load events from offset for aggregate {aggregate_id}: {e}",
245 | |             )
    | |_____________^ TRY400
246 |               raise
    |
    = help: Replace with `exception`

src/infrastructure/persistence/kafka_event_store.py:289:9: ARG002 Unused method argument: `metadata`
    |
287 |         event_type: str,
288 |         event_data: dict[str, Any],
289 |         metadata: dict[str, Any] | None,
    |         ^^^^^^^^ ARG002
290 |     ) -> Any | None:
291 |         """Deserialize event data back to domain event.
    |

src/infrastructure/persistence/kafka_event_store.py:304:17: PLC0415 `import` should be at the top-level of a file
    |
302 |             # Dynamic import based on event type
303 |             if event_type == "ChildRegistered":
304 |                 from src.domain.events.child_registered import ChildRegistered
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
305 |
306 |                 return ChildRegistered(**event_data)
    |

src/infrastructure/persistence/kafka_event_store.py:308:17: PLC0415 `import` should be at the top-level of a file
    |
306 |                   return ChildRegistered(**event_data)
307 |               if event_type == "ChildProfileUpdated":
308 | /                 from src.domain.events.child_profile_updated import (
309 | |                     ChildProfileUpdated,
310 | |                 )
    | |_________________^ PLC0415
311 |
312 |                   return ChildProfileUpdated(**event_data)
    |

src/infrastructure/persistence/kafka_event_store.py:314:13: TRY300 Consider moving this statement to an `else` block
    |
312 |                 return ChildProfileUpdated(**event_data)
313 |             logger.warning(f"Unknown event type: {event_type}")
314 |             return None
    |             ^^^^^^^^^^^ TRY300
315 |         except Exception as e:
316 |             logger.error(f"Failed to deserialize event {event_type}: {e}")
    |

src/infrastructure/persistence/kafka_event_store.py:316:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
314 |             return None
315 |         except Exception as e:
316 |             logger.error(f"Failed to deserialize event {event_type}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
317 |             return None
    |
    = help: Replace with `exception`

src/infrastructure/persistence/model_registry.py:52:12: PLW0603 Using the global statement to update `_model_registry` is discouraged
   |
50 | def get_model_registry() -> ModelRegistry:
51 |     """Get the global model registry instance."""
52 |     global _model_registry
   |            ^^^^^^^^^^^^^^^ PLW0603
53 |     if _model_registry is None:
54 |         _model_registry = ModelRegistry()
   |

src/infrastructure/persistence/model_registry.py:61:5: D205 1 blank line required between summary line and description
   |
59 |       model_class: type[DeclarativeBase],
60 |   ) -> type[DeclarativeBase]:
61 | /     """Decorator to register a model class.
62 | |     Usage: @register_model class MyModel(Base): pass.
63 | |     """
   | |_______^ D205
64 |       registry = get_model_registry()
65 |       registry.register_model(model_class)
   |
   = help: Insert single blank line

src/infrastructure/persistence/models/base.py:2:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | """Base SQLAlchemy configuration for all models."""
2 | from sqlalchemy.orm import DeclarativeBase
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ I001
3 |
4 | class Base(DeclarativeBase):
  |
  = help: Organize imports

src/infrastructure/persistence/models/child_models.py:6:1: I001 [*] Import block is un-sorted or un-formatted
   |
 4 |   """
 5 |
 6 | / import uuid
 7 | | from datetime import UTC, datetime
 8 | | from typing import Optional
 9 | |
10 | | from sqlalchemy import (
11 | |     CheckConstraint,
12 | |     DateTime,
13 | |     ForeignKey,
14 | |     Index,
15 | |     Integer,
16 | |     String,
17 | | )
18 | | from sqlalchemy.dialects.postgresql import ARRAY, JSONB, UUID
19 | | from sqlalchemy.orm import Mapped, mapped_column, relationship
20 | |
21 | | # استيراد الـ Types الصحيحة
22 | | from src.domain.value_objects.child_age import ChildAge, AgeCategory
23 | | from src.domain.value_objects.safety_level import SafetyLevel
24 | | from src.infrastructure.persistence.models.base import Base
   | |___________________________________________________________^ I001
   |
   = help: Organize imports

src/infrastructure/persistence/models/child_models.py:50:24: UP045 [*] Use `X | None` for type annotations
   |
48 |     name_encrypted: Mapped[str] = mapped_column(String(500), nullable=False)
49 |     age_years: Mapped[int] = mapped_column(Integer, nullable=False)
50 |     age_months: Mapped[Optional[int]] = mapped_column(Integer, nullable=True)
   |                        ^^^^^^^^^^^^^ UP045
51 |     
52 |     # ✅ استخدام AgeCategory (وهو Enum) بدلاً من ChildAge (وهو dataclass)
   |
   = help: Convert to `X | None`

src/infrastructure/persistence/models/child_models.py:51:1: W293 [*] Blank line contains whitespace
   |
49 |     age_years: Mapped[int] = mapped_column(Integer, nullable=False)
50 |     age_months: Mapped[Optional[int]] = mapped_column(Integer, nullable=True)
51 |     
   | ^^^^ W293
52 |     # ✅ استخدام AgeCategory (وهو Enum) بدلاً من ChildAge (وهو dataclass)
53 |     age_category: Mapped[str] = mapped_column(
   |
   = help: Remove whitespace from blank line

src/infrastructure/persistence/models/child_models.py:54:20: W291 [*] Trailing whitespace
   |
52 |     # ✅ استخدام AgeCategory (وهو Enum) بدلاً من ChildAge (وهو dataclass)
53 |     age_category: Mapped[str] = mapped_column(
54 |         String(20), 
   |                    ^ W291
55 |         nullable=False,
56 |         comment="Age category: toddler, preschool, early_child, middle_child, preteen"
   |
   = help: Remove trailing whitespace

src/infrastructure/persistence/models/child_models.py:76:30: UP045 [*] Use `X | None` for type annotations
   |
74 |     # Usage tracking
75 |     total_interactions: Mapped[int] = mapped_column(Integer, default=0, nullable=False)
76 |     last_interaction: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))
   |                              ^^^^^^^^^^^^^^^^^^ UP045
77 |
78 |     # Audit fields
   |
   = help: Convert to `X | None`

src/infrastructure/persistence/models/child_models.py:76:89: E501 Line too long (89 > 88)
   |
74 |     # Usage tracking
75 |     total_interactions: Mapped[int] = mapped_column(Integer, default=0, nullable=False)
76 |     last_interaction: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))
   |                                                                                         ^ E501
77 |
78 |     # Audit fields
   |

src/infrastructure/persistence/models/child_models.py:108:89: E501 Line too long (97 > 88)
    |
106 |         CheckConstraint("age_months <= 11", name="check_months_max"),
107 |         CheckConstraint(
108 |             "age_category IN ('toddler', 'preschool', 'early_child', 'middle_child', 'preteen')",
    |                                                                                         ^^^^^^^^^ E501
109 |             name="check_valid_age_category"
110 |         ),
    |

src/infrastructure/persistence/models/child_models.py:112:89: E501 Line too long (99 > 88)
    |
110 |         ),
111 |         CheckConstraint(
112 |             "safety_level IN ('none', 'low', 'strict', 'moderate', 'relaxed', 'high', 'critical')",
    |                                                                                         ^^^^^^^^^^^ E501
113 |             name="check_valid_safety_level"
114 |         ),
    |

src/infrastructure/persistence/models/child_models.py:116:1: W293 [*] Blank line contains whitespace
    |
114 |         ),
115 |     )
116 |     
    | ^^^^ W293
117 |     # ✅ Properties للتحويل بين database values والـ domain objects
118 |     @property
    |
    = help: Remove whitespace from blank line

src/infrastructure/persistence/models/child_models.py:122:1: W293 [*] Blank line contains whitespace
    |
120 |         """Get ChildAge domain object."""
121 |         return ChildAge(years=self.age_years, months=self.age_months)
122 |     
    | ^^^^ W293
123 |     @child_age.setter
124 |     def child_age(self, value: ChildAge) -> None:
    |
    = help: Remove whitespace from blank line

src/infrastructure/persistence/models/child_models.py:129:1: W293 [*] Blank line contains whitespace
    |
127 |         self.age_months = value.months
128 |         self.age_category = value.category.value  # تحديث الـ category تلقائياً
129 |     
    | ^^^^ W293
130 |     @property
131 |     def age_category_enum(self) -> AgeCategory:
    |
    = help: Remove whitespace from blank line

src/infrastructure/persistence/models/child_models.py:134:1: W293 [*] Blank line contains whitespace
    |
132 |         """Get age_category as enum."""
133 |         return AgeCategory(self.age_category)
134 |     
    | ^^^^ W293
135 |     @age_category_enum.setter
136 |     def age_category_enum(self, value: AgeCategory) -> None:
    |
    = help: Remove whitespace from blank line

src/infrastructure/persistence/models/child_models.py:139:1: W293 [*] Blank line contains whitespace
    |
137 |         """Set age_category from enum."""
138 |         self.age_category = value.value
139 |     
    | ^^^^ W293
140 |     @property
141 |     def safety_level_enum(self) -> SafetyLevel:
    |
    = help: Remove whitespace from blank line

src/infrastructure/persistence/models/child_models.py:144:1: W293 [*] Blank line contains whitespace
    |
142 |         """Get safety_level as enum."""
143 |         return SafetyLevel(self.safety_level)
144 |     
    | ^^^^ W293
145 |     @safety_level_enum.setter
146 |     def safety_level_enum(self, value: SafetyLevel) -> None:
    |
    = help: Remove whitespace from blank line

src/infrastructure/persistence/models/child_models.py:154:1: W293 [*] Blank line contains whitespace
    |
152 |         """Get age-appropriate interaction guidelines."""
153 |         return self.child_age.get_interaction_guidelines()
154 |     
    | ^^^^ W293
155 |     def get_recommended_topics(self) -> list[str]:
156 |         """Get age-appropriate topic recommendations."""
    |
    = help: Remove whitespace from blank line

src/infrastructure/persistence/models/child_models.py:158:1: W293 [*] Blank line contains whitespace
    |
156 |         """Get age-appropriate topic recommendations."""
157 |         return self.child_age.recommended_topics
158 |     
    | ^^^^ W293
159 |     def get_safety_restrictions(self) -> dict[str, bool]:
160 |         """Get safety restrictions."""
    |
    = help: Remove whitespace from blank line

src/infrastructure/persistence/models/child_models.py:162:1: W293 [*] Blank line contains whitespace
    |
160 |         """Get safety restrictions."""
161 |         return self.child_age.safety_restrictions
162 |     
    | ^^^^ W293
163 |     def is_appropriate_for_content(self, content_age_rating: int) -> bool:
164 |         """Check if content is appropriate for this age."""
    |
    = help: Remove whitespace from blank line

src/infrastructure/persistence/models/child_models.py:168:89: E501 Line too long (128 > 88)
    |
167 |     def __repr__(self) -> str:
168 |         return f"<ChildModel(id={self.id}, age={self.age_years}, category='{self.age_category}', safety='{self.safety_level}')>"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
    |

src/infrastructure/persistence/models/conversation_models.py:84:89: E501 Line too long (107 > 88)
   |
83 |     def __repr__(self) -> str:
84 |         return f"<ConversationModel(id={self.id}, child_id={self.child_id}, start_time={self.start_time})>"
   |                                                                                         ^^^^^^^^^^^^^^^^^^^ E501
   |

src/infrastructure/persistence/models/conversation_models.py:135:89: E501 Line too long (110 > 88)
    |
134 |     def __repr__(self) -> str:
135 |         return f"<MessageModel(id={self.id}, conversation_id={self.conversation_id}, sender='{self.sender}')>"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^ E501
    |

src/infrastructure/persistence/models/parent_models.py:93:89: E501 Line too long (95 > 88)
   |
92 |     def __repr__(self) -> str:
93 |         return f"<ParentModel(id={self.id}, email='{self.email}', is_active={self.is_active})>"
   |                                                                                         ^^^^^^^ E501
   |

src/infrastructure/persistence/postgres_event_store.py:3:1: I001 [*] Import block is un-sorted or un-formatted
   |
 1 |   """PostgreSQL Event Store Implementation for Event Sourcing."""
 2 |
 3 | / from datetime import datetime
 4 | | from typing import Any
 5 | | from uuid import UUID, uuid4
 6 | |
 7 | | from sqlalchemy import Column, DateTime, Index, Integer, String, select
 8 | | from sqlalchemy.dialects.postgresql import JSONB
 9 | | from sqlalchemy.dialects.postgresql import UUID as PGUUID
10 | | from sqlalchemy.orm import declarative_base
11 | |
12 | | from src.domain.repositories.event_store import EventStore
13 | | from src.infrastructure.logging_config import get_logger  
14 | | from src.infrastructure.persistence.database_manager import Database
   | |____________________________________________________________________^ I001
15 |
16 |   logger = get_logger(__name__, component="persistence")
   |
   = help: Organize imports

src/infrastructure/persistence/postgres_event_store.py:13:57: W291 [*] Trailing whitespace
   |
12 | from src.domain.repositories.event_store import EventStore
13 | from src.infrastructure.logging_config import get_logger  
   |                                                         ^^ W291
14 | from src.infrastructure.persistence.database_manager import Database
   |
   = help: Remove trailing whitespace

src/infrastructure/persistence/real_database_service.py:3:22: F401 [*] `datetime.datetime` imported but unused
  |
1 | """Database Service for AI Teddy Bear."""
2 |
3 | from datetime import datetime
  |                      ^^^^^^^^ F401
4 | from typing import Any
5 | from uuid import uuid4
  |
  = help: Remove unused import: `datetime.datetime`

src/infrastructure/persistence/real_database_service.py:4:20: F401 [*] `typing.Any` imported but unused
  |
3 | from datetime import datetime
4 | from typing import Any
  |                    ^^^ F401
5 | from uuid import uuid4
  |
  = help: Remove unused import: `typing.Any`

src/infrastructure/persistence/real_database_service.py:5:18: F401 [*] `uuid.uuid4` imported but unused
  |
3 | from datetime import datetime
4 | from typing import Any
5 | from uuid import uuid4
  |                  ^^^^^ F401
6 |
7 | from sqlalchemy import delete, update
  |
  = help: Remove unused import: `uuid.uuid4`

src/infrastructure/persistence/real_database_service.py:7:24: F401 [*] `sqlalchemy.delete` imported but unused
  |
5 | from uuid import uuid4
6 |
7 | from sqlalchemy import delete, update
  |                        ^^^^^^ F401
8 | from sqlalchemy.exc import IntegrityError
9 | from sqlalchemy.future import select
  |
  = help: Remove unused import

src/infrastructure/persistence/real_database_service.py:7:32: F401 [*] `sqlalchemy.update` imported but unused
  |
5 | from uuid import uuid4
6 |
7 | from sqlalchemy import delete, update
  |                                ^^^^^^ F401
8 | from sqlalchemy.exc import IntegrityError
9 | from sqlalchemy.future import select
  |
  = help: Remove unused import

src/infrastructure/persistence/real_database_service.py:8:28: F401 [*] `sqlalchemy.exc.IntegrityError` imported but unused
  |
7 | from sqlalchemy import delete, update
8 | from sqlalchemy.exc import IntegrityError
  |                            ^^^^^^^^^^^^^^ F401
9 | from sqlalchemy.future import select
  |
  = help: Remove unused import: `sqlalchemy.exc.IntegrityError`

src/infrastructure/persistence/real_database_service.py:9:31: F401 [*] `sqlalchemy.future.select` imported but unused
   |
 7 | from sqlalchemy import delete, update
 8 | from sqlalchemy.exc import IntegrityError
 9 | from sqlalchemy.future import select
   |                               ^^^^^^ F401
10 |
11 | from src.infrastructure.logging_config import get_logger
   |
   = help: Remove unused import: `sqlalchemy.future.select`

src/infrastructure/persistence/real_database_service.py:12:61: F401 [*] `src.infrastructure.persistence.database_manager.Database` imported but unused
   |
11 | from src.infrastructure.logging_config import get_logger
12 | from src.infrastructure.persistence.database_manager import Database
   |                                                             ^^^^^^^^ F401
13 | from src.infrastructure.persistence.models.child_model import ChildModel
14 | from src.infrastructure.persistence.models.conversation_models import ConversationModel
   |
   = help: Remove unused import: `src.infrastructure.persistence.database_manager.Database`

src/infrastructure/persistence/real_database_service.py:13:63: F401 [*] `src.infrastructure.persistence.models.child_model.ChildModel` imported but unused
   |
11 | from src.infrastructure.logging_config import get_logger
12 | from src.infrastructure.persistence.database_manager import Database
13 | from src.infrastructure.persistence.models.child_model import ChildModel
   |                                                               ^^^^^^^^^^ F401
14 | from src.infrastructure.persistence.models.conversation_models import ConversationModel
15 | from src.infrastructure.persistence.models.user_model import UserModel
   |
   = help: Remove unused import: `src.infrastructure.persistence.models.child_model.ChildModel`

src/infrastructure/persistence/real_database_service.py:14:71: F401 [*] `src.infrastructure.persistence.models.conversation_models.ConversationModel` imported but unused
   |
12 | from src.infrastructure.persistence.database_manager import Database
13 | from src.infrastructure.persistence.models.child_model import ChildModel
14 | from src.infrastructure.persistence.models.conversation_models import ConversationModel
   |                                                                       ^^^^^^^^^^^^^^^^^ F401
15 | from src.infrastructure.persistence.models.user_model import UserModel
   |
   = help: Remove unused import: `src.infrastructure.persistence.models.conversation_models.ConversationModel`

src/infrastructure/persistence/real_database_service.py:15:62: F401 [*] `src.infrastructure.persistence.models.user_model.UserModel` imported but unused
   |
13 | from src.infrastructure.persistence.models.child_model import ChildModel
14 | from src.infrastructure.persistence.models.conversation_models import ConversationModel
15 | from src.infrastructure.persistence.models.user_model import UserModel
   |                                                              ^^^^^^^^^ F401
16 |
17 | logger = get_logger(__name__, component="persistence")
   |
   = help: Remove unused import: `src.infrastructure.persistence.models.user_model.UserModel`

src/infrastructure/persistence/real_database_service.py:24:41: ARG002 Unused method argument: `field`
   |
22 | def get_sql_injection_prevention():
23 |     class DummyPrevention:
24 |         def sanitize_input(self, value, field):
   |                                         ^^^^^ ARG002
25 |             class Result:
26 |                 safe = True
   |

src/infrastructure/persistence/real_database_service.py:28:33: RUF012 Mutable class attributes should be annotated with `typing.ClassVar`
   |
26 |                 safe = True
27 |                 sanitized_input = value
28 |                 threats_found = []
   |                                 ^^ RUF012
29 |
30 |             return Result()
   |

src/infrastructure/persistence/redis_accessibility_profile_repository.py:19:5: D205 1 blank line required between summary line and description
   |
18 |   class RedisAccessibilityProfileRepository(IAccessibilityProfileRepository):
19 | /     """Redis implementation of the accessibility profile repository.
20 | |     Serializes and deserializes AccessibilityProfile objects to/from Redis.
21 | |     """
   | |_______^ D205
22 |
23 |       PROFILE_KEY_PREFIX = "accessibility_profile:"
   |
   = help: Insert single blank line

src/infrastructure/persistence/redis_accessibility_profile_repository.py:68:13: TRY300 Consider moving this statement to an `else` block
   |
66 |                 f"Accessibility profile for child {child_id} not found in Redis.",
67 |             )
68 |             return None
   |             ^^^^^^^^^^^ TRY300
69 |         except Exception as e:
70 |             self.logger.error(
   |

src/infrastructure/persistence/redis_accessibility_profile_repository.py:71:89: E501 Line too long (92 > 88)
   |
69 |         except Exception as e:
70 |             self.logger.error(
71 |                 f"Error getting accessibility profile for child {child_id} from Redis: {e}",
   |                                                                                         ^^^^ E501
72 |                 exc_info=True,
73 |             )
   |

src/infrastructure/persistence/redis_accessibility_profile_repository.py:95:89: E501 Line too long (97 > 88)
   |
93 |         except Exception as e:
94 |             self.logger.error(
95 |                 f"Error saving accessibility profile for child {profile.child_id} to Redis: {e}",
   |                                                                                         ^^^^^^^^^ E501
96 |                 exc_info=True,
97 |             )
   |

src/infrastructure/persistence/redis_accessibility_profile_repository.py:110:89: E501 Line too long (95 > 88)
    |
108 |                 return True
109 |             self.logger.debug(
110 |                 f"Accessibility profile for child {child_id} not found for deletion in Redis.",
    |                                                                                         ^^^^^^^ E501
111 |             )
112 |             return False
    |

src/infrastructure/persistence/redis_accessibility_profile_repository.py:112:13: TRY300 Consider moving this statement to an `else` block
    |
110 |                 f"Accessibility profile for child {child_id} not found for deletion in Redis.",
111 |             )
112 |             return False
    |             ^^^^^^^^^^^^ TRY300
113 |         except Exception as e:
114 |             self.logger.error(
    |

src/infrastructure/persistence/redis_accessibility_profile_repository.py:115:89: E501 Line too long (93 > 88)
    |
113 |         except Exception as e:
114 |             self.logger.error(
115 |                 f"Error deleting accessibility profile for child {child_id} from Redis: {e}",
    |                                                                                         ^^^^^ E501
116 |                 exc_info=True,
117 |             )
    |

src/infrastructure/persistence/redis_accessibility_profile_repository.py:121:89: E501 Line too long (89 > 88)
    |
120 |     async def get_all_profiles(self) -> list[AccessibilityProfile]:
121 |         # In a production system, this operation should be avoided or carefully paginated
    |                                                                                         ^ E501
122 |         # as it can be very resource intensive on large datasets.
123 |         # For now, a placeholder that logs a warning.
    |

src/infrastructure/persistence/redis_accessibility_profile_repository.py:125:89: E501 Line too long (116 > 88)
    |
123 |         # For now, a placeholder that logs a warning.
124 |         self.logger.warning(
125 |             "Attempted to retrieve all accessibility profiles. This operation is not optimized for large datasets.",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
126 |         )
127 |         # A real implementation would involve Redis SCAN or other techniques
    |

src/infrastructure/persistence/redis_notification_repository.py:20:5: D205 1 blank line required between summary line and description
   |
19 |   class RedisNotificationRepository(INotificationRepository):
20 | /     """Redis implementation of the notification repository.
21 | |     Stores notification records in Redis.
22 | |     """
   | |_______^ D205
23 |
24 |       NOTIFICATION_KEY_PREFIX = "notification:"
   |
   = help: Insert single blank line

src/infrastructure/persistence/redis_notification_repository.py:55:89: E501 Line too long (90 > 88)
   |
53 |             }
54 |             await self.redis_client.set(key, json.dumps(notification_data_dict))
55 |             # Store in recipient's history (e.g., as a list of IDs or a ZSET for ordering)
   |                                                                                         ^^ E501
56 |             # For simplicity, using a list of IDs for now, or could use hset
57 |             # for a smaller set of recent items
   |

src/infrastructure/persistence/redis_notification_repository.py:65:89: E501 Line too long (105 > 88)
   |
63 |             )  # Keep last 100 notifications per recipient
64 |             self.logger.debug(
65 |                 f"Saved notification {notification.id} for recipient {notification.recipient} to Redis.",
   |                                                                                         ^^^^^^^^^^^^^^^^^ E501
66 |             )
67 |         except Exception as e:
   |

src/infrastructure/persistence/redis_notification_repository.py:111:13: TRY300 Consider moving this statement to an `else` block
    |
109 |                 return notification
110 |             self.logger.debug(f"Notification {notification_id} not found in Redis.")
111 |             return None
    |             ^^^^^^^^^^^ TRY300
112 |         except Exception as e:
113 |             self.logger.error(
    |

src/infrastructure/persistence/redis_notification_repository.py:133:89: E501 Line too long (91 > 88)
    |
131 |                     notifications.append(notification)
132 |             self.logger.debug(
133 |                 f"Retrieved {len(notifications)} notifications for recipient {recipient}.",
    |                                                                                         ^^^ E501
134 |             )
135 |             return notifications
    |

src/infrastructure/persistence/redis_notification_repository.py:135:13: TRY300 Consider moving this statement to an `else` block
    |
133 |                 f"Retrieved {len(notifications)} notifications for recipient {recipient}.",
134 |             )
135 |             return notifications
    |             ^^^^^^^^^^^^^^^^^^^^ TRY300
136 |         except Exception as e:
137 |             self.logger.error(
    |

src/infrastructure/persistence/redis_notification_repository.py:138:89: E501 Line too long (89 > 88)
    |
136 |         except Exception as e:
137 |             self.logger.error(
138 |                 f"Error getting notifications for recipient {recipient} from Redis: {e}",
    |                                                                                         ^ E501
139 |                 exc_info=True,
140 |             )
    |

src/infrastructure/persistence/redis_notification_repository.py:153:13: TRY300 Consider moving this statement to an `else` block
    |
151 |                 f"Notification {notification_id} not found for deletion in Redis.",
152 |             )
153 |             return False
    |             ^^^^^^^^^^^^ TRY300
154 |         except Exception as e:
155 |             self.logger.error(
    |

src/infrastructure/persistence/redis_personality_profile_repository.py:20:5: D205 1 blank line required between summary line and description
   |
19 |   class RedisPersonalityProfileRepository(IPersonalityProfileRepository):
20 | /     """Redis implementation of the personality profile repository.
21 | |     Serializes and deserializes ChildPersonality objects to/from Redis.
22 | |     """
   | |_______^ D205
23 |
24 |       PROFILE_KEY_PREFIX = "personality_profile:"
   |
   = help: Insert single blank line

src/infrastructure/persistence/redis_personality_profile_repository.py:59:13: TRY300 Consider moving this statement to an `else` block
   |
57 |                 f"Personality profile for child {child_id} not found in Redis.",
58 |             )
59 |             return None
   |             ^^^^^^^^^^^ TRY300
60 |         except Exception as e:
61 |             self.logger.error(
   |

src/infrastructure/persistence/redis_personality_profile_repository.py:62:89: E501 Line too long (90 > 88)
   |
60 |         except Exception as e:
61 |             self.logger.error(
62 |                 f"Error getting personality profile for child {child_id} from Redis: {e}",
   |                                                                                         ^^ E501
63 |                 exc_info=True,
64 |             )
   |

src/infrastructure/persistence/redis_personality_profile_repository.py:87:89: E501 Line too long (95 > 88)
   |
85 |         except Exception as e:
86 |             self.logger.error(
87 |                 f"Error saving personality profile for child {profile.child_id} to Redis: {e}",
   |                                                                                         ^^^^^^^ E501
88 |                 exc_info=True,
89 |             )
   |

src/infrastructure/persistence/redis_personality_profile_repository.py:102:89: E501 Line too long (93 > 88)
    |
100 |                 return True
101 |             self.logger.debug(
102 |                 f"Personality profile for child {child_id} not found for deletion in Redis.",
    |                                                                                         ^^^^^ E501
103 |             )
104 |             return False
    |

src/infrastructure/persistence/redis_personality_profile_repository.py:104:13: TRY300 Consider moving this statement to an `else` block
    |
102 |                 f"Personality profile for child {child_id} not found for deletion in Redis.",
103 |             )
104 |             return False
    |             ^^^^^^^^^^^^ TRY300
105 |         except Exception as e:
106 |             self.logger.error(
    |

src/infrastructure/persistence/redis_personality_profile_repository.py:107:89: E501 Line too long (91 > 88)
    |
105 |         except Exception as e:
106 |             self.logger.error(
107 |                 f"Error deleting personality profile for child {child_id} from Redis: {e}",
    |                                                                                         ^^^ E501
108 |                 exc_info=True,
109 |             )
    |

src/infrastructure/persistence/redis_personality_profile_repository.py:113:89: E501 Line too long (89 > 88)
    |
112 |     async def get_all_profiles(self) -> list[ChildPersonality]:
113 |         # In a production system, this operation should be avoided or carefully paginated
    |                                                                                         ^ E501
114 |         # as it can be very resource intensive on large datasets.
115 |         # For now, a placeholder that logs a warning.
    |

src/infrastructure/persistence/redis_personality_profile_repository.py:117:89: E501 Line too long (114 > 88)
    |
115 |         # For now, a placeholder that logs a warning.
116 |         self.logger.warning(
117 |             "Attempted to retrieve all personality profiles. This operation is not optimized for large datasets.",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
118 |         )
119 |         # A real implementation would involve Redis SCAN or other techniques
    |

src/infrastructure/persistence/redis_session_repository.py:15:5: D205 1 blank line required between summary line and description
   |
14 |   class RedisSessionRepository(ISessionRepository):
15 | /     """Redis implementation of the session repository.
16 | |     Stores session data in Redis, leveraging its key-value store and expiration capabilities.
17 | |     """
   | |_______^ D205
18 |
19 |       SESSION_KEY_PREFIX = "session:"
   |
   = help: Insert single blank line

src/infrastructure/persistence/redis_session_repository.py:16:89: E501 Line too long (93 > 88)
   |
14 | class RedisSessionRepository(ISessionRepository):
15 |     """Redis implementation of the session repository.
16 |     Stores session data in Redis, leveraging its key-value store and expiration capabilities.
   |                                                                                         ^^^^^ E501
17 |     """
   |

src/infrastructure/persistence/redis_session_repository.py:44:13: TRY300 Consider moving this statement to an `else` block
   |
42 |                 return session_data
43 |             self.logger.debug(f"Session {session_id} not found in Redis.")
44 |             return None
   |             ^^^^^^^^^^^ TRY300
45 |         except Exception as e:
46 |             self.logger.error(
   |

src/infrastructure/persistence/redis_session_repository.py:70:89: E501 Line too long (104 > 88)
   |
68 |             )
69 |             self.logger.debug(
70 |                 f"Saved session {session_data.session_id} to Redis with timeout {timeout_minutes} min.",
   |                                                                                         ^^^^^^^^^^^^^^^^ E501
71 |             )
72 |         except Exception as e:
   |

src/infrastructure/persistence/redis_session_repository.py:87:13: TRY300 Consider moving this statement to an `else` block
   |
85 |                 return True
86 |             self.logger.debug(f"Session {session_id} not found for deletion in Redis.")
87 |             return False
   |             ^^^^^^^^^^^^ TRY300
88 |         except Exception as e:
89 |             self.logger.error(
   |

src/infrastructure/persistence/redis_session_repository.py:95:36: ARG002 Unused method argument: `timeout_minutes`
   |
93 |             return False
94 |
95 |     async def delete_expired(self, timeout_minutes: int) -> None:
   |                                    ^^^^^^^^^^^^^^^ ARG002
96 |         # Redis handles expiration automatically via SETEX, so explicit mass deletion of expired
97 |         # sessions is not typically needed. However, if there were a need to clean up sessions
   |

src/infrastructure/persistence/redis_session_repository.py:96:89: E501 Line too long (96 > 88)
   |
95 |     async def delete_expired(self, timeout_minutes: int) -> None:
96 |         # Redis handles expiration automatically via SETEX, so explicit mass deletion of expired
   |                                                                                         ^^^^^^^^ E501
97 |         # sessions is not typically needed. However, if there were a need to clean up sessions
98 |         # that somehow outlived their SETEX (e.g., due to Redis restart without AOF/RDB sync),
   |

src/infrastructure/persistence/redis_session_repository.py:97:89: E501 Line too long (94 > 88)
   |
95 |     async def delete_expired(self, timeout_minutes: int) -> None:
96 |         # Redis handles expiration automatically via SETEX, so explicit mass deletion of expired
97 |         # sessions is not typically needed. However, if there were a need to clean up sessions
   |                                                                                         ^^^^^^ E501
98 |         # that somehow outlived their SETEX (e.g., due to Redis restart without AOF/RDB sync),
99 |         # a scan and check approach would be used here. For simplicity and leveraging SETEX,
   |

src/infrastructure/persistence/redis_session_repository.py:98:89: E501 Line too long (94 > 88)
    |
 96 |         # Redis handles expiration automatically via SETEX, so explicit mass deletion of expired
 97 |         # sessions is not typically needed. However, if there were a need to clean up sessions
 98 |         # that somehow outlived their SETEX (e.g., due to Redis restart without AOF/RDB sync),
    |                                                                                         ^^^^^^ E501
 99 |         # a scan and check approach would be used here. For simplicity and leveraging SETEX,
100 |         # this method can log that explicit cleanup is handled by Redis's TTL.
    |

src/infrastructure/persistence/redis_session_repository.py:99:89: E501 Line too long (92 > 88)
    |
 97 |         # sessions is not typically needed. However, if there were a need to clean up sessions
 98 |         # that somehow outlived their SETEX (e.g., due to Redis restart without AOF/RDB sync),
 99 |         # a scan and check approach would be used here. For simplicity and leveraging SETEX,
    |                                                                                         ^^^^ E501
100 |         # this method can log that explicit cleanup is handled by Redis's TTL.
101 |         self.logger.info(
    |

src/infrastructure/persistence/redis_session_repository.py:102:89: E501 Line too long (100 > 88)
    |
100 |         # this method can log that explicit cleanup is handled by Redis's TTL.
101 |         self.logger.info(
102 |             "Redis handles session expiration automatically. Explicit delete_expired not required.",
    |                                                                                         ^^^^^^^^^^^^ E501
103 |         )
    |

src/infrastructure/persistence/repositories.py:51:19: TRY003 Avoid specifying long messages outside the exception class
   |
49 |         # Input validation
50 |         if not query or not isinstance(query, str):
51 |             raise ValueError("Valid query string is required")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
52 |         if len(query) > 200:
53 |             raise ValueError("Query too long - maximum 200 characters")
   |

src/infrastructure/persistence/repositories.py:52:25: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
   |
50 |         if not query or not isinstance(query, str):
51 |             raise ValueError("Valid query string is required")
52 |         if len(query) > 200:
   |                         ^^^ PLR2004
53 |             raise ValueError("Query too long - maximum 200 characters")
   |

src/infrastructure/persistence/repositories.py:53:19: TRY003 Avoid specifying long messages outside the exception class
   |
51 |             raise ValueError("Valid query string is required")
52 |         if len(query) > 200:
53 |             raise ValueError("Query too long - maximum 200 characters")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
54 |
55 |         # Security: Log all data access for audit
   |

src/infrastructure/persistence/repositories.py:60:19: TRY003 Avoid specifying long messages outside the exception class
   |
58 |         # Validate child_id if provided
59 |         if child_id and not self._is_valid_child_id(child_id):
60 |             raise PermissionError("Invalid child ID or access not allowed")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
61 |
62 |         # Handle different data types
   |

src/infrastructure/persistence/repositories.py:101:19: TRY003 Avoid specifying long messages outside the exception class
    |
 99 |         """Retrieves a child's profile data."""
100 |         if child_id not in self._child_data:
101 |             raise ValueError("Child profile not found")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
102 |         return self._child_data[child_id]
    |

src/infrastructure/persistence/repositories.py:132:89: E501 Line too long (90 > 88)
    |
130 |         """Removes data that has expired based on retention policies."""
131 |         datetime.utcnow() - timedelta(days=self.data_retention_days)
132 |         # Implement logic to iterate through data and remove if older than retention_limit
    |                                                                                         ^^ E501
133 |         logger.info("Expired data cleaning process completed.")
    |

src/infrastructure/persistence/repositories/__init__.py:9:89: E501 Line too long (133 > 88)
   |
 7 |     ChildRepository,
 8 | )
 9 | from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
10 |     ConversationRepository,
11 | )
   |

src/infrastructure/persistence/repositories/__init__.py:9:126: SyntaxError: Simple statements must be separated by newlines or semicolons
   |
 7 |     ChildRepository,
 8 | )
 9 | from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
   |                                                                                                                              ^^^^^^
10 |     ConversationRepository,
11 | )
   |

src/infrastructure/persistence/repositories/__init__.py:9:133: SyntaxError: Expected one or more symbol names after import
   |
 7 |     ChildRepository,
 8 | )
 9 | from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
   |                                                                                                                                     ^
10 |     ConversationRepository,
11 | )
   |

src/infrastructure/persistence/repositories/__init__.py:9:134: SyntaxError: missing closing parenthesis `)`
   |
 7 |     ChildRepository,
 8 | )
 9 | from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
   |                                                                                                                                      ^
10 |     ConversationRepository,
11 | )
12 | from src.infrastructure.persistence.repositories.safety_repository import (
   |

src/infrastructure/persistence/repositories/__init__.py:10:1: SyntaxError: Unexpected indentation
   |
 8 | )
 9 | from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
10 |     ConversationRepository,
   | ^^^^
11 | )
12 | from src.infrastructure.persistence.repositories.safety_repository import (
   |

src/infrastructure/persistence/repositories/__init__.py:10:27: COM818 Trailing comma on bare tuple prohibited
   |
 8 | )
 9 | from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
10 |     ConversationRepository,
   |                           ^ COM818
11 | )
12 | from src.infrastructure.persistence.repositories.safety_repository import (
   |

src/infrastructure/persistence/repositories/__init__.py:11:1: SyntaxError: Expected a statement
   |
 9 | from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
10 |     ConversationRepository,
11 | )
   | ^
12 | from src.infrastructure.persistence.repositories.safety_repository import (
13 |     SafetyRepository,
   |

src/infrastructure/persistence/repositories/__init__.py:11:2: SyntaxError: Expected a statement
   |
 9 | from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
10 |     ConversationRepository,
11 | )
   |  ^
12 | from src.infrastructure.persistence.repositories.safety_repository import (
13 |     SafetyRepository,
14 | )
   |

src/infrastructure/persistence/repositories/safety_repository.py:73:13: TRY300 Consider moving this statement to an `else` block
   |
71 |                 f"Type={event_type}, Severity={severity}, Details={details}",
72 |             )
73 |             return event_id
   |             ^^^^^^^^^^^^^^^ TRY300
74 |         except SecurityError as e:
75 |             logger.error(f"Security error recording safety event: {e}")
   |

src/infrastructure/persistence/repositories/safety_repository.py:75:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
73 |             return event_id
74 |         except SecurityError as e:
75 |             logger.error(f"Security error recording safety event: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
76 |             raise ValueError("Invalid data for safety event")
77 |         except Exception as e:
   |
   = help: Replace with `exception`

src/infrastructure/persistence/repositories/safety_repository.py:76:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
74 |         except SecurityError as e:
75 |             logger.error(f"Security error recording safety event: {e}")
76 |             raise ValueError("Invalid data for safety event")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
77 |         except Exception as e:
78 |             logger.error(f"Error recording safety event: {e}")
   |

src/infrastructure/persistence/repositories/safety_repository.py:76:19: TRY003 Avoid specifying long messages outside the exception class
   |
74 |         except SecurityError as e:
75 |             logger.error(f"Security error recording safety event: {e}")
76 |             raise ValueError("Invalid data for safety event")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
77 |         except Exception as e:
78 |             logger.error(f"Error recording safety event: {e}")
   |

src/infrastructure/persistence/repositories/safety_repository.py:78:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
76 |             raise ValueError("Invalid data for safety event")
77 |         except Exception as e:
78 |             logger.error(f"Error recording safety event: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
79 |             raise
   |
   = help: Replace with `exception`

src/infrastructure/persistence/repositories/usage_repository.py:49:21: TRY301 Abstract `raise` to an inner function
   |
47 |             for field in required_fields:
48 |                 if field not in usage_record:
49 |                     raise ValueError(f"Missing required field: {field}")
   |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
50 |
51 |             if usage_record["duration"] < 0:
   |

src/infrastructure/persistence/repositories/usage_repository.py:49:27: TRY003 Avoid specifying long messages outside the exception class
   |
47 |             for field in required_fields:
48 |                 if field not in usage_record:
49 |                     raise ValueError(f"Missing required field: {field}")
   |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
50 |
51 |             if usage_record["duration"] < 0:
   |

src/infrastructure/persistence/repositories/usage_repository.py:52:17: TRY301 Abstract `raise` to an inner function
   |
51 |               if usage_record["duration"] < 0:
52 | /                 raise ValueError(
53 | |                     f"Duration cannot be negative: {usage_record['duration']}",
54 | |                 )
   | |_________________^ TRY301
55 |
56 |               validated_operation = validate_database_operation(
   |

src/infrastructure/persistence/repositories/usage_repository.py:52:23: TRY003 Avoid specifying long messages outside the exception class
   |
51 |               if usage_record["duration"] < 0:
52 |                   raise ValueError(
   |  _______________________^
53 | |                     f"Duration cannot be negative: {usage_record['duration']}",
54 | |                 )
   | |_________________^ TRY003
55 |
56 |               validated_operation = validate_database_operation(
   |

src/infrastructure/persistence/repositories/usage_repository.py:75:13: TRY300 Consider moving this statement to an `else` block
   |
73 |             # In a real implementation, this would be saved to a database
74 |             logger.info(f"Usage recorded: {complete_record}")
75 |             return usage_id
   |             ^^^^^^^^^^^^^^^ TRY300
76 |         except (ValueError, SecurityError) as e:
77 |             logger.error(f"Error recording usage: {e}")
   |

src/infrastructure/persistence/repositories/usage_repository.py:77:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
75 |             return usage_id
76 |         except (ValueError, SecurityError) as e:
77 |             logger.error(f"Error recording usage: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
78 |             raise ValueError(f"Invalid usage data: {e}")
79 |         except Exception as e:
   |
   = help: Replace with `exception`

src/infrastructure/persistence/repositories/usage_repository.py:78:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
76 |         except (ValueError, SecurityError) as e:
77 |             logger.error(f"Error recording usage: {e}")
78 |             raise ValueError(f"Invalid usage data: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
79 |         except Exception as e:
80 |             logger.error(f"Unexpected error recording usage: {e}")
   |

src/infrastructure/persistence/repositories/usage_repository.py:78:19: TRY003 Avoid specifying long messages outside the exception class
   |
76 |         except (ValueError, SecurityError) as e:
77 |             logger.error(f"Error recording usage: {e}")
78 |             raise ValueError(f"Invalid usage data: {e}")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
79 |         except Exception as e:
80 |             logger.error(f"Unexpected error recording usage: {e}")
   |

src/infrastructure/persistence/repositories/usage_repository.py:80:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
78 |             raise ValueError(f"Invalid usage data: {e}")
79 |         except Exception as e:
80 |             logger.error(f"Unexpected error recording usage: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
81 |             raise
   |
   = help: Replace with `exception`

src/infrastructure/persistence/repositories/user_repository.py:80:21: TRY301 Abstract `raise` to an inner function
   |
78 |                 )
79 |                 if existing_user.scalar_one_or_none():
80 |                     raise ValueError("User with this email already exists")
   |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
81 |
82 |                 # Create new user
   |

src/infrastructure/persistence/repositories/user_repository.py:80:27: TRY003 Avoid specifying long messages outside the exception class
   |
78 |                 )
79 |                 if existing_user.scalar_one_or_none():
80 |                     raise ValueError("User with this email already exists")
   |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
81 |
82 |                 # Create new user
   |

src/infrastructure/persistence/repositories/user_repository.py:97:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
95 |         except IntegrityError:
96 |             logger.warning(f"Attempt to create duplicate user: {email}")
97 |             raise ValueError("User with this email already exists")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
98 |         except SecurityError as e:
99 |             logger.error(f"Security error creating user: {e}")
   |

src/infrastructure/persistence/repositories/user_repository.py:97:19: TRY003 Avoid specifying long messages outside the exception class
   |
95 |         except IntegrityError:
96 |             logger.warning(f"Attempt to create duplicate user: {email}")
97 |             raise ValueError("User with this email already exists")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
98 |         except SecurityError as e:
99 |             logger.error(f"Security error creating user: {e}")
   |

src/infrastructure/persistence/repositories/user_repository.py:99:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
 97 |             raise ValueError("User with this email already exists")
 98 |         except SecurityError as e:
 99 |             logger.error(f"Security error creating user: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
100 |             raise ValueError("Invalid data provided for user creation")
101 |         except Exception as e:
    |
    = help: Replace with `exception`

src/infrastructure/persistence/repositories/user_repository.py:100:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
 98 |         except SecurityError as e:
 99 |             logger.error(f"Security error creating user: {e}")
100 |             raise ValueError("Invalid data provided for user creation")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
101 |         except Exception as e:
102 |             logger.error(f"Error creating user: {e}")
    |

src/infrastructure/persistence/repositories/user_repository.py:100:19: TRY003 Avoid specifying long messages outside the exception class
    |
 98 |         except SecurityError as e:
 99 |             logger.error(f"Security error creating user: {e}")
100 |             raise ValueError("Invalid data provided for user creation")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
101 |         except Exception as e:
102 |             logger.error(f"Error creating user: {e}")
    |

src/infrastructure/persistence/repositories/user_repository.py:102:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
100 |             raise ValueError("Invalid data provided for user creation")
101 |         except Exception as e:
102 |             logger.error(f"Error creating user: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
103 |             raise
    |
    = help: Replace with `exception`

src/infrastructure/persistence/repositories/user_repository.py:131:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
129 |                 return None
130 |         except Exception as e:
131 |             logger.error(f"Error getting user by email: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
132 |             raise
    |
    = help: Replace with `exception`

src/infrastructure/persistence/repositories/user_repository.py:164:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
162 |                 return result.rowcount > 0
163 |         except SecurityError as e:
164 |             logger.error(f"Security error updating user role: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
165 |             return False
166 |         except Exception as e:
    |
    = help: Replace with `exception`

src/infrastructure/persistence/repositories/user_repository.py:167:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
165 |             return False
166 |         except Exception as e:
167 |             logger.error(f"Error updating user role: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
168 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/repositories/event_sourced_child_repository.py:53:13: TRY300 Consider moving this statement to an `else` block
   |
52 |             self.logger.info(f"Retrieved {len(child_profiles)} child profiles")
53 |             return child_profiles
   |             ^^^^^^^^^^^^^^^^^^^^^ TRY300
54 |         except Exception as e:
55 |             self.logger.error(f"Error retrieving all child profiles: {e}")
   |

src/infrastructure/repositories/event_sourced_child_repository.py:55:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
53 |             return child_profiles
54 |         except Exception as e:
55 |             self.logger.error(f"Error retrieving all child profiles: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
56 |             return []
   |
   = help: Replace with `exception`

src/infrastructure/resilience/circuit_breaker.py:24:5: D205 1 blank line required between summary line and description
   |
23 |   class CircuitBreaker:
24 | /     """Circuit breaker implementation to prevent cascade failures.
25 | |     The circuit breaker has three states:
26 | |     - CLOSED: Normal operation, requests are passed through
27 | |     - OPEN: Circuit is open, requests are rejected immediately
28 | |     - HALF_OPEN: Limited requests are allowed to test if service is back.
29 | |     """
   | |_______^ D205
30 |
31 |       def __init__(
   |
   = help: Insert single blank line

src/infrastructure/resilience/circuit_breaker.py:52:89: E501 Line too long (94 > 88)
   |
50 |         self.state = CircuitBreakerState.CLOSED
51 |         logger.info(
52 |             f"Circuit breaker initialized: threshold={failure_threshold}, timeout={timeout}s",
   |                                                                                         ^^^^^^ E501
53 |         )
   |

src/infrastructure/resilience/circuit_breaker.py:79:89: E501 Line too long (90 > 88)
   |
77 |         else:
78 |             logger.debug(
79 |                 f"Circuit breaker: failure {self.failure_count}/{self.failure_threshold}",
   |                                                                                         ^^ E501
80 |             )
   |

src/infrastructure/resilience/circuit_breaker.py:101:23: TRY003 Avoid specifying long messages outside the exception class
    |
 99 |                   logger.info("Circuit breaker transitioning to half-open state")
100 |               else:
101 |                   raise CircuitBreakerOpenError(
    |  _______________________^
102 | |                     f"Circuit breaker is open. Will retry in "
103 | |                     f"{self.timeout - (time.time() - self.last_failure_time):.1f}s",
104 | |                 )
    | |_________________^ TRY003
105 |
106 |           try:
    |

src/infrastructure/resilience/circuit_breaker.py:109:13: TRY300 Consider moving this statement to an `else` block
    |
107 |             result = func(*args, **kwargs)
108 |             self._record_success()
109 |             return result
    |             ^^^^^^^^^^^^^ TRY300
110 |         except self.expected_exception:
111 |             self._record_failure()
    |

src/infrastructure/resilience/circuit_breaker.py:133:23: TRY003 Avoid specifying long messages outside the exception class
    |
131 |                   logger.info("Circuit breaker transitioning to half-open state")
132 |               else:
133 |                   raise CircuitBreakerOpenError(
    |  _______________________^
134 | |                     f"Circuit breaker is open. Will retry in "
135 | |                     f"{self.timeout - (time.time() - self.last_failure_time):.1f}s",
136 | |                 )
    | |_________________^ TRY003
137 |
138 |           try:
    |

src/infrastructure/resilience/circuit_breaker.py:141:13: TRY300 Consider moving this statement to an `else` block
    |
139 |             result = await func(*args, **kwargs)
140 |             self._record_success()
141 |             return result
    |             ^^^^^^^^^^^^^ TRY300
142 |         except self.expected_exception:
143 |             self._record_failure()
    |

src/infrastructure/resilience/retry_decorator.py:28:5: PLR0913 Too many arguments in function definition (6 > 5)
   |
28 | def retry_with_backoff(
   |     ^^^^^^^^^^^^^^^^^^ PLR0913
29 |     max_attempts: int = 3,
30 |     base_delay: float = 1.0,
   |

src/infrastructure/resilience/retry_decorator.py:61:25: TRY400 Use `logging.exception` instead of `logging.error`
   |
59 |                       last_exception = e
60 |                       if attempt == max_attempts - 1:
61 | /                         logger.error(
62 | |                             f"Function {func.__name__} failed after {max_attempts} attempts: {e}",
63 | |                         )
   | |_________________________^ TRY400
64 |                           raise
   |
   = help: Replace with `exception`

src/infrastructure/resilience/retry_decorator.py:62:89: E501 Line too long (98 > 88)
   |
60 |                     if attempt == max_attempts - 1:
61 |                         logger.error(
62 |                             f"Function {func.__name__} failed after {max_attempts} attempts: {e}",
   |                                                                                         ^^^^^^^^^^ E501
63 |                         )
64 |                         raise
   |

src/infrastructure/resilience/retry_decorator.py:71:40: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
   |
69 |                     # Add jitter to prevent thundering herd
70 |                     if jitter:
71 |                         delay *= 0.5 + random.random() * 0.5
   |                                        ^^^^^^^^^^^^^^^ S311
72 |
73 |                     logger.warning(
   |

src/infrastructure/resilience/retry_decorator.py:74:89: E501 Line too long (97 > 88)
   |
73 |                     logger.warning(
74 |                         f"Attempt {attempt + 1}/{max_attempts} failed for {func.__name__}: {e}. "
   |                                                                                         ^^^^^^^^^ E501
75 |                         f"Retrying in {delay:.2f}s",
76 |                     )
   |

src/infrastructure/resilience/retry_decorator.py:92:25: TRY400 Use `logging.exception` instead of `logging.error`
   |
90 |                       last_exception = e
91 |                       if attempt == max_attempts - 1:
92 | /                         logger.error(
93 | |                             f"Function {func.__name__} failed after {max_attempts} attempts: {e}",
94 | |                         )
   | |_________________________^ TRY400
95 |                           raise
   |
   = help: Replace with `exception`

src/infrastructure/resilience/retry_decorator.py:93:89: E501 Line too long (98 > 88)
   |
91 |                     if attempt == max_attempts - 1:
92 |                         logger.error(
93 |                             f"Function {func.__name__} failed after {max_attempts} attempts: {e}",
   |                                                                                         ^^^^^^^^^^ E501
94 |                         )
95 |                         raise
   |

src/infrastructure/resilience/retry_decorator.py:102:40: S311 Standard pseudo-random generators are not suitable for cryptographic purposes
    |
100 |                     # Add jitter to prevent thundering herd
101 |                     if jitter:
102 |                         delay *= 0.5 + random.random() * 0.5
    |                                        ^^^^^^^^^^^^^^^ S311
103 |
104 |                     logger.warning(
    |

src/infrastructure/resilience/retry_decorator.py:105:89: E501 Line too long (97 > 88)
    |
104 |                     logger.warning(
105 |                         f"Attempt {attempt + 1}/{max_attempts} failed for {func.__name__}: {e}. "
    |                                                                                         ^^^^^^^^^ E501
106 |                         f"Retrying in {delay:.2f}s",
107 |                     )
    |

src/infrastructure/resilience/retry_decorator.py:122:5: D205 1 blank line required between summary line and description
    |
121 |   def retry_external_api(max_attempts: int = 3, base_delay: float = 1.0) -> Callable:
122 | /     """Simplified retry decorator specifically for external API calls.
123 | |     Retries on common network and API errors.
124 | |     """
    | |_______^ D205
125 |       try:
126 |           from requests.exceptions import (
    |
    = help: Insert single blank line

src/infrastructure/resilience/retry_decorator.py:126:9: PLC0415 `import` should be at the top-level of a file
    |
124 |       """
125 |       try:
126 | /         from requests.exceptions import (
127 | |             ConnectionError,
128 | |             RequestException,
129 | |             Timeout,
130 | |         )
    | |_________^ PLC0415
131 |
132 |           retryable_exceptions = (
    |

src/infrastructure/resilience/retry_decorator.py:127:13: A004 Import `ConnectionError` is shadowing a Python builtin
    |
125 |     try:
126 |         from requests.exceptions import (
127 |             ConnectionError,
    |             ^^^^^^^^^^^^^^^ A004
128 |             RequestException,
129 |             Timeout,
    |

src/infrastructure/security/access_control_service.py:83:15: PLR0913 Too many arguments in function definition (6 > 5)
   |
81 |         }
82 |
83 |     async def register_parent_child_relationship(
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLR0913
84 |         self,
85 |         parent_id: str,
   |

src/infrastructure/security/access_control_service.py:137:9: ARG002 Unused method argument: `context`
    |
135 |         child_id: str,
136 |         action: AccessAction,
137 |         context: dict[str, Any] | None = None,
    |         ^^^^^^^ ARG002
138 |     ) -> dict[str, Any]:
139 |         """Verify that a parent has permission to perform an action on child data."""
    |

src/infrastructure/security/access_control_service.py:196:89: E501 Line too long (98 > 88)
    |
194 |                 return {
195 |                     "access_granted": False,
196 |                     "reason": f"Access level {access_level.value} does not permit {action.value}",
    |                                                                                         ^^^^^^^^^^ E501
197 |                     "error_code": "INSUFFICIENT_PERMISSIONS",
198 |                 }
    |

src/infrastructure/security/access_control_service.py:230:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
228 |             }
229 |         except Exception as e:
230 |             logger.error(f"Access verification error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
231 |             await self._log_failed_access(
232 |                 parent_id,
    |
    = help: Replace with `exception`

src/infrastructure/security/access_control_service.py:322:15: PLR0913 Too many arguments in function definition (6 > 5)
    |
320 |         }
321 |
322 |     async def _log_audit_event(
    |               ^^^^^^^^^^^^^^^^ PLR0913
323 |         self,
324 |         parent_id: str,
    |

src/infrastructure/security/access_control_service.py:373:36: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
    |
371 |         ]
372 |
373 |         if len(recent_failures) >= 5:
    |                                    ^ PLR2004
374 |             logger.warning(
375 |                 f"Suspicious access activity detected for parent {parent_id}",
    |

src/infrastructure/security/api_security_manager.py:58:89: E501 Line too long (113 > 88)
   |
57 |             logger.debug(
58 |                 f"Rate limit check passed for {ip_address}: {len(request_times)}/{self.rate_limit_max_requests}",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^ E501
59 |             )
   |

src/infrastructure/security/api_security_manager.py:61:13: TRY300 Consider moving this statement to an `else` block
   |
59 |             )
60 |
61 |             return True
   |             ^^^^^^^^^^^ TRY300
62 |         except Exception as e:
63 |             logger.error(f"Error checking rate limit for {ip_address}: {e}")
   |

src/infrastructure/security/api_security_manager.py:63:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
61 |             return True
62 |         except Exception as e:
63 |             logger.error(f"Error checking rate limit for {ip_address}: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
64 |             # Fail open - allow request if there's an error
65 |             return True
   |
   = help: Replace with `exception`

src/infrastructure/security/api_security_manager.py:103:60: PLR2004 Magic value used in comparison, consider replacing `32` with a constant variable
    |
101 |             # Remove control characters except newline and tab
102 |             sanitized = "".join(
103 |                 char for char in sanitized if ord(char) >= 32 or char in "\n\t"
    |                                                            ^^ PLR2004
104 |             )
    |

src/infrastructure/security/api_security_manager.py:137:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
135 |             return sanitized.strip()
136 |         except Exception as e:
137 |             logger.error(f"Error sanitizing input: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
138 |             # Return empty string if sanitization fails
139 |             return ""
    |
    = help: Replace with `exception`

src/infrastructure/security/api_security_manager.py:181:34: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
    |
179 |             # Check for excessive caps (shouting)
180 |             if (
181 |                 len(sanitized) > 10
    |                                  ^^ PLR2004
182 |                 and sum(1 for c in sanitized if c.isupper()) / len(sanitized) > 0.7
183 |             ):
    |

src/infrastructure/security/api_security_manager.py:182:81: PLR2004 Magic value used in comparison, consider replacing `0.7` with a constant variable
    |
180 |             if (
181 |                 len(sanitized) > 10
182 |                 and sum(1 for c in sanitized if c.isupper()) / len(sanitized) > 0.7
    |                                                                                 ^^^ PLR2004
183 |             ):
184 |                 result["warnings"].append("Input contains excessive capital letters")
    |

src/infrastructure/security/api_security_manager.py:188:34: PLR2004 Magic value used in comparison, consider replacing `20` with a constant variable
    |
186 |             # Check for repetitive content
187 |             if (
188 |                 len(sanitized) > 20
    |                                  ^^ PLR2004
189 |                 and len(set(sanitized.lower())) < len(sanitized) * 0.3
190 |             ):
    |

src/infrastructure/security/api_security_manager.py:197:13: TRY300 Consider moving this statement to an `else` block
    |
195 |             )
196 |
197 |             return result
    |             ^^^^^^^^^^^^^ TRY300
198 |         except Exception as e:
199 |             logger.error(f"Error validating child input: {e}")
    |

src/infrastructure/security/api_security_manager.py:199:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
197 |             return result
198 |         except Exception as e:
199 |             logger.error(f"Error validating child input: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
200 |             result["is_safe"] = False
201 |             result["blocked_content"].append("Validation error occurred")
    |
    = help: Replace with `exception`

src/infrastructure/security/audit_decorators.py:20:5: PLR0915 Too many statements (74 > 50)
   |
20 | def audit_authentication(
   |     ^^^^^^^^^^^^^^^^^^^^ PLR0915
21 |     operation_type: str,
22 |     extract_email: Callable[[Any], str] | None = None,
   |

src/infrastructure/security/audit_decorators.py:25:5: D205 1 blank line required between summary line and description
   |
23 |       extract_ip: Callable[[Any], str] | None = None,
24 |   ):
25 | /     """Decorator to automatically audit authentication operations.
26 | |     Args: operation_type: Type of operation(login, logout, password_change)
27 | |         extract_email: Function to extract email from arguments
28 | |         extract_ip: Function to extract IP address from arguments.
29 | |     """
   | |_______^ D205
30 |
31 |       def decorator(func: Callable) -> Callable:
   |
   = help: Insert single blank line

src/infrastructure/security/audit_decorators.py:31:9: PLR0915 Too many statements (72 > 50)
   |
29 |     """
30 |
31 |     def decorator(func: Callable) -> Callable:
   |         ^^^^^^^^^ PLR0915
32 |         @functools.wraps(func)
33 |         async def async_wrapper(*args, **kwargs):
   |

src/infrastructure/security/audit_decorators.py:41:17: TRY300 Consider moving this statement to an `else` block
   |
39 |                 result = await func(*args, **kwargs)
40 |                 success = True
41 |                 return result
   |                 ^^^^^^^^^^^^^ TRY300
42 |             except Exception as e:
43 |                 error_message = str(e)
   |

src/infrastructure/security/audit_decorators.py:80:21: TRY400 Use `logging.exception` instead of `logging.error`
   |
78 |                       )
79 |                   except Exception as audit_error:
80 | /                     logger.error(
81 | |                         f"Failed to log audit event for {func.__name__}: {audit_error}",
82 | |                     )
   | |_____________________^ TRY400
83 |
84 |           @functools.wraps(func)
   |
   = help: Replace with `exception`

src/infrastructure/security/audit_decorators.py:93:17: TRY300 Consider moving this statement to an `else` block
   |
91 |                 result = func(*args, **kwargs)
92 |                 success = True
93 |                 return result
   |                 ^^^^^^^^^^^^^ TRY300
94 |             except Exception as e:
95 |                 error_message = str(e)
   |

src/infrastructure/security/audit_decorators.py:133:29: TRY400 Use `logging.exception` instead of `logging.error`
    |
131 |                               )
132 |                           except Exception as audit_error:
133 | /                             logger.error(
134 | |                                 f"Failed to log audit event for {func.__name__}: {audit_error}",
135 | |                             )
    | |_____________________________^ TRY400
136 |
137 |                       # Try to schedule the audit task
    |
    = help: Replace with `exception`

src/infrastructure/security/audit_decorators.py:134:89: E501 Line too long (96 > 88)
    |
132 |                         except Exception as audit_error:
133 |                             logger.error(
134 |                                 f"Failed to log audit event for {func.__name__}: {audit_error}",
    |                                                                                         ^^^^^^^^ E501
135 |                             )
    |

src/infrastructure/security/audit_decorators.py:140:25: RUF006 Store a reference to the return value of `loop.create_task`
    |
138 |                     try:
139 |                         loop = asyncio.get_event_loop()
140 |                         loop.create_task(log_audit())
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ RUF006
141 |                     except RuntimeError:
142 |                         # No event loop, skip audit (dev/test mode)
    |

src/infrastructure/security/audit_decorators.py:145:21: TRY400 Use `logging.exception` instead of `logging.error`
    |
143 |                           pass
144 |                   except Exception as audit_error:
145 | /                     logger.error(
146 | |                         f"Failed to schedule audit for {func.__name__}: {audit_error}",
147 | |                     )
    | |_____________________^ TRY400
148 |
149 |           # Return appropriate wrapper based on function type
    |
    = help: Replace with `exception`

src/infrastructure/security/audit_decorators.py:157:5: PLR0915 Too many statements (84 > 50)
    |
157 | def audit_data_access(
    |     ^^^^^^^^^^^^^^^^^ PLR0915
158 |     operation: str,
159 |     data_type: str,
    |

src/infrastructure/security/audit_decorators.py:164:5: D205 1 blank line required between summary line and description
    |
162 |       extract_ip: Callable[[Any], str] | None = None,
163 |   ):
164 | /     """Decorator to automatically audit data access operations.
165 | |     Args: operation: Type of operation(create, read, update, delete)
166 | |         data_type: Type of data being accessed
167 | |         extract_child_id: Function to extract child ID from arguments
168 | |         extract_user_id: Function to extract user ID from arguments
169 | |         extract_ip: Function to extract IP address from arguments.
170 | |     """
    | |_______^ D205
171 |
172 |       def decorator(func: Callable) -> Callable:
    |
    = help: Insert single blank line

src/infrastructure/security/audit_decorators.py:172:9: PLR0915 Too many statements (82 > 50)
    |
170 |     """
171 |
172 |     def decorator(func: Callable) -> Callable:
    |         ^^^^^^^^^ PLR0915
173 |         @functools.wraps(func)
174 |         async def async_wrapper(*args, **kwargs):
    |

src/infrastructure/security/audit_decorators.py:181:17: TRY300 Consider moving this statement to an `else` block
    |
179 |                 result = await func(*args, **kwargs)
180 |                 success = True
181 |                 return result
    |                 ^^^^^^^^^^^^^ TRY300
182 |             except Exception as e:
183 |                 error_message = str(e)
    |

src/infrastructure/security/audit_decorators.py:232:21: TRY400 Use `logging.exception` instead of `logging.error`
    |
230 |                           )
231 |                   except Exception as audit_error:
232 | /                     logger.error(
233 | |                         f"Failed to log data access audit for {func.__name__}: {audit_error}",
234 | |                     )
    | |_____________________^ TRY400
235 |
236 |           @functools.wraps(func)
    |
    = help: Replace with `exception`

src/infrastructure/security/audit_decorators.py:233:89: E501 Line too long (94 > 88)
    |
231 |                 except Exception as audit_error:
232 |                     logger.error(
233 |                         f"Failed to log data access audit for {func.__name__}: {audit_error}",
    |                                                                                         ^^^^^^ E501
234 |                     )
    |

src/infrastructure/security/audit_decorators.py:244:17: TRY300 Consider moving this statement to an `else` block
    |
242 |                 result = func(*args, **kwargs)
243 |                 success = True
244 |                 return result
    |                 ^^^^^^^^^^^^^ TRY300
245 |             except Exception as e:
246 |                 error_message = str(e)
    |

src/infrastructure/security/audit_decorators.py:292:29: TRY400 Use `logging.exception` instead of `logging.error`
    |
290 |                                   )
291 |                           except Exception as audit_error:
292 | /                             logger.error(
293 | |                                 f"Failed to log audit event for {func.__name__}: {audit_error}",
294 | |                             )
    | |_____________________________^ TRY400
295 |
296 |                       # Try to schedule the audit task
    |
    = help: Replace with `exception`

src/infrastructure/security/audit_decorators.py:293:89: E501 Line too long (96 > 88)
    |
291 |                         except Exception as audit_error:
292 |                             logger.error(
293 |                                 f"Failed to log audit event for {func.__name__}: {audit_error}",
    |                                                                                         ^^^^^^^^ E501
294 |                             )
    |

src/infrastructure/security/audit_decorators.py:299:25: RUF006 Store a reference to the return value of `loop.create_task`
    |
297 |                     try:
298 |                         loop = asyncio.get_event_loop()
299 |                         loop.create_task(log_audit())
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ RUF006
300 |                     except RuntimeError:
301 |                         # No event loop, skip audit (dev/test mode)
    |

src/infrastructure/security/audit_decorators.py:304:21: TRY400 Use `logging.exception` instead of `logging.error`
    |
302 |                           pass
303 |                   except Exception as audit_error:
304 | /                     logger.error(
305 | |                         f"Failed to schedule data access audit for {func.__name__}: {audit_error}",
306 | |                     )
    | |_____________________^ TRY400
307 |
308 |           # Return appropriate wrapper based on function type
    |
    = help: Replace with `exception`

src/infrastructure/security/audit_decorators.py:305:89: E501 Line too long (99 > 88)
    |
303 |                 except Exception as audit_error:
304 |                     logger.error(
305 |                         f"Failed to schedule data access audit for {func.__name__}: {audit_error}",
    |                                                                                         ^^^^^^^^^^^ E501
306 |                     )
    |

src/infrastructure/security/audit_decorators.py:316:5: PLR0915 Too many statements (71 > 50)
    |
316 | def audit_security_event(
    |     ^^^^^^^^^^^^^^^^^^^^ PLR0915
317 |     event_type: str,
318 |     severity: str = "info",
    |

src/infrastructure/security/audit_decorators.py:322:5: D205 1 blank line required between summary line and description
    |
320 |       extract_ip: Callable[[Any], str] | None = None,
321 |   ):
322 | /     """Decorator to automatically audit security events.
323 | |     Args: event_type: Type of security event
324 | |         severity: Event severity level
325 | |         extract_user_id: Function to extract user ID from arguments
326 | |         extract_ip: Function to extract IP address from arguments.
327 | |     """
    | |_______^ D205
328 |
329 |       def decorator(func: Callable) -> Callable:
    |
    = help: Insert single blank line

src/infrastructure/security/audit_decorators.py:329:9: PLR0915 Too many statements (69 > 50)
    |
327 |     """
328 |
329 |     def decorator(func: Callable) -> Callable:
    |         ^^^^^^^^^ PLR0915
330 |         @functools.wraps(func)
331 |         async def async_wrapper(*args, **kwargs):
    |

src/infrastructure/security/audit_decorators.py:338:17: TRY300 Consider moving this statement to an `else` block
    |
336 |                 result = await func(*args, **kwargs)
337 |                 success = True
338 |                 return result
    |                 ^^^^^^^^^^^^^ TRY300
339 |             except Exception as e:
340 |                 error_message = str(e)
    |

src/infrastructure/security/audit_decorators.py:380:21: TRY400 Use `logging.exception` instead of `logging.error`
    |
378 |                       )
379 |                   except Exception as audit_error:
380 | /                     logger.error(
381 | |                         f"Failed to log security audit for {func.__name__}: {audit_error}",
382 | |                     )
    | |_____________________^ TRY400
383 |
384 |           # Return appropriate wrapper based on function type
    |
    = help: Replace with `exception`

src/infrastructure/security/audit_decorators.py:381:89: E501 Line too long (91 > 88)
    |
379 |                 except Exception as audit_error:
380 |                     logger.error(
381 |                         f"Failed to log security audit for {func.__name__}: {audit_error}",
    |                                                                                         ^^^ E501
382 |                     )
    |

src/infrastructure/security/audit_decorators.py:397:17: TRY300 Consider moving this statement to an `else` block
    |
395 |                 result = func(*args, **kwargs)
396 |                 success = True
397 |                 return result
    |                 ^^^^^^^^^^^^^ TRY300
398 |             except Exception as e:
399 |                 error_message = str(e)
    |

src/infrastructure/security/audit_decorators.py:441:25: TRY400 Use `logging.exception` instead of `logging.error`
    |
439 |                           )
440 |                       except Exception as audit_error:
441 | /                         logger.error(
442 | |                             f"Failed to log security audit for {func.__name__}: {audit_error}",
443 | |                         )
    | |_________________________^ TRY400
444 |
445 |                   # Try to schedule the audit task
    |
    = help: Replace with `exception`

src/infrastructure/security/audit_decorators.py:442:89: E501 Line too long (95 > 88)
    |
440 |                     except Exception as audit_error:
441 |                         logger.error(
442 |                             f"Failed to log security audit for {func.__name__}: {audit_error}",
    |                                                                                         ^^^^^^^ E501
443 |                         )
    |

src/infrastructure/security/audit_decorators.py:448:21: RUF006 Store a reference to the return value of `loop.create_task`
    |
446 |                 try:
447 |                     loop = asyncio.get_event_loop()
448 |                     loop.create_task(log_audit())
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ RUF006
449 |                 except RuntimeError:
450 |                     # No event loop, skip audit (dev/test mode)
    |

src/infrastructure/security/audit_logger.py:19:89: E501 Line too long (90 > 88)
   |
18 | class AuditCategory(Enum):
19 |     """Categories for audit events to enable proper filtering and compliance reporting."""
   |                                                                                         ^^ E501
20 |
21 |     AUTHENTICATION = "authentication"
   |

src/infrastructure/security/audit_logger.py:40:23: S105 Possible hardcoded password assigned to: "PASSWORD_CHANGE"
   |
38 |     LOGIN_FAILURE = "login_failure"
39 |     LOGOUT = "logout"
40 |     PASSWORD_CHANGE = "password_change"
   |                       ^^^^^^^^^^^^^^^^^ S105
41 |     ACCOUNT_LOCKED = "account_locked"
   |

src/infrastructure/security/audit_logger.py:133:89: E501 Line too long (105 > 88)
    |
131 |     def calculate_checksum(self) -> str:
132 |         """Calculate checksum for tamper detection."""
133 |         content = f"{self.event_id}{self.timestamp.isoformat()}{self.event_type.value}{self.description}"
    |                                                                                         ^^^^^^^^^^^^^^^^^ E501
134 |         return hashlib.sha256(content.encode()).hexdigest()
    |

src/infrastructure/security/audit_logger.py:138:5: D205 1 blank line required between summary line and description
    |
137 |   class AuditLogger:
138 | /     """Enterprise - grade audit logging system with COPPA compliance features.
139 | |     Features:
140 | |     - Tamper - resistant logging with checksums
141 | |     - Encrypted audit logs
142 | |     - Real - time alerting for critical events
143 | |     - COPPA compliance tracking
144 | |     - Batch processing for performance
145 | |     - Automatic log rotation and retention.
146 | |     """
    | |_______^ D205
147 |
148 |       def __init__(self, config: AuditConfig) -> None:
    |
    = help: Insert single blank line

src/infrastructure/security/audit_logger.py:157:9: PTH103 `os.makedirs()` should be replaced by `Path.mkdir(parents=True)`
    |
155 |     def _ensure_log_directory(self) -> None:
156 |         """Ensure audit log directory exists."""
157 |         os.makedirs(self.config.log_directory, exist_ok=True)
    |         ^^^^^^^^^^^ PTH103
158 |
159 |     def _start_background_tasks(self) -> None:
    |

src/infrastructure/security/audit_logger.py:161:9: RUF006 Store a reference to the return value of `asyncio.create_task`
    |
159 |     def _start_background_tasks(self) -> None:
160 |         """Start background tasks for log processing."""
161 |         asyncio.create_task(self._flush_audit_buffer())
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ RUF006
162 |         asyncio.create_task(self._rotate_old_logs())
    |

src/infrastructure/security/audit_logger.py:162:9: RUF006 Store a reference to the return value of `asyncio.create_task`
    |
160 |         """Start background tasks for log processing."""
161 |         asyncio.create_task(self._flush_audit_buffer())
162 |         asyncio.create_task(self._rotate_old_logs())
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ RUF006
163 |
164 |     async def log_event(
    |

src/infrastructure/security/audit_logger.py:164:15: PLR0913 Too many arguments in function definition (6 > 5)
    |
162 |         asyncio.create_task(self._rotate_old_logs())
163 |
164 |     async def log_event(
    |               ^^^^^^^^^ PLR0913
165 |         self,
166 |         event_type: AuditEventType,
    |

src/infrastructure/security/audit_logger.py:213:13: TRY300 Consider moving this statement to an `else` block
    |
212 |             logger.debug(f"Audit event logged: {event_id} - {event_type.value}")
213 |             return event_id
    |             ^^^^^^^^^^^^^^^ TRY300
214 |         except Exception as e:
215 |             logger.error(f"Failed to log audit event: {e}")
    |

src/infrastructure/security/audit_logger.py:215:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
213 |             return event_id
214 |         except Exception as e:
215 |             logger.error(f"Failed to log audit event: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
216 |             # Fallback logging to ensure we don't lose critical events
217 |             logger.critical(f"AUDIT_FALLBACK: {event_type.value} - {description}")
    |
    = help: Replace with `exception`

src/infrastructure/security/audit_logger.py:220:15: PLR0913 Too many arguments in function definition (6 > 5)
    |
218 |             return event_id
219 |
220 |     async def log_child_interaction(
    |               ^^^^^^^^^^^^^^^^^^^^^ PLR0913
221 |         self,
222 |         child_id: str,
    |

src/infrastructure/security/audit_logger.py:249:68: PLR2004 Magic value used in comparison, consider replacing `100` with a constant variable
    |
247 |             response_hash = hashlib.sha256(response.encode()).hexdigest()[:16]
248 |         else:
249 |             content_hash = content[:100] + "..." if len(content) > 100 else content
    |                                                                    ^^^ PLR2004
250 |             response_hash = response[:100] + "..." if len(response) > 100 else response
    |

src/infrastructure/security/audit_logger.py:250:71: PLR2004 Magic value used in comparison, consider replacing `100` with a constant variable
    |
248 |         else:
249 |             content_hash = content[:100] + "..." if len(content) > 100 else content
250 |             response_hash = response[:100] + "..." if len(response) > 100 else response
    |                                                                       ^^^ PLR2004
251 |
252 |         details = {
    |

src/infrastructure/security/audit_logger.py:262:27: PLR2004 Magic value used in comparison, consider replacing `0.3` with a constant variable
    |
261 |         # Determine severity based on safety score
262 |         if safety_score < 0.3:
    |                           ^^^ PLR2004
263 |             severity = AuditSeverity.CRITICAL
264 |         elif safety_score < 0.7:
    |

src/infrastructure/security/audit_logger.py:264:29: PLR2004 Magic value used in comparison, consider replacing `0.7` with a constant variable
    |
262 |         if safety_score < 0.3:
263 |             severity = AuditSeverity.CRITICAL
264 |         elif safety_score < 0.7:
    |                             ^^^ PLR2004
265 |             severity = AuditSeverity.WARNING
266 |         else:
    |

src/infrastructure/security/audit_logger.py:273:89: E501 Line too long (94 > 88)
    |
271 |             severity=severity,
272 |             category=AuditCategory.CHILD_SAFETY,
273 |             description=f"Child interaction: {interaction_type} (safety: {safety_score:.2f})",
    |                                                                                         ^^^^^^ E501
274 |             context=context,
275 |             details=details,
    |

src/infrastructure/security/audit_logger.py:313:15: PLR0913 Too many arguments in function definition (6 > 5)
    |
311 |         )
312 |
313 |     async def log_data_access(
    |               ^^^^^^^^^^^^^^^ PLR0913
314 |         self,
315 |         user_id: str,
    |

src/infrastructure/security/audit_logger.py:405:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
403 |                 await self._send_security_alert(event)
404 |         except Exception as e:
405 |             logger.error(f"Failed to handle critical event {event.event_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
406 |
407 |     async def _send_security_alert(self, event: AuditEvent) -> None:
    |
    = help: Replace with `exception`

src/infrastructure/security/audit_logger.py:433:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
431 |                         await self._write_events_to_file(events_to_write)
432 |             except Exception as e:
433 |                 logger.error(f"Error in audit buffer flush: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
434 |
435 |     async def _write_events_to_file(self, events: list[AuditEvent]) -> None:
    |
    = help: Replace with `exception`

src/infrastructure/security/audit_logger.py:441:24: PTH118 `os.path.join()` should be replaced by `Path` with `/` operator
    |
440 |         try:
441 |             log_file = os.path.join(
    |                        ^^^^^^^^^^^^ PTH118
442 |                 self.config.log_directory,
443 |                 f"audit_{datetime.utcnow().strftime('%Y%m%d')}.jsonl",
    |

src/infrastructure/security/audit_logger.py:451:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
449 |                     await f.write(log_line + "\n")
450 |         except Exception as e:
451 |             logger.error(f"Failed to write audit events to file: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
452 |
453 |     async def _rotate_old_logs(self) -> None:
    |
    = help: Replace with `exception`

src/infrastructure/security/audit_logger.py:463:33: PTH208 Use `pathlib.Path.iterdir()` instead.
    |
461 |                 )
462 |
463 |                 for filename in os.listdir(self.config.log_directory):
    |                                 ^^^^^^^^^^ PTH208
464 |                     if filename.startswith("audit_") and filename.endswith(".jsonl"):
465 |                         file_path = os.path.join(self.config.log_directory, filename)
    |

src/infrastructure/security/audit_logger.py:465:37: PTH118 `os.path.join()` should be replaced by `Path` with `/` operator
    |
463 |                 for filename in os.listdir(self.config.log_directory):
464 |                     if filename.startswith("audit_") and filename.endswith(".jsonl"):
465 |                         file_path = os.path.join(self.config.log_directory, filename)
    |                                     ^^^^^^^^^^^^ PTH118
466 |                         file_stat = os.stat(file_path)
467 |                         file_date = datetime.fromtimestamp(file_stat.st_mtime)
    |

src/infrastructure/security/audit_logger.py:466:37: PTH116 `os.stat()` should be replaced by `Path.stat()`, `Path.owner()`, or `Path.group()`
    |
464 |                     if filename.startswith("audit_") and filename.endswith(".jsonl"):
465 |                         file_path = os.path.join(self.config.log_directory, filename)
466 |                         file_stat = os.stat(file_path)
    |                                     ^^^^^^^ PTH116
467 |                         file_date = datetime.fromtimestamp(file_stat.st_mtime)
    |

src/infrastructure/security/audit_logger.py:470:29: PTH107 `os.remove()` should be replaced by `Path.unlink()`
    |
469 |                         if file_date < cutoff_date:
470 |                             os.remove(file_path)
    |                             ^^^^^^^^^ PTH107
471 |                             logger.info(f"Rotated old audit log: {filename}")
472 |             except Exception as e:
    |
    = help: Replace with `Path(...).unlink()`

src/infrastructure/security/audit_logger.py:473:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
471 |                             logger.info(f"Rotated old audit log: {filename}")
472 |             except Exception as e:
473 |                 logger.error(f"Error in audit log rotation: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
    |
    = help: Replace with `exception`

src/infrastructure/security/audit_logger.py:482:12: PLW0603 Using the global statement to update `_audit_logger` is discouraged
    |
480 | def get_audit_logger() -> AuditLogger:
481 |     """Get or create global audit logger instance."""
482 |     global _audit_logger
    |            ^^^^^^^^^^^^^ PLW0603
483 |     if _audit_logger is None:
484 |         config = AuditConfig(
    |

src/infrastructure/security/child_data_security_manager.py:1:1: I001 [*] Import block is un-sorted or un-formatted
   |
 1 | / from datetime import datetime
 2 | | from typing import Any
 3 | |
 4 | | from src.infrastructure.logging_config import get_logger
 5 | | from src.infrastructure.security.child_data_encryption import (
 6 | |     ChildDataEncryption,
 7 | | )
 8 | | from src.infrastructure.security.coppa_validator import (
 9 | |     COPPAValidator,
10 | |     coppa_validator,
11 | |     is_coppa_subject,
12 | |     requires_parental_consent
13 | | )
   | |_^ I001
   |
   = help: Organize imports

src/infrastructure/security/child_data_security_manager.py:9:5: F401 [*] `src.infrastructure.security.coppa_validator.COPPAValidator` imported but unused
   |
 7 | )
 8 | from src.infrastructure.security.coppa_validator import (
 9 |     COPPAValidator,
   |     ^^^^^^^^^^^^^^ F401
10 |     coppa_validator,
11 |     is_coppa_subject,
   |
   = help: Remove unused import

src/infrastructure/security/child_data_security_manager.py:10:5: F401 [*] `src.infrastructure.security.coppa_validator.coppa_validator` imported but unused
   |
 8 | from src.infrastructure.security.coppa_validator import (
 9 |     COPPAValidator,
10 |     coppa_validator,
   |     ^^^^^^^^^^^^^^^ F401
11 |     is_coppa_subject,
12 |     requires_parental_consent
   |
   = help: Remove unused import

src/infrastructure/security/child_data_security_manager.py:11:5: F401 [*] `src.infrastructure.security.coppa_validator.is_coppa_subject` imported but unused
   |
 9 |     COPPAValidator,
10 |     coppa_validator,
11 |     is_coppa_subject,
   |     ^^^^^^^^^^^^^^^^ F401
12 |     requires_parental_consent
13 | )
   |
   = help: Remove unused import

src/infrastructure/security/child_data_security_manager.py:12:5: F401 [*] `src.infrastructure.security.coppa_validator.requires_parental_consent` imported but unused
   |
10 |     coppa_validator,
11 |     is_coppa_subject,
12 |     requires_parental_consent
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^ F401
13 | )
   |
   = help: Remove unused import

src/infrastructure/security/child_data_security_manager.py:24:30: F821 Undefined name `COPPAValidatorService`
   |
22 |     def __init__(self, encryption_key: str | None = None) -> None:
23 |         self.encryption = ChildDataEncryption(encryption_key)
24 |         self.coppa_service = COPPAValidatorService(self.encryption)
   |                              ^^^^^^^^^^^^^^^^^^^^^ F821
25 |
26 |     def secure_child_profile(
   |

src/infrastructure/security/child_data_security_manager.py:46:17: TRY301 Abstract `raise` to an inner function
   |
45 |               if not compliance_check["compliant"]:
46 | /                 raise ValueError(
47 | |                     f"COPPA compliance violations: {compliance_check['violations']}",
48 | |                 )
   | |_________________^ TRY301
49 |
50 |               # Encrypt sensitive data
   |

src/infrastructure/security/child_data_security_manager.py:46:23: TRY003 Avoid specifying long messages outside the exception class
   |
45 |               if not compliance_check["compliant"]:
46 |                   raise ValueError(
   |  _______________________^
47 | |                     f"COPPA compliance violations: {compliance_check['violations']}",
48 | |                 )
   | |_________________^ TRY003
49 |
50 |               # Encrypt sensitive data
   |

src/infrastructure/security/child_data_security_manager.py:56:89: E501 Line too long (92 > 88)
   |
54 |             encrypted_data["_coppa_compliance"] = {
55 |                 "consent_timestamp": consent_record.consent_timestamp.isoformat(),
56 |                 "data_retention_expires": consent_record.data_retention_expires.isoformat(),
   |                                                                                         ^^^^ E501
57 |                 "compliance_verified": True,
58 |             }
   |

src/infrastructure/security/child_data_security_manager.py:60:13: TRY300 Consider moving this statement to an `else` block
   |
58 |             }
59 |
60 |             return encrypted_data
   |             ^^^^^^^^^^^^^^^^^^^^^ TRY300
61 |         except Exception as e:
62 |             logger.error(f"Failed to secure child profile: {e}")
   |

src/infrastructure/security/child_data_security_manager.py:62:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
60 |             return encrypted_data
61 |         except Exception as e:
62 |             logger.error(f"Failed to secure child profile: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
63 |             raise
   |
   = help: Replace with `exception`

src/infrastructure/security/child_data_security_manager.py:79:21: TRY301 Abstract `raise` to an inner function
   |
77 |                   expiry = datetime.fromisoformat(coppa_info["data_retention_expires"])
78 |                   if datetime.utcnow() > expiry:
79 | /                     raise ValueError(
80 | |                         "Child data retention period expired - data access denied",
81 | |                     )
   | |_____________________^ TRY301
82 |
83 |               return decrypted_data
   |

src/infrastructure/security/child_data_security_manager.py:79:27: TRY003 Avoid specifying long messages outside the exception class
   |
77 |                   expiry = datetime.fromisoformat(coppa_info["data_retention_expires"])
78 |                   if datetime.utcnow() > expiry:
79 |                       raise ValueError(
   |  ___________________________^
80 | |                         "Child data retention period expired - data access denied",
81 | |                     )
   | |_____________________^ TRY003
82 |
83 |               return decrypted_data
   |

src/infrastructure/security/child_data_security_manager.py:83:13: TRY300 Consider moving this statement to an `else` block
   |
81 |                     )
82 |
83 |             return decrypted_data
   |             ^^^^^^^^^^^^^^^^^^^^^ TRY300
84 |         except Exception as e:
85 |             logger.error(f"Failed to get child data for interaction: {e}")
   |

src/infrastructure/security/child_data_security_manager.py:85:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
83 |             return decrypted_data
84 |         except Exception as e:
85 |             logger.error(f"Failed to get child data for interaction: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
86 |             raise
   |
   = help: Replace with `exception`

src/infrastructure/security/comprehensive_audit_integration.py:30:5: D205 1 blank line required between summary line and description
   |
29 |   class ComprehensiveAuditIntegration:
30 | /     """Comprehensive audit integration service that ensures all critical operations are logged.
31 | |     This service fixes audit trail gaps by providing centralized methods for logging:
32 | |     - Authentication events(login, logout, failures)
33 | |     - Authorization events(access granted / denied, permission changes)
34 | |     - Child data operations(creation, modification, deletion, access)
35 | |     - COPPA compliance events(consent, age verification, data retention)
36 | |     - Security events(threats, policy violations, configuration changes)
37 | |     """
   | |_______^ D205
38 |
39 |       def __init__(self):
   |
   = help: Insert single blank line

src/infrastructure/security/comprehensive_audit_integration.py:30:5: D415 First line should end with a period, question mark, or exclamation point
   |
29 |   class ComprehensiveAuditIntegration:
30 | /     """Comprehensive audit integration service that ensures all critical operations are logged.
31 | |     This service fixes audit trail gaps by providing centralized methods for logging:
32 | |     - Authentication events(login, logout, failures)
33 | |     - Authorization events(access granted / denied, permission changes)
34 | |     - Child data operations(creation, modification, deletion, access)
35 | |     - COPPA compliance events(consent, age verification, data retention)
36 | |     - Security events(threats, policy violations, configuration changes)
37 | |     """
   | |_______^ D415
38 |
39 |       def __init__(self):
   |
   = help: Add closing punctuation

src/infrastructure/security/comprehensive_audit_integration.py:30:89: E501 Line too long (95 > 88)
   |
29 | class ComprehensiveAuditIntegration:
30 |     """Comprehensive audit integration service that ensures all critical operations are logged.
   |                                                                                         ^^^^^^^ E501
31 |     This service fixes audit trail gaps by providing centralized methods for logging:
32 |     - Authentication events(login, logout, failures)
   |

src/infrastructure/security/comprehensive_audit_integration.py:83:89: E501 Line too long (113 > 88)
   |
81 |             severity=severity,
82 |             category=AuditCategory.AUTHENTICATION,
83 |             description=f"Authentication {event_type}: {sanitized_email} ({'success' if success else 'failed'})",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^ E501
84 |             context=context,
85 |             details=audit_details,
   |

src/infrastructure/security/comprehensive_audit_integration.py:88:15: PLR0913 Too many arguments in function definition (7 > 5)
   |
86 |         )
87 |
88 |     async def log_authorization_event(
   |               ^^^^^^^^^^^^^^^^^^^^^^^ PLR0913
89 |         self,
90 |         user_id: str,
   |

src/infrastructure/security/comprehensive_audit_integration.py:120:89: E501 Line too long (114 > 88)
    |
118 |             severity=severity,
119 |             category=AuditCategory.AUTHORIZATION,
120 |             description=f"Access {action} on {resource}: {'granted' if granted else 'denied'} for user {user_id}",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
121 |             context=context,
122 |             details=audit_details,
    |

src/infrastructure/security/comprehensive_audit_integration.py:125:15: PLR0913 Too many arguments in function definition (8 > 5)
    |
123 |         )
124 |
125 |     async def log_child_data_operation(
    |               ^^^^^^^^^^^^^^^^^^^^^^^^ PLR0913
126 |         self,
127 |         operation: str,
    |

src/infrastructure/security/comprehensive_audit_integration.py:146:19: TRY003 Avoid specifying long messages outside the exception class
    |
144 |         }
145 |         if operation not in operation_mapping:
146 |             raise ValueError(f"Unknown operation: {operation}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
147 |         event_type = operation_mapping[operation]
    |

src/infrastructure/security/comprehensive_audit_integration.py:180:89: E501 Line too long (112 > 88)
    |
178 |             severity=severity,
179 |             category=AuditCategory.DATA_PROTECTION,
180 |             description=f"Child data {operation}: {data_type} for child {sanitized_child_id} by user {user_id}",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^ E501
181 |             context=context,
182 |             details=audit_details,
    |

src/infrastructure/security/comprehensive_audit_integration.py:193:9: PLC0415 `import` should be at the top-level of a file
    |
191 |         details: dict[str, Any] | None = None,
192 |     ) -> str:
193 |         from ..config.coppa_config import requires_coppa_audit_logging
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
194 |
195 |         if not requires_coppa_audit_logging():
    |

src/infrastructure/security/comprehensive_audit_integration.py:193:9: TID252 Prefer absolute imports over relative imports from parent modules
    |
191 |         details: dict[str, Any] | None = None,
192 |     ) -> str:
193 |         from ..config.coppa_config import requires_coppa_audit_logging
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
194 |
195 |         if not requires_coppa_audit_logging():
    |
    = help: Replace relative imports from parent modules with absolute imports

src/infrastructure/security/comprehensive_audit_integration.py:231:15: PLR0913 Too many arguments in function definition (6 > 5)
    |
229 |         )
230 |
231 |     async def log_security_event(
    |               ^^^^^^^^^^^^^^^^^^ PLR0913
232 |         self,
233 |         event_type: str,
    |

src/infrastructure/security/comprehensive_audit_integration.py:301:30: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
    |
299 |         try:
300 |             parts = email.split("@")
301 |             if len(parts) == 2:
    |                              ^ PLR2004
302 |                 return f"{parts[0][:2]}***@{parts[1]}"
303 |             return "***@***"
    |

src/infrastructure/security/comprehensive_audit_integration.py:303:13: TRY300 Consider moving this statement to an `else` block
    |
301 |             if len(parts) == 2:
302 |                 return f"{parts[0][:2]}***@{parts[1]}"
303 |             return "***@***"
    |             ^^^^^^^^^^^^^^^^ TRY300
304 |         except (AttributeError, IndexError, TypeError):
305 |             return "***@***"
    |

src/infrastructure/security/comprehensive_audit_integration.py:309:32: PLR2004 Magic value used in comparison, consider replacing `8` with a constant variable
    |
307 |     def _sanitize_child_id(self, child_id: str) -> str:
308 |         try:
309 |             if len(child_id) > 8:
    |                                ^ PLR2004
310 |                 return f"{child_id[:4]}***{child_id[-4:]}"
311 |             return f"{child_id[:2]}***"
    |

src/infrastructure/security/comprehensive_audit_integration.py:321:12: PLW0603 Using the global statement to update `_audit_integration` is discouraged
    |
320 | def get_audit_integration() -> ComprehensiveAuditIntegration:
321 |     global _audit_integration
    |            ^^^^^^^^^^^^^^^^^^ PLW0603
322 |     if _audit_integration is None:
323 |         _audit_integration = ComprehensiveAuditIntegration()
    |

src/infrastructure/security/comprehensive_rate_limiter.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Comprehensive Rate Limiting Service for Child Safety and Security.
2 | | This module provides backwards compatibility imports from the new modular rate limiting system.
3 | | The implementation has been refactored into smaller, more maintainable modules.
4 | | """
  | |___^ D205
5 |
6 |   from src.infrastructure.logging_config import get_logger
  |
  = help: Insert single blank line

src/infrastructure/security/comprehensive_rate_limiter.py:2:89: E501 Line too long (95 > 88)
  |
1 | """Comprehensive Rate Limiting Service for Child Safety and Security.
2 | This module provides backwards compatibility imports from the new modular rate limiting system.
  |                                                                                         ^^^^^^^ E501
3 | The implementation has been refactored into smaller, more maintainable modules.
4 | """
  |

src/infrastructure/security/coppa/__init__.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """COPPA Compliance Package
2 | | Enterprise-grade COPPA compliance with modular architecture.
3 | | """
  | |___^ D205
4 |   from .consent_manager import COPPAConsentManager
5 |   from .data_models import (
  |
  = help: Insert single blank line

src/infrastructure/security/coppa/consent_manager.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """COPPA-Compliant Consent Manager
2 | | Provides comprehensive consent management with FTC-approved verification methods.
3 | | """
  | |___^ D205
4 |   from datetime import datetime, timedelta
5 |   from typing import Dict, Any, List, Optional
  |
  = help: Insert single blank line

src/infrastructure/security/coppa/consent_manager.py:4:1: I001 [*] Import block is un-sorted or un-formatted
   |
 2 |   Provides comprehensive consent management with FTC-approved verification methods.
 3 |   """
 4 | / from datetime import datetime, timedelta
 5 | | from typing import Dict, Any, List, Optional
 6 | | from uuid import uuid4
 7 | |
 8 | | from src.application.services.consent.consent_models import (
 9 | |     VerificationMethod, 
10 | |     VerificationStatus
11 | | )
12 | | from src.domain.models.consent_models import (
13 | |     ConsentType,
14 | |     ConsentStatus,
15 | |     ConsentRecord
16 | | )
17 | | from src.infrastructure.logging_config import get_logger
18 | | from src.application.services.consent.consent_service import ConsentService
   | |___________________________________________________________________________^ I001
19 |
20 |   logger = get_logger(__name__, component="security")
   |
   = help: Organize imports

src/infrastructure/security/coppa/consent_manager.py:4:32: F401 [*] `datetime.timedelta` imported but unused
  |
2 | Provides comprehensive consent management with FTC-approved verification methods.
3 | """
4 | from datetime import datetime, timedelta
  |                                ^^^^^^^^^ F401
5 | from typing import Dict, Any, List, Optional
6 | from uuid import uuid4
  |
  = help: Remove unused import: `datetime.timedelta`

src/infrastructure/security/coppa/consent_manager.py:5:1: UP035 `typing.Dict` is deprecated, use `dict` instead
  |
3 | """
4 | from datetime import datetime, timedelta
5 | from typing import Dict, Any, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
6 | from uuid import uuid4
  |

src/infrastructure/security/coppa/consent_manager.py:5:1: UP035 `typing.List` is deprecated, use `list` instead
  |
3 | """
4 | from datetime import datetime, timedelta
5 | from typing import Dict, Any, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
6 | from uuid import uuid4
  |

src/infrastructure/security/coppa/consent_manager.py:9:5: F401 [*] `src.application.services.consent.consent_models.VerificationMethod` imported but unused
   |
 8 | from src.application.services.consent.consent_models import (
 9 |     VerificationMethod, 
   |     ^^^^^^^^^^^^^^^^^^ F401
10 |     VerificationStatus
11 | )
   |
   = help: Remove unused import

src/infrastructure/security/coppa/consent_manager.py:9:24: W291 [*] Trailing whitespace
   |
 8 | from src.application.services.consent.consent_models import (
 9 |     VerificationMethod, 
   |                        ^ W291
10 |     VerificationStatus
11 | )
   |
   = help: Remove trailing whitespace

src/infrastructure/security/coppa/consent_manager.py:10:5: F401 [*] `src.application.services.consent.consent_models.VerificationStatus` imported but unused
   |
 8 | from src.application.services.consent.consent_models import (
 9 |     VerificationMethod, 
10 |     VerificationStatus
   |     ^^^^^^^^^^^^^^^^^^ F401
11 | )
12 | from src.domain.models.consent_models import (
   |
   = help: Remove unused import

src/infrastructure/security/coppa/consent_manager.py:13:5: F401 [*] `src.domain.models.consent_models.ConsentType` imported but unused
   |
11 | )
12 | from src.domain.models.consent_models import (
13 |     ConsentType,
   |     ^^^^^^^^^^^ F401
14 |     ConsentStatus,
15 |     ConsentRecord
   |
   = help: Remove unused import: `src.domain.models.consent_models.ConsentType`

src/infrastructure/security/coppa/consent_manager.py:25:1: W293 Blank line contains whitespace
   |
23 | class COPPAConsentManager:
24 |     """COPPA-compliant consent management system.
25 |     
   | ^^^^ W293
26 |     This manager handles all aspects of parental consent including:
27 |     - Consent requests and approvals
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:32:1: W293 [*] Blank line contains whitespace
   |
30 |     - Audit trail maintenance
31 |     """
32 |     
   | ^^^^ W293
33 |     def __init__(self, consent_service: Optional[ConsentService] = None):
34 |         """Initialize with optional consent service injection."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:33:41: UP045 [*] Use `X | None` for type annotations
   |
31 |     """
32 |     
33 |     def __init__(self, consent_service: Optional[ConsentService] = None):
   |                                         ^^^^^^^^^^^^^^^^^^^^^^^^ UP045
34 |         """Initialize with optional consent service injection."""
35 |         self._consent_service = consent_service or ConsentService()
   |
   = help: Convert to `X | None`

src/infrastructure/security/coppa/consent_manager.py:36:30: UP006 [*] Use `dict` instead of `Dict` for type annotation
   |
34 |         """Initialize with optional consent service injection."""
35 |         self._consent_service = consent_service or ConsentService()
36 |         self._consent_cache: Dict[str, ConsentRecord] = {}
   |                              ^^^^ UP006
37 |         
38 |     async def verify_parental_consent(
   |
   = help: Replace with `dict`

src/infrastructure/security/coppa/consent_manager.py:37:1: W293 [*] Blank line contains whitespace
   |
35 |         self._consent_service = consent_service or ConsentService()
36 |         self._consent_cache: Dict[str, ConsentRecord] = {}
37 |         
   | ^^^^^^^^ W293
38 |     async def verify_parental_consent(
39 |         self,
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:45:1: W293 Blank line contains whitespace
   |
43 |     ) -> bool:
44 |         """Verify if valid parental consent exists for specific action.
45 |         
   | ^^^^^^^^ W293
46 |         Args:
47 |             parent_id: Parent identifier
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:48:39: W291 Trailing whitespace
   |
46 |         Args:
47 |             parent_id: Parent identifier
48 |             child_id: Child identifier  
   |                                       ^^ W291
49 |             consent_type: Type of consent to verify
   |
   = help: Remove trailing whitespace

src/infrastructure/security/coppa/consent_manager.py:50:1: W293 Blank line contains whitespace
   |
48 |             child_id: Child identifier  
49 |             consent_type: Type of consent to verify
50 |             
   | ^^^^^^^^^^^^ W293
51 |         Returns:
52 |             True if valid consent exists, False otherwise
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:61:1: W293 [*] Blank line contains whitespace
   |
59 |                 if self._is_consent_valid(record):
60 |                     return True
61 |                     
   | ^^^^^^^^^^^^^^^^^^^^ W293
62 |             # Check with consent service
63 |             return await self._consent_service.verify_parental_consent(
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:66:1: W293 [*] Blank line contains whitespace
   |
64 |                 parent_id, child_id, consent_type
65 |             )
66 |             
   | ^^^^^^^^^^^^ W293
67 |         except Exception as e:
68 |             logger.error(f"Error verifying consent: {str(e)}")
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:68:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
67 |         except Exception as e:
68 |             logger.error(f"Error verifying consent: {str(e)}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
69 |             return False
   |
   = help: Replace with `exception`

src/infrastructure/security/coppa/consent_manager.py:68:54: RUF010 [*] Use explicit conversion flag
   |
67 |         except Exception as e:
68 |             logger.error(f"Error verifying consent: {str(e)}")
   |                                                      ^^^^^^ RUF010
69 |             return False
   |
   = help: Replace with conversion flag

src/infrastructure/security/coppa/consent_manager.py:70:1: W293 [*] Blank line contains whitespace
   |
68 |             logger.error(f"Error verifying consent: {str(e)}")
69 |             return False
70 |     
   | ^^^^ W293
71 |     async def request_parental_consent(
72 |         self,
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:75:9: ARG002 Unused method argument: `child_name`
   |
73 |         parent_id: str,
74 |         child_id: str,
75 |         child_name: str,
   |         ^^^^^^^^^^ ARG002
76 |         consent_types: List[str],
77 |         parent_email: Optional[str] = None
   |

src/infrastructure/security/coppa/consent_manager.py:76:24: UP006 [*] Use `list` instead of `List` for type annotation
   |
74 |         child_id: str,
75 |         child_name: str,
76 |         consent_types: List[str],
   |                        ^^^^ UP006
77 |         parent_email: Optional[str] = None
78 |     ) -> Dict[str, Any]:
   |
   = help: Replace with `list`

src/infrastructure/security/coppa/consent_manager.py:77:23: UP045 [*] Use `X | None` for type annotations
   |
75 |         child_name: str,
76 |         consent_types: List[str],
77 |         parent_email: Optional[str] = None
   |                       ^^^^^^^^^^^^^ UP045
78 |     ) -> Dict[str, Any]:
79 |         """Request parental consent for child data collection.
   |
   = help: Convert to `X | None`

src/infrastructure/security/coppa/consent_manager.py:78:10: UP006 [*] Use `dict` instead of `Dict` for type annotation
   |
76 |         consent_types: List[str],
77 |         parent_email: Optional[str] = None
78 |     ) -> Dict[str, Any]:
   |          ^^^^ UP006
79 |         """Request parental consent for child data collection.
   |
   = help: Replace with `dict`

src/infrastructure/security/coppa/consent_manager.py:80:1: W293 Blank line contains whitespace
   |
78 |     ) -> Dict[str, Any]:
79 |         """Request parental consent for child data collection.
80 |         
   | ^^^^^^^^ W293
81 |         Args:
82 |             parent_id: Parent identifier
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:87:1: W293 Blank line contains whitespace
   |
85 |             consent_types: Types of consent requested
86 |             parent_email: Parent's email for verification
87 |             
   | ^^^^^^^^^^^^ W293
88 |         Returns:
89 |             Dict with consent request details
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:93:1: W293 [*] Blank line contains whitespace
   |
91 |         try:
92 |             consent_requests = []
93 |             
   | ^^^^^^^^^^^^ W293
94 |             for consent_type in consent_types:
95 |                 result = await self._consent_service.request_consent(
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:102:1: W293 [*] Blank line contains whitespace
    |
100 |                 )
101 |                 consent_requests.append(result)
102 |                 
    | ^^^^^^^^^^^^^^^^ W293
103 |             return {
104 |                 "success": True,
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:103:13: TRY300 Consider moving this statement to an `else` block
    |
101 |                   consent_requests.append(result)
102 |                   
103 | /             return {
104 | |                 "success": True,
105 | |                 "consent_requests": consent_requests,
106 | |                 "verification_required": True,
107 | |                 "parent_email": parent_email,
108 | |                 "next_steps": "Parent must verify consent via email"
109 | |             }
    | |_____________^ TRY300
110 |               
111 |           except Exception as e:
    |

src/infrastructure/security/coppa/consent_manager.py:110:1: W293 [*] Blank line contains whitespace
    |
108 |                 "next_steps": "Parent must verify consent via email"
109 |             }
110 |             
    | ^^^^^^^^^^^^ W293
111 |         except Exception as e:
112 |             logger.error(f"Error requesting consent: {str(e)}")
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:112:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
111 |         except Exception as e:
112 |             logger.error(f"Error requesting consent: {str(e)}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
113 |             return {
114 |                 "success": False,
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/consent_manager.py:112:55: RUF010 [*] Use explicit conversion flag
    |
111 |         except Exception as e:
112 |             logger.error(f"Error requesting consent: {str(e)}")
    |                                                       ^^^^^^ RUF010
113 |             return {
114 |                 "success": False,
    |
    = help: Replace with conversion flag

src/infrastructure/security/coppa/consent_manager.py:117:1: W293 [*] Blank line contains whitespace
    |
115 |                 "error": str(e)
116 |             }
117 |     
    | ^^^^ W293
118 |     async def get_child_consent_status(self, child_id: str) -> Dict[str, Any]:
119 |         """Get comprehensive consent status for a child.
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:118:64: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
116 |             }
117 |     
118 |     async def get_child_consent_status(self, child_id: str) -> Dict[str, Any]:
    |                                                                ^^^^ UP006
119 |         """Get comprehensive consent status for a child.
    |
    = help: Replace with `dict`

src/infrastructure/security/coppa/consent_manager.py:120:1: W293 Blank line contains whitespace
    |
118 |     async def get_child_consent_status(self, child_id: str) -> Dict[str, Any]:
119 |         """Get comprehensive consent status for a child.
120 |         
    | ^^^^^^^^ W293
121 |         Args:
122 |             child_id: Child identifier
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:123:1: W293 Blank line contains whitespace
    |
121 |         Args:
122 |             child_id: Child identifier
123 |             
    | ^^^^^^^^^^^^ W293
124 |         Returns:
125 |             Dict with consent status for all types
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:130:35: W291 [*] Trailing whitespace
    |
128 |             consent_types = [
129 |                 "data_collection",
130 |                 "voice_recording", 
    |                                   ^ W291
131 |                 "interaction_logging",
132 |                 "safety_monitoring"
    |
    = help: Remove trailing whitespace

src/infrastructure/security/coppa/consent_manager.py:134:1: W293 [*] Blank line contains whitespace
    |
132 |                 "safety_monitoring"
133 |             ]
134 |             
    | ^^^^^^^^^^^^ W293
135 |             status = {}
136 |             for consent_type in consent_types:
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:143:1: W293 [*] Blank line contains whitespace
    |
141 |                     "verification_method": None
142 |                 }
143 |                 
    | ^^^^^^^^^^^^^^^^ W293
144 |             return {
145 |                 "child_id": child_id,
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:149:1: W293 [*] Blank line contains whitespace
    |
147 |                 "last_updated": datetime.utcnow().isoformat()
148 |             }
149 |             
    | ^^^^^^^^^^^^ W293
150 |         except Exception as e:
151 |             logger.error(f"Error getting consent status: {str(e)}")
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:151:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
150 |         except Exception as e:
151 |             logger.error(f"Error getting consent status: {str(e)}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
152 |             return {
153 |                 "child_id": child_id,
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/consent_manager.py:151:59: RUF010 [*] Use explicit conversion flag
    |
150 |         except Exception as e:
151 |             logger.error(f"Error getting consent status: {str(e)}")
    |                                                           ^^^^^^ RUF010
152 |             return {
153 |                 "child_id": child_id,
    |
    = help: Replace with conversion flag

src/infrastructure/security/coppa/consent_manager.py:156:1: W293 [*] Blank line contains whitespace
    |
154 |                 "error": str(e)
155 |             }
156 |     
    | ^^^^ W293
157 |     async def revoke_consent(
158 |         self,
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:161:23: UP045 [*] Use `X | None` for type annotations
    |
159 |         parent_id: str,
160 |         child_id: str,
161 |         consent_type: Optional[str] = None
    |                       ^^^^^^^^^^^^^ UP045
162 |     ) -> Dict[str, Any]:
163 |         """Revoke parental consent.
    |
    = help: Convert to `X | None`

src/infrastructure/security/coppa/consent_manager.py:162:10: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
160 |         child_id: str,
161 |         consent_type: Optional[str] = None
162 |     ) -> Dict[str, Any]:
    |          ^^^^ UP006
163 |         """Revoke parental consent.
    |
    = help: Replace with `dict`

src/infrastructure/security/coppa/consent_manager.py:164:1: W293 Blank line contains whitespace
    |
162 |     ) -> Dict[str, Any]:
163 |         """Revoke parental consent.
164 |         
    | ^^^^^^^^ W293
165 |         Args:
166 |             parent_id: Parent identifier
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:169:1: W293 Blank line contains whitespace
    |
167 |             child_id: Child identifier
168 |             consent_type: Specific type to revoke (None = all)
169 |             
    | ^^^^^^^^^^^^ W293
170 |         Returns:
171 |             Revocation result
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:181:13: RET505 [*] Unnecessary `else` after `return` statement
    |
179 |                     "revoked_types": [consent_type]
180 |                 }
181 |             else:
    |             ^^^^ RET505
182 |                 # Revoke all consents
183 |                 consent_types = ["data_collection", "voice_recording", "interaction_logging"]
    |
    = help: Remove unnecessary `else`

src/infrastructure/security/coppa/consent_manager.py:183:89: E501 Line too long (93 > 88)
    |
181 |             else:
182 |                 # Revoke all consents
183 |                 consent_types = ["data_collection", "voice_recording", "interaction_logging"]
    |                                                                                         ^^^^^ E501
184 |                 revoked = []
    |

src/infrastructure/security/coppa/consent_manager.py:185:1: W293 [*] Blank line contains whitespace
    |
183 |                 consent_types = ["data_collection", "voice_recording", "interaction_logging"]
184 |                 revoked = []
185 |                 
    | ^^^^^^^^^^^^^^^^ W293
186 |                 for ct in consent_types:
187 |                     consent_id = f"consent_{parent_id}_{child_id}_{ct}"
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:191:1: W293 [*] Blank line contains whitespace
    |
189 |                     if result["status"] == "revoked":
190 |                         revoked.append(ct)
191 |                         
    | ^^^^^^^^^^^^^^^^^^^^^^^^ W293
192 |                 return {
193 |                     "success": True,
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:196:1: W293 [*] Blank line contains whitespace
    |
194 |                     "revoked_types": revoked
195 |                 }
196 |                 
    | ^^^^^^^^^^^^^^^^ W293
197 |         except Exception as e:
198 |             logger.error(f"Error revoking consent: {str(e)}")
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:198:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
197 |         except Exception as e:
198 |             logger.error(f"Error revoking consent: {str(e)}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
199 |             return {
200 |                 "success": False,
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/consent_manager.py:198:53: RUF010 [*] Use explicit conversion flag
    |
197 |         except Exception as e:
198 |             logger.error(f"Error revoking consent: {str(e)}")
    |                                                     ^^^^^^ RUF010
199 |             return {
200 |                 "success": False,
    |
    = help: Replace with conversion flag

src/infrastructure/security/coppa/consent_manager.py:203:1: W293 [*] Blank line contains whitespace
    |
201 |                 "error": str(e)
202 |             }
203 |     
    | ^^^^ W293
204 |     def _is_consent_valid(self, record: ConsentRecord) -> bool:
205 |         """Check if consent record is valid."""
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:208:9: SIM103 Return the negated condition directly
    |
206 |           if record.status != ConsentStatus.GRANTED:
207 |               return False
208 | /         if record.expires_at and datetime.utcnow() > record.expires_at:
209 | |             return False
210 | |         return True
    | |___________________^ SIM103
211 |       
212 |       # Compatibility method for ParentalConsentManager
    |
    = help: Inline condition

src/infrastructure/security/coppa/consent_manager.py:211:1: W293 [*] Blank line contains whitespace
    |
209 |             return False
210 |         return True
211 |     
    | ^^^^ W293
212 |     # Compatibility method for ParentalConsentManager
213 |     async def create_consent_record(
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:217:21: UP006 [*] Use `list` instead of `List` for type annotation
    |
215 |         child_id: str,
216 |         parent_id: str,
217 |         data_types: List[str]
    |                     ^^^^ UP006
218 |     ) -> str:
219 |         """Create consent record (compatibility method).
    |
    = help: Replace with `list`

src/infrastructure/security/coppa/consent_manager.py:220:1: W293 Blank line contains whitespace
    |
218 |     ) -> str:
219 |         """Create consent record (compatibility method).
220 |         
    | ^^^^^^^^ W293
221 |         This method exists for backward compatibility with ParentalConsentManager.
222 |         """
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:229:1: W293 [*] Blank line contains whitespace
    |
227 |             consent_types=data_types
228 |         )
229 |         
    | ^^^^^^^^ W293
230 |         if result.get("success") and result.get("consent_requests"):
231 |             return result["consent_requests"][0]["consent_id"]
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/consent_manager.py:232:1: W293 [*] Blank line contains whitespace
    |
230 |         if result.get("success") and result.get("consent_requests"):
231 |             return result["consent_requests"][0]["consent_id"]
232 |         
    | ^^^^^^^^ W293
233 |         return f"consent_error_{uuid4().hex}"
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/coppa/data_models.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """COPPA Data Models and Validation
2 | | Enterprise-grade COPPA data models with comprehensive validation.
3 | | """
  | |___^ D205
4 |
5 |   import uuid
  |
  = help: Insert single blank line

src/infrastructure/security/coppa/data_models.py:88:19: TRY003 Avoid specifying long messages outside the exception class
   |
86 |         """Validate age compliance with COPPA."""
87 |         if v < MINIMUM_CHILD_AGE:
88 |             raise ValueError(f"Age must be at least {MINIMUM_CHILD_AGE} years")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
89 |         if v > COPPA_AGE_THRESHOLD:
90 |             raise ValueError(f"COPPA applies to children under {COPPA_AGE_THRESHOLD}")
   |

src/infrastructure/security/coppa/data_models.py:90:19: TRY003 Avoid specifying long messages outside the exception class
   |
88 |             raise ValueError(f"Age must be at least {MINIMUM_CHILD_AGE} years")
89 |         if v > COPPA_AGE_THRESHOLD:
90 |             raise ValueError(f"COPPA applies to children under {COPPA_AGE_THRESHOLD}")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
91 |         return v
   |

src/infrastructure/security/coppa/data_models.py:95:56: ARG003 Unused class method argument: `info`
   |
93 |     @field_validator("consent_date")
94 |     @classmethod
95 |     def validate_consent_date(cls, v: datetime | None, info) -> datetime | None:
   |                                                        ^^^^ ARG003
96 |         """Validate consent date is not in the future."""
97 |         if v and v > datetime.utcnow():
   |

src/infrastructure/security/coppa/data_models.py:98:19: TRY003 Avoid specifying long messages outside the exception class
   |
96 |         """Validate consent date is not in the future."""
97 |         if v and v > datetime.utcnow():
98 |             raise ValueError("Consent date cannot be in the future")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
99 |         return v
   |

src/infrastructure/security/coppa/data_retention.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """COPPA Data Retention Automation
2 | | Automated data lifecycle management for COPPA compliance with secure deletion
3 | | COPPA CONDITIONAL: All retention policies are conditional on ENABLE_COPPA_COMPLIANCE.
4 | | When disabled, uses longer retention periods and bypasses COPPA-specific deletion rules.
5 | | """
  | |___^ D205
6 |
7 |   import hashlib
  |
  = help: Insert single blank line

src/infrastructure/security/coppa/data_retention.py:7:1: I001 [*] Import block is un-sorted or un-formatted
   |
 5 |   """
 6 |
 7 | / import hashlib
 8 | | import secrets
 9 | | from datetime import datetime, timedelta
10 | | from typing import Any
11 | |
12 | | from src.infrastructure.logging_config import get_logger
13 | |
14 | | from ..coppa_validator import get_data_retention_days
15 | | from ...config.coppa_config import is_coppa_enabled
16 | | from .data_models import COPPAChildData, DataDeletionRequest, DataRetentionPolicy
   | |_________________________________________________________________________________^ I001
17 |
18 |   logger = get_logger(__name__, component="security")
   |
   = help: Organize imports

src/infrastructure/security/coppa/data_retention.py:14:1: TID252 Prefer absolute imports over relative imports from parent modules
   |
12 | from src.infrastructure.logging_config import get_logger
13 |
14 | from ..coppa_validator import get_data_retention_days
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
15 | from ...config.coppa_config import is_coppa_enabled
16 | from .data_models import COPPAChildData, DataDeletionRequest, DataRetentionPolicy
   |
   = help: Replace relative imports from parent modules with absolute imports

src/infrastructure/security/coppa/data_retention.py:15:1: TID252 Prefer absolute imports over relative imports from parent modules
   |
14 | from ..coppa_validator import get_data_retention_days
15 | from ...config.coppa_config import is_coppa_enabled
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
16 | from .data_models import COPPAChildData, DataDeletionRequest, DataRetentionPolicy
   |
   = help: Replace relative imports from parent modules with absolute imports

src/infrastructure/security/coppa/data_retention.py:22:5: D205 1 blank line required between summary line and description
   |
21 |   class DataRetentionManager:
22 | /     """Automated data retention management for COPPA compliance
23 | |     Features:
24 | |     - Automatic data expiration scheduling
25 | |     - Graduated deletion policies
26 | |     - Compliance reporting
27 | |     - Parent notification system.
28 | |     """
   | |_______^ D205
29 |
30 |       def __init__(self) -> None:
   |
   = help: Insert single blank line

src/infrastructure/security/coppa/data_retention.py:40:89: E501 Line too long (97 > 88)
   |
38 |             self.warning_days_before_deletion = 30  # Longer warning period
39 |             logger.info(
40 |                 "Data retention initialized with COPPA compliance disabled - extended retention",
   |                                                                                         ^^^^^^^^^ E501
41 |             )
   |

src/infrastructure/security/coppa/data_retention.py:47:9: D205 1 blank line required between summary line and description
   |
45 |           child_data: COPPAChildData,
46 |       ) -> DataRetentionPolicy:
47 | /         """Create data retention policy for a child
48 | |         COPPA CONDITIONAL: Policy varies based on COPPA compliance setting.
49 | |         """
   | |___________^ D205
50 |           # Calculate deletion date based on age and consent
51 |           retention_days = self.calculate_retention_period(child_data)
   |
   = help: Insert single blank line

src/infrastructure/security/coppa/data_retention.py:65:89: E501 Line too long (95 > 88)
   |
64 |         logger.info(
65 |             f"Created retention policy for child {child_data.child_id}: {retention_days} days",
   |                                                                                         ^^^^^^^ E501
66 |         )
67 |         return policy
   |

src/infrastructure/security/coppa/data_retention.py:70:9: D205 1 blank line required between summary line and description
   |
69 |       def calculate_retention_period(self, child_data: COPPAChildData) -> int:
70 | /         """Calculate appropriate retention period based on child's data
71 | |         COPPA CONDITIONAL: Uses COPPA config to determine retention period.
72 | |         """
   | |___________^ D205
73 |           # COPPA CONDITIONAL: Use the centralized retention calculation
74 |           base_retention = get_data_retention_days(child_data.age)
   |
   = help: Insert single blank line

src/infrastructure/security/coppa/data_retention.py:92:9: D205 1 blank line required between summary line and description
   |
91 |       async def schedule_automatic_deletion(self, child_id: str) -> bool:
92 | /         """Schedule automatic deletion for a child's data
93 | |         COPPA CONDITIONAL: Only schedules automatic deletion when COPPA is enabled.
94 | |         """
   | |___________^ D205
95 |           # COPPA CONDITIONAL: Skip automatic deletion when COPPA disabled
96 |           if not is_coppa_enabled():
   |
   = help: Insert single blank line

src/infrastructure/security/coppa/data_retention.py:98:89: E501 Line too long (107 > 88)
    |
 96 |         if not is_coppa_enabled():
 97 |             logger.info(
 98 |                 f"COPPA compliance disabled - skipping automatic deletion scheduling for child {child_id}",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^ E501
 99 |             )
100 |             return True  # Return success but don't actually schedule
    |

src/infrastructure/security/coppa/data_retention.py:114:13: TRY300 Consider moving this statement to an `else` block
    |
113 |             logger.info(f"Scheduled automatic deletion for child {child_id}")
114 |             return True
    |             ^^^^^^^^^^^ TRY300
115 |         except Exception as e:
116 |             logger.error(f"Failed to schedule deletion for child {child_id}: {e}")
    |

src/infrastructure/security/coppa/data_retention.py:116:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
114 |             return True
115 |         except Exception as e:
116 |             logger.error(f"Failed to schedule deletion for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
117 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/data_retention.py:153:89: E501 Line too long (96 > 88)
    |
151 |                             results["deleted"] += 1
152 |                             logger.info(
153 |                                 f"Successfully deleted data for child {child_data['child_id']}",
    |                                                                                         ^^^^^^^^ E501
154 |                             )
155 |                         else:
    |

src/infrastructure/security/coppa/data_retention.py:158:21: TRY400 Use `logging.exception` instead of `logging.error`
    |
156 |                               results["errors"] += 1
157 |                   except Exception as e:
158 | /                     logger.error(
159 | |                         f"Error processing child {child_data.get('child_id', 'unknown')}: {e}",
160 | |                     )
    | |_____________________^ TRY400
161 |                       results["errors"] += 1
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/data_retention.py:159:89: E501 Line too long (95 > 88)
    |
157 |                 except Exception as e:
158 |                     logger.error(
159 |                         f"Error processing child {child_data.get('child_id', 'unknown')}: {e}",
    |                                                                                         ^^^^^^^ E501
160 |                     )
161 |                     results["errors"] += 1
    |

src/infrastructure/security/coppa/data_retention.py:166:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
164 |             await self._log_compliance_summary(results)
165 |         except Exception as e:
166 |             logger.error(f"Critical error in data deletion process: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
167 |             results["errors"] += 1
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/data_retention.py:201:13: TRY300 Consider moving this statement to an `else` block
    |
199 |                 f"Found {len(mock_expired)} children with expired retention periods",
200 |             )
201 |             return mock_expired
    |             ^^^^^^^^^^^^^^^^^^^ TRY300
202 |         except Exception as e:
203 |             logger.error(f"Error finding expired children: {e}")
    |

src/infrastructure/security/coppa/data_retention.py:203:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
201 |             return mock_expired
202 |         except Exception as e:
203 |             logger.error(f"Error finding expired children: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
204 |             return []
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/data_retention.py:211:13: TRY300 Consider moving this statement to an `else` block
    |
209 |             # In production, update database record
210 |             logger.info(f"Marked parent notified for child {child_id}")
211 |             return True
    |             ^^^^^^^^^^^ TRY300
212 |         except Exception as e:
213 |             logger.error(f"Error marking parent notified for child {child_id}: {e}")
    |

src/infrastructure/security/coppa/data_retention.py:213:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
211 |             return True
212 |         except Exception as e:
213 |             logger.error(f"Error marking parent notified for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
214 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/data_retention.py:265:13: TRY300 Consider moving this statement to an `else` block
    |
264 |             logger.info(f"Completed graduated deletion for child {child_id}")
265 |             return True
    |             ^^^^^^^^^^^ TRY300
266 |         except Exception as e:
267 |             logger.error(f"Error in graduated deletion for child {child_id}: {e}")
    |

src/infrastructure/security/coppa/data_retention.py:267:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
265 |             return True
266 |         except Exception as e:
267 |             logger.error(f"Error in graduated deletion for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
268 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/data_retention.py:283:89: E501 Line too long (102 > 88)
    |
281 |             deletion_proof = secrets.token_hex(16)  # Proof of deletion
282 |             logger.info(
283 |                 f"Securely deleted voice data for child {sanitized_id} (proof: {deletion_proof[:8]})",
    |                                                                                         ^^^^^^^^^^^^^^ E501
284 |             )
285 |             return True
    |

src/infrastructure/security/coppa/data_retention.py:285:13: TRY300 Consider moving this statement to an `else` block
    |
283 |                 f"Securely deleted voice data for child {sanitized_id} (proof: {deletion_proof[:8]})",
284 |             )
285 |             return True
    |             ^^^^^^^^^^^ TRY300
286 |         except Exception as e:
287 |             sanitized_id = hashlib.sha256(f"child_{child_id}".encode()).hexdigest()[:8]
    |

src/infrastructure/security/coppa/data_retention.py:288:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
286 |         except Exception as e:
287 |             sanitized_id = hashlib.sha256(f"child_{child_id}".encode()).hexdigest()[:8]
288 |             logger.error(f"Error deleting voice data for child {sanitized_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
289 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/data_retention.py:296:13: TRY300 Consider moving this statement to an `else` block
    |
294 |             # In production: DELETE FROM conversations WHERE child_id = ?
295 |             logger.info(f"Deleted conversation data for child {child_id}")
296 |             return True
    |             ^^^^^^^^^^^ TRY300
297 |         except Exception as e:
298 |             logger.error(f"Error deleting conversation data for child {child_id}: {e}")
    |

src/infrastructure/security/coppa/data_retention.py:298:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
296 |             return True
297 |         except Exception as e:
298 |             logger.error(f"Error deleting conversation data for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
299 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/data_retention.py:306:13: TRY300 Consider moving this statement to an `else` block
    |
304 |             # In production: DELETE FROM analytics WHERE child_id = ?
305 |             logger.info(f"Deleted analytics data for child {child_id}")
306 |             return True
    |             ^^^^^^^^^^^ TRY300
307 |         except Exception as e:
308 |             logger.error(f"Error deleting analytics data for child {child_id}: {e}")
    |

src/infrastructure/security/coppa/data_retention.py:308:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
306 |             return True
307 |         except Exception as e:
308 |             logger.error(f"Error deleting analytics data for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
309 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/data_retention.py:315:89: E501 Line too long (94 > 88)
    |
313 |         try:
314 |             # In production: Anonymize rather than delete completely
315 |             # UPDATE children SET name = 'DELETED', age = 0, medical_notes = NULL WHERE id = ?
    |                                                                                         ^^^^^^ E501
316 |             logger.info(f"Anonymized profile data for child {child_id}")
317 |             return True
    |

src/infrastructure/security/coppa/data_retention.py:317:13: TRY300 Consider moving this statement to an `else` block
    |
315 |             # UPDATE children SET name = 'DELETED', age = 0, medical_notes = NULL WHERE id = ?
316 |             logger.info(f"Anonymized profile data for child {child_id}")
317 |             return True
    |             ^^^^^^^^^^^ TRY300
318 |         except Exception as e:
319 |             logger.error(f"Error deleting profile data for child {child_id}: {e}")
    |

src/infrastructure/security/coppa/data_retention.py:319:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
317 |             return True
318 |         except Exception as e:
319 |             logger.error(f"Error deleting profile data for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
320 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/data_retention.py:325:13: F841 Local variable `audit_record` is assigned to but never used
    |
323 |         """Create audit record for data deletion."""
324 |         try:
325 |             audit_record = {
    |             ^^^^^^^^^^^^ F841
326 |                 "child_id": child_id,
327 |                 "deletion_date": datetime.utcnow().isoformat(),
    |
    = help: Remove assignment to unused variable `audit_record`

src/infrastructure/security/coppa/data_retention.py:335:13: TRY300 Consider moving this statement to an `else` block
    |
333 |             # In production: INSERT INTO deletion_audit_log VALUES (...)
334 |             logger.info(f"Created deletion audit record for child {child_id}")
335 |             return True
    |             ^^^^^^^^^^^ TRY300
336 |         except Exception as e:
337 |             logger.error(f"Error creating audit record for child {child_id}: {e}")
    |

src/infrastructure/security/coppa/data_retention.py:337:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
335 |             return True
336 |         except Exception as e:
337 |             logger.error(f"Error creating audit record for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
338 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/data_retention.py:355:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
353 |             logger.info(f"COPPA Compliance Summary: {summary}")
354 |         except Exception as e:
355 |             logger.error(f"Error logging compliance summary: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
356 |
357 |     async def notify_parent_before_deletion(
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/data_retention.py:366:89: E501 Line too long (103 > 88)
    |
364 |             # This would send email/SMS to parent
365 |             logger.info(
366 |                 f"Would notify parent about upcoming deletion for child {child_id} on {deletion_date}",
    |                                                                                         ^^^^^^^^^^^^^^^ E501
367 |             )
368 |             return True
    |

src/infrastructure/security/coppa/data_retention.py:368:13: TRY300 Consider moving this statement to an `else` block
    |
366 |                 f"Would notify parent about upcoming deletion for child {child_id} on {deletion_date}",
367 |             )
368 |             return True
    |             ^^^^^^^^^^^ TRY300
369 |         except Exception as e:
370 |             logger.error(f"Failed to notify parent for child {child_id}: {e}")
    |

src/infrastructure/security/coppa/data_retention.py:370:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
368 |             return True
369 |         except Exception as e:
370 |             logger.error(f"Failed to notify parent for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
371 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/data_retention.py:380:34: PLR2004 Magic value used in comparison, consider replacing `365` with a constant variable
    |
378 |         """Extend retention period (requires parent consent)."""
379 |         try:
380 |             if additional_days > 365:
    |                                  ^^^ PLR2004
381 |                 raise ValueError("Cannot extend retention beyond 1 year")
    |

src/infrastructure/security/coppa/data_retention.py:381:17: TRY301 Abstract `raise` to an inner function
    |
379 |         try:
380 |             if additional_days > 365:
381 |                 raise ValueError("Cannot extend retention beyond 1 year")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
382 |
383 |             # This would update the retention policy
    |

src/infrastructure/security/coppa/data_retention.py:381:23: TRY003 Avoid specifying long messages outside the exception class
    |
379 |         try:
380 |             if additional_days > 365:
381 |                 raise ValueError("Cannot extend retention beyond 1 year")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
382 |
383 |             # This would update the retention policy
    |

src/infrastructure/security/coppa/data_retention.py:387:13: TRY300 Consider moving this statement to an `else` block
    |
385 |                 f"Extended retention for child {child_id} by {additional_days} days",
386 |             )
387 |             return True
    |             ^^^^^^^^^^^ TRY300
388 |         except Exception as e:
389 |             logger.error(f"Failed to extend retention for child {child_id}: {e}")
    |

src/infrastructure/security/coppa/data_retention.py:389:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
387 |             return True
388 |         except Exception as e:
389 |             logger.error(f"Failed to extend retention for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
390 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/data_retention.py:417:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
415 |             logger.info("Generated data retention compliance report")
416 |         except Exception as e:
417 |             logger.error(f"Failed to generate retention report: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
418 |             report["compliance_status"] = "error"
    |
    = help: Replace with `exception`

src/infrastructure/security/coppa/data_retention.py:429:12: PLW0603 Using the global statement to update `_retention_manager` is discouraged
    |
427 | def get_retention_manager() -> DataRetentionManager:
428 |     """Get global retention manager instance."""
429 |     global _retention_manager
    |            ^^^^^^^^^^^^^^^^^^ PLW0603
430 |     if _retention_manager is None:
431 |         _retention_manager = DataRetentionManager()
    |

src/infrastructure/security/coppa_validator.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Centralized COPPA Age Validation Service
2 | | This module provides a single source of truth for all COPPA-related age validation
3 | | and compliance checks to ensure consistent application of child protection laws.
4 | |
5 | | IMPORTANT: All COPPA functionality is conditional based on ENABLE_COPPA_COMPLIANCE setting.
6 | | When disabled, COPPA validations are bypassed for development/testing.
7 | | """
  | |___^ D205
8 |
9 |   from dataclasses import dataclass
  |
  = help: Insert single blank line

src/infrastructure/security/coppa_validator.py:5:89: E501 Line too long (91 > 88)
  |
3 | and compliance checks to ensure consistent application of child protection laws.
4 |
5 | IMPORTANT: All COPPA functionality is conditional based on ENABLE_COPPA_COMPLIANCE setting.
  |                                                                                         ^^^ E501
6 | When disabled, COPPA validations are bypassed for development/testing.
7 | """
  |

src/infrastructure/security/coppa_validator.py:14:1: TID252 Prefer absolute imports over relative imports from parent modules
   |
12 | from src.infrastructure.logging_config import get_logger
13 |
14 | from ..config.coppa_config import is_coppa_enabled
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
15 |
16 | logger = get_logger(__name__, component="security")
   |
   = help: Replace relative imports from parent modules with absolute imports

src/infrastructure/security/coppa_validator.py:40:5: D205 1 blank line required between summary line and description
   |
39 |   class COPPAValidator:
40 | /     """Centralized COPPA age validation and compliance service.
41 | |     This class provides the authoritative source for all age-related
42 | |     COPPA compliance decisions throughout the application.
43 | |     """
   | |_______^ D205
44 |
45 |       # COPPA Constants - DO NOT MODIFY WITHOUT LEGAL REVIEW
   |
   = help: Insert single blank line

src/infrastructure/security/coppa_validator.py:62:9: D205 1 blank line required between summary line and description
   |
60 |           strict_validation: bool = True,
61 |       ) -> COPPAValidationResult:
62 | /         """Perform comprehensive COPPA age validation.
63 | |         COPPA CONDITIONAL: When COPPA compliance is disabled, validation is relaxed
64 | |         to allow development/testing without COPPA restrictions.
65 | |
66 | |         Args:
67 | |             age: Child's age in years
68 | |             strict_validation: Whether to apply strict validation rules
69 | |
70 | |         Returns:
71 | |             COPPAValidationResult with all compliance requirements
72 | |
73 | |         Raises:
74 | |             ValueError: If age is invalid or out of acceptable range
75 | |
76 | |         """
   | |___________^ D205
77 |           if not isinstance(age, int):
78 |               raise ValueError(f"Age must be an integer, got {type(age)}")
   |
   = help: Insert single blank line

src/infrastructure/security/coppa_validator.py:78:13: TRY004 Prefer `TypeError` exception for invalid type
   |
76 |         """
77 |         if not isinstance(age, int):
78 |             raise ValueError(f"Age must be an integer, got {type(age)}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY004
79 |
80 |         # COPPA CONDITIONAL: Check if COPPA compliance is enabled
   |

src/infrastructure/security/coppa_validator.py:78:19: TRY003 Avoid specifying long messages outside the exception class
   |
76 |         """
77 |         if not isinstance(age, int):
78 |             raise ValueError(f"Age must be an integer, got {type(age)}")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
79 |
80 |         # COPPA CONDITIONAL: Check if COPPA compliance is enabled
   |

src/infrastructure/security/coppa_validator.py:89:33: PLR2004 Magic value used in comparison, consider replacing `18` with a constant variable
   |
88 |             # Still validate basic age range for system functionality
89 |             if age < 1 or age > 18:
   |                                 ^^ PLR2004
90 |                 raise ValueError(f"Age {age} is outside acceptable range (1-18)")
   |

src/infrastructure/security/coppa_validator.py:90:23: TRY003 Avoid specifying long messages outside the exception class
   |
88 |             # Still validate basic age range for system functionality
89 |             if age < 1 or age > 18:
90 |                 raise ValueError(f"Age {age} is outside acceptable range (1-18)")
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
91 |
92 |             # Return permissive result when COPPA disabled
   |

src/infrastructure/security/coppa_validator.py:99:89: E501 Line too long (90 > 88)
    |
 97 |                 data_retention_days=365 * 2,  # Longer retention when COPPA disabled
 98 |                 special_protections={
 99 |                     "enhanced_content_filtering": True,  # Still filter content for safety
    |                                                                                         ^^ E501
100 |                     "restricted_data_sharing": False,  # No COPPA restrictions
101 |                     "parental_oversight_required": False,  # No COPPA oversight
    |

src/infrastructure/security/coppa_validator.py:111:19: TRY003 Avoid specifying long messages outside the exception class
    |
109 |           # COPPA enabled - strict validation
110 |           if age < self.MIN_CHILD_AGE:
111 |               raise ValueError(
    |  ___________________^
112 | |                 f"Age {age} is below minimum allowed age of {self.MIN_CHILD_AGE}",
113 | |             )
    | |_____________^ TRY003
114 |
115 |           if strict_validation and age > self.MAX_CHILD_AGE:
    |

src/infrastructure/security/coppa_validator.py:116:19: TRY003 Avoid specifying long messages outside the exception class
    |
115 |           if strict_validation and age > self.MAX_CHILD_AGE:
116 |               raise ValueError(
    |  ___________________^
117 | |                 f"Age {age} exceeds maximum child age of {self.MAX_CHILD_AGE}",
118 | |             )
    | |_____________^ TRY003
119 |
120 |           # Determine COPPA status (only when COPPA enabled)
    |

src/infrastructure/security/coppa_validator.py:127:21: PLR2004 Magic value used in comparison, consider replacing `15` with a constant variable
    |
125 |             compliance_level = COPPAValidatorLevel.UNDER_COPPA
126 |             retention_days = self.COPPA_RETENTION_DAYS
127 |         elif age <= 15:
    |                     ^^ PLR2004
128 |             compliance_level = COPPAValidatorLevel.COPPA_TRANSITION
129 |             retention_days = self.TRANSITION_RETENTION_DAYS
    |

src/infrastructure/security/coppa_validator.py:136:49: PLR2004 Magic value used in comparison, consider replacing `16` with a constant variable
    |
134 |         # Determine special protections
135 |         special_protections = {
136 |             "enhanced_content_filtering": age < 16,
    |                                                 ^^ PLR2004
137 |             "restricted_data_sharing": is_coppa_subject,
138 |             "parental_oversight_required": is_coppa_subject,
    |

src/infrastructure/security/coppa_validator.py:172:13: TRY300 Consider moving this statement to an `else` block
    |
170 |         try:
171 |             result = self.validate_age_compliance(age, strict_validation=False)
172 |             return result.is_coppa_subject
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY300
173 |         except ValueError:
174 |             # If age validation fails, err on the side of caution
    |

src/infrastructure/security/coppa_validator.py:191:13: TRY300 Consider moving this statement to an `else` block
    |
189 |         try:
190 |             result = self.validate_age_compliance(age, strict_validation=False)
191 |             return result.data_retention_days
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY300
192 |         except ValueError:
193 |             # If age validation fails, use most restrictive retention
    |

src/infrastructure/security/coppa_validator.py:225:13: TRY300 Consider moving this statement to an `else` block
    |
223 |             if result.compliance_level == COPPAValidatorLevel.COPPA_TRANSITION:
224 |                 return "moderate"
225 |             return "standard"
    |             ^^^^^^^^^^^^^^^^^ TRY300
226 |         except ValueError:
227 |             # If age validation fails, use strictest filtering
    |

src/infrastructure/security/coppa_validator.py:258:13: TRY300 Consider moving this statement to an `else` block
    |
256 |         try:
257 |             self.validate_age_compliance(age)
258 |             return True
    |             ^^^^^^^^^^^ TRY300
259 |         except ValueError:
260 |             return False
    |

src/infrastructure/security/coppa_validator.py:269:5: D205 1 blank line required between summary line and description
    |
267 |   # Convenience functions for backward compatibility - ALL COPPA CONDITIONAL
268 |   def is_coppa_subject(age: int) -> bool:
269 | /     """Check if age is subject to COPPA (< 13 years old)
270 | |     COPPA CONDITIONAL: Always returns False when COPPA compliance is disabled.
271 | |     """
    | |_______^ D205
272 |       if not is_coppa_enabled():
273 |           return False  # Never subject to COPPA when disabled
    |
    = help: Insert single blank line

src/infrastructure/security/coppa_validator.py:279:5: D205 1 blank line required between summary line and description
    |
278 |   def requires_parental_consent(age: int) -> bool:
279 | /     """Check if parental consent is required for this age
280 | |     COPPA CONDITIONAL: Always returns False when COPPA compliance is disabled.
281 | |     """
    | |_______^ D205
282 |       if not is_coppa_enabled():
283 |           return False  # No consent required when COPPA disabled
    |
    = help: Insert single blank line

src/infrastructure/security/coppa_validator.py:289:5: D205 1 blank line required between summary line and description
    |
288 |   def get_data_retention_days(age: int) -> int:
289 | /     """Get data retention period in days for this age
290 | |     COPPA CONDITIONAL: Returns longer retention when COPPA compliance is disabled.
291 | |     """
    | |_______^ D205
292 |       return coppa_validator.get_data_retention_period(age)
    |
    = help: Insert single blank line

src/infrastructure/security/coppa_validator.py:296:5: D205 1 blank line required between summary line and description
    |
295 |   def validate_child_age(age: int) -> COPPAValidationResult:
296 | /     """Validate child age with full COPPA compliance check
297 | |     COPPA CONDITIONAL: Returns relaxed validation when COPPA compliance is disabled.
298 | |     """
    | |_______^ D205
299 |       return coppa_validator.validate_age_compliance(age)
    |
    = help: Insert single blank line

src/infrastructure/security/cors_service.py:34:19: TRY003 Avoid specifying long messages outside the exception class
   |
32 |         """Validate CORS configuration on initialization."""
33 |         if "*" in self.allowed_origins and self.allow_credentials:
34 |             raise ValueError("Cannot allow credentials with wildcard origins")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
   |

src/infrastructure/security/cors_service.py:38:5: D205 1 blank line required between summary line and description
   |
37 |   class CORSSecurityService:
38 | /     """Enterprise - grade CORS security service for child - safe applications.
39 | |     Features:
40 | |     - Age - appropriate CORS policies
41 | |     - Origin validation and sanitization
42 | |     - Security header enforcement
43 | |     - Audit logging for CORS violations
44 | |     - Dynamic policy adjustment
45 | |     """
   | |_______^ D205
46 |
47 |       def __init__(self, default_policy: CORSPolicy = CORSPolicy.STRICT) -> None:
   |
   = help: Insert single blank line

src/infrastructure/security/cors_service.py:38:5: D415 First line should end with a period, question mark, or exclamation point
   |
37 |   class CORSSecurityService:
38 | /     """Enterprise - grade CORS security service for child - safe applications.
39 | |     Features:
40 | |     - Age - appropriate CORS policies
41 | |     - Origin validation and sanitization
42 | |     - Security header enforcement
43 | |     - Audit logging for CORS violations
44 | |     - Dynamic policy adjustment
45 | |     """
   | |_______^ D415
46 |
47 |       def __init__(self, default_policy: CORSPolicy = CORSPolicy.STRICT) -> None:
   |
   = help: Add closing punctuation

src/infrastructure/security/cors_service.py:250:89: E501 Line too long (91 > 88)
    |
248 |                 forbidden_headers = requested_headers - config.allowed_headers
249 |                 logger.warning(
250 |                     f"CORS preflight: Headers {forbidden_headers} not allowed for {origin}"
    |                                                                                         ^^^ E501
251 |                 )
252 |                 return {
    |

src/infrastructure/security/cors_service.py:294:89: E501 Line too long (96 > 88)
    |
292 |             headers.update(
293 |                 {
294 |                     "Strict-Transport-Security": "max-age=31536000; includeSubDomains; preload",
    |                                                                                         ^^^^^^^^ E501
295 |                     "X-Child-Safety": "enabled",
296 |                     "X-Content-Safety-Policy": "child-safe",
    |

src/infrastructure/security/cors_service.py:302:9: PLR0911 Too many return statements (7 > 6)
    |
300 |         return headers
301 |
302 |     def _validate_origin_security(self, origin: str) -> dict[str, any]:
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^ PLR0911
303 |         """Validate origin for security issues."""
304 |         try:
    |

src/infrastructure/security/cors_service.py:317:44: S104 Possible binding to all interfaces
    |
315 |             # Check for localhost exception
316 |             is_localhost = parsed.netloc.startswith(
317 |                 ("localhost", "127.0.0.1", "0.0.0.0")
    |                                            ^^^^^^^^^ S104
318 |             )
319 |             if parsed.scheme == "http" and not is_localhost:
    |

src/infrastructure/security/cors_service.py:336:13: TRY300 Consider moving this statement to an `else` block
    |
334 |                 return {"secure": False, "reason": "Invalid domain format"}
335 |
336 |             return {"secure": True}
    |             ^^^^^^^^^^^^^^^^^^^^^^^ TRY300
337 |         except Exception as e:
338 |             logger.error(f"Error validating origin security: {e}")
    |

src/infrastructure/security/cors_service.py:338:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
336 |             return {"secure": True}
337 |         except Exception as e:
338 |             logger.error(f"Error validating origin security: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
339 |             return {"secure": False, "reason": "Origin validation error"}
    |
    = help: Replace with `exception`

src/infrastructure/security/cors_service.py:391:89: E501 Line too long (96 > 88)
    |
389 |         headers.update(
390 |             {
391 |                 "Vary": "Origin, Access-Control-Request-Method, Access-Control-Request-Headers",
    |                                                                                         ^^^^^^^^ E501
392 |                 "Cache-Control": f"max-age={config.max_age}",
393 |             }
    |

src/infrastructure/security/cors_service.py:440:89: E501 Line too long (93 > 88)
    |
438 |         self.violation_count[origin] = self.violation_count.get(origin, 0) + 1
439 |         logger.warning(
440 |             f"CORS violation from {origin}: {reason} (total: {self.violation_count[origin]})"
    |                                                                                         ^^^^^ E501
441 |         )
    |

src/infrastructure/security/cors_service.py:444:44: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
    |
443 |         # Alert on repeated violations
444 |         if self.violation_count[origin] >= 5:
    |                                            ^ PLR2004
445 |             logger.error(f"Repeated CORS violations from {origin} - possible attack")
    |

src/infrastructure/security/cors_service.py:490:25: SIM118 Use `key in dict` instead of `key in dict.keys()`
    |
488 |             # Clear related cache entries
489 |             cache_keys_to_remove = [
490 |                 key for key in self.origin_cache.keys() if key.startswith(f"{origin}:")
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ SIM118
491 |             ]
492 |             for key in cache_keys_to_remove:
    |
    = help: Remove `.keys()`

src/infrastructure/security/cors_service.py:496:13: TRY300 Consider moving this statement to an `else` block
    |
495 |             logger.info(f"Added origin {origin} to {policy.value} policy")
496 |             return True
    |             ^^^^^^^^^^^ TRY300
497 |         except Exception as e:
498 |             logger.error(f"Error adding origin {origin}: {e}")
    |

src/infrastructure/security/cors_service.py:498:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
496 |             return True
497 |         except Exception as e:
498 |             logger.error(f"Error adding origin {origin}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
499 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/cors_service.py:516:25: SIM118 Use `key in dict` instead of `key in dict.keys()`
    |
514 |             # Clear related cache entries
515 |             cache_keys_to_remove = [
516 |                 key for key in self.origin_cache.keys() if key.startswith(f"{origin}:")
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ SIM118
517 |             ]
518 |             for key in cache_keys_to_remove:
    |
    = help: Remove `.keys()`

src/infrastructure/security/cors_service.py:522:13: TRY300 Consider moving this statement to an `else` block
    |
521 |             logger.info(f"Removed origin {origin} from {policy.value} policy")
522 |             return True
    |             ^^^^^^^^^^^ TRY300
523 |         except Exception as e:
524 |             logger.error(f"Error removing origin {origin}: {e}")
    |

src/infrastructure/security/cors_service.py:524:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
522 |             return True
523 |         except Exception as e:
524 |             logger.error(f"Error removing origin {origin}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
525 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/database_input_validator.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """🔒 AI Teddy Bear - Database Input Validation Middleware
2 | | Database input validation interface for secure data operations.
3 | | """
  | |___^ D205
4 |
5 |   import functools
  |
  = help: Insert single blank line

src/infrastructure/security/database_input_validator.py:21:5: D205 1 blank line required between summary line and description
   |
20 |   class DatabaseInputValidator:
21 | /     """Database input validation interface for secure data operations.
22 | |     Automatically applies:
23 | |     - SQL Injection prevention
24 | |     - Input sanitization
25 | |     - Data validation
26 | |     - Suspicious attempt logging.
27 | |     """
   | |_______^ D205
28 |
29 |       def __init__(self) -> None:
   |
   = help: Insert single blank line

src/infrastructure/security/database_input_validator.py:50:23: TRY003 Avoid specifying long messages outside the exception class
   |
48 |             # Validate field name
49 |             if not self.sql_prevention.validate_column_name(field):
50 |                 raise ValueError(f"Invalid field name: {field}")
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
51 |
52 |             # Determine input type based on field name and table
   |

src/infrastructure/security/database_input_validator.py:64:89: E501 Line too long (100 > 88)
   |
62 |                     threats_detected.extend(sanitization_result.threats_found)
63 |                     logger.warning(
64 |                         f"Threats detected in field '{field}': {sanitization_result.threats_found}",
   |                                                                                         ^^^^^^^^^^^^ E501
65 |                     )
   |

src/infrastructure/security/database_input_validator.py:73:89: E501 Line too long (100 > 88)
   |
71 |                 if sanitization_result.modifications:
72 |                     logger.info(
73 |                         f"Input sanitized for field '{field}': {sanitization_result.modifications}",
   |                                                                                         ^^^^^^^^^^^^ E501
74 |                     )
   |

src/infrastructure/security/database_input_validator.py:112:54: ARG002 Unused method argument: `table_name`
    |
110 |         return validated_data
111 |
112 |     def _determine_input_type(self, field_name: str, table_name: str) -> str:
    |                                                      ^^^^^^^^^^ ARG002
113 |         """تحديد نوع المدخل بناءً على اسم الحقل والجدول."""
114 |         # Map field names to input types for validation
    |

src/infrastructure/security/database_input_validator.py:166:23: TRY003 Avoid specifying long messages outside the exception class
    |
164 |               min_val, max_val = numeric_ranges[field_name]
165 |               if not (min_val <= value <= max_val):
166 |                   raise ValueError(
    |  _______________________^
167 | |                     f"Value {value} for field '{field_name}' is outside valid range [{min_val}, {max_val}]",
168 | |                 )
    | |_________________^ TRY003
169 |
170 |           # Additional validation for specific cases
    |

src/infrastructure/security/database_input_validator.py:167:89: E501 Line too long (108 > 88)
    |
165 |             if not (min_val <= value <= max_val):
166 |                 raise ValueError(
167 |                     f"Value {value} for field '{field_name}' is outside valid range [{min_val}, {max_val}]",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^ E501
168 |                 )
    |

src/infrastructure/security/database_input_validator.py:171:73: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
    |
170 |         # Additional validation for specific cases
171 |         if field_name == "age" and table_name == "children" and value > 13:
    |                                                                         ^^ PLR2004
172 |             raise ValueError("Child age cannot exceed 13 years (COPPA compliance)")
    |

src/infrastructure/security/database_input_validator.py:172:19: TRY003 Avoid specifying long messages outside the exception class
    |
170 |         # Additional validation for specific cases
171 |         if field_name == "age" and table_name == "children" and value > 13:
172 |             raise ValueError("Child age cannot exceed 13 years (COPPA compliance)")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
173 |
174 |         return value
    |

src/infrastructure/security/database_input_validator.py:183:17: TRY004 Prefer `TypeError` exception for invalid type
    |
181 |             # Validate JSON keys
182 |             if not isinstance(key, str):
183 |                 raise ValueError(f"JSON keys must be strings, got {type(key)}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY004
184 |
185 |             if not self.sql_prevention.validate_column_name(key):
    |

src/infrastructure/security/database_input_validator.py:183:23: TRY003 Avoid specifying long messages outside the exception class
    |
181 |             # Validate JSON keys
182 |             if not isinstance(key, str):
183 |                 raise ValueError(f"JSON keys must be strings, got {type(key)}")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
184 |
185 |             if not self.sql_prevention.validate_column_name(key):
    |

src/infrastructure/security/database_input_validator.py:186:23: TRY003 Avoid specifying long messages outside the exception class
    |
185 |             if not self.sql_prevention.validate_column_name(key):
186 |                 raise ValueError(f"Invalid JSON key: {key}")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
187 |
188 |             # Recursively validate JSON values
    |

src/infrastructure/security/database_input_validator.py:240:19: TRY003 Avoid specifying long messages outside the exception class
    |
238 |               )
239 |
240 |               raise DatabaseSecurityError(
    |  ___________________^
241 | |                 f"Dangerous SQL query blocked: {validation_result.errors}",
242 | |             )
    | |_____________^ TRY003
243 |
244 |           return validation_result
    |

src/infrastructure/security/database_input_validator.py:252:5: D205 1 blank line required between summary line and description
    |
251 |   def database_input_validation(table_name: str):
252 | /     """Decorator للتحقق التلقائي من مدخلات قاعدة البيانات
253 | |     Usage:
254 | |     @database_input_validation("users")
255 | |     async def create_user(self, user_data: Dict[str, Any]):
256 | |         # The user_data will be automatically validated.
257 | |     """
    | |_______^ D205
258 |
259 |       def decorator(func: Callable) -> Callable:
    |
    = help: Insert single blank line

src/infrastructure/security/database_input_validator.py:286:27: TRY003 Avoid specifying long messages outside the exception class
    |
284 |                 )
285 |                 if not validation_result.safe:
286 |                     raise DatabaseSecurityError("Query validation failed")
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
287 |
288 |             return await func(*args, **kwargs)
    |

src/infrastructure/security/database_input_validator.py:301:5: D205 1 blank line required between summary line and description
    |
299 |       where_conditions: dict[str, Any] | None = None,
300 |   ) -> dict[str, Any]:
301 | /     """التحقق من عملية قاعدة البيانات قبل التنفيذ
302 | |     Args:
303 | |         operation: نوع العملية (SELECT, INSERT, UPDATE, DELETE)
304 | |         table_name: اسم الجدول
305 | |         data: البيانات للإدراج/التحديث
306 | |         where_conditions: شروط WHERE
307 | |     Returns:
308 | |         Dict containing validated operation details.
309 | |     """
    | |_______^ D205
310 |       validator = DatabaseInputValidator()
    |
    = help: Insert single blank line

src/infrastructure/security/database_input_validator.py:314:15: TRY003 Avoid specifying long messages outside the exception class
    |
312 |     # Validate table name
313 |     if not validator.sql_prevention.validate_table_name(table_name):
314 |         raise DatabaseSecurityError(f"Invalid table name: {table_name}")
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
315 |
316 |     validated_operation = {
    |

src/infrastructure/security/database_input_validator.py:356:19: TRY003 Avoid specifying long messages outside the exception class
    |
354 |         validation_result = self.validator.validate_query_execution(query, params)
355 |         if not validation_result.safe:
356 |             raise DatabaseSecurityError("Query validation failed")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
357 |
358 |         # Log the operation
    |

src/infrastructure/security/database_input_validator.py:374:13: TRY300 Consider moving this statement to an `else` block
    |
372 |             else:
373 |                 result = await self.session.execute(query)
374 |             return result
    |             ^^^^^^^^^^^^^ TRY300
375 |         except Exception as e:
376 |             logger.error(f"Database execution error: {e}")
    |

src/infrastructure/security/database_input_validator.py:376:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
374 |             return result
375 |         except Exception as e:
376 |             logger.error(f"Database execution error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
377 |             raise
    |
    = help: Replace with `exception`

src/infrastructure/security/email_validator.py:39:25: PLR2004 Magic value used in comparison, consider replacing `254` with a constant variable
   |
38 |         # التحقق من طول البريد الإلكتروني
39 |         if len(email) > 254:
   |                         ^^^ PLR2004
40 |             validation_result["valid"] = False
41 |             validation_result["errors"].append("Email address too long")
   |

src/infrastructure/security/environment_validator.py:14:5: D415 First line should end with a period, question mark, or exclamation point
   |
13 | class EnvironmentSecurityValidator:
14 |     """Validates environment configuration for security compliance"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
15 |
16 |     # Minimum entropy bits for secrets
   |
   = help: Add closing punctuation

src/infrastructure/security/environment_validator.py:20:24: RUF012 Mutable class attributes should be annotated with `typing.ClassVar`
   |
19 |       # Required environment variables with validation rules
20 |       REQUIRED_SECRETS = {
   |  ________________________^
21 | |         "DATABASE_URL": {
22 | |             "min_length": 20,
23 | |             "pattern": r"^postgresql://",
24 | |             "no_defaults": ["CHANGE_ME", "password", "admin", "root", "test"],
25 | |             "description": "PostgreSQL connection string",
26 | |         },
27 | |         "JWT_SECRET": {
28 | |             "min_length": 64,
29 | |             "pattern": None,
30 | |             "no_defaults": ["REQUIRED", "CHANGE", "SECRET", "your_secret"],
31 | |             "description": "JWT signing secret",
32 | |         },
33 | |         "ENCRYPTION_KEY": {
34 | |             "min_length": 64,
35 | |             "pattern": None,
36 | |             "no_defaults": ["REQUIRED", "CHANGE", "SECRET"],
37 | |             "description": "Data encryption key",
38 | |         },
39 | |         "SESSION_SECRET": {
40 | |             "min_length": 64,
41 | |             "pattern": None,
42 | |             "no_defaults": ["REQUIRED", "CHANGE", "SECRET"],
43 | |             "description": "Session encryption secret",
44 | |         },
45 | |         "OPENAI_API_KEY": {
46 | |             "min_length": 40,
47 | |             "pattern": r"^sk-",
48 | |             "no_defaults": ["REQUIRED", "your_api_key"],
49 | |             "description": "OpenAI API key",
50 | |         },
51 | |     }
   | |_____^ RUF012
52 |
53 |       # Optional but recommended secrets
   |

src/infrastructure/security/environment_validator.py:54:27: RUF012 Mutable class attributes should be annotated with `typing.ClassVar`
   |
53 |       # Optional but recommended secrets
54 |       RECOMMENDED_SECRETS = {
   |  ___________________________^
55 | |         "VAULT_TOKEN": {
56 | |             "min_length": 20,
57 | |             "description": "HashiCorp Vault token",
58 | |         },
59 | |         "SENTRY_DSN": {
60 | |             "min_length": 20,
61 | |             "description": "Sentry error tracking",
62 | |         },
63 | |         "PARENT_VERIFICATION_API_KEY": {
64 | |             "min_length": 32,
65 | |             "description": "Parent verification service",
66 | |         },
67 | |     }
   | |_____^ RUF012
68 |
69 |       @classmethod
   |

src/infrastructure/security/environment_validator.py:70:9: PLR0912 Too many branches (16 > 12)
   |
69 |     @classmethod
70 |     def validate_all(cls) -> tuple[bool, list[str]]:
   |         ^^^^^^^^^^^^ PLR0912
71 |         """Validate all environment variables
72 |         Returns: (is_valid, list_of_errors)
   |

src/infrastructure/security/environment_validator.py:71:9: D205 1 blank line required between summary line and description
   |
69 |       @classmethod
70 |       def validate_all(cls) -> tuple[bool, list[str]]:
71 | /         """Validate all environment variables
72 | |         Returns: (is_valid, list_of_errors)
73 | |         """
   | |___________^ D205
74 |           errors = []
75 |           warnings = []
   |
   = help: Insert single blank line

src/infrastructure/security/environment_validator.py:71:9: D415 First line should end with a period, question mark, or exclamation point
   |
69 |       @classmethod
70 |       def validate_all(cls) -> tuple[bool, list[str]]:
71 | /         """Validate all environment variables
72 | |         Returns: (is_valid, list_of_errors)
73 | |         """
   | |___________^ D415
74 |           errors = []
75 |           warnings = []
   |
   = help: Add closing punctuation

src/infrastructure/security/environment_validator.py:105:21: PERF401 Use `list.extend` to create a transformed list
    |
103 |               for default in rules.get("no_defaults", []):
104 |                   if default.lower() in value.lower():
105 | /                     errors.append(
106 | |                         f"{var_name} contains default/weak value: '{default}'"
107 | |                     )
    | |_____________________^ PERF401
108 |
109 |               if var_name in ["JWT_SECRET", "ENCRYPTION_KEY", "SESSION_SECRET"]:
    |
    = help: Replace for loop with list.extend

src/infrastructure/security/environment_validator.py:135:89: E501 Line too long (111 > 88)
    |
133 |             if int(retention_days) > COPPA_MAX_RETENTION_DAYS:
134 |                 errors.append(
135 |                     f"DATA_RETENTION_DAYS ({retention_days}) exceeds COPPA limit of {COPPA_MAX_RETENTION_DAYS}"
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^ E501
136 |                 )
137 |         except ValueError:
    |

src/infrastructure/security/environment_validator.py:148:9: D415 First line should end with a period, question mark, or exclamation point
    |
146 |     @staticmethod
147 |     def _calculate_entropy(value: str) -> float:
148 |         """Calculate Shannon entropy of a string in bits"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
149 |         if not value:
150 |             return 0.0
    |
    = help: Add closing punctuation

src/infrastructure/security/environment_validator.py:169:9: D415 First line should end with a period, question mark, or exclamation point
    |
167 |     @classmethod
168 |     def generate_secure_secret(cls, length: int = 64) -> str:
169 |         """Generate a cryptographically secure secret"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
170 |         return secrets.token_urlsafe(length)
    |
    = help: Add closing punctuation

src/infrastructure/security/environment_validator.py:174:9: D415 First line should end with a period, question mark, or exclamation point
    |
172 |     @classmethod
173 |     def validate_and_exit_on_error(cls) -> None:
174 |         """Validate environment and exit if errors found"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
175 |         is_valid, errors = cls.validate_all()
176 |         if not is_valid:
    |
    = help: Add closing punctuation

src/infrastructure/security/environment_validator.py:195:9: D415 First line should end with a period, question mark, or exclamation point
    |
193 |     @classmethod
194 |     def get_secure_config(cls) -> dict[str, str]:
195 |         """Get validated configuration with defaults for development only"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
196 |         config = {}
    |
    = help: Add closing punctuation

src/infrastructure/security/fallback_rate_limiter.py:31:89: E501 Line too long (96 > 88)
   |
30 |         logger.info(
31 |             f"Fallback rate limiter initialized: {default_limit} requests per {window_seconds}s"
   |                                                                                         ^^^^^^^^ E501
32 |         )
   |

src/infrastructure/security/fallback_rate_limiter.py:250:5: D205 1 blank line required between summary line and description
    |
249 |   class FallbackRateLimitService:
250 | /     """High - level rate limiting service with Redis fallback.
251 | |     Automatically falls back to in -memory limiting when Redis is unavailable.
252 | |     """
    | |_______^ D205
253 |
254 |       def __init__(self, redis_client=None) -> None:
    |
    = help: Insert single blank line

src/infrastructure/security/fallback_rate_limiter.py:307:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
305 |                 )
306 |             except Exception as e:
307 |                 logger.error(f"Redis rate limiting failed, using fallback: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
308 |                 self.redis_available = False
    |
    = help: Replace with `exception`

src/infrastructure/security/fallback_rate_limiter.py:353:89: E501 Line too long (90 > 88)
    |
351 |         endpoint: str | None = None,
352 |     ) -> None:
353 |         """Set custom rate limit(applies to fallback, Redis limits handled separately)."""
    |                                                                                         ^^ E501
354 |         self.fallback_limiter.set_custom_limit(user_id, limit, window_seconds, endpoint)
    |

src/infrastructure/security/file_security_manager.py:29:9: PLR0911 Too many return statements (7 > 6)
   |
27 |         ]
28 |
29 |     def validate_audio_file(self, filename: str, file_content: bytes) -> dict[str, Any]:
   |         ^^^^^^^^^^^^^^^^^^^ PLR0911
30 |         """Validate audio file for security and format compliance.
   |

src/infrastructure/security/file_security_manager.py:63:89: E501 Line too long (90 > 88)
   |
61 |             if sanitized_filename != filename:
62 |                 result["warnings"].append(
63 |                     f"Filename was sanitized from '{filename}' to '{sanitized_filename}'",
   |                                                                                         ^^ E501
64 |                 )
   |

src/infrastructure/security/file_security_manager.py:107:13: TRY300 Consider moving this statement to an `else` block
    |
106 |             logger.info(f"Audio file validation successful for {sanitized_filename}")
107 |             return result
    |             ^^^^^^^^^^^^^ TRY300
108 |         except (ValueError, OSError, RuntimeError) as e:
109 |             logger.error(f"Error validating audio file {filename}: {e}")
    |

src/infrastructure/security/file_security_manager.py:109:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
107 |             return result
108 |         except (ValueError, OSError, RuntimeError) as e:
109 |             logger.error(f"Error validating audio file {filename}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
110 |             result["errors"].append(f"Validation error: {e!s}")
111 |             return result
    |
    = help: Replace with `exception`

src/infrastructure/security/file_security_manager.py:113:9: PLR0912 Too many branches (19 > 12)
    |
111 |             return result
112 |
113 |     def _validate_audio_magic_numbers(
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLR0912
114 |         self,
115 |         file_content: bytes,
    |

src/infrastructure/security/file_security_manager.py:121:32: PLR2004 Magic value used in comparison, consider replacing `12` with a constant variable
    |
119 |         result = {"is_valid": False, "errors": []}
120 |
121 |         if len(file_content) < 12:
    |                                ^^ PLR2004
122 |             result["errors"].append("File too small to contain valid audio header")
123 |             return result
    |

src/infrastructure/security/file_security_manager.py:212:33: PLR2004 Magic value used in comparison, consider replacing `255` with a constant variable
    |
211 |             # Limit length
212 |             if len(sanitized) > 255:
    |                                 ^^^ PLR2004
213 |                 name_part = sanitized[:200]
214 |                 ext_part = sanitized[200:]
    |

src/infrastructure/security/file_security_manager.py:227:13: TRY300 Consider moving this statement to an `else` block
    |
226 |             logger.debug(f"Sanitized filename: '{filename}' -> '{sanitized}'")
227 |             return sanitized
    |             ^^^^^^^^^^^^^^^^ TRY300
228 |         except Exception as e:
229 |             logger.error(f"Error sanitizing filename {filename}: {e}")
    |

src/infrastructure/security/file_security_manager.py:229:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
227 |             return sanitized
228 |         except Exception as e:
229 |             logger.error(f"Error sanitizing filename {filename}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
230 |             return "safe_filename.txt"
    |
    = help: Replace with `exception`

src/infrastructure/security/hardening/__init__.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Security Hardening Package
2 | | Collection of security hardening measures for the application.
3 | | Note: This module is currently not in use but kept for future implementation.
4 | | """
  | |___^ D205
5 |
6 |   # CSRF Protection
  |
  = help: Insert single blank line

src/infrastructure/security/hardening/__init__.py:7:1: I001 [*] Import block is un-sorted or un-formatted
   |
 6 |   # CSRF Protection
 7 | / from .csrf_protection import (
 8 | |     CSRFConfig,
 9 | |     CSRFTokenManager,
10 | |     CSRFProtection,
11 | |     CSRFMiddleware,
12 | |     get_csrf_protection,
13 | |     init_csrf_protection,
14 | |     csrf_protect,
15 | | )
16 | |
17 | | # Input Validation components
18 | | from .validation import (
19 | |     InputSanitizer,
20 | |     InputValidationConfig,
21 | |     ValidationRule,
22 | |     ValidationSeverity,
23 | | )
   | |_^ I001
24 |
25 |   __all__ = [
   |
   = help: Organize imports

src/infrastructure/security/hardening/__init__.py:25:11: RUF022 `__all__` is not sorted
   |
23 |   )
24 |
25 |   __all__ = [
   |  ___________^
26 | |     # CSRF Protection
27 | |     "CSRFConfig",
28 | |     "CSRFTokenManager",
29 | |     "CSRFProtection",
30 | |     "CSRFMiddleware",
31 | |     "get_csrf_protection",
32 | |     "init_csrf_protection",
33 | |     "csrf_protect",
34 | |     # Input Validation
35 | |     "InputSanitizer",
36 | |     "InputValidationConfig",
37 | |     "ValidationRule",
38 | |     "ValidationSeverity",
39 | | ]
   | |_^ RUF022
40 |
41 |   # Package version
   |
   = help: Apply an isort-style sorting to `__all__`

src/infrastructure/security/hardening/csrf_protection.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """CSRF Protection for AI Teddy Bear
2 | | Comprehensive Cross-Site Request Forgery protection with token-based validation
3 | | """
  | |___^ D205
4 |
5 |   import hashlib
  |
  = help: Insert single blank line

src/infrastructure/security/hardening/csrf_protection.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """CSRF Protection for AI Teddy Bear
2 | | Comprehensive Cross-Site Request Forgery protection with token-based validation
3 | | """
  | |___^ D415
4 |
5 |   import hashlib
  |
  = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:20:5: D415 First line should end with a period, question mark, or exclamation point
   |
18 | @dataclass
19 | class CSRFConfig:
20 |     """Configuration for CSRF protection"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
21 |
22 |     secret_key: str
   |
   = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:36:5: D205 1 blank line required between summary line and description
   |
35 |   class CSRFTokenManager:
36 | /     """Manages CSRF token generation, validation, and storage
37 | |     Implements double-submit cookie pattern with cryptographic validation
38 | |     """
   | |_______^ D205
39 |
40 |       def __init__(self, config: CSRFConfig) -> None:
   |
   = help: Insert single blank line

src/infrastructure/security/hardening/csrf_protection.py:36:5: D415 First line should end with a period, question mark, or exclamation point
   |
35 |   class CSRFTokenManager:
36 | /     """Manages CSRF token generation, validation, and storage
37 | |     Implements double-submit cookie pattern with cryptographic validation
38 | |     """
   | |_______^ D415
39 |
40 |       def __init__(self, config: CSRFConfig) -> None:
   |
   = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:43:62: PLR2004 Magic value used in comparison, consider replacing `32` with a constant variable
   |
41 |         self.config = config
42 |         self.token_cache: dict[str, dict] = {}  # In-memory cache for tokens
43 |         if not config.secret_key or len(config.secret_key) < 32:
   |                                                              ^^ PLR2004
44 |             raise ValueError("CSRF secret key must be at least 32 characters long")
   |

src/infrastructure/security/hardening/csrf_protection.py:44:19: TRY003 Avoid specifying long messages outside the exception class
   |
42 |         self.token_cache: dict[str, dict] = {}  # In-memory cache for tokens
43 |         if not config.secret_key or len(config.secret_key) < 32:
44 |             raise ValueError("CSRF secret key must be at least 32 characters long")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
45 |
46 |     def generate_token(self, session_id: str, user_id: str = None) -> str:
   |

src/infrastructure/security/hardening/csrf_protection.py:46:56: RUF013 PEP 484 prohibits implicit `Optional`
   |
44 |             raise ValueError("CSRF secret key must be at least 32 characters long")
45 |
46 |     def generate_token(self, session_id: str, user_id: str = None) -> str:
   |                                                        ^^^ RUF013
47 |         """Generate a cryptographically secure CSRF token
48 |         Args: session_id: User session identifier
   |
   = help: Convert to `T | None`

src/infrastructure/security/hardening/csrf_protection.py:47:9: D205 1 blank line required between summary line and description
   |
46 |       def generate_token(self, session_id: str, user_id: str = None) -> str:
47 | /         """Generate a cryptographically secure CSRF token
48 | |         Args: session_id: User session identifier
49 | |             user_id: Optional user identifier for additional security
50 | |         Returns: Base64-encoded CSRF token
51 | |         """
   | |___________^ D205
52 |           try:
53 |               # Create timestamp
   |
   = help: Insert single blank line

src/infrastructure/security/hardening/csrf_protection.py:47:9: D415 First line should end with a period, question mark, or exclamation point
   |
46 |       def generate_token(self, session_id: str, user_id: str = None) -> str:
47 | /         """Generate a cryptographically secure CSRF token
48 | |         Args: session_id: User session identifier
49 | |             user_id: Optional user identifier for additional security
50 | |         Returns: Base64-encoded CSRF token
51 | |         """
   | |___________^ D415
52 |           try:
53 |               # Create timestamp
   |
   = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:77:13: TRY300 Consider moving this statement to an `else` block
   |
75 |             self._cleanup_expired_tokens()
76 |             logger.debug(f"Generated CSRF token for session {session_id}")
77 |             return full_token
   |             ^^^^^^^^^^^^^^^^^ TRY300
78 |         except Exception as e:
79 |             logger.error(f"Failed to generate CSRF token: {e}")
   |

src/infrastructure/security/hardening/csrf_protection.py:79:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
77 |             return full_token
78 |         except Exception as e:
79 |             logger.error(f"Failed to generate CSRF token: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
80 |             raise
   |
   = help: Replace with `exception`

src/infrastructure/security/hardening/csrf_protection.py:82:9: PLR0911 Too many return statements (7 > 6)
   |
80 |             raise
81 |
82 |     def validate_token(self, token: str, session_id: str, user_id: str = None) -> bool:
   |         ^^^^^^^^^^^^^^ PLR0911
83 |         """Validate CSRF token against session and user
84 |         Args: token: CSRF token to validate
   |

src/infrastructure/security/hardening/csrf_protection.py:82:68: RUF013 PEP 484 prohibits implicit `Optional`
   |
80 |             raise
81 |
82 |     def validate_token(self, token: str, session_id: str, user_id: str = None) -> bool:
   |                                                                    ^^^ RUF013
83 |         """Validate CSRF token against session and user
84 |         Args: token: CSRF token to validate
   |
   = help: Convert to `T | None`

src/infrastructure/security/hardening/csrf_protection.py:83:9: D205 1 blank line required between summary line and description
   |
82 |       def validate_token(self, token: str, session_id: str, user_id: str = None) -> bool:
83 | /         """Validate CSRF token against session and user
84 | |         Args: token: CSRF token to validate
85 | |             session_id: Current session identifier
86 | |             user_id: Current user identifier
87 | |         Returns: True if token is valid, False otherwise
88 | |         """
   | |___________^ D205
89 |           try:
90 |               if not token:
   |
   = help: Insert single blank line

src/infrastructure/security/hardening/csrf_protection.py:83:9: D415 First line should end with a period, question mark, or exclamation point
   |
82 |       def validate_token(self, token: str, session_id: str, user_id: str = None) -> bool:
83 | /         """Validate CSRF token against session and user
84 | |         Args: token: CSRF token to validate
85 | |             session_id: Current session identifier
86 | |             user_id: Current user identifier
87 | |         Returns: True if token is valid, False otherwise
88 | |         """
   | |___________^ D415
89 |           try:
90 |               if not token:
   |
   = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:112:13: TRY300 Consider moving this statement to an `else` block
    |
110 |                 return False
111 |             logger.debug(f"CSRF token validated successfully: {token[:16]}...")
112 |             return True
    |             ^^^^^^^^^^^ TRY300
113 |         except Exception as e:
114 |             logger.error(f"CSRF token validation error: {e}")
    |

src/infrastructure/security/hardening/csrf_protection.py:114:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
112 |             return True
113 |         except Exception as e:
114 |             logger.error(f"CSRF token validation error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
115 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/hardening/csrf_protection.py:118:9: D205 1 blank line required between summary line and description
    |
117 |       def invalidate_token(self, token: str) -> bool:
118 | /         """Invalidate a specific CSRF token
119 | |         Args: token: Token to invalidate
120 | |         Returns: True if token was found and invalidated
121 | |         """
    | |___________^ D205
122 |           try:
123 |               if token in self.token_cache:
    |
    = help: Insert single blank line

src/infrastructure/security/hardening/csrf_protection.py:118:9: D415 First line should end with a period, question mark, or exclamation point
    |
117 |       def invalidate_token(self, token: str) -> bool:
118 | /         """Invalidate a specific CSRF token
119 | |         Args: token: Token to invalidate
120 | |         Returns: True if token was found and invalidated
121 | |         """
    | |___________^ D415
122 |           try:
123 |               if token in self.token_cache:
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:127:13: TRY300 Consider moving this statement to an `else` block
    |
125 |                 logger.debug(f"Invalidated CSRF token: {token[:16]}...")
126 |                 return True
127 |             return False
    |             ^^^^^^^^^^^^ TRY300
128 |         except Exception as e:
129 |             logger.error(f"Failed to invalidate CSRF token: {e}")
    |

src/infrastructure/security/hardening/csrf_protection.py:129:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
127 |             return False
128 |         except Exception as e:
129 |             logger.error(f"Failed to invalidate CSRF token: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
130 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/hardening/csrf_protection.py:133:9: D205 1 blank line required between summary line and description
    |
132 |       def invalidate_session_tokens(self, session_id: str) -> int:
133 | /         """Invalidate all tokens for a specific session
134 | |         Args: session_id: Session to invalidate tokens for Returns: Number of tokens invalidated
135 | |         """
    | |___________^ D205
136 |           try:
137 |               tokens_to_remove = [
    |
    = help: Insert single blank line

src/infrastructure/security/hardening/csrf_protection.py:133:9: D415 First line should end with a period, question mark, or exclamation point
    |
132 |       def invalidate_session_tokens(self, session_id: str) -> int:
133 | /         """Invalidate all tokens for a specific session
134 | |         Args: session_id: Session to invalidate tokens for Returns: Number of tokens invalidated
135 | |         """
    | |___________^ D415
136 |           try:
137 |               tokens_to_remove = [
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:134:89: E501 Line too long (96 > 88)
    |
132 |     def invalidate_session_tokens(self, session_id: str) -> int:
133 |         """Invalidate all tokens for a specific session
134 |         Args: session_id: Session to invalidate tokens for Returns: Number of tokens invalidated
    |                                                                                         ^^^^^^^^ E501
135 |         """
136 |         try:
    |

src/infrastructure/security/hardening/csrf_protection.py:145:89: E501 Line too long (91 > 88)
    |
143 |                 del self.token_cache[token]
144 |             logger.info(
145 |                 f"Invalidated {len(tokens_to_remove)} CSRF tokens for session {session_id}"
    |                                                                                         ^^^ E501
146 |             )
147 |             return len(tokens_to_remove)
    |

src/infrastructure/security/hardening/csrf_protection.py:149:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
147 |             return len(tokens_to_remove)
148 |         except Exception as e:
149 |             logger.error(f"Failed to invalidate session tokens: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
150 |             return 0
    |
    = help: Replace with `exception`

src/infrastructure/security/hardening/csrf_protection.py:153:9: D415 First line should end with a period, question mark, or exclamation point
    |
152 |     def _cleanup_expired_tokens(self) -> None:
153 |         """Remove expired tokens from cache"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
154 |         try:
155 |             current_time = int(time.time())
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:166:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
164 |                 logger.debug(f"Cleaned up {len(expired_tokens)} expired CSRF tokens")
165 |         except Exception as e:
166 |             logger.error(f"Failed to cleanup expired tokens: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
167 |
168 |     def get_token_stats(self) -> dict[str, int]:
    |
    = help: Replace with `exception`

src/infrastructure/security/hardening/csrf_protection.py:169:9: D415 First line should end with a period, question mark, or exclamation point
    |
168 |     def get_token_stats(self) -> dict[str, int]:
169 |         """Get statistics about current tokens"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
170 |         try:
171 |             current_time = int(time.time())
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:184:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
182 |             }
183 |         except Exception as e:
184 |             logger.error(f"Failed to get token stats: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
185 |             return {}
    |
    = help: Replace with `exception`

src/infrastructure/security/hardening/csrf_protection.py:189:5: D415 First line should end with a period, question mark, or exclamation point
    |
188 | class CSRFProtection:
189 |     """Main CSRF protection class Provides middleware and utilities for CSRF protection"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
190 |
191 |     def __init__(self, config: CSRFConfig) -> None:
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:189:89: E501 Line too long (90 > 88)
    |
188 | class CSRFProtection:
189 |     """Main CSRF protection class Provides middleware and utilities for CSRF protection"""
    |                                                                                         ^^ E501
190 |
191 |     def __init__(self, config: CSRFConfig) -> None:
    |

src/infrastructure/security/hardening/csrf_protection.py:196:9: D415 First line should end with a period, question mark, or exclamation point
    |
195 |     def generate_token_for_request(self, request: Request) -> str:
196 |         """Generate CSRF token for current request"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
197 |         session_id = self._get_session_id(request)
198 |         user_id = self._get_user_id(request)
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:202:9: D205 1 blank line required between summary line and description
    |
201 |       def validate_request(self, request: Request) -> bool:
202 | /         """Validate CSRF protection for request
203 | |         Args: request: FastAPI request object
204 | |         Returns: True if request is valid or doesn't require CSRF protection
205 | |         """
    | |___________^ D205
206 |           try:
207 |               # Skip CSRF for safe methods
    |
    = help: Insert single blank line

src/infrastructure/security/hardening/csrf_protection.py:202:9: D415 First line should end with a period, question mark, or exclamation point
    |
201 |       def validate_request(self, request: Request) -> bool:
202 | /         """Validate CSRF protection for request
203 | |         Args: request: FastAPI request object
204 | |         Returns: True if request is valid or doesn't require CSRF protection
205 | |         """
    | |___________^ D415
206 |           try:
207 |               # Skip CSRF for safe methods
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:229:13: TRY300 Consider moving this statement to an `else` block
    |
227 |                     f"from {request.client.host if request.client else 'unknown'}"
228 |                 )
229 |             return is_valid
    |             ^^^^^^^^^^^^^^^ TRY300
230 |         except Exception as e:
231 |             logger.error(f"CSRF validation error: {e}")
    |

src/infrastructure/security/hardening/csrf_protection.py:231:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
229 |             return is_valid
230 |         except Exception as e:
231 |             logger.error(f"CSRF validation error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
232 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/hardening/csrf_protection.py:235:9: D415 First line should end with a period, question mark, or exclamation point
    |
234 |     def set_csrf_cookie(self, response: Response, token: str) -> None:
235 |         """Set CSRF token as HTTP-only cookie"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
236 |         try:
237 |             response.set_cookie(
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:246:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
244 |             )
245 |         except Exception as e:
246 |             logger.error(f"Failed to set CSRF cookie: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
247 |
248 |     def _get_session_id(self, request: Request) -> str:
    |
    = help: Replace with `exception`

src/infrastructure/security/hardening/csrf_protection.py:249:9: D415 First line should end with a period, question mark, or exclamation point
    |
248 |     def _get_session_id(self, request: Request) -> str:
249 |         """Extract session ID from request"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
250 |         # Try to get from session cookie or generate one
251 |         session_id = request.cookies.get("session_id")
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:259:9: D415 First line should end with a period, question mark, or exclamation point
    |
258 |     def _get_user_id(self, request: Request) -> str | None:
259 |         """Extract user ID from request(if authenticated)"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
260 |         try:
261 |             # Try to get from request state (set by auth middleware)
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:265:13: TRY300 Consider moving this statement to an `else` block
    |
263 |             if user and isinstance(user, dict):
264 |                 return user.get("user_id")
265 |             return None
    |             ^^^^^^^^^^^ TRY300
266 |         except Exception as e:
267 |             logger.debug(f"Could not extract user ID: {e}")
    |

src/infrastructure/security/hardening/csrf_protection.py:271:9: D415 First line should end with a period, question mark, or exclamation point
    |
270 |     def _get_csrf_token_from_request(self, request: Request) -> str | None:
271 |         """Extract CSRF token from request headers or form data"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
272 |         try:
273 |             # Try header first
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:281:13: TRY300 Consider moving this statement to an `else` block
    |
279 |             if token:
280 |                 return token
281 |             return None
    |             ^^^^^^^^^^^ TRY300
282 |         except Exception as e:
283 |             logger.error(f"Failed to extract CSRF token: {e}")
    |

src/infrastructure/security/hardening/csrf_protection.py:283:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
281 |             return None
282 |         except Exception as e:
283 |             logger.error(f"Failed to extract CSRF token: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
284 |             return None
    |
    = help: Replace with `exception`

src/infrastructure/security/hardening/csrf_protection.py:289:5: D415 First line should end with a period, question mark, or exclamation point
    |
287 | # Middleware for automatic CSRF protection
288 | class CSRFMiddleware:
289 |     """ASGI middleware for automatic CSRF protection"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
290 |
291 |     def __init__(self, app, config: CSRFConfig) -> None:
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:317:5: D415 First line should end with a period, question mark, or exclamation point
    |
316 | def get_csrf_protection() -> CSRFProtection:
317 |     """Get global CSRF protection instance"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
318 |     global _csrf_protection
319 |     if _csrf_protection is None:
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:318:12: PLW0603 Using the global statement to update `_csrf_protection` is discouraged
    |
316 | def get_csrf_protection() -> CSRFProtection:
317 |     """Get global CSRF protection instance"""
318 |     global _csrf_protection
    |            ^^^^^^^^^^^^^^^^ PLW0603
319 |     if _csrf_protection is None:
320 |         # Default configuration - should be overridden in production
    |

src/infrastructure/security/hardening/csrf_protection.py:333:5: D415 First line should end with a period, question mark, or exclamation point
    |
332 | def init_csrf_protection(secret_key: str, **kwargs) -> CSRFProtection:
333 |     """Initialize CSRF protection with custom configuration"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
334 |     global _csrf_protection
335 |     config = CSRFConfig(secret_key=secret_key, **kwargs)
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/csrf_protection.py:334:12: PLW0603 Using the global statement to update `_csrf_protection` is discouraged
    |
332 | def init_csrf_protection(secret_key: str, **kwargs) -> CSRFProtection:
333 |     """Initialize CSRF protection with custom configuration"""
334 |     global _csrf_protection
    |            ^^^^^^^^^^^^^^^^ PLW0603
335 |     config = CSRFConfig(secret_key=secret_key, **kwargs)
336 |     _csrf_protection = CSRFProtection(config)
    |

src/infrastructure/security/hardening/csrf_protection.py:343:5: D415 First line should end with a period, question mark, or exclamation point
    |
341 | # Decorator for protecting individual endpoints
342 | def csrf_protect(func):
343 |     """Decorator to add CSRF protection to individual endpoints"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
344 |
345 |     async def wrapper(*args, **kwargs):
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/secure_settings.py:17:11: TRY003 Avoid specifying long messages outside the exception class
   |
15 |           "Install required dependencies: pip install pydantic pydantic-settings",
16 |       )
17 |       raise ImportError(
   |  ___________^
18 | |         "Missing required dependency: pydantic. This application cannot run without it.",
19 | |     ) from e
   | |_____^ TRY003
   |

src/infrastructure/security/hardening/secure_settings.py:18:89: E501 Line too long (89 > 88)
   |
16 |     )
17 |     raise ImportError(
18 |         "Missing required dependency: pydantic. This application cannot run without it.",
   |                                                                                         ^ E501
19 |     ) from e
   |

src/infrastructure/security/hardening/secure_settings.py:80:11: D106 Missing docstring in public nested class
   |
78 |     enable_rate_limiting: bool = Field(default=True, description="Enable rate limiting")
79 |
80 |     class Config:
   |           ^^^^^^ D106
81 |         env_file = ".env"
82 |         env_file_encoding = "utf-8"
   |

src/infrastructure/security/hardening/security_tests/authentication_tests.py:71:56: PLR2004 Magic value used in comparison, consider replacing `0.25` with a constant variable
   |
69 |                 files_with_validation += 1
70 |
71 |         if files_with_validation / len(python_files) < 0.25:  # Arbitrary threshold
   |                                                        ^^^^ PLR2004
72 |             issues.append("Low usage of input validation keywords")
   |

src/infrastructure/security/hardening/security_tests/base_tester.py:40:18: PTH123 `open()` should be replaced by `Path.open()`
   |
38 |         """Read file content safely with error handling."""
39 |         try:
40 |             with open(file_path, encoding="utf-8") as f:
   |                  ^^^^ PTH123
41 |                 return f.read()
42 |         except Exception as e:
   |

src/infrastructure/security/hardening/security_tests/compliance_tests.py:96:89: E501 Line too long (92 > 88)
   |
94 |         recommendations = [
95 |             "Ensure a lawful basis for data processing",
96 |             "Implement mechanisms for data subject rights (access, rectification, erasure)",
   |                                                                                         ^^^^ E501
97 |             "Provide clear privacy notices",
98 |         ]
   |

src/infrastructure/security/hardening/security_tests/encryption_tests.py:109:89: E501 Line too long (107 > 88)
    |
108 |         recommendations = [
109 |             "Store secrets in environment variables or a secret management system (e.g., HashiCorp Vault)",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^ E501
110 |             "Use a library like `pydantic-settings` to manage secrets",
111 |             "Rotate secrets regularly",
    |

src/infrastructure/security/hardening/security_tests/injection_tests.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Injection Security Tests"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | import re
  |
  = help: Add closing punctuation

src/infrastructure/security/hardening/security_tests/injection_tests.py:14:5: D415 First line should end with a period, question mark, or exclamation point
   |
13 | class InjectionTester(BaseSecurityTester):
14 |     """Tests for various injection vulnerabilities"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
15 |
16 |     def test_code_injection(self) -> dict[str, Any]:
   |
   = help: Add closing punctuation

src/infrastructure/security/hardening/security_tests/injection_tests.py:17:9: D415 First line should end with a period, question mark, or exclamation point
   |
16 |     def test_code_injection(self) -> dict[str, Any]:
17 |         """Test for code injection vulnerabilities"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
18 |         issues = []
19 |         dangerous_patterns = [
   |
   = help: Add closing punctuation

src/infrastructure/security/hardening/security_tests/injection_tests.py:54:9: D415 First line should end with a period, question mark, or exclamation point
   |
53 |     def test_sql_injection(self) -> dict[str, Any]:
54 |         """Test for SQL injection vulnerabilities"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
55 |         issues = []
56 |         sql_patterns = [
   |
   = help: Add closing punctuation

src/infrastructure/security/hardening/security_tests/injection_tests.py:93:9: D415 First line should end with a period, question mark, or exclamation point
   |
92 |     def test_xss_vulnerabilities(self) -> dict[str, Any]:
93 |         """Test for Cross-Site Scripting (XSS) vulnerabilities"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
94 |         issues = []
95 |         xss_patterns = [
   |
   = help: Add closing punctuation

src/infrastructure/security/hardening/security_tests/injection_tests.py:146:9: D415 First line should end with a period, question mark, or exclamation point
    |
145 |     def test_path_traversal(self) -> dict[str, Any]:
146 |         """Test for path traversal vulnerabilities"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
147 |         issues = []
148 |         path_patterns = [
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/security_tests/injection_tests.py:172:89: E501 Line too long (95 > 88)
    |
170 |         recommendations = [
171 |             "Never use user-provided input directly in file paths",
172 |             "Use a secure method to serve files, ensuring the path is within a safe directory",
    |                                                                                         ^^^^^^^ E501
173 |             "Validate and sanitize all file path inputs",
174 |         ]
    |

src/infrastructure/security/hardening/security_validator.py:1:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | from src.infrastructure.security.security_levels import SecurityLevel
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ I001
2 | """Security Validator for AI Teddy Bear v5.
  |
  = help: Organize imports

src/infrastructure/security/hardening/security_validator.py:1:57: F401 [*] `src.infrastructure.security.security_levels.SecurityLevel` imported but unused
  |
1 | from src.infrastructure.security.security_levels import SecurityLevel
  |                                                         ^^^^^^^^^^^^^ F401
2 | """Security Validator for AI Teddy Bear v5.
  |
  = help: Remove unused import: `src.infrastructure.security.security_levels.SecurityLevel`

src/infrastructure/security/hardening/security_validator.py:8:1: E402 Module level import not at top of file
   |
 6 | """
 7 |
 8 | import re
   | ^^^^^^^^^ E402
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
10 | from dataclasses import dataclass, field
   |

src/infrastructure/security/hardening/security_validator.py:8:1: I001 [*] Import block is un-sorted or un-formatted
   |
 6 |   """
 7 |
 8 | / import re
 9 | | from typing import Dict, List, Optional, Set, Tuple, Any
10 | | from dataclasses import dataclass, field
11 | | from datetime import datetime, timezone
12 | | from enum import Enum
13 | | import hashlib
14 | | import secrets
15 | |
16 | | from src.infrastructure.logging_config import get_logger
   | |________________________________________________________^ I001
17 |
18 |   logger = get_logger(__name__, component="security-validator")
   |
   = help: Organize imports

src/infrastructure/security/hardening/security_validator.py:8:8: F401 [*] `re` imported but unused
   |
 6 | """
 7 |
 8 | import re
   |        ^^ F401
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
10 | from dataclasses import dataclass, field
   |
   = help: Remove unused import: `re`

src/infrastructure/security/hardening/security_validator.py:9:1: E402 Module level import not at top of file
   |
 8 | import re
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
10 | from dataclasses import dataclass, field
11 | from datetime import datetime, timezone
   |

src/infrastructure/security/hardening/security_validator.py:9:1: UP035 `typing.Dict` is deprecated, use `dict` instead
   |
 8 | import re
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
10 | from dataclasses import dataclass, field
11 | from datetime import datetime, timezone
   |

src/infrastructure/security/hardening/security_validator.py:9:1: UP035 `typing.List` is deprecated, use `list` instead
   |
 8 | import re
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
10 | from dataclasses import dataclass, field
11 | from datetime import datetime, timezone
   |

src/infrastructure/security/hardening/security_validator.py:9:1: UP035 `typing.Set` is deprecated, use `set` instead
   |
 8 | import re
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
10 | from dataclasses import dataclass, field
11 | from datetime import datetime, timezone
   |

src/infrastructure/security/hardening/security_validator.py:9:1: UP035 `typing.Tuple` is deprecated, use `tuple` instead
   |
 8 | import re
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
10 | from dataclasses import dataclass, field
11 | from datetime import datetime, timezone
   |

src/infrastructure/security/hardening/security_validator.py:9:20: F401 [*] `typing.Dict` imported but unused
   |
 8 | import re
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
   |                    ^^^^ F401
10 | from dataclasses import dataclass, field
11 | from datetime import datetime, timezone
   |
   = help: Remove unused import

src/infrastructure/security/hardening/security_validator.py:9:26: F401 [*] `typing.List` imported but unused
   |
 8 | import re
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
   |                          ^^^^ F401
10 | from dataclasses import dataclass, field
11 | from datetime import datetime, timezone
   |
   = help: Remove unused import

src/infrastructure/security/hardening/security_validator.py:9:32: F401 [*] `typing.Optional` imported but unused
   |
 8 | import re
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
   |                                ^^^^^^^^ F401
10 | from dataclasses import dataclass, field
11 | from datetime import datetime, timezone
   |
   = help: Remove unused import

src/infrastructure/security/hardening/security_validator.py:9:42: F401 [*] `typing.Set` imported but unused
   |
 8 | import re
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
   |                                          ^^^ F401
10 | from dataclasses import dataclass, field
11 | from datetime import datetime, timezone
   |
   = help: Remove unused import

src/infrastructure/security/hardening/security_validator.py:9:47: F401 [*] `typing.Tuple` imported but unused
   |
 8 | import re
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
   |                                               ^^^^^ F401
10 | from dataclasses import dataclass, field
11 | from datetime import datetime, timezone
   |
   = help: Remove unused import

src/infrastructure/security/hardening/security_validator.py:9:54: F401 [*] `typing.Any` imported but unused
   |
 8 | import re
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
   |                                                      ^^^ F401
10 | from dataclasses import dataclass, field
11 | from datetime import datetime, timezone
   |
   = help: Remove unused import

src/infrastructure/security/hardening/security_validator.py:10:1: E402 Module level import not at top of file
   |
 8 | import re
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
10 | from dataclasses import dataclass, field
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
11 | from datetime import datetime, timezone
12 | from enum import Enum
   |

src/infrastructure/security/hardening/security_validator.py:10:25: F401 [*] `dataclasses.dataclass` imported but unused
   |
 8 | import re
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
10 | from dataclasses import dataclass, field
   |                         ^^^^^^^^^ F401
11 | from datetime import datetime, timezone
12 | from enum import Enum
   |
   = help: Remove unused import

src/infrastructure/security/hardening/security_validator.py:10:36: F401 [*] `dataclasses.field` imported but unused
   |
 8 | import re
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
10 | from dataclasses import dataclass, field
   |                                    ^^^^^ F401
11 | from datetime import datetime, timezone
12 | from enum import Enum
   |
   = help: Remove unused import

src/infrastructure/security/hardening/security_validator.py:11:1: E402 Module level import not at top of file
   |
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
10 | from dataclasses import dataclass, field
11 | from datetime import datetime, timezone
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
12 | from enum import Enum
13 | import hashlib
   |

src/infrastructure/security/hardening/security_validator.py:11:22: F401 [*] `datetime.datetime` imported but unused
   |
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
10 | from dataclasses import dataclass, field
11 | from datetime import datetime, timezone
   |                      ^^^^^^^^ F401
12 | from enum import Enum
13 | import hashlib
   |
   = help: Remove unused import

src/infrastructure/security/hardening/security_validator.py:11:32: F401 [*] `datetime.timezone` imported but unused
   |
 9 | from typing import Dict, List, Optional, Set, Tuple, Any
10 | from dataclasses import dataclass, field
11 | from datetime import datetime, timezone
   |                                ^^^^^^^^ F401
12 | from enum import Enum
13 | import hashlib
   |
   = help: Remove unused import

src/infrastructure/security/hardening/security_validator.py:12:1: E402 Module level import not at top of file
   |
10 | from dataclasses import dataclass, field
11 | from datetime import datetime, timezone
12 | from enum import Enum
   | ^^^^^^^^^^^^^^^^^^^^^ E402
13 | import hashlib
14 | import secrets
   |

src/infrastructure/security/hardening/security_validator.py:12:18: F401 [*] `enum.Enum` imported but unused
   |
10 | from dataclasses import dataclass, field
11 | from datetime import datetime, timezone
12 | from enum import Enum
   |                  ^^^^ F401
13 | import hashlib
14 | import secrets
   |
   = help: Remove unused import: `enum.Enum`

src/infrastructure/security/hardening/security_validator.py:13:1: E402 Module level import not at top of file
   |
11 | from datetime import datetime, timezone
12 | from enum import Enum
13 | import hashlib
   | ^^^^^^^^^^^^^^ E402
14 | import secrets
   |

src/infrastructure/security/hardening/security_validator.py:13:8: F401 [*] `hashlib` imported but unused
   |
11 | from datetime import datetime, timezone
12 | from enum import Enum
13 | import hashlib
   |        ^^^^^^^ F401
14 | import secrets
   |
   = help: Remove unused import: `hashlib`

src/infrastructure/security/hardening/security_validator.py:14:1: E402 Module level import not at top of file
   |
12 | from enum import Enum
13 | import hashlib
14 | import secrets
   | ^^^^^^^^^^^^^^ E402
15 |
16 | from src.infrastructure.logging_config import get_logger
   |

src/infrastructure/security/hardening/security_validator.py:14:8: F401 [*] `secrets` imported but unused
   |
12 | from enum import Enum
13 | import hashlib
14 | import secrets
   |        ^^^^^^^ F401
15 |
16 | from src.infrastructure.logging_config import get_logger
   |
   = help: Remove unused import: `secrets`

src/infrastructure/security/hardening/security_validator.py:16:1: E402 Module level import not at top of file
   |
14 | import secrets
15 |
16 | from src.infrastructure.logging_config import get_logger
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
17 |
18 | logger = get_logger(__name__, component="security-validator")
   |

src/infrastructure/security/hardening/validation/__init__.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Input Validation Module
2 | | Extracted from input_validation.py to reduce file size
3 | | """
  | |___^ D205
4 |   from .sanitizer import InputSanitizer
5 |   from .validation_config import (
  |
  = help: Insert single blank line

src/infrastructure/security/hardening/validation/__init__.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Input Validation Module
2 | | Extracted from input_validation.py to reduce file size
3 | | """
  | |___^ D415
4 |   from .sanitizer import InputSanitizer
5 |   from .validation_config import (
  |
  = help: Add closing punctuation

src/infrastructure/security/hardening/validation/sanitizer.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Input Sanitization Logic
2 | | Extracted from input_validation.py to reduce file size
3 | | """
  | |___^ D205
4 |
5 |   import re
  |
  = help: Insert single blank line

src/infrastructure/security/hardening/validation/sanitizer.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Input Sanitization Logic
2 | | Extracted from input_validation.py to reduce file size
3 | | """
  | |___^ D415
4 |
5 |   import re
  |
  = help: Add closing punctuation

src/infrastructure/security/hardening/validation/sanitizer.py:110:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
108 |                 compiled.append((pattern, rule))
109 |             except re.error as e:
110 |                 logger.error(f"Invalid regex pattern '{rule.pattern}': {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
111 |         return compiled
    |
    = help: Replace with `exception`

src/infrastructure/security/hardening/validation/sanitizer.py:113:9: PLR0912 Too many branches (15 > 12)
    |
111 |         return compiled
112 |
113 |     def sanitize_string(
    |         ^^^^^^^^^^^^^^^ PLR0912
114 |         self,
115 |         value: str,
    |

src/infrastructure/security/hardening/validation/sanitizer.py:119:9: D415 First line should end with a period, question mark, or exclamation point
    |
117 |           context: str = "general",
118 |       ) -> dict[str, Any]:
119 | /         """Sanitize string input with comprehensive validation
120 | |
121 | |         Args:
122 | |             value: String to sanitize
123 | |             is_child_input: Whether input comes from child user
124 | |             context: Context of the input (message, name, etc.)
125 | |
126 | |         Returns:
127 | |             Dict with sanitized value and validation results.
128 | |         """
    | |___________^ D415
129 |           result = {
130 |               "original": value,
    |
    = help: Add closing punctuation

src/infrastructure/security/hardening/validation/sanitizer.py:148:89: E501 Line too long (95 > 88)
    |
146 |                         "type": "length_exceeded",
147 |                         "severity": "medium",
148 |                         "message": f"Input length ({len(value)}) exceeds limit ({max_length})",
    |                                                                                         ^^^^^^^ E501
149 |                     },
150 |                 )
    |

src/infrastructure/security/hardening/validation/sanitizer.py:155:13: SIM102 Use a single `if` statement instead of nested `if` statements
    |
154 |               # Check child-safe characters
155 | /             if is_child_input:
156 | |                 if not re.match(self.config.child_safe_pattern, value):
    | |_______________________________________________________________________^ SIM102
157 |                       result["violations"].append(
158 |                           {
    |
    = help: Combine `if` statements using `and`

src/infrastructure/security/hardening/validation/sanitizer.py:161:89: E501 Line too long (93 > 88)
    |
159 |                             "type": "unsafe_characters",
160 |                             "severity": "high",
161 |                             "message": "Input contains characters not suitable for children",
    |                                                                                         ^^^^^ E501
162 |                         },
163 |                     )
    |

src/infrastructure/security/hardening/validation/sanitizer.py:226:13: TRY300 Consider moving this statement to an `else` block
    |
224 |                     f"{[v['type'] for v in result['violations']]}",
225 |                 )
226 |             return result
    |             ^^^^^^^^^^^^^ TRY300
227 |         except Exception as e:
228 |             logger.error(f"Error sanitizing string input: {e}")
    |

src/infrastructure/security/hardening/validation/sanitizer.py:228:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
226 |             return result
227 |         except Exception as e:
228 |             logger.error(f"Error sanitizing string input: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
229 |             return {
230 |                 "original": value,
    |
    = help: Replace with `exception`

src/infrastructure/security/hardening/validation/sanitizer.py:259:13: TRY300 Consider moving this statement to an `else` block
    |
257 |                 result,
258 |             )
259 |             return result
    |             ^^^^^^^^^^^^^ TRY300
260 |         except Exception as e:
261 |             logger.error(f"Error sanitizing JSON: {e}")
    |

src/infrastructure/security/hardening/validation/sanitizer.py:261:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
259 |             return result
260 |         except Exception as e:
261 |             logger.error(f"Error sanitizing JSON: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
262 |             result["is_safe"] = False
263 |             result["violations"].append(
    |
    = help: Replace with `exception`

src/infrastructure/security/hardening/validation/sanitizer.py:286:89: E501 Line too long (104 > 88)
    |
284 |                     "type": "depth_exceeded",
285 |                     "severity": "high",
286 |                     "message": f"Object depth ({depth}) exceeds limit ({self.config.max_object_depth})",
    |                                                                                         ^^^^^^^^^^^^^^^^ E501
287 |                 },
288 |             )
    |

src/infrastructure/security/hardening/validation/sanitizer.py:360:12: PLW0603 Using the global statement to update `_sanitizer_instance` is discouraged
    |
358 | def get_input_sanitizer(config: InputValidationConfig = None) -> InputSanitizer:
359 |     """Get global input sanitizer instance."""
360 |     global _sanitizer_instance
    |            ^^^^^^^^^^^^^^^^^^^ PLW0603
361 |     if _sanitizer_instance is None:
362 |         _sanitizer_instance = InputSanitizer(config or InputValidationConfig())
    |

src/infrastructure/security/hardening/validation/validation_config.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Validation Configuration and Data Models
2 | | Extracted from input_validation.py to reduce file size
3 | | """
  | |___^ D205
4 |
5 |   from dataclasses import dataclass, field
  |
  = help: Insert single blank line

src/infrastructure/security/hardening/validation/validation_config.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Validation Configuration and Data Models
2 | | Extracted from input_validation.py to reduce file size
3 | | """
  | |___^ D415
4 |
5 |   from dataclasses import dataclass, field
  |
  = help: Add closing punctuation

src/infrastructure/security/hardening/validation/validation_config.py:5:1: I001 [*] Import block is un-sorted or un-formatted
  |
3 |   """
4 |
5 | / from dataclasses import dataclass, field
6 | | from enum import Enum
7 | | from .validation_rules import get_default_validation_rules
  | |__________________________________________________________^ I001
  |
  = help: Organize imports

src/infrastructure/security/hardening/validation/validation_config.py:5:36: F401 [*] `dataclasses.field` imported but unused
  |
3 | """
4 |
5 | from dataclasses import dataclass, field
  |                                    ^^^^^ F401
6 | from enum import Enum
7 | from .validation_rules import get_default_validation_rules
  |
  = help: Remove unused import: `dataclasses.field`

src/infrastructure/security/hardening/validation/validation_config.py:39:1: W293 [*] Blank line contains whitespace
   |
37 |     max_array_length: int = 100
38 |     child_max_array_length: int = 50
39 |     
   | ^^^^ W293
40 |     def __post_init__(self):
41 |         """Initialize default patterns if none provided."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/hardening/validation/validation_rules.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Validation Rules and Patterns
2 | | Extracted from input_validation.py to reduce file size
3 | | """
  | |___^ D205
4 |
5 |   from .validation_config import ValidationRule, ValidationSeverity
  |
  = help: Insert single blank line

src/infrastructure/security/hardening/validation/validation_rules.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Validation Rules and Patterns
2 | | Extracted from input_validation.py to reduce file size
3 | | """
  | |___^ D415
4 |
5 |   from .validation_config import ValidationRule, ValidationSeverity
  |
  = help: Add closing punctuation

src/infrastructure/security/hardening/validation/validation_rules.py:73:5: D205 1 blank line required between summary line and description
   |
72 |   def get_profanity_words() -> set[str]:
73 | /     """Get profanity words list (placeholder)
74 | |     In production, load from external file or service.
75 | |     """
   | |_______^ D205
76 |       return {
77 |           "badword1",
   |
   = help: Insert single blank line

src/infrastructure/security/input_validation/__init__.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Modular input validation system for AI Teddy Bear backend.
2 | | This package provides comprehensive input validation with:
3 | |  - Security threat detection (SQL injection, XSS, path traversal, etc.)
4 | |  - Child safety content filtering
5 | |  - PII detection and protection
6 | |  - FastAPI middleware integration
7 | | """
  | |___^ D205
8 |
9 |   from .core import InputValidationResult, SecurityThreat
  |
  = help: Insert single blank line

src/infrastructure/security/input_validation/__init__.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Modular input validation system for AI Teddy Bear backend.
2 | | This package provides comprehensive input validation with:
3 | |  - Security threat detection (SQL injection, XSS, path traversal, etc.)
4 | |  - Child safety content filtering
5 | |  - PII detection and protection
6 | |  - FastAPI middleware integration
7 | | """
  | |___^ D415
8 |
9 |   from .core import InputValidationResult, SecurityThreat
  |
  = help: Add closing punctuation

src/infrastructure/security/input_validation/detectors.py:95:17: PERF401 Use `list.extend` to create a transformed list
    |
 93 |               matches = pattern.findall(text)
 94 |               for match in matches:
 95 | /                 threats.append(
 96 | |                     SecurityThreat(
 97 | |                         "sql_injection",
 98 | |                         "critical",
 99 | |                         field,
100 | |                         str(match),
101 | |                         "Potential SQL injection detected",
102 | |                     ),
103 | |                 )
    | |_________________^ PERF401
104 |           return threats
    |
    = help: Replace for loop with list.extend

src/infrastructure/security/input_validation/detectors.py:112:17: PERF401 Use `list.extend` to create a transformed list
    |
110 |               matches = pattern.findall(text)
111 |               for match in matches:
112 | /                 threats.append(
113 | |                     SecurityThreat(
114 | |                         "xss_attack",
115 | |                         "critical",
116 | |                         field,
117 | |                         str(match),
118 | |                         "Potential XSS attack detected",
119 | |                     ),
120 | |                 )
    | |_________________^ PERF401
121 |           return threats
    |
    = help: Replace for loop with list.extend

src/infrastructure/security/input_validation/detectors.py:133:17: PERF401 Use `list.extend` to create a transformed list
    |
131 |               matches = pattern.findall(text)
132 |               for match in matches:
133 | /                 threats.append(
134 | |                     SecurityThreat(
135 | |                         "path_traversal",
136 | |                         "high",
137 | |                         field,
138 | |                         str(match),
139 | |                         "Potential path traversal detected",
140 | |                     ),
141 | |                 )
    | |_________________^ PERF401
142 |           return threats
    |
    = help: Replace for loop with list.extend

src/infrastructure/security/input_validation/detectors.py:154:17: PERF401 Use `list.extend` to create a transformed list
    |
152 |               matches = pattern.findall(text)
153 |               for match in matches:
154 | /                 threats.append(
155 | |                     SecurityThreat(
156 | |                         "command_injection",
157 | |                         "critical",
158 | |                         field,
159 | |                         str(match),
160 | |                         "Potential command injection detected",
161 | |                     ),
162 | |                 )
    | |_________________^ PERF401
163 |           return threats
    |
    = help: Replace for loop with list.extend

src/infrastructure/security/input_validation/detectors.py:180:21: PERF401 Use `list.extend` to create a transformed list
    |
178 |                   matches = pattern.findall(text)
179 |                   for match in matches:
180 | /                     threats.append(
181 | |                         SecurityThreat(
182 | |                             "ldap_injection",
183 | |                             "high",
184 | |                             field,
185 | |                             str(match),
186 | |                             "Potential LDAP injection detected",
187 | |                         ),
188 | |                     )
    | |_____________________^ PERF401
189 |           return threats
    |
    = help: Replace for loop with list.extend

src/infrastructure/security/input_validation/detectors.py:201:17: PERF401 Use `list.extend` to create a transformed list
    |
199 |               matches = pattern.findall(text)
200 |               for match in matches:
201 | /                 threats.append(
202 | |                     SecurityThreat(
203 | |                         "template_injection",
204 | |                         "high",
205 | |                         field,
206 | |                         str(match),
207 | |                         "Potential template injection detected",
208 | |                     ),
209 | |                 )
    | |_________________^ PERF401
210 |           return threats
    |
    = help: Replace for loop with list.extend

src/infrastructure/security/input_validation/detectors.py:218:17: PERF401 Use `list.extend` to create a transformed list
    |
216 |             matches = pattern.findall(text)
217 |             for match in matches:
218 |                 violations.append(f"Inappropriate content detected in {field}: {match}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PERF401
219 |         return violations
    |
    = help: Replace for loop with list.extend

src/infrastructure/security/input_validation/detectors.py:227:17: PERF401 Use `list.extend` to create a transformed list
    |
225 |             matches = pattern.findall(text)
226 |             for match in matches:
227 |                 violations.append(f"PII detected in {field}: {type(match).__name__}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PERF401
228 |         return violations
    |
    = help: Replace for loop with list.extend

src/infrastructure/security/input_validation/detectors.py:242:28: PLR2004 Magic value used in comparison, consider replacing `0x1000` with a constant variable
    |
240 |         for match in suspicious_unicode:
241 |             char = match.group()
242 |             if ord(char) > 0x1000:  # High unicode ranges often used in attacks
    |                            ^^^^^^ PLR2004
243 |                 threats.append(
244 |                     SecurityThreat(
    |

src/infrastructure/security/input_validation/detectors.py:274:12: PLW0603 Using the global statement to update `_threat_detector` is discouraged
    |
272 | def get_threat_detector() -> ThreatDetectors:
273 |     """Get global threat detector instance."""
274 |     global _threat_detector
    |            ^^^^^^^^^^^^^^^^ PLW0603
275 |     if _threat_detector is None:
276 |         _threat_detector = ThreatDetectors()
    |

src/infrastructure/security/input_validation/middleware.py:21:40: ARG002 Unused method argument: `value`
   |
19 |     # Fallback implementation
20 |     class MockValidator:
21 |         async def validate_input(self, value, field, context):
   |                                        ^^^^^ ARG002
22 |             from .core import InputValidationResult
   |

src/infrastructure/security/input_validation/middleware.py:21:47: ARG002 Unused method argument: `field`
   |
19 |     # Fallback implementation
20 |     class MockValidator:
21 |         async def validate_input(self, value, field, context):
   |                                               ^^^^^ ARG002
22 |             from .core import InputValidationResult
   |

src/infrastructure/security/input_validation/middleware.py:21:54: ARG002 Unused method argument: `context`
   |
19 |     # Fallback implementation
20 |     class MockValidator:
21 |         async def validate_input(self, value, field, context):
   |                                                      ^^^^^^^ ARG002
22 |             from .core import InputValidationResult
   |

src/infrastructure/security/input_validation/middleware.py:22:13: PLC0415 `import` should be at the top-level of a file
   |
20 |     class MockValidator:
21 |         async def validate_input(self, value, field, context):
22 |             from .core import InputValidationResult
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
23 |
24 |             return InputValidationResult(is_valid=True)
   |

src/infrastructure/security/input_validation/middleware.py:45:89: E501 Line too long (93 > 88)
   |
44 | class InputValidationMiddleware(BaseHTTPMiddleware):
45 |     """Middleware that automatically validates all incoming requests for security threats."""
   |                                                                                         ^^^^^ E501
46 |
47 |     def __init__(
   |

src/infrastructure/security/input_validation/middleware.py:68:15: PLR0912 Too many branches (15 > 12)
   |
66 |         self.skip_validation = ["/health", "/docs", "/openapi.json", "/static"]
67 |
68 |     async def dispatch(self, request: Request, call_next) -> Response:
   |               ^^^^^^^^ PLR0912
69 |         """Validate incoming request data."""
70 |         # Skip validation for certain endpoints
   |

src/infrastructure/security/input_validation/middleware.py:177:13: TRY300 Consider moving this statement to an `else` block
    |
175 |                 response.headers["X-Security-Warnings"] = str(len(all_threats))
176 |
177 |             return response
    |             ^^^^^^^^^^^^^^^ TRY300
178 |
179 |         except Exception as e:
    |

src/infrastructure/security/input_validation/middleware.py:180:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
179 |         except Exception as e:
180 |             logger.error(f"Input validation middleware error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
181 |             # On error, allow request but log the issue
182 |             response = await call_next(request)
    |
    = help: Replace with `exception`

src/infrastructure/security/input_validation/middleware.py:219:13: TRY300 Consider moving this statement to an `else` block
    |
217 |                     if not hasattr(value, "read")
218 |                 }
219 |             return None
    |             ^^^^^^^^^^^ TRY300
220 |         except Exception as e:
221 |             logger.warning(f"Could not parse request body: {e}")
    |

src/infrastructure/security/input_validation/middleware.py:260:39: PLR2004 Magic value used in comparison, consider replacing `3` with a constant variable
    |
258 |         # Block multiple medium threats (possible coordinated attack)
259 |         medium_threats = [t for t in threats if t.severity == "medium"]
260 |         return len(medium_threats) >= 3
    |                                       ^ PLR2004
261 |
262 |     async def _log_security_incident(
    |

src/infrastructure/security/input_validation/middleware.py:280:89: E501 Line too long (94 > 88)
    |
278 |             event_type="input_validation_blocked",
279 |             severity="critical",
280 |             description=f"Request blocked due to input validation failures: {threat_summary}",
    |                                                                                         ^^^^^^ E501
281 |             ip_address=self._get_client_ip(request),
282 |             details={
    |

src/infrastructure/security/input_validation/patterns.py:127:9: SIM110 Use `return all(not pattern.search(text) for pattern in self.inappropriate_patterns)` instead of `for` loop
    |
125 |       def is_safe_for_children(self, text: str) -> bool:
126 |           """Quick check if text is safe for children."""
127 | /         for pattern in self.inappropriate_patterns:
128 | |             if pattern.search(text):
129 | |                 return False
130 | |         return True
    | |___________________^ SIM110
131 |
132 |       def contains_pii(self, text: str) -> bool:
    |
    = help: Replace with `return all(not pattern.search(text) for pattern in self.inappropriate_patterns)`

src/infrastructure/security/input_validation/patterns.py:134:9: SIM110 Use `return any(pattern.search(text) for pattern in self.pii_patterns)` instead of `for` loop
    |
132 |       def contains_pii(self, text: str) -> bool:
133 |           """Quick check if text contains PII."""
134 | /         for pattern in self.pii_patterns:
135 | |             if pattern.search(text):
136 | |                 return True
137 | |         return False
    | |____________________^ SIM110
    |
    = help: Replace with `return any(pattern.search(text) for pattern in self.pii_patterns)`

src/infrastructure/security/input_validation/patterns.py:146:12: PLW0603 Using the global statement to update `_security_patterns` is discouraged
    |
144 | def get_security_patterns() -> SecurityPatterns:
145 |     """Get global security patterns instance."""
146 |     global _security_patterns
    |            ^^^^^^^^^^^^^^^^^^ PLW0603
147 |     if _security_patterns is None:
148 |         _security_patterns = SecurityPatterns()
    |

src/infrastructure/security/input_validation/validator.py:24:46: ARG002 Unused method argument: `text`
   |
22 |             super().__init__()
23 |
24 |         async def detect_sql_injection(self, text, field):
   |                                              ^^^^ ARG002
25 |             return []
   |

src/infrastructure/security/input_validation/validator.py:24:52: ARG002 Unused method argument: `field`
   |
22 |             super().__init__()
23 |
24 |         async def detect_sql_injection(self, text, field):
   |                                                    ^^^^^ ARG002
25 |             return []
   |

src/infrastructure/security/input_validation/validator.py:27:36: ARG002 Unused method argument: `text`
   |
25 |             return []
26 |
27 |         async def detect_xss(self, text, field):
   |                                    ^^^^ ARG002
28 |             return []
   |

src/infrastructure/security/input_validation/validator.py:27:42: ARG002 Unused method argument: `field`
   |
25 |             return []
26 |
27 |         async def detect_xss(self, text, field):
   |                                          ^^^^^ ARG002
28 |             return []
   |

src/infrastructure/security/input_validation/validator.py:30:47: ARG002 Unused method argument: `text`
   |
28 |             return []
29 |
30 |         async def detect_path_traversal(self, text, field):
   |                                               ^^^^ ARG002
31 |             return []
   |

src/infrastructure/security/input_validation/validator.py:30:53: ARG002 Unused method argument: `field`
   |
28 |             return []
29 |
30 |         async def detect_path_traversal(self, text, field):
   |                                                     ^^^^^ ARG002
31 |             return []
   |

src/infrastructure/security/input_validation/validator.py:33:50: ARG002 Unused method argument: `text`
   |
31 |             return []
32 |
33 |         async def detect_command_injection(self, text, field):
   |                                                  ^^^^ ARG002
34 |             return []
   |

src/infrastructure/security/input_validation/validator.py:33:56: ARG002 Unused method argument: `field`
   |
31 |             return []
32 |
33 |         async def detect_command_injection(self, text, field):
   |                                                        ^^^^^ ARG002
34 |             return []
   |

src/infrastructure/security/input_validation/validator.py:36:47: ARG002 Unused method argument: `text`
   |
34 |             return []
35 |
36 |         async def detect_ldap_injection(self, text, field):
   |                                               ^^^^ ARG002
37 |             return []
   |

src/infrastructure/security/input_validation/validator.py:36:53: ARG002 Unused method argument: `field`
   |
34 |             return []
35 |
36 |         async def detect_ldap_injection(self, text, field):
   |                                                     ^^^^^ ARG002
37 |             return []
   |

src/infrastructure/security/input_validation/validator.py:39:51: ARG002 Unused method argument: `text`
   |
37 |             return []
38 |
39 |         async def detect_template_injection(self, text, field):
   |                                                   ^^^^ ARG002
40 |             return []
   |

src/infrastructure/security/input_validation/validator.py:39:57: ARG002 Unused method argument: `field`
   |
37 |             return []
38 |
39 |         async def detect_template_injection(self, text, field):
   |                                                         ^^^^^ ARG002
40 |             return []
   |

src/infrastructure/security/input_validation/validator.py:42:54: ARG002 Unused method argument: `text`
   |
40 |             return []
41 |
42 |         async def detect_inappropriate_content(self, text, field):
   |                                                      ^^^^ ARG002
43 |             return []
   |

src/infrastructure/security/input_validation/validator.py:42:60: ARG002 Unused method argument: `field`
   |
40 |             return []
41 |
42 |         async def detect_inappropriate_content(self, text, field):
   |                                                            ^^^^^ ARG002
43 |             return []
   |

src/infrastructure/security/input_validation/validator.py:45:36: ARG002 Unused method argument: `text`
   |
43 |             return []
44 |
45 |         async def detect_pii(self, text, field):
   |                                    ^^^^ ARG002
46 |             return []
   |

src/infrastructure/security/input_validation/validator.py:45:42: ARG002 Unused method argument: `field`
   |
43 |             return []
44 |
45 |         async def detect_pii(self, text, field):
   |                                          ^^^^^ ARG002
46 |             return []
   |

src/infrastructure/security/input_validation/validator.py:48:49: ARG002 Unused method argument: `text`
   |
46 |             return []
47 |
48 |         async def detect_encoding_attacks(self, text, field):
   |                                                 ^^^^ ARG002
49 |             return []
   |

src/infrastructure/security/input_validation/validator.py:48:55: ARG002 Unused method argument: `field`
   |
46 |             return []
47 |
48 |         async def detect_encoding_attacks(self, text, field):
   |                                                       ^^^^^ ARG002
49 |             return []
   |

src/infrastructure/security/input_validation/validator.py:109:18: UP038 Use `X | Y` in `isinstance` call instead of `(X, Y)`
    |
107 |             if isinstance(data, dict):
108 |                 text_data = json.dumps(data)
109 |             elif isinstance(data, (list, int, float, bool)):
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP038
110 |                 text_data = str(data)
111 |             elif data is None:
    |
    = help: Convert to `X | Y`

src/infrastructure/security/input_validation/validator.py:131:33: PLR2004 Magic value used in comparison, consider replacing `100000` with a constant variable
    |
130 |             # Validate input size
131 |             if len(text_data) > 100000:  # 100KB limit
    |                                 ^^^^^^ PLR2004
132 |                 threats.append(
133 |                     SecurityThreat(
    |

src/infrastructure/security/input_validation/validator.py:175:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
173 |             )
174 |         except Exception as e:
175 |             logger.error(f"Input validation error for {field_name}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
176 |             errors.append(f"Validation failed: {e!s}")
177 |             return InputValidationResult(
    |
    = help: Replace with `exception`

src/infrastructure/security/input_validation/validator.py:191:9: SIM102 Use a single `if` statement instead of nested `if` statements
    |
190 |           # Child endpoint validation
191 | /         if context.get("is_child_endpoint", False):
192 | |             # More strict validation for child endpoints
193 | |             if len(text_data) > 1000:  # Smaller limit for children
    | |_____________________________________^ SIM102
194 |                   threats.append(
195 |                       SecurityThreat(
    |
    = help: Combine `if` statements using `and`

src/infrastructure/security/input_validation/validator.py:193:33: PLR2004 Magic value used in comparison, consider replacing `1000` with a constant variable
    |
191 |         if context.get("is_child_endpoint", False):
192 |             # More strict validation for child endpoints
193 |             if len(text_data) > 1000:  # Smaller limit for children
    |                                 ^^^^ PLR2004
194 |                 threats.append(
195 |                     SecurityThreat(
    |

src/infrastructure/security/input_validation/validator.py:210:21: PERF401 Use `list.extend` to create a transformed list
    |
208 |               for pattern in auth_bypass_patterns:
209 |                   if pattern in text_data.lower():
210 | /                     threats.append(
211 | |                         SecurityThreat(
212 | |                             "auth_bypass_attempt",
213 | |                             "high",
214 | |                             field_name,
215 | |                             pattern,
216 | |                             f"Potential auth bypass attempt: {pattern}",
217 | |                         )
218 | |                     )
    | |_____________________^ PERF401
219 |
220 |           return threats
    |
    = help: Replace for loop with list.extend

src/infrastructure/security/input_validation/validator.py:227:9: ARG002 Unused method argument: `context`
    |
225 |         threats: list[SecurityThreat],
226 |         child_safety_violations: list[str],
227 |         context: dict[str, Any] | None,
    |         ^^^^^^^ ARG002
228 |     ) -> None:
229 |         """Log validation results for audit purposes."""
    |

src/infrastructure/security/input_validation/validator.py:258:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
256 |                 )
257 |         except Exception as e:
258 |             logger.error(f"Failed to log validation results: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
259 |
260 |     async def validate_file_upload(
    |
    = help: Replace with `exception`

src/infrastructure/security/input_validation/validator.py:355:12: PLW0603 Using the global statement to update `_global_validator` is discouraged
    |
353 | def get_input_validator() -> ComprehensiveInputValidator:
354 |     """Get global input validator instance."""
355 |     global _global_validator
    |            ^^^^^^^^^^^^^^^^^ PLW0603
356 |     if _global_validator is None:
357 |         _global_validator = ComprehensiveInputValidator()
    |

src/infrastructure/security/jwt_auth.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """JWT Authentication module for FastAPI users"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | from collections.abc import AsyncGenerator
  |
  = help: Add closing punctuation

src/infrastructure/security/jwt_auth.py:48:9: D415 First line should end with a period, question mark, or exclamation point
   |
47 |     def get_settings():
48 |         """Mock settings function"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
49 |
50 |         class MockSettings:
   |
   = help: Add closing punctuation

src/infrastructure/security/jwt_auth.py:52:34: S105 Possible hardcoded password assigned to: "JWT_SECRET_KEY"
   |
50 |         class MockSettings:
51 |             class Security:
52 |                 JWT_SECRET_KEY = "your-secret-key-here"
   |                                  ^^^^^^^^^^^^^^^^^^^^^^ S105
53 |
54 |             security = Security()
   |

src/infrastructure/security/jwt_auth.py:71:9: D415 First line should end with a period, question mark, or exclamation point
   |
70 |     async def get_vault_client():
71 |         """Mock vault client function"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
72 |         return
   |
   = help: Add closing punctuation

src/infrastructure/security/jwt_auth.py:76:5: D415 First line should end with a period, question mark, or exclamation point
   |
75 | class User(SQLAlchemyBaseUserTableUUID, Base):
76 |     """User model extending FastAPI Users base table"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
77 |
78 |     __tablename__ = "users"
   |
   = help: Add closing punctuation

src/infrastructure/security/jwt_auth.py:82:5: ERA001 Found commented-out code
   |
80 |     # Additional fields for your user model, if any
81 |     # For example:
82 |     # first_name: Mapped[str] = mapped_column(String(255), nullable=True)
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ ERA001
83 |     # last_name: Mapped[str] = mapped_column(String(255), nullable=True)
   |
   = help: Remove commented-out code

src/infrastructure/security/jwt_auth.py:83:5: ERA001 Found commented-out code
   |
81 |     # For example:
82 |     # first_name: Mapped[str] = mapped_column(String(255), nullable=True)
83 |     # last_name: Mapped[str] = mapped_column(String(255), nullable=True)
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ ERA001
   |
   = help: Remove commented-out code

src/infrastructure/security/jwt_auth.py:89:5: D415 First line should end with a period, question mark, or exclamation point
   |
87 |     session: AsyncSession,
88 | ) -> AsyncGenerator[SQLAlchemyUserDatabase, None]:
89 |     """Get user database instance"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
90 |     if not FASTAPI_USERS_AVAILABLE:
91 |         raise ImportError("fastapi-users is required but not installed")
   |
   = help: Add closing punctuation

src/infrastructure/security/jwt_auth.py:91:15: TRY003 Avoid specifying long messages outside the exception class
   |
89 |     """Get user database instance"""
90 |     if not FASTAPI_USERS_AVAILABLE:
91 |         raise ImportError("fastapi-users is required but not installed")
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
92 |
93 |     yield SQLAlchemyUserDatabase(session, User)
   |

src/infrastructure/security/jwt_auth.py:97:5: D415 First line should end with a period, question mark, or exclamation point
   |
96 | async def get_jwt_strategy() -> JWTStrategy:
97 |     """Get JWT strategy with secure configuration"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
98 |     if not FASTAPI_USERS_AVAILABLE:
99 |         raise ImportError("fastapi-users is required but not installed")
   |
   = help: Add closing punctuation

src/infrastructure/security/jwt_auth.py:99:15: TRY003 Avoid specifying long messages outside the exception class
    |
 97 |     """Get JWT strategy with secure configuration"""
 98 |     if not FASTAPI_USERS_AVAILABLE:
 99 |         raise ImportError("fastapi-users is required but not installed")
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
100 |
101 |     settings = get_settings()
    |

src/infrastructure/security/jwt_auth.py:110:9: S110 `try`-`except`-`pass` detected, consider logging the exception
    |
108 |               secrets = await vault_client.get_secret("jwt-secrets")
109 |               jwt_secret = secrets.get("JWT_SECRET")
110 | /         except Exception:
111 | |             # Fallback to settings if vault fails
112 | |             pass
    | |________________^ S110
113 |
114 |       # Fallback to settings
    |

src/infrastructure/security/jwt_auth.py:123:15: TRY003 Avoid specifying long messages outside the exception class
    |
121 |       # Validate JWT secret
122 |       if not jwt_secret or jwt_secret.strip() == "":
123 |           raise ValueError(
    |  _______________^
124 | |             "JWT secret is empty or not configured. "
125 | |             "Set JWT_SECRET environment variable with a secure key."
126 | |         )
    | |_________^ TRY003
127 |
128 |       if len(jwt_secret) < 32:
    |

src/infrastructure/security/jwt_auth.py:128:26: PLR2004 Magic value used in comparison, consider replacing `32` with a constant variable
    |
126 |         )
127 |
128 |     if len(jwt_secret) < 32:
    |                          ^^ PLR2004
129 |         raise ValueError(
130 |             "JWT secret is too short. " "Must be at least 32 characters for security."
    |

src/infrastructure/security/jwt_auth.py:129:15: TRY003 Avoid specifying long messages outside the exception class
    |
128 |       if len(jwt_secret) < 32:
129 |           raise ValueError(
    |  _______________^
130 | |             "JWT secret is too short. " "Must be at least 32 characters for security."
131 | |         )
    | |_________^ TRY003
132 |
133 |       # Check for insecure secrets
    |

src/infrastructure/security/jwt_auth.py:145:15: TRY003 Avoid specifying long messages outside the exception class
    |
143 |       }
144 |       if jwt_secret.lower() in insecure_secrets:
145 |           raise ValueError(
    |  _______________^
146 | |             "JWT secret uses a common/insecure value. "
147 | |             "Use a cryptographically secure random key."
148 | |         )
    | |_________^ TRY003
149 |
150 |       return JWTStrategy(secret=jwt_secret, lifetime_seconds=3600)
    |

src/infrastructure/security/jwt_auth.py:154:5: D415 First line should end with a period, question mark, or exclamation point
    |
153 | def create_auth_components():
154 |     """Create authentication components"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
155 |     if not FASTAPI_USERS_AVAILABLE:
156 |         raise ImportError("fastapi-users is required but not installed")
    |
    = help: Add closing punctuation

src/infrastructure/security/jwt_auth.py:156:15: TRY003 Avoid specifying long messages outside the exception class
    |
154 |     """Create authentication components"""
155 |     if not FASTAPI_USERS_AVAILABLE:
156 |         raise ImportError("fastapi-users is required but not installed")
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
157 |
158 |     bearer_transport = BearerTransport(tokenUrl="auth/jwt/login")
    |

src/infrastructure/security/key_management/__init__.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Key Management Module
2 | | Provides modular key management services following Single Responsibility Principle.
3 | | """
  | |___^ D205
4 |
5 |   from src.infrastructure.security.key_management.key_generator import (
  |
  = help: Insert single blank line

src/infrastructure/security/key_management/key_generator.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Key Generation Service
2 | | Responsible solely for cryptographic key generation with child safety enhancements.
3 | | """
  | |___^ D205
4 |
5 |   import secrets
  |
  = help: Insert single blank line

src/infrastructure/security/key_management/key_generator.py:51:19: TRY003 Avoid specifying long messages outside the exception class
   |
49 |         key_size = self.algorithm_key_sizes.get(algorithm)
50 |         if not key_size:
51 |             raise ValueError(f"Unsupported algorithm: {algorithm}")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
52 |
53 |         key_data = secrets.token_bytes(key_size)
   |

src/infrastructure/security/key_management/key_lifecycle_manager.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Key Lifecycle Manager
2 | | Manages the creation, expiration, and deletion of cryptographic keys.
3 | | """
  | |___^ D205
4 |
5 |   from datetime import datetime, timedelta
  |
  = help: Insert single blank line

src/infrastructure/security/key_management/key_lifecycle_manager.py:87:13: TRY300 Consider moving this statement to an `else` block
   |
85 |                 return key_id
86 |             logger.error(f"Failed to store key {key_id}")
87 |             return None
   |             ^^^^^^^^^^^ TRY300
88 |         except Exception as e:
89 |             logger.error(f"Failed to create key: {e}")
   |

src/infrastructure/security/key_management/key_lifecycle_manager.py:89:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
87 |             return None
88 |         except Exception as e:
89 |             logger.error(f"Failed to create key: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
90 |             return None
   |
   = help: Replace with `exception`

src/infrastructure/security/key_management/key_lifecycle_manager.py:111:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
109 |             return self.storage.store_key(key_id, key_bytes, metadata)
110 |         except Exception as e:
111 |             logger.error(f"Failed to deactivate key {key_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
112 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/key_management/key_lifecycle_manager.py:127:13: SIM102 Use a single `if` statement instead of nested `if` statements
    |
126 |           for key_metadata in self.storage.list_keys():
127 | /             if not key_metadata.is_active and key_metadata.created_at < cutoff_time:
128 | |                 if self.storage.delete_key(key_metadata.key_id):
    | |________________________________________________________________^ SIM102
129 |                       cleaned_count += 1
130 |                       logger.info(f"Cleaned up old key: {key_metadata.key_id}")
    |
    = help: Combine `if` statements using `and`

src/infrastructure/security/key_management/key_rotation_orchestrator.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Key Rotation Orchestrator
2 | | Coordinates key rotation operations using specialized services.
3 | | """
  | |___^ D205
4 |
5 |   from typing import Any
  |
  = help: Insert single blank line

src/infrastructure/security/key_management/key_rotation_orchestrator.py:35:5: D205 1 blank line required between summary line and description
   |
34 |   class KeyRotationOrchestrator:
35 | /     """Orchestrates key rotation operations using specialized services.
36 | |     This is the main entry point for key rotation functionality,
37 | |     delegating specific responsibilities to focused services.
38 | |     """
   | |_______^ D205
39 |
40 |       def __init__(self, storage: KeyStorageInterface | None = None) -> None:
   |
   = help: Insert single blank line

src/infrastructure/security/key_management/key_rotation_orchestrator.py:146:9: PLC0415 `import` should be at the top-level of a file
    |
145 |         """
146 |         from datetime import timedelta
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
147 |
148 |         return self.lifecycle_manager.cleanup_old_keys(timedelta(days=days))
    |

src/infrastructure/security/key_management/rotation_executor.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Rotation Executor
2 | | Executes key rotation operations with proper orchestration and error handling.
3 | | """
  | |___^ D205
4 |
5 |   import threading
  |
  = help: Insert single blank line

src/infrastructure/security/key_management/rotation_executor.py:126:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
124 |                 )
125 |             except Exception as e:
126 |                 logger.error(f"Key rotation failed for {key_id}: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
127 |                 return RotationResult(
128 |                     success=False,
    |
    = help: Replace with `exception`

src/infrastructure/security/key_management/rotation_policy_manager.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Rotation Policy Manager
2 | | Manages key rotation policies and determines when keys need rotation.
3 | | """
  | |___^ D205
4 |
5 |   from datetime import datetime, timedelta
  |
  = help: Insert single blank line

src/infrastructure/security/key_management/rotation_policy_manager.py:69:17: PERF401 Use a list comprehension to create a transformed list
   |
67 |         for key_metadata in self.storage.list_keys():
68 |             if self.check_rotation_needed(key_metadata):
69 |                 needs_rotation.append(key_metadata)
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PERF401
70 |         return needs_rotation
   |
   = help: Replace for loop with list comprehension

src/infrastructure/security/key_management/rotation_statistics.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Rotation Statistics Service
2 | | Provides key rotation statistics and reporting.
3 | | """
  | |___^ D205
4 |
5 |   from datetime import datetime
  |
  = help: Insert single blank line

src/infrastructure/security/key_management/rotation_statistics.py:122:36: ARG002 Unused method argument: `days`
    |
120 |         return usage_report
121 |
122 |     def get_rotation_history(self, days: int = 30) -> list[dict[str, Any]]:
    |                                    ^^^^ ARG002
123 |         """Get rotation history for the past N days.
    |

src/infrastructure/security/key_rotation_service.py:108:28: ARG002 Unused method argument: `key_type`
    |
106 |         self.rotation_lock = threading.Lock()
107 |
108 |     def generate_key(self, key_type: KeyType, key_size: int = 256) -> tuple[str, str]:
    |                            ^^^^^^^^ ARG002
109 |         """Generate a new key and key ID."""
110 |         key = secrets.token_bytes(key_size // 8)
    |

src/infrastructure/security/log_sanitizer.py:43:5: D205 1 blank line required between summary line and description
   |
42 |   class LogSanitizer:
43 | /     """COPPA-compliant log sanitizer for child safety applications.
44 | |     Automatically detects and sanitizes sensitive data in log messages
45 | |     before they are written to log files, ensuring compliance with privacy regulations.
46 | |     """
   | |_______^ D205
47 |
48 |       def __init__(self) -> None:
   |
   = help: Insert single blank line

src/infrastructure/security/logging_security_monitor.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Logging Security Monitor
2 | |
3 | | This module monitors and enforces secure logging practices
4 | | throughout the AI Teddy Bear application to prevent data leaks.
5 | | """
  | |___^ D415
6 |
7 |   import re
  |
  = help: Add closing punctuation

src/infrastructure/security/logging_security_monitor.py:16:5: D205 1 blank line required between summary line and description
   |
15 |   class LoggingSecurityMonitor:
16 | /     """Ensures all log messages are sanitized and COPPA-compliant
17 | |     before being written to log files.
18 | |     """
   | |_______^ D205
19 |
20 |       def __init__(self) -> None:
   |
   = help: Insert single blank line

src/infrastructure/security/logging_security_monitor.py:38:9: D205 1 blank line required between summary line and description
   |
37 |       def scan_codebase_for_violations(self, source_dir: str) -> dict[str, Any]:
38 | /         """Scan the codebase for potential logging security violations
39 | |         Args: source_dir: Root directory to scan
40 | |         Returns: Report of findings and violations
41 | |         """
   | |___________^ D205
42 |           violations = []
43 |           files_scanned = 0
   |
   = help: Insert single blank line

src/infrastructure/security/logging_security_monitor.py:38:9: D415 First line should end with a period, question mark, or exclamation point
   |
37 |       def scan_codebase_for_violations(self, source_dir: str) -> dict[str, Any]:
38 | /         """Scan the codebase for potential logging security violations
39 | |         Args: source_dir: Root directory to scan
40 | |         Returns: Report of findings and violations
41 | |         """
   | |___________^ D415
42 |           violations = []
43 |           files_scanned = 0
   |
   = help: Add closing punctuation

src/infrastructure/security/logging_security_monitor.py:59:18: PTH123 `open()` should be replaced by `Path.open()`
   |
57 |         violations = []
58 |         try:
59 |             with open(file_path, encoding="utf-8") as f:
   |                  ^^^^ PTH123
60 |                 for line_num, line in enumerate(f, 1):
61 |                     if "logger." in line or "logging." in line:
   |

src/infrastructure/security/logging_security_monitor.py:61:21: SIM102 Use a single `if` statement instead of nested `if` statements
   |
59 |               with open(file_path, encoding="utf-8") as f:
60 |                   for line_num, line in enumerate(f, 1):
61 | /                     if "logger." in line or "logging." in line:
62 | |                         # Check if the log message is sanitized
63 | |                         if "sanitizer.sanitize" not in line:
   | |____________________________________________________________^ SIM102
64 |                               for (
65 |                                   data_type,
   |
   = help: Combine `if` statements using `and`

src/infrastructure/security/logging_security_monitor.py:73:89: E501 Line too long (117 > 88)
   |
71 | …                         "file": str(file_path),
72 | …                         "line": line_num,
73 | …                         "violation": f"Unsanitized log message containing potential {data_type}",
   |                                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
74 | …                         "code": line.strip(),
75 | …                     }
   |

src/infrastructure/security/logging_security_monitor.py:78:13: B028 No explicit `stacklevel` keyword argument found
   |
76 |                                     )
77 |         except Exception as e:
78 |             warnings.warn(f"Could not scan file {file_path}: {e}")
   |             ^^^^^^^^^^^^^ B028
79 |         return violations
   |
   = help: Set `stacklevel=2`

src/infrastructure/security/main_security_service.py:2:1: I001 [*] Import block is un-sorted or un-formatted
   |
 1 |   # Standard library imports
 2 | / import os
 3 | | import re
 4 | | import secrets
 5 | | from typing import Any
 6 | |
 7 | | # Local imports
 8 | | from ..config.settings import get_settings
 9 | | from .rate_limiter.service import ComprehensiveRateLimiter as RateLimiter
   | |_________________________________________________________________________^ I001
10 |   # # from .real_auth_service import ProductionAuthService
   |
   = help: Organize imports

src/infrastructure/security/main_security_service.py:8:1: TID252 Prefer absolute imports over relative imports from parent modules
   |
 7 | # Local imports
 8 | from ..config.settings import get_settings
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
 9 | from .rate_limiter.service import ComprehensiveRateLimiter as RateLimiter
10 | # # from .real_auth_service import ProductionAuthService
   |
   = help: Replace relative imports from parent modules with absolute imports

src/infrastructure/security/main_security_service.py:10:1: ERA001 Found commented-out code
   |
 8 | from ..config.settings import get_settings
 9 | from .rate_limiter.service import ComprehensiveRateLimiter as RateLimiter
10 | # # from .real_auth_service import ProductionAuthService
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ ERA001
11 |
12 | """Main security service - unified implementation"""
   |
   = help: Remove commented-out code

src/infrastructure/security/main_security_service.py:13:1: E402 Module level import not at top of file
   |
12 | """Main security service - unified implementation"""
13 | from src.infrastructure.logging_config import get_logger
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
14 |
15 | logger = get_logger(__name__, component="security")
   |

src/infrastructure/security/main_security_service.py:25:29: F821 Undefined name `ProductionAuthService`
   |
23 |         self.settings = get_settings()
24 |         # Initialize sub-services
25 |         self.auth_service = ProductionAuthService(
   |                             ^^^^^^^^^^^^^^^^^^^^^ F821
26 |             database_session=self.config.get("database"),
27 |             redis_cache=self.config.get("redis"),
   |

src/infrastructure/security/main_security_service.py:29:35: F821 Undefined name `ChildDataEncryption`
   |
27 |             redis_cache=self.config.get("redis"),
28 |         )
29 |         self.encryption_service = ChildDataEncryption(
   |                                   ^^^^^^^^^^^^^^^^^^^ F821
30 |             encryption_key=self.settings.SECRET_KEY,
31 |         )
   |

src/infrastructure/security/main_security_service.py:93:34: PLR2004 Magic value used in comparison, consider replacing `50` with a constant variable
   |
91 |                 return {"valid": False, "error": "Invalid email format"}
92 |         elif input_type == "child_name":
93 |             if len(input_data) > 50:
   |                                  ^^ PLR2004
94 |                 return {"valid": False, "error": "Name too long"}
95 |             if not re.match(r"^[a-zA-Z\s\'-]+$", input_data):
   |

src/infrastructure/security/main_security_service.py:120:89: E501 Line too long (93 > 88)
    |
119 |     def validate_production_environment_security(self) -> list[str]:
120 |         """Validates production environment security settings within the security service."""
    |                                                                                         ^^^^^ E501
121 |         errors = []
122 |         # Access environment variables directly to validate against secure
    |

src/infrastructure/security/password_hasher.py:10:5: D205 1 blank line required between summary line and description
   |
 9 |   class PasswordHasher:
10 | /     """Service for securely hashing and verifying passwords using bcrypt.
11 | |     This implementation includes mitigations for timing attacks.
12 | |     """
   | |_______^ D205
13 |
14 |       def __init__(self, settings=None) -> None:
   |
   = help: Insert single blank line

src/infrastructure/security/password_hasher.py:26:19: TRY003 Avoid specifying long messages outside the exception class
   |
24 |           """Hashes a password using bcrypt with a securely generated salt."""
25 |           if not password or len(password) < self.password_min_length:
26 |               raise ValueError(
   |  ___________________^
27 | |                 f"Password does not meet security requirements. "
28 | |                 f"Minimum length: {self.password_min_length} characters.",
29 | |             )
   | |_____________^ TRY003
30 |           try:
31 |               password_bytes = password.encode("utf-8")
   |

src/infrastructure/security/password_hasher.py:42:19: TRY003 Avoid specifying long messages outside the exception class
   |
40 |             )
41 |             # Do not expose internal error details to the caller.
42 |             raise ValueError("Could not securely hash the password.") from e
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
43 |
44 |     def verify_password(self, password: str, hashed_password: str) -> bool:
   |

src/infrastructure/security/password_hasher.py:45:9: D205 1 blank line required between summary line and description
   |
44 |       def verify_password(self, password: str, hashed_password: str) -> bool:
45 | /         """Verifies a password against a bcrypt hash in a way that is resistant
46 | |         to timing attacks.
47 | |         """
   | |___________^ D205
48 |           if not password or not hashed_password:
49 |               return False
   |
   = help: Insert single blank line

src/infrastructure/security/password_hasher.py:54:89: E501 Line too long (99 > 88)
   |
52 |             hashed_password_bytes = hashed_password.encode("utf-8")
53 |             # bcrypt.checkpw is the correct and secure way to verify bcrypt hashes.
54 |             # It is designed to be slow and its internal comparison is resistant to timing attacks.
   |                                                                                         ^^^^^^^^^^^ E501
55 |             return bcrypt.checkpw(password_bytes, hashed_password_bytes)
56 |         except (ValueError, TypeError):
   |

src/infrastructure/security/password_hasher.py:58:89: E501 Line too long (92 > 88)
   |
56 |         except (ValueError, TypeError):
57 |             # This can occur if the hashed_password is not a valid bcrypt hash.
58 |             # To prevent timing analysis that could leak information about valid vs. invalid
   |                                                                                         ^^^^ E501
59 |             # hash formats, we perform a dummy hash operation to ensure a consistent
60 |             # execution time, regardless of the input's validity.
   |

src/infrastructure/security/password_validator.py:9:5: PLR0912 Too many branches (24 > 12)
   |
 9 | def validate_password_strength(
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^ PLR0912
10 |     password: str,
11 |     requirements: PasswordRequirements,
   |

src/infrastructure/security/password_validator.py:9:5: PLR0915 Too many statements (56 > 50)
   |
 9 | def validate_password_strength(
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^ PLR0915
10 |     password: str,
11 |     requirements: PasswordRequirements,
   |

src/infrastructure/security/password_validator.py:97:37: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
   |
95 |         email_local = user_info.get("email", "").split("@")[0].lower()
96 |         for part in [*name_parts, email_local]:
97 |             if part and len(part) > 2 and part in password_lower:
   |                                     ^ PLR2004
98 |                 validation["valid"] = False
99 |                 validation["errors"].append(
   |

src/infrastructure/security/password_validator.py:104:40: PLR2004 Magic value used in comparison, consider replacing `80` with a constant variable
    |
103 |     # تقييم القوة النهائية
104 |     if validation["strength_score"] >= 80:
    |                                        ^^ PLR2004
105 |         validation["strength"] = "STRONG"
106 |     elif validation["strength_score"] >= 60:
    |

src/infrastructure/security/password_validator.py:106:42: PLR2004 Magic value used in comparison, consider replacing `60` with a constant variable
    |
104 |     if validation["strength_score"] >= 80:
105 |         validation["strength"] = "STRONG"
106 |     elif validation["strength_score"] >= 60:
    |                                          ^^ PLR2004
107 |         validation["strength"] = "MEDIUM"
108 |     else:
    |

src/infrastructure/security/password_validator.py:114:39: PLR2004 Magic value used in comparison, consider replacing `80` with a constant variable
    |
113 |     # اقتراحات التحسين
114 |     if validation["strength_score"] < 80:
    |                                       ^^ PLR2004
115 |         validation["suggestions"].extend(
116 |             [
    |

src/infrastructure/security/path_validator.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Path Validation Security Service
2 | | This module provides secure path validation to prevent directory traversal attacks
3 | | and ensure all file operations are restricted to authorized directories.
4 | | """
  | |___^ D205
5 |
6 |   import os
  |
  = help: Insert single blank line

src/infrastructure/security/path_validator.py:18:5: D415 First line should end with a period, question mark, or exclamation point
   |
16 | @dataclass
17 | class PathPolicy:
18 |     """Security policy for path operations"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
19 |
20 |     allowed_base_dirs: set[str]
   |
   = help: Add closing punctuation

src/infrastructure/security/path_validator.py:28:5: D205 1 blank line required between summary line and description
   |
27 |   class PathValidator:
28 | /     """This service validates file paths and prevents directory traversal
29 | |     vulnerabilities while maintaining child safety compliance.
30 | |     """
   | |_______^ D205
31 |
32 |       # Dangerous path patterns that indicate traversal attempts
   |
   = help: Insert single blank line

src/infrastructure/security/path_validator.py:33:26: RUF012 Mutable class attributes should be annotated with `typing.ClassVar`
   |
32 |       # Dangerous path patterns that indicate traversal attempts
33 |       TRAVERSAL_PATTERNS = [
   |  __________________________^
34 | |         r"\\.\\./",  # Unix-style parent directory
35 | |         r"\\.\\.\\",  # Windows-style parent directory
36 | |         r"%2e%2e",  # URL-encoded ..
37 | |         r"%2f",  # URL-encoded /
38 | |         r"%5c",  # URL-encoded \\
39 | |         r"\\.\\.%2f",  # Mixed encoding
40 | |         r"\\.\\.%5c",  # Mixed encoding
41 | |         r"%252e%252e",  # Double URL-encoded ..
42 | |         r"\x2e\x2e",  # Hex-encoded ..
43 | |         r"\\.{2,}",  # Multiple dots
44 | |     ]
   | |_____^ RUF012
45 |
46 |       def __init__(self, policy: PathPolicy) -> None:
   |

src/infrastructure/security/path_validator.py:54:43: PTH100 `os.path.abspath()` should be replaced by `Path.resolve()`
   |
52 |         self.normalized_base_dirs = set()
53 |         for base_dir in policy.allowed_base_dirs:
54 |             normalized = os.path.realpath(os.path.abspath(base_dir))
   |                                           ^^^^^^^^^^^^^^^ PTH100
55 |             self.normalized_base_dirs.add(normalized)
56 |             logger.debug(f"Added normalized base directory: {normalized}")
   |
   = help: Replace with `Path(...).resolve()`

src/infrastructure/security/path_validator.py:58:9: PLR0911 Too many return statements (10 > 6)
   |
56 |             logger.debug(f"Added normalized base directory: {normalized}")
57 |
58 |     def validate_path(self, user_path: str, operation: str = "read") -> bool:
   |         ^^^^^^^^^^^^^ PLR0911
59 |         """Validate a user-provided path for security
60 |         Args:
   |

src/infrastructure/security/path_validator.py:58:45: ARG002 Unused method argument: `operation`
   |
56 |             logger.debug(f"Added normalized base directory: {normalized}")
57 |
58 |     def validate_path(self, user_path: str, operation: str = "read") -> bool:
   |                                             ^^^^^^^^^ ARG002
59 |         """Validate a user-provided path for security
60 |         Args:
   |

src/infrastructure/security/path_validator.py:59:9: D205 1 blank line required between summary line and description
   |
58 |       def validate_path(self, user_path: str, operation: str = "read") -> bool:
59 | /         """Validate a user-provided path for security
60 | |         Args:
61 | |             user_path: The path provided by user/API
62 | |             operation: Type of operation (read, write, execute)
63 | |
64 | |         Returns:
65 | |             bool: True if path is safe, False otherwise
66 | |         """
   | |___________^ D205
67 |           try:
68 |               # Basic input validation
   |
   = help: Insert single blank line

src/infrastructure/security/path_validator.py:59:9: D415 First line should end with a period, question mark, or exclamation point
   |
58 |       def validate_path(self, user_path: str, operation: str = "read") -> bool:
59 | /         """Validate a user-provided path for security
60 | |         Args:
61 | |             user_path: The path provided by user/API
62 | |             operation: Type of operation (read, write, execute)
63 | |
64 | |         Returns:
65 | |             bool: True if path is safe, False otherwise
66 | |         """
   | |___________^ D415
67 |           try:
68 |               # Basic input validation
   |
   = help: Add closing punctuation

src/infrastructure/security/path_validator.py:89:52: PTH100 `os.path.abspath()` should be replaced by `Path.resolve()`
   |
87 |             # Normalize and resolve the path
88 |             try:
89 |                 normalized_path = os.path.realpath(os.path.abspath(user_path))
   |                                                    ^^^^^^^^^^^^^^^ PTH100
90 |             except (OSError, ValueError) as e:
91 |                 logger.warning(f"Failed to normalize path {user_path}: {e}")
   |
   = help: Replace with `Path(...).resolve()`

src/infrastructure/security/path_validator.py:104:51: PTH114 `os.path.islink()` should be replaced by `Path.is_symlink()`
    |
102 |                     return False
103 |             # Check symlink policy
104 |             if not self.policy.allow_symlinks and os.path.islink(user_path):
    |                                                   ^^^^^^^^^^^^^^ PTH114
105 |                 logger.warning(f"Symlinks not allowed: {user_path}")
106 |                 return False
    |
    = help: Replace with `Path(...).is_symlink()`

src/infrastructure/security/path_validator.py:107:13: TRY300 Consider moving this statement to an `else` block
    |
105 |                 logger.warning(f"Symlinks not allowed: {user_path}")
106 |                 return False
107 |             return True
    |             ^^^^^^^^^^^ TRY300
108 |         except Exception as e:
109 |             logger.error(f"Path validation error: {e}")
    |

src/infrastructure/security/path_validator.py:109:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
107 |             return True
108 |         except Exception as e:
109 |             logger.error(f"Path validation error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
110 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/path_validator.py:113:9: D205 1 blank line required between summary line and description
    |
112 |       def sanitize_path(self, user_path: str) -> str | None:
113 | /         """Sanitize a user path by removing dangerous components
114 | |         Args:
115 | |             user_path: User-provided path
116 | |         Returns:
117 | |             Optional[str]: Sanitized path or None if cannot be made safe
118 | |         """
    | |___________^ D205
119 |           if not user_path:
120 |               return None
    |
    = help: Insert single blank line

src/infrastructure/security/path_validator.py:113:9: D415 First line should end with a period, question mark, or exclamation point
    |
112 |       def sanitize_path(self, user_path: str) -> str | None:
113 | /         """Sanitize a user path by removing dangerous components
114 | |         Args:
115 | |             user_path: User-provided path
116 | |         Returns:
117 | |             Optional[str]: Sanitized path or None if cannot be made safe
118 | |         """
    | |___________^ D415
119 |           if not user_path:
120 |               return None
    |
    = help: Add closing punctuation

src/infrastructure/security/path_validator.py:136:13: TRY300 Consider moving this statement to an `else` block
    |
134 |             if self.validate_path(sanitized):
135 |                 return sanitized
136 |             return None
    |             ^^^^^^^^^^^ TRY300
137 |         except Exception as e:
138 |             logger.error(f"Path sanitization error: {e}")
    |

src/infrastructure/security/path_validator.py:138:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
136 |             return None
137 |         except Exception as e:
138 |             logger.error(f"Path sanitization error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
139 |             return None
    |
    = help: Replace with `exception`

src/infrastructure/security/path_validator.py:141:55: RUF013 PEP 484 prohibits implicit `Optional`
    |
139 |             return None
140 |
141 |     def get_safe_path(self, user_path: str, base_dir: str = None) -> str | None:
    |                                                       ^^^ RUF013
142 |         """Get a safe absolute path within the specified base directory
143 |         Args:
    |
    = help: Convert to `T | None`

src/infrastructure/security/path_validator.py:142:9: D205 1 blank line required between summary line and description
    |
141 |       def get_safe_path(self, user_path: str, base_dir: str = None) -> str | None:
142 | /         """Get a safe absolute path within the specified base directory
143 | |         Args:
144 | |             user_path: User-provided path
145 | |             base_dir: Base directory to restrict to (must be in allowed dirs)
146 | |
147 | |         Returns:
148 | |             Optional[str]: Safe absolute path or None
149 | |         """
    | |___________^ D205
150 |           try:
151 |               # Use first allowed base directory if none specified
    |
    = help: Insert single blank line

src/infrastructure/security/path_validator.py:142:9: D415 First line should end with a period, question mark, or exclamation point
    |
141 |       def get_safe_path(self, user_path: str, base_dir: str = None) -> str | None:
142 | /         """Get a safe absolute path within the specified base directory
143 | |         Args:
144 | |             user_path: User-provided path
145 | |             base_dir: Base directory to restrict to (must be in allowed dirs)
146 | |
147 | |         Returns:
148 | |             Optional[str]: Safe absolute path or None
149 | |         """
    | |___________^ D415
150 |           try:
151 |               # Use first allowed base directory if none specified
    |
    = help: Add closing punctuation

src/infrastructure/security/path_validator.py:155:28: RUF015 Prefer `next(iter(self.normalized_base_dirs))` over single element slice
    |
153 |                 if not self.normalized_base_dirs:
154 |                     return None
155 |                 base_dir = list(self.normalized_base_dirs)[0]
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ RUF015
156 |             # Ensure base directory is allowed
157 |             normalized_base = os.path.realpath(os.path.abspath(base_dir))
    |
    = help: Replace with `next(iter(self.normalized_base_dirs))`

src/infrastructure/security/path_validator.py:157:48: PTH100 `os.path.abspath()` should be replaced by `Path.resolve()`
    |
155 |                 base_dir = list(self.normalized_base_dirs)[0]
156 |             # Ensure base directory is allowed
157 |             normalized_base = os.path.realpath(os.path.abspath(base_dir))
    |                                                ^^^^^^^^^^^^^^^ PTH100
158 |             if normalized_base not in self.normalized_base_dirs:
159 |                 logger.warning(f"Base directory not allowed: {base_dir}")
    |
    = help: Replace with `Path(...).resolve()`

src/infrastructure/security/path_validator.py:166:25: PTH118 `os.path.join()` should be replaced by `Path` with `/` operator
    |
164 |                 return None
165 |             # Combine with base directory
166 |             safe_path = os.path.join(normalized_base, sanitized)
    |                         ^^^^^^^^^^^^ PTH118
167 |             safe_path = os.path.realpath(safe_path)
168 |             # Final validation
    |

src/infrastructure/security/path_validator.py:171:13: TRY300 Consider moving this statement to an `else` block
    |
169 |             if self.validate_path(safe_path):
170 |                 return safe_path
171 |             return None
    |             ^^^^^^^^^^^ TRY300
172 |         except Exception as e:
173 |             logger.error(f"Safe path generation error: {e}")
    |

src/infrastructure/security/path_validator.py:173:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
171 |             return None
172 |         except Exception as e:
173 |             logger.error(f"Safe path generation error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
174 |             return None
    |
    = help: Replace with `exception`

src/infrastructure/security/path_validator.py:177:9: D415 First line should end with a period, question mark, or exclamation point
    |
176 |     def _contains_traversal_patterns(self, path: str) -> bool:
177 |         """Check if path contains directory traversal patterns"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
178 |         for pattern in self._compiled_patterns:
179 |             if pattern.search(path):
    |
    = help: Add closing punctuation

src/infrastructure/security/path_validator.py:178:9: SIM110 Use `return any(pattern.search(path) for pattern in self._compiled_patterns)` instead of `for` loop
    |
176 |       def _contains_traversal_patterns(self, path: str) -> bool:
177 |           """Check if path contains directory traversal patterns"""
178 | /         for pattern in self._compiled_patterns:
179 | |             if pattern.search(path):
180 | |                 return True
181 | |         return False
    | |____________________^ SIM110
182 |
183 |       def _is_within_allowed_dirs(self, normalized_path: str) -> bool:
    |
    = help: Replace with `return any(pattern.search(path) for pattern in self._compiled_patterns)`

src/infrastructure/security/path_validator.py:184:9: D415 First line should end with a period, question mark, or exclamation point
    |
183 |     def _is_within_allowed_dirs(self, normalized_path: str) -> bool:
184 |         """Check if normalized path is within allowed base directories"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
185 |         for base_dir in self.normalized_base_dirs:
186 |             try:
    |
    = help: Add closing punctuation

src/infrastructure/security/path_validator.py:197:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
195 |                 continue
196 |             except OSError as e:
197 |                 logger.error(f"OS error during path validation: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
198 |                 continue
199 |         return False
    |
    = help: Replace with `exception`

src/infrastructure/security/path_validator.py:203:5: D205 1 blank line required between summary line and description
    |
202 |   class SecureFileOperations:
203 | /     """Provides safe file operations that automatically validate paths
204 | |     before performing file system operations.
205 | |     """
    | |_______^ D205
206 |
207 |       def __init__(self, validator: PathValidator) -> None:
    |
    = help: Insert single blank line

src/infrastructure/security/path_validator.py:211:9: D205 1 blank line required between summary line and description
    |
210 |       def safe_open(self, user_path: str, mode: str = "r", **kwargs):
211 | /         """Safely open a file after path validation
212 | |         Args:
213 | |             user_path: User-provided file path
214 | |             mode: File open mode
215 | |             **kwargs: Additional arguments for open()
216 | |
217 | |         Returns:
218 | |             File object or raises PathSecurityError
219 | |         """
    | |___________^ D205
220 |           if not self.validator.validate_path(
221 |               user_path, "read" if "r" in mode else "write"
    |
    = help: Insert single blank line

src/infrastructure/security/path_validator.py:211:9: D415 First line should end with a period, question mark, or exclamation point
    |
210 |       def safe_open(self, user_path: str, mode: str = "r", **kwargs):
211 | /         """Safely open a file after path validation
212 | |         Args:
213 | |             user_path: User-provided file path
214 | |             mode: File open mode
215 | |             **kwargs: Additional arguments for open()
216 | |
217 | |         Returns:
218 | |             File object or raises PathSecurityError
219 | |         """
    | |___________^ D415
220 |           if not self.validator.validate_path(
221 |               user_path, "read" if "r" in mode else "write"
    |
    = help: Add closing punctuation

src/infrastructure/security/path_validator.py:223:19: TRY003 Avoid specifying long messages outside the exception class
    |
221 |             user_path, "read" if "r" in mode else "write"
222 |         ):
223 |             raise PathSecurityError(f"Path validation failed: {user_path}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
224 |         safe_path = self.validator.get_safe_path(user_path)
225 |         if not safe_path:
    |

src/infrastructure/security/path_validator.py:226:19: TRY003 Avoid specifying long messages outside the exception class
    |
224 |         safe_path = self.validator.get_safe_path(user_path)
225 |         if not safe_path:
226 |             raise PathSecurityError(f"Cannot create safe path: {user_path}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
227 |         try:
228 |             return open(safe_path, mode, **kwargs)
    |

src/infrastructure/security/path_validator.py:228:20: PTH123 `open()` should be replaced by `Path.open()`
    |
226 |             raise PathSecurityError(f"Cannot create safe path: {user_path}")
227 |         try:
228 |             return open(safe_path, mode, **kwargs)
    |                    ^^^^ PTH123
229 |         except Exception as e:
230 |             logger.error(f"File operation error: {e}")
    |

src/infrastructure/security/path_validator.py:230:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
228 |             return open(safe_path, mode, **kwargs)
229 |         except Exception as e:
230 |             logger.error(f"File operation error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
231 |             raise
    |
    = help: Replace with `exception`

src/infrastructure/security/path_validator.py:234:9: D415 First line should end with a period, question mark, or exclamation point
    |
233 |     def safe_exists(self, user_path: str) -> bool:
234 |         """Safely check if file exists"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
235 |         if not self.validator.validate_path(user_path, "read"):
236 |             return False
    |
    = help: Add closing punctuation

src/infrastructure/security/path_validator.py:240:16: PTH110 `os.path.exists()` should be replaced by `Path.exists()`
    |
238 |         if not safe_path:
239 |             return False
240 |         return os.path.exists(safe_path)
    |                ^^^^^^^^^^^^^^ PTH110
241 |
242 |     def safe_remove(self, user_path: str) -> bool:
    |
    = help: Replace with `Path(...).exists()`

src/infrastructure/security/path_validator.py:243:9: D415 First line should end with a period, question mark, or exclamation point
    |
242 |     def safe_remove(self, user_path: str) -> bool:
243 |         """Safely remove a file"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
244 |         if not self.validator.validate_path(user_path, "write"):
245 |             return False
    |
    = help: Add closing punctuation

src/infrastructure/security/path_validator.py:250:13: PTH107 `os.remove()` should be replaced by `Path.unlink()`
    |
248 |             return False
249 |         try:
250 |             os.remove(safe_path)
    |             ^^^^^^^^^ PTH107
251 |             return True
252 |         except Exception as e:
    |
    = help: Replace with `Path(...).unlink()`

src/infrastructure/security/path_validator.py:251:13: TRY300 Consider moving this statement to an `else` block
    |
249 |         try:
250 |             os.remove(safe_path)
251 |             return True
    |             ^^^^^^^^^^^ TRY300
252 |         except Exception as e:
253 |             logger.error(f"File removal error: {e}")
    |

src/infrastructure/security/path_validator.py:253:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
251 |             return True
252 |         except Exception as e:
253 |             logger.error(f"File removal error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
254 |             return False
    |
    = help: Replace with `exception`

src/infrastructure/security/path_validator.py:257:9: D415 First line should end with a period, question mark, or exclamation point
    |
256 |     def safe_listdir(self, user_path: str) -> list[str]:
257 |         """Safely list directory contents"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
258 |         if not self.validator.validate_path(user_path, "read"):
259 |             return []
    |
    = help: Add closing punctuation

src/infrastructure/security/path_validator.py:264:20: PTH208 Use `pathlib.Path.iterdir()` instead.
    |
262 |             return []
263 |         try:
264 |             return os.listdir(safe_path)
    |                    ^^^^^^^^^^ PTH208
265 |         except Exception as e:
266 |             logger.error(f"Directory listing error: {e}")
    |

src/infrastructure/security/path_validator.py:266:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
264 |             return os.listdir(safe_path)
265 |         except Exception as e:
266 |             logger.error(f"Directory listing error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
267 |             return []
    |
    = help: Replace with `exception`

src/infrastructure/security/path_validator.py:271:5: D415 First line should end with a period, question mark, or exclamation point
    |
270 | class PathSecurityError(Exception):
271 |     """Custom exception for security-related path errors"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
    |
    = help: Add closing punctuation

src/infrastructure/security/path_validator.py:275:5: D205 1 blank line required between summary line and description
    |
274 |   def create_child_safe_validator() -> PathValidator:
275 | /     """Create a path validator with child-safe default policies
276 | |     Returns:
277 | |         PathValidator: Configured for child safety compliance
278 | |     """
    | |_______^ D205
279 |       # Define safe base directories for child data
280 |       safe_dirs = {
    |
    = help: Insert single blank line

src/infrastructure/security/path_validator.py:275:5: D415 First line should end with a period, question mark, or exclamation point
    |
274 |   def create_child_safe_validator() -> PathValidator:
275 | /     """Create a path validator with child-safe default policies
276 | |     Returns:
277 | |         PathValidator: Configured for child safety compliance
278 | |     """
    | |_______^ D415
279 |       # Define safe base directories for child data
280 |       safe_dirs = {
    |
    = help: Add closing punctuation

src/infrastructure/security/path_validator.py:281:9: S108 Probable insecure usage of temporary file or directory: "/tmp/teddy_temp"
    |
279 |     # Define safe base directories for child data
280 |     safe_dirs = {
281 |         "/tmp/teddy_temp",  # Temporary files
    |         ^^^^^^^^^^^^^^^^^ S108
282 |         "./data/children",  # Child data (relative to app)
283 |         "./logs",  # Log files
    |

src/infrastructure/security/path_validator.py:309:5: D205 1 blank line required between summary line and description
    |
308 |   def create_secure_file_operations() -> SecureFileOperations:
309 | /     """Create secure file operations with child-safe validation
310 | |     Returns:
311 | |         SecureFileOperations: Ready for safe file operations
312 | |     """
    | |_______^ D205
313 |       validator = create_child_safe_validator()
314 |       return SecureFileOperations(validator)
    |
    = help: Insert single blank line

src/infrastructure/security/path_validator.py:309:5: D415 First line should end with a period, question mark, or exclamation point
    |
308 |   def create_secure_file_operations() -> SecureFileOperations:
309 | /     """Create secure file operations with child-safe validation
310 | |     Returns:
311 | |         SecureFileOperations: Ready for safe file operations
312 | |     """
    | |_______^ D415
313 |       validator = create_child_safe_validator()
314 |       return SecureFileOperations(validator)
    |
    = help: Add closing punctuation

src/infrastructure/security/path_validator.py:323:5: D415 First line should end with a period, question mark, or exclamation point
    |
322 | def get_path_validator() -> PathValidator:
323 |     """Get global path validator instance"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
324 |     global _default_validator
325 |     if _default_validator is None:
    |
    = help: Add closing punctuation

src/infrastructure/security/path_validator.py:324:12: PLW0603 Using the global statement to update `_default_validator` is discouraged
    |
322 | def get_path_validator() -> PathValidator:
323 |     """Get global path validator instance"""
324 |     global _default_validator
    |            ^^^^^^^^^^^^^^^^^^ PLW0603
325 |     if _default_validator is None:
326 |         _default_validator = create_child_safe_validator()
    |

src/infrastructure/security/path_validator.py:331:5: D415 First line should end with a period, question mark, or exclamation point
    |
330 | def get_secure_file_operations() -> SecureFileOperations:
331 |     """Get global secure file operations instance"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
332 |     global _default_file_ops
333 |     if _default_file_ops is None:
    |
    = help: Add closing punctuation

src/infrastructure/security/path_validator.py:332:12: PLW0603 Using the global statement to update `_default_file_ops` is discouraged
    |
330 | def get_secure_file_operations() -> SecureFileOperations:
331 |     """Get global secure file operations instance"""
332 |     global _default_file_ops
    |            ^^^^^^^^^^^^^^^^^ PLW0603
333 |     if _default_file_ops is None:
334 |         _default_file_ops = create_secure_file_operations()
    |

src/infrastructure/security/path_validator.py:339:5: D415 First line should end with a period, question mark, or exclamation point
    |
338 | def validate_path(user_path: str) -> bool:
339 |     """Convenience function for path validation"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
340 |     return get_path_validator().validate_path(user_path)
    |
    = help: Add closing punctuation

src/infrastructure/security/path_validator.py:344:5: D415 First line should end with a period, question mark, or exclamation point
    |
343 | def safe_open(user_path: str, mode: str = "r", **kwargs):
344 |     """Convenience function for safe file opening"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
345 |     return get_secure_file_operations().safe_open(user_path, mode, **kwargs)
    |
    = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Plugin Architecture for AI Teddy Bear
2 | |
3 | | This module provides a secure plugin system for extending functionality
4 | | while maintaining child safety and security compliance.
5 | | """
  | |___^ D415
6 |
7 |   import importlib
  |
  = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:17:5: D415 First line should end with a period, question mark, or exclamation point
   |
16 | class PluginType(Enum):
17 |     """Types of plugins supported by the system"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
18 |
19 |     AI_SERVICE = "AI_SERVICE"
   |
   = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:27:5: D415 First line should end with a period, question mark, or exclamation point
   |
26 | class PluginStatus(Enum):
27 |     """Plugin status states"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
28 |
29 |     INACTIVE = "INACTIVE"
   |
   = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:37:5: D415 First line should end with a period, question mark, or exclamation point
   |
35 | @dataclass
36 | class PluginManifest:
37 |     """Plugin manifest containing metadata"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
38 |
39 |     name: str
   |
   = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:56:5: D415 First line should end with a period, question mark, or exclamation point
   |
55 | class PluginInterface(ABC):
56 |     """Base interface that all plugins must implement"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
57 |
58 |     @abstractmethod
   |
   = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:60:9: D415 First line should end with a period, question mark, or exclamation point
   |
58 |     @abstractmethod
59 |     def initialize(self, config: dict[str, Any]) -> bool:
60 |         """Initialize the plugin with configuration"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
61 |         pass
   |
   = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:65:9: D415 First line should end with a period, question mark, or exclamation point
   |
63 |     @abstractmethod
64 |     def execute(self, *args, **kwargs) -> Any:
65 |         """Execute the plugin's main functionality"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
66 |         pass
   |
   = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:70:9: D415 First line should end with a period, question mark, or exclamation point
   |
68 |     @abstractmethod
69 |     def cleanup(self) -> None:
70 |         """Clean up resources when plugin is disabled"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
71 |         pass
   |
   = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:76:9: D415 First line should end with a period, question mark, or exclamation point
   |
74 |     @abstractmethod
75 |     def name(self) -> str:
76 |         """Get plugin name"""
   |         ^^^^^^^^^^^^^^^^^^^^^ D415
77 |         pass
   |
   = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:82:9: D415 First line should end with a period, question mark, or exclamation point
   |
80 |     @abstractmethod
81 |     def version(self) -> str:
82 |         """Get plugin version"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^ D415
83 |         pass
   |
   = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:87:5: D415 First line should end with a period, question mark, or exclamation point
   |
86 | class PluginValidationError(Exception):
87 |     """Exception raised when plugin validation fails"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
88 |
89 |     pass
   |
   = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:93:5: D415 First line should end with a period, question mark, or exclamation point
   |
92 | class PluginSecurityError(Exception):
93 |     """Exception raised when plugin security check fails"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
94 |
95 |     pass
   |
   = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:99:5: D415 First line should end with a period, question mark, or exclamation point
    |
 98 | class PluginValidator:
 99 |     """Validates plugins for security and child safety compliance"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
100 |
101 |     FORBIDDEN_IMPORTS = {
    |
    = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:101:25: RUF012 Mutable class attributes should be annotated with `typing.ClassVar`
    |
 99 |       """Validates plugins for security and child safety compliance"""
100 |
101 |       FORBIDDEN_IMPORTS = {
    |  _________________________^
102 | |         "subprocess",
103 | |         "os.system",
104 | |         "eval",
105 | |         "exec",
106 | |         "compile",
107 | |         "socket",
108 | |         "urllib",
109 | |         "requests",
110 | |         "http",
111 | |         "ftplib",
112 | |         "__import__",
113 | |         "importlib.import_module",
114 | |     }
    | |_____^ RUF012
115 |
116 |       FORBIDDEN_KEYWORDS = {
    |

src/infrastructure/security/plugin_architecture.py:116:26: RUF012 Mutable class attributes should be annotated with `typing.ClassVar`
    |
114 |       }
115 |
116 |       FORBIDDEN_KEYWORDS = {
    |  __________________________^
117 | |         "subprocess",
118 | |         "system",
119 | |         "popen",
120 | |         "shell",
121 | |         "network",
122 | |         "internet",
123 | |         "download",
124 | |         "upload",
125 | |     }
    | |_____^ RUF012
126 |
127 |       def validate_plugin(self, plugin_path: Path) -> bool:
    |

src/infrastructure/security/plugin_architecture.py:128:9: D415 First line should end with a period, question mark, or exclamation point
    |
127 |     def validate_plugin(self, plugin_path: Path) -> bool:
128 |         """Validate plugin for security and compliance"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
129 |         try:
130 |             # Check file extension
    |
    = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:132:17: TRY301 Abstract `raise` to an inner function
    |
130 |             # Check file extension
131 |             if not plugin_path.suffix == ".py":
132 |                 raise PluginValidationError("Plugin must be a Python file")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
133 |
134 |             # Read and analyze source code
    |

src/infrastructure/security/plugin_architecture.py:132:23: TRY003 Avoid specifying long messages outside the exception class
    |
130 |             # Check file extension
131 |             if not plugin_path.suffix == ".py":
132 |                 raise PluginValidationError("Plugin must be a Python file")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
133 |
134 |             # Read and analyze source code
    |

src/infrastructure/security/plugin_architecture.py:135:18: PTH123 `open()` should be replaced by `Path.open()`
    |
134 |             # Read and analyze source code
135 |             with open(plugin_path, encoding="utf-8") as f:
    |                  ^^^^ PTH123
136 |                 source_code = f.read()
    |

src/infrastructure/security/plugin_architecture.py:140:17: TRY301 Abstract `raise` to an inner function
    |
138 |             # Check for forbidden imports and keywords
139 |             if self._contains_forbidden_content(source_code):
140 |                 raise PluginSecurityError("Plugin contains forbidden functionality")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
141 |
142 |             # Validate syntax
    |

src/infrastructure/security/plugin_architecture.py:140:23: TRY003 Avoid specifying long messages outside the exception class
    |
138 |             # Check for forbidden imports and keywords
139 |             if self._contains_forbidden_content(source_code):
140 |                 raise PluginSecurityError("Plugin contains forbidden functionality")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
141 |
142 |             # Validate syntax
    |

src/infrastructure/security/plugin_architecture.py:146:17: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
144 |                 compile(source_code, plugin_path, "exec")
145 |             except SyntaxError as e:
146 |                 raise PluginValidationError(f"Plugin syntax error: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
147 |
148 |             return True
    |

src/infrastructure/security/plugin_architecture.py:146:23: TRY003 Avoid specifying long messages outside the exception class
    |
144 |                 compile(source_code, plugin_path, "exec")
145 |             except SyntaxError as e:
146 |                 raise PluginValidationError(f"Plugin syntax error: {e}")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
147 |
148 |             return True
    |

src/infrastructure/security/plugin_architecture.py:148:13: TRY300 Consider moving this statement to an `else` block
    |
146 |                 raise PluginValidationError(f"Plugin syntax error: {e}")
147 |
148 |             return True
    |             ^^^^^^^^^^^ TRY300
149 |
150 |         except Exception as e:
    |

src/infrastructure/security/plugin_architecture.py:151:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
150 |         except Exception as e:
151 |             raise PluginValidationError(f"Plugin validation failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
152 |
153 |     def _contains_forbidden_content(self, source_code: str) -> bool:
    |

src/infrastructure/security/plugin_architecture.py:151:19: TRY003 Avoid specifying long messages outside the exception class
    |
150 |         except Exception as e:
151 |             raise PluginValidationError(f"Plugin validation failed: {e}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
152 |
153 |     def _contains_forbidden_content(self, source_code: str) -> bool:
    |

src/infrastructure/security/plugin_architecture.py:154:9: D415 First line should end with a period, question mark, or exclamation point
    |
153 |     def _contains_forbidden_content(self, source_code: str) -> bool:
154 |         """Check if source code contains forbidden functionality"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
155 |         source_lower = source_code.lower()
    |
    = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:166:9: SIM110 Use `return any(keyword in source_lower for keyword in self.FORBIDDEN_KEYWORDS)` instead of `for` loop
    |
165 |           # Check for forbidden keywords
166 | /         for keyword in self.FORBIDDEN_KEYWORDS:
167 | |             if keyword in source_lower:
168 | |                 return True
169 | |
170 | |         return False
    | |____________________^ SIM110
    |
    = help: Replace with `return any(keyword in source_lower for keyword in self.FORBIDDEN_KEYWORDS)`

src/infrastructure/security/plugin_architecture.py:174:5: D415 First line should end with a period, question mark, or exclamation point
    |
173 | class PluginManager:
174 |     """Manages plugin loading, validation, and execution"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
175 |
176 |     def __init__(self, plugins_dir: str = "./plugins"):
    |
    = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:185:9: D415 First line should end with a period, question mark, or exclamation point
    |
184 |     def load_plugin(self, plugin_name: str) -> bool:
185 |         """Load a plugin by name"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
186 |         try:
187 |             plugin_path = self.plugins_dir / f"{plugin_name}.py"
    |
    = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:191:17: TRY301 Abstract `raise` to an inner function
    |
190 |             if not plugin_path.exists():
191 |                 raise FileNotFoundError(f"Plugin file not found: {plugin_path}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
192 |
193 |             # Validate plugin security
    |

src/infrastructure/security/plugin_architecture.py:191:23: TRY003 Avoid specifying long messages outside the exception class
    |
190 |             if not plugin_path.exists():
191 |                 raise FileNotFoundError(f"Plugin file not found: {plugin_path}")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
192 |
193 |             # Validate plugin security
    |

src/infrastructure/security/plugin_architecture.py:195:17: TRY301 Abstract `raise` to an inner function
    |
193 |               # Validate plugin security
194 |               if not self.validator.validate_plugin(plugin_path):
195 | /                 raise PluginSecurityError(
196 | |                     f"Plugin {plugin_name} failed security validation"
197 | |                 )
    | |_________________^ TRY301
198 |
199 |               # Load manifest if exists
    |

src/infrastructure/security/plugin_architecture.py:195:23: TRY003 Avoid specifying long messages outside the exception class
    |
193 |               # Validate plugin security
194 |               if not self.validator.validate_plugin(plugin_path):
195 |                   raise PluginSecurityError(
    |  _______________________^
196 | |                     f"Plugin {plugin_name} failed security validation"
197 | |                 )
    | |_________________^ TRY003
198 |
199 |               # Load manifest if exists
    |

src/infrastructure/security/plugin_architecture.py:205:17: TRY301 Abstract `raise` to an inner function
    |
203 |             spec = importlib.util.spec_from_file_location(plugin_name, plugin_path)
204 |             if spec is None or spec.loader is None:
205 |                 raise ImportError(f"Cannot load plugin spec: {plugin_name}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
206 |
207 |             module = importlib.util.module_from_spec(spec)
    |

src/infrastructure/security/plugin_architecture.py:205:23: TRY003 Avoid specifying long messages outside the exception class
    |
203 |             spec = importlib.util.spec_from_file_location(plugin_name, plugin_path)
204 |             if spec is None or spec.loader is None:
205 |                 raise ImportError(f"Cannot load plugin spec: {plugin_name}")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
206 |
207 |             module = importlib.util.module_from_spec(spec)
    |

src/infrastructure/security/plugin_architecture.py:213:17: TRY301 Abstract `raise` to an inner function
    |
211 |             plugin_class = self._find_plugin_class(module)
212 |             if plugin_class is None:
213 |                 raise PluginValidationError("No valid plugin class found")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
214 |
215 |             # Create plugin instance
    |

src/infrastructure/security/plugin_architecture.py:213:23: TRY003 Avoid specifying long messages outside the exception class
    |
211 |             plugin_class = self._find_plugin_class(module)
212 |             if plugin_class is None:
213 |                 raise PluginValidationError("No valid plugin class found")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
214 |
215 |             # Create plugin instance
    |

src/infrastructure/security/plugin_architecture.py:226:13: TRY300 Consider moving this statement to an `else` block
    |
224 |             }
225 |
226 |             return True
    |             ^^^^^^^^^^^ TRY300
227 |
228 |         except Exception as e:
    |

src/infrastructure/security/plugin_architecture.py:232:57: RUF013 PEP 484 prohibits implicit `Optional`
    |
230 |             return False
231 |
232 |     def activate_plugin(self, plugin_name: str, config: dict[str, Any] = None) -> bool:
    |                                                         ^^^^^^^^^^^^^^ RUF013
233 |         """Activate a loaded plugin"""
234 |         if plugin_name not in self.plugins:
    |
    = help: Convert to `T | None`

src/infrastructure/security/plugin_architecture.py:233:9: D415 First line should end with a period, question mark, or exclamation point
    |
232 |     def activate_plugin(self, plugin_name: str, config: dict[str, Any] = None) -> bool:
233 |         """Activate a loaded plugin"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
234 |         if plugin_name not in self.plugins:
235 |             return False
    |
    = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:246:13: TRY300 Consider moving this statement to an `else` block
    |
244 |                 return True
245 |             plugin_info["status"] = PluginStatus.ERROR
246 |             return False
    |             ^^^^^^^^^^^^ TRY300
247 |
248 |         except Exception as e:
    |

src/infrastructure/security/plugin_architecture.py:254:9: D415 First line should end with a period, question mark, or exclamation point
    |
253 |     def deactivate_plugin(self, plugin_name: str) -> bool:
254 |         """Deactivate a plugin"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^ D415
255 |         if plugin_name not in self.plugins:
256 |             return False
    |
    = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:264:13: TRY300 Consider moving this statement to an `else` block
    |
262 |             plugin_instance.cleanup()
263 |             plugin_info["status"] = PluginStatus.INACTIVE
264 |             return True
    |             ^^^^^^^^^^^ TRY300
265 |
266 |         except Exception as e:
    |

src/infrastructure/security/plugin_architecture.py:271:9: D415 First line should end with a period, question mark, or exclamation point
    |
270 |     def execute_plugin(self, plugin_name: str, *args, **kwargs) -> Any:
271 |         """Execute a plugin's main functionality"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
272 |         if plugin_name not in self.plugins:
273 |             raise ValueError(f"Plugin {plugin_name} not found")
    |
    = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:273:19: TRY003 Avoid specifying long messages outside the exception class
    |
271 |         """Execute a plugin's main functionality"""
272 |         if plugin_name not in self.plugins:
273 |             raise ValueError(f"Plugin {plugin_name} not found")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
274 |
275 |         plugin_info = self.plugins[plugin_name]
    |

src/infrastructure/security/plugin_architecture.py:277:19: TRY003 Avoid specifying long messages outside the exception class
    |
275 |         plugin_info = self.plugins[plugin_name]
276 |         if plugin_info["status"] != PluginStatus.ACTIVE:
277 |             raise RuntimeError(f"Plugin {plugin_name} is not active")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
278 |
279 |         return plugin_info["instance"].execute(*args, **kwargs)
    |

src/infrastructure/security/plugin_architecture.py:282:9: D415 First line should end with a period, question mark, or exclamation point
    |
281 |     def list_plugins(self) -> list[dict[str, Any]]:
282 |         """List all loaded plugins with their status"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
283 |         return [
284 |             {
    |
    = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:293:9: D415 First line should end with a period, question mark, or exclamation point
    |
292 |     def get_plugins_by_type(self, plugin_type: PluginType) -> list[str]:
293 |         """Get plugins of a specific type"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
294 |         return [
295 |             name
    |
    = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:301:9: D415 First line should end with a period, question mark, or exclamation point
    |
300 |     def _load_manifest(self, manifest_path: Path) -> PluginManifest | None:
301 |         """Load plugin manifest from JSON file"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
302 |         if not manifest_path.exists():
303 |             return None
    |
    = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:306:13: PLC0415 `import` should be at the top-level of a file
    |
305 |         try:
306 |             import json
    |             ^^^^^^^^^^^ PLC0415
307 |
308 |             with open(manifest_path, encoding="utf-8") as f:
    |

src/infrastructure/security/plugin_architecture.py:308:18: PTH123 `open()` should be replaced by `Path.open()`
    |
306 |             import json
307 |
308 |             with open(manifest_path, encoding="utf-8") as f:
    |                  ^^^^ PTH123
309 |                 data = json.load(f)
    |

src/infrastructure/security/plugin_architecture.py:328:9: D415 First line should end with a period, question mark, or exclamation point
    |
327 |     def _find_plugin_class(self, module) -> type[PluginInterface] | None:
328 |         """Find the main plugin class in a module"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
329 |         for name, obj in inspect.getmembers(module, inspect.isclass):
330 |             if (
    |
    = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:329:13: B007 Loop control variable `name` not used within loop body
    |
327 |     def _find_plugin_class(self, module) -> type[PluginInterface] | None:
328 |         """Find the main plugin class in a module"""
329 |         for name, obj in inspect.getmembers(module, inspect.isclass):
    |             ^^^^ B007
330 |             if (
331 |                 obj != PluginInterface
    |
    = help: Rename unused `name` to `_name`

src/infrastructure/security/plugin_architecture.py:340:5: D415 First line should end with a period, question mark, or exclamation point
    |
339 | def create_plugin_manager(path: str = "./plugins") -> PluginManager:
340 |     """Create a new plugin manager instance"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
341 |     return PluginManager(path)
    |
    = help: Add closing punctuation

src/infrastructure/security/plugin_architecture.py:344:5: PLR0913 Too many arguments in function definition (6 > 5)
    |
344 | def create_plugin_manifest(
    |     ^^^^^^^^^^^^^^^^^^^^^^ PLR0913
345 |     name: str,
346 |     version: str,
    |

src/infrastructure/security/plugin_architecture.py:353:5: D415 First line should end with a period, question mark, or exclamation point
    |
351 |     **kwargs,
352 | ) -> PluginManifest:
353 |     """Create a new plugin manifest"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
354 |     return PluginManifest(
355 |         name=name,
    |
    = help: Add closing punctuation

src/infrastructure/security/rate_limiter.py:32:26: ARG002 Unused method argument: `args`
   |
30 |             pass
31 |
32 |         def limit(self, *args, **kwargs) -> Callable:
   |                          ^^^^ ARG002
33 |             def decorator(func) -> Callable:
34 |                 return func
   |

src/infrastructure/security/rate_limiter.py:32:34: ARG002 Unused method argument: `kwargs`
   |
30 |             pass
31 |
32 |         def limit(self, *args, **kwargs) -> Callable:
   |                                  ^^^^^^ ARG002
33 |             def decorator(func) -> Callable:
34 |                 return func
   |

src/infrastructure/security/rate_limiter.py:38:28: ARG001 Unused function argument: `request`
   |
36 |             return decorator
37 |
38 |     def get_remote_address(request):
   |                            ^^^^^^^ ARG001
39 |         return "127.0.0.1"
   |

src/infrastructure/security/rate_limiter.py:41:11: N818 Exception name `RateLimitExceeded` should be named with an Error suffix
   |
39 |         return "127.0.0.1"
40 |
41 |     class RateLimitExceeded(Exception):
   |           ^^^^^^^^^^^^^^^^^ N818
42 |         pass
   |

src/infrastructure/security/rate_limiter.py:62:11: N818 Exception name `HTTPException` should be named with an Error suffix
   |
60 |             self.url = type("URL", (), {"path": "/"})()
61 |
62 |     class HTTPException(Exception):
   |           ^^^^^^^^^^^^^ N818
63 |         def __init__(self, status_code: int, detail: str) -> None:
64 |             self.status_code = status_code
   |

src/infrastructure/security/rate_limiter.py:67:11: N801 Class name `status` should use CapWords convention
   |
65 |             self.detail = detail
66 |
67 |     class status:
   |           ^^^^^^ N801
68 |         HTTP_429_TOO_MANY_REQUESTS = 429
   |

src/infrastructure/security/rate_limiter.py:76:37: ARG002 Unused method argument: `exc_class`
   |
75 |     class FastAPI:
76 |         def exception_handler(self, exc_class):
   |                                     ^^^^^^^^^ ARG002
77 |             def decorator(func):
78 |                 return func
   |

src/infrastructure/security/rate_limiter.py:84:5: D205 1 blank line required between summary line and description
   |
83 |   class ChildSafetyRateLimiter:
84 | /     """Advanced rate limiter with child-specific safety controls.
85 | |     Implements dynamic rate limits based on user behavior and child safety context.
86 | |     """
   | |_______^ D205
87 |
88 |       def __init__(self, settings: Settings = None) -> None:
   |
   = help: Insert single blank line

src/infrastructure/security/rate_limiter.py:121:9: D415 First line should end with a period, question mark, or exclamation point
    |
120 |     def get_limiter(self) -> Limiter:
121 |         """Get the rate limiter instance"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
122 |         return self.limiter
    |
    = help: Add closing punctuation

src/infrastructure/security/rate_limiter.py:125:30: ARG002 Unused method argument: `request`
    |
124 |     async def check_child_interaction(
125 |         self, child_id: str, request: Request = None
    |                              ^^^^^^^ ARG002
126 |     ) -> None:
127 |         """Rate limit child interactions to prevent abuse and ensure safety."""
    |

src/infrastructure/security/rate_limiter.py:149:9: D415 First line should end with a period, question mark, or exclamation point
    |
148 |     def is_child_locked_out(self, child_id: str) -> bool:
149 |         """Check if a child is currently locked out"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
150 |         if child_id not in self.child_interaction_limits:
151 |             return False
    |
    = help: Add closing punctuation

src/infrastructure/security/rate_limiter.py:163:9: D415 First line should end with a period, question mark, or exclamation point
    |
162 |     def get_child_interaction_count(self, child_id: str) -> int:
163 |         """Get current interaction count for a child"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
164 |         now = datetime.utcnow()
165 |         self.child_interaction_limits[child_id] = [
    |
    = help: Add closing punctuation

src/infrastructure/security/rate_limiter.py:173:9: D415 First line should end with a period, question mark, or exclamation point
    |
172 |     def reset_child_interactions(self, child_id: str) -> None:
173 |         """Reset interaction count for a child (admin function)"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
174 |         if child_id in self.child_interaction_limits:
175 |             del self.child_interaction_limits[child_id]
    |
    = help: Add closing punctuation

src/infrastructure/security/rate_limiter.py:201:47: RUF013 PEP 484 prohibits implicit `Optional`
    |
199 |             )
200 |
201 |     def get_rate_limit_status(self, child_id: str = None) -> dict:
    |                                               ^^^ RUF013
202 |         """Get current rate limiting status"""
203 |         status_info = {
    |
    = help: Convert to `T | None`

src/infrastructure/security/rate_limiter.py:202:9: D415 First line should end with a period, question mark, or exclamation point
    |
201 |     def get_rate_limit_status(self, child_id: str = None) -> dict:
202 |         """Get current rate limiting status"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
203 |         status_info = {
204 |             "slowapi_available": SLOWAPI_AVAILABLE,
    |
    = help: Add closing punctuation

src/infrastructure/security/rate_limiter.py:229:5: D415 First line should end with a period, question mark, or exclamation point
    |
227 |     settings: Settings = None,
228 | ) -> ChildSafetyRateLimiter:
229 |     """Get or create the global rate limiter instance"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
230 |     global _rate_limiter_instance
231 |     if _rate_limiter_instance is None:
    |
    = help: Add closing punctuation

src/infrastructure/security/rate_limiter.py:230:12: PLW0603 Using the global statement to update `_rate_limiter_instance` is discouraged
    |
228 | ) -> ChildSafetyRateLimiter:
229 |     """Get or create the global rate limiter instance"""
230 |     global _rate_limiter_instance
    |            ^^^^^^^^^^^^^^^^^^^^^^ PLW0603
231 |     if _rate_limiter_instance is None:
232 |         if settings is None:
    |

src/infrastructure/security/rate_limiter.py:239:5: D415 First line should end with a period, question mark, or exclamation point
    |
238 | def create_rate_limiter_dependency():
239 |     """Create a FastAPI dependency for the rate limiter"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
240 |     if FASTAPI_AVAILABLE:
241 |         return Depends(get_child_safety_rate_limiter)
    |
    = help: Add closing punctuation

src/infrastructure/security/rate_limiter.py:247:5: D415 First line should end with a period, question mark, or exclamation point
    |
245 | # Convenience functions for easy use
246 | def check_child_rate_limit(child_id: str, request: Request = None):
247 |     """Convenience function to check child rate limits"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
248 |     limiter = get_child_safety_rate_limiter()
249 |     return limiter.check_child_interaction(child_id, request)
    |
    = help: Add closing punctuation

src/infrastructure/security/rate_limiter.py:252:37: RUF013 PEP 484 prohibits implicit `Optional`
    |
252 | def get_rate_limit_status(child_id: str = None) -> dict:
    |                                     ^^^ RUF013
253 |     """Convenience function to get rate limit status"""
254 |     limiter = get_child_safety_rate_limiter()
    |
    = help: Convert to `T | None`

src/infrastructure/security/rate_limiter.py:253:5: D415 First line should end with a period, question mark, or exclamation point
    |
252 | def get_rate_limit_status(child_id: str = None) -> dict:
253 |     """Convenience function to get rate limit status"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
254 |     limiter = get_child_safety_rate_limiter()
255 |     return limiter.get_rate_limit_status(child_id)
    |
    = help: Add closing punctuation

src/infrastructure/security/rate_limiter/child_safety.py:52:9: PLC0415 `import` should be at the top-level of a file
   |
51 |         # Block if there have been too many recent denials
52 |         import time
   |         ^^^^^^^^^^^ PLC0415
53 |
54 |         recent_time = time.time() - 300  # Last 5 minutes
   |

src/infrastructure/security/rate_limiter/convenience.py:3:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 |   """Convenience functions for common rate limiting scenarios."""
2 |
3 | / from src.infrastructure.security.rate_limiter.core import RateLimitResult
4 | | from .service import get_rate_limiter
  | |_____________________________________^ I001
  |
  = help: Organize imports

src/infrastructure/security/rate_limiter/core.py:19:20: S105 Possible hardcoded password assigned to: "TOKEN_BUCKET"
   |
18 |     SLIDING_WINDOW = "sliding_window"
19 |     TOKEN_BUCKET = "token_bucket"
   |                    ^^^^^^^^^^^^^^ S105
20 |     FIXED_WINDOW = "fixed_window"
21 |     REQUESTS_PER_MINUTE = "requests_per_minute"
   |

src/infrastructure/security/rate_limiter/core.py:35:20: S105 Possible hardcoded password assigned to: "TOKEN_BUCKET"
   |
33 |     FIXED_WINDOW = "fixed_window"
34 |     SLIDING_WINDOW = "sliding_window"
35 |     TOKEN_BUCKET = "token_bucket"
   |                    ^^^^^^^^^^^^^^ S105
36 |     LEAKY_BUCKET = "leaky_bucket"
   |

src/infrastructure/security/rate_limiter/core.py:94:5: D205 1 blank line required between summary line and description
   |
93 |   class RedisRateLimiter:
94 | /     """Redis-backed rate limiter with multiple strategies
95 | |     Supports sliding window, token bucket, and fixed window algorithms.
96 | |     """
   | |_______^ D205
97 |
98 |       def __init__(self, config: RateLimitConfig) -> None:
   |
   = help: Insert single blank line

src/infrastructure/security/rate_limiter/core.py:193:1: W293 [*] Blank line contains whitespace
    |
191 | class ChildSafetyRateLimiter(RedisRateLimiter):
192 |     """Child-specific rate limiter with enhanced safety features."""
193 |     
    | ^^^^ W293
194 |     def __init__(self, redis_client=None):
195 |         # Configuration optimized for child safety
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/rate_limiter/core.py:204:1: W293 [*] Blank line contains whitespace
    |
202 |         )
203 |         super().__init__(child_config, redis_client)
204 |     
    | ^^^^ W293
205 |     async def is_allowed(self, identifier: str, **kwargs) -> RateLimitResult:
206 |         """Check rate limit with child-specific safety checks."""
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/rate_limiter/service.py:22:89: E501 Line too long (94 > 88)
   |
21 | class ComprehensiveRateLimiter:
22 |     """Comprehensive rate limiting service with multiple strategies and child safety features.
   |                                                                                         ^^^^^^ E501
23 |
24 |     Features:
   |

src/infrastructure/security/rate_limiter/service.py:42:9: RUF006 Store a reference to the return value of `asyncio.create_task`
   |
40 |         self.audit_integration = get_audit_integration()
41 |         # Start cleanup task
42 |         asyncio.create_task(self._cleanup_expired_entries())
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ RUF006
43 |
44 |     async def check_rate_limit(
   |

src/infrastructure/security/rate_limiter/service.py:44:15: PLR0913 Too many arguments in function definition (6 > 5)
   |
42 |         asyncio.create_task(self._cleanup_expired_entries())
43 |
44 |     async def check_rate_limit(
   |               ^^^^^^^^^^^^^^^^ PLR0913
45 |         self,
46 |         key: str,
   |

src/infrastructure/security/rate_limiter/service.py:51:9: ARG002 Unused method argument: `request_details`
   |
49 |         child_id: str | None = None,
50 |         ip_address: str | None = None,
51 |         request_details: dict[str, Any] | None = None,
   |         ^^^^^^^^^^^^^^^ ARG002
52 |     ) -> RateLimitResult:
53 |         """Check if request is within rate limits.
   |

src/infrastructure/security/rate_limiter/service.py:69:19: TRY003 Avoid specifying long messages outside the exception class
   |
67 |         config = self.configs.get(config_name)
68 |         if not config:
69 |             raise ValueError(f"Rate limit configuration '{config_name}' not found")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
70 |
71 |         state = await self.storage.get_state(key)
   |

src/infrastructure/security/rate_limiter/service.py:131:12: PLW0603 Using the global statement to update `_rate_limiter_instance` is discouraged
    |
129 | def get_rate_limiter(redis_client=None) -> ComprehensiveRateLimiter:
130 |     """Get singleton instance of the rate limiter."""
131 |     global _rate_limiter_instance
    |            ^^^^^^^^^^^^^^^^^^^^^^ PLW0603
132 |     if _rate_limiter_instance is None:
133 |         _rate_limiter_instance = ComprehensiveRateLimiter(redis_client)
    |

src/infrastructure/security/rate_limiter_service.py:16:45: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
14 |     """Service for managing rate limiting and account lockouts."""
15 |
16 |     def __init__(self, settings: Settings = Depends(get_settings)) -> None:
   |                                             ^^^^^^^^^^^^^^^^^^^^^ B008
17 |         self.settings = settings
18 |         self.max_login_attempts = self.settings.security.MAX_LOGIN_ATTEMPTS
   |

src/infrastructure/security/rate_limiter_service.py:29:9: ARG002 Unused method argument: `ip_address`
   |
27 |         self,
28 |         email: str,
29 |         ip_address: str | None = None,
   |         ^^^^^^^^^^ ARG002
30 |     ) -> dict[str, Any]:
31 |         """Enhanced rate limiting with IP tracking and progressive delays."""
   |

src/infrastructure/security/rate_limiter_service.py:45:89: E501 Line too long (99 > 88)
   |
43 |                     "reason": "account_locked",
44 |                     "retry_after": int(remaining_time),
45 |                     "message": f"Account locked. Try again in {int(remaining_time / 60)} minutes.",
   |                                                                                         ^^^^^^^^^^^ E501
46 |                 }
47 |             # Unlock account
   |

src/infrastructure/security/rate_limiter_service.py:74:27: ARG002 Unused method argument: `ip_address`
   |
73 |     async def record_failed_login(
74 |         self, email: str, ip_address: str | None = None
   |                           ^^^^^^^^^^ ARG002
75 |     ) -> None:
76 |         """Record a failed login attempt."""
   |

src/infrastructure/security/real_auth_service.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Production Authentication Service for AI Teddy Bear
2 | | Enterprise-grade authentication with JWT, bcrypt, and comprehensive security features.
3 | | """
  | |___^ D205
4 |
5 |   import json
  |
  = help: Insert single blank line

src/infrastructure/security/real_auth_service.py:5:1: I001 [*] Import block is un-sorted or un-formatted
   |
 3 |   """
 4 |
 5 | / import json
 6 | | from collections.abc import Callable
 7 | | from datetime import datetime
 8 | | from typing import Any, Optional, Dict
 9 | |
10 | | from fastapi import Depends, HTTPException, status
11 | | from fastapi.security import HTTPBearer, HTTPAuthorizationCredentials
12 | | from pydantic import BaseModel
13 | |
14 | | from src.infrastructure.logging_config import get_logger
15 | | from src.presentation.api.models.validation_models import LoginRequest, LoginResponse
   | |_____________________________________________________________________________________^ I001
16 |
17 |   logger = get_logger(__name__, component="security")
   |
   = help: Organize imports

src/infrastructure/security/real_auth_service.py:5:8: F401 [*] `json` imported but unused
  |
3 | """
4 |
5 | import json
  |        ^^^^ F401
6 | from collections.abc import Callable
7 | from datetime import datetime
  |
  = help: Remove unused import: `json`

src/infrastructure/security/real_auth_service.py:6:29: F401 [*] `collections.abc.Callable` imported but unused
  |
5 | import json
6 | from collections.abc import Callable
  |                             ^^^^^^^^ F401
7 | from datetime import datetime
8 | from typing import Any, Optional, Dict
  |
  = help: Remove unused import: `collections.abc.Callable`

src/infrastructure/security/real_auth_service.py:7:22: F401 [*] `datetime.datetime` imported but unused
  |
5 | import json
6 | from collections.abc import Callable
7 | from datetime import datetime
  |                      ^^^^^^^^ F401
8 | from typing import Any, Optional, Dict
  |
  = help: Remove unused import: `datetime.datetime`

src/infrastructure/security/real_auth_service.py:8:1: UP035 `typing.Dict` is deprecated, use `dict` instead
   |
 6 | from collections.abc import Callable
 7 | from datetime import datetime
 8 | from typing import Any, Optional, Dict
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
 9 |
10 | from fastapi import Depends, HTTPException, status
   |

src/infrastructure/security/real_auth_service.py:8:20: F401 [*] `typing.Any` imported but unused
   |
 6 | from collections.abc import Callable
 7 | from datetime import datetime
 8 | from typing import Any, Optional, Dict
   |                    ^^^ F401
 9 |
10 | from fastapi import Depends, HTTPException, status
   |
   = help: Remove unused import

src/infrastructure/security/real_auth_service.py:8:35: F401 [*] `typing.Dict` imported but unused
   |
 6 | from collections.abc import Callable
 7 | from datetime import datetime
 8 | from typing import Any, Optional, Dict
   |                                   ^^^^ F401
 9 |
10 | from fastapi import Depends, HTTPException, status
   |
   = help: Remove unused import

src/infrastructure/security/real_auth_service.py:35:11: UP045 [*] Use `X | None` for type annotations
   |
33 |     email: str
34 |     role: str
35 |     name: Optional[str] = None
   |           ^^^^^^^^^^^^^ UP045
36 |     is_active: bool = True
   |
   = help: Convert to `X | None`

src/infrastructure/security/real_auth_service.py:41:1: W293 [*] Blank line contains whitespace
   |
39 | class ProductionAuthService:
40 |     """Production-ready authentication service."""
41 |     
   | ^^^^ W293
42 |     def __init__(self):
43 |         self.logger = logger
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/real_auth_service.py:45:1: W293 [*] Blank line contains whitespace
   |
43 |         self.logger = logger
44 |         self.log_sanitizer = log_sanitizer
45 |     
   | ^^^^ W293
46 |     def authenticate(self, request: LoginRequest) -> LoginResponse:
47 |         """Authenticate user credentials."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/real_auth_service.py:46:28: ARG002 Unused method argument: `request`
   |
44 |         self.log_sanitizer = log_sanitizer
45 |     
46 |     def authenticate(self, request: LoginRequest) -> LoginResponse:
   |                            ^^^^^^^ ARG002
47 |         """Authenticate user credentials."""
48 |         return LoginResponse(
   |

src/infrastructure/security/real_auth_service.py:51:13: S106 Possible hardcoded password assigned to argument: "token"
   |
49 |             success=True,
50 |             message="Authentication successful",
51 |             token="dummy_token"
   |             ^^^^^^^^^^^^^^^^^^^ S106
52 |         )
   |

src/infrastructure/security/real_auth_service.py:53:1: W293 [*] Blank line contains whitespace
   |
51 |             token="dummy_token"
52 |         )
53 |     
   | ^^^^ W293
54 |     def validate_token(self, token: str) -> bool:
55 |         """Validate JWT token."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/real_auth_service.py:56:16: SIM210 Use `bool(...)` instead of `True if ... else False`
   |
54 |     def validate_token(self, token: str) -> bool:
55 |         """Validate JWT token."""
56 |         return True if token else False
   |                ^^^^^^^^^^^^^^^^^^^^^^^^ SIM210
57 |     
58 |     def get_user_info(self, user_id: str) -> UserInfo:
   |
   = help: Replace with `bool(...)

src/infrastructure/security/real_auth_service.py:57:1: W293 [*] Blank line contains whitespace
   |
55 |         """Validate JWT token."""
56 |         return True if token else False
57 |     
   | ^^^^ W293
58 |     def get_user_info(self, user_id: str) -> UserInfo:
59 |         """Get user information."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/real_auth_service.py:69:72: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
68 | # Dependency functions
69 | async def get_current_user(credentials: HTTPAuthorizationCredentials = Depends(security)) -> UserInfo:
   |                                                                        ^^^^^^^^^^^^^^^^^ B008
70 |     """Get current authenticated user."""
71 |     try:
   |

src/infrastructure/security/real_auth_service.py:69:89: E501 Line too long (102 > 88)
   |
68 | # Dependency functions
69 | async def get_current_user(credentials: HTTPAuthorizationCredentials = Depends(security)) -> UserInfo:
   |                                                                                         ^^^^^^^^^^^^^^ E501
70 |     """Get current authenticated user."""
71 |     try:
   |

src/infrastructure/security/real_auth_service.py:74:13: TRY301 Abstract `raise` to an inner function
   |
72 |           token = credentials.credentials
73 |           if not token:
74 | /             raise HTTPException(
75 | |                 status_code=status.HTTP_401_UNAUTHORIZED,
76 | |                 detail="Invalid token"
77 | |             )
   | |_____________^ TRY301
78 |           
79 |           # Mock user data - replace with real JWT validation
   |

src/infrastructure/security/real_auth_service.py:78:1: W293 [*] Blank line contains whitespace
   |
76 |                 detail="Invalid token"
77 |             )
78 |         
   | ^^^^^^^^ W293
79 |         # Mock user data - replace with real JWT validation
80 |         return UserInfo(
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/real_auth_service.py:87:9: TRY400 Use `logging.exception` instead of `logging.error`
   |
85 |         )
86 |     except Exception as e:
87 |         logger.error(f"Authentication error: {e}")
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
88 |         raise HTTPException(
89 |             status_code=status.HTTP_401_UNAUTHORIZED,
   |
   = help: Replace with `exception`

src/infrastructure/security/real_auth_service.py:88:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
86 |       except Exception as e:
87 |           logger.error(f"Authentication error: {e}")
88 | /         raise HTTPException(
89 | |             status_code=status.HTTP_401_UNAUTHORIZED,
90 | |             detail="Authentication failed"
91 | |         )
   | |_________^ B904
   |

src/infrastructure/security/real_auth_service.py:94:55: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
94 | async def get_current_parent(current_user: UserInfo = Depends(get_current_user)) -> UserInfo:
   |                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^ B008
95 |     """Get current parent user."""
96 |     if current_user.role not in ["parent", "admin"]:
   |

src/infrastructure/security/real_auth_service.py:94:89: E501 Line too long (93 > 88)
   |
94 | async def get_current_parent(current_user: UserInfo = Depends(get_current_user)) -> UserInfo:
   |                                                                                         ^^^^^ E501
95 |     """Get current parent user."""
96 |     if current_user.role not in ["parent", "admin"]:
   |

src/infrastructure/security/real_auth_service.py:104:54: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
104 | async def get_current_child(current_user: UserInfo = Depends(get_current_user)) -> UserInfo:
    |                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^ B008
105 |     """Get current child user."""
106 |     if current_user.role != "child":
    |

src/infrastructure/security/real_auth_service.py:104:89: E501 Line too long (92 > 88)
    |
104 | async def get_current_child(current_user: UserInfo = Depends(get_current_user)) -> UserInfo:
    |                                                                                         ^^^^ E501
105 |     """Get current child user."""
106 |     if current_user.role != "child":
    |

src/infrastructure/security/real_auth_service.py:114:54: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
114 | async def get_current_admin(current_user: UserInfo = Depends(get_current_user)) -> UserInfo:
    |                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^ B008
115 |     """Get current admin user."""
116 |     if current_user.role != "admin":
    |

src/infrastructure/security/real_auth_service.py:114:89: E501 Line too long (92 > 88)
    |
114 | async def get_current_admin(current_user: UserInfo = Depends(get_current_user)) -> UserInfo:
    |                                                                                         ^^^^ E501
115 |     """Get current admin user."""
116 |     if current_user.role != "admin":
    |

src/infrastructure/security/real_auth_service.py:124:35: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
124 | def require_auth(user: UserInfo = Depends(get_current_user)) -> UserInfo:
    |                                   ^^^^^^^^^^^^^^^^^^^^^^^^^ B008
125 |     """Require authentication."""
126 |     return user
    |

src/infrastructure/security/real_auth_service.py:129:44: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
129 | def require_parent_auth(parent: UserInfo = Depends(get_current_parent)) -> UserInfo:
    |                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
130 |     """Require parent authentication."""
131 |     return parent
    |

src/infrastructure/security/real_auth_service.py:134:42: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
134 | def require_admin_auth(admin: UserInfo = Depends(get_current_admin)) -> UserInfo:
    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
135 |     """Require admin authentication."""
136 |     return admin
    |

src/infrastructure/security/real_auth_service.py:151:11: RUF022 [*] `__all__` is not sorted
    |
150 |   # Export all required components
151 |   __all__ = [
    |  ___________^
152 | |     "ProductionAuthService",
153 | |     "UserInfo", 
154 | |     "get_current_user",
155 | |     "get_current_parent",
156 | |     "get_current_child",
157 | |     "get_current_admin",
158 | |     "require_auth",
159 | |     "require_parent_auth", 
160 | |     "require_admin_auth",
161 | |     "create_auth_service",
162 | |     "auth_service"
163 | | ]
    | |_^ RUF022
    |
    = help: Apply an isort-style sorting to `__all__`

src/infrastructure/security/real_auth_service.py:153:16: W291 [*] Trailing whitespace
    |
151 | __all__ = [
152 |     "ProductionAuthService",
153 |     "UserInfo", 
    |                ^ W291
154 |     "get_current_user",
155 |     "get_current_parent",
    |
    = help: Remove trailing whitespace

src/infrastructure/security/real_auth_service.py:159:27: W291 [*] Trailing whitespace
    |
157 |     "get_current_admin",
158 |     "require_auth",
159 |     "require_parent_auth", 
    |                           ^ W291
160 |     "require_admin_auth",
161 |     "create_auth_service",
    |
    = help: Remove trailing whitespace

src/infrastructure/security/request_security_detector.py:24:44: PLR2004 Magic value used in comparison, consider replacing `403` with a constant variable
   |
23 |         # Detect potential attacks
24 |         if response_info["status_code"] == 403:
   |                                            ^^^ PLR2004
25 |             security_events.append("access_denied")
26 |         if response_info["status_code"] == 429:
   |

src/infrastructure/security/request_security_detector.py:26:44: PLR2004 Magic value used in comparison, consider replacing `429` with a constant variable
   |
24 |         if response_info["status_code"] == 403:
25 |             security_events.append("access_denied")
26 |         if response_info["status_code"] == 429:
   |                                            ^^^ PLR2004
27 |             security_events.append("rate_limit_exceeded")
   |

src/infrastructure/security/request_signing_service.py:1:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | from src.infrastructure.security.security_levels import RequestSecurityLevel
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ I001
2 | """Request Signing Service
3 | Provides cryptographic request signing and validation for child safety.
  |
  = help: Organize imports

src/infrastructure/security/request_signing_service.py:1:57: F401 [*] `src.infrastructure.security.security_levels.RequestSecurityLevel` imported but unused
  |
1 | from src.infrastructure.security.security_levels import RequestSecurityLevel
  |                                                         ^^^^^^^^^^^^^^^^^^^^ F401
2 | """Request Signing Service
3 | Provides cryptographic request signing and validation for child safety.
  |
  = help: Remove unused import: `src.infrastructure.security.security_levels.RequestSecurityLevel`

src/infrastructure/security/request_signing_service.py:7:1: E402 Module level import not at top of file
  |
5 | """
6 |
7 | import base64
  | ^^^^^^^^^^^^^ E402
8 | import hashlib
9 | import hmac
  |

src/infrastructure/security/request_signing_service.py:7:8: F401 [*] `base64` imported but unused
  |
5 | """
6 |
7 | import base64
  |        ^^^^^^ F401
8 | import hashlib
9 | import hmac
  |
  = help: Remove unused import: `base64`

src/infrastructure/security/request_signing_service.py:8:1: E402 Module level import not at top of file
   |
 7 | import base64
 8 | import hashlib
   | ^^^^^^^^^^^^^^ E402
 9 | import hmac
10 | import json
   |

src/infrastructure/security/request_signing_service.py:8:8: F401 [*] `hashlib` imported but unused
   |
 7 | import base64
 8 | import hashlib
   |        ^^^^^^^ F401
 9 | import hmac
10 | import json
   |
   = help: Remove unused import: `hashlib`

src/infrastructure/security/request_signing_service.py:9:1: E402 Module level import not at top of file
   |
 7 | import base64
 8 | import hashlib
 9 | import hmac
   | ^^^^^^^^^^^ E402
10 | import json
11 | import secrets
   |

src/infrastructure/security/request_signing_service.py:9:8: F401 [*] `hmac` imported but unused
   |
 7 | import base64
 8 | import hashlib
 9 | import hmac
   |        ^^^^ F401
10 | import json
11 | import secrets
   |
   = help: Remove unused import: `hmac`

src/infrastructure/security/request_signing_service.py:10:1: E402 Module level import not at top of file
   |
 8 | import hashlib
 9 | import hmac
10 | import json
   | ^^^^^^^^^^^ E402
11 | import secrets
12 | import time
   |

src/infrastructure/security/request_signing_service.py:10:8: F401 [*] `json` imported but unused
   |
 8 | import hashlib
 9 | import hmac
10 | import json
   |        ^^^^ F401
11 | import secrets
12 | import time
   |
   = help: Remove unused import: `json`

src/infrastructure/security/request_signing_service.py:11:1: E402 Module level import not at top of file
   |
 9 | import hmac
10 | import json
11 | import secrets
   | ^^^^^^^^^^^^^^ E402
12 | import time
13 | import urllib.parse
   |

src/infrastructure/security/request_signing_service.py:11:8: F401 [*] `secrets` imported but unused
   |
 9 | import hmac
10 | import json
11 | import secrets
   |        ^^^^^^^ F401
12 | import time
13 | import urllib.parse
   |
   = help: Remove unused import: `secrets`

src/infrastructure/security/request_signing_service.py:12:1: E402 Module level import not at top of file
   |
10 | import json
11 | import secrets
12 | import time
   | ^^^^^^^^^^^ E402
13 | import urllib.parse
14 | from dataclasses import dataclass
   |

src/infrastructure/security/request_signing_service.py:12:8: F401 [*] `time` imported but unused
   |
10 | import json
11 | import secrets
12 | import time
   |        ^^^^ F401
13 | import urllib.parse
14 | from dataclasses import dataclass
   |
   = help: Remove unused import: `time`

src/infrastructure/security/request_signing_service.py:13:1: E402 Module level import not at top of file
   |
11 | import secrets
12 | import time
13 | import urllib.parse
   | ^^^^^^^^^^^^^^^^^^^ E402
14 | from dataclasses import dataclass
15 | from datetime import datetime, timedelta
   |

src/infrastructure/security/request_signing_service.py:13:8: F401 [*] `urllib.parse` imported but unused
   |
11 | import secrets
12 | import time
13 | import urllib.parse
   |        ^^^^^^^^^^^^ F401
14 | from dataclasses import dataclass
15 | from datetime import datetime, timedelta
   |
   = help: Remove unused import: `urllib.parse`

src/infrastructure/security/request_signing_service.py:14:1: E402 Module level import not at top of file
   |
12 | import time
13 | import urllib.parse
14 | from dataclasses import dataclass
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
15 | from datetime import datetime, timedelta
16 | from enum import Enum
   |

src/infrastructure/security/request_signing_service.py:14:25: F401 [*] `dataclasses.dataclass` imported but unused
   |
12 | import time
13 | import urllib.parse
14 | from dataclasses import dataclass
   |                         ^^^^^^^^^ F401
15 | from datetime import datetime, timedelta
16 | from enum import Enum
   |
   = help: Remove unused import: `dataclasses.dataclass`

src/infrastructure/security/request_signing_service.py:15:1: E402 Module level import not at top of file
   |
13 | import urllib.parse
14 | from dataclasses import dataclass
15 | from datetime import datetime, timedelta
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
16 | from enum import Enum
17 | from typing import Any
   |

src/infrastructure/security/request_signing_service.py:15:22: F401 [*] `datetime.datetime` imported but unused
   |
13 | import urllib.parse
14 | from dataclasses import dataclass
15 | from datetime import datetime, timedelta
   |                      ^^^^^^^^ F401
16 | from enum import Enum
17 | from typing import Any
   |
   = help: Remove unused import

src/infrastructure/security/request_signing_service.py:15:32: F401 [*] `datetime.timedelta` imported but unused
   |
13 | import urllib.parse
14 | from dataclasses import dataclass
15 | from datetime import datetime, timedelta
   |                                ^^^^^^^^^ F401
16 | from enum import Enum
17 | from typing import Any
   |
   = help: Remove unused import

src/infrastructure/security/request_signing_service.py:16:1: E402 Module level import not at top of file
   |
14 | from dataclasses import dataclass
15 | from datetime import datetime, timedelta
16 | from enum import Enum
   | ^^^^^^^^^^^^^^^^^^^^^ E402
17 | from typing import Any
   |

src/infrastructure/security/request_signing_service.py:17:1: E402 Module level import not at top of file
   |
15 | from datetime import datetime, timedelta
16 | from enum import Enum
17 | from typing import Any
   | ^^^^^^^^^^^^^^^^^^^^^^ E402
18 |
19 | from src.infrastructure.logging_config import get_logger
   |

src/infrastructure/security/request_signing_service.py:17:20: F401 [*] `typing.Any` imported but unused
   |
15 | from datetime import datetime, timedelta
16 | from enum import Enum
17 | from typing import Any
   |                    ^^^ F401
18 |
19 | from src.infrastructure.logging_config import get_logger
   |
   = help: Remove unused import: `typing.Any`

src/infrastructure/security/request_signing_service.py:19:1: E402 Module level import not at top of file
   |
17 | from typing import Any
18 |
19 | from src.infrastructure.logging_config import get_logger
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
20 |
21 | logger = get_logger(__name__, component="security")
   |

src/infrastructure/security/robust_encryption_service.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Robust Encryption Service with No Silent Failures
2 | | Ensures all encryption operations are properly validated and logged for COPPA compliance.
3 | | """
  | |___^ D205
4 |
5 |   import base64
  |
  = help: Insert single blank line

src/infrastructure/security/robust_encryption_service.py:2:89: E501 Line too long (89 > 88)
  |
1 | """Robust Encryption Service with No Silent Failures
2 | Ensures all encryption operations are properly validated and logged for COPPA compliance.
  |                                                                                         ^ E501
3 | """
  |

src/infrastructure/security/robust_encryption_service.py:34:9: PLR0913 Too many arguments in function definition (6 > 5)
   |
32 |     """Result of encryption operation with detailed status."""
33 |
34 |     def __init__(
   |         ^^^^^^^^ PLR0913
35 |         self,
36 |         success: bool,
   |

src/infrastructure/security/robust_encryption_service.py:84:5: D205 1 blank line required between summary line and description
   |
83 |   class RobustEncryptionService:
84 | /     """Robust encryption service that never fails silently.
85 | |     Features:
86 | |     - Never fails silently - all failures are logged and raised
87 | |     - Comprehensive audit logging for all operations
88 | |     - Key rotation with secure key management
89 | |     - Multiple encryption algorithms support
90 | |     - Integrity verification for all encrypted data
91 | |     - COPPA compliance with enhanced child data protection
92 | |     - Secure key derivation and storage
93 | |     - Operation tracing and monitoring
94 | |     """
   | |_______^ D205
95 |
96 |       def __init__(self, config: EncryptionConfig | None = None):
   |
   = help: Insert single blank line

src/infrastructure/security/robust_encryption_service.py:84:5: D415 First line should end with a period, question mark, or exclamation point
   |
83 |   class RobustEncryptionService:
84 | /     """Robust encryption service that never fails silently.
85 | |     Features:
86 | |     - Never fails silently - all failures are logged and raised
87 | |     - Comprehensive audit logging for all operations
88 | |     - Key rotation with secure key management
89 | |     - Multiple encryption algorithms support
90 | |     - Integrity verification for all encrypted data
91 | |     - COPPA compliance with enhanced child data protection
92 | |     - Secure key derivation and storage
93 | |     - Operation tracing and monitoring
94 | |     """
   | |_______^ D415
95 |
96 |       def __init__(self, config: EncryptionConfig | None = None):
   |
   = help: Add closing punctuation

src/infrastructure/security/robust_encryption_service.py:117:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
115 |         except Exception as e:
116 |             logger.critical(f"Failed to initialize encryption service: {e}")
117 |             raise RuntimeError(f"Encryption service initialization failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
118 |
119 |     def _import_crypto_dependencies(self) -> None:
    |

src/infrastructure/security/robust_encryption_service.py:117:19: TRY003 Avoid specifying long messages outside the exception class
    |
115 |         except Exception as e:
116 |             logger.critical(f"Failed to initialize encryption service: {e}")
117 |             raise RuntimeError(f"Encryption service initialization failed: {e}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
118 |
119 |     def _import_crypto_dependencies(self) -> None:
    |

src/infrastructure/security/robust_encryption_service.py:122:20: PLW0603 Using the global statement to update `Fernet` is discouraged
    |
120 |         """Import and verify cryptographic dependencies."""
121 |         try:
122 |             global Fernet, AESGCM, ChaCha20Poly1305, PBKDF2HMAC, hashes
    |                    ^^^^^^ PLW0603
123 |             from cryptography.fernet import Fernet
124 |             from cryptography.hazmat.primitives import hashes
    |

src/infrastructure/security/robust_encryption_service.py:122:28: PLW0603 Using the global statement to update `AESGCM` is discouraged
    |
120 |         """Import and verify cryptographic dependencies."""
121 |         try:
122 |             global Fernet, AESGCM, ChaCha20Poly1305, PBKDF2HMAC, hashes
    |                            ^^^^^^ PLW0603
123 |             from cryptography.fernet import Fernet
124 |             from cryptography.hazmat.primitives import hashes
    |

src/infrastructure/security/robust_encryption_service.py:122:36: PLW0603 Using the global statement to update `ChaCha20Poly1305` is discouraged
    |
120 |         """Import and verify cryptographic dependencies."""
121 |         try:
122 |             global Fernet, AESGCM, ChaCha20Poly1305, PBKDF2HMAC, hashes
    |                                    ^^^^^^^^^^^^^^^^ PLW0603
123 |             from cryptography.fernet import Fernet
124 |             from cryptography.hazmat.primitives import hashes
    |

src/infrastructure/security/robust_encryption_service.py:122:54: PLW0603 Using the global statement to update `PBKDF2HMAC` is discouraged
    |
120 |         """Import and verify cryptographic dependencies."""
121 |         try:
122 |             global Fernet, AESGCM, ChaCha20Poly1305, PBKDF2HMAC, hashes
    |                                                      ^^^^^^^^^^ PLW0603
123 |             from cryptography.fernet import Fernet
124 |             from cryptography.hazmat.primitives import hashes
    |

src/infrastructure/security/robust_encryption_service.py:122:66: PLW0603 Using the global statement to update `hashes` is discouraged
    |
120 |         """Import and verify cryptographic dependencies."""
121 |         try:
122 |             global Fernet, AESGCM, ChaCha20Poly1305, PBKDF2HMAC, hashes
    |                                                                  ^^^^^^ PLW0603
123 |             from cryptography.fernet import Fernet
124 |             from cryptography.hazmat.primitives import hashes
    |

src/infrastructure/security/robust_encryption_service.py:123:13: PLC0415 `import` should be at the top-level of a file
    |
121 |         try:
122 |             global Fernet, AESGCM, ChaCha20Poly1305, PBKDF2HMAC, hashes
123 |             from cryptography.fernet import Fernet
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
124 |             from cryptography.hazmat.primitives import hashes
125 |             from cryptography.hazmat.primitives.ciphers.aead import (
    |

src/infrastructure/security/robust_encryption_service.py:124:13: PLC0415 `import` should be at the top-level of a file
    |
122 |             global Fernet, AESGCM, ChaCha20Poly1305, PBKDF2HMAC, hashes
123 |             from cryptography.fernet import Fernet
124 |             from cryptography.hazmat.primitives import hashes
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
125 |             from cryptography.hazmat.primitives.ciphers.aead import (
126 |                 AESGCM,
    |

src/infrastructure/security/robust_encryption_service.py:125:13: PLC0415 `import` should be at the top-level of a file
    |
123 |               from cryptography.fernet import Fernet
124 |               from cryptography.hazmat.primitives import hashes
125 | /             from cryptography.hazmat.primitives.ciphers.aead import (
126 | |                 AESGCM,
127 | |                 ChaCha20Poly1305,
128 | |             )
    | |_____________^ PLC0415
129 |               from cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC
    |

src/infrastructure/security/robust_encryption_service.py:129:13: PLC0415 `import` should be at the top-level of a file
    |
127 |                 ChaCha20Poly1305,
128 |             )
129 |             from cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
130 |
131 |             self._crypto_available = True
    |

src/infrastructure/security/robust_encryption_service.py:134:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
132 |             logger.info("Cryptography dependencies loaded successfully")
133 |         except ImportError as e:
134 |             logger.error(f"Cryptography dependencies not available: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
135 |             self._crypto_available = False
136 |             raise ImportError(
    |
    = help: Replace with `exception`

src/infrastructure/security/robust_encryption_service.py:136:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
134 |               logger.error(f"Cryptography dependencies not available: {e}")
135 |               self._crypto_available = False
136 | /             raise ImportError(
137 | |                 f"Required cryptography library not available: {e}. "
138 | |                 "Install with: pip install cryptography"
139 | |             )
    | |_____________^ B904
140 |
141 |       def _initialize_master_key(self) -> None:
    |

src/infrastructure/security/robust_encryption_service.py:136:19: TRY003 Avoid specifying long messages outside the exception class
    |
134 |               logger.error(f"Cryptography dependencies not available: {e}")
135 |               self._crypto_available = False
136 |               raise ImportError(
    |  ___________________^
137 | |                 f"Required cryptography library not available: {e}. "
138 | |                 "Install with: pip install cryptography"
139 | |             )
    | |_____________^ TRY003
140 |
141 |       def _initialize_master_key(self) -> None:
    |

src/infrastructure/security/robust_encryption_service.py:149:43: PLR2004 Magic value used in comparison, consider replacing `32` with a constant variable
    |
147 |                 try:
148 |                     master_key = base64.b64decode(master_key_b64)
149 |                     if len(master_key) != 32:  # 256-bit key
    |                                           ^^ PLR2004
150 |                         raise ValueError("Invalid master key length")
151 |                     self._master_key = master_key
    |

src/infrastructure/security/robust_encryption_service.py:150:25: TRY301 Abstract `raise` to an inner function
    |
148 |                     master_key = base64.b64decode(master_key_b64)
149 |                     if len(master_key) != 32:  # 256-bit key
150 |                         raise ValueError("Invalid master key length")
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
151 |                     self._master_key = master_key
152 |                     logger.info("Master key loaded from environment")
    |

src/infrastructure/security/robust_encryption_service.py:150:31: TRY003 Avoid specifying long messages outside the exception class
    |
148 |                     master_key = base64.b64decode(master_key_b64)
149 |                     if len(master_key) != 32:  # 256-bit key
150 |                         raise ValueError("Invalid master key length")
    |                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
151 |                     self._master_key = master_key
152 |                     logger.info("Master key loaded from environment")
    |

src/infrastructure/security/robust_encryption_service.py:154:21: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
152 |                     logger.info("Master key loaded from environment")
153 |                 except Exception as e:
154 |                     raise ValueError(f"Invalid master key in environment: {e}")
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
155 |             else:
156 |                 # Generate new master key for development/testing
    |

src/infrastructure/security/robust_encryption_service.py:154:27: TRY003 Avoid specifying long messages outside the exception class
    |
152 |                     logger.info("Master key loaded from environment")
153 |                 except Exception as e:
154 |                     raise ValueError(f"Invalid master key in environment: {e}")
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
155 |             else:
156 |                 # Generate new master key for development/testing
    |

src/infrastructure/security/robust_encryption_service.py:170:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
168 |         except Exception as e:
169 |             logger.critical(f"Failed to initialize master key: {e}")
170 |             raise RuntimeError(f"Master key initialization failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
171 |
172 |     def _derive_default_key(self) -> None:
    |

src/infrastructure/security/robust_encryption_service.py:170:19: TRY003 Avoid specifying long messages outside the exception class
    |
168 |         except Exception as e:
169 |             logger.critical(f"Failed to initialize master key: {e}")
170 |             raise RuntimeError(f"Master key initialization failed: {e}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
171 |
172 |     def _derive_default_key(self) -> None:
    |

src/infrastructure/security/robust_encryption_service.py:194:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
192 |         except Exception as e:
193 |             logger.critical(f"Failed to derive default key: {e}")
194 |             raise RuntimeError(f"Key derivation failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
195 |
196 |     def _verify_encryption_capabilities(self) -> None:
    |

src/infrastructure/security/robust_encryption_service.py:194:19: TRY003 Avoid specifying long messages outside the exception class
    |
192 |         except Exception as e:
193 |             logger.critical(f"Failed to derive default key: {e}")
194 |             raise RuntimeError(f"Key derivation failed: {e}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
195 |
196 |     def _verify_encryption_capabilities(self) -> None:
    |

src/infrastructure/security/robust_encryption_service.py:203:17: TRY301 Abstract `raise` to an inner function
    |
201 |             encrypt_result = self.encrypt(test_data, policy=EncryptionPolicy.REQUIRED)
202 |             if not encrypt_result.success:
203 |                 raise RuntimeError(f"Encryption test failed: {encrypt_result.error}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
204 |             # Test decryption
205 |             decrypt_result = self.decrypt(
    |

src/infrastructure/security/robust_encryption_service.py:203:23: TRY003 Avoid specifying long messages outside the exception class
    |
201 |             encrypt_result = self.encrypt(test_data, policy=EncryptionPolicy.REQUIRED)
202 |             if not encrypt_result.success:
203 |                 raise RuntimeError(f"Encryption test failed: {encrypt_result.error}")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
204 |             # Test decryption
205 |             decrypt_result = self.decrypt(
    |

src/infrastructure/security/robust_encryption_service.py:209:17: TRY301 Abstract `raise` to an inner function
    |
207 |             )
208 |             if not decrypt_result.success:
209 |                 raise RuntimeError(f"Decryption test failed: {decrypt_result.error}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
210 |             if decrypt_result.data != test_data:
211 |                 raise RuntimeError("Encryption/decryption test data mismatch")
    |

src/infrastructure/security/robust_encryption_service.py:209:23: TRY003 Avoid specifying long messages outside the exception class
    |
207 |             )
208 |             if not decrypt_result.success:
209 |                 raise RuntimeError(f"Decryption test failed: {decrypt_result.error}")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
210 |             if decrypt_result.data != test_data:
211 |                 raise RuntimeError("Encryption/decryption test data mismatch")
    |

src/infrastructure/security/robust_encryption_service.py:211:17: TRY301 Abstract `raise` to an inner function
    |
209 |                 raise RuntimeError(f"Decryption test failed: {decrypt_result.error}")
210 |             if decrypt_result.data != test_data:
211 |                 raise RuntimeError("Encryption/decryption test data mismatch")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
212 |             logger.info("Encryption capabilities verified successfully")
213 |         except Exception as e:
    |

src/infrastructure/security/robust_encryption_service.py:211:23: TRY003 Avoid specifying long messages outside the exception class
    |
209 |                 raise RuntimeError(f"Decryption test failed: {decrypt_result.error}")
210 |             if decrypt_result.data != test_data:
211 |                 raise RuntimeError("Encryption/decryption test data mismatch")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
212 |             logger.info("Encryption capabilities verified successfully")
213 |         except Exception as e:
    |

src/infrastructure/security/robust_encryption_service.py:215:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
213 |         except Exception as e:
214 |             logger.critical(f"Encryption capability verification failed: {e}")
215 |             raise RuntimeError(f"Encryption verification failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
216 |
217 |     async def encrypt(
    |

src/infrastructure/security/robust_encryption_service.py:215:19: TRY003 Avoid specifying long messages outside the exception class
    |
213 |         except Exception as e:
214 |             logger.critical(f"Encryption capability verification failed: {e}")
215 |             raise RuntimeError(f"Encryption verification failed: {e}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
216 |
217 |     async def encrypt(
    |

src/infrastructure/security/robust_encryption_service.py:217:15: PLR0912 Too many branches (13 > 12)
    |
215 |             raise RuntimeError(f"Encryption verification failed: {e}")
216 |
217 |     async def encrypt(
    |               ^^^^^^^ PLR0912
218 |         self,
219 |         plaintext: str,
    |

src/infrastructure/security/robust_encryption_service.py:241:17: TRY301 Abstract `raise` to an inner function
    |
239 |                 if policy == EncryptionPolicy.OPTIONAL:
240 |                     return EncryptionResult(True, "", None, operation_id)
241 |                 raise ValueError("Cannot encrypt empty data with current policy")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
242 |             if len(plaintext.encode()) > self.config.max_plaintext_size:
243 |                 raise ValueError(
    |

src/infrastructure/security/robust_encryption_service.py:241:23: TRY003 Avoid specifying long messages outside the exception class
    |
239 |                 if policy == EncryptionPolicy.OPTIONAL:
240 |                     return EncryptionResult(True, "", None, operation_id)
241 |                 raise ValueError("Cannot encrypt empty data with current policy")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
242 |             if len(plaintext.encode()) > self.config.max_plaintext_size:
243 |                 raise ValueError(
    |

src/infrastructure/security/robust_encryption_service.py:243:17: TRY301 Abstract `raise` to an inner function
    |
241 |                   raise ValueError("Cannot encrypt empty data with current policy")
242 |               if len(plaintext.encode()) > self.config.max_plaintext_size:
243 | /                 raise ValueError(
244 | |                     f"Plaintext exceeds maximum size: {self.config.max_plaintext_size}"
245 | |                 )
    | |_________________^ TRY301
246 |               # Check if encryption is available
247 |               if not self._crypto_available:
    |

src/infrastructure/security/robust_encryption_service.py:243:23: TRY003 Avoid specifying long messages outside the exception class
    |
241 |                   raise ValueError("Cannot encrypt empty data with current policy")
242 |               if len(plaintext.encode()) > self.config.max_plaintext_size:
243 |                   raise ValueError(
    |  _______________________^
244 | |                     f"Plaintext exceeds maximum size: {self.config.max_plaintext_size}"
245 | |                 )
    | |_________________^ TRY003
246 |               # Check if encryption is available
247 |               if not self._crypto_available:
    |

src/infrastructure/security/robust_encryption_service.py:259:17: TRY301 Abstract `raise` to an inner function
    |
257 |                     "encryption_failed", operation_id, error_msg, context
258 |                 )
259 |                 raise RuntimeError(error_msg)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
260 |             # Get encryption key
261 |             if key_id not in self._encryption_keys:
    |

src/infrastructure/security/robust_encryption_service.py:266:17: TRY301 Abstract `raise` to an inner function
    |
264 |                     "encryption_failed", operation_id, error_msg, context
265 |                 )
266 |                 raise ValueError(error_msg)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
267 |             encryption_key = self._encryption_keys[key_id]
268 |             # Perform encryption
    |

src/infrastructure/security/robust_encryption_service.py:292:21: TRY301 Abstract `raise` to an inner function
    |
290 |                         "encryption_failed", operation_id, error_msg, context
291 |                     )
292 |                     raise RuntimeError(error_msg)
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
293 |             # Log successful encryption
294 |             duration = (datetime.utcnow() - start_time).total_seconds()
    |

src/infrastructure/security/robust_encryption_service.py:314:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
312 |           except Exception as e:
313 |               error_msg = f"Encryption failed: {e!s}"
314 | /             logger.error(
315 | |                 f"Encryption error (operation_id: {operation_id}): {error_msg}"
316 | |             )
    | |_____________^ TRY400
317 |               # Log encryption failure
318 |               await self._log_encryption_event(
    |
    = help: Replace with `exception`

src/infrastructure/security/robust_encryption_service.py:376:17: TRY301 Abstract `raise` to an inner function
    |
374 |                     "decryption_failed", operation_id, error_msg, context
375 |                 )
376 |                 raise RuntimeError(error_msg)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
377 |             # Get decryption key
378 |             if key_id not in self._encryption_keys:
    |

src/infrastructure/security/robust_encryption_service.py:383:17: TRY301 Abstract `raise` to an inner function
    |
381 |                     "decryption_failed", operation_id, error_msg, context
382 |                 )
383 |                 raise ValueError(error_msg)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
384 |             encryption_key = self._encryption_keys[key_id]
385 |             # Perform decryption
    |

src/infrastructure/security/robust_encryption_service.py:426:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
424 |           except Exception as e:
425 |               error_msg = f"Decryption failed: {e!s}"
426 | /             logger.error(
427 | |                 f"Decryption error (operation_id: {operation_id}): {error_msg}"
428 | |             )
    | |_____________^ TRY400
429 |               # Log decryption failure
430 |               await self._log_encryption_event(
    |
    = help: Replace with `exception`

src/infrastructure/security/robust_encryption_service.py:444:43: ARG002 Unused method argument: `operation_id`
    |
443 |     async def _encrypt_aes_gcm(
444 |         self, plaintext: str, key: bytes, operation_id: str
    |                                           ^^^^^^^^^^^^ ARG002
445 |     ) -> str:
446 |         """Encrypt using AES-256-GCM."""
    |

src/infrastructure/security/robust_encryption_service.py:455:48: ARG002 Unused method argument: `operation_id`
    |
454 |     async def _decrypt_aes_gcm(
455 |         self, encrypted_data: str, key: bytes, operation_id: str
    |                                                ^^^^^^^^^^^^ ARG002
456 |     ) -> str:
457 |         """Decrypt using AES-256-GCM."""
    |

src/infrastructure/security/robust_encryption_service.py:459:19: TRY003 Avoid specifying long messages outside the exception class
    |
457 |         """Decrypt using AES-256-GCM."""
458 |         if not encrypted_data.startswith("AES-GCM:"):
459 |             raise ValueError("Invalid AES-GCM format")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
460 |         data = base64.b64decode(encrypted_data[8:])  # Remove "AES-GCM:" prefix
461 |         nonce = data[:12]
    |

src/infrastructure/security/robust_encryption_service.py:468:43: ARG002 Unused method argument: `operation_id`
    |
467 |     async def _encrypt_chacha20(
468 |         self, plaintext: str, key: bytes, operation_id: str
    |                                           ^^^^^^^^^^^^ ARG002
469 |     ) -> str:
470 |         """Encrypt using ChaCha20-Poly1305."""
    |

src/infrastructure/security/robust_encryption_service.py:479:48: ARG002 Unused method argument: `operation_id`
    |
478 |     async def _decrypt_chacha20(
479 |         self, encrypted_data: str, key: bytes, operation_id: str
    |                                                ^^^^^^^^^^^^ ARG002
480 |     ) -> str:
481 |         """Decrypt using ChaCha20-Poly1305."""
    |

src/infrastructure/security/robust_encryption_service.py:483:19: TRY003 Avoid specifying long messages outside the exception class
    |
481 |         """Decrypt using ChaCha20-Poly1305."""
482 |         if not encrypted_data.startswith("ChaCha20:"):
483 |             raise ValueError("Invalid ChaCha20 format")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
484 |         data = base64.b64decode(encrypted_data[9:])  # Remove "ChaCha20:" prefix
485 |         nonce = data[:12]
    |

src/infrastructure/security/robust_encryption_service.py:492:43: ARG002 Unused method argument: `operation_id`
    |
491 |     async def _encrypt_fernet(
492 |         self, plaintext: str, key: bytes, operation_id: str
    |                                           ^^^^^^^^^^^^ ARG002
493 |     ) -> str:
494 |         """Encrypt using Fernet (fallback)."""
    |

src/infrastructure/security/robust_encryption_service.py:502:48: ARG002 Unused method argument: `operation_id`
    |
501 |     async def _decrypt_fernet(
502 |         self, encrypted_data: str, key: bytes, operation_id: str
    |                                                ^^^^^^^^^^^^ ARG002
503 |     ) -> str:
504 |         """Decrypt using Fernet (fallback)."""
    |

src/infrastructure/security/robust_encryption_service.py:536:15: TRY003 Avoid specifying long messages outside the exception class
    |
534 |             except Exception as e:
535 |                 logger.debug(f"Fallback {alg_name} decryption failed: {e}")
536 |         raise RuntimeError("All decryption methods failed")
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
537 |
538 |     def _looks_like_ciphertext(self, data: str) -> bool:
    |

src/infrastructure/security/robust_encryption_service.py:547:28: PLR2004 Magic value used in comparison, consider replacing `20` with a constant variable
    |
545 |         # Check if it looks like base64
546 |         try:
547 |             if len(data) > 20 and len(data) % 4 == 0:
    |                            ^^ PLR2004
548 |                 base64.b64decode(data)
549 |                 return True
    |

src/infrastructure/security/robust_encryption_service.py:584:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
582 |             )
583 |         except Exception as e:
584 |             logger.error(f"Failed to log encryption event: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
585 |
586 |     def is_available(self) -> bool:
    |
    = help: Replace with `exception`

src/infrastructure/security/robust_encryption_service.py:610:12: PLW0603 Using the global statement to update `_encryption_service` is discouraged
    |
608 | ) -> RobustEncryptionService:
609 |     """Get or create global encryption service instance."""
610 |     global _encryption_service
    |            ^^^^^^^^^^^^^^^^^^^ PLW0603
611 |     if _encryption_service is None:
612 |         _encryption_service = RobustEncryptionService(config)
    |

src/infrastructure/security/safe_expression_parser/__init__.py:22:24: ARG002 Unused method argument: `expression`
   |
20 |         pass
21 |
22 |     def evaluate(self, expression, context):
   |                        ^^^^^^^^^^ ARG002
23 |         return 0
   |

src/infrastructure/security/safe_expression_parser/__init__.py:22:36: ARG002 Unused method argument: `context`
   |
20 |         pass
21 |
22 |     def evaluate(self, expression, context):
   |                                    ^^^^^^^ ARG002
23 |         return 0
   |

src/infrastructure/security/safety_monitor_service.py:13:45: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
11 |     """Service for monitoring and reporting on child safety incidents."""
12 |
13 |     def __init__(self, settings: Settings = Depends(get_settings)) -> None:
   |                                             ^^^^^^^^^^^^^^^^^^^^^ B008
14 |         self.logger = get_logger(__name__, component="security")
15 |         self.settings = settings
   |

src/infrastructure/security/safety_monitor_service.py:93:13: SIM102 Use a single `if` statement instead of nested `if` statements
   |
92 |               # Check for personal information patterns
93 | /             if self.safety_rules["allow_personal_info"] is False:
94 | |                 if self._contains_personal_info(content):
   | |_________________________________________________________^ SIM102
95 |                       flags.append("Personal information detected")
96 |                       safety_score -= 0.5
   |
   = help: Combine `if` statements using `and`

src/infrastructure/security/safety_monitor_service.py:114:13: TRY300 Consider moving this statement to an `else` block
    |
112 |                 f"Content safety check: {is_safe}, score: {safety_score:.2f}",
113 |             )
114 |             return result
    |             ^^^^^^^^^^^^^ TRY300
115 |         except Exception as e:
116 |             self.logger.error(f"Error checking content safety: {e!s}")
    |

src/infrastructure/security/safety_monitor_service.py:116:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
114 |             return result
115 |         except Exception as e:
116 |             self.logger.error(f"Error checking content safety: {e!s}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
117 |             return {
118 |                 "safe": False,
    |
    = help: Replace with `exception`

src/infrastructure/security/safety_monitor_service.py:126:9: PLC0415 `import` should be at the top-level of a file
    |
124 |     def _contains_personal_info(self, content: str) -> bool:
125 |         """Check if content contains personal information."""
126 |         import re
    |         ^^^^^^^^^ PLC0415
127 |
128 |         # Simple patterns for personal information
    |

src/infrastructure/security/safety_monitor_service.py:155:37: PLR2004 Magic value used in comparison, consider replacing `300` with a constant variable
    |
153 |             # Check audio duration estimate (basic)
154 |             estimated_duration = len(audio_data) / (16000 * 2)  # Assuming 16kHz, 16-bit
155 |             if estimated_duration > 300:  # 5 minutes max
    |                                     ^^^ PLR2004
156 |                 flags.append("Audio duration too long")
157 |                 safety_score -= 0.1
    |

src/infrastructure/security/safety_monitor_service.py:172:39: PLR2004 Magic value used in comparison, consider replacing `0.7` with a constant variable
    |
171 |             # For now, we implement basic audio validation
172 |             is_safe = safety_score >= 0.7 and len(flags) == 0
    |                                       ^^^ PLR2004
173 |
174 |             result = {
    |

src/infrastructure/security/safety_monitor_service.py:184:89: E501 Line too long (113 > 88)
    |
183 |             self.logger.info(
184 |                 f"Audio safety check: {is_safe}, score: {safety_score:.2f}, duration: {estimated_duration:.1f}s",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^ E501
185 |             )
186 |             return result
    |

src/infrastructure/security/safety_monitor_service.py:186:13: TRY300 Consider moving this statement to an `else` block
    |
184 |                 f"Audio safety check: {is_safe}, score: {safety_score:.2f}, duration: {estimated_duration:.1f}s",
185 |             )
186 |             return result
    |             ^^^^^^^^^^^^^ TRY300
187 |         except Exception as e:
188 |             self.logger.error(f"Error checking audio safety: {e!s}")
    |

src/infrastructure/security/safety_monitor_service.py:188:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
186 |             return result
187 |         except Exception as e:
188 |             self.logger.error(f"Error checking audio safety: {e!s}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
189 |             return {
190 |                 "safe": False,
    |
    = help: Replace with `exception`

src/infrastructure/security/safety_monitor_service.py:198:30: PLR2004 Magic value used in comparison, consider replacing `44` with a constant variable
    |
196 |     def _is_valid_audio_format(self, audio_data: bytes) -> bool:
197 |         """Basic check for valid audio format."""
198 |         if len(audio_data) < 44:  # Minimum WAV header size
    |                              ^^ PLR2004
199 |             return False
    |

src/infrastructure/security/safety_monitor_service.py:208:9: SIM103 Return the condition directly
    |
206 |           if audio_data[:4] == b"OggS":
207 |               return True  # OGG format
208 | /         if audio_data[:4] == b"fLaC":
209 | |             return True  # FLAC format
210 | |
211 | |         return False
    | |____________________^ SIM103
    |
    = help: Inline condition

src/infrastructure/security/secure_logger.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Unified Secure Logging Utility
2 | | Combines COPPA compliance features with advanced sanitization
3 | | Replaces both secure_logger.py and secure_logging.py
4 | | """
  | |___^ D205
5 |
6 |   import hashlib
  |
  = help: Insert single blank line

src/infrastructure/security/secure_logger.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Unified Secure Logging Utility
2 | | Combines COPPA compliance features with advanced sanitization
3 | | Replaces both secure_logger.py and secure_logging.py
4 | | """
  | |___^ D415
5 |
6 |   import hashlib
  |
  = help: Add closing punctuation

src/infrastructure/security/secure_logger.py:9:1: UP035 [*] Import from `collections.abc` instead: `Callable`
   |
 7 | import logging
 8 | import re
 9 | from typing import Any, Callable
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
10 |
11 | from src.infrastructure.logging_config import get_logger
   |
   = help: Import from `collections.abc`

src/infrastructure/security/secure_logger.py:18:5: TID252 Prefer absolute imports over relative imports from parent modules
   |
17 | try:
18 |     from ..config.coppa_config import requires_coppa_audit_logging
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
19 | except ImportError:
20 |     # Fallback if COPPA config not available
   |
   = help: Replace relative imports from parent modules with absolute imports

src/infrastructure/security/secure_logger.py:31:17: RUF013 PEP 484 prohibits implicit `Optional`
   |
29 |         self,
30 |         name: str,
31 |         logger: logging.Logger = None,
   |                 ^^^^^^^^^^^^^^ RUF013
32 |         config: LogSanitizationConfig = None,
33 |     ):
   |
   = help: Convert to `T | None`

src/infrastructure/security/secure_logger.py:37:1: W293 [*] Blank line contains whitespace
   |
35 |         self.logger = logger or get_logger(name, component="security")
36 |         self.config = config or get_default_log_sanitization_config()
37 |         
   | ^^^^^^^^ W293
38 |         # COPPA-specific settings
39 |         self._salt = "teddy_bear_secure_log_2025"
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/secure_logger.py:40:1: W293 [*] Blank line contains whitespace
   |
38 |         # COPPA-specific settings
39 |         self._salt = "teddy_bear_secure_log_2025"
40 |         
   | ^^^^^^^^ W293
41 |         # Compile regex patterns for performance
42 |         self.redact_regex = [
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/secure_logger.py:47:47: W291 [*] Trailing whitespace
   |
45 |         ]
46 |         self.mask_regex = [
47 |             re.compile(pattern, re.IGNORECASE) 
   |                                               ^ W291
48 |             for pattern in self.config.mask_patterns
49 |         ]
   |
   = help: Remove trailing whitespace

src/infrastructure/security/secure_logger.py:54:1: W293 [*] Blank line contains whitespace
   |
52 |     # COPPA-Specific ID Sanitization
53 |     # =====================================
54 |     
   | ^^^^ W293
55 |     def _sanitize_child_id(self, child_id: str) -> str:
56 |         """Convert child_id to a safe hash for COPPA compliance."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/secure_logger.py:59:1: W293 [*] Blank line contains whitespace
   |
57 |         if not child_id:
58 |             return "[EMPTY_CHILD_ID]"
59 |         
   | ^^^^^^^^ W293
60 |         hash_obj = hashlib.sha256(f"{self._salt}_{child_id}".encode())
61 |         short_hash = hash_obj.hexdigest()[:8]
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/secure_logger.py:68:1: W293 [*] Blank line contains whitespace
   |
66 |         if not parent_id:
67 |             return "[EMPTY_PARENT_ID]"
68 |         
   | ^^^^^^^^ W293
69 |         hash_obj = hashlib.sha256(f"{self._salt}_{parent_id}".encode())
70 |         short_hash = hash_obj.hexdigest()[:8]
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/secure_logger.py:77:1: W293 [*] Blank line contains whitespace
   |
75 |         if not email or "@" not in email:
76 |             return "[INVALID_EMAIL]"
77 |         
   | ^^^^^^^^ W293
78 |         parts = email.split("@")
79 |         masked_local = "***" if len(parts[0]) <= 2 else parts[0][:2] + "***"
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/secure_logger.py:79:50: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
   |
78 |         parts = email.split("@")
79 |         masked_local = "***" if len(parts[0]) <= 2 else parts[0][:2] + "***"
   |                                                  ^ PLR2004
80 |         return f"{masked_local}@{parts[1]}"
   |

src/infrastructure/security/secure_logger.py:86:1: W293 [*] Blank line contains whitespace
   |
84 |         if not phone:
85 |             return "[EMPTY_PHONE]"
86 |         
   | ^^^^^^^^ W293
87 |         digits_only = re.sub(r"\D", "", phone)
88 |         if len(digits_only) < 5:
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/secure_logger.py:88:31: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
   |
87 |         digits_only = re.sub(r"\D", "", phone)
88 |         if len(digits_only) < 5:
   |                               ^ PLR2004
89 |             return "***"
90 |         if len(digits_only) >= 10:
   |

src/infrastructure/security/secure_logger.py:90:32: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
   |
88 |         if len(digits_only) < 5:
89 |             return "***"
90 |         if len(digits_only) >= 10:
   |                                ^^ PLR2004
91 |             return digits_only[:3] + "***" + digits_only[-2:]
92 |         return digits_only[:2] + "***"
   |

src/infrastructure/security/secure_logger.py:97:1: W293 [*] Blank line contains whitespace
   |
95 |     # Advanced Value Sanitization
96 |     # =====================================
97 |     
   | ^^^^ W293
98 |     def _sanitize_value(self, key: str, value: Any) -> str:
99 |         """Sanitize a single value based on its key and content."""
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/secure_logger.py:98:9: PLR0911 Too many return statements (10 > 6)
    |
 96 |     # =====================================
 97 |     
 98 |     def _sanitize_value(self, key: str, value: Any) -> str:
    |         ^^^^^^^^^^^^^^^ PLR0911
 99 |         """Sanitize a single value based on its key and content."""
100 |         if value is None:
    |

src/infrastructure/security/secure_logger.py:109:9: RET505 [*] Unnecessary `elif` after `return` statement
    |
107 |         if key_lower == "child_id":
108 |             return self._sanitize_child_id(str_value)
109 |         elif key_lower == "parent_id":
    |         ^^^^ RET505
110 |             return self._sanitize_parent_id(str_value)
111 |         elif key_lower == "email":
    |
    = help: Remove unnecessary `elif`

src/infrastructure/security/secure_logger.py:138:26: PLR2004 Magic value used in comparison, consider replacing `6` with a constant variable
    |
136 |     def _mask_value(self, value: str) -> str:
137 |         """Partially mask a value (show first and last few characters)."""
138 |         if len(value) <= 6:
    |                          ^ PLR2004
139 |             return "*" * len(value)
140 |         if len(value) <= 10:
    |

src/infrastructure/security/secure_logger.py:140:26: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
    |
138 |         if len(value) <= 6:
139 |             return "*" * len(value)
140 |         if len(value) <= 10:
    |                          ^^ PLR2004
141 |             return value[:1] + "*" * (len(value) - 2) + value[-1:]
142 |         return value[:3] + "*" * (len(value) - 6) + value[-3:]
    |

src/infrastructure/security/secure_logger.py:144:89: E501 Line too long (89 > 88)
    |
142 |         return value[:3] + "*" * (len(value) - 6) + value[-3:]
143 |
144 |     def _sanitize_dict(self, data: dict[str, Any], max_depth: int = 3) -> dict[str, Any]:
    |                                                                                         ^ E501
145 |         """Recursively sanitize a dictionary."""
146 |         if max_depth <= 0:
    |

src/infrastructure/security/secure_logger.py:153:18: UP038 Use `X | Y` in `isinstance` call instead of `(X, Y)`
    |
151 |             if isinstance(value, dict):
152 |                 sanitized[key] = self._sanitize_dict(value, max_depth - 1)
153 |             elif isinstance(value, (list, tuple)):
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP038
154 |                 sanitized[key] = self._sanitize_list(value, max_depth - 1)
155 |             else:
    |
    = help: Convert to `X | Y`

src/infrastructure/security/secure_logger.py:168:18: UP038 Use `X | Y` in `isinstance` call instead of `(X, Y)`
    |
166 |             if isinstance(item, dict):
167 |                 sanitized.append(self._sanitize_dict(item, max_depth - 1))
168 |             elif isinstance(item, (list, tuple)):
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP038
169 |                 sanitized.append(self._sanitize_list(item, max_depth - 1))
170 |             else:
    |
    = help: Convert to `X | Y`

src/infrastructure/security/secure_logger.py:195:89: E501 Line too long (111 > 88)
    |
193 |         # Pattern-based sanitization for embedded sensitive data
194 |         patterns = {
195 |             r"\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b": lambda m: self._sanitize_email(m.group(0)),
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^ E501
196 |             r"\+?[\d\s\-\(\)]{10,}": lambda m: self._sanitize_phone(m.group(0)),
197 |             r"\bchild_[a-zA-Z0-9\-_]{8,}": lambda m: self._sanitize_child_id(m.group(0)),
    |

src/infrastructure/security/secure_logger.py:197:89: E501 Line too long (89 > 88)
    |
195 |             r"\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b": lambda m: self._sanitize_email(m.group(0)),
196 |             r"\+?[\d\s\-\(\)]{10,}": lambda m: self._sanitize_phone(m.group(0)),
197 |             r"\bchild_[a-zA-Z0-9\-_]{8,}": lambda m: self._sanitize_child_id(m.group(0)),
    |                                                                                         ^ E501
198 |             r"\bparent_[a-zA-Z0-9\-_]{8,}": lambda m: self._sanitize_parent_id(m.group(0)),
199 |             r"password[=:\s]+\S+": lambda m: "password=[REDACTED]",
    |

src/infrastructure/security/secure_logger.py:198:89: E501 Line too long (91 > 88)
    |
196 |             r"\+?[\d\s\-\(\)]{10,}": lambda m: self._sanitize_phone(m.group(0)),
197 |             r"\bchild_[a-zA-Z0-9\-_]{8,}": lambda m: self._sanitize_child_id(m.group(0)),
198 |             r"\bparent_[a-zA-Z0-9\-_]{8,}": lambda m: self._sanitize_parent_id(m.group(0)),
    |                                                                                         ^^^ E501
199 |             r"password[=:\s]+\S+": lambda m: "password=[REDACTED]",
200 |             r"token[=:\s]+\S+": lambda m: "token=[REDACTED]",
    |

src/infrastructure/security/secure_logger.py:199:43: ARG005 Unused lambda argument: `m`
    |
197 |             r"\bchild_[a-zA-Z0-9\-_]{8,}": lambda m: self._sanitize_child_id(m.group(0)),
198 |             r"\bparent_[a-zA-Z0-9\-_]{8,}": lambda m: self._sanitize_parent_id(m.group(0)),
199 |             r"password[=:\s]+\S+": lambda m: "password=[REDACTED]",
    |                                           ^ ARG005
200 |             r"token[=:\s]+\S+": lambda m: "token=[REDACTED]",
201 |             r"api_key[=:\s]+\S+": lambda m: "api_key=[REDACTED]",
    |

src/infrastructure/security/secure_logger.py:200:40: ARG005 Unused lambda argument: `m`
    |
198 |             r"\bparent_[a-zA-Z0-9\-_]{8,}": lambda m: self._sanitize_parent_id(m.group(0)),
199 |             r"password[=:\s]+\S+": lambda m: "password=[REDACTED]",
200 |             r"token[=:\s]+\S+": lambda m: "token=[REDACTED]",
    |                                        ^ ARG005
201 |             r"api_key[=:\s]+\S+": lambda m: "api_key=[REDACTED]",
202 |             r"secret[=:\s]+\S+": lambda m: "secret=[REDACTED]",
    |

src/infrastructure/security/secure_logger.py:201:42: ARG005 Unused lambda argument: `m`
    |
199 |             r"password[=:\s]+\S+": lambda m: "password=[REDACTED]",
200 |             r"token[=:\s]+\S+": lambda m: "token=[REDACTED]",
201 |             r"api_key[=:\s]+\S+": lambda m: "api_key=[REDACTED]",
    |                                          ^ ARG005
202 |             r"secret[=:\s]+\S+": lambda m: "secret=[REDACTED]",
203 |         }
    |

src/infrastructure/security/secure_logger.py:202:41: ARG005 Unused lambda argument: `m`
    |
200 |             r"token[=:\s]+\S+": lambda m: "token=[REDACTED]",
201 |             r"api_key[=:\s]+\S+": lambda m: "api_key=[REDACTED]",
202 |             r"secret[=:\s]+\S+": lambda m: "secret=[REDACTED]",
    |                                         ^ ARG005
203 |         }
    |

src/infrastructure/security/secure_logger.py:218:18: UP038 Use `X | Y` in `isinstance` call instead of `(X, Y)`
    |
216 |             if isinstance(arg, dict):
217 |                 sanitized_args.append(self._sanitize_dict(arg))
218 |             elif isinstance(arg, (list, tuple)):
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP038
219 |                 sanitized_args.append(self._sanitize_list(arg))
220 |             else:
    |
    = help: Convert to `X | Y`

src/infrastructure/security/secure_logger.py:230:18: UP038 Use `X | Y` in `isinstance` call instead of `(X, Y)`
    |
228 |             elif isinstance(value, dict):
229 |                 sanitized_kwargs[key] = self._sanitize_dict(value)
230 |             elif isinstance(value, (list, tuple)):
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP038
231 |                 sanitized_kwargs[key] = self._sanitize_list(value)
232 |             else:
    |
    = help: Convert to `X | Y`

src/infrastructure/security/secure_logger.py:240:1: W293 [*] Blank line contains whitespace
    |
238 |     # Standard Logging Methods
239 |     # =====================================
240 |     
    | ^^^^ W293
241 |     def debug(self, message: str, *args, **kwargs):
242 |         """Log debug message with sanitization."""
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/secure_logger.py:243:89: E501 Line too long (96 > 88)
    |
241 |     def debug(self, message: str, *args, **kwargs):
242 |         """Log debug message with sanitization."""
243 |         msg, sanitized_args, sanitized_kwargs = self._prepare_log_data(message, *args, **kwargs)
    |                                                                                         ^^^^^^^^ E501
244 |         self.logger.debug(msg, *sanitized_args, **sanitized_kwargs)
    |

src/infrastructure/security/secure_logger.py:248:89: E501 Line too long (96 > 88)
    |
246 |     def info(self, message: str, *args, **kwargs):
247 |         """Log info message with sanitization."""
248 |         msg, sanitized_args, sanitized_kwargs = self._prepare_log_data(message, *args, **kwargs)
    |                                                                                         ^^^^^^^^ E501
249 |         self.logger.info(msg, *sanitized_args, **sanitized_kwargs)
    |

src/infrastructure/security/secure_logger.py:253:89: E501 Line too long (96 > 88)
    |
251 |     def warning(self, message: str, *args, **kwargs):
252 |         """Log warning message with sanitization."""
253 |         msg, sanitized_args, sanitized_kwargs = self._prepare_log_data(message, *args, **kwargs)
    |                                                                                         ^^^^^^^^ E501
254 |         self.logger.warning(msg, *sanitized_args, **sanitized_kwargs)
    |

src/infrastructure/security/secure_logger.py:258:89: E501 Line too long (96 > 88)
    |
256 |     def error(self, message: str, *args, **kwargs):
257 |         """Log error message with sanitization."""
258 |         msg, sanitized_args, sanitized_kwargs = self._prepare_log_data(message, *args, **kwargs)
    |                                                                                         ^^^^^^^^ E501
259 |         self.logger.error(msg, *sanitized_args, **sanitized_kwargs)
    |

src/infrastructure/security/secure_logger.py:263:89: E501 Line too long (96 > 88)
    |
261 |     def critical(self, message: str, *args, **kwargs):
262 |         """Log critical message with sanitization."""
263 |         msg, sanitized_args, sanitized_kwargs = self._prepare_log_data(message, *args, **kwargs)
    |                                                                                         ^^^^^^^^ E501
264 |         self.logger.critical(msg, *sanitized_args, **sanitized_kwargs)
    |

src/infrastructure/security/secure_logger.py:269:1: W293 [*] Blank line contains whitespace
    |
267 |     # Specialized COPPA Logging Methods
268 |     # =====================================
269 |     
    | ^^^^ W293
270 |     def log_child_activity(self, child_id: str, activity: str, details: dict = None) -> None:
271 |         """Log child activity with automatic ID sanitization."""
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/secure_logger.py:270:73: RUF013 PEP 484 prohibits implicit `Optional`
    |
268 |     # =====================================
269 |     
270 |     def log_child_activity(self, child_id: str, activity: str, details: dict = None) -> None:
    |                                                                         ^^^^ RUF013
271 |         """Log child activity with automatic ID sanitization."""
272 |         safe_child_id = self._sanitize_child_id(child_id)
    |
    = help: Convert to `T | None`

src/infrastructure/security/secure_logger.py:270:89: E501 Line too long (93 > 88)
    |
268 |     # =====================================
269 |     
270 |     def log_child_activity(self, child_id: str, activity: str, details: dict = None) -> None:
    |                                                                                         ^^^^^ E501
271 |         """Log child activity with automatic ID sanitization."""
272 |         safe_child_id = self._sanitize_child_id(child_id)
    |

src/infrastructure/security/secure_logger.py:275:89: E501 Line too long (108 > 88)
    |
273 |         if details:
274 |             sanitized_details = self._sanitize_dict(details)
275 |             self.info(f"Child activity: {safe_child_id} - {activity}", extra={"details": sanitized_details})
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^ E501
276 |         else:
277 |             self.info(f"Child activity: {safe_child_id} - {activity}")
    |

src/infrastructure/security/secure_logger.py:279:72: RUF013 PEP 484 prohibits implicit `Optional`
    |
277 |             self.info(f"Child activity: {safe_child_id} - {activity}")
278 |
279 |     def log_parent_action(self, parent_id: str, action: str, child_id: str = None) -> None:
    |                                                                        ^^^ RUF013
280 |         """Log parent action with automatic ID sanitization."""
281 |         safe_parent_id = self._sanitize_parent_id(parent_id)
    |
    = help: Convert to `T | None`

src/infrastructure/security/secure_logger.py:279:89: E501 Line too long (91 > 88)
    |
277 |             self.info(f"Child activity: {safe_child_id} - {activity}")
278 |
279 |     def log_parent_action(self, parent_id: str, action: str, child_id: str = None) -> None:
    |                                                                                         ^^^ E501
280 |         """Log parent action with automatic ID sanitization."""
281 |         safe_parent_id = self._sanitize_parent_id(parent_id)
    |

src/infrastructure/security/secure_logger.py:284:89: E501 Line too long (93 > 88)
    |
282 |         if child_id:
283 |             safe_child_id = self._sanitize_child_id(child_id)
284 |             self.info(f"Parent action: {safe_parent_id} - {action} - child: {safe_child_id}")
    |                                                                                         ^^^^^ E501
285 |         else:
286 |             self.info(f"Parent action: {safe_parent_id} - {action}")
    |

src/infrastructure/security/secure_logger.py:288:88: RUF013 PEP 484 prohibits implicit `Optional`
    |
286 |             self.info(f"Parent action: {safe_parent_id} - {action}")
287 |
288 |     def log_safety_event(self, child_id: str, event_type: str, severity: str, details: str = None) -> None:
    |                                                                                        ^^^ RUF013
289 |         """Log safety event with automatic sanitization."""
290 |         safe_child_id = self._sanitize_child_id(child_id)
    |
    = help: Convert to `T | None`

src/infrastructure/security/secure_logger.py:288:89: E501 Line too long (107 > 88)
    |
286 |             self.info(f"Parent action: {safe_parent_id} - {action}")
287 |
288 |     def log_safety_event(self, child_id: str, event_type: str, severity: str, details: str = None) -> None:
    |                                                                                         ^^^^^^^^^^^^^^^^^^^ E501
289 |         """Log safety event with automatic sanitization."""
290 |         safe_child_id = self._sanitize_child_id(child_id)
    |

src/infrastructure/security/secure_logger.py:292:89: E501 Line too long (98 > 88)
    |
290 |         safe_child_id = self._sanitize_child_id(child_id)
291 |         if details:
292 |             self.warning(f"Safety event: {safe_child_id} - {event_type} ({severity}) - {details}")
    |                                                                                         ^^^^^^^^^^ E501
293 |         else:
294 |             self.warning(f"Safety event: {safe_child_id} - {event_type} ({severity})")
    |

src/infrastructure/security/secure_logger.py:296:89: E501 Line too long (91 > 88)
    |
294 |             self.warning(f"Safety event: {safe_child_id} - {event_type} ({severity})")
295 |
296 |     def log_coppa_event(self, child_id: str, event_type: str, consent_status: str) -> None:
    |                                                                                         ^^^ E501
297 |         """Log COPPA compliance event with sanitization."""
298 |         if not requires_coppa_audit_logging():
    |

src/infrastructure/security/secure_logger.py:300:1: W293 [*] Blank line contains whitespace
    |
298 |         if not requires_coppa_audit_logging():
299 |             return  # Skip when COPPA disabled
300 |         
    | ^^^^^^^^ W293
301 |         safe_child_id = self._sanitize_child_id(child_id)
302 |         self.info(f"COPPA event: {safe_child_id} - {event_type} - consent: {consent_status}")
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/secure_logger.py:302:89: E501 Line too long (93 > 88)
    |
301 |         safe_child_id = self._sanitize_child_id(child_id)
302 |         self.info(f"COPPA event: {safe_child_id} - {event_type} - consent: {consent_status}")
    |                                                                                         ^^^^^ E501
303 |
304 |     def log_child_interaction(self, child_id: str, interaction_type: str, success: bool, **metadata):
    |

src/infrastructure/security/secure_logger.py:304:89: E501 Line too long (101 > 88)
    |
302 |         self.info(f"COPPA event: {safe_child_id} - {event_type} - consent: {consent_status}")
303 |
304 |     def log_child_interaction(self, child_id: str, interaction_type: str, success: bool, **metadata):
    |                                                                                         ^^^^^^^^^^^^^ E501
305 |         """Specialized logging for child interactions with COPPA compliance."""
306 |         safe_metadata = {
    |

src/infrastructure/security/secure_logger.py:316:89: E501 Line too long (96 > 88)
    |
314 |         masked_child_id = self._sanitize_child_id(child_id)
315 |         self.info(
316 |             f"Child interaction: {masked_child_id}, type={interaction_type}, success={success}",
    |                                                                                         ^^^^^^^^ E501
317 |             extra={"child_interaction": safe_metadata}
318 |         )
    |

src/infrastructure/security/secure_logger.py:369:63: RUF013 PEP 484 prohibits implicit `Optional`
    |
367 | # =====================================
368 |
369 | def log_child_activity(child_id: str, activity: str, details: dict = None) -> None:
    |                                                               ^^^^ RUF013
370 |     """Quick child activity logging."""
371 |     logger = get_secure_logger("child_activity")
    |
    = help: Convert to `T | None`

src/infrastructure/security/secure_logger.py:375:62: RUF013 PEP 484 prohibits implicit `Optional`
    |
375 | def log_parent_action(parent_id: str, action: str, child_id: str = None) -> None:
    |                                                              ^^^ RUF013
376 |     """Quick parent action logging."""
377 |     logger = get_secure_logger("parent_activity")
    |
    = help: Convert to `T | None`

src/infrastructure/security/secure_logger.py:381:78: RUF013 PEP 484 prohibits implicit `Optional`
    |
381 | def log_safety_event(child_id: str, event_type: str, severity: str, details: str = None) -> None:
    |                                                                              ^^^ RUF013
382 |     """Quick safety event logging."""
383 |     logger = get_secure_logger("child_safety")
    |
    = help: Convert to `T | None`

src/infrastructure/security/secure_logger.py:381:89: E501 Line too long (97 > 88)
    |
381 | def log_safety_event(child_id: str, event_type: str, severity: str, details: str = None) -> None:
    |                                                                                         ^^^^^^^^^ E501
382 |     """Quick safety event logging."""
383 |     logger = get_secure_logger("child_safety")
    |

src/infrastructure/security/secure_logger.py:418:13: TRY300 Consider moving this statement to an `else` block
    |
416 |             result = func(*args, **kwargs)
417 |             logger.debug(f"Function success: {func.__name__}")
418 |             return result
    |             ^^^^^^^^^^^^^ TRY300
419 |         except Exception as e:
420 |             logger.error(f"Function error: {func.__name__} - {type(e).__name__}")
    |

src/infrastructure/security/secure_logger.py:420:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
418 |             return result
419 |         except Exception as e:
420 |             logger.error(f"Function error: {func.__name__} - {type(e).__name__}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
421 |             raise
    |
    = help: Replace with `exception`

src/infrastructure/security/secure_logger.py:423:19: W292 [*] No newline at end of file
    |
421 |             raise
422 |
423 |     return wrapper
    |                   ^ W292
    |
    = help: Add trailing newline

src/infrastructure/security/secure_user_registration.py:18:1: E402 Module level import not at top of file
   |
16 | Secure user registration system with identity verification"""
17 |
18 | from src.infrastructure.logging_config import get_logger
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
19 |
20 | logger = get_logger(__name__, component="security")
   |

src/infrastructure/security/secure_user_registration.py:27:11: TRY003 Avoid specifying long messages outside the exception class
   |
25 | except ImportError as e:
26 |     logger.critical(f"CRITICAL ERROR: Security dependencies missing: {e}")
27 |     raise ImportError("Missing security dependencies: bcrypt, cryptography") from e
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
   |

src/infrastructure/security/secure_user_registration.py:31:5: D205 1 blank line required between summary line and description
   |
30 |   class SecureUserRegistration:
31 | /     """Secure User Registration System
32 | |     Features:
33 | |     - Password strength validation
34 | |     - Email address validation
35 | |     - Duplicate account prevention
36 | |     - Email identity verification
37 | |     - COPPA compliance for parents.
38 | |     """
   | |_______^ D205
39 |
40 |       def __init__(self) -> None:
   |
   = help: Insert single blank line

src/infrastructure/security/secure_user_registration.py:90:28: PLR2004 Magic value used in comparison, consider replacing `100` with a constant variable
   |
88 |                         f"Must be at least {self.min_parent_age} years old to register",
89 |                     )
90 |                 elif age > 100:
   |                            ^^^ PLR2004
91 |                     validation["warnings"].append(
92 |                         "Please verify the date of birth is correct",
   |

src/infrastructure/security/secure_user_registration.py:229:89: E501 Line too long (109 > 88)
    |
227 |                     datetime.utcnow() + self.verification_token_expiry
228 |                 ).isoformat(),
229 |                 "message": "Registration successful. Please check your email for verification instructions.",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^ E501
230 |                 "password_strength": password_validation["strength"],
231 |             }
    |

src/infrastructure/security/secure_user_registration.py:233:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
231 |             }
232 |         except Exception as e:
233 |             logger.error(f"Registration error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
234 |             return {
235 |                 "success": False,
    |
    = help: Replace with `exception`

src/infrastructure/security/secure_user_registration.py:266:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
264 |             }
265 |         except Exception as e:
266 |             logger.error(f"Error resending verification: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
267 |             return {
268 |                 "success": False,
    |
    = help: Replace with `exception`

src/infrastructure/security/security_headers_service.py:1:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | / from src.infrastructure.security.security_levels import SecurityLevel
2 | | from dataclasses import dataclass
3 | | from datetime import datetime, timedelta
4 | | from enum import Enum
5 | | from typing import Any
6 | |
7 | | from src.infrastructure.logging_config import get_logger
  | |________________________________________________________^ I001
8 |
9 |   logger = get_logger(__name__, component="security")
  |
  = help: Organize imports

src/infrastructure/security/security_headers_service.py:1:57: F401 [*] `src.infrastructure.security.security_levels.SecurityLevel` imported but unused
  |
1 | from src.infrastructure.security.security_levels import SecurityLevel
  |                                                         ^^^^^^^^^^^^^ F401
2 | from dataclasses import dataclass
3 | from datetime import datetime, timedelta
  |
  = help: Remove unused import: `src.infrastructure.security.security_levels.SecurityLevel`

src/infrastructure/security/security_headers_service.py:2:25: F401 [*] `dataclasses.dataclass` imported but unused
  |
1 | from src.infrastructure.security.security_levels import SecurityLevel
2 | from dataclasses import dataclass
  |                         ^^^^^^^^^ F401
3 | from datetime import datetime, timedelta
4 | from enum import Enum
  |
  = help: Remove unused import: `dataclasses.dataclass`

src/infrastructure/security/security_headers_service.py:3:22: F401 [*] `datetime.datetime` imported but unused
  |
1 | from src.infrastructure.security.security_levels import SecurityLevel
2 | from dataclasses import dataclass
3 | from datetime import datetime, timedelta
  |                      ^^^^^^^^ F401
4 | from enum import Enum
5 | from typing import Any
  |
  = help: Remove unused import

src/infrastructure/security/security_headers_service.py:3:32: F401 [*] `datetime.timedelta` imported but unused
  |
1 | from src.infrastructure.security.security_levels import SecurityLevel
2 | from dataclasses import dataclass
3 | from datetime import datetime, timedelta
  |                                ^^^^^^^^^ F401
4 | from enum import Enum
5 | from typing import Any
  |
  = help: Remove unused import

src/infrastructure/security/security_headers_service.py:4:18: F401 [*] `enum.Enum` imported but unused
  |
2 | from dataclasses import dataclass
3 | from datetime import datetime, timedelta
4 | from enum import Enum
  |                  ^^^^ F401
5 | from typing import Any
  |
  = help: Remove unused import: `enum.Enum`

src/infrastructure/security/security_headers_service.py:5:20: F401 [*] `typing.Any` imported but unused
  |
3 | from datetime import datetime, timedelta
4 | from enum import Enum
5 | from typing import Any
  |                    ^^^ F401
6 |
7 | from src.infrastructure.logging_config import get_logger
  |
  = help: Remove unused import: `typing.Any`

src/infrastructure/security/security_levels.py:8:1: W293 [*] Blank line contains whitespace
   |
 6 | class SecurityLevel(Enum):
 7 |     """Unified security levels for all security components."""
 8 |     
   | ^^^^ W293
 9 |     DEVELOPMENT = "development"
10 |     STAGING = "staging" 
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/security_levels.py:10:24: W291 [*] Trailing whitespace
   |
 9 |     DEVELOPMENT = "development"
10 |     STAGING = "staging" 
   |                        ^ W291
11 |     PRODUCTION = "production"
12 |     CHILD_STRICT = "child_strict"
   |
   = help: Remove trailing whitespace

src/infrastructure/security/security_levels.py:20:1: W293 [*] Blank line contains whitespace
   |
18 | class RequestSecurityLevel(Enum):
19 |     """Security levels for request signing."""
20 |     
   | ^^^^ W293
21 |     CHILD_INTERACTION = "child_interaction"
22 |     PARENT_ACCESS = "parent_access"
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/security_manager.py:1:89: E501 Line too long (99 > 88)
  |
1 | """Core security manager for handling passwords, tokens, and other security-critical operations."""
  |                                                                                         ^^^^^^^^^^^ E501
2 |
3 | import hashlib
  |

src/infrastructure/security/security_middleware.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Middleware أمان شامل لحماية التطبيق"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | import json
  |
  = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:15:42: F401 `starlette.types.Receive` imported but unused; consider using `importlib.util.find_spec` to test for availability
   |
13 |     from fastapi import HTTPException, Request, Response
14 |     from starlette.middleware.base import BaseHTTPMiddleware
15 |     from starlette.types import ASGIApp, Receive, Scope, Send
   |                                          ^^^^^^^ F401
16 | except ImportError as e:
17 |     logger.error(f"CRITICAL ERROR: FastAPI is required for production use: {e}")
   |
   = help: Remove unused import

src/infrastructure/security/security_middleware.py:15:51: F401 `starlette.types.Scope` imported but unused; consider using `importlib.util.find_spec` to test for availability
   |
13 |     from fastapi import HTTPException, Request, Response
14 |     from starlette.middleware.base import BaseHTTPMiddleware
15 |     from starlette.types import ASGIApp, Receive, Scope, Send
   |                                                   ^^^^^ F401
16 | except ImportError as e:
17 |     logger.error(f"CRITICAL ERROR: FastAPI is required for production use: {e}")
   |
   = help: Remove unused import

src/infrastructure/security/security_middleware.py:15:58: F401 `starlette.types.Send` imported but unused; consider using `importlib.util.find_spec` to test for availability
   |
13 |     from fastapi import HTTPException, Request, Response
14 |     from starlette.middleware.base import BaseHTTPMiddleware
15 |     from starlette.types import ASGIApp, Receive, Scope, Send
   |                                                          ^^^^ F401
16 | except ImportError as e:
17 |     logger.error(f"CRITICAL ERROR: FastAPI is required for production use: {e}")
   |
   = help: Remove unused import

src/infrastructure/security/security_middleware.py:17:5: TRY400 Use `logging.exception` instead of `logging.error`
   |
15 |     from starlette.types import ASGIApp, Receive, Scope, Send
16 | except ImportError as e:
17 |     logger.error(f"CRITICAL ERROR: FastAPI is required for production use: {e}")
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
18 |     logger.error("Install required dependencies: pip install fastapi starlette")
19 |     raise ImportError(f"Missing middleware dependencies: {e}") from e
   |
   = help: Replace with `exception`

src/infrastructure/security/security_middleware.py:18:5: TRY400 Use `logging.exception` instead of `logging.error`
   |
16 | except ImportError as e:
17 |     logger.error(f"CRITICAL ERROR: FastAPI is required for production use: {e}")
18 |     logger.error("Install required dependencies: pip install fastapi starlette")
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
19 |     raise ImportError(f"Missing middleware dependencies: {e}") from e
   |
   = help: Replace with `exception`

src/infrastructure/security/security_middleware.py:19:11: TRY003 Avoid specifying long messages outside the exception class
   |
17 |     logger.error(f"CRITICAL ERROR: FastAPI is required for production use: {e}")
18 |     logger.error("Install required dependencies: pip install fastapi starlette")
19 |     raise ImportError(f"Missing middleware dependencies: {e}") from e
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
20 |
21 | try:
   |

src/infrastructure/security/security_middleware.py:59:36: ARG002 Unused method argument: `seconds`
   |
57 |             self.data.pop(key, None)
58 |
59 |         async def setex(self, key, seconds, value):
   |                                    ^^^^^^^ ARG002
60 |             self.data[key] = value
   |

src/infrastructure/security/security_middleware.py:66:5: D415 First line should end with a period, question mark, or exclamation point
   |
65 | class RateLimiter:
66 |     """محدد معدل الطلبات لحماية من DDoS"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
67 |
68 |     def __init__(
   |
   = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:80:9: D415 First line should end with a period, question mark, or exclamation point
   |
79 |     async def is_allowed(self, client_ip: str) -> bool:
80 |         """التحقق من إذا كان العميل مسموح له بالطلب"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
81 |         key = f"rate_limit:{client_ip}"
82 |         now = int(time.time())
   |
   = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:99:57: ARG002 Unused method argument: `activity`
    |
 97 |         return True
 98 |
 99 |     async def record_suspicious_activity(self, ip: str, activity: str) -> None:
    |                                                         ^^^^^^^^ ARG002
100 |         """تسجيل النشاط المشبوه"""
101 |         key = f"suspicious_activity:{ip}"
    |

src/infrastructure/security/security_middleware.py:100:9: D415 First line should end with a period, question mark, or exclamation point
    |
 99 |     async def record_suspicious_activity(self, ip: str, activity: str) -> None:
100 |         """تسجيل النشاط المشبوه"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
101 |         key = f"suspicious_activity:{ip}"
102 |         now = datetime.now()
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:109:30: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
    |
107 |         # Check if IP should be blocked
108 |         activity_count = await self.redis.zcard(key)
109 |         if activity_count >= 5:
    |                              ^ PLR2004
110 |             block_key = f"blocked_ip:{ip}"
111 |             await self.redis.setex(
    |

src/infrastructure/security/security_middleware.py:117:9: D415 First line should end with a period, question mark, or exclamation point
    |
116 |     async def is_ip_blocked(self, ip: str) -> bool:
117 |         """التحقق من حظر IP"""
    |         ^^^^^^^^^^^^^^^^^^^^^^ D415
118 |         block_key = f"blocked_ip:{ip}"
119 |         return await self.redis.exists(block_key)
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:122:9: D415 First line should end with a period, question mark, or exclamation point
    |
121 |     async def clear_failed_attempts(self, identifier: str) -> None:
122 |         """Clear failed attempts for successful authentication"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
123 |         await self.redis.delete(f"rate_limit:{identifier}")
124 |         await self.redis.delete(f"suspicious_activity:{identifier}")
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:129:5: D415 First line should end with a period, question mark, or exclamation point
    |
128 | class SecurityValidator:
129 |     """مدقق الأمان للطلبات"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^ D415
130 |
131 |     # أنماط الهجمات الشائعة
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:132:26: RUF012 Mutable class attributes should be annotated with `typing.ClassVar`
    |
131 |       # أنماط الهجمات الشائعة
132 |       MALICIOUS_PATTERNS = [
    |  __________________________^
133 | |         r"<script[^>]*>.*?</script>",  # XSS
134 | |         r"javascript:",  # JavaScript injection
135 | |         r"vbscript:",  # VBScript injection
136 | |         r"onload\\s*=",  # Event handler injection
137 | |         r"onerror\\s*=",  # Error handler injection
138 | |         r"eval\\s*\\(",  # JavaScript eval
139 | |         r"exec\\s*\\(",  # Code execution
140 | |         r"system\\s*\\(",  # System calls
141 | |         r"union\\s+select",  # SQL injection
142 | |         r"drop\\s+table",  # SQL injection
143 | |         r"delete\\s+from",  # SQL injection
144 | |         r"insert\\s+into",  # SQL injection
145 | |         r"update\\s+.*set",  # SQL injection
146 | |         r"\\.\\./\\.\\.",  # Path traversal
147 | |         r"etc/passwd",  # Unix system files
148 | |         r"windows/system32",  # Windows system files
149 | |     ]
    | |_____^ RUF012
150 |
151 |       def __init__(self) -> None:
    |

src/infrastructure/security/security_middleware.py:157:9: D415 First line should end with a period, question mark, or exclamation point
    |
156 |     def scan_request(self, request_data: str) -> list[str]:
157 |         """فحص البيانات للبحث عن محتوى ضار"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
158 |         threats = []
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:185:9: D415 First line should end with a period, question mark, or exclamation point
    |
184 |     def validate_child_data(self, data: dict) -> list[str]:
185 |         """التحقق من بيانات الطفل للامتثال لـ COPPA"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
186 |         violations = []
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:190:22: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
    |
188 |         if "age" in data:
189 |             age = data.get("age", 0)
190 |             if age > 13:
    |                      ^^ PLR2004
191 |                 violations.append("COPPA: العمر يجب أن يكون 13 سنة أو أقل")
    |

src/infrastructure/security/security_middleware.py:197:21: PERF401 Use `list.extend` to create a transformed list
    |
195 |             for field in personal_fields:
196 |                 if field in data.get("personal_info", {}):
197 |                     violations.append(f"COPPA: لا يجوز جمع {field} للأطفال")
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PERF401
198 |
199 |         return violations
    |
    = help: Replace for loop with list.extend

src/infrastructure/security/security_middleware.py:203:5: D415 First line should end with a period, question mark, or exclamation point
    |
202 | class SecurityMiddleware(BaseHTTPMiddleware):
203 |     """Middleware الأمان الرئيسي"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
204 |
205 |     def __init__(
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:218:9: D415 First line should end with a period, question mark, or exclamation point
    |
217 |     async def dispatch(self, request: Request, call_next) -> Response:
218 |         """معالجة الطلبات مع فحص الأمان"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
219 |         start_time = time.time()
220 |         client_ip = self.get_client_ip(request)
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:226:17: TRY301 Abstract `raise` to an inner function
    |
224 |               if await self.rate_limiter.is_ip_blocked(client_ip):
225 |                   logger.warning(f"Blocked IP attempted access: {client_ip}")
226 | /                 raise HTTPException(
227 | |                     status_code=403,
228 | |                     detail="IP blocked due to suspicious activity",
229 | |                 )
    | |_________________^ TRY301
230 |
231 |               # فحص معدل الطلبات
    |

src/infrastructure/security/security_middleware.py:237:17: TRY301 Abstract `raise` to an inner function
    |
235 |                 )
236 |                 logger.warning(f"Rate limit exceeded for IP: {client_ip}")
237 |                 raise HTTPException(status_code=429, detail="Rate limit exceeded")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
238 |
239 |             # فحص الأمان للطلب
    |

src/infrastructure/security/security_middleware.py:248:17: TRY301 Abstract `raise` to an inner function
    |
246 |                       f"Security threats detected from {client_ip}: {security_issues}"
247 |                   )
248 | /                 raise HTTPException(
249 | |                     status_code=400, detail="Malicious content detected"
250 | |                 )
    | |_________________^ TRY301
251 |
252 |               # تنفيذ الطلب
    |

src/infrastructure/security/security_middleware.py:261:13: TRY300 Consider moving this statement to an `else` block
    |
259 |             self.log_request(request, response, time.time() - start_time, client_ip)
260 |
261 |             return response
    |             ^^^^^^^^^^^^^^^ TRY300
262 |         except HTTPException:
263 |             # إعادة إلقاء HTTPException كما هي
    |

src/infrastructure/security/security_middleware.py:266:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
264 |             raise
265 |         except (ValueError, TypeError, AttributeError) as e:
266 |             logger.error(f"Security middleware data processing error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
267 |             # في حالة خطأ، السماح بمرور الطلب مع تسجيل تفصيلي
268 |             return await call_next(request)
    |
    = help: Replace with `exception`

src/infrastructure/security/security_middleware.py:273:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
271 |             # Log stack trace for debugging
272 |             logger.exception("Security middleware unexpected error details:")
273 |             raise HTTPException(status_code=500, detail="Internal security error")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
274 |
275 |     def get_client_ip(self, request: Request) -> str:
    |

src/infrastructure/security/security_middleware.py:276:9: D415 First line should end with a period, question mark, or exclamation point
    |
275 |     def get_client_ip(self, request: Request) -> str:
276 |         """الحصول على IP العميل"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
277 |         # البحث في headers المختلفة للحصول على IP الحقيقي
278 |         forwarded_for = request.headers.get("X-Forwarded-For")
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:289:9: D415 First line should end with a period, question mark, or exclamation point
    |
288 |     async def scan_request_security(self, request: Request) -> list[str]:
289 |         """فحص أمان الطلب"""
    |         ^^^^^^^^^^^^^^^^^^^^ D415
290 |         threats = []
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:327:9: D415 First line should end with a period, question mark, or exclamation point
    |
326 |     def add_security_headers(self, response: Response) -> Response:
327 |         """إضافة headers الأمان"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
328 |         security_headers = {
329 |             "X-Content-Type-Options": "nosniff",
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:356:9: D415 First line should end with a period, question mark, or exclamation point
    |
354 |         client_ip: str,
355 |     ) -> None:
356 |         """تسجيل الطلب"""
    |         ^^^^^^^^^^^^^^^^^ D415
357 |         log_data = {
358 |             "timestamp": datetime.now().isoformat(),
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:371:5: D415 First line should end with a period, question mark, or exclamation point
    |
370 | class ChildSafetySecurityMiddleware(SecurityMiddleware):
371 |     """Middleware أمان مخصص لحماية الأطفال"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
372 |
373 |     def __init__(
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:389:9: D415 First line should end with a period, question mark, or exclamation point
    |
388 |     async def dispatch(self, request: Request, call_next) -> Response:
389 |         """معالجة خاصة للطلبات المتعلقة بالأطفال"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
390 |         # التحقق من أن الطلب متعلق بالأطفال
391 |         if self.is_child_request(request):
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:406:9: D415 First line should end with a period, question mark, or exclamation point
    |
405 |     def is_child_request(self, request: Request) -> bool:
406 |         """التحقق من أن الطلب متعلق بالأطفال"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
407 |         child_patterns = [
408 |             "/children/",
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:416:9: D415 First line should end with a period, question mark, or exclamation point
    |
415 |     async def validate_child_content(self, request: Request) -> None:
416 |         """فحص المحتوى للتأكد من مناسبته للأطفال"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
417 |         if request.method in ["POST", "PUT", "PATCH"]:
418 |             try:
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:437:89: E501 Line too long (90 > 88)
    |
435 |                         if word.lower() in body_str.lower():
436 |                             logger.warning(
437 |                                 f"Inappropriate content detected in child request: {word}"
    |                                                                                         ^^ E501
438 |                             )
439 |                             raise HTTPException(
    |

src/infrastructure/security/security_middleware.py:450:5: D415 First line should end with a period, question mark, or exclamation point
    |
448 |     child_safety: bool = False,
449 | ) -> SecurityMiddleware:
450 |     """إنشاء middleware الأمان"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
451 |     if not redis_client and REDIS_AVAILABLE:
452 |         try:
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:473:5: D415 First line should end with a period, question mark, or exclamation point
    |
472 | def setup_security_middleware(app, redis_client=None, child_safety: bool = True):
473 |     """إعداد middleware الأمان للتطبيق"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
474 |     middleware = create_security_middleware(redis_client, child_safety)
475 |     middleware.app = app  # Set the app reference
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:505:5: D415 First line should end with a period, question mark, or exclamation point
    |
504 | def get_security_config() -> dict:
505 |     """الحصول على إعدادات الأمان الحالية"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
506 |     return DEFAULT_SECURITY_CONFIG.copy()
    |
    = help: Add closing punctuation

src/infrastructure/security/security_middleware.py:510:5: D415 First line should end with a period, question mark, or exclamation point
    |
509 | async def get_security_status(redis_client=None) -> dict:
510 |     """الحصول على حالة نظام الأمان"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
511 |     status = {
512 |         "redis_available": REDIS_AVAILABLE,
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Unified SQL Injection Protection System"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | from src.infrastructure.security.validation.query_validator import QueryValidationResult
  |
  = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:3:1: I001 [*] Import block is un-sorted or un-formatted
   |
 1 |   """Unified SQL Injection Protection System"""
 2 |
 3 | / from src.infrastructure.security.validation.query_validator import QueryValidationResult
 4 | | from collections import defaultdict
 5 | | from datetime import datetime
 6 | | from typing import Any
 7 | |
 8 | | from src.infrastructure.logging_config import get_logger
   | |________________________________________________________^ I001
 9 |
10 |   logger = get_logger(__name__, component="security")
   |
   = help: Organize imports

src/infrastructure/security/sql_injection_protection.py:19:45: ARG002 Unused method argument: `input_type`
   |
18 |     class MockInputSanitizer:
19 |         def sanitize(self, user_input: str, input_type: str = "text"):
   |                                             ^^^^^^^^^^ ARG002
20 |             class MockResult:
21 |                 def __init__(self):
   |

src/infrastructure/security/sql_injection_protection.py:39:46: ARG002 Unused method argument: `context`
   |
38 |     class MockQueryValidator:
39 |         def validate_query(self, query: str, context: str | None = None):
   |                                              ^^^^^^^ ARG002
40 |             class MockResult:
41 |                 def __init__(self):
   |

src/infrastructure/security/sql_injection_protection.py:54:5: D415 First line should end with a period, question mark, or exclamation point
   |
53 | class SQLInjectionProtection:
54 |     """Unified SQL injection protection combining prevention, monitoring, and configuration"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
55 |
56 |     def __init__(self) -> None:
   |
   = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:54:89: E501 Line too long (94 > 88)
   |
53 | class SQLInjectionProtection:
54 |     """Unified SQL injection protection combining prevention, monitoring, and configuration"""
   |                                                                                         ^^^^^^ E501
55 |
56 |     def __init__(self) -> None:
   |

src/infrastructure/security/sql_injection_protection.py:77:9: D415 First line should end with a period, question mark, or exclamation point
   |
76 |     def validate_query(self, query: str, context: str | None = None) -> dict[str, Any]:
77 |         """Validate SQL query for injection attempts"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
78 |         # Validate query
79 |         result = self.query_validator.validate_query(query, context)
   |
   = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:96:9: D415 First line should end with a period, question mark, or exclamation point
   |
94 |         self, user_input: str, input_type: str = "text"
95 |     ) -> dict[str, Any]:
96 |         """Sanitize user input before use in queries"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
97 |         result = self.input_sanitizer.sanitize(user_input, input_type)
   |
   = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:108:9: D415 First line should end with a period, question mark, or exclamation point
    |
107 |     def check_ip_blocked(self, ip_address: str) -> bool:
108 |         """Check if IP is blocked due to attack attempts"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
109 |         return ip_address in self.blocked_ips
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:112:9: D415 First line should end with a period, question mark, or exclamation point
    |
111 |     def block_ip(self, ip_address: str, reason: str = "SQL injection attempts") -> None:
112 |         """Block an IP address"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^ D415
113 |         if self.config.get("enable_ip_blocking", True):
114 |             self.blocked_ips.add(ip_address)
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:118:9: D415 First line should end with a period, question mark, or exclamation point
    |
117 |     def unblock_ip(self, ip_address: str) -> None:
118 |         """Unblock an IP address"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
119 |         if ip_address in self.blocked_ips:
120 |             self.blocked_ips.remove(ip_address)
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:130:9: D415 First line should end with a period, question mark, or exclamation point
    |
128 |         context: str | None = None,
129 |     ) -> None:
130 |         """Record attack attempt from specific IP"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
131 |         now = datetime.utcnow()
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:163:9: D415 First line should end with a period, question mark, or exclamation point
    |
161 |         self, query: str, threats: list[str], context: str | None = None
162 |     ) -> None:
163 |         """Log potential SQL injection attempt"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
164 |         if not self.config.get("enable_logging", True):
165 |             return
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:172:66: PLR2004 Magic value used in comparison, consider replacing `100` with a constant variable
    |
170 |             "timestamp": datetime.utcnow().isoformat(),
171 |             "threats": threats,
172 |             "query_preview": query[:100] + "..." if len(query) > 100 else query,
    |                                                                  ^^^ PLR2004
173 |             "context": context,
174 |             "risk_assessment": self._assess_risk_level(threats),
    |

src/infrastructure/security/sql_injection_protection.py:184:27: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
    |
183 |         # Additional logging for high-risk attempts
184 |         if len(threats) > 2 or any("DROP" in threat.upper() for threat in threats):
    |                           ^ PLR2004
185 |             logger.critical(f"HIGH-RISK SQL injection attempt detected: {log_data}")
    |

src/infrastructure/security/sql_injection_protection.py:188:9: D415 First line should end with a period, question mark, or exclamation point
    |
187 |     def _assess_risk_level(self, threats: list[str]) -> str:
188 |         """Assess risk level based on detected threats"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
189 |         if not threats:
190 |             return "none"
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:208:9: D415 First line should end with a period, question mark, or exclamation point
    |
206 |         self, query: str, child_id: str | None = None
207 |     ) -> dict[str, Any]:
208 |         """Special validation for queries involving child data (COPPA compliance)"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
209 |         # Standard validation first
210 |         result = self.validate_query(query, f"child_data:{child_id}")
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:221:17: PERF401 Use a list comprehension to create a transformed list
    |
219 |           for operation in dangerous_operations:
220 |               if operation in query_upper:
221 | /                 child_violations.append(
222 | |                     f"Dangerous operation on child data: {operation}"
223 | |                 )
    | |_________________^ PERF401
224 |
225 |           # Check for data export attempts
    |
    = help: Replace for loop with list comprehension

src/infrastructure/security/sql_injection_protection.py:229:17: PERF401 Use `list.extend` to create a transformed list
    |
227 |         for pattern in export_patterns:
228 |             if pattern in query_upper:
229 |                 child_violations.append(f"Potential data export attempt: {pattern}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PERF401
230 |
231 |         if child_violations:
    |
    = help: Replace for loop with list.extend

src/infrastructure/security/sql_injection_protection.py:242:9: D415 First line should end with a period, question mark, or exclamation point
    |
241 |     def get_protection_stats(self) -> dict[str, Any]:
242 |         """Get protection statistics"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
243 |         now = datetime.utcnow()
244 |         recent_attacks = 0
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:252:71: PLR2004 Magic value used in comparison, consider replacing `86400` with a constant variable
    |
250 |                     attempt
251 |                     for attempt in ip_attempts
252 |                     if (now - attempt["timestamp"]).total_seconds() < 86400
    |                                                                       ^^^^^ PLR2004
253 |                 ]
254 |             )
    |

src/infrastructure/security/sql_injection_protection.py:267:9: D415 First line should end with a period, question mark, or exclamation point
    |
266 |     def update_configuration(self, config: dict[str, Any]) -> None:
267 |         """Update protection configuration"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
268 |         old_config = self.config.copy()
269 |         self.config.update(config)
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:277:9: D415 First line should end with a period, question mark, or exclamation point
    |
276 |     def reset_protection_state(self) -> None:
277 |         """Reset protection state (for testing or maintenance)"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
278 |         self.attack_attempts.clear()
279 |         self.blocked_ips.clear()
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:283:9: D415 First line should end with a period, question mark, or exclamation point
    |
282 |     def export_security_report(self) -> dict[str, Any]:
283 |         """Export comprehensive security report"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
284 |         return {
285 |             "report_timestamp": datetime.utcnow().isoformat(),
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:297:25: C401 Unnecessary generator (rewrite as a set comprehension)
    |
295 |                       ),
296 |                       "threat_types": list(
297 | /                         set(
298 | |                             threat
299 | |                             for attempt in attempts
300 | |                             for threat in attempt["threats"]
301 | |                         )
    | |_________________________^ C401
302 |                       ),
303 |                   }
    |
    = help: Rewrite as a set comprehension

src/infrastructure/security/sql_injection_protection.py:316:5: D415 First line should end with a period, question mark, or exclamation point
    |
315 | def get_sql_protection() -> SQLInjectionProtection:
316 |     """Get or create SQL injection protection instance"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
317 |     global _sql_protection
318 |     if _sql_protection is None:
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:317:12: PLW0603 Using the global statement to update `_sql_protection` is discouraged
    |
315 | def get_sql_protection() -> SQLInjectionProtection:
316 |     """Get or create SQL injection protection instance"""
317 |     global _sql_protection
    |            ^^^^^^^^^^^^^^^ PLW0603
318 |     if _sql_protection is None:
319 |         _sql_protection = SQLInjectionProtection()
    |

src/infrastructure/security/sql_injection_protection.py:324:5: D415 First line should end with a period, question mark, or exclamation point
    |
323 | def validate_query_safe(query: str, context: str | None = None) -> bool:
324 |     """Quick validation check - returns True if safe"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
325 |     protection = get_sql_protection()
326 |     result = protection.validate_query(query, context)
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:331:5: D415 First line should end with a period, question mark, or exclamation point
    |
330 | def sanitize_user_input(user_input: str, input_type: str = "text") -> str:
331 |     """Quick sanitization - returns sanitized string"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
332 |     protection = get_sql_protection()
333 |     result = protection.sanitize_input(user_input, input_type)
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:338:5: D415 First line should end with a period, question mark, or exclamation point
    |
337 | def validate_child_query_safe(query: str, child_id: str | None = None) -> bool:
338 |     """Quick validation for child data queries"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
339 |     protection = get_sql_protection()
340 |     result = protection.validate_child_query(query, child_id)
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:347:5: D415 First line should end with a period, question mark, or exclamation point
    |
345 |     config: dict[str, Any] | None = None,
346 | ) -> SQLInjectionProtection:
347 |     """Setup SQL injection protection with configuration"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
348 |     protection = get_sql_protection()
349 |     if config:
    |
    = help: Add closing punctuation

src/infrastructure/security/sql_injection_protection.py:360:1: E402 Module level import not at top of file
    |
359 | # Real implementations for database security
360 | from dataclasses import dataclass
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
361 | from typing import List, Dict, Any
    |

src/infrastructure/security/sql_injection_protection.py:360:1: I001 [*] Import block is un-sorted or un-formatted
    |
359 |   # Real implementations for database security
360 | / from dataclasses import dataclass
361 | | from typing import List, Dict, Any
    | |__________________________________^ I001
362 |
363 |   @dataclass
    |
    = help: Organize imports

src/infrastructure/security/sql_injection_protection.py:361:1: E402 Module level import not at top of file
    |
359 | # Real implementations for database security
360 | from dataclasses import dataclass
361 | from typing import List, Dict, Any
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
362 |
363 | @dataclass
    |

src/infrastructure/security/sql_injection_protection.py:361:1: UP035 `typing.List` is deprecated, use `list` instead
    |
359 | # Real implementations for database security
360 | from dataclasses import dataclass
361 | from typing import List, Dict, Any
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
362 |
363 | @dataclass
    |

src/infrastructure/security/sql_injection_protection.py:361:1: UP035 `typing.Dict` is deprecated, use `dict` instead
    |
359 | # Real implementations for database security
360 | from dataclasses import dataclass
361 | from typing import List, Dict, Any
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
362 |
363 | @dataclass
    |

src/infrastructure/security/sql_injection_protection.py:365:46: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
363 | @dataclass
364 | class SecureQueryBuilder:
365 |     def build_insert(self, table: str, data: Dict[str, Any]) -> tuple:
    |                                              ^^^^ UP006
366 |         # Mock implementation - safe placeholder
367 |         return "INSERT INTO ? VALUES (?)", [table, data]
    |
    = help: Replace with `dict`

src/infrastructure/security/sql_injection_protection.py:368:1: W293 [*] Blank line contains whitespace
    |
366 |         # Mock implementation - safe placeholder
367 |         return "INSERT INTO ? VALUES (?)", [table, data]
368 |     
    | ^^^^ W293
369 |     def build_update(self, table: str, data: Dict[str, Any], where: Dict[str, Any]) -> tuple:
370 |         # Mock implementation - safe placeholder  
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/sql_injection_protection.py:369:46: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
367 |         return "INSERT INTO ? VALUES (?)", [table, data]
368 |     
369 |     def build_update(self, table: str, data: Dict[str, Any], where: Dict[str, Any]) -> tuple:
    |                                              ^^^^ UP006
370 |         # Mock implementation - safe placeholder  
371 |         return "UPDATE ? SET ? WHERE ?", [table, data, where]
    |
    = help: Replace with `dict`

src/infrastructure/security/sql_injection_protection.py:369:69: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
367 |         return "INSERT INTO ? VALUES (?)", [table, data]
368 |     
369 |     def build_update(self, table: str, data: Dict[str, Any], where: Dict[str, Any]) -> tuple:
    |                                                                     ^^^^ UP006
370 |         # Mock implementation - safe placeholder  
371 |         return "UPDATE ? SET ? WHERE ?", [table, data, where]
    |
    = help: Replace with `dict`

src/infrastructure/security/sql_injection_protection.py:369:89: E501 Line too long (93 > 88)
    |
367 |         return "INSERT INTO ? VALUES (?)", [table, data]
368 |     
369 |     def build_update(self, table: str, data: Dict[str, Any], where: Dict[str, Any]) -> tuple:
    |                                                                                         ^^^^^ E501
370 |         # Mock implementation - safe placeholder  
371 |         return "UPDATE ? SET ? WHERE ?", [table, data, where]
    |

src/infrastructure/security/sql_injection_protection.py:370:49: W291 [*] Trailing whitespace
    |
369 |     def build_update(self, table: str, data: Dict[str, Any], where: Dict[str, Any]) -> tuple:
370 |         # Mock implementation - safe placeholder  
    |                                                 ^^ W291
371 |         return "UPDATE ? SET ? WHERE ?", [table, data, where]
    |
    = help: Remove trailing whitespace

src/infrastructure/security/sql_injection_protection.py:372:1: W293 [*] Blank line contains whitespace
    |
370 |         # Mock implementation - safe placeholder  
371 |         return "UPDATE ? SET ? WHERE ?", [table, data, where]
372 |         
    | ^^^^^^^^ W293
373 |     def build_select(self, table: str, columns: List[str], where: Dict[str, Any] = None, limit: int = None) -> tuple:
374 |         # Mock implementation - safe placeholder
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/sql_injection_protection.py:373:49: UP006 [*] Use `list` instead of `List` for type annotation
    |
371 |         return "UPDATE ? SET ? WHERE ?", [table, data, where]
372 |         
373 |     def build_select(self, table: str, columns: List[str], where: Dict[str, Any] = None, limit: int = None) -> tuple:
    |                                                 ^^^^ UP006
374 |         # Mock implementation - safe placeholder
375 |         return "SELECT ? FROM ? WHERE ? LIMIT ?", [columns, table, where, limit]
    |
    = help: Replace with `list`

src/infrastructure/security/sql_injection_protection.py:373:67: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
371 |         return "UPDATE ? SET ? WHERE ?", [table, data, where]
372 |         
373 |     def build_select(self, table: str, columns: List[str], where: Dict[str, Any] = None, limit: int = None) -> tuple:
    |                                                                   ^^^^ UP006
374 |         # Mock implementation - safe placeholder
375 |         return "SELECT ? FROM ? WHERE ? LIMIT ?", [columns, table, where, limit]
    |
    = help: Replace with `dict`

src/infrastructure/security/sql_injection_protection.py:373:67: RUF013 PEP 484 prohibits implicit `Optional`
    |
371 |         return "UPDATE ? SET ? WHERE ?", [table, data, where]
372 |         
373 |     def build_select(self, table: str, columns: List[str], where: Dict[str, Any] = None, limit: int = None) -> tuple:
    |                                                                   ^^^^^^^^^^^^^^ RUF013
374 |         # Mock implementation - safe placeholder
375 |         return "SELECT ? FROM ? WHERE ? LIMIT ?", [columns, table, where, limit]
    |
    = help: Convert to `T | None`

src/infrastructure/security/sql_injection_protection.py:373:89: E501 Line too long (117 > 88)
    |
371 |         return "UPDATE ? SET ? WHERE ?", [table, data, where]
372 |         
373 |     def build_select(self, table: str, columns: List[str], where: Dict[str, Any] = None, limit: int = None) -> tuple:
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
374 |         # Mock implementation - safe placeholder
375 |         return "SELECT ? FROM ? WHERE ? LIMIT ?", [columns, table, where, limit]
    |

src/infrastructure/security/sql_injection_protection.py:373:97: RUF013 PEP 484 prohibits implicit `Optional`
    |
371 |         return "UPDATE ? SET ? WHERE ?", [table, data, where]
372 |         
373 |     def build_select(self, table: str, columns: List[str], where: Dict[str, Any] = None, limit: int = None) -> tuple:
    |                                                                                                 ^^^ RUF013
374 |         # Mock implementation - safe placeholder
375 |         return "SELECT ? FROM ? WHERE ? LIMIT ?", [columns, table, where, limit]
    |
    = help: Convert to `T | None`

src/infrastructure/security/sql_injection_protection.py:382:34: ARG002 Unused method argument: `query`
    |
380 | # Enhanced mock SQL protection with proper interface
381 | class EnhancedSQLProtection:
382 |     def validate_sql_query(self, query: str, params: Dict[str, Any] = None) -> QueryValidationResult:
    |                                  ^^^^^ ARG002
383 |         return QueryValidationResult(safe=True, errors=[], warnings=[])
    |

src/infrastructure/security/sql_injection_protection.py:382:46: ARG002 Unused method argument: `params`
    |
380 | # Enhanced mock SQL protection with proper interface
381 | class EnhancedSQLProtection:
382 |     def validate_sql_query(self, query: str, params: Dict[str, Any] = None) -> QueryValidationResult:
    |                                              ^^^^^^ ARG002
383 |         return QueryValidationResult(safe=True, errors=[], warnings=[])
    |

src/infrastructure/security/sql_injection_protection.py:382:54: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
380 | # Enhanced mock SQL protection with proper interface
381 | class EnhancedSQLProtection:
382 |     def validate_sql_query(self, query: str, params: Dict[str, Any] = None) -> QueryValidationResult:
    |                                                      ^^^^ UP006
383 |         return QueryValidationResult(safe=True, errors=[], warnings=[])
    |
    = help: Replace with `dict`

src/infrastructure/security/sql_injection_protection.py:382:54: RUF013 PEP 484 prohibits implicit `Optional`
    |
380 | # Enhanced mock SQL protection with proper interface
381 | class EnhancedSQLProtection:
382 |     def validate_sql_query(self, query: str, params: Dict[str, Any] = None) -> QueryValidationResult:
    |                                                      ^^^^^^^^^^^^^^ RUF013
383 |         return QueryValidationResult(safe=True, errors=[], warnings=[])
    |
    = help: Convert to `T | None`

src/infrastructure/security/sql_injection_protection.py:382:89: E501 Line too long (101 > 88)
    |
380 | # Enhanced mock SQL protection with proper interface
381 | class EnhancedSQLProtection:
382 |     def validate_sql_query(self, query: str, params: Dict[str, Any] = None) -> QueryValidationResult:
    |                                                                                         ^^^^^^^^^^^^^ E501
383 |         return QueryValidationResult(safe=True, errors=[], warnings=[])
    |

src/infrastructure/security/sql_injection_protection.py:384:1: W293 [*] Blank line contains whitespace
    |
382 |     def validate_sql_query(self, query: str, params: Dict[str, Any] = None) -> QueryValidationResult:
383 |         return QueryValidationResult(safe=True, errors=[], warnings=[])
384 |     
    | ^^^^ W293
385 |     def validate_column_name(self, name: str) -> bool:
386 |         return name.replace('_', '').replace('-', '').isalnum()
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/sql_injection_protection.py:387:1: W293 [*] Blank line contains whitespace
    |
385 |     def validate_column_name(self, name: str) -> bool:
386 |         return name.replace('_', '').replace('-', '').isalnum()
387 |     
    | ^^^^ W293
388 |     def validate_table_name(self, name: str) -> bool:
389 |         return name.replace('_', '').replace('-', '').isalnum()
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/sql_injection_protection.py:390:1: W293 [*] Blank line contains whitespace
    |
388 |     def validate_table_name(self, name: str) -> bool:
389 |         return name.replace('_', '').replace('-', '').isalnum()
390 |         
    | ^^^^^^^^ W293
391 |     def sanitize_input(self, value: str, input_type: str):
392 |         class Result:
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/sql_injection_protection.py:391:42: ARG002 Unused method argument: `input_type`
    |
389 |         return name.replace('_', '').replace('-', '').isalnum()
390 |         
391 |     def sanitize_input(self, value: str, input_type: str):
    |                                          ^^^^^^^^^^ ARG002
392 |         class Result:
393 |             def __init__(self):
    |

src/infrastructure/security/sql_injection_protection.py:399:1: W293 [*] Blank line contains whitespace
    |
397 |                 self.modifications = []
398 |         return Result()
399 |     
    | ^^^^ W293
400 |     def log_security_event(self, event_type: str, details: Dict[str, Any], severity: str):
401 |         pass  # Mock logging
    |
    = help: Remove whitespace from blank line

src/infrastructure/security/sql_injection_protection.py:400:60: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
398 |         return Result()
399 |     
400 |     def log_security_event(self, event_type: str, details: Dict[str, Any], severity: str):
    |                                                            ^^^^ UP006
401 |         pass  # Mock logging
    |
    = help: Replace with `dict`

src/infrastructure/security/sql_injection_protection.py:400:89: E501 Line too long (90 > 88)
    |
398 |         return Result()
399 |     
400 |     def log_security_event(self, event_type: str, details: Dict[str, Any], severity: str):
    |                                                                                         ^^ E501
401 |         pass  # Mock logging
    |

src/infrastructure/security/sql_injection_protection.py:403:1: E731 Do not assign a `lambda` expression, use a `def`
    |
401 |         pass  # Mock logging
402 |
403 | get_sql_injection_prevention = lambda: EnhancedSQLProtection()
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E731
    |
    = help: Rewrite `get_sql_injection_prevention` as a `def`

src/infrastructure/security/tests/test_path_traversal_fixes.py:23:5: D415 First line should end with a period, question mark, or exclamation point
   |
22 | class TestPathValidator:
23 |     """Test the core path validation functionality"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
24 |
25 |     def setup_method(self) -> None:
   |
   = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:26:9: D415 First line should end with a period, question mark, or exclamation point
   |
25 |     def setup_method(self) -> None:
26 |         """Setup test environment"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
27 |         self.temp_dir = tempfile.mkdtemp()
28 |         self.policy = PathPolicy(
   |
   = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:37:9: D415 First line should end with a period, question mark, or exclamation point
   |
36 |     def test_basic_path_validation(self) -> None:
37 |         """Test basic valid paths are accepted"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
38 |         valid_path = os.path.join(self.temp_dir, "test.txt")
39 |         assert self.validator.validate_path(valid_path)
   |
   = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:38:22: PTH118 `os.path.join()` should be replaced by `Path` with `/` operator
   |
36 |     def test_basic_path_validation(self) -> None:
37 |         """Test basic valid paths are accepted"""
38 |         valid_path = os.path.join(self.temp_dir, "test.txt")
   |                      ^^^^^^^^^^^^ PTH118
39 |         assert self.validator.validate_path(valid_path)
   |

src/infrastructure/security/tests/test_path_traversal_fixes.py:42:9: D415 First line should end with a period, question mark, or exclamation point
   |
41 |     def test_directory_traversal_prevention(self) -> None:
42 |         """Test that directory traversal attempts are blocked"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
43 |         traversal_attempts = [
44 |             "../../../etc/passwd",
   |
   = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:62:9: D415 First line should end with a period, question mark, or exclamation point
   |
61 |     def test_null_byte_injection_prevention(self) -> None:
62 |         """Test null byte injection attempts are blocked"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
63 |         null_byte_attempts = [
64 |             "file.txt\\x00.php",
   |
   = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:74:9: D415 First line should end with a period, question mark, or exclamation point
   |
73 |     def test_path_length_validation(self) -> None:
74 |         """Test maximum path length enforcement"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
75 |         long_path = "a" * 300  # Exceeds 255 char limit
76 |         assert not self.validator.validate_path(long_path)
   |
   = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:79:9: D415 First line should end with a period, question mark, or exclamation point
   |
78 |     def test_extension_validation(self) -> None:
79 |         """Test file extension restrictions"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
80 |         valid_path = os.path.join(self.temp_dir, "test.txt")
81 |         invalid_path = os.path.join(self.temp_dir, "test.exe")
   |
   = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:80:22: PTH118 `os.path.join()` should be replaced by `Path` with `/` operator
   |
78 |     def test_extension_validation(self) -> None:
79 |         """Test file extension restrictions"""
80 |         valid_path = os.path.join(self.temp_dir, "test.txt")
   |                      ^^^^^^^^^^^^ PTH118
81 |         invalid_path = os.path.join(self.temp_dir, "test.exe")
82 |         assert self.validator.validate_path(valid_path)
   |

src/infrastructure/security/tests/test_path_traversal_fixes.py:81:24: PTH118 `os.path.join()` should be replaced by `Path` with `/` operator
   |
79 |         """Test file extension restrictions"""
80 |         valid_path = os.path.join(self.temp_dir, "test.txt")
81 |         invalid_path = os.path.join(self.temp_dir, "test.exe")
   |                        ^^^^^^^^^^^^ PTH118
82 |         assert self.validator.validate_path(valid_path)
83 |         assert not self.validator.validate_path(invalid_path)
   |

src/infrastructure/security/tests/test_path_traversal_fixes.py:86:9: D415 First line should end with a period, question mark, or exclamation point
   |
85 |     def test_symlink_prevention(self) -> None:
86 |         """Test symlink blocking when disabled"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
87 |         # Create a test file and symlink
88 |         test_file = os.path.join(self.temp_dir, "test.txt")
   |
   = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:88:21: PTH118 `os.path.join()` should be replaced by `Path` with `/` operator
   |
86 |         """Test symlink blocking when disabled"""
87 |         # Create a test file and symlink
88 |         test_file = os.path.join(self.temp_dir, "test.txt")
   |                     ^^^^^^^^^^^^ PTH118
89 |         with open(test_file, "w") as f:
90 |             f.write("test")
   |

src/infrastructure/security/tests/test_path_traversal_fixes.py:89:14: PTH123 `open()` should be replaced by `Path.open()`
   |
87 |         # Create a test file and symlink
88 |         test_file = os.path.join(self.temp_dir, "test.txt")
89 |         with open(test_file, "w") as f:
   |              ^^^^ PTH123
90 |             f.write("test")
   |

src/infrastructure/security/tests/test_path_traversal_fixes.py:92:24: PTH118 `os.path.join()` should be replaced by `Path` with `/` operator
   |
90 |             f.write("test")
91 |
92 |         symlink_path = os.path.join(self.temp_dir, "link.txt")
   |                        ^^^^^^^^^^^^ PTH118
93 |         try:
94 |             os.symlink(test_file, symlink_path)
   |

src/infrastructure/security/tests/test_path_traversal_fixes.py:101:9: D415 First line should end with a period, question mark, or exclamation point
    |
100 |     def test_path_sanitization(self) -> None:
101 |         """Test path sanitization functionality"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
102 |         test_cases = [
103 |             ("../test.txt", "test.txt"),
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:115:9: D415 First line should end with a period, question mark, or exclamation point
    |
114 |     def test_safe_path_generation(self) -> None:
115 |         """Test generation of safe absolute paths"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
116 |         user_input = "subdir/file.txt"
117 |         safe_path = self.validator.get_safe_path(user_input, self.temp_dir)
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:124:5: D415 First line should end with a period, question mark, or exclamation point
    |
123 | class TestSecureFileOperations:
124 |     """Test secure file operations wrapper"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
125 |
126 |     def setup_method(self) -> None:
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:127:9: D415 First line should end with a period, question mark, or exclamation point
    |
126 |     def setup_method(self) -> None:
127 |         """Setup test environment"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
128 |         self.temp_dir = tempfile.mkdtemp()
129 |         self.policy = PathPolicy(
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:139:9: D415 First line should end with a period, question mark, or exclamation point
    |
138 |     def test_safe_file_opening(self) -> None:
139 |         """Test secure file opening"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
140 |         # Create a test file
141 |         test_file = os.path.join(self.temp_dir, "test.txt")
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:141:21: PTH118 `os.path.join()` should be replaced by `Path` with `/` operator
    |
139 |         """Test secure file opening"""
140 |         # Create a test file
141 |         test_file = os.path.join(self.temp_dir, "test.txt")
    |                     ^^^^^^^^^^^^ PTH118
142 |         with open(test_file, "w") as f:
143 |             f.write("test content")
    |

src/infrastructure/security/tests/test_path_traversal_fixes.py:142:14: PTH123 `open()` should be replaced by `Path.open()`
    |
140 |         # Create a test file
141 |         test_file = os.path.join(self.temp_dir, "test.txt")
142 |         with open(test_file, "w") as f:
    |              ^^^^ PTH123
143 |             f.write("test content")
    |

src/infrastructure/security/tests/test_path_traversal_fixes.py:151:9: D415 First line should end with a period, question mark, or exclamation point
    |
150 |     def test_unsafe_file_opening_blocked(self) -> None:
151 |         """Test that unsafe file operations are blocked"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
152 |         with pytest.raises(SecurityError):
153 |             self.secure_ops.safe_open("../../../etc/passwd", "r")
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:156:9: D415 First line should end with a period, question mark, or exclamation point
    |
155 |     def test_safe_file_existence_check(self) -> None:
156 |         """Test secure file existence checking"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
157 |         # Create a test file
158 |         test_file = os.path.join(self.temp_dir, "exists.txt")
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:158:21: PTH118 `os.path.join()` should be replaced by `Path` with `/` operator
    |
156 |         """Test secure file existence checking"""
157 |         # Create a test file
158 |         test_file = os.path.join(self.temp_dir, "exists.txt")
    |                     ^^^^^^^^^^^^ PTH118
159 |         with open(test_file, "w") as f:
160 |             f.write("test")
    |

src/infrastructure/security/tests/test_path_traversal_fixes.py:159:14: PTH123 `open()` should be replaced by `Path.open()`
    |
157 |         # Create a test file
158 |         test_file = os.path.join(self.temp_dir, "exists.txt")
159 |         with open(test_file, "w") as f:
    |              ^^^^ PTH123
160 |             f.write("test")
    |

src/infrastructure/security/tests/test_path_traversal_fixes.py:167:9: D415 First line should end with a period, question mark, or exclamation point
    |
166 |     def test_safe_file_removal(self) -> None:
167 |         """Test secure file removal"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
168 |         # Create a test file
169 |         test_file = os.path.join(self.temp_dir, "remove_me.txt")
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:169:21: PTH118 `os.path.join()` should be replaced by `Path` with `/` operator
    |
167 |         """Test secure file removal"""
168 |         # Create a test file
169 |         test_file = os.path.join(self.temp_dir, "remove_me.txt")
    |                     ^^^^^^^^^^^^ PTH118
170 |         with open(test_file, "w") as f:
171 |             f.write("test")
    |

src/infrastructure/security/tests/test_path_traversal_fixes.py:170:14: PTH123 `open()` should be replaced by `Path.open()`
    |
168 |         # Create a test file
169 |         test_file = os.path.join(self.temp_dir, "remove_me.txt")
170 |         with open(test_file, "w") as f:
    |              ^^^^ PTH123
171 |             f.write("test")
    |

src/infrastructure/security/tests/test_path_traversal_fixes.py:174:20: PTH110 `os.path.exists()` should be replaced by `Path.exists()`
    |
173 |         assert self.secure_ops.safe_remove("remove_me.txt")
174 |         assert not os.path.exists(test_file)
    |                    ^^^^^^^^^^^^^^ PTH110
175 |
176 |         # Test that traversal attempts fail
    |
    = help: Replace with `Path(...).exists()`

src/infrastructure/security/tests/test_path_traversal_fixes.py:180:9: D415 First line should end with a period, question mark, or exclamation point
    |
179 |     def test_safe_directory_listing(self) -> None:
180 |         """Test secure directory listing"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
181 |         # Create test files
182 |         for i in range(3):
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:183:25: PTH118 `os.path.join()` should be replaced by `Path` with `/` operator
    |
181 |         # Create test files
182 |         for i in range(3):
183 |             test_file = os.path.join(self.temp_dir, f"file{i}.txt")
    |                         ^^^^^^^^^^^^ PTH118
184 |             with open(test_file, "w") as f:
185 |                 f.write(f"content {i}")
    |

src/infrastructure/security/tests/test_path_traversal_fixes.py:184:18: PTH123 `open()` should be replaced by `Path.open()`
    |
182 |         for i in range(3):
183 |             test_file = os.path.join(self.temp_dir, f"file{i}.txt")
184 |             with open(test_file, "w") as f:
    |                  ^^^^ PTH123
185 |                 f.write(f"content {i}")
    |

src/infrastructure/security/tests/test_path_traversal_fixes.py:188:30: PLR2004 Magic value used in comparison, consider replacing `3` with a constant variable
    |
187 |         files = self.secure_ops.safe_listdir(".")
188 |         assert len(files) >= 3
    |                              ^ PLR2004
189 |
190 |         # Test that traversal attempts return empty list
    |

src/infrastructure/security/tests/test_path_traversal_fixes.py:196:5: D415 First line should end with a period, question mark, or exclamation point
    |
195 | class TestChildSafeValidator:
196 |     """Test the child-safe default configuration"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
197 |
198 |     def test_child_safe_validator_creation(self) -> None:
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:199:9: D415 First line should end with a period, question mark, or exclamation point
    |
198 |     def test_child_safe_validator_creation(self) -> None:
199 |         """Test creation of child-safe validator"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
200 |         validator = create_child_safe_validator()
201 |         assert validator is not None
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:203:52: PLR2004 Magic value used in comparison, consider replacing `255` with a constant variable
    |
201 |         assert validator is not None
202 |         assert not validator.policy.allow_symlinks
203 |         assert validator.policy.max_path_length == 255
    |                                                    ^^^ PLR2004
204 |
205 |     def test_child_safe_extensions(self) -> None:
    |

src/infrastructure/security/tests/test_path_traversal_fixes.py:206:9: D415 First line should end with a period, question mark, or exclamation point
    |
205 |     def test_child_safe_extensions(self) -> None:
206 |         """Test that only child-safe extensions are allowed"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
207 |         validator = create_child_safe_validator()
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:223:5: D415 First line should end with a period, question mark, or exclamation point
    |
222 | class TestIntegrationWithExistingCode:
223 |     """Test integration with existing vulnerable code"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
224 |
225 |     def test_request_logging_middleware_integration(self) -> None:
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:226:9: D415 First line should end with a period, question mark, or exclamation point
    |
225 |     def test_request_logging_middleware_integration(self) -> None:
226 |         """Test that request logging middleware uses path validation"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
227 |         try:
228 |             from src.presentation.api.middleware.request_logging import (
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:228:13: PLC0415 `import` should be at the top-level of a file
    |
226 |           """Test that request logging middleware uses path validation"""
227 |           try:
228 | /             from src.presentation.api.middleware.request_logging import (
229 | |                 RequestLoggingMiddleware,
230 | |             )
    | |_____________^ PLC0415
231 |
232 |               # Mock the FastAPI app
    |

src/infrastructure/security/tests/test_path_traversal_fixes.py:244:9: D415 First line should end with a period, question mark, or exclamation point
    |
243 |     def test_audit_logger_integration(self) -> None:
244 |         """Test that audit logger uses secure file operations"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
245 |         # This would test the actual audit logger integration
246 |         # but requires more complex setup with temp directories
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:250:9: D415 First line should end with a period, question mark, or exclamation point
    |
249 |     def test_conversation_repository_integration(self) -> None:
250 |         """Test that conversation repository uses secure file operations"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
251 |         # This would test the actual repository integration
252 |         # but requires database setup
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:257:5: D415 First line should end with a period, question mark, or exclamation point
    |
256 | class TestSecurityReporting:
257 |     """Test security monitoring and reporting"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
258 |
259 |     def test_traversal_attempt_logging(self, caplog) -> None:
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:260:9: D415 First line should end with a period, question mark, or exclamation point
    |
259 |     def test_traversal_attempt_logging(self, caplog) -> None:
260 |         """Test that traversal attempts are properly logged"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
261 |         validator = create_child_safe_validator()
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:273:9: D415 First line should end with a period, question mark, or exclamation point
    |
272 |     def test_security_metrics(self) -> None:
273 |         """Test security metrics collection"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
274 |         validator = create_child_safe_validator()
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:294:5: D415 First line should end with a period, question mark, or exclamation point
    |
292 | # Convenience functions for testing
293 | def test_global_convenience_functions() -> None:
294 |     """Test the global convenience functions"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
295 |     # Test that global functions work
296 |     assert not validate_path("../../../etc/passwd")
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:303:5: D415 First line should end with a period, question mark, or exclamation point
    |
301 | # Performance tests
302 | class TestPerformance:
303 |     """Test performance of path validation"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
304 |
305 |     def test_validation_performance(self) -> None:
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:306:9: D415 First line should end with a period, question mark, or exclamation point
    |
305 |     def test_validation_performance(self) -> None:
306 |         """Test that validation is fast enough for production"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
307 |         import time
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:307:9: PLC0415 `import` should be at the top-level of a file
    |
305 |     def test_validation_performance(self) -> None:
306 |         """Test that validation is fast enough for production"""
307 |         import time
    |         ^^^^^^^^^^^ PLC0415
308 |
309 |         validator = create_child_safe_validator()
    |

src/infrastructure/security/tests/test_path_traversal_fixes.py:329:5: D415 First line should end with a period, question mark, or exclamation point
    |
327 | # Test configuration and security hardening
328 | class TestSecurityConfiguration:
329 |     """Test security configuration and hardening measures"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
330 |
331 |     def test_default_security_policy(self) -> None:
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:332:9: D415 First line should end with a period, question mark, or exclamation point
    |
331 |     def test_default_security_policy(self) -> None:
332 |         """Test that default security policy is secure"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
333 |         validator = create_child_safe_validator()
334 |         policy = validator.policy
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:338:42: PLR2004 Magic value used in comparison, consider replacing `255` with a constant variable
    |
336 |         # Verify secure defaults
337 |         assert not policy.allow_symlinks
338 |         assert policy.max_path_length <= 255
    |                                          ^^^ PLR2004
339 |         assert len(policy.allowed_extensions) > 0
340 |         assert ".exe" not in policy.allowed_extensions
    |

src/infrastructure/security/tests/test_path_traversal_fixes.py:343:9: D415 First line should end with a period, question mark, or exclamation point
    |
342 |     def test_child_safety_measures(self) -> None:
343 |         """Test child safety specific measures"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
344 |         validator = create_child_safe_validator()
    |
    = help: Add closing punctuation

src/infrastructure/security/tests/test_path_traversal_fixes.py:365:9: D415 First line should end with a period, question mark, or exclamation point
    |
364 |     def test_error_handling_security(self) -> None:
365 |         """Test that error handling doesn't leak information"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
366 |         validator = create_child_safe_validator()
    |
    = help: Add closing punctuation

src/infrastructure/security/token_service.py:16:45: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
14 |     """Service for creating, verifying, and managing JWT tokens."""
15 |
16 |     def __init__(self, settings: Settings = Depends(get_settings)) -> None:
   |                                             ^^^^^^^^^^^^^^^^^^^^^ B008
17 |         self.settings = settings
18 |         self.secret_key = self.settings.security.SECRET_KEY
   |

src/infrastructure/security/token_service.py:27:58: PLR2004 Magic value used in comparison, consider replacing `32` with a constant variable
   |
25 |         )
26 |
27 |         if not self.secret_key or len(self.secret_key) < 32:
   |                                                          ^^ PLR2004
28 |             raise ValueError("SECRET_KEY must be at least 32 characters long")
   |

src/infrastructure/security/token_service.py:28:19: TRY003 Avoid specifying long messages outside the exception class
   |
27 |         if not self.secret_key or len(self.secret_key) < 32:
28 |             raise ValueError("SECRET_KEY must be at least 32 characters long")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
29 |
30 |     def create_access_token(self, user_data: dict[str, Any]) -> str:
   |

src/infrastructure/security/token_service.py:46:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
44 |             )
45 |         except (KeyError, TypeError) as e:
46 |             logger.error(f"Invalid user data for token creation: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
47 |             raise ValueError("Failed to create access token")
48 |         except JWTError as e:
   |
   = help: Replace with `exception`

src/infrastructure/security/token_service.py:47:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
45 |         except (KeyError, TypeError) as e:
46 |             logger.error(f"Invalid user data for token creation: {e}")
47 |             raise ValueError("Failed to create access token")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
48 |         except JWTError as e:
49 |             logger.error(f"JWT encoding error: {e}")
   |

src/infrastructure/security/token_service.py:47:19: TRY003 Avoid specifying long messages outside the exception class
   |
45 |         except (KeyError, TypeError) as e:
46 |             logger.error(f"Invalid user data for token creation: {e}")
47 |             raise ValueError("Failed to create access token")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
48 |         except JWTError as e:
49 |             logger.error(f"JWT encoding error: {e}")
   |

src/infrastructure/security/token_service.py:49:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
47 |             raise ValueError("Failed to create access token")
48 |         except JWTError as e:
49 |             logger.error(f"JWT encoding error: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
50 |             raise ValueError("Failed to create access token")
   |
   = help: Replace with `exception`

src/infrastructure/security/token_service.py:50:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
48 |         except JWTError as e:
49 |             logger.error(f"JWT encoding error: {e}")
50 |             raise ValueError("Failed to create access token")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
51 |
52 |     def create_refresh_token(self, user_data: dict[str, Any]) -> str:
   |

src/infrastructure/security/token_service.py:50:19: TRY003 Avoid specifying long messages outside the exception class
   |
48 |         except JWTError as e:
49 |             logger.error(f"JWT encoding error: {e}")
50 |             raise ValueError("Failed to create access token")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
51 |
52 |     def create_refresh_token(self, user_data: dict[str, Any]) -> str:
   |

src/infrastructure/security/token_service.py:67:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
65 |             )
66 |         except (KeyError, TypeError) as e:
67 |             logger.error(f"Invalid user data for refresh token: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
68 |             raise ValueError("Failed to create refresh token")
69 |         except JWTError as e:
   |
   = help: Replace with `exception`

src/infrastructure/security/token_service.py:68:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
66 |         except (KeyError, TypeError) as e:
67 |             logger.error(f"Invalid user data for refresh token: {e}")
68 |             raise ValueError("Failed to create refresh token")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
69 |         except JWTError as e:
70 |             logger.error(f"JWT encoding error: {e}")
   |

src/infrastructure/security/token_service.py:68:19: TRY003 Avoid specifying long messages outside the exception class
   |
66 |         except (KeyError, TypeError) as e:
67 |             logger.error(f"Invalid user data for refresh token: {e}")
68 |             raise ValueError("Failed to create refresh token")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
69 |         except JWTError as e:
70 |             logger.error(f"JWT encoding error: {e}")
   |

src/infrastructure/security/token_service.py:70:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
68 |             raise ValueError("Failed to create refresh token")
69 |         except JWTError as e:
70 |             logger.error(f"JWT encoding error: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
71 |             raise ValueError("Failed to create refresh token")
   |
   = help: Replace with `exception`

src/infrastructure/security/token_service.py:71:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
69 |         except JWTError as e:
70 |             logger.error(f"JWT encoding error: {e}")
71 |             raise ValueError("Failed to create refresh token")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
72 |
73 |     def verify_token(self, token: str) -> dict[str, Any]:
   |

src/infrastructure/security/token_service.py:71:19: TRY003 Avoid specifying long messages outside the exception class
   |
69 |         except JWTError as e:
70 |             logger.error(f"JWT encoding error: {e}")
71 |             raise ValueError("Failed to create refresh token")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
72 |
73 |     def verify_token(self, token: str) -> dict[str, Any]:
   |

src/infrastructure/security/token_service.py:79:13: TRY300 Consider moving this statement to an `else` block
   |
77 |                 token, self.secret_key, algorithms=[self.algorithm]
78 |             )
79 |             return payload
   |             ^^^^^^^^^^^^^^ TRY300
80 |         except JWTError as e:
81 |             logger.error(f"JWT verification error: {e}")
   |

src/infrastructure/security/token_service.py:79:20: RET504 Unnecessary assignment to `payload` before `return` statement
   |
77 |                 token, self.secret_key, algorithms=[self.algorithm]
78 |             )
79 |             return payload
   |                    ^^^^^^^ RET504
80 |         except JWTError as e:
81 |             logger.error(f"JWT verification error: {e}")
   |
   = help: Remove unnecessary assignment

src/infrastructure/security/token_service.py:81:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
79 |             return payload
80 |         except JWTError as e:
81 |             logger.error(f"JWT verification error: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
82 |             raise ValueError("Invalid token")
   |
   = help: Replace with `exception`

src/infrastructure/security/token_service.py:82:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
80 |         except JWTError as e:
81 |             logger.error(f"JWT verification error: {e}")
82 |             raise ValueError("Invalid token")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
83 |
84 |     def refresh_access_token(self, refresh_token: str) -> str:
   |

src/infrastructure/security/token_service.py:82:19: TRY003 Avoid specifying long messages outside the exception class
   |
80 |         except JWTError as e:
81 |             logger.error(f"JWT verification error: {e}")
82 |             raise ValueError("Invalid token")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
83 |
84 |     def refresh_access_token(self, refresh_token: str) -> str:
   |

src/infrastructure/security/token_service.py:88:1: W293 [*] Blank line contains whitespace
   |
86 |         try:
87 |             payload = self.verify_token(refresh_token)
88 |             
   | ^^^^^^^^^^^^ W293
89 |             if payload.get("type") != "refresh":
90 |                 raise ValueError("Invalid refresh token")
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/token_service.py:90:17: TRY301 Abstract `raise` to an inner function
   |
89 |             if payload.get("type") != "refresh":
90 |                 raise ValueError("Invalid refresh token")
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
91 |             
92 |             user_data = {
   |

src/infrastructure/security/token_service.py:90:23: TRY003 Avoid specifying long messages outside the exception class
   |
89 |             if payload.get("type") != "refresh":
90 |                 raise ValueError("Invalid refresh token")
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
91 |             
92 |             user_data = {
   |

src/infrastructure/security/token_service.py:91:1: W293 [*] Blank line contains whitespace
   |
89 |             if payload.get("type") != "refresh":
90 |                 raise ValueError("Invalid refresh token")
91 |             
   | ^^^^^^^^^^^^ W293
92 |             user_data = {
93 |                 "id": payload["sub"],
   |
   = help: Remove whitespace from blank line

src/infrastructure/security/token_service.py:101:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
 99 |             raise
100 |         except Exception as e:
101 |             logger.error(f"Token refresh error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
102 |             raise ValueError("Failed to refresh token")
    |
    = help: Replace with `exception`

src/infrastructure/security/token_service.py:102:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
100 |         except Exception as e:
101 |             logger.error(f"Token refresh error: {e}")
102 |             raise ValueError("Failed to refresh token")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
    |

src/infrastructure/security/token_service.py:102:19: TRY003 Avoid specifying long messages outside the exception class
    |
100 |         except Exception as e:
101 |             logger.error(f"Token refresh error: {e}")
102 |             raise ValueError("Failed to refresh token")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
    |

src/infrastructure/security/token_service.py:102:56: W292 [*] No newline at end of file
    |
100 |         except Exception as e:
101 |             logger.error(f"Token refresh error: {e}")
102 |             raise ValueError("Failed to refresh token")
    |                                                        ^ W292
    |
    = help: Add trailing newline

src/infrastructure/security/validation/__init__.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Security Validation Package
2 | | Enterprise-grade input and query validation services
3 | | """
  | |___^ D205
4 |
5 |   from .query_validator import (
  |
  = help: Insert single blank line

src/infrastructure/security/validation/__init__.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Security Validation Package
2 | | Enterprise-grade input and query validation services
3 | | """
  | |___^ D415
4 |
5 |   from .query_validator import (
  |
  = help: Add closing punctuation

src/infrastructure/security/validation/__init__.py:15:2: W292 [*] No newline at end of file
   |
13 |     "SQLQueryValidator",
14 |     "get_query_validator",
15 | ]
   |  ^ W292
   |
   = help: Add trailing newline

src/infrastructure/security/validation/query_validator.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """🔒 SQL Query Validation Service
2 | | Advanced SQL injection prevention and query safety
3 | | """
  | |___^ D205
4 |
5 |   import re
  |
  = help: Insert single blank line

src/infrastructure/security/validation/query_validator.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """🔒 SQL Query Validation Service
2 | | Advanced SQL injection prevention and query safety
3 | | """
  | |___^ D415
4 |
5 |   import re
  |
  = help: Add closing punctuation

src/infrastructure/security/validation/query_validator.py:17:5: D415 First line should end with a period, question mark, or exclamation point
   |
15 | @dataclass
16 | class QueryValidationResult:
17 |     """Result of SQL query validation"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
18 |
19 |     safe: bool
   |
   = help: Add closing punctuation

src/infrastructure/security/validation/query_validator.py:27:5: D205 1 blank line required between summary line and description
   |
26 |   class SQLQueryValidator:
27 | /     """Enterprise-grade SQL injection prevention
28 | |     Features:
29 | |     - Advanced SQL injection pattern detection
30 | |     - NoSQL injection prevention
31 | |     - Parameterized query validation
32 | |     - Query structure analysis
33 | |     - Threat level assessment
34 | |     """
   | |_______^ D205
35 |
36 |       def __init__(self) -> None:
   |
   = help: Insert single blank line

src/infrastructure/security/validation/query_validator.py:27:5: D415 First line should end with a period, question mark, or exclamation point
   |
26 |   class SQLQueryValidator:
27 | /     """Enterprise-grade SQL injection prevention
28 | |     Features:
29 | |     - Advanced SQL injection pattern detection
30 | |     - NoSQL injection prevention
31 | |     - Parameterized query validation
32 | |     - Query structure analysis
33 | |     - Threat level assessment
34 | |     """
   | |_______^ D415
35 |
36 |       def __init__(self) -> None:
   |
   = help: Add closing punctuation

src/infrastructure/security/validation/query_validator.py:85:9: D415 First line should end with a period, question mark, or exclamation point
   |
83 |         self, params: dict[str, Any]
84 |     ) -> QueryValidationResult:
85 |         """Validate query parameters for SQL injection"""
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
86 |         validation = QueryValidationResult(
87 |             safe=True, errors=[], warnings=[], threat_level="low"
   |
   = help: Add closing punctuation

src/infrastructure/security/validation/query_validator.py:136:9: D415 First line should end with a period, question mark, or exclamation point
    |
135 |     def validate_table_name(self, table_name: str) -> bool:
136 |         """Validate table name against whitelist"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
137 |         # Must be alphanumeric with underscores
138 |         if not re.match(r"^[a-zA-Z_][a-zA-Z0-9_]*$", table_name):
    |
    = help: Add closing punctuation

src/infrastructure/security/validation/query_validator.py:150:9: D415 First line should end with a period, question mark, or exclamation point
    |
149 |     def validate_column_name(self, column_name: str) -> bool:
150 |         """Validate column name format"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
151 |         if not re.match(r"^[a-zA-Z_][a-zA-Z0-9_]*$", column_name):
152 |             logger.warning(f"Invalid column name format: {column_name}")
    |
    = help: Add closing punctuation

src/infrastructure/security/validation/query_validator.py:181:9: D415 First line should end with a period, question mark, or exclamation point
    |
179 |         self, conditions: dict[str, Any]
180 |     ) -> tuple[str, list[Any]]:
181 |         """Create safe parameterized WHERE clause"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
182 |         where_parts = []
183 |         params = []
    |
    = help: Add closing punctuation

src/infrastructure/security/validation/query_validator.py:188:23: TRY003 Avoid specifying long messages outside the exception class
    |
186 |             # Validate column name
187 |             if not self.validate_column_name(column):
188 |                 raise ValueError(f"Invalid column name: {column}")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
189 |
190 |             # Validate value safety
    |

src/infrastructure/security/validation/query_validator.py:194:27: TRY003 Avoid specifying long messages outside the exception class
    |
192 |                   param_validation = self.validate_query_parameters({column: value})
193 |                   if not param_validation.safe:
194 |                       raise ValueError(
    |  ___________________________^
195 | |                         f"Unsafe value for column {column}: {param_validation.errors}"
196 | |                     )
    | |_____________________^ TRY003
197 |
198 |               where_parts.append(f"{column} = ?")
    |

src/infrastructure/security/validation/query_validator.py:207:9: D415 First line should end with a period, question mark, or exclamation point
    |
205 |         self, table_name: str, conditions: dict[str, Any]
206 |     ) -> QueryValidationResult:
207 |         """Special validation for queries involving child data"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
208 |         validation = QueryValidationResult(
209 |             safe=True, errors=[], warnings=[], threat_level="low"
    |
    = help: Add closing punctuation

src/infrastructure/security/validation/query_validator.py:241:9: D415 First line should end with a period, question mark, or exclamation point
    |
239 |         severity: str = "medium",
240 |     ) -> None:
241 |         """Log security event for monitoring"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
242 |         security_event = {
243 |             "timestamp": datetime.utcnow().isoformat(),
    |
    = help: Add closing punctuation

src/infrastructure/security/validation/query_validator.py:242:9: F841 Local variable `security_event` is assigned to but never used
    |
240 |     ) -> None:
241 |         """Log security event for monitoring"""
242 |         security_event = {
    |         ^^^^^^^^^^^^^^ F841
243 |             "timestamp": datetime.utcnow().isoformat(),
244 |             "event_type": event_type,
    |
    = help: Remove assignment to unused variable `security_event`

src/infrastructure/security/validation/query_validator.py:257:9: ERA001 Found commented-out code
    |
256 |         # In production, this would also send to SIEM/monitoring system
257 |         # Example: send_to_security_monitoring(security_event)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ ERA001
258 |
259 |     def sanitize_query_string(self, query: str) -> str:
    |
    = help: Remove commented-out code

src/infrastructure/security/validation/query_validator.py:260:9: D415 First line should end with a period, question mark, or exclamation point
    |
259 |     def sanitize_query_string(self, query: str) -> str:
260 |         """Sanitize a raw query string (use with extreme caution)"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
261 |         # Remove SQL comments
262 |         query = re.sub(r"--.*$", "", query, flags=re.MULTILINE)
    |
    = help: Add closing punctuation

src/infrastructure/security/validation/query_validator.py:277:22: RUF013 PEP 484 prohibits implicit `Optional`
    |
276 |     def get_safe_limit_offset(
277 |         self, limit: int = None, offset: int = None
    |                      ^^^ RUF013
278 |     ) -> tuple[int, int]:
279 |         """Get safe LIMIT and OFFSET values"""
    |
    = help: Convert to `T | None`

src/infrastructure/security/validation/query_validator.py:277:42: RUF013 PEP 484 prohibits implicit `Optional`
    |
276 |     def get_safe_limit_offset(
277 |         self, limit: int = None, offset: int = None
    |                                          ^^^ RUF013
278 |     ) -> tuple[int, int]:
279 |         """Get safe LIMIT and OFFSET values"""
    |
    = help: Convert to `T | None`

src/infrastructure/security/validation/query_validator.py:279:9: D415 First line should end with a period, question mark, or exclamation point
    |
277 |         self, limit: int = None, offset: int = None
278 |     ) -> tuple[int, int]:
279 |         """Get safe LIMIT and OFFSET values"""
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
280 |         # Default and maximum limits for child safety
281 |         DEFAULT_LIMIT = 50
    |
    = help: Add closing punctuation

src/infrastructure/security/validation/query_validator.py:281:9: N806 Variable `DEFAULT_LIMIT` in function should be lowercase
    |
279 |         """Get safe LIMIT and OFFSET values"""
280 |         # Default and maximum limits for child safety
281 |         DEFAULT_LIMIT = 50
    |         ^^^^^^^^^^^^^ N806
282 |         MAX_LIMIT = 1000
283 |         MAX_OFFSET = 10000
    |

src/infrastructure/security/validation/query_validator.py:282:9: N806 Variable `MAX_LIMIT` in function should be lowercase
    |
280 |         # Default and maximum limits for child safety
281 |         DEFAULT_LIMIT = 50
282 |         MAX_LIMIT = 1000
    |         ^^^^^^^^^ N806
283 |         MAX_OFFSET = 10000
    |

src/infrastructure/security/validation/query_validator.py:283:9: N806 Variable `MAX_OFFSET` in function should be lowercase
    |
281 |         DEFAULT_LIMIT = 50
282 |         MAX_LIMIT = 1000
283 |         MAX_OFFSET = 10000
    |         ^^^^^^^^^^ N806
284 |
285 |         # Validate and sanitize limit
    |

src/infrastructure/security/validation/query_validator.py:323:5: D415 First line should end with a period, question mark, or exclamation point
    |
322 | def get_query_validator() -> SQLQueryValidator:
323 |     """Get global query validator instance"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
324 |     global _query_validator
325 |     if _query_validator is None:
    |
    = help: Add closing punctuation

src/infrastructure/security/validation/query_validator.py:324:12: PLW0603 Using the global statement to update `_query_validator` is discouraged
    |
322 | def get_query_validator() -> SQLQueryValidator:
323 |     """Get global query validator instance"""
324 |     global _query_validator
    |            ^^^^^^^^^^^^^^^^ PLW0603
325 |     if _query_validator is None:
326 |         _query_validator = SQLQueryValidator()
    |

src/infrastructure/security/validation/query_validator.py:332:5: D415 First line should end with a period, question mark, or exclamation point
    |
330 | # Convenience functions for common operations
331 | def validate_params(params: dict[str, Any]) -> QueryValidationResult:
332 |     """Quick parameter validation"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
333 |     validator = get_query_validator()
334 |     return validator.validate_query_parameters(params)
    |
    = help: Add closing punctuation

src/infrastructure/security/validation/query_validator.py:338:5: D415 First line should end with a period, question mark, or exclamation point
    |
337 | def is_safe_table(table_name: str) -> bool:
338 |     """Quick table name validation"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
339 |     validator = get_query_validator()
340 |     return validator.validate_table_name(table_name)
    |
    = help: Add closing punctuation

src/infrastructure/security/validation/query_validator.py:344:5: D415 First line should end with a period, question mark, or exclamation point
    |
343 | def is_safe_column(column_name: str) -> bool:
344 |     """Quick column name validation"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
345 |     validator = get_query_validator()
346 |     return validator.validate_column_name(column_name)
    |
    = help: Add closing punctuation

src/infrastructure/security/validation/query_validator.py:350:5: D415 First line should end with a period, question mark, or exclamation point
    |
349 | def create_safe_where(conditions: dict[str, Any]) -> tuple[str, list[Any]]:
350 |     """Quick safe WHERE clause creation"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
351 |     validator = get_query_validator()
352 |     return validator.create_safe_where_clause(conditions)
    |
    = help: Add closing punctuation

src/infrastructure/security/validation/query_validator.py:358:5: D415 First line should end with a period, question mark, or exclamation point
    |
356 |     table_name: str, conditions: dict[str, Any]
357 | ) -> QueryValidationResult:
358 |     """Quick child data query validation"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
359 |     validator = get_query_validator()
360 |     return validator.validate_child_data_query(table_name, conditions)
    |
    = help: Add closing punctuation

src/infrastructure/security/vault_client.py:50:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
48 |             self._initialized = True
49 |         except Exception as e:
50 |             raise ConnectionError(f"Failed to initialize Vault client: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
51 |
52 |     def _init_client(self) -> Any:
   |

src/infrastructure/security/vault_client.py:50:19: TRY003 Avoid specifying long messages outside the exception class
   |
48 |             self._initialized = True
49 |         except Exception as e:
50 |             raise ConnectionError(f"Failed to initialize Vault client: {e}")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
51 |
52 |     def _init_client(self) -> Any:
   |

src/infrastructure/security/vault_client.py:54:19: TRY003 Avoid specifying long messages outside the exception class
   |
52 |       def _init_client(self) -> Any:
53 |           if not VAULT_AVAILABLE:
54 |               raise ImportError(
   |  ___________________^
55 | |                 "hvac package not installed. Install with: pip install hvac",
56 | |             )
   | |_____________^ TRY003
57 |           """Initialize the HVAC client (synchronous operation)."""
58 |           client = hvac.Client(
   |

src/infrastructure/security/vault_client.py:63:19: TRY003 Avoid specifying long messages outside the exception class
   |
61 |         )
62 |         if not client.is_authenticated():
63 |             raise ConnectionError("Vault authentication failed")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
64 |         return client
   |

src/infrastructure/security/vault_client.py:84:19: TRY003 Avoid specifying long messages outside the exception class
   |
82 |             await self.initialize()
83 |         if not self.client:
84 |             raise ValueError("Vault client not initialized.")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
85 |         try:
86 |             # Run in thread pool to avoid blocking
   |

src/infrastructure/security/vault_client.py:95:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
93 |             return response["data"]["data"]
94 |         except Exception as e:
95 |             raise ValueError(f"Failed to retrieve secret '{secret_path}': {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
96 |
97 |     async def put_secret(
   |

src/infrastructure/security/vault_client.py:95:19: TRY003 Avoid specifying long messages outside the exception class
   |
93 |             return response["data"]["data"]
94 |         except Exception as e:
95 |             raise ValueError(f"Failed to retrieve secret '{secret_path}': {e}")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
96 |
97 |     async def put_secret(
   |

src/infrastructure/security/vault_client.py:114:19: TRY003 Avoid specifying long messages outside the exception class
    |
112 |             await self.initialize()
113 |         if not self.client:
114 |             raise ValueError("Vault client not initialized.")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
115 |         try:
116 |             await asyncio.get_event_loop().run_in_executor(
    |

src/infrastructure/security/vault_client.py:124:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
122 |             )
123 |         except Exception as e:
124 |             raise ValueError(f"Failed to store secret '{secret_path}': {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
    |

src/infrastructure/security/vault_client.py:124:19: TRY003 Avoid specifying long messages outside the exception class
    |
122 |             )
123 |         except Exception as e:
124 |             raise ValueError(f"Failed to store secret '{secret_path}': {e}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
    |

src/infrastructure/services/data_retention_service.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """COPPA-Compliant Data Retention and Automated Deletion Service
2 | | This service handles the automatic deletion of child data after 90 days
3 | | as required by COPPA, with comprehensive audit trails and parent notifications.
4 | | """
  | |___^ D205
5 |
6 |   import asyncio
  |
  = help: Insert single blank line

src/infrastructure/services/data_retention_service.py:102:9: D205 1 blank line required between summary line and description
    |
101 |       async def schedule_daily_retention_check(self) -> None:
102 | /         """Daily scheduled task to check for data due for deletion.
103 | |         This should be called by a scheduler (cron, celery, etc.) daily.
104 | |         """
    | |___________^ D205
105 |           logger.info("Starting daily data retention check")
106 |           current_time = datetime.utcnow()
    |
    = help: Insert single blank line

src/infrastructure/services/data_retention_service.py:114:38: PERF102 When using only the values of a dict use the `values()` method
    |
112 |         pending_deletions = []
113 |
114 |         for _retention_id, record in self.retention_records.items():
    |                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PERF102
115 |             if record["status"] != RetentionStatus.ACTIVE.value:
116 |                 continue
    |
    = help: Replace `.items()` with `.values()`

src/infrastructure/services/data_retention_service.py:166:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
164 |               logger.info(f"Deletion notification sent: {record['retention_id']}")
165 |           except Exception as e:
166 | /             logger.error(
167 | |                 f"Failed to send deletion notification: {record['retention_id']}, {e}",
168 | |             )
    | |_____________^ TRY400
169 |
170 |       async def _send_email_notification(self, notification_data: dict[str, Any]) -> None:
    |
    = help: Replace with `exception`

src/infrastructure/services/data_retention_service.py:172:9: F841 Local variable `email_content` is assigned to but never used
    |
170 |     async def _send_email_notification(self, notification_data: dict[str, Any]) -> None:
171 |         """Send email notification to parent."""
172 |         email_content = f"""Subject: Important: Your Child's Data Will Be Deleted in {self.notification_days_before} Days
    |         ^^^^^^^^^^^^^ F841
173 | Dear Parent/Guardian,
    |
    = help: Remove assignment to unused variable `email_content`

src/infrastructure/services/data_retention_service.py:172:89: E501 Line too long (121 > 88)
    |
170 |     async def _send_email_notification(self, notification_data: dict[str, Any]) -> None:
171 |         """Send email notification to parent."""
172 |         email_content = f"""Subject: Important: Your Child's Data Will Be Deleted in {self.notification_days_before} Days
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
173 | Dear Parent/Guardian,
    |

src/infrastructure/services/data_retention_service.py:175:89: E501 Line too long (90 > 88)
    |
173 | Dear Parent/Guardian,
174 |
175 | This is an automated notification regarding your child's data in the AI Teddy Bear system.
    |                                                                                         ^^ E501
176 |
177 | Child ID: {notification_data["child_id"]}
    |

src/infrastructure/services/data_retention_service.py:226:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
224 |               record["status"] = "deletion_failed"
225 |               record["deletion_error"] = str(e)
226 | /             logger.error(
227 | |                 f"Failed to process scheduled deletion: {record['retention_id']}, {e}",
228 | |             )
    | |_____________^ TRY400
229 |
230 |       async def _export_child_data(self, record: dict[str, Any]) -> dict[str, Any]:
    |
    = help: Replace with `exception`

src/infrastructure/services/data_retention_service.py:234:13: F841 Local variable `export_data` is assigned to but never used
    |
232 |         try:
233 |             # Create export data structure
234 |             export_data = {
    |             ^^^^^^^^^^^ F841
235 |                 "child_id": record["child_id"],
236 |                 "export_date": datetime.utcnow().isoformat(),
    |
    = help: Remove assignment to unused variable `export_data`

src/infrastructure/services/data_retention_service.py:257:13: TRY300 Consider moving this statement to an `else` block
    |
256 |             logger.info(f"Data export completed: {record['retention_id']}")
257 |             return export_result
    |             ^^^^^^^^^^^^^^^^^^^^ TRY300
258 |         except Exception as e:
259 |             logger.error(f"Data export failed: {record['retention_id']}, {e}")
    |

src/infrastructure/services/data_retention_service.py:259:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
257 |             return export_result
258 |         except Exception as e:
259 |             logger.error(f"Data export failed: {record['retention_id']}, {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
260 |             return {
261 |                 "error": str(e),
    |
    = help: Replace with `exception`

src/infrastructure/services/data_retention_service.py:297:13: TRY300 Consider moving this statement to an `else` block
    |
296 |             logger.info(f"Child data deletion completed: {child_id}")
297 |             return deletion_result
    |             ^^^^^^^^^^^^^^^^^^^^^^ TRY300
298 |         except Exception as e:
299 |             logger.error(f"Child data deletion failed: {record['retention_id']}, {e}")
    |

src/infrastructure/services/data_retention_service.py:299:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
297 |             return deletion_result
298 |         except Exception as e:
299 |             logger.error(f"Child data deletion failed: {record['retention_id']}, {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
300 |             return {
301 |                 "error": str(e),
    |
    = help: Replace with `exception`

src/infrastructure/services/data_retention_service.py:387:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
385 |               )
386 |           except Exception as e:
387 | /             logger.error(
388 | |                 f"Failed to send deletion confirmation: {record['retention_id']}, {e}",
389 | |             )
    | |_____________^ TRY400
390 |
391 |       async def _send_deletion_confirmation_email(
    |
    = help: Replace with `exception`

src/infrastructure/services/data_retention_service.py:396:9: F841 Local variable `email_content` is assigned to but never used
    |
394 |     ) -> None:
395 |         """Send deletion confirmation email."""
396 |         email_content = f"""Subject: Child Data Deletion Completed - AI Teddy Bear
    |         ^^^^^^^^^^^^^ F841
397 | Dear Parent/Guardian,
    |
    = help: Remove assignment to unused variable `email_content`

src/infrastructure/services/data_retention_service.py:445:89: E501 Line too long (91 > 88)
    |
443 |             return {
444 |                 "success": False,
445 |                 "error": "Extension would exceed COPPA maximum retention period of 1 year",
    |                                                                                         ^^^ E501
446 |             }
    |

src/infrastructure/services/data_retention_service.py:592:12: PLW0603 Using the global statement to update `_retention_service` is discouraged
    |
590 | def get_retention_service() -> COPPADataRetentionService:
591 |     """Get global retention service instance."""
592 |     global _retention_service
    |            ^^^^^^^^^^^^^^^^^^ PLW0603
593 |     if _retention_service is None:
594 |         _retention_service = COPPADataRetentionService()
    |

src/infrastructure/session_manager/session_models.py:1:18: F401 [*] `enum.Enum` imported but unused
  |
1 | from enum import Enum
  |                  ^^^^ F401
2 |
3 | from sqlalchemy import Column, DateTime, Integer, String, Text
  |
  = help: Remove unused import: `enum.Enum`

src/infrastructure/session_manager/session_models.py:10:1: E402 Module level import not at top of file
   |
10 | from src.application.services.session.session_models import SessionStatus
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
11 | class Session(Base):
12 |     __tablename__ = "sessions"
   |

src/infrastructure/session_manager/session_models.py:10:1: I001 [*] Import block is un-sorted or un-formatted
   |
10 | from src.application.services.session.session_models import SessionStatus
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ I001
11 | class Session(Base):
12 |     __tablename__ = "sessions"
   |
   = help: Organize imports

src/infrastructure/state/application_state_manager.py:21:9: ARG002 Unused method argument: `scope`
   |
19 |         key: str,
20 |         value: Any,
21 |         scope: StateScope,
   |         ^^^^^ ARG002
22 |         expires_at: datetime | None = None,
23 |     ) -> None:
   |

src/infrastructure/state/application_state_manager.py:22:9: ARG002 Unused method argument: `expires_at`
   |
20 |         value: Any,
21 |         scope: StateScope,
22 |         expires_at: datetime | None = None,
   |         ^^^^^^^^^^ ARG002
23 |     ) -> None:
24 |         self.state[key] = value
   |

src/infrastructure/state/application_state_manager.py:26:41: ARG002 Unused method argument: `scope`
   |
24 |         self.state[key] = value
25 |
26 |     async def get_state(self, key: str, scope: StateScope) -> Any | None:
   |                                         ^^^^^ ARG002
27 |         return self.state.get(key)
   |

src/infrastructure/state/application_state_manager.py:29:41: ARG002 Unused method argument: `scope`
   |
27 |         return self.state.get(key)
28 |
29 |     async def has_state(self, key: str, scope: StateScope) -> bool:
   |                                         ^^^^^ ARG002
30 |         return key in self.state
   |

src/infrastructure/state/application_state_manager.py:32:44: ARG002 Unused method argument: `scope`
   |
30 |         return key in self.state
31 |
32 |     async def delete_state(self, key: str, scope: StateScope) -> None:
   |                                            ^^^^^ ARG002
33 |         if key in self.state:
34 |             del self.state[key]
   |

src/infrastructure/state/application_state_manager.py:36:43: ARG002 Unused method argument: `request_id`
   |
34 |             del self.state[key]
35 |
36 |     async def async_request_context(self, request_id: str) -> Any:
   |                                           ^^^^^^^^^^ ARG002
37 |         class AsyncContextManager:
38 |             async def __aenter__(self_inner):
   |

src/infrastructure/state/application_state_manager.py:38:34: N805 First argument of a method should be named `self`
   |
36 |     async def async_request_context(self, request_id: str) -> Any:
37 |         class AsyncContextManager:
38 |             async def __aenter__(self_inner):
   |                                  ^^^^^^^^^^ N805
39 |                 return self_inner
   |
   = help: Rename `self_inner` to `self`

src/infrastructure/state/application_state_manager.py:41:33: N805 First argument of a method should be named `self`
   |
39 |                 return self_inner
40 |
41 |             async def __aexit__(self_inner, exc_type, exc_val, exc_tb):
   |                                 ^^^^^^^^^^ N805
42 |                 pass
   |
   = help: Rename `self_inner` to `self`

src/infrastructure/state/application_state_manager.py:46:31: ARG002 Unused method argument: `session_id`
   |
44 |         return AsyncContextManager()
45 |
46 |     def session_context(self, session_id: str):
   |                               ^^^^^^^^^^ ARG002
47 |         class ContextManager:
48 |             def __enter__(self_inner):
   |

src/infrastructure/state/application_state_manager.py:48:27: N805 First argument of a method should be named `self`
   |
46 |     def session_context(self, session_id: str):
47 |         class ContextManager:
48 |             def __enter__(self_inner):
   |                           ^^^^^^^^^^ N805
49 |                 return self_inner
   |
   = help: Rename `self_inner` to `self`

src/infrastructure/state/application_state_manager.py:51:26: N805 First argument of a method should be named `self`
   |
49 |                 return self_inner
50 |
51 |             def __exit__(self_inner, exc_type, exc_val, exc_tb):
   |                          ^^^^^^^^^^ N805
52 |                 pass
   |
   = help: Rename `self_inner` to `self`

src/infrastructure/validation/child_safety_validator.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Child Safety Input Validation Service
2 | |
3 | | Provides COPPA-compliant validation specifically focused on child safety,
4 | | including age validation, content filtering, and PII protection.
5 | | """
  | |___^ D415
6 |
7 |   import re
  |
  = help: Add closing punctuation

src/infrastructure/validation/child_safety_validator.py:7:1: I001 [*] Import block is un-sorted or un-formatted
   |
 5 |   """
 6 |
 7 | / import re
 8 | | from re import Pattern
 9 | | from typing import Any
10 | | from src.domain.schemas import ValidationResult
11 | | from src.domain.exceptions.base_exceptions import ValidationError
12 | | from src.infrastructure.logging_config import get_logger
   | |________________________________________________________^ I001
13 |
14 |   logger = get_logger(__name__, component="validation")
   |
   = help: Organize imports

src/infrastructure/validation/child_safety_validator.py:7:8: F401 [*] `re` imported but unused
  |
5 | """
6 |
7 | import re
  |        ^^ F401
8 | from re import Pattern
9 | from typing import Any
  |
  = help: Remove unused import: `re`

src/infrastructure/validation/child_safety_validator.py:8:16: F401 [*] `re.Pattern` imported but unused
   |
 7 | import re
 8 | from re import Pattern
   |                ^^^^^^^ F401
 9 | from typing import Any
10 | from src.domain.schemas import ValidationResult
   |
   = help: Remove unused import: `re.Pattern`

src/infrastructure/validation/child_safety_validator.py:9:20: F401 [*] `typing.Any` imported but unused
   |
 7 | import re
 8 | from re import Pattern
 9 | from typing import Any
   |                    ^^^ F401
10 | from src.domain.schemas import ValidationResult
11 | from src.domain.exceptions.base_exceptions import ValidationError
   |
   = help: Remove unused import: `typing.Any`

src/infrastructure/validation/child_safety_validator.py:10:32: F401 [*] `src.domain.schemas.ValidationResult` imported but unused
   |
 8 | from re import Pattern
 9 | from typing import Any
10 | from src.domain.schemas import ValidationResult
   |                                ^^^^^^^^^^^^^^^^ F401
11 | from src.domain.exceptions.base_exceptions import ValidationError
12 | from src.infrastructure.logging_config import get_logger
   |
   = help: Remove unused import: `src.domain.schemas.ValidationResult`

src/infrastructure/validation/child_safety_validator.py:11:51: F401 [*] `src.domain.exceptions.base_exceptions.ValidationError` imported but unused
   |
 9 | from typing import Any
10 | from src.domain.schemas import ValidationResult
11 | from src.domain.exceptions.base_exceptions import ValidationError
   |                                                   ^^^^^^^^^^^^^^^ F401
12 | from src.infrastructure.logging_config import get_logger
   |
   = help: Remove unused import: `src.domain.exceptions.base_exceptions.ValidationError`

src/infrastructure/validation/comprehensive_validator.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Comprehensive Validator
2 | |
3 | | Main validation service that combines all validation modules for unified
4 | | validation. Provides a single interface for all validation needs with proper
5 | | delegation.
6 | | """
  | |___^ D415
7 |
8 |   from typing import Any
  |
  = help: Add closing punctuation

src/infrastructure/validation/comprehensive_validator.py:8:1: I001 [*] Import block is un-sorted or un-formatted
   |
 6 |   """
 7 |
 8 | / from typing import Any
 9 | |
10 | | from src.infrastructure.logging_config import get_logger
11 | |
12 | | from .child_safety_validator import get_child_safety_validator
13 | | from .general_input_validator import get_general_input_validator
14 | | from src.domain.schemas import ValidationResult
   | |_______________________________________________^ I001
15 |
16 |   logger = get_logger(__name__, component="validation")
   |
   = help: Organize imports

src/infrastructure/validation/comprehensive_validator.py:57:9: F841 Local variable `warnings` is assigned to but never used
   |
55 |         """
56 |         errors = []
57 |         warnings = []
   |         ^^^^^^^^ F841
58 |         metadata = {}
59 |         security_flags = []
   |
   = help: Remove assignment to unused variable `warnings`

src/infrastructure/validation/comprehensive_validator.py:65:17: PERF401 Use a list comprehension to create a transformed list
   |
63 |         for field in required_fields:
64 |             if field not in child_data or not child_data[field]:
65 |                 errors.append(f"Field '{field}' is required")
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PERF401
66 |
67 |         if errors:
   |
   = help: Replace for loop with list comprehension

src/infrastructure/validation/comprehensive_validator.py:100:9: SIM102 Use a single `if` statement instead of nested `if` statements
    |
 99 |           # Additional validations based on age
100 | /         if age_result.valid and age_result.metadata.get("coppa_applicable"):
101 | |             if "parent_email" not in child_data or not child_data["parent_email"]:
    | |__________________________________________________________________________________^ SIM102
102 |                   errors.append(
103 |                       "Parent email is required for children under 13 "
    |
    = help: Combine `if` statements using `and`

src/infrastructure/validation/comprehensive_validator.py:125:9: F841 Local variable `warnings` is assigned to but never used
    |
123 |         """
124 |         errors = []
125 |         warnings = []
    |         ^^^^^^^^ F841
126 |         metadata = {}
    |
    = help: Remove assignment to unused variable `warnings`

src/infrastructure/validation/comprehensive_validator.py:197:17: PERF401 Use a list comprehension to create a transformed list
    |
195 |         for field in required_fields:
196 |             if field not in file_data:
197 |                 errors.append(f"Field '{field}' is required")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PERF401
198 |
199 |         if errors:
    |
    = help: Replace for loop with list comprehension

src/infrastructure/validation/comprehensive_validator.py:241:33: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
    |
239 |         if parent_data.get("name"):
240 |             name_text = parent_data["name"]
241 |             if len(name_text) < 2 or len(name_text) > 100:
    |                                 ^ PLR2004
242 |                 errors.append("Parent name must be between 2 and 100 characters")
243 |             else:
    |

src/infrastructure/validation/comprehensive_validator.py:241:55: PLR2004 Magic value used in comparison, consider replacing `100` with a constant variable
    |
239 |         if parent_data.get("name"):
240 |             name_text = parent_data["name"]
241 |             if len(name_text) < 2 or len(name_text) > 100:
    |                                                       ^^^ PLR2004
242 |                 errors.append("Parent name must be between 2 and 100 characters")
243 |             else:
    |

src/infrastructure/validation/comprehensive_validator.py:315:24: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
    |
313 |             )
314 |
315 |         if len(name) < 2 or len(name) > 50:
    |                        ^ PLR2004
316 |             return ValidationResult(
317 |                 valid=False,
    |

src/infrastructure/validation/comprehensive_validator.py:315:41: PLR2004 Magic value used in comparison, consider replacing `50` with a constant variable
    |
313 |             )
314 |
315 |         if len(name) < 2 or len(name) > 50:
    |                                         ^^ PLR2004
316 |             return ValidationResult(
317 |                 valid=False,
    |

src/infrastructure/validation/emergency_contact_validator.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Emergency Contact Validator
2 | |
3 | | Validates emergency contact information for child safety compliance.
4 | | """
  | |___^ D415
5 |
6 |   import re
  |
  = help: Add closing punctuation

src/infrastructure/validation/emergency_contact_validator.py:161:28: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
    |
159 |             }
160 |
161 |         if len(contacts) > 5:
    |                            ^ PLR2004
162 |             return {
163 |                 "valid": False,
    |

src/infrastructure/validation/emergency_contact_validator.py:225:24: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
    |
224 |         name = name.strip()
225 |         if len(name) < 2:
    |                        ^ PLR2004
226 |             return {
227 |                 "valid": False,
    |

src/infrastructure/validation/emergency_contact_validator.py:231:24: PLR2004 Magic value used in comparison, consider replacing `100` with a constant variable
    |
229 |             }
230 |
231 |         if len(name) > 100:
    |                        ^^^ PLR2004
232 |             return {
233 |                 "valid": False,
    |

src/infrastructure/validation/emergency_contact_validator.py:284:68: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
    |
282 |                     formatted = self._format_international_number(cleaned_phone)
283 |                     country_code = (
284 |                         cleaned_phone[1:2] if len(cleaned_phone) > 10 else None
    |                                                                    ^^ PLR2004
285 |                     )
286 |                 else:
    |

src/infrastructure/validation/emergency_contact_validator.py:332:27: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
    |
331 |         address = address.strip()
332 |         if len(address) < 10:
    |                           ^^ PLR2004
333 |             return {
334 |                 "valid": False,
    |

src/infrastructure/validation/emergency_contact_validator.py:338:27: PLR2004 Magic value used in comparison, consider replacing `500` with a constant variable
    |
336 |             }
337 |
338 |         if len(address) > 500:
    |                           ^^^ PLR2004
339 |             return {
340 |                 "valid": False,
    |

src/infrastructure/validation/emergency_contact_validator.py:351:35: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
    |
349 |     def _format_us_number(self, cleaned_number: str) -> str:
350 |         """Format US phone number."""
351 |         if len(cleaned_number) == 10:
    |                                   ^^ PLR2004
352 |             return (
353 |                 f"({cleaned_number[:3]}) {cleaned_number[3:6]}-" f"{cleaned_number[6:]}"
    |

src/infrastructure/validation/emergency_contact_validator.py:355:35: PLR2004 Magic value used in comparison, consider replacing `11` with a constant variable
    |
353 |                 f"({cleaned_number[:3]}) {cleaned_number[3:6]}-" f"{cleaned_number[6:]}"
354 |             )
355 |         if len(cleaned_number) == 11 and cleaned_number[0] == "1":
    |                                   ^^ PLR2004
356 |             return (
357 |                 f"+1 ({cleaned_number[1:4]}) {cleaned_number[4:7]}-"
    |

src/infrastructure/validation/emergency_contact_validator.py:368:9: PLR0912 Too many branches (14 > 12)
    |
366 |         return f"+{cleaned_number}"
367 |
368 |     def get_contact_accessibility_score(
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLR0912
369 |         self,
370 |         contacts: list[dict[str, Any]],
    |

src/infrastructure/validation/emergency_contact_validator.py:410:35: PLR2004 Magic value used in comparison, consider replacing `6` with a constant variable
    |
408 |                 # Extract area code/prefix
409 |                 digits = re.sub(r"[^\d]", "", phone)
410 |                 if len(digits) >= 6:
    |                                   ^ PLR2004
411 |                     phone_prefixes.add(digits[:3])
    |

src/infrastructure/validation/general_input_validator.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """General Input Validator - Placeholder implementation"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | from src.domain.schemas import ValidationResult
  |
  = help: Add closing punctuation

src/infrastructure/validation/general_input_validator.py:3:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | """General Input Validator - Placeholder implementation"""
2 |
3 | from src.domain.schemas import ValidationResult
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ I001
4 |
5 | class GeneralInputValidator:
  |
  = help: Organize imports

src/infrastructure/validation/general_input_validator.py:8:1: W293 [*] Blank line contains whitespace
   |
 6 |     def validate_text(self, text: str) -> ValidationResult:
 7 |         return ValidationResult(valid=True, sanitized_value=text)
 8 |     
   | ^^^^ W293
 9 |     def validate_email(self, email: str) -> ValidationResult:
10 |         return ValidationResult(valid=True, sanitized_value=email)
   |
   = help: Remove whitespace from blank line

src/infrastructure/validation/general_input_validator.py:15:12: PLW0603 Using the global statement to update `_general_validator` is discouraged
   |
14 | def get_general_input_validator():
15 |     global _general_validator
   |            ^^^^^^^^^^^^^^^^^^ PLW0603
16 |     if _general_validator is None:
17 |         _general_validator = GeneralInputValidator()
   |

src/main.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """AI Teddy Bear - Modern FastAPI Application (2025 Standards)
2 | | Enterprise-grade child-safe AI interaction system with Hexagonal Architecture.
3 | | """
  | |___^ D205
4 |
5 |   # Standard library imports
  |
  = help: Insert single blank line

src/main.py:41:20: ARG001 Unused function argument: `app`
   |
41 | async def lifespan(app: FastAPI):
   |                    ^^^ ARG001
42 |     try:
43 |         # Initialize FastAPILimiter with Redis connection
   |

src/main.py:57:15: TRY003 Avoid specifying long messages outside the exception class
   |
55 |               exc_info=True,
56 |           )
57 |           raise RuntimeError(
   |  _______________^
58 | |             "Failed to initialize FastAPILimiter due to Redis connection "
59 | |             "issue",
60 | |         ) from e
   | |_________^ TRY003
61 |
62 |       # Yield control to the application startup
   |

src/main.py:95:15: TRY003 Avoid specifying long messages outside the exception class
   |
93 |               exc_info=True,
94 |           )
95 |           raise StartupValidationException(
   |  _______________^
96 | |             "Application startup validation failed"
97 | |         ) from e
   | |_________^ TRY003
   |

src/main.py:134:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
132 |                   f"of project root '{project_root}'.",
133 |               )
134 | /             raise ValueError(
135 | |                 "Invalid static files directory configuration: Path traversal "
136 | |                 "detected.",
137 | |             )
    | |_____________^ B904
138 |           fast_app.mount(
139 |               "/static", StaticFiles(directory=static_dir), name="static"
    |

src/main.py:134:19: TRY003 Avoid specifying long messages outside the exception class
    |
132 |                   f"of project root '{project_root}'.",
133 |               )
134 |               raise ValueError(
    |  ___________________^
135 | |                 "Invalid static files directory configuration: Path traversal "
136 | |                 "detected.",
137 | |             )
    | |_____________^ TRY003
138 |           fast_app.mount(
139 |               "/static", StaticFiles(directory=static_dir), name="static"
    |

src/main.py:211:15: TRY003 Avoid specifying long messages outside the exception class
    |
209 |               "external proxy handles SSL.",
210 |           )
211 |           raise RuntimeError(
    |  _______________^
212 | |             "SSL configuration required for production deployment"
213 | |         )
    | |_________^ TRY003
214 |       elif ssl_keyfile and ssl_certfile and not ssl_offloaded:
215 |           uvicorn_ssl_args["ssl_keyfile"] = ssl_keyfile
    |

src/main.py:226:9: F821 Undefined name `app`
    |
225 |     uvicorn.run(
226 |         app,
    |         ^^^ F821
227 |         host=host,
228 |         port=port,
    |

src/presentation/__init__.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Presentation layer for the AI Teddy Bear system.
2 | | This package contains the user-facing interfaces, such as FastAPI endpoints and API schemas.
3 | | It handles the presentation of data and the reception of user input, adapting it for the application layer.
4 | | """
  | |___^ D205
  |
  = help: Insert single blank line

src/presentation/__init__.py:2:89: E501 Line too long (92 > 88)
  |
1 | """Presentation layer for the AI Teddy Bear system.
2 | This package contains the user-facing interfaces, such as FastAPI endpoints and API schemas.
  |                                                                                         ^^^^ E501
3 | It handles the presentation of data and the reception of user input, adapting it for the application layer.
4 | """
  |

src/presentation/__init__.py:3:89: E501 Line too long (107 > 88)
  |
1 | """Presentation layer for the AI Teddy Bear system.
2 | This package contains the user-facing interfaces, such as FastAPI endpoints and API schemas.
3 | It handles the presentation of data and the reception of user input, adapting it for the application layer.
  |                                                                                         ^^^^^^^^^^^^^^^^^^^ E501
4 | """
  |

src/presentation/api/decorators/rate_limit.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Rate limiting decorators for API endpoints"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | from collections.abc import Callable
  |
  = help: Add closing punctuation

src/presentation/api/decorators/rate_limit.py:64:48: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
62 |     child_id: str,
63 |     interaction_type: str = "general",
64 |     rate_limiter_service: RateLimiterService = Depends(),
   |                                                ^^^^^^^^^ B008
65 | ) -> None:
66 |     """Check child-specific interaction limits.
   |

src/presentation/api/decorators/rate_limit.py:88:9: TRY400 Use `logging.exception` instead of `logging.error`
   |
86 |         raise
87 |     except Exception as e:
88 |         logger.error(f"Unexpected error in rate limiting: {e}")
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
   |
   = help: Replace with `exception`

src/presentation/api/dependencies/__init__.py:2:1: I001 [*] Import block is un-sorted or un-formatted
   |
 1 |   """Professional dependency injection system."""
 2 | / from .providers import (
 3 | |     audio_processing_provider,
 4 | |     compliance_validator_provider,
 5 | |     coppa_integration_provider,
 6 | |     data_retention_provider,
 7 | |     parental_consent_provider,
 8 | | )
   | |_^ I001
 9 |
10 |   # Audio dependencies
   |
   = help: Organize imports

src/presentation/api/dependencies/__init__.py:15:26: W291 [*] Trailing whitespace
   |
13 |     return audio_processing_provider.get()
14 |
15 | # Compliance dependencies  
   |                          ^^ W291
16 | def get_coppa_integration():
17 |     """Get COPPA integration service."""
   |
   = help: Remove trailing whitespace

src/presentation/api/dependencies/auth.py:13:49: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
12 | async def get_authenticated_user(
13 |     credentials: HTTPAuthorizationCredentials = Depends(security),
   |                                                 ^^^^^^^^^^^^^^^^^ B008
14 |     auth_service: ProductionAuthService = Depends(container.auth_service),
15 | ) -> dict[str, Any]:
   |

src/presentation/api/dependencies/auth.py:14:43: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
12 | async def get_authenticated_user(
13 |     credentials: HTTPAuthorizationCredentials = Depends(security),
14 |     auth_service: ProductionAuthService = Depends(container.auth_service),
   |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
15 | ) -> dict[str, Any]:
16 |     """Verify authentication for child audio access - COPPA compliance required.
   |

src/presentation/api/dependencies/auth.py:28:13: TRY301 Abstract `raise` to an inner function
   |
26 |           payload = await auth_service.verify_token(token)
27 |           if not payload:
28 | /             raise HTTPException(
29 | |                 status_code=status.HTTP_401_UNAUTHORIZED,
30 | |                 detail="Invalid authentication token",
31 | |                 headers={"WWW-Authenticate": "Bearer"},
32 | |             )
   | |_____________^ TRY301
33 |
34 |           user_role = payload.get("role", "")
   |

src/presentation/api/dependencies/auth.py:36:13: TRY301 Abstract `raise` to an inner function
   |
34 |           user_role = payload.get("role", "")
35 |           if user_role not in ["parent", "guardian", "admin"]:
36 | /             raise HTTPException(
37 | |                 status_code=status.HTTP_403_FORBIDDEN,
38 | |                 detail="Access denied: Only parents/guardians can access child audio data",
39 | |             )
   | |_____________^ TRY301
40 |           return {
41 |               "user_id": payload.get("sub"),
   |

src/presentation/api/dependencies/auth.py:38:89: E501 Line too long (91 > 88)
   |
36 |             raise HTTPException(
37 |                 status_code=status.HTTP_403_FORBIDDEN,
38 |                 detail="Access denied: Only parents/guardians can access child audio data",
   |                                                                                         ^^^ E501
39 |             )
40 |         return {
   |

src/presentation/api/dependencies/auth.py:50:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
48 |       except Exception as e:
49 |           # Generic exception handling for unexpected errors
50 | /         raise HTTPException(
51 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
52 | |             detail=f"Authentication processing error: {e}",
53 | |         )
   | |_________^ B904
   |

src/presentation/api/dependencies/base.py:2:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 |   """Base dependency injection patterns."""
2 | / from functools import lru_cache
3 | | from typing import TypeVar, Callable, Any
4 | | from abc import ABC, abstractmethod
  | |___________________________________^ I001
5 |
6 |   T = TypeVar('T')
  |
  = help: Organize imports

src/presentation/api/dependencies/base.py:2:23: F401 [*] `functools.lru_cache` imported but unused
  |
1 | """Base dependency injection patterns."""
2 | from functools import lru_cache
  |                       ^^^^^^^^^ F401
3 | from typing import TypeVar, Callable, Any
4 | from abc import ABC, abstractmethod
  |
  = help: Remove unused import: `functools.lru_cache`

src/presentation/api/dependencies/base.py:3:1: UP035 [*] Import from `collections.abc` instead: `Callable`
  |
1 | """Base dependency injection patterns."""
2 | from functools import lru_cache
3 | from typing import TypeVar, Callable, Any
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
4 | from abc import ABC, abstractmethod
  |
  = help: Import from `collections.abc`

src/presentation/api/dependencies/base.py:10:1: W293 [*] Blank line contains whitespace
   |
 8 | class ServiceFactory(ABC):
 9 |     """Abstract factory for service creation."""
10 |     
   | ^^^^ W293
11 |     @abstractmethod
12 |     def create(self) -> Any:
   |
   = help: Remove whitespace from blank line

src/presentation/api/dependencies/base.py:18:1: W293 [*] Blank line contains whitespace
   |
16 | class LazyServiceProvider:
17 |     """Lazy service provider to avoid circular imports."""
18 |     
   | ^^^^ W293
19 |     def __init__(self, factory: Callable[[], T]):
20 |         self._factory = factory
   |
   = help: Remove whitespace from blank line

src/presentation/api/dependencies/base.py:22:1: W293 [*] Blank line contains whitespace
   |
20 |         self._factory = factory
21 |         self._instance = None
22 |     
   | ^^^^ W293
23 |     def get(self) -> T:
24 |         if self._instance is None:
   |
   = help: Remove whitespace from blank line

src/presentation/api/dependencies/providers.py:2:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | """Service providers using factory pattern."""
2 | from .base import LazyServiceProvider
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ I001
3 |
4 | # COPPA Services
  |
  = help: Organize imports

src/presentation/api/dependencies/providers.py:6:5: PLC0415 `import` should be at the top-level of a file
  |
4 | # COPPA Services
5 | def _create_coppa_integration():
6 |     from src.presentation.api.endpoints.children.compliance import COPPAIntegration
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
7 |     from src.infrastructure.config.settings import get_settings
8 |     from src.infrastructure.security.coppa_validator import (
  |

src/presentation/api/dependencies/providers.py:6:5: I001 [*] Import block is un-sorted or un-formatted
   |
 4 |   # COPPA Services
 5 |   def _create_coppa_integration():
 6 | /     from src.presentation.api.endpoints.children.compliance import COPPAIntegration
 7 | |     from src.infrastructure.config.settings import get_settings
 8 | |     from src.infrastructure.security.coppa_validator import (
 9 | |     COPPAValidator,
10 | |     coppa_validator,
11 | |     is_coppa_subject,
12 | |     requires_parental_consent
13 | | )
   | |_^ I001
14 |       
15 |       settings = get_settings()
   |
   = help: Organize imports

src/presentation/api/dependencies/providers.py:7:5: PLC0415 `import` should be at the top-level of a file
  |
5 | def _create_coppa_integration():
6 |     from src.presentation.api.endpoints.children.compliance import COPPAIntegration
7 |     from src.infrastructure.config.settings import get_settings
  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
8 |     from src.infrastructure.security.coppa_validator import (
9 |     COPPAValidator,
  |

src/presentation/api/dependencies/providers.py:8:5: PLC0415 `import` should be at the top-level of a file
   |
 6 |       from src.presentation.api.endpoints.children.compliance import COPPAIntegration
 7 |       from src.infrastructure.config.settings import get_settings
 8 | /     from src.infrastructure.security.coppa_validator import (
 9 | |     COPPAValidator,
10 | |     coppa_validator,
11 | |     is_coppa_subject,
12 | |     requires_parental_consent
13 | | )
   | |_^ PLC0415
14 |       
15 |       settings = get_settings()
   |

src/presentation/api/dependencies/providers.py:10:5: F401 [*] `src.infrastructure.security.coppa_validator.coppa_validator` imported but unused
   |
 8 |     from src.infrastructure.security.coppa_validator import (
 9 |     COPPAValidator,
10 |     coppa_validator,
   |     ^^^^^^^^^^^^^^^ F401
11 |     is_coppa_subject,
12 |     requires_parental_consent
   |
   = help: Remove unused import

src/presentation/api/dependencies/providers.py:11:5: F401 [*] `src.infrastructure.security.coppa_validator.is_coppa_subject` imported but unused
   |
 9 |     COPPAValidator,
10 |     coppa_validator,
11 |     is_coppa_subject,
   |     ^^^^^^^^^^^^^^^^ F401
12 |     requires_parental_consent
13 | )
   |
   = help: Remove unused import

src/presentation/api/dependencies/providers.py:12:5: F401 [*] `src.infrastructure.security.coppa_validator.requires_parental_consent` imported but unused
   |
10 |     coppa_validator,
11 |     is_coppa_subject,
12 |     requires_parental_consent
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^ F401
13 | )
   |
   = help: Remove unused import

src/presentation/api/dependencies/providers.py:14:1: W293 [*] Blank line contains whitespace
   |
12 |     requires_parental_consent
13 | )
14 |     
   | ^^^^ W293
15 |     settings = get_settings()
16 |     coppa_service = COPPAValidator()
   |
   = help: Remove whitespace from blank line

src/presentation/api/dependencies/providers.py:20:5: PLC0415 `import` should be at the top-level of a file
   |
19 | def _create_parental_consent_manager():
20 |     from src.presentation.api.endpoints.children.compliance import ParentalConsentManager
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
21 |     from src.infrastructure.security.coppa_validator import (
22 |     COPPAValidator,
   |

src/presentation/api/dependencies/providers.py:20:5: I001 [*] Import block is un-sorted or un-formatted
   |
19 |   def _create_parental_consent_manager():
20 | /     from src.presentation.api.endpoints.children.compliance import ParentalConsentManager
21 | |     from src.infrastructure.security.coppa_validator import (
22 | |     COPPAValidator,
23 | |     coppa_validator,
24 | |     is_coppa_subject,
25 | |     requires_parental_consent
26 | | )
   | |_^ I001
27 |       
28 |       coppa_service = COPPAValidator()
   |
   = help: Organize imports

src/presentation/api/dependencies/providers.py:20:89: E501 Line too long (89 > 88)
   |
19 | def _create_parental_consent_manager():
20 |     from src.presentation.api.endpoints.children.compliance import ParentalConsentManager
   |                                                                                         ^ E501
21 |     from src.infrastructure.security.coppa_validator import (
22 |     COPPAValidator,
   |

src/presentation/api/dependencies/providers.py:21:5: PLC0415 `import` should be at the top-level of a file
   |
19 |   def _create_parental_consent_manager():
20 |       from src.presentation.api.endpoints.children.compliance import ParentalConsentManager
21 | /     from src.infrastructure.security.coppa_validator import (
22 | |     COPPAValidator,
23 | |     coppa_validator,
24 | |     is_coppa_subject,
25 | |     requires_parental_consent
26 | | )
   | |_^ PLC0415
27 |       
28 |       coppa_service = COPPAValidator()
   |

src/presentation/api/dependencies/providers.py:23:5: F401 [*] `src.infrastructure.security.coppa_validator.coppa_validator` imported but unused
   |
21 |     from src.infrastructure.security.coppa_validator import (
22 |     COPPAValidator,
23 |     coppa_validator,
   |     ^^^^^^^^^^^^^^^ F401
24 |     is_coppa_subject,
25 |     requires_parental_consent
   |
   = help: Remove unused import

src/presentation/api/dependencies/providers.py:24:5: F401 [*] `src.infrastructure.security.coppa_validator.is_coppa_subject` imported but unused
   |
22 |     COPPAValidator,
23 |     coppa_validator,
24 |     is_coppa_subject,
   |     ^^^^^^^^^^^^^^^^ F401
25 |     requires_parental_consent
26 | )
   |
   = help: Remove unused import

src/presentation/api/dependencies/providers.py:25:5: F401 [*] `src.infrastructure.security.coppa_validator.requires_parental_consent` imported but unused
   |
23 |     coppa_validator,
24 |     is_coppa_subject,
25 |     requires_parental_consent
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^ F401
26 | )
   |
   = help: Remove unused import

src/presentation/api/dependencies/providers.py:27:1: W293 [*] Blank line contains whitespace
   |
25 |     requires_parental_consent
26 | )
27 |     
   | ^^^^ W293
28 |     coppa_service = COPPAValidator()
29 |     return ParentalConsentManager(coppa_service)
   |
   = help: Remove whitespace from blank line

src/presentation/api/dependencies/providers.py:32:5: PLC0415 `import` should be at the top-level of a file
   |
31 | def _create_compliance_validator():
32 |     from src.presentation.api.endpoints.children.compliance import ComplianceValidator
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
33 |     from src.infrastructure.config.settings import get_settings
   |

src/presentation/api/dependencies/providers.py:32:5: I001 [*] Import block is un-sorted or un-formatted
   |
31 |   def _create_compliance_validator():
32 | /     from src.presentation.api.endpoints.children.compliance import ComplianceValidator
33 | |     from src.infrastructure.config.settings import get_settings
   | |_______________________________________________________________^ I001
34 |       
35 |       settings = get_settings()
   |
   = help: Organize imports

src/presentation/api/dependencies/providers.py:33:5: PLC0415 `import` should be at the top-level of a file
   |
31 | def _create_compliance_validator():
32 |     from src.presentation.api.endpoints.children.compliance import ComplianceValidator
33 |     from src.infrastructure.config.settings import get_settings
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
34 |     
35 |     settings = get_settings()
   |

src/presentation/api/dependencies/providers.py:34:1: W293 [*] Blank line contains whitespace
   |
32 |     from src.presentation.api.endpoints.children.compliance import ComplianceValidator
33 |     from src.infrastructure.config.settings import get_settings
34 |     
   | ^^^^ W293
35 |     settings = get_settings()
36 |     return ComplianceValidator(settings)
   |
   = help: Remove whitespace from blank line

src/presentation/api/dependencies/providers.py:39:5: PLC0415 `import` should be at the top-level of a file
   |
38 | def _create_data_retention_manager():
39 |     from src.presentation.api.endpoints.children.compliance import DataRetentionManager
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
40 |     from src.infrastructure.security.coppa_validator import (
41 |     COPPAValidator,
   |

src/presentation/api/dependencies/providers.py:39:5: I001 [*] Import block is un-sorted or un-formatted
   |
38 |   def _create_data_retention_manager():
39 | /     from src.presentation.api.endpoints.children.compliance import DataRetentionManager
40 | |     from src.infrastructure.security.coppa_validator import (
41 | |     COPPAValidator,
42 | |     coppa_validator,
43 | |     is_coppa_subject,
44 | |     requires_parental_consent
45 | | )
   | |_^ I001
46 |       
47 |       coppa_service = COPPAValidator()
   |
   = help: Organize imports

src/presentation/api/dependencies/providers.py:40:5: PLC0415 `import` should be at the top-level of a file
   |
38 |   def _create_data_retention_manager():
39 |       from src.presentation.api.endpoints.children.compliance import DataRetentionManager
40 | /     from src.infrastructure.security.coppa_validator import (
41 | |     COPPAValidator,
42 | |     coppa_validator,
43 | |     is_coppa_subject,
44 | |     requires_parental_consent
45 | | )
   | |_^ PLC0415
46 |       
47 |       coppa_service = COPPAValidator()
   |

src/presentation/api/dependencies/providers.py:42:5: F401 [*] `src.infrastructure.security.coppa_validator.coppa_validator` imported but unused
   |
40 |     from src.infrastructure.security.coppa_validator import (
41 |     COPPAValidator,
42 |     coppa_validator,
   |     ^^^^^^^^^^^^^^^ F401
43 |     is_coppa_subject,
44 |     requires_parental_consent
   |
   = help: Remove unused import

src/presentation/api/dependencies/providers.py:43:5: F401 [*] `src.infrastructure.security.coppa_validator.is_coppa_subject` imported but unused
   |
41 |     COPPAValidator,
42 |     coppa_validator,
43 |     is_coppa_subject,
   |     ^^^^^^^^^^^^^^^^ F401
44 |     requires_parental_consent
45 | )
   |
   = help: Remove unused import

src/presentation/api/dependencies/providers.py:44:5: F401 [*] `src.infrastructure.security.coppa_validator.requires_parental_consent` imported but unused
   |
42 |     coppa_validator,
43 |     is_coppa_subject,
44 |     requires_parental_consent
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^ F401
45 | )
   |
   = help: Remove unused import

src/presentation/api/dependencies/providers.py:46:1: W293 [*] Blank line contains whitespace
   |
44 |     requires_parental_consent
45 | )
46 |     
   | ^^^^ W293
47 |     coppa_service = COPPAValidator()
48 |     return DataRetentionManager(coppa_service)
   |
   = help: Remove whitespace from blank line

src/presentation/api/dependencies/providers.py:51:5: PLC0415 `import` should be at the top-level of a file
   |
50 | def _create_audio_processing_service():
51 |     from src.application.services.audio_processing_service import AudioProcessingService
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
52 |     return AudioProcessingService()
   |

src/presentation/api/emergency_response/__init__.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Emergency Response Module - Modular emergency system components"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | from .endpoints import EmergencyEndpoints
  |
  = help: Add closing punctuation

src/presentation/api/emergency_response/endpoints.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Emergency Response Endpoints - API routes for emergency system"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | import os
  |
  = help: Add closing punctuation

src/presentation/api/emergency_response/endpoints.py:26:11: TRY003 Avoid specifying long messages outside the exception class
   |
24 |   if not JWT_SECRET:
25 |       logger.critical("JWT_SECRET environment variable is required but not set")
26 |       raise RuntimeError(
   |  ___________^
27 | |         "CRITICAL SECURITY ERROR: JWT_SECRET must be set in environment variables",
28 | |     )
   | |_____^ TRY003
29 |
30 |   ENVIRONMENT = os.getenv("ENVIRONMENT", "development")
   |

src/presentation/api/emergency_response/endpoints.py:68:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
66 |             }
67 |         except Exception as e:
68 |             logger.error(f"Error processing webhook: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
69 |             raise HTTPException(status_code=500, detail=str(e))
   |
   = help: Replace with `exception`

src/presentation/api/emergency_response/endpoints.py:69:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
67 |         except Exception as e:
68 |             logger.error(f"Error processing webhook: {e}")
69 |             raise HTTPException(status_code=500, detail=str(e))
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
70 |
71 |     async def _process_single_alert(self, alert_data: dict, receiver: str):
   |

src/presentation/api/emergency_response/endpoints.py:71:61: ARG002 Unused method argument: `receiver`
   |
69 |             raise HTTPException(status_code=500, detail=str(e))
70 |
71 |     async def _process_single_alert(self, alert_data: dict, receiver: str):
   |                                                             ^^^^^^^^ ARG002
72 |         """معالجة تنبيه واحد."""
73 |         try:
   |

src/presentation/api/emergency_response/endpoints.py:90:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
88 |             await self.emergency_service.process_alert(emergency_alert.dict())
89 |         except Exception as e:
90 |             logger.error(f"Error processing single alert: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
91 |
92 |     async def health_check(self) -> HealthResponse:
   |
   = help: Replace with `exception`

src/presentation/api/emergency_response/endpoints.py:108:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
106 |             )
107 |         except Exception as e:
108 |             logger.error(f"Health check failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
109 |             raise HTTPException(status_code=503, detail="Service unhealthy")
    |
    = help: Replace with `exception`

src/presentation/api/emergency_response/endpoints.py:109:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
107 |         except Exception as e:
108 |             logger.error(f"Health check failed: {e}")
109 |             raise HTTPException(status_code=503, detail="Service unhealthy")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
110 |
111 |     async def get_alerts(
    |

src/presentation/api/emergency_response/endpoints.py:113:53: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
111 |     async def get_alerts(
112 |         self,
113 |         credentials: HTTPAuthorizationCredentials = Depends(security),
    |                                                     ^^^^^^^^^^^^^^^^^ B008
114 |     ) -> list[dict]:
115 |         """الحصول على قائمة التنبيهات النشطة."""
    |

src/presentation/api/emergency_response/endpoints.py:124:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
122 |             return []
123 |         except Exception as e:
124 |             logger.error(f"Error fetching alerts: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
125 |             raise HTTPException(status_code=500, detail=str(e))
    |
    = help: Replace with `exception`

src/presentation/api/emergency_response/endpoints.py:125:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
123 |         except Exception as e:
124 |             logger.error(f"Error fetching alerts: {e}")
125 |             raise HTTPException(status_code=500, detail=str(e))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
126 |
127 |     async def send_notification(
    |

src/presentation/api/emergency_response/endpoints.py:130:53: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
128 |         self,
129 |         request: NotificationRequest,
130 |         credentials: HTTPAuthorizationCredentials = Depends(security),
    |                                                     ^^^^^^^^^^^^^^^^^ B008
131 |     ) -> dict[str, str]:
132 |         """إرسال إشعار طارئ."""
    |

src/presentation/api/emergency_response/endpoints.py:140:13: TRY301 Abstract `raise` to an inner function
    |
138 |             if success:
139 |                 return {"status": "sent", "message": "تم إرسال الإشعار بنجاح"}
140 |             raise HTTPException(status_code=500, detail="فشل في إرسال الإشعار")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
141 |         except Exception as e:
142 |             logger.error(f"Error sending notification: {e}")
    |

src/presentation/api/emergency_response/endpoints.py:142:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
140 |             raise HTTPException(status_code=500, detail="فشل في إرسال الإشعار")
141 |         except Exception as e:
142 |             logger.error(f"Error sending notification: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
143 |             raise HTTPException(status_code=500, detail=str(e))
    |
    = help: Replace with `exception`

src/presentation/api/emergency_response/endpoints.py:143:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
141 |         except Exception as e:
142 |             logger.error(f"Error sending notification: {e}")
143 |             raise HTTPException(status_code=500, detail=str(e))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
144 |
145 |     async def system_status(
    |

src/presentation/api/emergency_response/endpoints.py:147:53: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
145 |     async def system_status(
146 |         self,
147 |         credentials: HTTPAuthorizationCredentials = Depends(security),
    |                                                     ^^^^^^^^^^^^^^^^^ B008
148 |     ) -> list[dict]:
149 |         """الحصول على حالة النظام."""
    |

src/presentation/api/emergency_response/endpoints.py:157:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
155 |             return [status.dict() for status in statuses]
156 |         except Exception as e:
157 |             logger.error(f"Error checking system status: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
158 |             raise HTTPException(status_code=500, detail=str(e))
    |
    = help: Replace with `exception`

src/presentation/api/emergency_response/endpoints.py:158:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
156 |         except Exception as e:
157 |             logger.error(f"Error checking system status: {e}")
158 |             raise HTTPException(status_code=500, detail=str(e))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
159 |
160 |     def _verify_token(self, token: str) -> bool:
    |

src/presentation/api/emergency_response/endpoints.py:172:53: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
170 |         alert_type: str,
171 |         message: str,
172 |         credentials: HTTPAuthorizationCredentials = Depends(security),
    |                                                     ^^^^^^^^^^^^^^^^^ B008
173 |     ) -> dict[str, str]:
174 |         """إرسال تنبيه لجهات الاتصال الطارئة."""
    |

src/presentation/api/emergency_response/endpoints.py:194:13: TRY300 Consider moving this statement to an `else` block
    |
192 |               await self.emergency_service.process_alert(emergency_alert.dict())
193 |
194 | /             return {
195 | |                 "status": "sent",
196 | |                 "message": "تم إرسال التنبيه الطارئ بنجاح",
197 | |                 "alert_id": emergency_alert.id,
198 | |             }
    | |_____________^ TRY300
199 |           except Exception as e:
200 |               logger.error(f"Error sending emergency contact alert: {e}")
    |

src/presentation/api/emergency_response/endpoints.py:200:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
198 |             }
199 |         except Exception as e:
200 |             logger.error(f"Error sending emergency contact alert: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
201 |             raise HTTPException(status_code=500, detail=str(e))
    |
    = help: Replace with `exception`

src/presentation/api/emergency_response/endpoints.py:201:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
199 |         except Exception as e:
200 |             logger.error(f"Error sending emergency contact alert: {e}")
201 |             raise HTTPException(status_code=500, detail=str(e))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
202 |
203 |     async def get_emergency_logs(
    |

src/presentation/api/emergency_response/endpoints.py:205:19: RUF013 PEP 484 prohibits implicit `Optional`
    |
203 |     async def get_emergency_logs(
204 |         self,
205 |         child_id: str = None,
    |                   ^^^ RUF013
206 |         limit: int = 50,
207 |         credentials: HTTPAuthorizationCredentials = Depends(security),
    |
    = help: Convert to `T | None`

src/presentation/api/emergency_response/endpoints.py:207:53: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
205 |         child_id: str = None,
206 |         limit: int = 50,
207 |         credentials: HTTPAuthorizationCredentials = Depends(security),
    |                                                     ^^^^^^^^^^^^^^^^^ B008
208 |     ) -> list[dict]:
209 |         """الحصول على سجلات الطوارئ."""
    |

src/presentation/api/emergency_response/endpoints.py:219:13: TRY300 Consider moving this statement to an `else` block
    |
217 |                 child_id=child_id, limit=limit
218 |             )
219 |             return logs
    |             ^^^^^^^^^^^ TRY300
220 |         except Exception as e:
221 |             logger.error(f"Error fetching emergency logs: {e}")
    |

src/presentation/api/emergency_response/endpoints.py:219:20: RET504 Unnecessary assignment to `logs` before `return` statement
    |
217 |                 child_id=child_id, limit=limit
218 |             )
219 |             return logs
    |                    ^^^^ RET504
220 |         except Exception as e:
221 |             logger.error(f"Error fetching emergency logs: {e}")
    |
    = help: Remove unnecessary assignment

src/presentation/api/emergency_response/endpoints.py:221:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
219 |             return logs
220 |         except Exception as e:
221 |             logger.error(f"Error fetching emergency logs: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
222 |             raise HTTPException(status_code=500, detail=str(e))
    |
    = help: Replace with `exception`

src/presentation/api/emergency_response/endpoints.py:222:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
220 |         except Exception as e:
221 |             logger.error(f"Error fetching emergency logs: {e}")
222 |             raise HTTPException(status_code=500, detail=str(e))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
    |

src/presentation/api/emergency_response/main.py:65:12: SyntaxError: Global statement must have at least one name
   |
63 | async def lifespan(app: FastAPI):
64 |     """إدارة دورة حياة التطبيق."""
65 |     global (
   |            ^
66 |         redis_client,
67 |         db_session,
   |

src/presentation/api/emergency_response/main.py:65:13: SyntaxError: missing closing parenthesis `)`
   |
63 | async def lifespan(app: FastAPI):
64 |     """إدارة دورة حياة التطبيق."""
65 |     global (
   |             ^
66 |         redis_client,
67 |         db_session,
68 |         emergency_service,
   |

src/presentation/api/emergency_response/main.py:66:1: SyntaxError: Unexpected indentation
   |
64 |     """إدارة دورة حياة التطبيق."""
65 |     global (
66 |         redis_client,
   | ^^^^^^^^
67 |         db_session,
68 |         emergency_service,
   |

src/presentation/api/emergency_response/main.py:66:21: COM818 Trailing comma on bare tuple prohibited
   |
64 |     """إدارة دورة حياة التطبيق."""
65 |     global (
66 |         redis_client,
   |                     ^ COM818
67 |         db_session,
68 |         emergency_service,
   |

src/presentation/api/emergency_response/main.py:67:19: COM818 Trailing comma on bare tuple prohibited
   |
65 |     global (
66 |         redis_client,
67 |         db_session,
   |                   ^ COM818
68 |         emergency_service,
69 |         monitor_service,
   |

src/presentation/api/emergency_response/main.py:68:26: COM818 Trailing comma on bare tuple prohibited
   |
66 |         redis_client,
67 |         db_session,
68 |         emergency_service,
   |                          ^ COM818
69 |         monitor_service,
70 |         notification_service,
   |

src/presentation/api/emergency_response/main.py:69:24: COM818 Trailing comma on bare tuple prohibited
   |
67 |         db_session,
68 |         emergency_service,
69 |         monitor_service,
   |                        ^ COM818
70 |         notification_service,
71 |         endpoints
   |

src/presentation/api/emergency_response/main.py:70:29: COM818 Trailing comma on bare tuple prohibited
   |
68 |         emergency_service,
69 |         monitor_service,
70 |         notification_service,
   |                             ^ COM818
71 |         endpoints
72 |     )
   |

src/presentation/api/emergency_response/main.py:72:5: SyntaxError: Expected a statement
   |
70 |         notification_service,
71 |         endpoints
72 |     )
   |     ^
73 |     logger.info("🚨 Starting Emergency Response System...")
74 |     try:
   |

src/presentation/api/emergency_response/main.py:72:6: SyntaxError: Expected a statement
   |
70 |         notification_service,
71 |         endpoints
72 |     )
   |      ^
73 |     logger.info("🚨 Starting Emergency Response System...")
74 |     try:
75 |         # إعداد Redis
   |

src/presentation/api/emergency_response/main.py:113:1: SyntaxError: Expected a statement
    |
113 | def create_app() -> FastAPI:
    | ^
114 |     """إنشاء تطبيق FastAPI."""
115 |     app = FastAPI(
    |

src/presentation/api/emergency_response/models.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Emergency Response Models - Data models for emergency system"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | from datetime import datetime
  |
  = help: Add closing punctuation

src/presentation/api/emergency_response/services.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Emergency Response Services - Core business logic for emergency handling"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | import asyncio
  |
  = help: Add closing punctuation

src/presentation/api/emergency_response/services.py:151:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
149 |                 action.success = False
150 |                 action.error_message = str(e)
151 |                 logger.error(f"Action {action.action_type} failed: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
152 |
153 |     async def _execute_single_action(self, action: ResponseAction):
    |
    = help: Replace with `exception`

src/presentation/api/emergency_response/services.py:153:44: ARG002 Unused method argument: `action`
    |
151 |                 logger.error(f"Action {action.action_type} failed: {e}")
152 |
153 |     async def _execute_single_action(self, action: ResponseAction):
    |                                            ^^^^^^ ARG002
154 |         """تنفيذ إجراء واحد."""
155 |         # تنفيذ مؤقت - في الواقع سيتم استدعاء الخدمات المناسبة
    |

src/presentation/api/emergency_response/services.py:176:13: TRY300 Consider moving this statement to an `else` block
    |
174 |                 }
175 |                 logs.append(log_entry)
176 |             return logs
    |             ^^^^^^^^^^^ TRY300
177 |         except Exception as e:
178 |             logger.error(f"Error fetching emergency logs: {e}")
    |

src/presentation/api/emergency_response/services.py:178:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
176 |             return logs
177 |         except Exception as e:
178 |             logger.error(f"Error fetching emergency logs: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
179 |             return []
    |
    = help: Replace with `exception`

src/presentation/api/emergency_response/services.py:229:62: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
227 |             return SystemStatus(
228 |                 service_name=service,
229 |                 status=("healthy" if response.status_code == 200 else "unhealthy"),
    |                                                              ^^^ PLR2004
230 |                 last_check=end_time,
231 |                 response_time_ms=response_time,
    |

src/presentation/api/emergency_response/services.py:234:48: PLR2004 Magic value used in comparison, consider replacing `200` with a constant variable
    |
232 |                 error_message=(
233 |                     None
234 |                     if response.status_code == 200
    |                                                ^^^ PLR2004
235 |                     else f"HTTP {response.status_code}"
236 |                 ),
    |

src/presentation/api/emergency_response/services.py:267:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
265 |                 }
266 |             except Exception as e:
267 |                 logger.error(f"Error getting Redis info: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
268 |
269 |             # عدد التنبيهات النشطة
    |
    = help: Replace with `exception`

src/presentation/api/emergency_response/services.py:274:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
272 |                 metrics["alerts_count"] = len(alert_keys)
273 |             except Exception as e:
274 |                 logger.error(f"Error counting alerts: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
275 |
276 |             return metrics
    |
    = help: Replace with `exception`

src/presentation/api/emergency_response/services.py:276:13: TRY300 Consider moving this statement to an `else` block
    |
274 |                 logger.error(f"Error counting alerts: {e}")
275 |
276 |             return metrics
    |             ^^^^^^^^^^^^^^ TRY300
277 |         except Exception as e:
278 |             logger.error(f"Error getting system metrics: {e}")
    |

src/presentation/api/emergency_response/services.py:278:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
276 |             return metrics
277 |         except Exception as e:
278 |             logger.error(f"Error getting system metrics: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
279 |             return {"error": str(e)}
    |
    = help: Replace with `exception`

src/presentation/api/emergency_response/services.py:302:13: TRY300 Consider moving this statement to an `else` block
    |
300 |             await self.redis.lpush("notification_queue", json.dumps(notification_data))
301 |             logger.info(f"Notification queued for alert {request.alert_id}")
302 |             return True
    |             ^^^^^^^^^^^ TRY300
303 |         except Exception as e:
304 |             logger.error(f"Failed to queue notification: {e}")
    |

src/presentation/api/emergency_response/services.py:304:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
302 |             return True
303 |         except Exception as e:
304 |             logger.error(f"Failed to queue notification: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
305 |             return False
    |
    = help: Replace with `exception`

src/presentation/api/emergency_response/services.py:325:13: TRY300 Consider moving this statement to an `else` block
    |
323 |                 }
324 |                 notifications.append(notification)
325 |             return notifications
    |             ^^^^^^^^^^^^^^^^^^^^ TRY300
326 |         except Exception as e:
327 |             logger.error(f"Error fetching notification history: {e}")
    |

src/presentation/api/emergency_response/services.py:327:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
325 |             return notifications
326 |         except Exception as e:
327 |             logger.error(f"Error fetching notification history: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
328 |             return []
    |
    = help: Replace with `exception`

src/presentation/api/emergency_response/services.py:347:13: TRY300 Consider moving this statement to an `else` block
    |
346 |             logger.critical(f"Emergency SMS queued for {len(phone_numbers)} recipients")
347 |             return True
    |             ^^^^^^^^^^^ TRY300
348 |         except Exception as e:
349 |             logger.error(f"Failed to queue emergency SMS: {e}")
    |

src/presentation/api/emergency_response/services.py:349:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
347 |             return True
348 |         except Exception as e:
349 |             logger.error(f"Failed to queue emergency SMS: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
350 |             return False
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/audio.py:2:1: I001 [*] Import block is un-sorted or un-formatted
   |
 1 |   # Standard library imports
 2 | / from typing import Any
 3 | | # Third-party imports
 4 | | from fastapi import APIRouter, Depends, File, UploadFile
 5 | | from fastapi.responses import StreamingResponse
 6 | | # Local imports
 7 | | from src.application.services.audio_processing_service import AudioProcessingService
 8 | | from src.infrastructure.security.real_auth_service import UserInfo, get_current_user
 9 | | from src.presentation.api.dependencies import get_audio_processing_service
   | |__________________________________________________________________________^ I001
10 |
11 |   router = APIRouter()
   |
   = help: Organize imports

src/presentation/api/endpoints/audio.py:17:89: E501 Line too long (108 > 88)
   |
15 |     response_class=StreamingResponse,
16 |     summary="Transcribe audio file",
17 |     description="Transcribes an uploaded audio file and processes it to generate a child-safe AI response.",
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^ E501
18 | )
19 | async def transcribe_audio(
   |

src/presentation/api/endpoints/audio.py:20:30: B008 Do not perform function call `File` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
18 | )
19 | async def transcribe_audio(
20 |     audio_file: UploadFile = File(..., description="The audio file to transcribe (e.g., WAV, MP3)."),
   |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
21 |     child_context: dict[str, Any] | None = None,
22 |     voice_service: AudioProcessingService = Depends(get_audio_processing_service),
   |

src/presentation/api/endpoints/audio.py:20:89: E501 Line too long (101 > 88)
   |
18 | )
19 | async def transcribe_audio(
20 |     audio_file: UploadFile = File(..., description="The audio file to transcribe (e.g., WAV, MP3)."),
   |                                                                                         ^^^^^^^^^^^^^ E501
21 |     child_context: dict[str, Any] | None = None,
22 |     voice_service: AudioProcessingService = Depends(get_audio_processing_service),
   |

src/presentation/api/endpoints/audio.py:22:45: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
20 |     audio_file: UploadFile = File(..., description="The audio file to transcribe (e.g., WAV, MP3)."),
21 |     child_context: dict[str, Any] | None = None,
22 |     voice_service: AudioProcessingService = Depends(get_audio_processing_service),
   |                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
23 |     current_user: UserInfo = Depends(get_current_user),
24 | ) -> StreamingResponse:
   |

src/presentation/api/endpoints/audio.py:23:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
21 |     child_context: dict[str, Any] | None = None,
22 |     voice_service: AudioProcessingService = Depends(get_audio_processing_service),
23 |     current_user: UserInfo = Depends(get_current_user),
   |                              ^^^^^^^^^^^^^^^^^^^^^^^^^ B008
24 | ) -> StreamingResponse:
25 |     """Transcribes an uploaded audio file and processes it to generate a child-safe AI response."""
   |

src/presentation/api/endpoints/audio.py:25:89: E501 Line too long (99 > 88)
   |
23 |     current_user: UserInfo = Depends(get_current_user),
24 | ) -> StreamingResponse:
25 |     """Transcribes an uploaded audio file and processes it to generate a child-safe AI response."""
   |                                                                                         ^^^^^^^^^^^ E501
26 |     # Implementation here
27 |     pass
   |

src/presentation/api/endpoints/auth.py:1:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | from src.presentation.api.models.validation_models import LoginRequest
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ I001
2 | """API endpoints for authentication and authorization"""
  |
  = help: Organize imports

src/presentation/api/endpoints/auth.py:1:59: F401 [*] `src.presentation.api.models.validation_models.LoginRequest` imported but unused
  |
1 | from src.presentation.api.models.validation_models import LoginRequest
  |                                                           ^^^^^^^^^^^^ F401
2 | """API endpoints for authentication and authorization"""
  |
  = help: Remove unused import: `src.presentation.api.models.validation_models.LoginRequest`

src/presentation/api/endpoints/auth.py:4:1: E402 Module level import not at top of file
  |
2 | """API endpoints for authentication and authorization"""
3 |
4 | from datetime import datetime
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
5 |
6 | from fastapi import APIRouter, Depends, HTTPException, Request, status
  |

src/presentation/api/endpoints/auth.py:4:22: F401 [*] `datetime.datetime` imported but unused
  |
2 | """API endpoints for authentication and authorization"""
3 |
4 | from datetime import datetime
  |                      ^^^^^^^^ F401
5 |
6 | from fastapi import APIRouter, Depends, HTTPException, Request, status
  |
  = help: Remove unused import: `datetime.datetime`

src/presentation/api/endpoints/auth.py:6:1: E402 Module level import not at top of file
  |
4 | from datetime import datetime
5 |
6 | from fastapi import APIRouter, Depends, HTTPException, Request, status
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
8 | from pydantic import BaseModel, EmailStr
  |

src/presentation/api/endpoints/auth.py:6:32: F401 [*] `fastapi.Depends` imported but unused
  |
4 | from datetime import datetime
5 |
6 | from fastapi import APIRouter, Depends, HTTPException, Request, status
  |                                ^^^^^^^ F401
7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
8 | from pydantic import BaseModel, EmailStr
  |
  = help: Remove unused import

src/presentation/api/endpoints/auth.py:6:41: F401 [*] `fastapi.HTTPException` imported but unused
  |
4 | from datetime import datetime
5 |
6 | from fastapi import APIRouter, Depends, HTTPException, Request, status
  |                                         ^^^^^^^^^^^^^ F401
7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
8 | from pydantic import BaseModel, EmailStr
  |
  = help: Remove unused import

src/presentation/api/endpoints/auth.py:6:65: F401 [*] `fastapi.status` imported but unused
  |
4 | from datetime import datetime
5 |
6 | from fastapi import APIRouter, Depends, HTTPException, Request, status
  |                                                                 ^^^^^^ F401
7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
8 | from pydantic import BaseModel, EmailStr
  |
  = help: Remove unused import

src/presentation/api/endpoints/auth.py:7:1: E402 Module level import not at top of file
  |
6 | from fastapi import APIRouter, Depends, HTTPException, Request, status
7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
8 | from pydantic import BaseModel, EmailStr
  |

src/presentation/api/endpoints/auth.py:7:30: F401 [*] `fastapi.security.HTTPAuthorizationCredentials` imported but unused
  |
6 | from fastapi import APIRouter, Depends, HTTPException, Request, status
7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
  |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ F401
8 | from pydantic import BaseModel, EmailStr
  |
  = help: Remove unused import: `fastapi.security.HTTPAuthorizationCredentials`

src/presentation/api/endpoints/auth.py:8:1: E402 Module level import not at top of file
   |
 6 | from fastapi import APIRouter, Depends, HTTPException, Request, status
 7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
 8 | from pydantic import BaseModel, EmailStr
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
 9 |
10 | from src.infrastructure.di.container import container
   |

src/presentation/api/endpoints/auth.py:8:22: F401 [*] `pydantic.BaseModel` imported but unused
   |
 6 | from fastapi import APIRouter, Depends, HTTPException, Request, status
 7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
 8 | from pydantic import BaseModel, EmailStr
   |                      ^^^^^^^^^ F401
 9 |
10 | from src.infrastructure.di.container import container
   |
   = help: Remove unused import

src/presentation/api/endpoints/auth.py:8:33: F401 [*] `pydantic.EmailStr` imported but unused
   |
 6 | from fastapi import APIRouter, Depends, HTTPException, Request, status
 7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
 8 | from pydantic import BaseModel, EmailStr
   |                                 ^^^^^^^^ F401
 9 |
10 | from src.infrastructure.di.container import container
   |
   = help: Remove unused import

src/presentation/api/endpoints/auth.py:10:1: E402 Module level import not at top of file
   |
 8 | from pydantic import BaseModel, EmailStr
 9 |
10 | from src.infrastructure.di.container import container
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
11 | from src.infrastructure.logging_config import get_logger
12 | from src.infrastructure.security.rate_limiter_service import RateLimiterService
   |

src/presentation/api/endpoints/auth.py:10:45: F401 [*] `src.infrastructure.di.container.container` imported but unused
   |
 8 | from pydantic import BaseModel, EmailStr
 9 |
10 | from src.infrastructure.di.container import container
   |                                             ^^^^^^^^^ F401
11 | from src.infrastructure.logging_config import get_logger
12 | from src.infrastructure.security.rate_limiter_service import RateLimiterService
   |
   = help: Remove unused import: `src.infrastructure.di.container.container`

src/presentation/api/endpoints/auth.py:11:1: E402 Module level import not at top of file
   |
10 | from src.infrastructure.di.container import container
11 | from src.infrastructure.logging_config import get_logger
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
12 | from src.infrastructure.security.rate_limiter_service import RateLimiterService
13 | from src.infrastructure.security.real_auth_service import (
   |

src/presentation/api/endpoints/auth.py:12:1: E402 Module level import not at top of file
   |
10 | from src.infrastructure.di.container import container
11 | from src.infrastructure.logging_config import get_logger
12 | from src.infrastructure.security.rate_limiter_service import RateLimiterService
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
13 | from src.infrastructure.security.real_auth_service import (
14 |     ProductionAuthService,
   |

src/presentation/api/endpoints/auth.py:12:62: F401 [*] `src.infrastructure.security.rate_limiter_service.RateLimiterService` imported but unused
   |
10 | from src.infrastructure.di.container import container
11 | from src.infrastructure.logging_config import get_logger
12 | from src.infrastructure.security.rate_limiter_service import RateLimiterService
   |                                                              ^^^^^^^^^^^^^^^^^^ F401
13 | from src.infrastructure.security.real_auth_service import (
14 |     ProductionAuthService,
   |
   = help: Remove unused import: `src.infrastructure.security.rate_limiter_service.RateLimiterService`

src/presentation/api/endpoints/auth.py:13:1: E402 Module level import not at top of file
   |
11 |   from src.infrastructure.logging_config import get_logger
12 |   from src.infrastructure.security.rate_limiter_service import RateLimiterService
13 | / from src.infrastructure.security.real_auth_service import (
14 | |     ProductionAuthService,
15 | | )
   | |_^ E402
16 |   from src.presentation.api.decorators.rate_limit import moderate_limit, strict_limit
   |

src/presentation/api/endpoints/auth.py:14:5: F401 [*] `src.infrastructure.security.real_auth_service.ProductionAuthService` imported but unused
   |
12 | from src.infrastructure.security.rate_limiter_service import RateLimiterService
13 | from src.infrastructure.security.real_auth_service import (
14 |     ProductionAuthService,
   |     ^^^^^^^^^^^^^^^^^^^^^ F401
15 | )
16 | from src.presentation.api.decorators.rate_limit import moderate_limit, strict_limit
   |
   = help: Remove unused import: `src.infrastructure.security.real_auth_service.ProductionAuthService`

src/presentation/api/endpoints/auth.py:16:1: E402 Module level import not at top of file
   |
14 |     ProductionAuthService,
15 | )
16 | from src.presentation.api.decorators.rate_limit import moderate_limit, strict_limit
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
17 |
18 | logger = get_logger(__name__, component="api")
   |

src/presentation/api/endpoints/auth.py:16:56: F401 [*] `src.presentation.api.decorators.rate_limit.moderate_limit` imported but unused
   |
14 |     ProductionAuthService,
15 | )
16 | from src.presentation.api.decorators.rate_limit import moderate_limit, strict_limit
   |                                                        ^^^^^^^^^^^^^^ F401
17 |
18 | logger = get_logger(__name__, component="api")
   |
   = help: Remove unused import

src/presentation/api/endpoints/auth.py:16:72: F401 [*] `src.presentation.api.decorators.rate_limit.strict_limit` imported but unused
   |
14 |     ProductionAuthService,
15 | )
16 | from src.presentation.api.decorators.rate_limit import moderate_limit, strict_limit
   |                                                                        ^^^^^^^^^^^^ F401
17 |
18 | logger = get_logger(__name__, component="api")
   |
   = help: Remove unused import

src/presentation/api/endpoints/auth/routes_di.py:1:1: I001 [*] Import block is un-sorted or un-formatted
   |
 1 | / from src.presentation.api.models.validation_models import LoginRequest, LoginResponse
 2 | | from datetime import datetime
 3 | | from typing import Any
 4 | |
 5 | | from dependency_injector.wiring import Provide, inject
 6 | | from fastapi import APIRouter, Depends, HTTPException, status
 7 | | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
 8 | | from pydantic import BaseModel, EmailStr
 9 | |
10 | | from src.infrastructure.di.container import Container
11 | | from src.infrastructure.logging_config import get_logger
   | |________________________________________________________^ I001
12 |
13 |   logger = get_logger(__name__, component="api")
   |
   = help: Organize imports

src/presentation/api/endpoints/auth/routes_di.py:1:59: F401 [*] `src.presentation.api.models.validation_models.LoginRequest` imported but unused
  |
1 | from src.presentation.api.models.validation_models import LoginRequest, LoginResponse
  |                                                           ^^^^^^^^^^^^ F401
2 | from datetime import datetime
3 | from typing import Any
  |
  = help: Remove unused import

src/presentation/api/endpoints/auth/routes_di.py:1:73: F401 [*] `src.presentation.api.models.validation_models.LoginResponse` imported but unused
  |
1 | from src.presentation.api.models.validation_models import LoginRequest, LoginResponse
  |                                                                         ^^^^^^^^^^^^^ F401
2 | from datetime import datetime
3 | from typing import Any
  |
  = help: Remove unused import

src/presentation/api/endpoints/auth/routes_di.py:2:22: F401 [*] `datetime.datetime` imported but unused
  |
1 | from src.presentation.api.models.validation_models import LoginRequest, LoginResponse
2 | from datetime import datetime
  |                      ^^^^^^^^ F401
3 | from typing import Any
  |
  = help: Remove unused import: `datetime.datetime`

src/presentation/api/endpoints/auth/routes_di.py:3:20: F401 [*] `typing.Any` imported but unused
  |
1 | from src.presentation.api.models.validation_models import LoginRequest, LoginResponse
2 | from datetime import datetime
3 | from typing import Any
  |                    ^^^ F401
4 |
5 | from dependency_injector.wiring import Provide, inject
  |
  = help: Remove unused import: `typing.Any`

src/presentation/api/endpoints/auth/routes_di.py:5:40: F401 [*] `dependency_injector.wiring.Provide` imported but unused
  |
3 | from typing import Any
4 |
5 | from dependency_injector.wiring import Provide, inject
  |                                        ^^^^^^^ F401
6 | from fastapi import APIRouter, Depends, HTTPException, status
7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
  |
  = help: Remove unused import

src/presentation/api/endpoints/auth/routes_di.py:5:49: F401 [*] `dependency_injector.wiring.inject` imported but unused
  |
3 | from typing import Any
4 |
5 | from dependency_injector.wiring import Provide, inject
  |                                                 ^^^^^^ F401
6 | from fastapi import APIRouter, Depends, HTTPException, status
7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
  |
  = help: Remove unused import

src/presentation/api/endpoints/auth/routes_di.py:6:32: F401 [*] `fastapi.Depends` imported but unused
  |
5 | from dependency_injector.wiring import Provide, inject
6 | from fastapi import APIRouter, Depends, HTTPException, status
  |                                ^^^^^^^ F401
7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
8 | from pydantic import BaseModel, EmailStr
  |
  = help: Remove unused import

src/presentation/api/endpoints/auth/routes_di.py:6:41: F401 [*] `fastapi.HTTPException` imported but unused
  |
5 | from dependency_injector.wiring import Provide, inject
6 | from fastapi import APIRouter, Depends, HTTPException, status
  |                                         ^^^^^^^^^^^^^ F401
7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
8 | from pydantic import BaseModel, EmailStr
  |
  = help: Remove unused import

src/presentation/api/endpoints/auth/routes_di.py:6:56: F401 [*] `fastapi.status` imported but unused
  |
5 | from dependency_injector.wiring import Provide, inject
6 | from fastapi import APIRouter, Depends, HTTPException, status
  |                                                        ^^^^^^ F401
7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
8 | from pydantic import BaseModel, EmailStr
  |
  = help: Remove unused import

src/presentation/api/endpoints/auth/routes_di.py:7:30: F401 [*] `fastapi.security.HTTPAuthorizationCredentials` imported but unused
  |
5 | from dependency_injector.wiring import Provide, inject
6 | from fastapi import APIRouter, Depends, HTTPException, status
7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
  |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ F401
8 | from pydantic import BaseModel, EmailStr
  |
  = help: Remove unused import: `fastapi.security.HTTPAuthorizationCredentials`

src/presentation/api/endpoints/auth/routes_di.py:8:22: F401 [*] `pydantic.BaseModel` imported but unused
   |
 6 | from fastapi import APIRouter, Depends, HTTPException, status
 7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
 8 | from pydantic import BaseModel, EmailStr
   |                      ^^^^^^^^^ F401
 9 |
10 | from src.infrastructure.di.container import Container
   |
   = help: Remove unused import

src/presentation/api/endpoints/auth/routes_di.py:8:33: F401 [*] `pydantic.EmailStr` imported but unused
   |
 6 | from fastapi import APIRouter, Depends, HTTPException, status
 7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
 8 | from pydantic import BaseModel, EmailStr
   |                                 ^^^^^^^^ F401
 9 |
10 | from src.infrastructure.di.container import Container
   |
   = help: Remove unused import

src/presentation/api/endpoints/auth/routes_di.py:10:45: F401 [*] `src.infrastructure.di.container.Container` imported but unused
   |
 8 | from pydantic import BaseModel, EmailStr
 9 |
10 | from src.infrastructure.di.container import Container
   |                                             ^^^^^^^^^ F401
11 | from src.infrastructure.logging_config import get_logger
   |
   = help: Remove unused import: `src.infrastructure.di.container.Container`

src/presentation/api/endpoints/chatgpt.py:261:9: SyntaxError: Expected ',', found ']'
    |
259 |             "activities": ["Complex Games", "Creative Projects", "Debates"],
260 |             "learning_goals": ["Advanced thinking", "Ethical reasoning"],
261 |         ],
    |         ^
262 |     }
    |

src/presentation/api/endpoints/chatgpt.py:261:10: SyntaxError: Expected an expression or a '}'
    |
259 |             "activities": ["Complex Games", "Creative Projects", "Debates"],
260 |             "learning_goals": ["Advanced thinking", "Ethical reasoning"],
261 |         ],
    |          ^
262 |     }
    |

src/presentation/api/endpoints/chatgpt.py:262:6: SyntaxError: Expected ',', found newline
    |
260 |             "learning_goals": ["Advanced thinking", "Ethical reasoning"],
261 |         ],
262 |     }
    |      ^
263 |
264 |     topics = topics_by_age.get(child_age, topics_by_age[6])
    |

src/presentation/api/endpoints/chatgpt.py:264:12: SyntaxError: Expected ':', found '='
    |
262 |     }
263 |
264 |     topics = topics_by_age.get(child_age, topics_by_age[6])
    |            ^
265 |
266 |     return {
    |

src/presentation/api/endpoints/chatgpt.py:264:60: SyntaxError: Expected ':', found newline
    |
262 |     }
263 |
264 |     topics = topics_by_age.get(child_age, topics_by_age[6])
    |                                                            ^
265 |
266 |     return {
267 |         "age": child_age,
    |

src/presentation/api/endpoints/chatgpt.py:266:5: SyntaxError: Expected '}', found 'return'
    |
264 |     topics = topics_by_age.get(child_age, topics_by_age[6])
265 |
266 |     return {
    |     ^^^^^^
267 |         "age": child_age,
268 |         "topics": topics,
    |

src/presentation/api/endpoints/children/__init__.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Children Endpoints Package - Modular structure for better organization
2 | |
3 | | This package provides child-safe API endpoints with COPPA compliance,
4 | | comprehensive safety monitoring, and parental control features.
5 | | """
  | |___^ D415
6 |
7 |   # Standard library imports
  |
  = help: Add closing punctuation

src/presentation/api/endpoints/children/__init__.py:19:29: ARG002 Unused method argument: `args`
   |
17 |     # Define mock classes when FastAPI is not available
18 |     class APIRouter:
19 |         def __init__(self, *args, **kwargs) -> None:
   |                             ^^^^ ARG002
20 |             self.prefix = kwargs.get("prefix", "")
21 |             self.tags = kwargs.get("tags", [])
   |

src/presentation/api/endpoints/children/__init__.py:51:11: N818 Exception name `HTTPException` should be named with an Error suffix
   |
49 |             return decorator
50 |
51 |     class HTTPException(Exception):
   |           ^^^^^^^^^^^^^ N818
52 |         def __init__(self, status_code: int, detail: str) -> None:
53 |             self.status_code = status_code
   |

src/presentation/api/endpoints/children/__init__.py:56:11: N801 Class name `status` should use CapWords convention
   |
54 |             self.detail = detail
55 |
56 |     class status:
   |           ^^^^^^ N801
57 |         HTTP_200_OK = 200
58 |         HTTP_201_CREATED = 201
   |

src/presentation/api/endpoints/children/__init__.py:126:11: RUF022 `__all__` is not sorted
    |
125 |   # Export router for use in main application
126 |   __all__ = [
    |  ___________^
127 | |     # FastAPI Router
128 | |     "router",
129 | |     # Compliance
130 | |     "COPPAIntegration",
131 | |     "handle_compliant_child_deletion",
132 | |     "request_parental_consent",
133 | |     "validate_child_creation_compliance",
134 | |     "validate_data_access_permission",
135 | |     # Models
136 | |     "ChildCreateRequest",
137 | |     "ChildDeleteResponse",
138 | |     "ChildResponse",
139 | |     "ChildSafetySummary",
140 | |     "ChildUpdateRequest",
141 | |     # Operations
142 | |     "ChildOperations",
143 | |     "create_child",
144 | |     "delete_child",
145 | |     "get_child",
146 | |     "get_children",
147 | |     "update_child",
148 | |     # Safety
149 | |     "ChildSafetyManager",
150 | |     "ContentSafetyFilter",
151 | |     "PrivacyProtectionManager",
152 | |     "SafetyEventTypes",
153 | |     "UsageMonitor",
154 | |     "get_child_safety_summary",
155 | |     "record_safety_event",
156 | |     "track_child_usage",
157 | |     "validate_interaction_safety",
158 | | ]
    | |_^ RUF022
    |
    = help: Apply an isort-style sorting to `__all__`

src/presentation/api/endpoints/children/compliance.py:2:1: I001 [*] Import block is un-sorted or un-formatted
   |
 1 |   """Children compliance endpoints with COPPA support."""
 2 | / from datetime import datetime
 3 | | from typing import List, Optional
 4 | |
 5 | | from fastapi import APIRouter, Depends, HTTPException, status
 6 | | from pydantic import BaseModel, Field
 7 | |
 8 | | from src.infrastructure.security.coppa_validator import (
 9 | |     COPPAValidator,
10 | |     coppa_validator,
11 | |     is_coppa_subject,
12 | |     requires_parental_consent
13 | | )
14 | | from src.infrastructure.config.settings import Settings, get_settings
15 | | from src.infrastructure.security.coppa import COPPAConsentManager, get_consent_manager
16 | | from src.infrastructure.logging_config import get_logger
   | |________________________________________________________^ I001
17 |
18 |   logger = get_logger(__name__)
   |
   = help: Organize imports

src/presentation/api/endpoints/children/compliance.py:3:1: UP035 `typing.List` is deprecated, use `list` instead
  |
1 | """Children compliance endpoints with COPPA support."""
2 | from datetime import datetime
3 | from typing import List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
4 |
5 | from fastapi import APIRouter, Depends, HTTPException, status
  |

src/presentation/api/endpoints/children/compliance.py:3:26: F401 [*] `typing.Optional` imported but unused
  |
1 | """Children compliance endpoints with COPPA support."""
2 | from datetime import datetime
3 | from typing import List, Optional
  |                          ^^^^^^^^ F401
4 |
5 | from fastapi import APIRouter, Depends, HTTPException, status
  |
  = help: Remove unused import: `typing.Optional`

src/presentation/api/endpoints/children/compliance.py:5:41: F401 [*] `fastapi.HTTPException` imported but unused
  |
3 | from typing import List, Optional
4 |
5 | from fastapi import APIRouter, Depends, HTTPException, status
  |                                         ^^^^^^^^^^^^^ F401
6 | from pydantic import BaseModel, Field
  |
  = help: Remove unused import

src/presentation/api/endpoints/children/compliance.py:5:56: F401 [*] `fastapi.status` imported but unused
  |
3 | from typing import List, Optional
4 |
5 | from fastapi import APIRouter, Depends, HTTPException, status
  |                                                        ^^^^^^ F401
6 | from pydantic import BaseModel, Field
  |
  = help: Remove unused import

src/presentation/api/endpoints/children/compliance.py:10:5: F401 [*] `src.infrastructure.security.coppa_validator.coppa_validator` imported but unused
   |
 8 | from src.infrastructure.security.coppa_validator import (
 9 |     COPPAValidator,
10 |     coppa_validator,
   |     ^^^^^^^^^^^^^^^ F401
11 |     is_coppa_subject,
12 |     requires_parental_consent
   |
   = help: Remove unused import

src/presentation/api/endpoints/children/compliance.py:11:5: F401 [*] `src.infrastructure.security.coppa_validator.is_coppa_subject` imported but unused
   |
 9 |     COPPAValidator,
10 |     coppa_validator,
11 |     is_coppa_subject,
   |     ^^^^^^^^^^^^^^^^ F401
12 |     requires_parental_consent
13 | )
   |
   = help: Remove unused import

src/presentation/api/endpoints/children/compliance.py:12:5: F401 [*] `src.infrastructure.security.coppa_validator.requires_parental_consent` imported but unused
   |
10 |     coppa_validator,
11 |     is_coppa_subject,
12 |     requires_parental_consent
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^ F401
13 | )
14 | from src.infrastructure.config.settings import Settings, get_settings
   |
   = help: Remove unused import

src/presentation/api/endpoints/children/compliance.py:26:17: UP006 [*] Use `list` instead of `List` for type annotation
   |
24 |     child_id: str = Field(..., description="Child identifier")
25 |     parent_id: str = Field(..., description="Parent identifier")
26 |     data_types: List[str] = Field(..., description="Data types requiring consent")
   |                 ^^^^ UP006
27 |
28 | class ConsentResponse(BaseModel):
   |
   = help: Replace with `list`

src/presentation/api/endpoints/children/compliance.py:36:1: W293 [*] Blank line contains whitespace
   |
34 | class ComplianceValidator:
35 |     """Compliance validation service."""
36 |     
   | ^^^^ W293
37 |     def __init__(self, settings: Settings):
38 |         self.settings = settings
   |
   = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:40:1: W293 [*] Blank line contains whitespace
   |
38 |         self.settings = settings
39 |         self.coppa = COPPAValidator()
40 |     
   | ^^^^ W293
41 |     def validate_age_compliance(self, age: int) -> dict:
42 |         """Validate age compliance requirements."""
   |
   = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:45:39: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
   |
43 |         return {
44 |             "compliant": True,
45 |             "requires_consent": age < 13,
   |                                       ^^ PLR2004
46 |             "compliance_level": str(ComplianceLevel.from_age(age))
47 |         }
   |

src/presentation/api/endpoints/children/compliance.py:46:37: F821 Undefined name `ComplianceLevel`
   |
44 |             "compliant": True,
45 |             "requires_consent": age < 13,
46 |             "compliance_level": str(ComplianceLevel.from_age(age))
   |                                     ^^^^^^^^^^^^^^^ F821
47 |         }
   |

src/presentation/api/endpoints/children/compliance.py:48:1: W293 [*] Blank line contains whitespace
   |
46 |             "compliance_level": str(ComplianceLevel.from_age(age))
47 |         }
48 |     
   | ^^^^ W293
49 |     def validate_data_collection(self, data_types: List[str], child_age: int) -> dict:
50 |         """Validate data collection compliance."""
   |
   = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:49:52: UP006 [*] Use `list` instead of `List` for type annotation
   |
47 |         }
48 |     
49 |     def validate_data_collection(self, data_types: List[str], child_age: int) -> dict:
   |                                                    ^^^^ UP006
50 |         """Validate data collection compliance."""
51 |         if child_age < 13:
   |
   = help: Replace with `list`

src/presentation/api/endpoints/children/compliance.py:51:24: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
   |
49 |     def validate_data_collection(self, data_types: List[str], child_age: int) -> dict:
50 |         """Validate data collection compliance."""
51 |         if child_age < 13:
   |                        ^^ PLR2004
52 |             allowed = [str(DataType.VOICE_INTERACTIONS), str(DataType.PREFERENCES)]
53 |             disallowed = [dt for dt in data_types if dt not in allowed]
   |

src/presentation/api/endpoints/children/compliance.py:52:28: F821 Undefined name `DataType`
   |
50 |         """Validate data collection compliance."""
51 |         if child_age < 13:
52 |             allowed = [str(DataType.VOICE_INTERACTIONS), str(DataType.PREFERENCES)]
   |                            ^^^^^^^^ F821
53 |             disallowed = [dt for dt in data_types if dt not in allowed]
   |

src/presentation/api/endpoints/children/compliance.py:52:62: F821 Undefined name `DataType`
   |
50 |         """Validate data collection compliance."""
51 |         if child_age < 13:
52 |             allowed = [str(DataType.VOICE_INTERACTIONS), str(DataType.PREFERENCES)]
   |                                                              ^^^^^^^^ F821
53 |             disallowed = [dt for dt in data_types if dt not in allowed]
   |

src/presentation/api/endpoints/children/compliance.py:54:1: W293 [*] Blank line contains whitespace
   |
52 |             allowed = [str(DataType.VOICE_INTERACTIONS), str(DataType.PREFERENCES)]
53 |             disallowed = [dt for dt in data_types if dt not in allowed]
54 |             
   | ^^^^^^^^^^^^ W293
55 |             return {
56 |                 "compliant": len(disallowed) == 0,
   |
   = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:60:1: W293 [*] Blank line contains whitespace
   |
58 |                 "disallowed_types": disallowed
59 |             }
60 |         
   | ^^^^^^^^ W293
61 |         return {
62 |             "compliant": True,
   |
   = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:69:1: W293 [*] Blank line contains whitespace
   |
67 | class DataRetentionManager:
68 |     """Data retention management."""
69 |     
   | ^^^^ W293
70 |     def __init__(self, coppa_service: COPPAValidator):
71 |         self.coppa = coppa_service
   |
   = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:72:1: W293 [*] Blank line contains whitespace
   |
70 |     def __init__(self, coppa_service: COPPAValidator):
71 |         self.coppa = coppa_service
72 |     
   | ^^^^ W293
73 |     async def schedule_data_deletion(self, child_id: str, deletion_date: datetime) -> bool:
74 |         """Schedule data deletion according to retention policy."""
   |
   = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:73:44: ARG002 Unused method argument: `child_id`
   |
71 |         self.coppa = coppa_service
72 |     
73 |     async def schedule_data_deletion(self, child_id: str, deletion_date: datetime) -> bool:
   |                                            ^^^^^^^^ ARG002
74 |         """Schedule data deletion according to retention policy."""
75 |         # Implementation would schedule deletion
   |

src/presentation/api/endpoints/children/compliance.py:73:59: ARG002 Unused method argument: `deletion_date`
   |
71 |         self.coppa = coppa_service
72 |     
73 |     async def schedule_data_deletion(self, child_id: str, deletion_date: datetime) -> bool:
   |                                                           ^^^^^^^^^^^^^ ARG002
74 |         """Schedule data deletion according to retention policy."""
75 |         # Implementation would schedule deletion
   |

src/presentation/api/endpoints/children/compliance.py:73:89: E501 Line too long (91 > 88)
   |
71 |         self.coppa = coppa_service
72 |     
73 |     async def schedule_data_deletion(self, child_id: str, deletion_date: datetime) -> bool:
   |                                                                                         ^^^ E501
74 |         """Schedule data deletion according to retention policy."""
75 |         # Implementation would schedule deletion
   |

src/presentation/api/endpoints/children/compliance.py:77:1: W293 [*] Blank line contains whitespace
   |
75 |         # Implementation would schedule deletion
76 |         return True
77 |     
   | ^^^^ W293
78 |     async def check_retention_compliance(self, child_id: str) -> dict:
79 |         """Check if data retention is compliant."""
   |
   = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:78:48: ARG002 Unused method argument: `child_id`
   |
76 |         return True
77 |     
78 |     async def check_retention_compliance(self, child_id: str) -> dict:
   |                                                ^^^^^^^^ ARG002
79 |         """Check if data retention is compliant."""
80 |         return {
   |

src/presentation/api/endpoints/children/compliance.py:88:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
86 | # Dependency injection
87 | def get_compliance_validator(
88 |     settings: Settings = Depends(get_settings)
   |                          ^^^^^^^^^^^^^^^^^^^^^ B008
89 | ) -> ComplianceValidator:
90 |     """Get compliance validator instance."""
   |

src/presentation/api/endpoints/children/compliance.py:99:44: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
 97 | async def request_consent(
 98 |     request: ConsentRequest,
 99 |     consent_manager: COPPAConsentManager = Depends(get_consent_manager)
    |                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
100 | ) -> ConsentResponse:
101 |     """Request parental consent for data collection."""
    |

src/presentation/api/endpoints/children/compliance.py:107:1: W293 [*] Blank line contains whitespace
    |
105 |         request.data_types
106 |     )
107 |     
    | ^^^^ W293
108 |     return ConsentResponse(
109 |         consent_id=consent_id,
    |
    = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:117:38: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
115 | async def check_age_compliance(
116 |     age: int,
117 |     validator: ComplianceValidator = Depends(get_compliance_validator)
    |                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
118 | ) -> dict:
119 |     """Check compliance requirements for given age."""
    |

src/presentation/api/endpoints/children/compliance.py:123:1: W293 Blank line contains whitespace
    |
121 | class COPPAIntegration:
122 |     """COPPA Integration Service - Facade for all COPPA compliance operations.
123 |     
    | ^^^^ W293
124 |     This class provides a unified interface for COPPA-related functionality,
125 |     coordinating between validators, consent managers, and retention policies.
    |
    = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:127:1: W293 [*] Blank line contains whitespace
    |
125 |     coordinating between validators, consent managers, and retention policies.
126 |     """
127 |     
    | ^^^^ W293
128 |     def __init__(self, coppa_service: COPPAValidator, settings: Settings):
129 |         """Initialize COPPA integration with required services.
    |
    = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:130:1: W293 Blank line contains whitespace
    |
128 |     def __init__(self, coppa_service: COPPAValidator, settings: Settings):
129 |         """Initialize COPPA integration with required services.
130 |         
    | ^^^^^^^^ W293
131 |         Args:
132 |             coppa_service: Core COPPA validation service
    |
    = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:138:32: F821 Undefined name `ParentalConsentManager`
    |
136 |         self.settings = settings
137 |         self.compliance_validator = ComplianceValidator(settings)
138 |         self.consent_manager = ParentalConsentManager(coppa_service)
    |                                ^^^^^^^^^^^^^^^^^^^^^^ F821
139 |         self.retention_manager = DataRetentionManager(settings)
140 |         logger.info("COPPAIntegration initialized with all compliance components")
    |

src/presentation/api/endpoints/children/compliance.py:141:1: W293 [*] Blank line contains whitespace
    |
139 |         self.retention_manager = DataRetentionManager(settings)
140 |         logger.info("COPPAIntegration initialized with all compliance components")
141 |     
    | ^^^^ W293
142 |     def validate_child_creation(self, age: int, data_types: List[str]) -> dict:
143 |         """Validate if child profile can be created based on COPPA rules.
    |
    = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:142:61: UP006 [*] Use `list` instead of `List` for type annotation
    |
140 |         logger.info("COPPAIntegration initialized with all compliance components")
141 |     
142 |     def validate_child_creation(self, age: int, data_types: List[str]) -> dict:
    |                                                             ^^^^ UP006
143 |         """Validate if child profile can be created based on COPPA rules.
    |
    = help: Replace with `list`

src/presentation/api/endpoints/children/compliance.py:144:1: W293 Blank line contains whitespace
    |
142 |     def validate_child_creation(self, age: int, data_types: List[str]) -> dict:
143 |         """Validate if child profile can be created based on COPPA rules.
144 |         
    | ^^^^^^^^ W293
145 |         Args:
146 |             age: Child's age in years
    |
    = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:148:1: W293 Blank line contains whitespace
    |
146 |             age: Child's age in years
147 |             data_types: Types of data to be collected
148 |             
    | ^^^^^^^^^^^^ W293
149 |         Returns:
150 |             Validation result with compliance status and requirements
    |
    = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:153:89: E501 Line too long (93 > 88)
    |
151 |         """
152 |         age_compliance = self.compliance_validator.validate_age_compliance(age)
153 |         data_compliance = self.compliance_validator.validate_data_collection(data_types, age)
    |                                                                                         ^^^^^ E501
154 |         
155 |         return {
    |

src/presentation/api/endpoints/children/compliance.py:154:1: W293 [*] Blank line contains whitespace
    |
152 |         age_compliance = self.compliance_validator.validate_age_compliance(age)
153 |         data_compliance = self.compliance_validator.validate_data_collection(data_types, age)
154 |         
    | ^^^^^^^^ W293
155 |         return {
156 |             "age_compliance": age_compliance,
    |
    = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:158:48: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
    |
156 |             "age_compliance": age_compliance,
157 |             "data_compliance": data_compliance,
158 |             "requires_parental_consent": age < 13,
    |                                                ^^ PLR2004
159 |             "allowed_data_types": data_compliance.get("allowed_types", [])
160 |         }
    |

src/presentation/api/endpoints/children/compliance.py:161:1: W293 [*] Blank line contains whitespace
    |
159 |             "allowed_data_types": data_compliance.get("allowed_types", [])
160 |         }
161 |     
    | ^^^^ W293
162 |     def get_compliance_requirements(self, age: int) -> dict:
163 |         """Get COPPA compliance requirements for a given age.
    |
    = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:164:1: W293 Blank line contains whitespace
    |
162 |     def get_compliance_requirements(self, age: int) -> dict:
163 |         """Get COPPA compliance requirements for a given age.
164 |         
    | ^^^^^^^^ W293
165 |         Args:
166 |             age: Child's age in years
    |
    = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:167:1: W293 Blank line contains whitespace
    |
165 |         Args:
166 |             age: Child's age in years
167 |             
    | ^^^^^^^^^^^^ W293
168 |         Returns:
169 |             Dictionary of compliance requirements
    |
    = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:172:1: W293 [*] Blank line contains whitespace
    |
170 |         """
171 |         validation_result = self.coppa_service.validate_age(age)
172 |         
    | ^^^^^^^^ W293
173 |         return {
174 |             "is_coppa_subject": validation_result.is_coppa_subject,
    |
    = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:180:1: W293 [*] Blank line contains whitespace
    |
178 |             "special_protections": validation_result.special_protections
179 |         }
180 |     
    | ^^^^ W293
181 |     # Module-level functions for backward compatibility
182 | async def handle_compliant_child_deletion(child_id: str, user_id: str) -> dict:
    |
    = help: Remove whitespace from blank line

src/presentation/api/endpoints/children/compliance.py:182:58: ARG001 Unused function argument: `user_id`
    |
181 |     # Module-level functions for backward compatibility
182 | async def handle_compliant_child_deletion(child_id: str, user_id: str) -> dict:
    |                                                          ^^^^^^^ ARG001
183 |     """Handle COPPA-compliant child profile deletion."""
184 |     # Implementation would use the managers above
    |

src/presentation/api/endpoints/children/compliance.py:187:51: ARG001 Unused function argument: `parent_email`
    |
185 |     return {"status": "deleted", "child_id": child_id}
186 |
187 | async def request_parental_consent(child_id: str, parent_email: str) -> dict:
    |                                                   ^^^^^^^^^^^^ ARG001
188 |     """Request parental consent for child data collection."""
189 |     return {"status": "consent_requested", "child_id": child_id}
    |

src/presentation/api/endpoints/children/compliance.py:193:33: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
    |
191 | async def validate_child_creation_compliance(age: int, data_types: list) -> dict:
192 |     """Validate child creation request for COPPA compliance."""
193 |     return {"compliant": age >= 13 or len(data_types) == 0, "age": age}
    |                                 ^^ PLR2004
194 |
195 | async def validate_data_access_permission(child_id: str, requester_id: str) -> bool:
    |

src/presentation/api/endpoints/children/compliance.py:195:43: ARG001 Unused function argument: `child_id`
    |
193 |     return {"compliant": age >= 13 or len(data_types) == 0, "age": age}
194 |
195 | async def validate_data_access_permission(child_id: str, requester_id: str) -> bool:
    |                                           ^^^^^^^^ ARG001
196 |     """Validate data access permission for child data."""
197 |     return True  # Placeholder implementation
    |

src/presentation/api/endpoints/children/compliance.py:195:58: ARG001 Unused function argument: `requester_id`
    |
193 |     return {"compliant": age >= 13 or len(data_types) == 0, "age": age}
194 |
195 | async def validate_data_access_permission(child_id: str, requester_id: str) -> bool:
    |                                                          ^^^^^^^^^^^^ ARG001
196 |     """Validate data access permission for child data."""
197 |     return True  # Placeholder implementation
    |

src/presentation/api/endpoints/children/compliance.py:197:46: W292 [*] No newline at end of file
    |
195 | async def validate_data_access_permission(child_id: str, requester_id: str) -> bool:
196 |     """Validate data access permission for child data."""
197 |     return True  # Placeholder implementation
    |                                              ^ W292
    |
    = help: Add trailing newline

src/presentation/api/endpoints/children/create_child.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Child Creation Endpoint
2 | | Handles creating new child profiles with COPPA compliance.
3 | | """
  | |___^ D205
4 |
5 |   from typing import Any
  |
  = help: Insert single blank line

src/presentation/api/endpoints/children/create_child.py:25:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
23 | async def create_child_endpoint(
24 |     request: ChildCreateRequest,
25 |     current_user: User = Depends(container.auth_service.get_current_user),
   |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
26 |     manage_child_profile_use_case: ManageChildProfileUseCase = Depends(
27 |         Provide[container.manage_child_profile_use_case],
   |

src/presentation/api/endpoints/children/create_child.py:26:64: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
24 |       request: ChildCreateRequest,
25 |       current_user: User = Depends(container.auth_service.get_current_user),
26 |       manage_child_profile_use_case: ManageChildProfileUseCase = Depends(
   |  ________________________________________________________________^
27 | |         Provide[container.manage_child_profile_use_case],
28 | |     ),
   | |_____^ B008
29 |       coppa_integration: COPPAIntegration = Depends(
30 |           Provide[container.coppa_integration_service],
   |

src/presentation/api/endpoints/children/create_child.py:29:43: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
27 |           Provide[container.manage_child_profile_use_case],
28 |       ),
29 |       coppa_integration: COPPAIntegration = Depends(
   |  ___________________________________________^
30 | |         Provide[container.coppa_integration_service],
31 | |     ),
   | |_____^ B008
32 |       safety_monitor: SafetyMonitorService = Depends(Provide[container.safety_monitor]),
33 |   ) -> ChildResponse:
   |

src/presentation/api/endpoints/children/create_child.py:32:44: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
30 |         Provide[container.coppa_integration_service],
31 |     ),
32 |     safety_monitor: SafetyMonitorService = Depends(Provide[container.safety_monitor]),
   |                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
33 | ) -> ChildResponse:
34 |     """إنشاء ملف طفل جديد مع الامتثال لـ COPPA."""
   |

src/presentation/api/endpoints/children/create_child.py:38:13: TRY301 Abstract `raise` to an inner function
   |
36 |           # Verify user is a parent
37 |           if current_user.role != "parent":
38 | /             raise HTTPException(
39 | |                 status_code=status.HTTP_403_FORBIDDEN,
40 | |                 detail="Only parents can create child profiles",
41 | |             )
   | |_____________^ TRY301
42 |
43 |           parent_id = current_user.id
   |

src/presentation/api/endpoints/children/create_child.py:68:9: TRY300 Consider moving this statement to an `else` block
   |
66 |         )
67 |
68 |         return child
   |         ^^^^^^^^^^^^ TRY300
69 |     except HTTPException:
70 |         raise
   |

src/presentation/api/endpoints/children/create_child.py:72:9: TRY400 Use `logging.exception` instead of `logging.error`
   |
70 |         raise
71 |     except Exception as e:
72 |         logger.error(f"Error creating child profile: {e}")
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
73 |         raise HTTPException(
74 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
   |
   = help: Replace with `exception`

src/presentation/api/endpoints/children/create_child.py:73:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
71 |       except Exception as e:
72 |           logger.error(f"Error creating child profile: {e}")
73 | /         raise HTTPException(
74 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
75 | |             detail="Failed to create child profile. Please try again.",
76 | |         )
   | |_________^ B904
   |

src/presentation/api/endpoints/children/create_child.py:82:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
80 | async def validate_child_creation_request(
81 |     request: ChildCreateRequest,
82 |     current_user: User = Depends(container.auth_service.get_current_user),
   |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
83 | ) -> dict[str, Any]:
84 |     """التحقق من صحة طلب إنشاء طفل قبل المعالجة."""
   |

src/presentation/api/endpoints/children/create_child.py:88:13: TRY301 Abstract `raise` to an inner function
   |
86 |           # التحقق من صلاحيات المستخدم
87 |           if current_user.role not in ["parent", "guardian"]:
88 | /             raise HTTPException(
89 | |                 status_code=status.HTTP_403_FORBIDDEN,
90 | |                 detail="Only parents or guardians can create child profiles",
91 | |             )
   | |_____________^ TRY301
92 |
93 |           # التحقق من صحة البيانات
   |

src/presentation/api/endpoints/children/create_child.py:97:26: PLR2004 Magic value used in comparison, consider replacing `3` with a constant variable
   |
96 |         # التحقق من العمر
97 |         if request.age < 3 or request.age > 17:
   |                          ^ PLR2004
98 |             validation_errors.append("Child age must be between 3 and 17 years")
   |

src/presentation/api/endpoints/children/create_child.py:97:45: PLR2004 Magic value used in comparison, consider replacing `17` with a constant variable
   |
96 |         # التحقق من العمر
97 |         if request.age < 3 or request.age > 17:
   |                                             ^^ PLR2004
98 |             validation_errors.append("Child age must be between 3 and 17 years")
   |

src/presentation/api/endpoints/children/create_child.py:101:60: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
    |
100 |         # التحقق من الاسم
101 |         if not request.name or len(request.name.strip()) < 2:
    |                                                            ^ PLR2004
102 |             validation_errors.append("Child name must be at least 2 characters long")
    |

src/presentation/api/endpoints/children/create_child.py:114:13: TRY301 Abstract `raise` to an inner function
    |
113 |           if validation_errors:
114 | /             raise HTTPException(
115 | |                 status_code=status.HTTP_400_BAD_REQUEST,
116 | |                 detail={
117 | |                     "message": "Validation errors found",
118 | |                     "errors": validation_errors,
119 | |                 },
120 | |             )
    | |_____________^ TRY301
121 |
122 |           return {
    |

src/presentation/api/endpoints/children/create_child.py:122:9: TRY300 Consider moving this statement to an `else` block
    |
120 |               )
121 |
122 | /         return {
123 | |             "valid": True,
124 | |             "parent_id": current_user.id,
125 | |             "coppa_applicable": request.age < 13,
126 | |             "message": "Child creation request is valid",
127 | |         }
    | |_________^ TRY300
128 |
129 |       except HTTPException:
    |

src/presentation/api/endpoints/children/create_child.py:125:47: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
    |
123 |             "valid": True,
124 |             "parent_id": current_user.id,
125 |             "coppa_applicable": request.age < 13,
    |                                               ^^ PLR2004
126 |             "message": "Child creation request is valid",
127 |         }
    |

src/presentation/api/endpoints/children/create_child.py:132:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
130 |         raise
131 |     except Exception as e:
132 |         logger.error(f"Error validating child creation request: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
133 |         raise HTTPException(
134 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/create_child.py:133:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
131 |       except Exception as e:
132 |           logger.error(f"Error validating child creation request: {e}")
133 | /         raise HTTPException(
134 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
135 | |             detail="Failed to validate child creation request",
136 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/children/create_child.py:142:5: ARG001 Unused function argument: `coppa_integration`
    |
140 | async def get_child_creation_requirements(
141 |     child_age: int,
142 |     coppa_integration: COPPAIntegration = Depends(
    |     ^^^^^^^^^^^^^^^^^ ARG001
143 |         Provide[container.coppa_integration_service],
144 |     ),
    |

src/presentation/api/endpoints/children/create_child.py:142:43: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
140 |   async def get_child_creation_requirements(
141 |       child_age: int,
142 |       coppa_integration: COPPAIntegration = Depends(
    |  ___________________________________________^
143 | |         Provide[container.coppa_integration_service],
144 | |     ),
    | |_____^ B008
145 |   ) -> dict[str, Any]:
146 |       """الحصول على متطلبات إنشاء طفل حسب العمر."""
    |

src/presentation/api/endpoints/children/create_child.py:148:40: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
    |
146 |     """الحصول على متطلبات إنشاء طفل حسب العمر."""
147 |     try:
148 |         coppa_applicable = child_age < 13
    |                                        ^^ PLR2004
149 |
150 |         requirements = {
    |

src/presentation/api/endpoints/children/create_child.py:172:9: TRY300 Consider moving this statement to an `else` block
    |
170 |             ]
171 |
172 |         return requirements
    |         ^^^^^^^^^^^^^^^^^^^ TRY300
173 |
174 |     except Exception as e:
    |

src/presentation/api/endpoints/children/create_child.py:175:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
174 |     except Exception as e:
175 |         logger.error(f"Error getting child creation requirements: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
176 |         raise HTTPException(
177 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/create_child.py:176:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
174 |       except Exception as e:
175 |           logger.error(f"Error getting child creation requirements: {e}")
176 | /         raise HTTPException(
177 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
178 | |             detail="Failed to get child creation requirements",
179 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/children/create_child.py:182:32: ARG001 Unused function argument: `parent_id`
    |
182 | async def _get_parent_children(parent_id: str) -> list:
    |                                ^^^^^^^^^ ARG001
183 |     """الحصول على قائمة الأطفال للوالد - دالة مساعدة."""
184 |     try:
    |

src/presentation/api/endpoints/children/create_child.py:189:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
187 |         return []
188 |     except Exception as e:
189 |         logger.error(f"Error getting parent children: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
190 |         return []
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/create_child.py:195:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
193 | @inject
194 | async def check_child_limit(
195 |     current_user: User = Depends(container.auth_service.get_current_user),
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
196 | ) -> dict[str, Any]:
197 |     """التحقق من حد الأطفال المسموح للوالد."""
    |

src/presentation/api/endpoints/children/create_child.py:215:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
214 |     except Exception as e:
215 |         logger.error(f"Error checking child limit: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
216 |         raise HTTPException(
217 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/create_child.py:216:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
214 |       except Exception as e:
215 |           logger.error(f"Error checking child limit: {e}")
216 | /         raise HTTPException(
217 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
218 | |             detail="Failed to check child limit",
219 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/children/get_children.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Get Children Endpoint
2 | | Handles retrieving children list for parents with proper access control.
3 | | """
  | |___^ D205
4 |
5 |   from typing import Any
  |
  = help: Insert single blank line

src/presentation/api/endpoints/children/get_children.py:22:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
20 | @inject
21 | async def get_children_endpoint(
22 |     current_user: User = Depends(container.auth_service.get_current_user),
   |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
23 |     manage_child_profile_use_case: ManageChildProfileUseCase = Depends(
24 |         Provide[container.manage_child_profile_use_case],
   |

src/presentation/api/endpoints/children/get_children.py:23:64: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
21 |   async def get_children_endpoint(
22 |       current_user: User = Depends(container.auth_service.get_current_user),
23 |       manage_child_profile_use_case: ManageChildProfileUseCase = Depends(
   |  ________________________________________________________________^
24 | |         Provide[container.manage_child_profile_use_case],
25 | |     ),
   | |_____^ B008
26 |   ) -> list[ChildResponse]:
27 |       """الحصول على قائمة الأطفال للوالد مع التحقق من الصلاحيات."""
   |

src/presentation/api/endpoints/children/get_children.py:31:13: TRY301 Abstract `raise` to an inner function
   |
29 |           # Verify user is a parent
30 |           if current_user.role not in ["parent", "guardian"]:
31 | /             raise HTTPException(
32 | |                 status_code=status.HTTP_403_FORBIDDEN,
33 | |                 detail="Only parents and guardians can access children profiles",
34 | |             )
   | |_____________^ TRY301
35 |
36 |           # Get children for this parent
   |

src/presentation/api/endpoints/children/get_children.py:50:9: TRY300 Consider moving this statement to an `else` block
   |
48 |             f"Retrieved {len(children)} children profiles for parent: {current_user.id}"
49 |         )
50 |         return child_responses
   |         ^^^^^^^^^^^^^^^^^^^^^^ TRY300
51 |     except HTTPException:
52 |         raise
   |

src/presentation/api/endpoints/children/get_children.py:54:9: TRY400 Use `logging.exception` instead of `logging.error`
   |
52 |         raise
53 |     except Exception as e:
54 |         logger.error(f"Error retrieving children: {e}")
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
55 |         raise HTTPException(
56 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
   |
   = help: Replace with `exception`

src/presentation/api/endpoints/children/get_children.py:55:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
53 |       except Exception as e:
54 |           logger.error(f"Error retrieving children: {e}")
55 | /         raise HTTPException(
56 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
57 | |             detail="Failed to retrieve children profiles. Please try again.",
58 | |         )
   | |_________^ B904
   |

src/presentation/api/endpoints/children/get_children.py:63:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
61 | @inject
62 | async def get_children_summary(
63 |     current_user: User = Depends(container.auth_service.get_current_user),
   |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
64 |     manage_child_profile_use_case: ManageChildProfileUseCase = Depends(
65 |         Provide[container.manage_child_profile_use_case],
   |

src/presentation/api/endpoints/children/get_children.py:64:64: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
62 |   async def get_children_summary(
63 |       current_user: User = Depends(container.auth_service.get_current_user),
64 |       manage_child_profile_use_case: ManageChildProfileUseCase = Depends(
   |  ________________________________________________________________^
65 | |         Provide[container.manage_child_profile_use_case],
66 | |     ),
   | |_____^ B008
67 |   ) -> dict[str, Any]:
68 |       """الحصول على ملخص الأطفال للوالد."""
   |

src/presentation/api/endpoints/children/get_children.py:72:13: TRY301 Abstract `raise` to an inner function
   |
70 |           # Verify user permissions
71 |           if current_user.role not in ["parent", "guardian"]:
72 | /             raise HTTPException(
73 | |                 status_code=status.HTTP_403_FORBIDDEN,
74 | |                 detail="Access denied to children information",
75 | |             )
   | |_____________^ TRY301
76 |
77 |           # Get children for this parent
   |

src/presentation/api/endpoints/children/get_children.py:96:29: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
   |
94 |         for child in children:
95 |             # Count by age group
96 |             if child.age <= 5:
   |                             ^ PLR2004
97 |                 age_groups["preschool"] += 1
98 |             elif child.age <= 10:
   |

src/presentation/api/endpoints/children/get_children.py:98:31: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
    |
 96 |             if child.age <= 5:
 97 |                 age_groups["preschool"] += 1
 98 |             elif child.age <= 10:
    |                               ^^ PLR2004
 99 |                 age_groups["elementary"] += 1
100 |             elif child.age <= 13:
    |

src/presentation/api/endpoints/children/get_children.py:100:31: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
    |
 98 |             elif child.age <= 10:
 99 |                 age_groups["elementary"] += 1
100 |             elif child.age <= 13:
    |                               ^^ PLR2004
101 |                 age_groups["middle_school"] += 1
102 |             else:
    |

src/presentation/api/endpoints/children/get_children.py:106:28: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
    |
105 |             # Count COPPA applicable children (under 13)
106 |             if child.age < 13:
    |                            ^^ PLR2004
107 |                 coppa_applicable_count += 1
    |

src/presentation/api/endpoints/children/get_children.py:128:9: TRY300 Consider moving this statement to an `else` block
    |
127 |         logger.info(f"Generated children summary for parent: {current_user.id}")
128 |         return summary
    |         ^^^^^^^^^^^^^^ TRY300
129 |
130 |     except HTTPException:
    |

src/presentation/api/endpoints/children/get_children.py:133:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
131 |         raise
132 |     except Exception as e:
133 |         logger.error(f"Error generating children summary: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
134 |         raise HTTPException(
135 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/get_children.py:134:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
132 |       except Exception as e:
133 |           logger.error(f"Error generating children summary: {e}")
134 | /         raise HTTPException(
135 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
136 | |             detail="Failed to generate children summary",
137 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/children/get_children.py:143:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
141 | async def get_child_by_id(
142 |     child_id: str,
143 |     current_user: User = Depends(container.auth_service.get_current_user),
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
144 |     manage_child_profile_use_case: ManageChildProfileUseCase = Depends(
145 |         Provide[container.manage_child_profile_use_case],
    |

src/presentation/api/endpoints/children/get_children.py:144:64: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
142 |       child_id: str,
143 |       current_user: User = Depends(container.auth_service.get_current_user),
144 |       manage_child_profile_use_case: ManageChildProfileUseCase = Depends(
    |  ________________________________________________________________^
145 | |         Provide[container.manage_child_profile_use_case],
146 | |     ),
    | |_____^ B008
147 |   ) -> ChildResponse:
148 |       """الحصول على معلومات طفل محدد."""
    |

src/presentation/api/endpoints/children/get_children.py:152:13: TRY301 Abstract `raise` to an inner function
    |
150 |           # Verify user permissions
151 |           if current_user.role not in ["parent", "guardian"]:
152 | /             raise HTTPException(
153 | |                 status_code=status.HTTP_403_FORBIDDEN,
154 | |                 detail="Access denied to child information",
155 | |             )
    | |_____________^ TRY301
156 |
157 |           # Get the specific child
    |

src/presentation/api/endpoints/children/get_children.py:163:13: TRY301 Abstract `raise` to an inner function
    |
162 |           if not child:
163 | /             raise HTTPException(
164 | |                 status_code=status.HTTP_404_NOT_FOUND,
165 | |                 detail="Child not found or access denied",
166 | |             )
    | |_____________^ TRY301
167 |
168 |           # Verify ownership
    |

src/presentation/api/endpoints/children/get_children.py:170:13: TRY301 Abstract `raise` to an inner function
    |
168 |           # Verify ownership
169 |           if child.parent_id != current_user.id:
170 | /             raise HTTPException(
171 | |                 status_code=status.HTTP_403_FORBIDDEN,
172 | |                 detail="Access denied to this child's information",
173 | |             )
    | |_____________^ TRY301
174 |
175 |           child_response = ChildResponse.from_domain(child)
    |

src/presentation/api/endpoints/children/get_children.py:180:9: TRY300 Consider moving this statement to an `else` block
    |
178 |             f"Retrieved child profile: {child_id} for parent: {current_user.id}"
179 |         )
180 |         return child_response
    |         ^^^^^^^^^^^^^^^^^^^^^ TRY300
181 |
182 |     except HTTPException:
    |

src/presentation/api/endpoints/children/get_children.py:185:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
183 |         raise
184 |     except Exception as e:
185 |         logger.error(f"Error retrieving child {child_id}: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
186 |         raise HTTPException(
187 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/get_children.py:186:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
184 |       except Exception as e:
185 |           logger.error(f"Error retrieving child {child_id}: {e}")
186 | /         raise HTTPException(
187 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
188 | |             detail="Failed to retrieve child information",
189 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/children/get_children.py:197:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
195 |     age_min: int | None = None,
196 |     age_max: int | None = None,
197 |     current_user: User = Depends(container.auth_service.get_current_user),
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
198 |     manage_child_profile_use_case: ManageChildProfileUseCase = Depends(
199 |         Provide[container.manage_child_profile_use_case],
    |

src/presentation/api/endpoints/children/get_children.py:198:64: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
196 |       age_max: int | None = None,
197 |       current_user: User = Depends(container.auth_service.get_current_user),
198 |       manage_child_profile_use_case: ManageChildProfileUseCase = Depends(
    |  ________________________________________________________________^
199 | |         Provide[container.manage_child_profile_use_case],
200 | |     ),
    | |_____^ B008
201 |   ) -> list[ChildResponse]:
202 |       """البحث في الأطفال بناءً على معايير محددة."""
    |

src/presentation/api/endpoints/children/get_children.py:206:13: TRY301 Abstract `raise` to an inner function
    |
204 |           # Verify user permissions
205 |           if current_user.role not in ["parent", "guardian"]:
206 | /             raise HTTPException(
207 | |                 status_code=status.HTTP_403_FORBIDDEN,
208 | |                 detail="Access denied to children information",
209 | |             )
    | |_____________^ TRY301
210 |
211 |           # Get all children for this parent first
    |

src/presentation/api/endpoints/children/get_children.py:237:89: E501 Line too long (92 > 88)
    |
236 |         logger.info(
237 |             f"Search returned {len(child_responses)} children for parent: {current_user.id}"
    |                                                                                         ^^^^ E501
238 |         )
239 |         return child_responses
    |

src/presentation/api/endpoints/children/get_children.py:239:9: TRY300 Consider moving this statement to an `else` block
    |
237 |             f"Search returned {len(child_responses)} children for parent: {current_user.id}"
238 |         )
239 |         return child_responses
    |         ^^^^^^^^^^^^^^^^^^^^^^ TRY300
240 |
241 |     except HTTPException:
    |

src/presentation/api/endpoints/children/get_children.py:244:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
242 |         raise
243 |     except Exception as e:
244 |         logger.error(f"Error searching children: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
245 |         raise HTTPException(
246 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/get_children.py:245:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
243 |       except Exception as e:
244 |           logger.error(f"Error searching children: {e}")
245 | /         raise HTTPException(
246 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
247 | |             detail="Failed to search children",
248 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/children/get_children.py:254:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
252 | async def get_children_activity_summary(
253 |     days: int = 7,
254 |     current_user: User = Depends(container.auth_service.get_current_user),
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
255 |     manage_child_profile_use_case: ManageChildProfileUseCase = Depends(
256 |         Provide[container.manage_child_profile_use_case],
    |

src/presentation/api/endpoints/children/get_children.py:255:64: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
253 |       days: int = 7,
254 |       current_user: User = Depends(container.auth_service.get_current_user),
255 |       manage_child_profile_use_case: ManageChildProfileUseCase = Depends(
    |  ________________________________________________________________^
256 | |         Provide[container.manage_child_profile_use_case],
257 | |     ),
    | |_____^ B008
258 |   ) -> dict[str, Any]:
259 |       """الحصول على ملخص نشاط الأطفال للأيام الماضية."""
    |

src/presentation/api/endpoints/children/get_children.py:263:13: TRY301 Abstract `raise` to an inner function
    |
261 |           # Verify user permissions
262 |           if current_user.role not in ["parent", "guardian"]:
263 | /             raise HTTPException(
264 | |                 status_code=status.HTTP_403_FORBIDDEN,
265 | |                 detail="Access denied to children activity information",
266 | |             )
    | |_____________^ TRY301
267 |
268 |           # Validate days parameter
    |

src/presentation/api/endpoints/children/get_children.py:269:31: PLR2004 Magic value used in comparison, consider replacing `365` with a constant variable
    |
268 |         # Validate days parameter
269 |         if days < 1 or days > 365:
    |                               ^^^ PLR2004
270 |             raise HTTPException(
271 |                 status_code=status.HTTP_400_BAD_REQUEST,
    |

src/presentation/api/endpoints/children/get_children.py:270:13: TRY301 Abstract `raise` to an inner function
    |
268 |           # Validate days parameter
269 |           if days < 1 or days > 365:
270 | /             raise HTTPException(
271 | |                 status_code=status.HTTP_400_BAD_REQUEST,
272 | |                 detail="Days parameter must be between 1 and 365",
273 | |             )
    | |_____________^ TRY301
274 |
275 |           # Get children for this parent
    |

src/presentation/api/endpoints/children/get_children.py:318:9: TRY300 Consider moving this statement to an `else` block
    |
316 |             f"Generated {days}-day activity summary for parent: {current_user.id}"
317 |         )
318 |         return activity_summary
    |         ^^^^^^^^^^^^^^^^^^^^^^^ TRY300
319 |
320 |     except HTTPException:
    |

src/presentation/api/endpoints/children/get_children.py:323:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
321 |         raise
322 |     except Exception as e:
323 |         logger.error(f"Error generating activity summary: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
324 |         raise HTTPException(
325 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/get_children.py:324:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
322 |       except Exception as e:
323 |           logger.error(f"Error generating activity summary: {e}")
324 | /         raise HTTPException(
325 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
326 | |             detail="Failed to generate activity summary",
327 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/children/operations.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Core CRUD operations for child profile management.
2 | | This module provides the business logic for creating, reading, updating,
3 | | and deleting child profiles with COPPA compliance and data validation.
4 | | """
  | |___^ D205
5 |
6 |   from datetime import datetime
  |
  = help: Insert single blank line

src/presentation/api/endpoints/children/operations.py:38:68: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
36 |       def __init__(
37 |           self,
38 |           manage_child_profile_use_case: ManageChildProfileUseCase = Depends(
   |  ____________________________________________________________________^
39 | |             Provide[container.manage_child_profile_use_case],
40 | |         ),
   | |_________^ B008
41 |           coppa_compliance_service: COPPAValidator = Depends(
42 |               Provide[container.coppa_compliance_service],
   |

src/presentation/api/endpoints/children/operations.py:41:52: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
39 |               Provide[container.manage_child_profile_use_case],
40 |           ),
41 |           coppa_compliance_service: COPPAValidator = Depends(
   |  ____________________________________________________^
42 | |             Provide[container.coppa_compliance_service],
43 | |         ),
   | |_________^ B008
44 |           pagination_service: PaginationService = Depends(
45 |               Provide[container.pagination_service],
   |

src/presentation/api/endpoints/children/operations.py:44:49: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
42 |               Provide[container.coppa_compliance_service],
43 |           ),
44 |           pagination_service: PaginationService = Depends(
   |  _________________________________________________^
45 | |             Provide[container.pagination_service],
46 | |         ),
   | |_________^ B008
47 |       ) -> None:
48 |           self.manage_child_profile_use_case = manage_child_profile_use_case
   |

src/presentation/api/endpoints/children/operations.py:72:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
70 |             return ChildResponse.from_domain_entity(child_profile)
71 |         except ValueError as e:
72 |             logger.error(f"Validation error creating child: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
73 |             raise HTTPException(status_code=400, detail=str(e))
74 |         except Exception as e:
   |
   = help: Replace with `exception`

src/presentation/api/endpoints/children/operations.py:73:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
71 |         except ValueError as e:
72 |             logger.error(f"Validation error creating child: {e}")
73 |             raise HTTPException(status_code=400, detail=str(e))
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
74 |         except Exception as e:
75 |             logger.error(f"Error creating child: {e}")
   |

src/presentation/api/endpoints/children/operations.py:75:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
73 |             raise HTTPException(status_code=400, detail=str(e))
74 |         except Exception as e:
75 |             logger.error(f"Error creating child: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
76 |             raise HTTPException(
77 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
   |
   = help: Replace with `exception`

src/presentation/api/endpoints/children/operations.py:76:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
74 |           except Exception as e:
75 |               logger.error(f"Error creating child: {e}")
76 | /             raise HTTPException(
77 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
78 | |                 detail=f"Failed to create child: {e!s}",
79 | |             )
   | |_____________^ B904
80 |
81 |       async def get_children(
   |

src/presentation/api/endpoints/children/operations.py:113:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
111 |             )
112 |         except Exception as e:
113 |             logger.error(f"Error getting children for parent {parent_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
114 |             raise HTTPException(
115 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/operations.py:114:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
112 |           except Exception as e:
113 |               logger.error(f"Error getting children for parent {parent_id}: {e}")
114 | /             raise HTTPException(
115 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
116 | |                 detail=f"Failed to get children: {e!s}",
117 | |             )
    | |_____________^ B904
118 |
119 |       async def get_child(self, child_id: str) -> ChildResponse:
    |

src/presentation/api/endpoints/children/operations.py:124:17: TRY301 Abstract `raise` to an inner function
    |
122 |               child = await self.manage_child_profile_use_case.get_child_profile(child_id)
123 |               if not child:
124 | /                 raise HTTPException(
125 | |                     status_code=status.HTTP_404_NOT_FOUND,
126 | |                     detail="Child not found",
127 | |                 )
    | |_________________^ TRY301
128 |               return ChildResponse.from_domain_entity(child)
129 |           except HTTPException:
    |

src/presentation/api/endpoints/children/operations.py:132:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
130 |             raise
131 |         except Exception as e:
132 |             logger.error(f"Error getting child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
133 |             raise HTTPException(
134 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/operations.py:133:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
131 |           except Exception as e:
132 |               logger.error(f"Error getting child {child_id}: {e}")
133 | /             raise HTTPException(
134 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
135 | |                 detail=f"Failed to get child: {e!s}",
136 | |             )
    | |_____________^ B904
137 |
138 |       async def update_child(
    |

src/presentation/api/endpoints/children/operations.py:160:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
158 |             raise
159 |         except ValueError as e:
160 |             logger.error(f"Validation error updating child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
161 |             raise HTTPException(status_code=400, detail=str(e))
162 |         except Exception as e:
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/operations.py:161:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
159 |         except ValueError as e:
160 |             logger.error(f"Validation error updating child {child_id}: {e}")
161 |             raise HTTPException(status_code=400, detail=str(e))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
162 |         except Exception as e:
163 |             logger.error(f"Error updating child {child_id}: {e}")
    |

src/presentation/api/endpoints/children/operations.py:163:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
161 |             raise HTTPException(status_code=400, detail=str(e))
162 |         except Exception as e:
163 |             logger.error(f"Error updating child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
164 |             raise HTTPException(
165 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/operations.py:164:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
162 |           except Exception as e:
163 |               logger.error(f"Error updating child {child_id}: {e}")
164 | /             raise HTTPException(
165 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
166 | |                 detail=f"Failed to update child: {e!s}",
167 | |             )
    | |_____________^ B904
168 |
169 |       async def delete_child(self, child_id: str) -> dict[str, str]:
    |

src/presentation/api/endpoints/children/operations.py:173:13: TRY300 Consider moving this statement to an `else` block
    |
171 |         try:
172 |             await self.manage_child_profile_use_case.delete_child_profile(child_id)
173 |             return {"message": "Child and all associated data deleted successfully"}
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY300
174 |         except HTTPException:
175 |             raise
    |

src/presentation/api/endpoints/children/operations.py:177:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
175 |             raise
176 |         except Exception as e:
177 |             logger.error(f"Error deleting child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
178 |             raise HTTPException(
179 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/operations.py:178:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
176 |           except Exception as e:
177 |               logger.error(f"Error deleting child {child_id}: {e}")
178 | /             raise HTTPException(
179 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
180 | |                 detail=f"Failed to delete child: {e!s}",
181 | |             )
    | |_____________^ B904
    |

src/presentation/api/endpoints/children/operations.py:189:52: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
187 |       def __init__(
188 |           self,
189 |           coppa_compliance_service: COPPAValidator = Depends(
    |  ____________________________________________________^
190 | |             Provide[container.coppa_compliance_service],
191 | |         ),
    | |_________^ B008
192 |       ) -> None:
193 |           self.coppa_compliance_service = coppa_compliance_service
    |

src/presentation/api/endpoints/children/operations.py:202:19: TRY003 Avoid specifying long messages outside the exception class
    |
200 |         """Validate child creation request for compliance and data integrity."""
201 |         if not parent_id or not parent_id.strip():
202 |             raise ValueError("Parent ID is required")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
203 |
204 |         if not request.name or not request.name.strip():
    |

src/presentation/api/endpoints/children/operations.py:205:19: TRY003 Avoid specifying long messages outside the exception class
    |
204 |         if not request.name or not request.name.strip():
205 |             raise ValueError("Child name is required")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
206 |
207 |         if not hasattr(request, "age") or request.age is None:
    |

src/presentation/api/endpoints/children/operations.py:208:19: TRY003 Avoid specifying long messages outside the exception class
    |
207 |         if not hasattr(request, "age") or request.age is None:
208 |             raise ValueError("Child age is required")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
209 |
210 |         if request.age < 3 or request.age > 17:
    |

src/presentation/api/endpoints/children/operations.py:210:26: PLR2004 Magic value used in comparison, consider replacing `3` with a constant variable
    |
208 |             raise ValueError("Child age is required")
209 |
210 |         if request.age < 3 or request.age > 17:
    |                          ^ PLR2004
211 |             raise ValueError("Child age must be between 3 and 17")
    |

src/presentation/api/endpoints/children/operations.py:210:45: PLR2004 Magic value used in comparison, consider replacing `17` with a constant variable
    |
208 |             raise ValueError("Child age is required")
209 |
210 |         if request.age < 3 or request.age > 17:
    |                                             ^^ PLR2004
211 |             raise ValueError("Child age must be between 3 and 17")
    |

src/presentation/api/endpoints/children/operations.py:211:19: TRY003 Avoid specifying long messages outside the exception class
    |
210 |         if request.age < 3 or request.age > 17:
211 |             raise ValueError("Child age must be between 3 and 17")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
212 |
213 |         # Use coppa_compliance_service for age validation
    |

src/presentation/api/endpoints/children/operations.py:217:89: E501 Line too long (89 > 88)
    |
215 |             coppa_result = self.coppa_compliance_service.validate_age(request.age)
216 |             if coppa_result.parental_consent_required:
217 |                 # This check is now handled by the create_child method in ChildOperations
    |                                                                                         ^ E501
218 |                 logger.info(f"Parental consent required for child age {request.age}")
219 |         except Exception as e:
    |

src/presentation/api/endpoints/children/operations.py:226:19: TRY003 Avoid specifying long messages outside the exception class
    |
224 |         """Validate child update request for compliance and data integrity."""
225 |         if not child_id or not child_id.strip():
226 |             raise ValueError("Child ID is required")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
227 |
228 |         # Check if there's data to update
    |

src/presentation/api/endpoints/children/operations.py:240:19: TRY003 Avoid specifying long messages outside the exception class
    |
239 |         if not has_updates:
240 |             raise ValueError("At least one field must be provided for update")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
241 |
242 |         # Validate age if provided
    |

src/presentation/api/endpoints/children/operations.py:243:9: SIM102 Use a single `if` statement instead of nested `if` statements
    |
242 |           # Validate age if provided
243 | /         if hasattr(request, "age") and request.age is not None:
244 | |             if request.age < 3 or request.age > 17:
    | |___________________________________________________^ SIM102
245 |                   raise ValueError("Child age must be between 3 and 17")
    |
    = help: Combine `if` statements using `and`

src/presentation/api/endpoints/children/operations.py:244:30: PLR2004 Magic value used in comparison, consider replacing `3` with a constant variable
    |
242 |         # Validate age if provided
243 |         if hasattr(request, "age") and request.age is not None:
244 |             if request.age < 3 or request.age > 17:
    |                              ^ PLR2004
245 |                 raise ValueError("Child age must be between 3 and 17")
    |

src/presentation/api/endpoints/children/operations.py:244:49: PLR2004 Magic value used in comparison, consider replacing `17` with a constant variable
    |
242 |         # Validate age if provided
243 |         if hasattr(request, "age") and request.age is not None:
244 |             if request.age < 3 or request.age > 17:
    |                                                 ^^ PLR2004
245 |                 raise ValueError("Child age must be between 3 and 17")
    |

src/presentation/api/endpoints/children/operations.py:245:23: TRY003 Avoid specifying long messages outside the exception class
    |
243 |         if hasattr(request, "age") and request.age is not None:
244 |             if request.age < 3 or request.age > 17:
245 |                 raise ValueError("Child age must be between 3 and 17")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
246 |
247 |     def validate_parent_permission(self, parent_id: str, child_id: str) -> None:
    |

src/presentation/api/endpoints/children/operations.py:252:19: TRY003 Avoid specifying long messages outside the exception class
    |
250 |         # that the child belongs to this parent
251 |         if not parent_id or not child_id:
252 |             raise ValueError("Parent ID and Child ID are required")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
    |

src/presentation/api/endpoints/children/operations.py:308:68: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
306 |       def __init__(
307 |           self,
308 |           manage_child_profile_use_case: ManageChildProfileUseCase = Depends(
    |  ____________________________________________________________________^
309 | |             Provide[container.manage_child_profile_use_case],
310 | |         ),
    | |_________^ B008
311 |       ) -> None:
312 |           self.manage_child_profile_use_case = manage_child_profile_use_case
    |

src/presentation/api/endpoints/children/operations.py:318:18: RUF013 PEP 484 prohibits implicit `Optional`
    |
316 |         parent_id: str,
317 |         search_query: str = "",
318 |         age_min: int = None,
    |                  ^^^ RUF013
319 |         age_max: int = None,
320 |         language: str = None,
    |
    = help: Convert to `T | None`

src/presentation/api/endpoints/children/operations.py:319:18: RUF013 PEP 484 prohibits implicit `Optional`
    |
317 |         search_query: str = "",
318 |         age_min: int = None,
319 |         age_max: int = None,
    |                  ^^^ RUF013
320 |         language: str = None,
321 |     ) -> list[ChildResponse]:
    |
    = help: Convert to `T | None`

src/presentation/api/endpoints/children/operations.py:320:19: RUF013 PEP 484 prohibits implicit `Optional`
    |
318 |         age_min: int = None,
319 |         age_max: int = None,
320 |         language: str = None,
    |                   ^^^ RUF013
321 |     ) -> list[ChildResponse]:
322 |         """Search children with various filters."""
    |
    = help: Convert to `T | None`

src/presentation/api/endpoints/children/operations.py:356:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
355 |         except Exception as e:
356 |             logger.error(f"Error searching children for parent {parent_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
357 |             raise HTTPException(
358 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/operations.py:357:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
355 |           except Exception as e:
356 |               logger.error(f"Error searching children for parent {parent_id}: {e}")
357 | /             raise HTTPException(
358 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
359 | |                 detail=f"Failed to search children: {e!s}",
360 | |             )
    | |_____________^ B904
    |

src/presentation/api/endpoints/children/operations.py:368:41: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
366 |       request: ChildCreateRequest,
367 |       parent_id: str,
368 |       child_operations: ChildOperations = Depends(
    |  _________________________________________^
369 | |         Provide[container.child_operations_service],
370 | |     ),
    | |_____^ B008
371 |   ) -> ChildResponse:
372 |       """Create a new child profile."""
    |

src/presentation/api/endpoints/children/operations.py:380:41: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
378 |       parent_id: str,
379 |       pagination_request: PaginationRequest | None = None,
380 |       child_operations: ChildOperations = Depends(
    |  _________________________________________^
381 | |         Provide[container.child_operations_service],
382 | |     ),
    | |_____^ B008
383 |   ) -> PaginatedResponse[ChildResponse]:
384 |       """Get children list for parent with pagination."""
    |

src/presentation/api/endpoints/children/operations.py:391:41: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
389 |   async def get_child(
390 |       child_id: str,
391 |       child_operations: ChildOperations = Depends(
    |  _________________________________________^
392 | |         Provide[container.child_operations_service],
393 | |     ),
    | |_____^ B008
394 |   ) -> ChildResponse:
395 |       """Get detailed information for a specific child."""
    |

src/presentation/api/endpoints/children/operations.py:403:41: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
401 |       child_id: str,
402 |       request: ChildUpdateRequest,
403 |       child_operations: ChildOperations = Depends(
    |  _________________________________________^
404 | |         Provide[container.child_operations_service],
405 | |     ),
    | |_____^ B008
406 |   ) -> ChildResponse:
407 |       """Update child profile information."""
    |

src/presentation/api/endpoints/children/operations.py:414:41: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
412 |   async def delete_child(
413 |       child_id: str,
414 |       child_operations: ChildOperations = Depends(
    |  _________________________________________^
415 | |         Provide[container.child_operations_service],
416 | |     ),
    | |_____^ B008
417 |   ) -> dict[str, str]:
418 |       """Delete a child profile with COPPA compliance."""
    |

src/presentation/api/endpoints/children/operations.py:423:11: PLR0913 Too many arguments in function definition (6 > 5)
    |
422 | @inject
423 | async def search_children(
    |           ^^^^^^^^^^^^^^^ PLR0913
424 |     parent_id: str,
425 |     search_query: str = "",
    |

src/presentation/api/endpoints/children/operations.py:426:14: RUF013 PEP 484 prohibits implicit `Optional`
    |
424 |     parent_id: str,
425 |     search_query: str = "",
426 |     age_min: int = None,
    |              ^^^ RUF013
427 |     age_max: int = None,
428 |     language: str = None,
    |
    = help: Convert to `T | None`

src/presentation/api/endpoints/children/operations.py:427:14: RUF013 PEP 484 prohibits implicit `Optional`
    |
425 |     search_query: str = "",
426 |     age_min: int = None,
427 |     age_max: int = None,
    |              ^^^ RUF013
428 |     language: str = None,
429 |     child_search_service: ChildSearchService = Depends(
    |
    = help: Convert to `T | None`

src/presentation/api/endpoints/children/operations.py:428:15: RUF013 PEP 484 prohibits implicit `Optional`
    |
426 |     age_min: int = None,
427 |     age_max: int = None,
428 |     language: str = None,
    |               ^^^ RUF013
429 |     child_search_service: ChildSearchService = Depends(
430 |         Provide[container.child_search_service],
    |
    = help: Convert to `T | None`

src/presentation/api/endpoints/children/operations.py:429:48: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
427 |       age_max: int = None,
428 |       language: str = None,
429 |       child_search_service: ChildSearchService = Depends(
    |  ________________________________________________^
430 | |         Provide[container.child_search_service],
431 | |     ),
    | |_____^ B008
432 |   ) -> list[ChildResponse]:
433 |       """Search children with various filters."""
    |

src/presentation/api/endpoints/children/route_handlers.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Individual route handlers extracted from the monolithic setup_routes function.
2 | | Each handler is focused on a single responsibility for better maintainability.
3 | | """
  | |___^ D205
4 |
5 |   from dependency_injector.wiring import Provide, inject
  |
  = help: Insert single blank line

src/presentation/api/endpoints/children/route_handlers.py:39:68: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
37 |       def __init__(
38 |           self,
39 |           manage_child_profile_use_case: ManageChildProfileUseCase = Depends(
   |  ____________________________________________________________________^
40 | |             Provide[container.manage_child_profile_use_case],
41 | |         ),
   | |_________^ B008
42 |           coppa_integration: COPPAIntegration = Depends(
43 |               Provide[container.coppa_integration_service],
   |

src/presentation/api/endpoints/children/route_handlers.py:42:47: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
40 |               Provide[container.manage_child_profile_use_case],
41 |           ),
42 |           coppa_integration: COPPAIntegration = Depends(
   |  _______________________________________________^
43 | |             Provide[container.coppa_integration_service],
44 | |         ),
   | |_________^ B008
45 |           safety_monitor: SafetyMonitorService = Depends(
46 |               Provide[container.safety_monitor],
   |

src/presentation/api/endpoints/children/route_handlers.py:45:48: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
43 |               Provide[container.coppa_integration_service],
44 |           ),
45 |           safety_monitor: SafetyMonitorService = Depends(
   |  ________________________________________________^
46 | |             Provide[container.safety_monitor],
47 | |         ),
   | |_________^ B008
48 |           auth_service: ProductionAuthService = Depends(Provide[container.auth_service]),
49 |       ) -> None:
   |

src/presentation/api/endpoints/children/route_handlers.py:48:47: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
46 |             Provide[container.safety_monitor],
47 |         ),
48 |         auth_service: ProductionAuthService = Depends(Provide[container.auth_service]),
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
49 |     ) -> None:
50 |         self.manage_child_profile_use_case = manage_child_profile_use_case
   |

src/presentation/api/endpoints/children/route_handlers.py:58:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
56 |         self,
57 |         request: ChildCreateRequest,
58 |         current_user: User = Depends(container.auth_service.get_current_user),
   |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
59 |     ) -> ChildResponse:
60 |         """Create a new child profile with COPPA compliance.
   |

src/presentation/api/endpoints/children/route_handlers.py:60:9: D205 1 blank line required between summary line and description
   |
58 |           current_user: User = Depends(container.auth_service.get_current_user),
59 |       ) -> ChildResponse:
60 | /         """Create a new child profile with COPPA compliance.
61 | |         This endpoint creates a new child profile under parental supervision,
62 | |         ensuring full COPPA compliance and child safety protocols.
63 | |
64 | |         Args:
65 | |             request: Child creation request containing name, age, and preferences
66 | |             current_user: Authenticated parent user (required)
67 | |
68 | |         Returns:
69 | |             ChildResponse: Created child profile with safety metadata
70 | |
71 | |         Raises:
72 | |             HTTPException: 403 if user is not a parent
73 | |             HTTPException: 422 if child data validation fails
74 | |             HTTPException: 400 if COPPA compliance checks fail
75 | |
76 | |         Security:
77 | |             - Requires valid JWT authentication
78 | |             - Parent role verification
79 | |             - COPPA age verification (< 13 years)
80 | |             - Parental consent documentation
81 | |
82 | |         """
   | |___________^ D205
83 |           # Verify user is a parent
84 |           if current_user.role != "parent":
   |
   = help: Insert single blank line

src/presentation/api/endpoints/children/route_handlers.py:116:13: TRY300 Consider moving this statement to an `else` block
    |
114 |             )
115 |
116 |             return child
    |             ^^^^^^^^^^^^ TRY300
117 |         except Exception as e:
118 |             logger.error(f"Error creating child: {e}")
    |

src/presentation/api/endpoints/children/route_handlers.py:118:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
116 |             return child
117 |         except Exception as e:
118 |             logger.error(f"Error creating child: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
119 |             raise HTTPException(
120 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/route_handlers.py:119:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
117 |           except Exception as e:
118 |               logger.error(f"Error creating child: {e}")
119 | /             raise HTTPException(
120 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
121 | |                 detail=f"Failed to create child: {e!s}",
122 | |             )
    | |_____________^ B904
123 |
124 |       @staticmethod
    |

src/presentation/api/endpoints/children/route_handlers.py:125:15: D417 Missing argument description in the docstring for `get_children_handler`: `self`
    |
124 |     @staticmethod
125 |     async def get_children_handler(
    |               ^^^^^^^^^^^^^^^^^^^^ D417
126 |         self,
127 |         current_user: User = Depends(container.auth_service.get_current_user),
    |

src/presentation/api/endpoints/children/route_handlers.py:126:9: PLW0211 First argument of a static method should not be named `self`
    |
124 |     @staticmethod
125 |     async def get_children_handler(
126 |         self,
    |         ^^^^ PLW0211
127 |         current_user: User = Depends(container.auth_service.get_current_user),
128 |     ) -> list[ChildResponse]:
    |

src/presentation/api/endpoints/children/route_handlers.py:127:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
125 |     async def get_children_handler(
126 |         self,
127 |         current_user: User = Depends(container.auth_service.get_current_user),
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
128 |     ) -> list[ChildResponse]:
129 |         """Retrieve all child profiles for authenticated parent.
    |

src/presentation/api/endpoints/children/route_handlers.py:129:9: D205 1 blank line required between summary line and description
    |
127 |           current_user: User = Depends(container.auth_service.get_current_user),
128 |       ) -> list[ChildResponse]:
129 | /         """Retrieve all child profiles for authenticated parent.
130 | |         Returns a list of all children associated with the authenticated parent,
131 | |         including safety summaries and compliance status for each child.
132 | |
133 | |         Args:
134 | |             current_user: Authenticated parent user (required)
135 | |
136 | |         Returns:
137 | |             List[ChildResponse]: List of child profiles with safety metadata
138 | |
139 | |         Raises:
140 | |             HTTPException: 403 if user is not a parent
141 | |             HTTPException: 500 if database retrieval fails
142 | |
143 | |         Security:
144 | |             - Requires valid JWT authentication
145 | |             - Parent role verification
146 | |             - Logs data access for audit trail
147 | |
148 | |         """
    | |___________^ D205
149 |           # Verify user is a parent
150 |           if current_user.role != "parent":
    |
    = help: Insert single blank line

src/presentation/api/endpoints/children/route_handlers.py:170:13: TRY300 Consider moving this statement to an `else` block
    |
168 |                 )
169 |
170 |             return children
    |             ^^^^^^^^^^^^^^^ TRY300
171 |         except Exception as e:
172 |             logger.error(f"Error getting children: {e}")
    |

src/presentation/api/endpoints/children/route_handlers.py:172:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
170 |             return children
171 |         except Exception as e:
172 |             logger.error(f"Error getting children: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
173 |             raise HTTPException(
174 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/route_handlers.py:173:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
171 |           except Exception as e:
172 |               logger.error(f"Error getting children: {e}")
173 | /             raise HTTPException(
174 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
175 | |                 detail=f"Failed to get children: {e!s}",
176 | |             )
    | |_____________^ B904
177 |
178 |       @staticmethod
    |

src/presentation/api/endpoints/children/route_handlers.py:180:9: PLW0211 First argument of a static method should not be named `self`
    |
178 |     @staticmethod
179 |     async def get_child_handler(
180 |         self,
    |         ^^^^ PLW0211
181 |         child_id: str,
182 |         current_user: User = Depends(container.auth_service.get_current_user),
    |

src/presentation/api/endpoints/children/route_handlers.py:182:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
180 |         self,
181 |         child_id: str,
182 |         current_user: User = Depends(container.auth_service.get_current_user),
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
183 |     ) -> ChildResponse:
184 |         """Handle retrieval of a specific child's profile."""
    |

src/presentation/api/endpoints/children/route_handlers.py:202:17: TRY301 Abstract `raise` to an inner function
    |
201 |               if not can_access:
202 | /                 raise HTTPException(
203 | |                     status_code=status.HTTP_403_FORBIDDEN,
204 | |                     detail="Access denied: Child not associated with this parent",
205 | |                 )
    | |_________________^ TRY301
206 |
207 |               child = await self.manage_child_profile_use_case.get_child(child_id)
    |

src/presentation/api/endpoints/children/route_handlers.py:216:13: TRY300 Consider moving this statement to an `else` block
    |
214 |             )
215 |
216 |             return child
    |             ^^^^^^^^^^^^ TRY300
217 |         except Exception as e:
218 |             logger.error(f"Error getting child {child_id}: {e}")
    |

src/presentation/api/endpoints/children/route_handlers.py:218:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
216 |             return child
217 |         except Exception as e:
218 |             logger.error(f"Error getting child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
219 |             raise HTTPException(
220 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/route_handlers.py:219:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
217 |           except Exception as e:
218 |               logger.error(f"Error getting child {child_id}: {e}")
219 | /             raise HTTPException(
220 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
221 | |                 detail=f"Failed to get child: {e!s}",
222 | |             )
    | |_____________^ B904
223 |
224 |       @staticmethod
    |

src/presentation/api/endpoints/children/route_handlers.py:226:9: PLW0211 First argument of a static method should not be named `self`
    |
224 |     @staticmethod
225 |     async def update_child_handler(
226 |         self,
    |         ^^^^ PLW0211
227 |         child_id: str,
228 |         request: ChildUpdateRequest,
    |

src/presentation/api/endpoints/children/route_handlers.py:229:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
227 |         child_id: str,
228 |         request: ChildUpdateRequest,
229 |         current_user: User = Depends(container.auth_service.get_current_user),
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
230 |     ) -> ChildResponse:
231 |         """Handle child profile updates with compliance checks."""
    |

src/presentation/api/endpoints/children/route_handlers.py:250:17: TRY301 Abstract `raise` to an inner function
    |
249 |               if not can_modify:
250 | /                 raise HTTPException(
251 | |                     status_code=status.HTTP_403_FORBIDDEN,
252 | |                     detail="Access denied: Cannot modify this child's profile",
253 | |                 )
    | |_________________^ TRY301
254 |
255 |               # Update the child
    |

src/presentation/api/endpoints/children/route_handlers.py:272:13: TRY300 Consider moving this statement to an `else` block
    |
270 |             )
271 |
272 |             return updated_child
    |             ^^^^^^^^^^^^^^^^^^^^ TRY300
273 |         except Exception as e:
274 |             logger.error(f"Error updating child {child_id}: {e}")
    |

src/presentation/api/endpoints/children/route_handlers.py:274:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
272 |             return updated_child
273 |         except Exception as e:
274 |             logger.error(f"Error updating child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
275 |             raise HTTPException(
276 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/route_handlers.py:275:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
273 |           except Exception as e:
274 |               logger.error(f"Error updating child {child_id}: {e}")
275 | /             raise HTTPException(
276 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
277 | |                 detail=f"Failed to update child: {e!s}",
278 | |             )
    | |_____________^ B904
279 |
280 |       @staticmethod
    |

src/presentation/api/endpoints/children/route_handlers.py:282:9: PLW0211 First argument of a static method should not be named `self`
    |
280 |     @staticmethod
281 |     async def delete_child_handler(
282 |         self,
    |         ^^^^ PLW0211
283 |         child_id: str,
284 |         current_user: User = Depends(container.auth_service.get_current_user),
    |

src/presentation/api/endpoints/children/route_handlers.py:284:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
282 |         self,
283 |         child_id: str,
284 |         current_user: User = Depends(container.auth_service.get_current_user),
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
285 |     ) -> ChildDeleteResponse:
286 |         """Handle child profile deletion with COPPA compliance."""
    |

src/presentation/api/endpoints/children/route_handlers.py:305:17: TRY301 Abstract `raise` to an inner function
    |
304 |               if not can_delete:
305 | /                 raise HTTPException(
306 | |                     status_code=status.HTTP_403_FORBIDDEN,
307 | |                     detail="Access denied: Cannot delete this child's profile",
308 | |                 )
    | |_________________^ TRY301
309 |
310 |               # Handle compliant deletion
    |

src/presentation/api/endpoints/children/route_handlers.py:323:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
321 |             )
322 |         except Exception as e:
323 |             logger.error(f"Error deleting child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
324 |             raise HTTPException(
325 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/route_handlers.py:324:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
322 |           except Exception as e:
323 |               logger.error(f"Error deleting child {child_id}: {e}")
324 | /             raise HTTPException(
325 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
326 | |                 detail=f"Failed to delete child: {e!s}",
327 | |             )
    | |_____________^ B904
328 |
329 |       @staticmethod
    |

src/presentation/api/endpoints/children/route_handlers.py:331:9: PLW0211 First argument of a static method should not be named `self`
    |
329 |     @staticmethod
330 |     async def get_child_safety_summary_handler(
331 |         self,
    |         ^^^^ PLW0211
332 |         child_id: str,
333 |         current_user: User = Depends(container.auth_service.get_current_user),
    |

src/presentation/api/endpoints/children/route_handlers.py:333:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
331 |         self,
332 |         child_id: str,
333 |         current_user: User = Depends(container.auth_service.get_current_user),
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
334 |     ):
335 |         """Handle retrieval of child safety summary."""
    |

src/presentation/api/endpoints/children/route_handlers.py:354:17: TRY301 Abstract `raise` to an inner function
    |
353 |               if not can_access:
354 | /                 raise HTTPException(
355 | |                     status_code=status.HTTP_403_FORBIDDEN,
356 | |                     detail="Access denied: Cannot access this child's safety data",
357 | |                 )
    | |_________________^ TRY301
358 |
359 |               safety_summary = await self.safety_monitor.get_child_safety_summary(
    |

src/presentation/api/endpoints/children/route_handlers.py:370:13: TRY300 Consider moving this statement to an `else` block
    |
368 |             )
369 |
370 |             return safety_summary
    |             ^^^^^^^^^^^^^^^^^^^^^ TRY300
371 |         except Exception as e:
372 |             logger.error(f"Error getting safety summary for child {child_id}: {e}")
    |

src/presentation/api/endpoints/children/route_handlers.py:372:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
370 |             return safety_summary
371 |         except Exception as e:
372 |             logger.error(f"Error getting safety summary for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
373 |             raise HTTPException(
374 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/route_handlers.py:373:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
371 |           except Exception as e:
372 |               logger.error(f"Error getting safety summary for child {child_id}: {e}")
373 | /             raise HTTPException(
374 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
375 | |                 detail=f"Failed to get safety summary: {e!s}",
376 | |             )
    | |_____________^ B904
377 |
378 |       @staticmethod
    |

src/presentation/api/endpoints/children/route_handlers.py:380:9: PLW0211 First argument of a static method should not be named `self`
    |
378 |     @staticmethod
379 |     async def get_child_usage_monitor_handler(
380 |         self,
    |         ^^^^ PLW0211
381 |         child_id: str,
382 |         current_user: User = Depends(container.auth_service.get_current_user),
    |

src/presentation/api/endpoints/children/route_handlers.py:382:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
380 |         self,
381 |         child_id: str,
382 |         current_user: User = Depends(container.auth_service.get_current_user),
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
383 |         usage_monitor: UsageMonitor = Depends(Provide[container.usage_monitor_service]),
384 |     ):
    |

src/presentation/api/endpoints/children/route_handlers.py:383:24: F821 Undefined name `UsageMonitor`
    |
381 |         child_id: str,
382 |         current_user: User = Depends(container.auth_service.get_current_user),
383 |         usage_monitor: UsageMonitor = Depends(Provide[container.usage_monitor_service]),
    |                        ^^^^^^^^^^^^ F821
384 |     ):
385 |         """Handle retrieval of child usage monitoring data."""
    |

src/presentation/api/endpoints/children/route_handlers.py:383:39: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
381 |         child_id: str,
382 |         current_user: User = Depends(container.auth_service.get_current_user),
383 |         usage_monitor: UsageMonitor = Depends(Provide[container.usage_monitor_service]),
    |                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
384 |     ):
385 |         """Handle retrieval of child usage monitoring data."""
    |

src/presentation/api/endpoints/children/route_handlers.py:404:17: TRY301 Abstract `raise` to an inner function
    |
403 |               if not can_access:
404 | /                 raise HTTPException(
405 | |                     status_code=status.HTTP_403_FORBIDDEN,
406 | |                     detail="Access denied: Cannot access this child's usage data",
407 | |                 )
    | |_________________^ TRY301
408 |
409 |               usage_data = await usage_monitor.get_child_usage_data(child_id)
    |

src/presentation/api/endpoints/children/route_handlers.py:418:13: TRY300 Consider moving this statement to an `else` block
    |
416 |             )
417 |
418 |             return usage_data
    |             ^^^^^^^^^^^^^^^^^ TRY300
419 |         except Exception as e:
420 |             logger.error(f"Error getting usage data for child {child_id}: {e}")
    |

src/presentation/api/endpoints/children/route_handlers.py:420:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
418 |             return usage_data
419 |         except Exception as e:
420 |             logger.error(f"Error getting usage data for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
421 |             raise HTTPException(
422 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/route_handlers.py:421:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
419 |           except Exception as e:
420 |               logger.error(f"Error getting usage data for child {child_id}: {e}")
421 | /             raise HTTPException(
422 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
423 | |                 detail=f"Failed to get usage data: {e!s}",
424 | |             )
    | |_____________^ B904
425 |
426 |       @staticmethod
    |

src/presentation/api/endpoints/children/route_handlers.py:428:9: PLW0211 First argument of a static method should not be named `self`
    |
426 |     @staticmethod
427 |     async def request_consent_handler(
428 |         self,
    |         ^^^^ PLW0211
429 |         child_id: str,
430 |         current_user: User = Depends(container.auth_service.get_current_user),
    |

src/presentation/api/endpoints/children/route_handlers.py:430:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
428 |         self,
429 |         child_id: str,
430 |         current_user: User = Depends(container.auth_service.get_current_user),
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
431 |         parental_consent_manager: ParentalConsentManager = Depends(
432 |             Provide[container.parental_consent_manager_service],
    |

src/presentation/api/endpoints/children/route_handlers.py:431:35: F821 Undefined name `ParentalConsentManager`
    |
429 |         child_id: str,
430 |         current_user: User = Depends(container.auth_service.get_current_user),
431 |         parental_consent_manager: ParentalConsentManager = Depends(
    |                                   ^^^^^^^^^^^^^^^^^^^^^^ F821
432 |             Provide[container.parental_consent_manager_service],
433 |         ),
    |

src/presentation/api/endpoints/children/route_handlers.py:431:60: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
429 |           child_id: str,
430 |           current_user: User = Depends(container.auth_service.get_current_user),
431 |           parental_consent_manager: ParentalConsentManager = Depends(
    |  ____________________________________________________________^
432 | |             Provide[container.parental_consent_manager_service],
433 | |         ),
    | |_________^ B008
434 |       ):
435 |           """Handle parental consent requests."""
    |

src/presentation/api/endpoints/children/route_handlers.py:454:17: TRY301 Abstract `raise` to an inner function
    |
453 |               if not can_consent:
454 | /                 raise HTTPException(
455 | |                     status_code=status.HTTP_403_FORBIDDEN,
456 | |                     detail="Access denied: Cannot manage consent for this child",
457 | |                 )
    | |_________________^ TRY301
458 |
459 |               consent_result = await parental_consent_manager.request_consent(
    |

src/presentation/api/endpoints/children/route_handlers.py:475:13: TRY300 Consider moving this statement to an `else` block
    |
473 |             )
474 |
475 |             return consent_result
    |             ^^^^^^^^^^^^^^^^^^^^^ TRY300
476 |         except Exception as e:
477 |             logger.error(f"Error requesting consent for child {child_id}: {e}")
    |

src/presentation/api/endpoints/children/route_handlers.py:477:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
475 |             return consent_result
476 |         except Exception as e:
477 |             logger.error(f"Error requesting consent for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
478 |             raise HTTPException(
479 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/route_handlers.py:478:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
476 |           except Exception as e:
477 |               logger.error(f"Error requesting consent for child {child_id}: {e}")
478 | /             raise HTTPException(
479 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
480 | |                 detail=f"Failed to request consent: {e!s}",
481 | |             )
    | |_____________^ B904
    |

src/presentation/api/endpoints/children/routes.py:25:11: TRY003 Avoid specifying long messages outside the exception class
   |
23 |     logger.critical(f"CRITICAL ERROR: FastAPI is required for production use: {e}")
24 |     logger.critical("Install required dependencies: pip install fastapi")
25 |     raise ImportError(f"Missing required dependencies for children routes: {e}") from e
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
   |

src/presentation/api/endpoints/children/routes.py:35:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
33 |     async def create_child_endpoint(
34 |         request: ChildProfile,
35 |         current_user: User = Depends(container.auth_service.get_current_user),
   |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
36 |         child_route_handlers: ChildRouteHandlers = Depends(
37 |             Provide[container.child_route_handlers],
   |

src/presentation/api/endpoints/children/routes.py:36:52: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
34 |           request: ChildProfile,
35 |           current_user: User = Depends(container.auth_service.get_current_user),
36 |           child_route_handlers: ChildRouteHandlers = Depends(
   |  ____________________________________________________^
37 | |             Provide[container.child_route_handlers],
38 | |         ),
   | |_________^ B008
39 |       ):
40 |           """Create a new child profile with COPPA compliance."""
   |

src/presentation/api/endpoints/children/routes.py:50:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
48 |     @inject
49 |     async def get_children_endpoint(
50 |         current_user: User = Depends(container.auth_service.get_current_user),
   |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
51 |         child_route_handlers: ChildRouteHandlers = Depends(
52 |             Provide[container.child_route_handlers],
   |

src/presentation/api/endpoints/children/routes.py:51:52: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
49 |       async def get_children_endpoint(
50 |           current_user: User = Depends(container.auth_service.get_current_user),
51 |           child_route_handlers: ChildRouteHandlers = Depends(
   |  ____________________________________________________^
52 | |             Provide[container.child_route_handlers],
53 | |         ),
   | |_________^ B008
54 |       ):
55 |           """Get list of children for the authenticated parent."""
   |

src/presentation/api/endpoints/children/routes.py:66:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
64 |     async def get_child_endpoint(
65 |         child_id: str,
66 |         current_user: User = Depends(container.auth_service.get_current_user),
   |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
67 |         child_route_handlers: ChildRouteHandlers = Depends(
68 |             Provide[container.child_route_handlers],
   |

src/presentation/api/endpoints/children/routes.py:67:52: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
65 |           child_id: str,
66 |           current_user: User = Depends(container.auth_service.get_current_user),
67 |           child_route_handlers: ChildRouteHandlers = Depends(
   |  ____________________________________________________^
68 | |             Provide[container.child_route_handlers],
69 | |         ),
   | |_________^ B008
70 |       ):
71 |           """Get detailed information for a specific child."""
   |

src/presentation/api/endpoints/children/routes.py:83:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
81 |         child_id: str,
82 |         request: ChildProfile,
83 |         current_user: User = Depends(container.auth_service.get_current_user),
   |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
84 |         child_route_handlers: ChildRouteHandlers = Depends(
85 |             Provide[container.child_route_handlers],
   |

src/presentation/api/endpoints/children/routes.py:84:52: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
82 |           request: ChildProfile,
83 |           current_user: User = Depends(container.auth_service.get_current_user),
84 |           child_route_handlers: ChildRouteHandlers = Depends(
   |  ____________________________________________________^
85 | |             Provide[container.child_route_handlers],
86 | |         ),
   | |_________^ B008
87 |       ):
88 |           """Update an existing child profile."""
   |

src/presentation/api/endpoints/children/routes.py:103:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
101 |     async def delete_child_endpoint(
102 |         child_id: str,
103 |         current_user: User = Depends(container.auth_service.get_current_user),
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
104 |         child_route_handlers: ChildRouteHandlers = Depends(
105 |             Provide[container.child_route_handlers],
    |

src/presentation/api/endpoints/children/routes.py:104:52: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
102 |           child_id: str,
103 |           current_user: User = Depends(container.auth_service.get_current_user),
104 |           child_route_handlers: ChildRouteHandlers = Depends(
    |  ____________________________________________________^
105 | |             Provide[container.child_route_handlers],
106 | |         ),
    | |_________^ B008
107 |       ):
108 |           """Delete a child profile with COPPA compliance checks."""
    |

src/presentation/api/endpoints/children/routes.py:119:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
117 |     async def get_child_safety_status_endpoint(
118 |         child_id: str,
119 |         current_user: User = Depends(container.auth_service.get_current_user),
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
120 |         child_route_handlers: ChildRouteHandlers = Depends(
121 |             Provide[container.child_route_handlers],
    |

src/presentation/api/endpoints/children/routes.py:120:52: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
118 |           child_id: str,
119 |           current_user: User = Depends(container.auth_service.get_current_user),
120 |           child_route_handlers: ChildRouteHandlers = Depends(
    |  ____________________________________________________^
121 | |             Provide[container.child_route_handlers],
122 | |         ),
    | |_________^ B008
123 |       ):
124 |           """Get real-time safety status for a child profile."""
    |

src/presentation/api/endpoints/children/routes.py:153:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
151 |             }
152 |         except Exception as e:
153 |             logger.error(f"Error getting activity log: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
154 |             raise HTTPException(
155 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/routes.py:154:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
152 |           except Exception as e:
153 |               logger.error(f"Error getting activity log: {e}")
154 | /             raise HTTPException(
155 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
156 | |                 detail=f"Failed to get activity log: {e!s}",
157 | |             )
    | |_____________^ B904
158 |
159 |       @router.get("/{child_id}/compliance-report")
    |

src/presentation/api/endpoints/children/routes.py:172:13: TRY300 Consider moving this statement to an `else` block
    |
170 |                 "compliance_score": 100,
171 |             }
172 |             return report
    |             ^^^^^^^^^^^^^ TRY300
173 |         except Exception as e:
174 |             logger.error(f"Error getting compliance report: {e}")
    |

src/presentation/api/endpoints/children/routes.py:172:20: RET504 Unnecessary assignment to `report` before `return` statement
    |
170 |                 "compliance_score": 100,
171 |             }
172 |             return report
    |                    ^^^^^^ RET504
173 |         except Exception as e:
174 |             logger.error(f"Error getting compliance report: {e}")
    |
    = help: Remove unnecessary assignment

src/presentation/api/endpoints/children/routes.py:174:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
172 |             return report
173 |         except Exception as e:
174 |             logger.error(f"Error getting compliance report: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
175 |             raise HTTPException(
176 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/routes.py:175:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
173 |           except Exception as e:
174 |               logger.error(f"Error getting compliance report: {e}")
175 | /             raise HTTPException(
176 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
177 | |                 detail=f"Failed to get compliance report: {e!s}",
178 | |             )
    | |_____________^ B904
    |

src/presentation/api/endpoints/children/routes_di.py:28:20: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
26 | async def create_child(
27 |     request: ChildCreateRequest,
28 |     current_parent=Depends(Container.auth_service.get_current_parent),
   |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
29 |     manage_child_use_case: ManageChildProfileUseCase = Depends(
30 |         Provide[Container.manage_child_profile_use_case],
   |

src/presentation/api/endpoints/children/routes_di.py:29:56: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
27 |       request: ChildCreateRequest,
28 |       current_parent=Depends(Container.auth_service.get_current_parent),
29 |       manage_child_use_case: ManageChildProfileUseCase = Depends(
   |  ________________________________________________________^
30 | |         Provide[Container.manage_child_profile_use_case],
31 | |     ),
   | |_____^ B008
32 |       coppa_service=Depends(Provide[Container.coppa_compliance_service]),
33 |       safety_monitor=Depends(Provide[Container.safety_monitor]),
   |

src/presentation/api/endpoints/children/routes_di.py:32:19: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
30 |         Provide[Container.manage_child_profile_use_case],
31 |     ),
32 |     coppa_service=Depends(Provide[Container.coppa_compliance_service]),
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
33 |     safety_monitor=Depends(Provide[Container.safety_monitor]),
34 | ) -> ChildResponse:
   |

src/presentation/api/endpoints/children/routes_di.py:33:20: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
31 |     ),
32 |     coppa_service=Depends(Provide[Container.coppa_compliance_service]),
33 |     safety_monitor=Depends(Provide[Container.safety_monitor]),
   |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
34 | ) -> ChildResponse:
35 |     """Create a new child profile with COPPA compliance."""
   |

src/presentation/api/endpoints/children/routes_di.py:40:13: TRY301 Abstract `raise` to an inner function
   |
38 |           age_validation = await coppa_service.validate_child_age(request.age)
39 |           if not age_validation.get("compliant", True):
40 | /             raise HTTPException(
41 | |                 status_code=status.HTTP_400_BAD_REQUEST,
42 | |                 detail=age_validation.get("reason", "Age validation failed"),
43 | |             )
   | |_____________^ TRY301
44 |
45 |           # Create consent record
   |

src/presentation/api/endpoints/children/routes_di.py:101:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
 99 |         raise
100 |     except Exception as e:
101 |         logger.error(f"Error creating child profile: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
102 |         raise HTTPException(
103 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/routes_di.py:102:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
100 |       except Exception as e:
101 |           logger.error(f"Error creating child profile: {e}")
102 | /         raise HTTPException(
103 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
104 | |             detail="Failed to create child profile",
105 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/children/routes_di.py:111:20: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
109 | @inject
110 | async def list_children(
111 |     current_parent=Depends(Container.auth_service.get_current_parent),
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
112 |     manage_child_use_case: ManageChildProfileUseCase = Depends(
113 |         Provide[Container.manage_child_profile_use_case],
    |

src/presentation/api/endpoints/children/routes_di.py:112:56: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
110 |   async def list_children(
111 |       current_parent=Depends(Container.auth_service.get_current_parent),
112 |       manage_child_use_case: ManageChildProfileUseCase = Depends(
    |  ________________________________________________________^
113 | |         Provide[Container.manage_child_profile_use_case],
114 | |     ),
    | |_____^ B008
115 |   ) -> list[ChildResponse]:
116 |       """List all children for the current parent."""
    |

src/presentation/api/endpoints/children/routes_di.py:136:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
134 |         ]
135 |     except Exception as e:
136 |         logger.error(f"Error listing children: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
137 |         raise HTTPException(
138 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/routes_di.py:137:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
135 |       except Exception as e:
136 |           logger.error(f"Error listing children: {e}")
137 | /         raise HTTPException(
138 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
139 | |             detail="Failed to list children",
140 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/children/routes_di.py:147:20: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
145 | async def get_child(
146 |     child_id: UUID,
147 |     current_parent=Depends(Container.auth_service.get_current_parent),
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
148 |     manage_child_use_case: ManageChildProfileUseCase = Depends(
149 |         Provide[Container.manage_child_profile_use_case],
    |

src/presentation/api/endpoints/children/routes_di.py:148:56: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
146 |       child_id: UUID,
147 |       current_parent=Depends(Container.auth_service.get_current_parent),
148 |       manage_child_use_case: ManageChildProfileUseCase = Depends(
    |  ________________________________________________________^
149 | |         Provide[Container.manage_child_profile_use_case],
150 | |     ),
    | |_____^ B008
151 |   ) -> ChildResponse:
152 |       """Get a specific child profile."""
    |

src/presentation/api/endpoints/children/routes_di.py:158:13: TRY301 Abstract `raise` to an inner function
    |
156 |           # Verify parent ownership
157 |           if getattr(child, "parent_id", None) != current_parent.id:
158 | /             raise HTTPException(
159 | |                 status_code=status.HTTP_403_FORBIDDEN,
160 | |                 detail="Access denied to this child profile",
161 | |             )
    | |_____________^ TRY301
162 |
163 |           return ChildResponse(
    |

src/presentation/api/endpoints/children/routes_di.py:178:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
176 |         raise
177 |     except Exception as e:
178 |         logger.error(f"Error getting child {child_id}: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
179 |         raise HTTPException(
180 |             status_code=status.HTTP_404_NOT_FOUND,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/routes_di.py:179:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
177 |       except Exception as e:
178 |           logger.error(f"Error getting child {child_id}: {e}")
179 | /         raise HTTPException(
180 | |             status_code=status.HTTP_404_NOT_FOUND,
181 | |             detail="Child not found",
182 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/children/routes_di.py:187:11: PLR0913 Too many arguments in function definition (6 > 5)
    |
185 | @router.put("/{child_id}", response_model=ChildResponse)
186 | @inject
187 | async def update_child(
    |           ^^^^^^^^^^^^ PLR0913
188 |     child_id: UUID,
189 |     request: ChildUpdateRequest,
    |

src/presentation/api/endpoints/children/routes_di.py:190:20: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
188 |     child_id: UUID,
189 |     request: ChildUpdateRequest,
190 |     current_parent=Depends(Container.auth_service.get_current_parent),
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
191 |     manage_child_use_case: ManageChildProfileUseCase = Depends(
192 |         Provide[Container.manage_child_profile_use_case],
    |

src/presentation/api/endpoints/children/routes_di.py:191:56: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
189 |       request: ChildUpdateRequest,
190 |       current_parent=Depends(Container.auth_service.get_current_parent),
191 |       manage_child_use_case: ManageChildProfileUseCase = Depends(
    |  ________________________________________________________^
192 | |         Provide[Container.manage_child_profile_use_case],
193 | |     ),
    | |_____^ B008
194 |       coppa_service=Depends(Provide[Container.coppa_compliance_service]),
195 |       safety_monitor=Depends(Provide[Container.safety_monitor]),
    |

src/presentation/api/endpoints/children/routes_di.py:194:19: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
192 |         Provide[Container.manage_child_profile_use_case],
193 |     ),
194 |     coppa_service=Depends(Provide[Container.coppa_compliance_service]),
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
195 |     safety_monitor=Depends(Provide[Container.safety_monitor]),
196 | ) -> ChildResponse:
    |

src/presentation/api/endpoints/children/routes_di.py:195:20: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
193 |     ),
194 |     coppa_service=Depends(Provide[Container.coppa_compliance_service]),
195 |     safety_monitor=Depends(Provide[Container.safety_monitor]),
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
196 | ) -> ChildResponse:
197 |     """Update a child profile."""
    |

src/presentation/api/endpoints/children/routes_di.py:204:13: TRY301 Abstract `raise` to an inner function
    |
202 |           # Verify parent ownership
203 |           if getattr(child, "parent_id", None) != current_parent.id:
204 | /             raise HTTPException(
205 | |                 status_code=status.HTTP_403_FORBIDDEN,
206 | |                 detail="Access denied to this child profile",
207 | |             )
    | |_____________^ TRY301
208 |
209 |           # Validate age if being updated
    |

src/presentation/api/endpoints/children/routes_di.py:213:17: TRY301 Abstract `raise` to an inner function
    |
211 |               age_validation = await coppa_service.validate_child_age(request.age)
212 |               if not age_validation.get("compliant", True):
213 | /                 raise HTTPException(
214 | |                     status_code=status.HTTP_400_BAD_REQUEST,
215 | |                     detail=age_validation.get("reason", "Age validation failed"),
216 | |                 )
    | |_________________^ TRY301
217 |
218 |           # Prepare update data
    |

src/presentation/api/endpoints/children/routes_di.py:264:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
262 |         raise
263 |     except Exception as e:
264 |         logger.error(f"Error updating child {child_id}: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
265 |         raise HTTPException(
266 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/routes_di.py:265:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
263 |       except Exception as e:
264 |           logger.error(f"Error updating child {child_id}: {e}")
265 | /         raise HTTPException(
266 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
267 | |             detail="Failed to update child profile",
268 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/children/routes_di.py:275:20: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
273 | async def delete_child(
274 |     child_id: UUID,
275 |     current_parent=Depends(Container.auth_service.get_current_parent),
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
276 |     manage_child_use_case: ManageChildProfileUseCase = Depends(
277 |         Provide[Container.manage_child_profile_use_case],
    |

src/presentation/api/endpoints/children/routes_di.py:276:56: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
274 |       child_id: UUID,
275 |       current_parent=Depends(Container.auth_service.get_current_parent),
276 |       manage_child_use_case: ManageChildProfileUseCase = Depends(
    |  ________________________________________________________^
277 | |         Provide[Container.manage_child_profile_use_case],
278 | |     ),
    | |_____^ B008
279 |       coppa_service=Depends(Provide[Container.coppa_compliance_service]),
280 |       safety_monitor=Depends(Provide[Container.safety_monitor]),
    |

src/presentation/api/endpoints/children/routes_di.py:279:19: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
277 |         Provide[Container.manage_child_profile_use_case],
278 |     ),
279 |     coppa_service=Depends(Provide[Container.coppa_compliance_service]),
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
280 |     safety_monitor=Depends(Provide[Container.safety_monitor]),
281 | ) -> ChildDeleteResponse:
    |

src/presentation/api/endpoints/children/routes_di.py:280:20: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
278 |     ),
279 |     coppa_service=Depends(Provide[Container.coppa_compliance_service]),
280 |     safety_monitor=Depends(Provide[Container.safety_monitor]),
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
281 | ) -> ChildDeleteResponse:
282 |     """Delete a child profile with COPPA compliance."""
    |

src/presentation/api/endpoints/children/routes_di.py:289:13: TRY301 Abstract `raise` to an inner function
    |
287 |           # Verify parent ownership
288 |           if getattr(child, "parent_id", None) != current_parent.id:
289 | /             raise HTTPException(
290 | |                 status_code=status.HTTP_403_FORBIDDEN,
291 | |                 detail="Access denied to this child profile",
292 | |             )
    | |_____________^ TRY301
293 |
294 |           # Schedule COPPA-compliant data deletion
    |

src/presentation/api/endpoints/children/routes_di.py:317:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
315 |         raise
316 |     except Exception as e:
317 |         logger.error(f"Error deleting child {child_id}: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
318 |         raise HTTPException(
319 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/routes_di.py:318:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
316 |       except Exception as e:
317 |           logger.error(f"Error deleting child {child_id}: {e}")
318 | /         raise HTTPException(
319 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
320 | |             detail="Failed to delete child profile",
321 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/children/routes_di.py:328:20: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
326 | async def get_child_safety_summary(
327 |     child_id: UUID,
328 |     current_parent=Depends(Container.auth_service.get_current_parent),
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
329 |     manage_child_use_case: ManageChildProfileUseCase = Depends(
330 |         Provide[Container.manage_child_profile_use_case],
    |

src/presentation/api/endpoints/children/routes_di.py:329:56: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
327 |       child_id: UUID,
328 |       current_parent=Depends(Container.auth_service.get_current_parent),
329 |       manage_child_use_case: ManageChildProfileUseCase = Depends(
    |  ________________________________________________________^
330 | |         Provide[Container.manage_child_profile_use_case],
331 | |     ),
    | |_____^ B008
332 |       safety_monitor=Depends(Provide[Container.safety_monitor]),
333 |       database_service=Depends(Provide[Container.database_service]),
    |

src/presentation/api/endpoints/children/routes_di.py:332:5: ARG001 Unused function argument: `safety_monitor`
    |
330 |         Provide[Container.manage_child_profile_use_case],
331 |     ),
332 |     safety_monitor=Depends(Provide[Container.safety_monitor]),
    |     ^^^^^^^^^^^^^^ ARG001
333 |     database_service=Depends(Provide[Container.database_service]),
334 | ) -> dict[str, Any]:
    |

src/presentation/api/endpoints/children/routes_di.py:332:20: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
330 |         Provide[Container.manage_child_profile_use_case],
331 |     ),
332 |     safety_monitor=Depends(Provide[Container.safety_monitor]),
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
333 |     database_service=Depends(Provide[Container.database_service]),
334 | ) -> dict[str, Any]:
    |

src/presentation/api/endpoints/children/routes_di.py:333:22: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
331 |     ),
332 |     safety_monitor=Depends(Provide[Container.safety_monitor]),
333 |     database_service=Depends(Provide[Container.database_service]),
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
334 | ) -> dict[str, Any]:
335 |     """Get safety summary for a child."""
    |

src/presentation/api/endpoints/children/routes_di.py:340:13: TRY301 Abstract `raise` to an inner function
    |
338 |           child = await manage_child_use_case.get_child(child_id)
339 |           if getattr(child, "parent_id", None) != current_parent.id:
340 | /             raise HTTPException(
341 | |                 status_code=status.HTTP_403_FORBIDDEN,
342 | |                 detail="Access denied to this child's safety data",
343 | |             )
    | |_____________^ TRY301
344 |
345 |           # Get safety events
    |

src/presentation/api/endpoints/children/routes_di.py:388:34: PLR2004 Magic value used in comparison, consider replacing `2` with a constant variable
    |
386 |         ]
387 |
388 |         if high_severity_count > 2:
    |                                  ^ PLR2004
389 |             recommendations.append("Consider adjusting content filters")
    |

src/presentation/api/endpoints/children/routes_di.py:412:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
410 |         raise
411 |     except Exception as e:
412 |         logger.error(f"Error getting safety summary for child {child_id}: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
413 |         raise HTTPException(
414 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/routes_di.py:413:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
411 |       except Exception as e:
412 |           logger.error(f"Error getting safety summary for child {child_id}: {e}")
413 | /         raise HTTPException(
414 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
415 | |             detail="Failed to get safety summary",
416 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/children/routes_di.py:424:20: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
422 |     child_id: UUID,
423 |     limit: int = 50,
424 |     current_parent=Depends(Container.auth_service.get_current_parent),
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
425 |     manage_child_use_case: ManageChildProfileUseCase = Depends(
426 |         Provide[Container.manage_child_profile_use_case],
    |

src/presentation/api/endpoints/children/routes_di.py:425:56: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
423 |       limit: int = 50,
424 |       current_parent=Depends(Container.auth_service.get_current_parent),
425 |       manage_child_use_case: ManageChildProfileUseCase = Depends(
    |  ________________________________________________________^
426 | |         Provide[Container.manage_child_profile_use_case],
427 | |     ),
    | |_____^ B008
428 |       database_service=Depends(Provide[Container.database_service]),
429 |   ) -> dict[str, Any]:
    |

src/presentation/api/endpoints/children/routes_di.py:428:22: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
426 |         Provide[Container.manage_child_profile_use_case],
427 |     ),
428 |     database_service=Depends(Provide[Container.database_service]),
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
429 | ) -> dict[str, Any]:
430 |     """Get recent interactions for a child."""
    |

src/presentation/api/endpoints/children/routes_di.py:435:13: TRY301 Abstract `raise` to an inner function
    |
433 |           child = await manage_child_use_case.get_child(child_id)
434 |           if getattr(child, "parent_id", None) != current_parent.id:
435 | /             raise HTTPException(
436 | |                 status_code=status.HTTP_403_FORBIDDEN,
437 | |                 detail="Access denied to this child's interaction data",
438 | |             )
    | |_____________^ TRY301
439 |
440 |           # Get interactions
    |

src/presentation/api/endpoints/children/routes_di.py:458:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
456 |         raise
457 |     except Exception as e:
458 |         logger.error(f"Error getting interactions for child {child_id}: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
459 |         raise HTTPException(
460 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/routes_di.py:459:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
457 |       except Exception as e:
458 |           logger.error(f"Error getting interactions for child {child_id}: {e}")
459 | /         raise HTTPException(
460 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
461 | |             detail="Failed to get child interactions",
462 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/children/routes_refactored.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Refactored Children Routes
2 | | Clean, modular route setup with separated endpoint handlers.
3 | | """
  | |___^ D205
4 |
5 |   from fastapi import APIRouter
  |
  = help: Insert single blank line

src/presentation/api/endpoints/children/routes_refactored.py:150:12: RUF013 PEP 484 prohibits implicit `Optional`
    |
149 | async def search_children_endpoint(
150 |     query: str = None,
    |            ^^^ RUF013
151 |     age_min: int = None,
152 |     age_max: int = None,
    |
    = help: Convert to `T | None`

src/presentation/api/endpoints/children/routes_refactored.py:151:14: RUF013 PEP 484 prohibits implicit `Optional`
    |
149 | async def search_children_endpoint(
150 |     query: str = None,
151 |     age_min: int = None,
    |              ^^^ RUF013
152 |     age_max: int = None,
153 | ):
    |
    = help: Convert to `T | None`

src/presentation/api/endpoints/children/routes_refactored.py:152:14: RUF013 PEP 484 prohibits implicit `Optional`
    |
150 |     query: str = None,
151 |     age_min: int = None,
152 |     age_max: int = None,
    |              ^^^ RUF013
153 | ):
154 |     """Search children profiles with filters."""
    |
    = help: Convert to `T | None`

src/presentation/api/endpoints/children/routes_refactored.py:257:15: TRY003 Avoid specifying long messages outside the exception class
    |
255 |     """Get children router based on configuration."""
256 |     if config not in ROUTER_CONFIGS:
257 |         raise ValueError(f"Unknown router config: {config}")
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
258 |
259 |     return ROUTER_CONFIGS[config]()
    |

src/presentation/api/endpoints/children/safety.py:20:11: N818 Exception name `HTTPException` should be named with an Error suffix
   |
18 |     FASTAPI_AVAILABLE = False
19 |
20 |     class HTTPException(Exception):
   |           ^^^^^^^^^^^^^ N818
21 |         def __init__(self, status_code: int, detail: str) -> None:
22 |             self.status_code = status_code
   |

src/presentation/api/endpoints/children/safety.py:25:11: N801 Class name `status` should use CapWords convention
   |
23 |             self.detail = detail
24 |
25 |     class status:
   |           ^^^^^^ N801
26 |         HTTP_404_NOT_FOUND = 404
27 |         HTTP_500_INTERNAL_SERVER_ERROR = 500
   |

src/presentation/api/endpoints/children/safety.py:68:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
66 |             return ChildSafetySummary.from_safety_events(child_id, safety_events)
67 |         except Exception as e:
68 |             logger.error(f"Error getting safety summary for child {child_id}: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
69 |             raise HTTPException(
70 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
   |
   = help: Replace with `exception`

src/presentation/api/endpoints/children/safety.py:69:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
67 |           except Exception as e:
68 |               logger.error(f"Error getting safety summary for child {child_id}: {e}")
69 | /             raise HTTPException(
70 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
71 | |                 detail=f"Failed to get safety summary: {e!s}",
72 | |             )
   | |_____________^ B904
73 |
74 |       @staticmethod
   |

src/presentation/api/endpoints/children/safety.py:108:13: TRY300 Consider moving this statement to an `else` block
    |
106 |             await ChildSafetyManager.update_safety_score(child_id, event_type)
107 |
108 |             return event_record
    |             ^^^^^^^^^^^^^^^^^^^ TRY300
109 |         except Exception as e:
110 |             logger.error(f"Error recording safety event: {e}")
    |

src/presentation/api/endpoints/children/safety.py:110:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
108 |             return event_record
109 |         except Exception as e:
110 |             logger.error(f"Error recording safety event: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
111 |             raise HTTPException(
112 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/safety.py:111:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
109 |           except Exception as e:
110 |               logger.error(f"Error recording safety event: {e}")
111 | /             raise HTTPException(
112 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
113 | |                 detail=f"Failed to record safety event: {e!s}",
114 | |             )
    | |_____________^ B904
115 |
116 |       @staticmethod
    |

src/presentation/api/endpoints/children/safety.py:151:21: TRY301 Abstract `raise` to an inner function
    |
149 |                 if not success:
150 |                     logger.error(f"Failed to update safety score for child {child_id}")
151 |                     raise RuntimeError("Safety score update failed")
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
152 |             except Exception as e:
153 |                 logger.error(f"Error updating safety score for child {child_id}: {e}")
    |

src/presentation/api/endpoints/children/safety.py:151:27: TRY003 Avoid specifying long messages outside the exception class
    |
149 |                 if not success:
150 |                     logger.error(f"Failed to update safety score for child {child_id}")
151 |                     raise RuntimeError("Safety score update failed")
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
152 |             except Exception as e:
153 |                 logger.error(f"Error updating safety score for child {child_id}: {e}")
    |

src/presentation/api/endpoints/children/safety.py:153:17: TRY400 Use `logging.exception` instead of `logging.error`
    |
151 |                     raise RuntimeError("Safety score update failed")
152 |             except Exception as e:
153 |                 logger.error(f"Error updating safety score for child {child_id}: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
154 |                 raise
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/safety.py:157:28: PLR2004 Magic value used in comparison, consider replacing `70` with a constant variable
    |
156 |             # Send alert if score drops significantly
157 |             if new_score < 70:
    |                            ^^ PLR2004
158 |                 await ChildSafetyManager.send_safety_alert(
159 |                     child_id,
    |

src/presentation/api/endpoints/children/safety.py:164:13: TRY300 Consider moving this statement to an `else` block
    |
162 |                 )
163 |
164 |             return new_score
    |             ^^^^^^^^^^^^^^^^ TRY300
165 |         except Exception as e:
166 |             logger.error(f"Error updating safety score: {e}")
    |

src/presentation/api/endpoints/children/safety.py:166:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
164 |             return new_score
165 |         except Exception as e:
166 |             logger.error(f"Error updating safety score: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
167 |             return 100
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/safety.py:181:57: PLR2004 Magic value used in comparison, consider replacing `50` with a constant variable
    |
179 |                 "safety_score": safety_score,
180 |                 "event_type": event_type,
181 |                 "alert_level": "high" if safety_score < 50 else "medium",
    |                                                         ^^ PLR2004
182 |                 "timestamp": datetime.now().isoformat(),
183 |                 "message": f"Safety score dropped to {safety_score}% due to {event_type}",
    |

src/presentation/api/endpoints/children/safety.py:183:89: E501 Line too long (90 > 88)
    |
181 |                 "alert_level": "high" if safety_score < 50 else "medium",
182 |                 "timestamp": datetime.now().isoformat(),
183 |                 "message": f"Safety score dropped to {safety_score}% due to {event_type}",
    |                                                                                         ^^ E501
184 |             }
    |

src/presentation/api/endpoints/children/safety.py:194:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
192 |             await db_service.send_safety_alert(alert_data)
193 |         except Exception as e:
194 |             logger.error(f"Error sending safety alert: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
195 |
196 |     @staticmethod
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/safety.py:215:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
213 |             return await db_service.get_safety_events(child_id, limit)
214 |         except Exception as e:
215 |             logger.error(f"Error getting safety events: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
216 |             return []
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/safety.py:246:49: PLR2004 Magic value used in comparison, consider replacing `8` with a constant variable
    |
244 |                 "violations": violations,
245 |                 "is_safe": len(violations) == 0,
246 |                 "age_appropriate": child_age >= 8,  # Age appropriateness check
    |                                                 ^ PLR2004
247 |             }
248 |         except Exception as e:
    |

src/presentation/api/endpoints/children/safety.py:249:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
247 |             }
248 |         except Exception as e:
249 |             logger.error(f"Error filtering text content: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
250 |             return {
251 |                 "original_text": text,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/safety.py:292:54: PLR2004 Magic value used in comparison, consider replacing `8` with a constant variable
    |
290 |             # Check interaction frequency
291 |             if "daily_interactions" in interaction_data:
292 |                 max_interactions = 20 if child_age < 8 else 30
    |                                                      ^ PLR2004
293 |                 if interaction_data["daily_interactions"] > max_interactions:
294 |                     safety_checks["frequency_normal"] = False
    |

src/presentation/api/endpoints/children/safety.py:304:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
302 |             }
303 |         except Exception as e:
304 |             logger.error(f"Error validating interaction safety: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
305 |             return {
306 |                 "safety_checks": {},
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/safety.py:335:36: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
    |
333 |             for field, value in data.items():
334 |                 if field in sensitive_fields:
335 |                     if child_age < 13:
    |                                    ^^ PLR2004
336 |                         violations.append(f"sharing_{field}_under_13")
337 |                         protected_data[field] = "PROTECTED"
    |

src/presentation/api/endpoints/children/safety.py:347:49: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
    |
345 |                 "violations": violations,
346 |                 "sharing_allowed": len(violations) == 0,
347 |                 "coppa_compliant": child_age >= 13 or len(violations) == 0,
    |                                                 ^^ PLR2004
348 |             }
349 |         except Exception as e:
    |

src/presentation/api/endpoints/children/safety.py:350:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
348 |             }
349 |         except Exception as e:
350 |             logger.error(f"Error validating data sharing: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
351 |             return {
352 |                 "protected_data": data,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/safety.py:380:13: TRY300 Consider moving this statement to an `else` block
    |
378 |             anonymized["anonymized_at"] = datetime.now().isoformat()
379 |
380 |             return anonymized
    |             ^^^^^^^^^^^^^^^^^ TRY300
381 |         except Exception as e:
382 |             logger.error(f"Error anonymizing child data: {e}")
    |

src/presentation/api/endpoints/children/safety.py:382:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
380 |             return anonymized
381 |         except Exception as e:
382 |             logger.error(f"Error anonymizing child data: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
383 |             return data
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/safety.py:414:30: PLR2004 Magic value used in comparison, consider replacing `120` with a constant variable
    |
412 |             # Check usage limits
413 |             daily_usage = await db_service.get_daily_usage(child_id)
414 |             if daily_usage > 120:  # More than 2 hours
    |                              ^^^ PLR2004
415 |                 await ChildSafetyManager.record_safety_event(
416 |                     child_id,
    |

src/presentation/api/endpoints/children/safety.py:421:13: TRY300 Consider moving this statement to an `else` block
    |
419 |                 )
420 |
421 |             return usage_record
    |             ^^^^^^^^^^^^^^^^^^^ TRY300
422 |         except Exception as e:
423 |             logger.error(f"Error tracking usage: {e}")
    |

src/presentation/api/endpoints/children/safety.py:423:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
421 |             return usage_record
422 |         except Exception as e:
423 |             logger.error(f"Error tracking usage: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
424 |             return {"error": str(e)}
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children/safety.py:445:13: TRY300 Consider moving this statement to an `else` block
    |
443 |             db_service = get_database_service()
444 |             usage_stats = await db_service.get_usage_statistics(child_id, days)
445 |             return usage_stats
    |             ^^^^^^^^^^^^^^^^^^ TRY300
446 |         except Exception as e:
447 |             logger.error(f"Error getting usage statistics: {e}")
    |

src/presentation/api/endpoints/children/safety.py:445:20: RET504 Unnecessary assignment to `usage_stats` before `return` statement
    |
443 |             db_service = get_database_service()
444 |             usage_stats = await db_service.get_usage_statistics(child_id, days)
445 |             return usage_stats
    |                    ^^^^^^^^^^^ RET504
446 |         except Exception as e:
447 |             logger.error(f"Error getting usage statistics: {e}")
    |
    = help: Remove unnecessary assignment

src/presentation/api/endpoints/children/safety.py:447:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
445 |             return usage_stats
446 |         except Exception as e:
447 |             logger.error(f"Error getting usage statistics: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
448 |             return {"error": str(e)}
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/children_legacy.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """API endpoints لإدارة ملفات الأطفال - Legacy compatibility file
2 | | This file provides backward compatibility by re-exporting all children endpoints.
3 | | """
  | |___^ D205
4 |
5 |   from src.infrastructure.logging_config import get_logger
  |
  = help: Insert single blank line

src/presentation/api/endpoints/conversations.py:1:1: I001 [*] Import block is un-sorted or un-formatted
   |
 1 | / from datetime import datetime
 2 | | from typing import Any
 3 | | from uuid import uuid4
 4 | | from src.presentation.api.models.validation_models import ConversationRequest
 5 | | from dependency_injector.wiring import Provide, inject
 6 | | from fastapi import APIRouter, Depends, HTTPException, status
 7 | | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
 8 | | from pydantic import BaseModel, Field, field_validator
 9 | |
10 | | from src.application.services.ai_orchestration_service import (
11 | |     AIOrchestrationService,
12 | | )
13 | | from src.application.services.conversation_service import ConversationService
14 | | from src.application.use_cases.manage_child_profile import (
15 | |     ManageChildProfileUseCase,
16 | | )
17 | | from src.infrastructure.di.container import container
18 | | from src.infrastructure.logging_config import get_logger
19 | | from src.infrastructure.security.real_auth_service import ProductionAuthService
20 | | from src.infrastructure.security.safety_monitor_service import (
21 | |     SafetyMonitorService,
22 | | )
   | |_^ I001
23 |
24 |   logger = get_logger(__name__, component="api")
   |
   = help: Organize imports

src/presentation/api/endpoints/conversations.py:1:22: F401 [*] `datetime.datetime` imported but unused
  |
1 | from datetime import datetime
  |                      ^^^^^^^^ F401
2 | from typing import Any
3 | from uuid import uuid4
  |
  = help: Remove unused import: `datetime.datetime`

src/presentation/api/endpoints/conversations.py:3:18: F401 [*] `uuid.uuid4` imported but unused
  |
1 | from datetime import datetime
2 | from typing import Any
3 | from uuid import uuid4
  |                  ^^^^^ F401
4 | from src.presentation.api.models.validation_models import ConversationRequest
5 | from dependency_injector.wiring import Provide, inject
  |
  = help: Remove unused import: `uuid.uuid4`

src/presentation/api/endpoints/conversations.py:4:59: F401 [*] `src.presentation.api.models.validation_models.ConversationRequest` imported but unused
  |
2 | from typing import Any
3 | from uuid import uuid4
4 | from src.presentation.api.models.validation_models import ConversationRequest
  |                                                           ^^^^^^^^^^^^^^^^^^^ F401
5 | from dependency_injector.wiring import Provide, inject
6 | from fastapi import APIRouter, Depends, HTTPException, status
  |
  = help: Remove unused import: `src.presentation.api.models.validation_models.ConversationRequest`

src/presentation/api/endpoints/conversations.py:5:40: F401 [*] `dependency_injector.wiring.Provide` imported but unused
  |
3 | from uuid import uuid4
4 | from src.presentation.api.models.validation_models import ConversationRequest
5 | from dependency_injector.wiring import Provide, inject
  |                                        ^^^^^^^ F401
6 | from fastapi import APIRouter, Depends, HTTPException, status
7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
  |
  = help: Remove unused import

src/presentation/api/endpoints/conversations.py:5:49: F401 [*] `dependency_injector.wiring.inject` imported but unused
  |
3 | from uuid import uuid4
4 | from src.presentation.api.models.validation_models import ConversationRequest
5 | from dependency_injector.wiring import Provide, inject
  |                                                 ^^^^^^ F401
6 | from fastapi import APIRouter, Depends, HTTPException, status
7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
  |
  = help: Remove unused import

src/presentation/api/endpoints/conversations.py:8:22: F401 [*] `pydantic.BaseModel` imported but unused
   |
 6 | from fastapi import APIRouter, Depends, HTTPException, status
 7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
 8 | from pydantic import BaseModel, Field, field_validator
   |                      ^^^^^^^^^ F401
 9 |
10 | from src.application.services.ai_orchestration_service import (
   |
   = help: Remove unused import

src/presentation/api/endpoints/conversations.py:8:33: F401 [*] `pydantic.Field` imported but unused
   |
 6 | from fastapi import APIRouter, Depends, HTTPException, status
 7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
 8 | from pydantic import BaseModel, Field, field_validator
   |                                 ^^^^^ F401
 9 |
10 | from src.application.services.ai_orchestration_service import (
   |
   = help: Remove unused import

src/presentation/api/endpoints/conversations.py:8:40: F401 [*] `pydantic.field_validator` imported but unused
   |
 6 | from fastapi import APIRouter, Depends, HTTPException, status
 7 | from fastapi.security import HTTPAuthorizationCredentials, HTTPBearer
 8 | from pydantic import BaseModel, Field, field_validator
   |                                        ^^^^^^^^^^^^^^^ F401
 9 |
10 | from src.application.services.ai_orchestration_service import (
   |
   = help: Remove unused import

src/presentation/api/endpoints/conversations.py:11:5: F401 [*] `src.application.services.ai_orchestration_service.AIOrchestrationService` imported but unused
   |
10 | from src.application.services.ai_orchestration_service import (
11 |     AIOrchestrationService,
   |     ^^^^^^^^^^^^^^^^^^^^^^ F401
12 | )
13 | from src.application.services.conversation_service import ConversationService
   |
   = help: Remove unused import: `src.application.services.ai_orchestration_service.AIOrchestrationService`

src/presentation/api/endpoints/conversations.py:13:59: F401 [*] `src.application.services.conversation_service.ConversationService` imported but unused
   |
11 |     AIOrchestrationService,
12 | )
13 | from src.application.services.conversation_service import ConversationService
   |                                                           ^^^^^^^^^^^^^^^^^^^ F401
14 | from src.application.use_cases.manage_child_profile import (
15 |     ManageChildProfileUseCase,
   |
   = help: Remove unused import: `src.application.services.conversation_service.ConversationService`

src/presentation/api/endpoints/conversations.py:15:5: F401 [*] `src.application.use_cases.manage_child_profile.ManageChildProfileUseCase` imported but unused
   |
13 | from src.application.services.conversation_service import ConversationService
14 | from src.application.use_cases.manage_child_profile import (
15 |     ManageChildProfileUseCase,
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^ F401
16 | )
17 | from src.infrastructure.di.container import container
   |
   = help: Remove unused import: `src.application.use_cases.manage_child_profile.ManageChildProfileUseCase`

src/presentation/api/endpoints/conversations.py:21:5: F401 [*] `src.infrastructure.security.safety_monitor_service.SafetyMonitorService` imported but unused
   |
19 | from src.infrastructure.security.real_auth_service import ProductionAuthService
20 | from src.infrastructure.security.safety_monitor_service import (
21 |     SafetyMonitorService,
   |     ^^^^^^^^^^^^^^^^^^^^ F401
22 | )
   |
   = help: Remove unused import: `src.infrastructure.security.safety_monitor_service.SafetyMonitorService`

src/presentation/api/endpoints/conversations.py:31:49: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
30 | async def get_authenticated_user(
31 |     credentials: HTTPAuthorizationCredentials = Depends(security),
   |                                                 ^^^^^^^^^^^^^^^^^ B008
32 |     auth_service: ProductionAuthService = Depends(container.auth_service),
33 | ) -> dict[str, Any]:
   |

src/presentation/api/endpoints/conversations.py:32:43: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
30 | async def get_authenticated_user(
31 |     credentials: HTTPAuthorizationCredentials = Depends(security),
32 |     auth_service: ProductionAuthService = Depends(container.auth_service),
   |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
33 | ) -> dict[str, Any]:
34 |     """Verify authentication for child conversation access - COPPA compliance required.
   |

src/presentation/api/endpoints/conversations.py:48:13: TRY301 Abstract `raise` to an inner function
   |
47 |           if not payload:
48 | /             raise HTTPException(
49 | |                 status_code=status.HTTP_401_UNAUTHORIZED,
50 | |                 detail="Invalid authentication token",
51 | |                 headers={"WWW-Authenticate": "Bearer"},
52 | |             )
   | |_____________^ TRY301
53 |
54 |           user_role = payload.get("role", "")
   |

src/presentation/api/endpoints/conversations.py:56:13: TRY301 Abstract `raise` to an inner function
   |
54 |           user_role = payload.get("role", "")
55 |           if user_role not in ["parent", "guardian", "admin"]:
56 | /             raise HTTPException(
57 | |                 status_code=status.HTTP_403_FORBIDDEN,
58 | |                 detail="Access denied: Only parents/guardians can access child conversation data",
59 | |             )
   | |_____________^ TRY301
60 |
61 |           return {
   |

src/presentation/api/endpoints/conversations.py:58:89: E501 Line too long (98 > 88)
   |
56 |             raise HTTPException(
57 |                 status_code=status.HTTP_403_FORBIDDEN,
58 |                 detail="Access denied: Only parents/guardians can access child conversation data",
   |                                                                                         ^^^^^^^^^^ E501
59 |             )
   |

src/presentation/api/endpoints/conversations.py:70:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
68 |           raise
69 |       except Exception:
70 | /         raise HTTPException(
71 | |             status_code=status.HTTP_401_UNAUTHORIZED,
72 | |             detail="Authentication verification failed",
73 | |             headers={"WWW-Authenticate": "Bearer"},
74 | |         )
   | |_________^ B904
   |

src/presentation/api/endpoints/conversations_paginated.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Paginated Conversations Endpoints
2 | | Provides paginated access to child conversations with COPPA compliance.
3 | | """
  | |___^ D205
4 |
5 |   from datetime import datetime, timedelta
  |
  = help: Insert single blank line

src/presentation/api/endpoints/conversations_paginated.py:31:23: ARG002 Unused method argument: `path`
   |
29 |             pass
30 |
31 |         def get(self, path: str, **kwargs):
   |                       ^^^^ ARG002
32 |             def decorator(func):
33 |                 return func
   |

src/presentation/api/endpoints/conversations_paginated.py:31:36: ARG002 Unused method argument: `kwargs`
   |
29 |             pass
30 |
31 |         def get(self, path: str, **kwargs):
   |                                    ^^^^^^ ARG002
32 |             def decorator(func):
33 |                 return func
   |

src/presentation/api/endpoints/conversations_paginated.py:50:89: E501 Line too long (94 > 88)
   |
48 |                 "timestamp": conversation_time.isoformat(),
49 |                 "child_message": f"Hello teddy! This is message {i + 1}",
50 |                 "ai_response": f"Hello! I'm happy to talk with you. This is response {i + 1}",
   |                                                                                         ^^^^^^ E501
51 |                 "safety_flags": ["appropriate_content"] if i % 10 == 0 else [],
52 |                 "emotion_detected": ["happy", "curious", "excited", "calm"][i % 4],
   |

src/presentation/api/endpoints/conversations_paginated.py:83:17: TRY301 Abstract `raise` to an inner function
   |
81 |                   child_id,
82 |               ):
83 | /                 raise HTTPException(
84 | |                     status_code=status.HTTP_403_FORBIDDEN,
85 | |                     detail="Parent does not have access to this child's conversations",
86 | |                 )
   | |_________________^ TRY301
87 |
88 |               # Create child-safe pagination
   |

src/presentation/api/endpoints/conversations_paginated.py:107:13: TRY300 Consider moving this statement to an `else` block
    |
105 |                 f"Retrieved {len(result.items)} conversations for child {child_id}",
106 |             )
107 |             return result
    |             ^^^^^^^^^^^^^ TRY300
108 |         except HTTPException:
109 |             raise
    |

src/presentation/api/endpoints/conversations_paginated.py:111:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
109 |             raise
110 |         except Exception as e:
111 |             logger.error(f"Error getting conversations for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
112 |             raise HTTPException(
113 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/conversations_paginated.py:112:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
110 |           except Exception as e:
111 |               logger.error(f"Error getting conversations for child {child_id}: {e}")
112 | /             raise HTTPException(
113 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
114 | |                 detail=f"Failed to get conversations: {e!s}",
115 | |             )
    | |_____________^ B904
116 |
117 |       async def get_conversation_history(
    |

src/presentation/api/endpoints/conversations_paginated.py:153:89: E501 Line too long (91 > 88)
    |
152 |             logger.info(
153 |                 f"Retrieved {len(result.items)} recent conversations for child {child_id}",
    |                                                                                         ^^^ E501
154 |             )
155 |             return result
    |

src/presentation/api/endpoints/conversations_paginated.py:155:13: TRY300 Consider moving this statement to an `else` block
    |
153 |                 f"Retrieved {len(result.items)} recent conversations for child {child_id}",
154 |             )
155 |             return result
    |             ^^^^^^^^^^^^^ TRY300
156 |         except Exception as e:
157 |             logger.error(
    |

src/presentation/api/endpoints/conversations_paginated.py:157:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
155 |               return result
156 |           except Exception as e:
157 | /             logger.error(
158 | |                 f"Error getting conversation history for child {child_id}: {e}",
159 | |             )
    | |_____________^ TRY400
160 |               raise HTTPException(
161 |                   status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/conversations_paginated.py:160:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
158 |                   f"Error getting conversation history for child {child_id}: {e}",
159 |               )
160 | /             raise HTTPException(
161 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
162 | |                 detail=f"Failed to get conversation history: {e!s}",
163 | |             )
    | |_____________^ B904
164 |
165 |       async def search_conversations(
    |

src/presentation/api/endpoints/conversations_paginated.py:194:89: E501 Line too long (105 > 88)
    |
193 |             logger.info(
194 |                 f"Found {len(result.items)} conversations matching '{search_term}' for child {child_id}",
    |                                                                                         ^^^^^^^^^^^^^^^^^ E501
195 |             )
196 |             return result
    |

src/presentation/api/endpoints/conversations_paginated.py:196:13: TRY300 Consider moving this statement to an `else` block
    |
194 |                 f"Found {len(result.items)} conversations matching '{search_term}' for child {child_id}",
195 |             )
196 |             return result
    |             ^^^^^^^^^^^^^ TRY300
197 |         except Exception as e:
198 |             logger.error(f"Error searching conversations for child {child_id}: {e}")
    |

src/presentation/api/endpoints/conversations_paginated.py:198:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
196 |             return result
197 |         except Exception as e:
198 |             logger.error(f"Error searching conversations for child {child_id}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
199 |             raise HTTPException(
200 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/conversations_paginated.py:199:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
197 |           except Exception as e:
198 |               logger.error(f"Error searching conversations for child {child_id}: {e}")
199 | /             raise HTTPException(
200 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
201 | |                 detail=f"Failed to search conversations: {e!s}",
202 | |             )
    | |_____________^ B904
203 |
204 |       async def _validate_parent_access(self, parent_id: str, child_id: str) -> bool:
    |

src/presentation/api/endpoints/conversations_paginated.py:220:15: PLR0913 Too many arguments in function definition (7 > 5)
    |
219 |     @router.get("/child/{child_id}")
220 |     async def get_child_conversations_paginated(
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLR0913
221 |         child_id: str,
222 |         page: int = Query(1, ge=1, description="Page number"),
    |

src/presentation/api/endpoints/conversations_paginated.py:252:15: PLR0913 Too many arguments in function definition (6 > 5)
    |
251 |     @router.get("/child/{child_id}/history")
252 |     async def get_conversation_history_paginated(
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLR0913
253 |         child_id: str,
254 |         days_back: int = Query(
    |

src/presentation/api/endpoints/conversations_paginated.py:284:15: PLR0913 Too many arguments in function definition (6 > 5)
    |
283 |     @router.get("/child/{child_id}/search")
284 |     async def search_conversations_paginated(
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLR0913
285 |         child_id: str,
286 |         search_term: str = Query(
    |

src/presentation/api/endpoints/coppa_notices.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """COPPA Legal Notices and Compliance Information Endpoints
2 | | COPPA CONDITIONAL: These endpoints are only active when COPPA compliance is enabled.
3 | | When disabled, they return 404 or empty responses to avoid confusion.
4 | | """
  | |___^ D205
5 |
6 |   from fastapi import APIRouter, Depends, HTTPException, status
  |
  = help: Insert single blank line

src/presentation/api/endpoints/coppa_notices.py:43:5: D205 1 blank line required between summary line and description
   |
41 |   @router.get("/status", response_model=COPPAValidatorStatus)
42 |   async def get_coppa_status():
43 | /     """Get current COPPA compliance status
44 | |     This endpoint always works to inform clients about COPPA status.
45 | |     """
   | |_______^ D205
46 |       coppa_enabled = is_coppa_enabled()
47 |       features_affected = []
   |
   = help: Insert single blank line

src/presentation/api/endpoints/coppa_notices.py:67:5: D205 1 blank line required between summary line and description
   |
65 |   @router.get("/notice", response_model=COPPANoticeResponse)
66 |   async def get_coppa_notice():
67 | /     """Get COPPA compliance notice
68 | |     COPPA CONDITIONAL: Returns different content based on compliance status.
69 | |     """
   | |_______^ D205
70 |       coppa_enabled = is_coppa_enabled()
   |
   = help: Insert single blank line

src/presentation/api/endpoints/coppa_notices.py:75:89: E501 Line too long (91 > 88)
   |
73 |         return COPPANoticeResponse(
74 |             enabled=False,
75 |             notice_text="COPPA compliance is currently disabled for development purposes.",
   |                                                                                         ^^^ E501
76 |             consent_required=False,
77 |         )
   |

src/presentation/api/endpoints/coppa_notices.py:115:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
113 | async def get_child_privacy_settings(
114 |     child_id: str,
115 |     current_user: User = Depends(get_current_user),
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^ B008
116 | ):
117 |     """Get privacy settings for a specific child
    |

src/presentation/api/endpoints/coppa_notices.py:117:5: D205 1 blank line required between summary line and description
    |
115 |       current_user: User = Depends(get_current_user),
116 |   ):
117 | /     """Get privacy settings for a specific child
118 | |     COPPA CONDITIONAL: Returns different settings based on compliance status.
119 | |     """
    | |_______^ D205
120 |       # Verify user is a parent
121 |       if current_user.role != "parent":
    |
    = help: Insert single blank line

src/presentation/api/endpoints/coppa_notices.py:166:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
164 | async def request_coppa_consent(
165 |     child_id: str,
166 |     current_user: User = Depends(get_current_user),
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^ B008
167 | ):
168 |     """Request COPPA consent for a child
    |

src/presentation/api/endpoints/coppa_notices.py:168:5: D205 1 blank line required between summary line and description
    |
166 |       current_user: User = Depends(get_current_user),
167 |   ):
168 | /     """Request COPPA consent for a child
169 | |     COPPA CONDITIONAL: Only functional when COPPA compliance is enabled.
170 | |     """
    | |_______^ D205
171 |       # Verify user is a parent
172 |       if current_user.role != "parent":
    |
    = help: Insert single blank line

src/presentation/api/endpoints/coppa_notices.py:187:5: PLC0415 `import` should be at the top-level of a file
    |
186 |     # COPPA enabled - process consent request
187 |     from ..endpoints.children.compliance import request_parental_consent
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
188 |
189 |     try:
    |

src/presentation/api/endpoints/coppa_notices.py:187:5: TID252 Prefer absolute imports over relative imports from parent modules
    |
186 |     # COPPA enabled - process consent request
187 |     from ..endpoints.children.compliance import request_parental_consent
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
188 |
189 |     try:
    |
    = help: Replace relative imports from parent modules with absolute imports

src/presentation/api/endpoints/coppa_notices.py:200:9: TRY300 Consider moving this statement to an `else` block
    |
198 |           )
199 |
200 | /         return {
201 | |             "child_id": child_id,
202 | |             "consent_id": consent_id,
203 | |             "consent_status": "requested",
204 | |             "message": "Parental consent has been requested",
205 | |             "coppa_enabled": True,
206 | |         }
    | |_________^ TRY300
207 |       except Exception as e:
208 |           logger.error(f"Error requesting COPPA consent: {e}")
    |

src/presentation/api/endpoints/coppa_notices.py:208:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
206 |         }
207 |     except Exception as e:
208 |         logger.error(f"Error requesting COPPA consent: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
209 |         raise HTTPException(
210 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/coppa_notices.py:209:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
207 |       except Exception as e:
208 |           logger.error(f"Error requesting COPPA consent: {e}")
209 | /         raise HTTPException(
210 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
211 | |             detail="Failed to process consent request",
212 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/coppa_notices.py:218:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
216 | async def request_data_deletion(
217 |     child_id: str,
218 |     current_user: User = Depends(get_current_user),
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^ B008
219 | ):
220 |     """Request deletion of child's data
    |

src/presentation/api/endpoints/coppa_notices.py:220:5: D205 1 blank line required between summary line and description
    |
218 |       current_user: User = Depends(get_current_user),
219 |   ):
220 | /     """Request deletion of child's data
221 | |     COPPA CONDITIONAL: Behavior changes based on compliance status.
222 | |     """
    | |_______^ D205
223 |       # Verify user is a parent
224 |       if current_user.role != "parent":
    |
    = help: Insert single blank line

src/presentation/api/endpoints/coppa_notices.py:240:5: PLC0415 `import` should be at the top-level of a file
    |
239 |     # COPPA enabled - process compliant deletion
240 |     from ..endpoints.children.compliance import handle_compliant_child_deletion
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
241 |
242 |     try:
    |

src/presentation/api/endpoints/coppa_notices.py:240:5: TID252 Prefer absolute imports over relative imports from parent modules
    |
239 |     # COPPA enabled - process compliant deletion
240 |     from ..endpoints.children.compliance import handle_compliant_child_deletion
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TID252
241 |
242 |     try:
    |
    = help: Replace relative imports from parent modules with absolute imports

src/presentation/api/endpoints/coppa_notices.py:248:9: TRY300 Consider moving this statement to an `else` block
    |
246 |           )
247 |
248 | /         return {
249 | |             "child_id": child_id,
250 | |             "deletion_result": deletion_result,
251 | |             "deletion_status": "completed",
252 | |             "message": "COPPA-compliant data deletion completed",
253 | |             "coppa_enabled": True,
254 | |         }
    | |_________^ TRY300
255 |       except Exception as e:
256 |           logger.error(f"Error processing data deletion: {e}")
    |

src/presentation/api/endpoints/coppa_notices.py:256:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
254 |         }
255 |     except Exception as e:
256 |         logger.error(f"Error processing data deletion: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
257 |         raise HTTPException(
258 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/coppa_notices.py:257:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
255 |       except Exception as e:
256 |           logger.error(f"Error processing data deletion: {e}")
257 | /         raise HTTPException(
258 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
259 | |             detail="Failed to process data deletion request",
260 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/dashboard.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """📊 Dashboard Analytics Endpoints
2 | | Added comprehensive error boundaries and authentication.
3 | | """
  | |___^ D205
4 |
5 |   import secrets
  |
  = help: Insert single blank line

src/presentation/api/endpoints/dashboard.py:48:52: PLR2004 Magic value used in comparison, consider replacing `4` with a constant variable
   |
46 |         return _log_sanitizer.sanitize_child_id(child_id)
47 |     # Fallback: show only first 4 characters
48 |     return f"{child_id[:4]}***" if len(child_id) > 4 else "***"
   |                                                    ^ PLR2004
   |

src/presentation/api/endpoints/dashboard.py:52:49: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
51 | async def get_authenticated_user(
52 |     credentials: HTTPAuthorizationCredentials = Depends(security),
   |                                                 ^^^^^^^^^^^^^^^^^ B008
53 | ) -> dict[str, Any]:
54 |     """Verify authentication for dashboard access - COPPA compliance required."""
   |

src/presentation/api/endpoints/dashboard.py:56:9: PLC0415 `import` should be at the top-level of a file
   |
54 |       """Verify authentication for dashboard access - COPPA compliance required."""
55 |       try:
56 | /         from src.infrastructure.security.real_auth_service import (
57 | |             create_auth_service,
58 | |         )
   | |_________^ PLC0415
59 |
60 |           auth_service = create_auth_service()
   |

src/presentation/api/endpoints/dashboard.py:66:13: TRY301 Abstract `raise` to an inner function
   |
65 |           if not payload:
66 | /             raise AITeddyErrorHandler.handle_authentication_error(
67 | |                 operation="dashboard_access",
68 | |             )
   | |_____________^ TRY301
69 |
70 |           user_role = payload.get("role", "")
   |

src/presentation/api/endpoints/dashboard.py:72:13: TRY301 Abstract `raise` to an inner function
   |
70 |           user_role = payload.get("role", "")
71 |           if user_role not in ["parent", "guardian", "admin"]:
72 | /             raise AITeddyErrorHandler.handle_authorization_error(
73 | |                 operation="dashboard_access",
74 | |                 user_message="Access denied: Only parents/guardians can access child dashboards",
75 | |             )
   | |_____________^ TRY301
76 |
77 |           return {
   |

src/presentation/api/endpoints/dashboard.py:74:89: E501 Line too long (97 > 88)
   |
72 |             raise AITeddyErrorHandler.handle_authorization_error(
73 |                 operation="dashboard_access",
74 |                 user_message="Access denied: Only parents/guardians can access child dashboards",
   |                                                                                         ^^^^^^^^^ E501
75 |             )
   |

src/presentation/api/endpoints/dashboard.py:86:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
84 |           raise
85 |       except Exception as e:
86 | /         raise AITeddyErrorHandler.handle_authentication_error(
87 | |             error=e,
88 | |             operation="dashboard_authentication",
89 | |         )
   | |_________^ B904
   |

src/presentation/api/endpoints/dashboard.py:96:36: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
94 |     child_id: str,
95 |     period: str = "week",  # week, month, year
96 |     current_user: dict[str, Any] = Depends(get_authenticated_user),
   |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
97 |     database: Database = Depends(container.database),
98 | ) -> dict[str, Any]:
   |

src/presentation/api/endpoints/dashboard.py:97:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
95 |     period: str = "week",  # week, month, year
96 |     current_user: dict[str, Any] = Depends(get_authenticated_user),
97 |     database: Database = Depends(container.database),
   |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
98 | ) -> dict[str, Any]:
99 |     """Get child interaction statistics with COPPA compliance.
   |

src/presentation/api/endpoints/dashboard.py:108:13: TRY301 Abstract `raise` to an inner function
    |
106 |           valid_periods = ["day", "week", "month", "year"]
107 |           if period not in valid_periods:
108 | /             raise AITeddyErrorHandler.handle_validation_error(
109 | |                 ValueError(f"Invalid period: {period}"),
110 | |                 "stats_retrieval",
111 | |                 f"Period must be one of: {', '.join(valid_periods)}",
112 | |             )
    | |_____________^ TRY301
113 |
114 |           logger.info(
    |

src/presentation/api/endpoints/dashboard.py:127:13: TRY301 Abstract `raise` to an inner function
    |
126 |           if not child_stats:
127 | /             raise AITeddyErrorHandler.handle_not_found_error(
128 | |                 "child statistics",
129 | |                 child_id,
130 | |                 "stats_retrieval",
131 | |             )
    | |_____________^ TRY301
132 |
133 |           stats = {
    |

src/presentation/api/endpoints/dashboard.py:127:19: TRY003 Avoid specifying long messages outside the exception class
    |
126 |           if not child_stats:
127 |               raise AITeddyErrorHandler.handle_not_found_error(
    |  ___________________^
128 | |                 "child statistics",
129 | |                 child_id,
130 | |                 "stats_retrieval",
131 | |             )
    | |_____________^ TRY003
132 |
133 |           stats = {
    |

src/presentation/api/endpoints/dashboard.py:149:13: PLC0415 `import` should be at the top-level of a file
    |
148 |           try:
149 | /             from src.presentation.api.models.standard_responses import (
150 | |                 create_child_safety_response,
151 | |             )
    | |_____________^ PLC0415
152 |
153 |               return create_child_safety_response(
    |

src/presentation/api/endpoints/dashboard.py:173:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
171 |           raise
172 |       except Exception as e:
173 | /         raise AITeddyErrorHandler.handle_internal_error(
174 | |             e,
175 | |             "child_stats_retrieval",
176 | |             "Failed to retrieve child statistics. Please try again.",
177 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/dashboard.py:182:36: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
180 | @router.get("/devices/status")
181 | async def get_devices_status(
182 |     current_user: dict[str, Any] = Depends(get_authenticated_user),
    |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
183 |     database: Database = Depends(container.database),
184 | ) -> dict[str, Any]:
    |

src/presentation/api/endpoints/dashboard.py:183:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
181 | async def get_devices_status(
182 |     current_user: dict[str, Any] = Depends(get_authenticated_user),
183 |     database: Database = Depends(container.database),
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
184 | ) -> dict[str, Any]:
185 |     """Get devices status for authorized children only.
    |

src/presentation/api/endpoints/dashboard.py:237:76: PLR2004 Magic value used in comparison, consider replacing `20` with a constant variable
    |
235 |             "maintenance": len([d for d in devices if d["status"] == "maintenance"]),
236 |             "error": len([d for d in devices if d["status"] == "error"]),
237 |             "low_battery": len([d for d in devices if d["battery_level"] < 20]),
    |                                                                            ^^ PLR2004
238 |             "generated_at": datetime.now().isoformat(),
239 |         }
    |

src/presentation/api/endpoints/dashboard.py:242:13: PLC0415 `import` should be at the top-level of a file
    |
241 |           try:
242 | /             from src.presentation.api.models.standard_responses import (
243 | |                 create_success_response,
244 | |             )
    | |_____________^ PLC0415
245 |
246 |               return create_success_response(
    |

src/presentation/api/endpoints/dashboard.py:284:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
282 |           raise
283 |       except Exception as e:
284 | /         raise AITeddyErrorHandler.handle_internal_error(
285 | |             e,
286 | |             "devices_status_retrieval",
287 | |             "Failed to retrieve devices status. Please try again.",
288 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/dashboard.py:292:11: PLR0915 Too many statements (55 > 50)
    |
291 | @router.get("/system/health")
292 | async def get_system_health(
    |           ^^^^^^^^^^^^^^^^^ PLR0915
293 |     current_user: dict[str, Any] = Depends(get_authenticated_user),
294 |     ai_service: AIOrchestrationService = Depends(get_ai_orchestration_service),
    |

src/presentation/api/endpoints/dashboard.py:293:36: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
291 | @router.get("/system/health")
292 | async def get_system_health(
293 |     current_user: dict[str, Any] = Depends(get_authenticated_user),
    |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
294 |     ai_service: AIOrchestrationService = Depends(get_ai_orchestration_service),
295 |     voice_service: AudioProcessingService = Depends(get_audio_processing_service),
    |

src/presentation/api/endpoints/dashboard.py:294:42: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
292 | async def get_system_health(
293 |     current_user: dict[str, Any] = Depends(get_authenticated_user),
294 |     ai_service: AIOrchestrationService = Depends(get_ai_orchestration_service),
    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
295 |     voice_service: AudioProcessingService = Depends(get_audio_processing_service),
296 |     database: Database = Depends(container.database),
    |

src/presentation/api/endpoints/dashboard.py:295:45: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
293 |     current_user: dict[str, Any] = Depends(get_authenticated_user),
294 |     ai_service: AIOrchestrationService = Depends(get_ai_orchestration_service),
295 |     voice_service: AudioProcessingService = Depends(get_audio_processing_service),
    |                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
296 |     database: Database = Depends(container.database),
297 |     redis_cache: RedisCache = Depends(container.redis_cache),
    |

src/presentation/api/endpoints/dashboard.py:296:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
294 |     ai_service: AIOrchestrationService = Depends(get_ai_orchestration_service),
295 |     voice_service: AudioProcessingService = Depends(get_audio_processing_service),
296 |     database: Database = Depends(container.database),
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
297 |     redis_cache: RedisCache = Depends(container.redis_cache),
298 | ) -> dict[str, Any]:
    |

src/presentation/api/endpoints/dashboard.py:297:31: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
295 |     voice_service: AudioProcessingService = Depends(get_audio_processing_service),
296 |     database: Database = Depends(container.database),
297 |     redis_cache: RedisCache = Depends(container.redis_cache),
    |                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
298 | ) -> dict[str, Any]:
299 |     """Get system health metrics for administrators only.
    |

src/presentation/api/endpoints/dashboard.py:305:13: TRY301 Abstract `raise` to an inner function
    |
303 |       try:
304 |           if current_user.get("role") != "admin":
305 | /             raise AITeddyErrorHandler.handle_authorization_error(
306 | |                 operation="system_health_access",
307 | |                 user_message="Access denied: Only administrators can view system health",
308 | |             )
    | |_____________^ TRY301
309 |
310 |           logger.info(
    |

src/presentation/api/endpoints/dashboard.py:307:89: E501 Line too long (89 > 88)
    |
305 |             raise AITeddyErrorHandler.handle_authorization_error(
306 |                 operation="system_health_access",
307 |                 user_message="Access denied: Only administrators can view system health",
    |                                                                                         ^ E501
308 |             )
    |

src/presentation/api/endpoints/dashboard.py:327:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
325 |             services_status["ai_service"] = ai_health
326 |         except Exception as e:
327 |             logger.error(f"AI service health check failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
328 |             services_status["ai_service"] = "unhealthy"
329 |             health_status = "degraded"
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/dashboard.py:340:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
338 |             services_status["voice_service"] = voice_health
339 |         except Exception as e:
340 |             logger.error(f"Voice service health check failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
341 |             services_status["voice_service"] = "unhealthy"
342 |             health_status = "degraded"
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/dashboard.py:353:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
351 |             services_status["database"] = db_health
352 |         except Exception as e:
353 |             logger.error(f"Database health check failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
354 |             services_status["database"] = "unhealthy"
355 |             health_status = "degraded"
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/dashboard.py:371:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
369 |             AttributeError,
370 |         ) as e:
371 |             logger.error(f"Redis health check failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
372 |             services_status["redis"] = "unhealthy"
373 |             health_status = "degraded"
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/dashboard.py:377:13: PLC0415 `import` should be at the top-level of a file
    |
375 |         # Get system metrics
376 |         try:
377 |             import psutil
    |             ^^^^^^^^^^^^^ PLC0415
378 |
379 |             cpu_usage = psutil.cpu_percent(interval=1)
    |

src/presentation/api/endpoints/dashboard.py:389:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
387 |         except Exception as e:
388 |             # If system metrics fail, log error and use mock data
389 |             logger.error(f"Failed to retrieve system metrics: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
390 |             cpu_usage = secrets.randbelow(31) + 20  # 20-50%
391 |             memory_usage = secrets.randbelow(21) + 30  # 30-50%
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/dashboard.py:419:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
417 |           raise
418 |       except Exception as e:
419 | /         raise AITeddyErrorHandler.handle_internal_error(
420 | |             e,
421 | |             "system_health_retrieval",
422 | |             "Failed to retrieve system health. Please try again.",
423 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/dashboard.py:430:36: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
428 |     child_id: str,
429 |     metric_type: str = "learning",
430 |     current_user: dict[str, Any] = Depends(get_authenticated_user),
    |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
431 |     database: Database = Depends(container.database),
432 | ) -> dict[str, Any]:
    |

src/presentation/api/endpoints/dashboard.py:431:26: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
429 |     metric_type: str = "learning",
430 |     current_user: dict[str, Any] = Depends(get_authenticated_user),
431 |     database: Database = Depends(container.database),
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
432 | ) -> dict[str, Any]:
433 |     """Get detailed analytics for a specific child."""
    |

src/presentation/api/endpoints/dashboard.py:461:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
459 |           raise
460 |       except Exception as e:
461 | /         raise AITeddyErrorHandler.handle_internal_error(
462 | |             e,
463 | |             "child_analytics_retrieval",
464 | |             "Failed to retrieve child analytics. Please try again.",
465 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/device.py:25:5: D415 First line should end with a period, question mark, or exclamation point
   |
24 | class DeviceRegistration(BaseModel):
25 |     """Device registration model with comprehensive validation"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
26 |
27 |     device_id: str = Field(
   |
   = help: Add closing punctuation

src/presentation/api/endpoints/device.py:61:5: D415 First line should end with a period, question mark, or exclamation point
   |
60 | class DeviceStatus(BaseModel):
61 |     """Device status model with validation"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
62 |
63 |     device_id: str = Field(
   |
   = help: Add closing punctuation

src/presentation/api/endpoints/device.py:83:5: D415 First line should end with a period, question mark, or exclamation point
   |
81 |     device: DeviceRegistration,
82 | ) -> dict[str, Any]:
83 |     """Register new ESP32 device"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
84 |     try:
85 |         # Generate unique device token
   |
   = help: Add closing punctuation

src/presentation/api/endpoints/device.py:104:9: TRY300 Consider moving this statement to an `else` block
    |
102 |           logger.info(f"Device registered: {device_data}")
103 |
104 | /         return {
105 | |             "status": "success",
106 | |             "device_token": device_token,
107 | |             "message": f"Device {device.device_id} registered successfully",
108 | |             "config": {
109 | |                 "websocket_url": "ws://localhost:8000/ws/device",
110 | |                 "upload_endpoint": "/api/devices/audio/upload",
111 | |                 "heartbeat_interval": 30,
112 | |             },
113 | |         }
    | |_________^ TRY300
114 |       except Exception as e:
115 |           raise HTTPException(
    |

src/presentation/api/endpoints/device.py:115:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
113 |           }
114 |       except Exception as e:
115 | /         raise HTTPException(
116 | |             status_code=status.HTTP_400_BAD_REQUEST,
117 | |             detail=f"Device registration failed: {e!s}",
118 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/device.py:131:5: D415 First line should end with a period, question mark, or exclamation point
    |
129 |     )
130 | ) -> DeviceStatus:
131 |     """Get device status"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^ D415
132 |     try:
133 |         # In a real implementation, this would fetch from database
    |
    = help: Add closing punctuation

src/presentation/api/endpoints/device.py:151:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
149 |         return DeviceStatus(**device_status)
150 |     except Exception as e:
151 |         logger.error(f"Error getting device status for {device_id}: {e!s}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
152 |         raise HTTPException(
153 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/device.py:152:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
150 |       except Exception as e:
151 |           logger.error(f"Error getting device status for {device_id}: {e!s}")
152 | /         raise HTTPException(
153 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
154 | |             detail=f"Failed to get device status: {e!s}",
155 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/device.py:159:5: D415 First line should end with a period, question mark, or exclamation point
    |
158 | class AudioUploadRequest(BaseModel):
159 |     """Audio upload request model with validation"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
160 |
161 |     device_id: str = Field(
    |
    = help: Add closing punctuation

src/presentation/api/endpoints/device.py:191:42: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
189 |     request: AudioUploadRequest,
190 |     audio_data: bytes = Field(..., description="Audio file data"),
191 |     ai_service: AIOrchestrationService = Depends(get_ai_orchestration_service),
    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
192 |     voice_service: AudioProcessingService = Depends(get_audio_processing_service),
193 | ) -> dict[str, Any]:
    |

src/presentation/api/endpoints/device.py:192:45: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
190 |     audio_data: bytes = Field(..., description="Audio file data"),
191 |     ai_service: AIOrchestrationService = Depends(get_ai_orchestration_service),
192 |     voice_service: AudioProcessingService = Depends(get_audio_processing_service),
    |                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
193 | ) -> dict[str, Any]:
194 |     """Handle audio upload from ESP32"""
    |

src/presentation/api/endpoints/device.py:194:5: D415 First line should end with a period, question mark, or exclamation point
    |
192 |     voice_service: AudioProcessingService = Depends(get_audio_processing_service),
193 | ) -> dict[str, Any]:
194 |     """Handle audio upload from ESP32"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
195 |     try:
196 |         if len(audio_data) == 0:
    |
    = help: Add closing punctuation

src/presentation/api/endpoints/device.py:197:13: TRY301 Abstract `raise` to an inner function
    |
195 |       try:
196 |           if len(audio_data) == 0:
197 | /             raise HTTPException(
198 | |                 status_code=status.HTTP_400_BAD_REQUEST,
199 | |                 detail="Audio data cannot be empty",
200 | |             )
    | |_____________^ TRY301
201 |
202 |           max_audio_size = 5 * 1024 * 1024  # 5MB
    |

src/presentation/api/endpoints/device.py:204:13: TRY301 Abstract `raise` to an inner function
    |
202 |           max_audio_size = 5 * 1024 * 1024  # 5MB
203 |           if len(audio_data) > max_audio_size:
204 | /             raise HTTPException(
205 | |                 status_code=status.HTTP_413_REQUEST_ENTITY_TOO_LARGE,
206 | |                 detail="Audio file too large. Maximum size is 5MB for child safety.",
207 | |             )
    | |_____________^ TRY301
208 |
209 |           # Process audio
    |

src/presentation/api/endpoints/device.py:222:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
220 |           }
221 |       except Exception as e:
222 | /         raise HTTPException(
223 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
224 | |             detail=f"Audio processing failed: {e!s}",
225 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/device.py:229:5: D415 First line should end with a period, question mark, or exclamation point
    |
228 | class DeviceConfig(BaseModel):
229 |     """Device configuration response model"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
230 |
231 |     device_id: str
    |
    = help: Add closing punctuation

src/presentation/api/endpoints/device.py:250:5: D205 1 blank line required between summary line and description
    |
248 |       )
249 |   ) -> DeviceConfig:
250 | /     """Get device configuration with child safety parameters.
251 | |     Returns optimized configuration for child interaction including
252 | |     audio settings and safety timeouts.
253 | |     """
    | |_______^ D205
254 |       try:
255 |           if not device_id or len(device_id) < 8:
    |
    = help: Insert single blank line

src/presentation/api/endpoints/device.py:255:46: PLR2004 Magic value used in comparison, consider replacing `8` with a constant variable
    |
253 |     """
254 |     try:
255 |         if not device_id or len(device_id) < 8:
    |                                              ^ PLR2004
256 |             raise HTTPException(
257 |                 status_code=status.HTTP_400_BAD_REQUEST,
    |

src/presentation/api/endpoints/device.py:256:13: TRY301 Abstract `raise` to an inner function
    |
254 |       try:
255 |           if not device_id or len(device_id) < 8:
256 | /             raise HTTPException(
257 | |                 status_code=status.HTTP_400_BAD_REQUEST,
258 | |                 detail="Invalid device identifier",
259 | |             )
    | |_____________^ TRY301
260 |
261 |           config = DeviceConfig(
    |

src/presentation/api/endpoints/device.py:271:9: TRY300 Consider moving this statement to an `else` block
    |
269 |         )
270 |
271 |         return config
    |         ^^^^^^^^^^^^^ TRY300
272 |     except HTTPException:
273 |         raise
    |

src/presentation/api/endpoints/device.py:271:16: RET504 Unnecessary assignment to `config` before `return` statement
    |
269 |         )
270 |
271 |         return config
    |                ^^^^^^ RET504
272 |     except HTTPException:
273 |         raise
    |
    = help: Remove unnecessary assignment

src/presentation/api/endpoints/device.py:275:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
273 |         raise
274 |     except Exception as e:
275 |         logger.error(f"Error getting device config for {device_id}: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
276 |         raise HTTPException(
277 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/device.py:276:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
274 |       except Exception as e:
275 |           logger.error(f"Error getting device config for {device_id}: {e}")
276 | /         raise HTTPException(
277 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
278 | |             detail="Failed to retrieve device configuration",
279 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/health.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Production Health Check Endpoints
2 | | Enterprise-grade health monitoring with dependency checks
3 | | """
  | |___^ D205
4 |
5 |   # Standard library imports
  |
  = help: Insert single blank line

src/presentation/api/endpoints/health.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Production Health Check Endpoints
2 | | Enterprise-grade health monitoring with dependency checks
3 | | """
  | |___^ D415
4 |
5 |   # Standard library imports
  |
  = help: Add closing punctuation

src/presentation/api/endpoints/health.py:22:11: TRY003 Avoid specifying long messages outside the exception class
   |
20 |         "Install required dependencies: pip install fastapi pydantic",
21 |     )
22 |     raise ImportError(f"Missing required dependencies for health endpoints: {e}") from e
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
23 |
24 | # Local imports - optional infrastructure
   |

src/presentation/api/endpoints/health.py:33:5: TRY400 Use `logging.exception` instead of `logging.error`
   |
31 |     INFRASTRUCTURE_AVAILABLE = True
32 | except ImportError as e:
33 |     logging.getLogger(__name__).error(f"Health check infrastructure import error: {e}")
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
34 |     # Continue without optional monitoring features
35 |     INFRASTRUCTURE_AVAILABLE = False
   |
   = help: Replace with `exception`

src/presentation/api/endpoints/health.py:46:5: TRY400 Use `logging.exception` instead of `logging.error`
   |
44 |     HEALTH_CHECKS_AVAILABLE = True
45 | except ImportError as e:
46 |     logging.getLogger(__name__).error(f"Health checks import error: {e}")
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
47 |     HEALTH_CHECKS_AVAILABLE = False
   |
   = help: Replace with `exception`

src/presentation/api/endpoints/health.py:122:11: PLR0912 Too many branches (15 > 12)
    |
121 | @router.get("/", response_model=HealthStatus)
122 | async def basic_health_check() -> HealthStatus:
    |           ^^^^^^^^^^^^^^^^^^ PLR0912
123 |     """Basic health check endpoint.
124 |     Returns overall system health status.
    |

src/presentation/api/endpoints/health.py:123:5: D205 1 blank line required between summary line and description
    |
121 |   @router.get("/", response_model=HealthStatus)
122 |   async def basic_health_check() -> HealthStatus:
123 | /     """Basic health check endpoint.
124 | |     Returns overall system health status.
125 | |     """
    | |_______^ D205
126 |       try:
127 |           # Get settings with fallback
    |
    = help: Insert single blank line

src/presentation/api/endpoints/health.py:199:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
197 |         )
198 |     except Exception as e:
199 |         logger.error(f"Health check error: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
200 |         raise HTTPException(
201 |             status_code=status.HTTP_503_SERVICE_UNAVAILABLE,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/health.py:200:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
198 |       except Exception as e:
199 |           logger.error(f"Health check error: {e}")
200 | /         raise HTTPException(
201 | |             status_code=status.HTTP_503_SERVICE_UNAVAILABLE,
202 | |             detail=f"Health check failed: {e!s}",
203 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/health.py:208:5: D205 1 blank line required between summary line and description
    |
206 |   @router.get("/ready")
207 |   async def readiness_check() -> dict[str, Any]:
208 | /     """Kubernetes readiness probe endpoint.
209 | |     Checks if the application is ready to serve traffic.
210 | |     """
    | |_______^ D205
211 |       try:
212 |           # Check critical dependencies only
    |
    = help: Insert single blank line

src/presentation/api/endpoints/health.py:239:9: TRY301 Abstract `raise` to an inner function
    |
237 |                   },
238 |               }
239 | /         raise HTTPException(
240 | |             status_code=status.HTTP_503_SERVICE_UNAVAILABLE,
241 | |             detail="Service not ready",
242 | |         )
    | |_________^ TRY301
243 |       except HTTPException:
244 |           raise
    |

src/presentation/api/endpoints/health.py:246:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
244 |         raise
245 |     except Exception as e:
246 |         logger.error(f"Readiness check error: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
247 |         raise HTTPException(
248 |             status_code=status.HTTP_503_SERVICE_UNAVAILABLE,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/health.py:247:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
245 |       except Exception as e:
246 |           logger.error(f"Readiness check error: {e}")
247 | /         raise HTTPException(
248 | |             status_code=status.HTTP_503_SERVICE_UNAVAILABLE,
249 | |             detail=f"Readiness check failed: {e!s}",
250 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/health.py:255:5: D205 1 blank line required between summary line and description
    |
253 |   @router.get("/live")
254 |   async def liveness_check() -> dict[str, Any]:
255 | /     """Kubernetes liveness probe endpoint.
256 | |     Simple check to verify the application is alive.
257 | |     """
    | |_______^ D205
258 |       try:
259 |           pid = os.getpid()
    |
    = help: Insert single blank line

src/presentation/api/endpoints/health.py:311:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
309 |         }
310 |     except Exception as e:
311 |         logger.error(f"Metrics endpoint error: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
312 |         raise HTTPException(
313 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/health.py:312:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
310 |       except Exception as e:
311 |           logger.error(f"Metrics endpoint error: {e}")
312 | /         raise HTTPException(
313 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
314 | |             detail=f"Metrics collection failed: {e!s}",
315 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/health.py:346:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
344 |         }
345 |     except Exception as e:
346 |         logger.error(f"Dependencies check error: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
347 |         raise HTTPException(
348 |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/health.py:347:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
345 |       except Exception as e:
346 |           logger.error(f"Dependencies check error: {e}")
347 | /         raise HTTPException(
348 | |             status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
349 | |             detail=f"Dependencies check failed: {e!s}",
350 | |         )
    | |_________^ B904
    |

src/presentation/api/endpoints/health.py:369:89: E501 Line too long (117 > 88)
    |
367 |             "version": version,
368 |             "timestamp": datetime.now().isoformat(),
369 |             "python_version": f"{os.sys.version_info.major}.{os.sys.version_info.minor}.{os.sys.version_info.micro}",
    |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E501
370 |             "platform": os.name,
371 |             "pid": os.getpid(),
    |

src/presentation/api/endpoints/health.py:379:9: TRY400 Use `logging.exception` instead of `logging.error`
    |
377 |         }
378 |     except Exception as e:
379 |         logger.error(f"System info error: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
380 |         return {
381 |             "error": f"System info collection failed: {e}",
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/monitoring_dashboard.py:28:23: ARG002 Unused method argument: `path`
   |
26 |             pass
27 |
28 |         def get(self, path: str, **kwargs):
   |                       ^^^^ ARG002
29 |             def decorator(func):
30 |                 return func
   |

src/presentation/api/endpoints/monitoring_dashboard.py:28:36: ARG002 Unused method argument: `kwargs`
   |
26 |             pass
27 |
28 |         def get(self, path: str, **kwargs):
   |                                    ^^^^^^ ARG002
29 |             def decorator(func):
30 |                 return func
   |

src/presentation/api/endpoints/monitoring_dashboard.py:64:63: PLR2004 Magic value used in comparison, consider replacing `0.8` with a constant variable
   |
62 |                 "child_safety": safety_summary,
63 |                 "system_status": (
64 |                     "operational" if health_status["score"] > 0.8 else "degraded"
   |                                                               ^^^ PLR2004
65 |                 ),
66 |             }
   |

src/presentation/api/endpoints/monitoring_dashboard.py:68:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
66 |             }
67 |         except Exception as e:
68 |             logger.error(f"Error getting system health: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
69 |             raise HTTPException(
70 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
   |
   = help: Replace with `exception`

src/presentation/api/endpoints/monitoring_dashboard.py:69:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
67 |           except Exception as e:
68 |               logger.error(f"Error getting system health: {e}")
69 | /             raise HTTPException(
70 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
71 | |                 detail=f"Failed to get system health: {e!s}",
72 | |             )
   | |_____________^ B904
73 |
74 |       async def get_metrics_dashboard(self, time_range: str = "1h") -> dict[str, Any]:
   |

src/presentation/api/endpoints/monitoring_dashboard.py:106:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
104 |             }
105 |         except Exception as e:
106 |             logger.error(f"Error getting metrics dashboard: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
107 |             raise HTTPException(
108 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/monitoring_dashboard.py:107:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
105 |           except Exception as e:
106 |               logger.error(f"Error getting metrics dashboard: {e}")
107 | /             raise HTTPException(
108 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
109 | |                 detail=f"Failed to get metrics dashboard: {e!s}",
110 | |             )
    | |_____________^ B904
111 |
112 |       async def get_child_safety_dashboard(self) -> dict[str, Any]:
    |

src/presentation/api/endpoints/monitoring_dashboard.py:146:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
144 |             }
145 |         except Exception as e:
146 |             logger.error(f"Error getting child safety dashboard: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
147 |             raise HTTPException(
148 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/monitoring_dashboard.py:147:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
145 |           except Exception as e:
146 |               logger.error(f"Error getting child safety dashboard: {e}")
147 | /             raise HTTPException(
148 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
149 | |                 detail=f"Failed to get child safety dashboard: {e!s}",
150 | |             )
    | |_____________^ B904
151 |
152 |       async def get_security_dashboard(self) -> dict[str, Any]:
    |

src/presentation/api/endpoints/monitoring_dashboard.py:180:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
178 |             }
179 |         except Exception as e:
180 |             logger.error(f"Error getting security dashboard: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
181 |             raise HTTPException(
182 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/monitoring_dashboard.py:181:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
179 |           except Exception as e:
180 |               logger.error(f"Error getting security dashboard: {e}")
181 | /             raise HTTPException(
182 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
183 | |                 detail=f"Failed to get security dashboard: {e!s}",
184 | |             )
    | |_____________^ B904
185 |
186 |       async def get_coppa_compliance_dashboard(self) -> dict[str, Any]:
    |

src/presentation/api/endpoints/monitoring_dashboard.py:210:55: PLR2004 Magic value used in comparison, consider replacing `0.9` with a constant variable
    |
208 |                 "compliance_score": compliance_score,
209 |                 "compliance_status": (
210 |                     "compliant" if compliance_score > 0.9 else "needs_attention"
    |                                                       ^^^ PLR2004
211 |                 ),
212 |                 "last_updated": datetime.utcnow().isoformat(),
    |

src/presentation/api/endpoints/monitoring_dashboard.py:215:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
213 |             }
214 |         except Exception as e:
215 |             logger.error(f"Error getting COPPA compliance dashboard: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
216 |             raise HTTPException(
217 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/monitoring_dashboard.py:216:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
214 |           except Exception as e:
215 |               logger.error(f"Error getting COPPA compliance dashboard: {e}")
216 | /             raise HTTPException(
217 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
218 | |                 detail=f"Failed to get COPPA compliance dashboard: {e!s}",
219 | |             )
    | |_____________^ B904
220 |
221 |       def _calculate_health_status(
    |

src/presentation/api/endpoints/monitoring_dashboard.py:231:25: PLR2004 Magic value used in comparison, consider replacing `0.05` with a constant variable
    |
229 |         latest_metrics = metrics_summary.get("latest_metrics", {})
230 |         error_rate = latest_metrics.get("error_rate", 0)
231 |         if error_rate > 0.05:  # 5% threshold
    |                         ^^^^ PLR2004
232 |             health_score -= 0.2
233 |             issues.append(f"High error rate: {error_rate:.2%}")
    |

src/presentation/api/endpoints/monitoring_dashboard.py:237:32: PLR2004 Magic value used in comparison, consider replacing `2.0` with a constant variable
    |
235 |         # Check response time
236 |         avg_response_time = latest_metrics.get("avg_response_time", 0)
237 |         if avg_response_time > 2.0:  # 2 second threshold
    |                                ^^^ PLR2004
238 |             health_score -= 0.1
239 |             issues.append(f"Slow response time: {avg_response_time:.2f}s")
    |

src/presentation/api/endpoints/monitoring_dashboard.py:243:27: PLR2004 Magic value used in comparison, consider replacing `0.8` with a constant variable
    |
241 |         # Check memory usage
242 |         memory_usage = latest_metrics.get("memory_usage", 0)
243 |         if memory_usage > 0.8:  # 80% threshold
    |                           ^^^ PLR2004
244 |             health_score -= 0.15
245 |             issues.append(f"High memory usage: {memory_usage:.1%}")
    |

src/presentation/api/endpoints/monitoring_dashboard.py:263:21: PLR2004 Magic value used in comparison, consider replacing `0.9` with a constant variable
    |
261 |     def _get_health_status_text(self, score: float) -> str:
262 |         """Convert health score to text status."""
263 |         if score >= 0.9:
    |                     ^^^ PLR2004
264 |             return "excellent"
265 |         if score >= 0.8:
    |

src/presentation/api/endpoints/monitoring_dashboard.py:265:21: PLR2004 Magic value used in comparison, consider replacing `0.8` with a constant variable
    |
263 |         if score >= 0.9:
264 |             return "excellent"
265 |         if score >= 0.8:
    |                     ^^^ PLR2004
266 |             return "good"
267 |         if score >= 0.6:
    |

src/presentation/api/endpoints/monitoring_dashboard.py:267:21: PLR2004 Magic value used in comparison, consider replacing `0.6` with a constant variable
    |
265 |         if score >= 0.8:
266 |             return "good"
267 |         if score >= 0.6:
    |                     ^^^ PLR2004
268 |             return "fair"
269 |         if score >= 0.4:
    |

src/presentation/api/endpoints/monitoring_dashboard.py:269:21: PLR2004 Magic value used in comparison, consider replacing `0.4` with a constant variable
    |
267 |         if score >= 0.6:
268 |             return "fair"
269 |         if score >= 0.4:
    |                     ^^^ PLR2004
270 |             return "poor"
271 |         return "critical"
    |

src/presentation/api/endpoints/monitoring_dashboard.py:284:17: PERF401 Use a list comprehension to create a transformed list
    |
282 |                   and alert.status == AlertStatus.ACTIVE
283 |               ):
284 | /                 recent_alerts.append(
285 | |                     {
286 | |                         "alert_id": alert.alert_id,
287 | |                         "name": alert.name,
288 | |                         "description": alert.description,
289 | |                         "severity": alert.severity.value,
290 | |                         "last_triggered": alert.last_triggered.isoformat(),
291 | |                         "trigger_count": alert.trigger_count,
292 | |                     }
293 | |                 )
    | |_________________^ PERF401
294 |
295 |           return sorted(recent_alerts, key=lambda x: x["last_triggered"], reverse=True)
    |
    = help: Replace for loop with list comprehension

src/presentation/api/endpoints/monitoring_dashboard.py:335:36: PLR2004 Magic value used in comparison, consider replacing `50` with a constant variable
    |
333 |         total_failed_auth = sum(failed_auth.values())
334 |
335 |         if total_security_events > 50 or total_failed_auth > 100:
    |                                    ^^ PLR2004
336 |             return "high"
337 |         if total_security_events > 20 or total_failed_auth > 50:
    |

src/presentation/api/endpoints/monitoring_dashboard.py:335:62: PLR2004 Magic value used in comparison, consider replacing `100` with a constant variable
    |
333 |         total_failed_auth = sum(failed_auth.values())
334 |
335 |         if total_security_events > 50 or total_failed_auth > 100:
    |                                                              ^^^ PLR2004
336 |             return "high"
337 |         if total_security_events > 20 or total_failed_auth > 50:
    |

src/presentation/api/endpoints/monitoring_dashboard.py:337:36: PLR2004 Magic value used in comparison, consider replacing `20` with a constant variable
    |
335 |         if total_security_events > 50 or total_failed_auth > 100:
336 |             return "high"
337 |         if total_security_events > 20 or total_failed_auth > 50:
    |                                    ^^ PLR2004
338 |             return "medium"
339 |         if total_security_events > 5 or total_failed_auth > 10:
    |

src/presentation/api/endpoints/monitoring_dashboard.py:337:62: PLR2004 Magic value used in comparison, consider replacing `50` with a constant variable
    |
335 |         if total_security_events > 50 or total_failed_auth > 100:
336 |             return "high"
337 |         if total_security_events > 20 or total_failed_auth > 50:
    |                                                              ^^ PLR2004
338 |             return "medium"
339 |         if total_security_events > 5 or total_failed_auth > 10:
    |

src/presentation/api/endpoints/monitoring_dashboard.py:339:36: PLR2004 Magic value used in comparison, consider replacing `5` with a constant variable
    |
337 |         if total_security_events > 20 or total_failed_auth > 50:
338 |             return "medium"
339 |         if total_security_events > 5 or total_failed_auth > 10:
    |                                    ^ PLR2004
340 |             return "low"
341 |         return "minimal"
    |

src/presentation/api/endpoints/monitoring_dashboard.py:339:61: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
    |
337 |         if total_security_events > 20 or total_failed_auth > 50:
338 |             return "medium"
339 |         if total_security_events > 5 or total_failed_auth > 10:
    |                                                             ^^ PLR2004
340 |             return "low"
341 |         return "minimal"
    |

src/presentation/api/endpoints/monitoring_dashboard.py:411:17: SIM102 Use a single `if` statement instead of nested `if` statements
    |
409 |               active_alerts = []
410 |               for alert in monitoring_service.alerts.values():
411 | /                 if alert.status == AlertStatus.ACTIVE:
412 | |                     if severity is None or alert.severity.value == severity:
    | |____________________________________________________________________________^ SIM102
413 |                           active_alerts.append(
414 |                               {
    |
    = help: Combine `if` statements using `and`

src/presentation/api/endpoints/monitoring_dashboard.py:439:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
437 |             }
438 |         except Exception as e:
439 |             logger.error(f"Error getting active alerts: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
440 |             raise HTTPException(
441 |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
    |
    = help: Replace with `exception`

src/presentation/api/endpoints/monitoring_dashboard.py:440:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
438 |           except Exception as e:
439 |               logger.error(f"Error getting active alerts: {e}")
440 | /             raise HTTPException(
441 | |                 status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
442 | |                 detail=f"Failed to get active alerts: {e!s}",
443 | |             )
    | |_____________^ B904
    |

src/presentation/api/esp32_endpoints.py:27:49: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
26 | async def get_current_user_esp32(
27 |     credentials: HTTPAuthorizationCredentials = Depends(security),
   |                                                 ^^^^^^^^^^^^^^^^^ B008
28 | ) -> dict[str, Any]:
29 |     """Verify user authentication for ESP32 endpoints"""
   |

src/presentation/api/esp32_endpoints.py:29:5: D415 First line should end with a period, question mark, or exclamation point
   |
27 |     credentials: HTTPAuthorizationCredentials = Depends(security),
28 | ) -> dict[str, Any]:
29 |     """Verify user authentication for ESP32 endpoints"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
30 |     try:
31 |         from src.infrastructure.security.real_auth_service import (
   |
   = help: Add closing punctuation

src/presentation/api/esp32_endpoints.py:31:9: PLC0415 `import` should be at the top-level of a file
   |
29 |       """Verify user authentication for ESP32 endpoints"""
30 |       try:
31 | /         from src.infrastructure.security.real_auth_service import (
32 | |             create_auth_service,
33 | |         )
   | |_________^ PLC0415
34 |
35 |           auth_service = create_auth_service()
   |

src/presentation/api/esp32_endpoints.py:40:13: TRY301 Abstract `raise` to an inner function
   |
39 |           if not payload:
40 | /             raise HTTPException(
41 | |                 status_code=401,
42 | |                 detail="Invalid authentication token",
43 | |                 headers={"WWW-Authenticate": "Bearer"},
44 | |             )
   | |_____________^ TRY301
45 |
46 |           return {
   |

src/presentation/api/esp32_endpoints.py:52:9: TRY400 Use `logging.exception` instead of `logging.error`
   |
50 |         }
51 |     except Exception as e:
52 |         logger.error(f"Authentication failed: {e}")
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
53 |         raise HTTPException(
54 |             status_code=401,
   |
   = help: Replace with `exception`

src/presentation/api/esp32_endpoints.py:53:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   |
51 |       except Exception as e:
52 |           logger.error(f"Authentication failed: {e}")
53 | /         raise HTTPException(
54 | |             status_code=401,
55 | |             detail="Authentication required",
56 | |             headers={"WWW-Authenticate": "Bearer"},
57 | |         )
   | |_________^ B904
   |

src/presentation/api/esp32_endpoints.py:91:36: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
89 | async def process_audio(
90 |     request: AudioRequest,
91 |     current_user: dict[str, Any] = Depends(get_current_user_esp32),
   |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
92 |     ai_orchestration_service: AIOrchestrationService = Depends(
93 |         Provide[Container.ai_orchestration_service]
   |

src/presentation/api/esp32_endpoints.py:92:56: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
90 |       request: AudioRequest,
91 |       current_user: dict[str, Any] = Depends(get_current_user_esp32),
92 |       ai_orchestration_service: AIOrchestrationService = Depends(
   |  ________________________________________________________^
93 | |         Provide[Container.ai_orchestration_service]
94 | |     ),
   | |_____^ B008
95 |       database_service: DatabaseService = Depends(Provide[Container.database_service]),
96 |   ):
   |

src/presentation/api/esp32_endpoints.py:95:41: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   |
93 |         Provide[Container.ai_orchestration_service]
94 |     ),
95 |     database_service: DatabaseService = Depends(Provide[Container.database_service]),
   |                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
96 | ):
97 |     """Process audio from ESP32 device"""
   |

src/presentation/api/esp32_endpoints.py:97:5: D415 First line should end with a period, question mark, or exclamation point
   |
95 |     database_service: DatabaseService = Depends(Provide[Container.database_service]),
96 | ):
97 |     """Process audio from ESP32 device"""
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
98 |     try:
99 |         # Verify parental consent before processing child data
   |
   = help: Add closing punctuation

src/presentation/api/esp32_endpoints.py:100:9: PLC0415 `import` should be at the top-level of a file
    |
 98 |     try:
 99 |         # Verify parental consent before processing child data
100 |         from src.infrastructure.security.coppa import get_consent_manager
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLC0415
101 |
102 |         consent_manager = get_consent_manager()
    |

src/presentation/api/esp32_endpoints.py:113:17: TRY301 Abstract `raise` to an inner function
    |
111 |               )
112 |               if not has_consent:
113 | /                 raise HTTPException(
114 | |                     status_code=403,
115 | |                     detail=f"Parental consent required for {consent_type}",
116 | |                 )
    | |_________________^ TRY301
117 |
118 |           # Get child profile
    |

src/presentation/api/esp32_endpoints.py:121:13: TRY301 Abstract `raise` to an inner function
    |
119 |         child = await database_service.get_child(request.child_id)
120 |         if not child:
121 |             raise HTTPException(status_code=404, detail="Child not found")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
122 |
123 |         # Simulate audio transcription (in real implementation, this would use Whisper)
    |

src/presentation/api/esp32_endpoints.py:161:89: E501 Line too long (89 > 88)
    |
159 |         return AudioResponse(
160 |             response_text=ai_response.response_text,
161 |             audio_response="base64_encoded_audio_response",  # Would be actual TTS output
    |                                                                                         ^ E501
162 |             emotion=ai_response.emotion,
163 |             safe=ai_response.safe,
    |

src/presentation/api/esp32_endpoints.py:168:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
166 |         )
167 |     except Exception as e:
168 |         raise HTTPException(status_code=500, detail=f"Error processing audio: {e!s}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
    |

src/presentation/api/esp32_endpoints.py:175:5: ARG001 Unused function argument: `current_user`
    |
173 | async def update_device_status(
174 |     request: DeviceStatusRequest,
175 |     current_user: dict[str, Any] = Depends(get_current_user_esp32),
    |     ^^^^^^^^^^^^ ARG001
176 | ):
177 |     """Update ESP32 device status"""
    |

src/presentation/api/esp32_endpoints.py:175:36: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
173 | async def update_device_status(
174 |     request: DeviceStatusRequest,
175 |     current_user: dict[str, Any] = Depends(get_current_user_esp32),
    |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
176 | ):
177 |     """Update ESP32 device status"""
    |

src/presentation/api/esp32_endpoints.py:177:5: D415 First line should end with a period, question mark, or exclamation point
    |
175 |     current_user: dict[str, Any] = Depends(get_current_user_esp32),
176 | ):
177 |     """Update ESP32 device status"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
178 |     # In a real implementation, this would update device status in database
179 |     return {
    |
    = help: Add closing punctuation

src/presentation/api/esp32_endpoints.py:191:5: D415 First line should end with a period, question mark, or exclamation point
    |
189 | @router.get("/health")
190 | async def health_check():
191 |     """Check ESP32 service health"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
192 |     return {
193 |         "status": "healthy",
    |
    = help: Add closing punctuation

src/presentation/api/esp32_endpoints.py:204:5: ARG001 Unused function argument: `current_user`
    |
202 | async def get_device_config(
203 |     device_id: str,
204 |     current_user: dict[str, Any] = Depends(get_current_user_esp32),
    |     ^^^^^^^^^^^^ ARG001
205 | ):
206 |     """Get device configuration"""
    |

src/presentation/api/esp32_endpoints.py:204:36: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
202 | async def get_device_config(
203 |     device_id: str,
204 |     current_user: dict[str, Any] = Depends(get_current_user_esp32),
    |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
205 | ):
206 |     """Get device configuration"""
    |

src/presentation/api/esp32_endpoints.py:206:5: D415 First line should end with a period, question mark, or exclamation point
    |
204 |     current_user: dict[str, Any] = Depends(get_current_user_esp32),
205 | ):
206 |     """Get device configuration"""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
207 |     return {
208 |         "device_id": device_id,
    |
    = help: Add closing punctuation

src/presentation/api/health_endpoints.py:1:1: I001 [*] Import block is un-sorted or un-formatted
   |
 1 | / from src.presentation.api.emergency_response.models import HealthResponse
 2 | | from datetime import datetime
 3 | | from typing import Any
 4 | |
 5 | | from fastapi import APIRouter, status
 6 | | from fastapi.responses import JSONResponse, PlainTextResponse
 7 | | from pydantic import BaseModel
 8 | |
 9 | | from src.infrastructure.health.health_checks import (
10 | |     HealthStatus,
11 | |     get_health_manager,
12 | | )
13 | | from src.infrastructure.logging_config import get_logger
   | |________________________________________________________^ I001
14 |
15 |   logger = get_logger(__name__, component="api")
   |
   = help: Organize imports

src/presentation/api/health_endpoints.py:1:60: F401 [*] `src.presentation.api.emergency_response.models.HealthResponse` imported but unused
  |
1 | from src.presentation.api.emergency_response.models import HealthResponse
  |                                                            ^^^^^^^^^^^^^^ F401
2 | from datetime import datetime
3 | from typing import Any
  |
  = help: Remove unused import: `src.presentation.api.emergency_response.models.HealthResponse`

src/presentation/api/health_endpoints.py:2:22: F401 [*] `datetime.datetime` imported but unused
  |
1 | from src.presentation.api.emergency_response.models import HealthResponse
2 | from datetime import datetime
  |                      ^^^^^^^^ F401
3 | from typing import Any
  |
  = help: Remove unused import: `datetime.datetime`

src/presentation/api/health_endpoints.py:3:20: F401 [*] `typing.Any` imported but unused
  |
1 | from src.presentation.api.emergency_response.models import HealthResponse
2 | from datetime import datetime
3 | from typing import Any
  |                    ^^^ F401
4 |
5 | from fastapi import APIRouter, status
  |
  = help: Remove unused import: `typing.Any`

src/presentation/api/health_endpoints.py:5:32: F401 [*] `fastapi.status` imported but unused
  |
3 | from typing import Any
4 |
5 | from fastapi import APIRouter, status
  |                                ^^^^^^ F401
6 | from fastapi.responses import JSONResponse, PlainTextResponse
7 | from pydantic import BaseModel
  |
  = help: Remove unused import: `fastapi.status`

src/presentation/api/health_endpoints.py:6:31: F401 [*] `fastapi.responses.JSONResponse` imported but unused
  |
5 | from fastapi import APIRouter, status
6 | from fastapi.responses import JSONResponse, PlainTextResponse
  |                               ^^^^^^^^^^^^ F401
7 | from pydantic import BaseModel
  |
  = help: Remove unused import

src/presentation/api/health_endpoints.py:6:45: F401 [*] `fastapi.responses.PlainTextResponse` imported but unused
  |
5 | from fastapi import APIRouter, status
6 | from fastapi.responses import JSONResponse, PlainTextResponse
  |                                             ^^^^^^^^^^^^^^^^^ F401
7 | from pydantic import BaseModel
  |
  = help: Remove unused import

src/presentation/api/health_endpoints.py:7:22: F401 [*] `pydantic.BaseModel` imported but unused
  |
5 | from fastapi import APIRouter, status
6 | from fastapi.responses import JSONResponse, PlainTextResponse
7 | from pydantic import BaseModel
  |                      ^^^^^^^^^ F401
8 |
9 | from src.infrastructure.health.health_checks import (
  |
  = help: Remove unused import: `pydantic.BaseModel`

src/presentation/api/health_endpoints.py:10:5: F401 [*] `src.infrastructure.health.health_checks.HealthStatus` imported but unused
   |
 9 | from src.infrastructure.health.health_checks import (
10 |     HealthStatus,
   |     ^^^^^^^^^^^^ F401
11 |     get_health_manager,
12 | )
   |
   = help: Remove unused import

src/presentation/api/health_endpoints.py:11:5: F401 [*] `src.infrastructure.health.health_checks.get_health_manager` imported but unused
   |
 9 | from src.infrastructure.health.health_checks import (
10 |     HealthStatus,
11 |     get_health_manager,
   |     ^^^^^^^^^^^^^^^^^^ F401
12 | )
13 | from src.infrastructure.logging_config import get_logger
   |
   = help: Remove unused import

src/presentation/api/main_router.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """Main router for all endpoints"""
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | try:
  |
  = help: Add closing punctuation

src/presentation/api/main_router.py:8:11: TRY003 Avoid specifying long messages outside the exception class
   |
 6 |       FASTAPI_AVAILABLE = True
 7 |   except ImportError as e:
 8 |       raise ImportError(
   |  ___________^
 9 | |         "FastAPI is required for production API deployment. "
10 | |         "Install with: pip install fastapi uvicorn",
11 | |     ) from e
   | |_____^ TRY003
12 |
13 |   from src.infrastructure.logging_config import get_logger
   |

src/presentation/api/middleware/__init__.py:1:1: I001 [*] Import block is un-sorted or un-formatted
  |
1 | / from .error_handling import ErrorHandlingMiddleware
2 | | from .request_logging import RequestLoggingMiddleware
3 | | from .rate_limit_middleware import RateLimitMiddleware as ChildSafetyMiddleware
  | |_______________________________________________________________________________^ I001
4 |   # RateLimitingMiddleware same as RateLimitMiddleware
  |
  = help: Organize imports

src/presentation/api/middleware/__init__.py:8:31: W291 [*] Trailing whitespace
   |
 6 | __all__ = [
 7 |     "ChildSafetyMiddleware",
 8 |     "ErrorHandlingMiddleware", 
   |                               ^ W291
 9 |     "RateLimitingMiddleware",
10 |     "RequestLoggingMiddleware"
   |
   = help: Remove trailing whitespace

src/presentation/api/middleware/child_safe_rate_limiter.py:34:58: PLR2004 Magic value used in comparison, consider replacing `20` with a constant variable
   |
32 |         if self._is_child_endpoint(endpoint):
33 |             # More restrictive for child endpoints
34 |             return len(self.request_counts[client_ip]) > 20  # 20 requests per minute
   |                                                          ^^ PLR2004
35 |         # Standard rate limit
36 |         return len(self.request_counts[client_ip]) > 60  # 60 requests per minute
   |

src/presentation/api/middleware/child_safe_rate_limiter.py:36:54: PLR2004 Magic value used in comparison, consider replacing `60` with a constant variable
   |
34 |             return len(self.request_counts[client_ip]) > 20  # 20 requests per minute
35 |         # Standard rate limit
36 |         return len(self.request_counts[client_ip]) > 60  # 60 requests per minute
   |                                                      ^^ PLR2004
37 |
38 |     def create_rate_limit_response(self, request: Request) -> Response:
   |

src/presentation/api/middleware/consent_verification.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """COPPA Consent Verification Middleware
2 | | Ensures parental consent is verified at all child data collection points
3 | | """
  | |___^ D205
4 |
5 |   import json
  |
  = help: Insert single blank line

src/presentation/api/middleware/consent_verification.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """COPPA Consent Verification Middleware
2 | | Ensures parental consent is verified at all child data collection points
3 | | """
  | |___^ D415
4 |
5 |   import json
  |
  = help: Add closing punctuation

src/presentation/api/middleware/consent_verification.py:19:5: D205 1 blank line required between summary line and description
   |
18 |   class ConsentVerificationRoute(APIRoute):
19 | /     """Custom route class that verifies parental consent before processing requests
20 | |     that involve child data collection or interaction.
21 | |     """
   | |_______^ D205
22 |
23 |       def __init__(
   |
   = help: Insert single blank line

src/presentation/api/middleware/consent_verification.py:82:13: TRY300 Consider moving this statement to an `else` block
   |
80 |                         pass
81 |
82 |             return None
   |             ^^^^^^^^^^^ TRY300
83 |         except Exception as e:
84 |             logger.error(f"Failed to extract child_id from request: {e}")
   |

src/presentation/api/middleware/consent_verification.py:84:13: TRY400 Use `logging.exception` instead of `logging.error`
   |
82 |             return None
83 |         except Exception as e:
84 |             logger.error(f"Failed to extract child_id from request: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
85 |             return None
   |
   = help: Replace with `exception`

src/presentation/api/middleware/consent_verification.py:95:17: TRY301 Abstract `raise` to an inner function
    |
 93 |               user = getattr(request.state, "user", None)
 94 |               if not user:
 95 | /                 raise HTTPException(
 96 | |                     status_code=401,
 97 | |                     detail="Authentication required for child data access",
 98 | |                 )
    | |_________________^ TRY301
 99 |
100 |               parent_id = user.get("user_id")
    |

src/presentation/api/middleware/consent_verification.py:102:17: TRY301 Abstract `raise` to an inner function
    |
100 |               parent_id = user.get("user_id")
101 |               if not parent_id:
102 | /                 raise HTTPException(
103 | |                     status_code=403,
104 | |                     detail="Parent identification required",
105 | |                 )
    | |_________________^ TRY301
106 |
107 |               # Check consent for each required type
    |

src/presentation/api/middleware/consent_verification.py:120:21: TRY301 Abstract `raise` to an inner function
    |
118 |                           f"child={child_id}, type={consent_type}",
119 |                       )
120 | /                     raise HTTPException(
121 | |                         status_code=403,
122 | |                         detail=f"Parental consent required for {consent_type}. "
123 | |                         "Please provide consent in the parental dashboard.",
124 | |                     )
    | |_____________________^ TRY301
125 |
126 |               logger.info(
    |

src/presentation/api/middleware/consent_verification.py:133:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
131 |             raise
132 |         except Exception as e:
133 |             logger.error(f"Consent verification error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
134 |             raise HTTPException(
135 |                 status_code=500,
    |
    = help: Replace with `exception`

src/presentation/api/middleware/consent_verification.py:134:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
132 |           except Exception as e:
133 |               logger.error(f"Consent verification error: {e}")
134 | /             raise HTTPException(
135 | |                 status_code=500,
136 | |                 detail="Failed to verify parental consent",
137 | |             )
    | |_____________^ B904
138 |
139 |       async def _log_data_collection(self, request: Request, child_id: str) -> None:
    |

src/presentation/api/middleware/consent_verification.py:142:13: PLC0415 `import` should be at the top-level of a file
    |
140 |           """Log the data collection event for audit trail."""
141 |           try:
142 | /             from src.infrastructure.security.coppa.data_models import (
143 | |                 AuditLogEntry,
144 | |             )
    | |_____________^ PLC0415
145 |
146 |               # Create audit log entry
    |

src/presentation/api/middleware/consent_verification.py:149:89: E501 Line too long (95 > 88)
    |
147 |             audit_entry = AuditLogEntry(
148 |                 event_type="data_collection",
149 |                 event_description=f"Child data access via {request.method} {request.url.path}",
    |                                                                                         ^^^^^^^ E501
150 |                 actor_type="api_endpoint",
151 |                 actor_id=f"{request.method}:{request.url.path}",
    |

src/presentation/api/middleware/consent_verification.py:168:89: E501 Line too long (89 > 88)
    |
166 |             # In production, this would save to audit database
167 |             logger.info(
168 |                 f"Data collection logged: {audit_entry.event_type} for child {child_id}",
    |                                                                                         ^ E501
169 |             )
170 |         except Exception as e:
    |

src/presentation/api/middleware/consent_verification.py:171:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
169 |             )
170 |         except Exception as e:
171 |             logger.error(f"Failed to log data collection event: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
172 |             # Don't fail the request for logging errors
    |
    = help: Replace with `exception`

src/presentation/api/middleware/consent_verification.py:176:5: D205 1 blank line required between summary line and description
    |
175 |   def require_consent(*consent_types: str):
176 | /     """Decorator to mark endpoints that require specific consent types
177 | |     Usage: @require_consent("data_collection", "voice_recording")
178 | |            @router.post("/process-audio")
179 | |            async def process_audio(...): ...
180 | |     """
    | |_______^ D205
181 |
182 |       def decorator(func):
    |
    = help: Insert single blank line

src/presentation/api/middleware/error_handling.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Error Handling Middleware for AI Teddy Bear
2 | | Comprehensive error handling with child safety and COPPA compliance
3 | | """
  | |___^ D205
4 |
5 |   from datetime import datetime
  |
  = help: Insert single blank line

src/presentation/api/middleware/error_handling.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """Error Handling Middleware for AI Teddy Bear
2 | | Comprehensive error handling with child safety and COPPA compliance
3 | | """
  | |___^ D415
4 |
5 |   from datetime import datetime
  |
  = help: Add closing punctuation

src/presentation/api/middleware/error_handling.py:5:1: I001 [*] Import block is un-sorted or un-formatted
   |
 3 |   """
 4 |
 5 | / from datetime import datetime
 6 | | from typing import Dict, Any, Optional, Union
 7 | | import logging
 8 | | from fastapi import Request, Response, HTTPException
 9 | | from starlette.middleware.base import BaseHTTPMiddleware
10 | | from fastapi.responses import JSONResponse
11 | | from pydantic import ValidationError
12 | | from starlette.middleware.base import RequestResponseEndpoint
13 | | import traceback
14 | |
15 | | from src.infrastructure.config.settings import get_settings
16 | | from src.infrastructure.logging_config import get_logger
   | |________________________________________________________^ I001
17 |
18 |   logger = get_logger(__name__, component="middleware")
   |
   = help: Organize imports

src/presentation/api/middleware/error_handling.py:6:1: UP035 `typing.Dict` is deprecated, use `dict` instead
  |
5 | from datetime import datetime
6 | from typing import Dict, Any, Optional, Union
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ UP035
7 | import logging
8 | from fastapi import Request, Response, HTTPException
  |

src/presentation/api/middleware/error_handling.py:6:41: F401 [*] `typing.Union` imported but unused
  |
5 | from datetime import datetime
6 | from typing import Dict, Any, Optional, Union
  |                                         ^^^^^ F401
7 | import logging
8 | from fastapi import Request, Response, HTTPException
  |
  = help: Remove unused import: `typing.Union`

src/presentation/api/middleware/error_handling.py:7:8: F401 [*] `logging` imported but unused
  |
5 | from datetime import datetime
6 | from typing import Dict, Any, Optional, Union
7 | import logging
  |        ^^^^^^^ F401
8 | from fastapi import Request, Response, HTTPException
9 | from starlette.middleware.base import BaseHTTPMiddleware
  |
  = help: Remove unused import: `logging`

src/presentation/api/middleware/error_handling.py:13:8: F401 [*] `traceback` imported but unused
   |
11 | from pydantic import ValidationError
12 | from starlette.middleware.base import RequestResponseEndpoint
13 | import traceback
   |        ^^^^^^^^^ F401
14 |
15 | from src.infrastructure.config.settings import get_settings
   |
   = help: Remove unused import: `traceback`

src/presentation/api/middleware/error_handling.py:22:5: D200 One-line docstring should fit on one line
   |
21 |   class ErrorHandlingMiddleware(BaseHTTPMiddleware):
22 | /     """
23 | |     Comprehensive error handling middleware for child safety applications.
24 | |     """
   | |_______^ D200
25 |       
26 |       def __init__(self, app) -> None:
   |
   = help: Reformat to one line

src/presentation/api/middleware/error_handling.py:22:5: D212 [*] Multi-line docstring summary should start at the first line
   |
21 |   class ErrorHandlingMiddleware(BaseHTTPMiddleware):
22 | /     """
23 | |     Comprehensive error handling middleware for child safety applications.
24 | |     """
   | |_______^ D212
25 |       
26 |       def __init__(self, app) -> None:
   |
   = help: Remove whitespace after opening quotes

src/presentation/api/middleware/error_handling.py:25:1: W293 [*] Blank line contains whitespace
   |
23 |     Comprehensive error handling middleware for child safety applications.
24 |     """
25 |     
   | ^^^^ W293
26 |     def __init__(self, app) -> None:
27 |         super().__init__(app)
   |
   = help: Remove whitespace from blank line

src/presentation/api/middleware/error_handling.py:33:89: E501 Line too long (91 > 88)
   |
31 |         # Child-friendly error messages
32 |         self.child_friendly_messages = {
33 |             400: "Oops! Something wasn't quite right with your request. Please try again!",
   |                                                                                         ^^^ E501
34 |             401: "You need to sign in first before we can help you!",
35 |             403: "Sorry, you don't have permission to do that right now.",
   |

src/presentation/api/middleware/error_handling.py:40:1: W293 [*] Blank line contains whitespace
   |
38 |             500: "Oh no! Something went wrong on our end. Don't worry, we're fixing it!"
39 |         }
40 |         
   | ^^^^^^^^ W293
41 |         # Security-related error codes that need special handling
42 |         self.security_error_codes = {401, 403, 422, 429}
   |
   = help: Remove whitespace from blank line

src/presentation/api/middleware/error_handling.py:44:89: E501 Line too long (95 > 88)
   |
42 |         self.security_error_codes = {401, 403, 422, 429}
43 |
44 |     async def dispatch(self, request: Request, call_next: RequestResponseEndpoint) -> Response:
   |                                                                                         ^^^^^^^ E501
45 |         """Handle request with comprehensive error catching and safe responses."""
46 |         try:
   |

src/presentation/api/middleware/error_handling.py:48:13: TRY300 Consider moving this statement to an `else` block
   |
46 |         try:
47 |             response = await call_next(request)
48 |             return response
   |             ^^^^^^^^^^^^^^^ TRY300
49 |         except HTTPException as e:
50 |             return await self._handle_http_exception(request, e)
   |

src/presentation/api/middleware/error_handling.py:48:20: RET504 Unnecessary assignment to `response` before `return` statement
   |
46 |         try:
47 |             response = await call_next(request)
48 |             return response
   |                    ^^^^^^^^ RET504
49 |         except HTTPException as e:
50 |             return await self._handle_http_exception(request, e)
   |
   = help: Remove unnecessary assignment

src/presentation/api/middleware/error_handling.py:56:89: E501 Line too long (97 > 88)
   |
54 |             return await self._handle_unexpected_error(request, e)
55 |
56 |     async def _handle_http_exception(self, request: Request, exc: HTTPException) -> JSONResponse:
   |                                                                                         ^^^^^^^^^ E501
57 |         """Handle FastAPI HTTP exceptions with child safety considerations."""
58 |         error_response = self._create_error_response(
   |

src/presentation/api/middleware/error_handling.py:65:1: W293 [*] Blank line contains whitespace
   |
63 |             is_security_error=exc.status_code in self.security_error_codes
64 |         )
65 |         
   | ^^^^^^^^ W293
66 |         return JSONResponse(
67 |             status_code=exc.status_code,
   |
   = help: Remove whitespace from blank line

src/presentation/api/middleware/error_handling.py:71:64: ARG002 Unused method argument: `exc`
   |
69 |         )
70 |
71 |     async def _handle_validation_error(self, request: Request, exc: ValidationError) -> JSONResponse:
   |                                                                ^^^ ARG002
72 |         """Handle Pydantic validation errors with child-appropriate messages."""
73 |         if self._is_child_related_request(request):
   |

src/presentation/api/middleware/error_handling.py:71:89: E501 Line too long (101 > 88)
   |
69 |         )
70 |
71 |     async def _handle_validation_error(self, request: Request, exc: ValidationError) -> JSONResponse:
   |                                                                                         ^^^^^^^^^^^^^ E501
72 |         """Handle Pydantic validation errors with child-appropriate messages."""
73 |         if self._is_child_related_request(request):
   |

src/presentation/api/middleware/error_handling.py:74:89: E501 Line too long (96 > 88)
   |
72 |         """Handle Pydantic validation errors with child-appropriate messages."""
73 |         if self._is_child_related_request(request):
74 |             message = "Some information wasn't filled in correctly. Please check and try again!"
   |                                                                                         ^^^^^^^^ E501
75 |         else:
76 |             message = "Please check your input and try again."
   |

src/presentation/api/middleware/error_handling.py:77:1: W293 [*] Blank line contains whitespace
   |
75 |         else:
76 |             message = "Please check your input and try again."
77 |             
   | ^^^^^^^^^^^^ W293
78 |         error_response = self._create_error_response(
79 |             request=request,
   |
   = help: Remove whitespace from blank line

src/presentation/api/middleware/error_handling.py:84:1: W293 [*] Blank line contains whitespace
   |
82 |             message=message
83 |         )
84 |         
   | ^^^^^^^^ W293
85 |         return JSONResponse(
86 |             status_code=422,
   |
   = help: Remove whitespace from blank line

src/presentation/api/middleware/error_handling.py:90:89: E501 Line too long (95 > 88)
   |
88 |         )
89 |
90 |     async def _handle_unexpected_error(self, request: Request, exc: Exception) -> JSONResponse:
   |                                                                                         ^^^^^^^ E501
91 |         """Handle unexpected errors with comprehensive logging and safe responses."""
92 |         logger.error(f"Unexpected error: {exc}", exc_info=True)
   |

src/presentation/api/middleware/error_handling.py:93:1: W293 [*] Blank line contains whitespace
   |
91 |         """Handle unexpected errors with comprehensive logging and safe responses."""
92 |         logger.error(f"Unexpected error: {exc}", exc_info=True)
93 |         
   | ^^^^^^^^ W293
94 |         error_response = self._create_error_response(
95 |             request=request,
   |
   = help: Remove whitespace from blank line

src/presentation/api/middleware/error_handling.py:101:1: W293 [*] Blank line contains whitespace
    |
 99 |             is_unexpected=True
100 |         )
101 |         
    | ^^^^^^^^ W293
102 |         return JSONResponse(
103 |             status_code=500,
    |
    = help: Remove whitespace from blank line

src/presentation/api/middleware/error_handling.py:107:9: PLR0913 Too many arguments in function definition (6 > 5)
    |
105 |         )
106 |
107 |     def _create_error_response(
    |         ^^^^^^^^^^^^^^^^^^^^^^ PLR0913
108 |         self,
109 |         request: Request,
    |

src/presentation/api/middleware/error_handling.py:111:9: ARG002 Unused method argument: `error_type`
    |
109 |         request: Request,
110 |         status_code: int,
111 |         error_type: str,
    |         ^^^^^^^^^^ ARG002
112 |         message: Optional[str] = None,
113 |         is_security_error: bool = False,
    |

src/presentation/api/middleware/error_handling.py:112:18: UP045 [*] Use `X | None` for type annotations
    |
110 |         status_code: int,
111 |         error_type: str,
112 |         message: Optional[str] = None,
    |                  ^^^^^^^^^^^^^ UP045
113 |         is_security_error: bool = False,
114 |         is_unexpected: bool = False
    |
    = help: Convert to `X | None`

src/presentation/api/middleware/error_handling.py:113:9: ARG002 Unused method argument: `is_security_error`
    |
111 |         error_type: str,
112 |         message: Optional[str] = None,
113 |         is_security_error: bool = False,
    |         ^^^^^^^^^^^^^^^^^ ARG002
114 |         is_unexpected: bool = False
115 |     ) -> Dict[str, Any]:
    |

src/presentation/api/middleware/error_handling.py:114:9: ARG002 Unused method argument: `is_unexpected`
    |
112 |         message: Optional[str] = None,
113 |         is_security_error: bool = False,
114 |         is_unexpected: bool = False
    |         ^^^^^^^^^^^^^ ARG002
115 |     ) -> Dict[str, Any]:
116 |         """Create a safe error response appropriate for the context."""
    |

src/presentation/api/middleware/error_handling.py:115:10: UP006 [*] Use `dict` instead of `Dict` for type annotation
    |
113 |         is_security_error: bool = False,
114 |         is_unexpected: bool = False
115 |     ) -> Dict[str, Any]:
    |          ^^^^ UP006
116 |         """Create a safe error response appropriate for the context."""
117 |         # Use child-friendly message if available and appropriate
    |
    = help: Replace with `dict`

src/presentation/api/middleware/error_handling.py:125:1: W293 [*] Blank line contains whitespace
    |
123 |         else:
124 |             safe_message = message
125 |             
    | ^^^^^^^^^^^^ W293
126 |         # Base error response
127 |         error_response = {
    |
    = help: Remove whitespace from blank line

src/presentation/api/middleware/error_handling.py:134:1: W293 [*] Blank line contains whitespace
    |
132 |             "path": request.url.path
133 |         }
134 |         
    | ^^^^^^^^ W293
135 |         # Add child safety indicators
136 |         if self._is_child_related_request(request):
    |
    = help: Remove whitespace from blank line

src/presentation/api/middleware/error_handling.py:139:1: W293 [*] Blank line contains whitespace
    |
137 |             error_response["child_safe"] = True
138 |             error_response["coppa_compliant"] = True
139 |             
    | ^^^^^^^^^^^^ W293
140 |         return error_response
    |
    = help: Remove whitespace from blank line

src/presentation/api/middleware/error_handling.py:150:1: W293 [*] Blank line contains whitespace
    |
148 |             "/api/v1/playground"
149 |         ]
150 |         
    | ^^^^^^^^ W293
151 |         return any(request.url.path.startswith(path) for path in child_paths)
    |
    = help: Remove whitespace from blank line

src/presentation/api/middleware/rate_limit_middleware.py:16:5: D205 1 blank line required between summary line and description
   |
15 |   class RateLimitMiddleware(BaseHTTPMiddleware):
16 | /     """Rate limiting middleware that applies different limits based on endpoint patterns.
17 | |     Features:
18 | |     - Endpoint-specific rate limiting
19 | |     - IP-based and user-based limits
20 | |     - Child safety rate limits
21 | |     - Automatic blocking for abuse
22 | |     - Comprehensive headers for client information
23 | |     """
   | |_______^ D205
24 |
25 |       def __init__(
   |
   = help: Insert single blank line

src/presentation/api/middleware/rate_limit_middleware.py:16:5: D415 First line should end with a period, question mark, or exclamation point
   |
15 |   class RateLimitMiddleware(BaseHTTPMiddleware):
16 | /     """Rate limiting middleware that applies different limits based on endpoint patterns.
17 | |     Features:
18 | |     - Endpoint-specific rate limiting
19 | |     - IP-based and user-based limits
20 | |     - Child safety rate limits
21 | |     - Automatic blocking for abuse
22 | |     - Comprehensive headers for client information
23 | |     """
   | |_______^ D415
24 |
25 |       def __init__(
   |
   = help: Add closing punctuation

src/presentation/api/middleware/rate_limit_middleware.py:16:89: E501 Line too long (89 > 88)
   |
15 | class RateLimitMiddleware(BaseHTTPMiddleware):
16 |     """Rate limiting middleware that applies different limits based on endpoint patterns.
   |                                                                                         ^ E501
17 |     Features:
18 |     - Endpoint-specific rate limiting
   |

src/presentation/api/middleware/rate_limit_middleware.py:116:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
115 |         except Exception as e:
116 |             logger.error(f"Rate limiting error for {endpoint}: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
117 |
118 |             # On error, allow request but log the issue
    |
    = help: Replace with `exception`

src/presentation/api/middleware/rate_limit_middleware.py:157:13: TRY300 Consider moving this statement to an `else` block
    |
155 |                 return user_id
156 |
157 |             return None
    |             ^^^^^^^^^^^ TRY300
158 |         except (AttributeError, KeyError, ValueError) as e:
159 |             logger.warning(f"Error extracting user ID from request: {e}")
    |

src/presentation/api/middleware/rate_limit_middleware.py:162:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
160 |             return None
161 |         except Exception as e:
162 |             logger.error(f"Unexpected error extracting user ID: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
163 |             return None
    |
    = help: Replace with `exception`

src/presentation/api/middleware/rate_limit_middleware.py:177:44: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
    |
175 |                     potential_id = path_parts[children_index + 1]
176 |                     # Simple validation - should be UUID-like
177 |                     if len(potential_id) > 10 and (
    |                                            ^^ PLR2004
178 |                         "-" in potential_id or potential_id.isalnum()
179 |                     ):
    |

src/presentation/api/middleware/rate_limit_middleware.py:188:13: TRY300 Consider moving this statement to an `else` block
    |
186 |                     return child_id
187 |
188 |             return None
    |             ^^^^^^^^^^^ TRY300
189 |         except (AttributeError, ValueError, IndexError) as e:
190 |             logger.warning(f"Error extracting child ID from request: {e}")
    |

src/presentation/api/middleware/rate_limit_middleware.py:193:13: TRY400 Use `logging.exception` instead of `logging.error`
    |
191 |             return None
192 |         except Exception as e:
193 |             logger.error(f"Unexpected error extracting child ID: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
194 |             return None
    |
    = help: Replace with `exception`

src/presentation/api/middleware/rate_limit_middleware.py:239:40: ARG002 Unused method argument: `config_name`
    |
238 |     def _create_rate_limit_error_response(
239 |         self, result: RateLimitResult, config_name: str
    |                                        ^^^^^^^^^^^ ARG002
240 |     ) -> Response:
241 |         """Create appropriate error response for rate limit violations."""
    |

src/presentation/api/middleware/rate_limit_middleware.py:279:16: RET504 Unnecessary assignment to `response` before `return` statement
    |
277 |         )
278 |
279 |         return response
    |                ^^^^^^^^ RET504
    |
    = help: Remove unnecessary assignment

src/presentation/api/middleware/request_logging.py:1:1: I001 [*] Import block is un-sorted or un-formatted
   |
 1 | / import json
 2 | | import time
 3 | | from datetime import datetime
 4 | | from typing import Any
 5 | |
 6 | | from fastapi import Request, Response
 7 | | from starlette.middleware.base import BaseHTTPMiddleware
 8 | | from starlette.middleware.base import RequestResponseEndpoint
 9 | |
10 | | from src.application.services.audit_service import AuditService
11 | | from src.infrastructure.config.settings import get_settings
12 | | from src.infrastructure.security.request_security_detector import (
13 | |     RequestSecurityDetector,
14 | | )
   | |_^ I001
15 |
16 |   """Request Logging Middleware for AI Teddy Bear
   |
   = help: Organize imports

src/presentation/api/middleware/request_logging.py:19:1: E402 Module level import not at top of file
   |
17 | Comprehensive request/response logging with child safety and COPPA compliance"""
18 |
19 | from src.infrastructure.logging_config import get_logger
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ E402
20 |
21 | logger = get_logger(__name__, component="middleware")
   |

src/presentation/api/middleware/request_logging.py:25:5: D205 1 blank line required between summary line and description
   |
24 |   class RequestLoggingMiddleware(BaseHTTPMiddleware):
25 | /     """Comprehensive request logging middleware for child safety compliance.
26 | |     Features:
27 | |     - Detailed request/response logging
28 | |     - COPPA-compliant data handling
29 | |     - Security event detection
30 | |     - Child safety tracking.
31 | |     """
   | |_______^ D205
32 |
33 |       def __init__(self, app) -> None:
   |
   = help: Insert single blank line

src/presentation/api/middleware/request_logging.py:238:50: PLR2004 Magic value used in comparison, consider replacing `1000` with a constant variable
    |
236 |         if isinstance(data, list | tuple):
237 |             return [self._sanitize_data(item) for item in data]
238 |         if isinstance(data, str) and len(data) > 1000:
    |                                                  ^^^^ PLR2004
239 |             # Truncate very long strings
240 |             return data[:1000] + "...[TRUNCATED]"
    |

src/presentation/api/middleware/request_logging.py:264:36: PLR2004 Magic value used in comparison, consider replacing `400` with a constant variable
    |
262 |         """Determine if response should be logged."""
263 |         # Always log errors
264 |         if response.status_code >= 400:
    |                                    ^^^ PLR2004
265 |             return True
    |

src/presentation/api/middleware/request_logging.py:315:44: PLR2004 Magic value used in comparison, consider replacing `500` with a constant variable
    |
314 |         # Determine log level based on status code
315 |         if response_info["status_code"] >= 500:
    |                                            ^^^ PLR2004
316 |             logger.error(f"Response: {json.dumps(log_data, default=str)}")
317 |         elif response_info["status_code"] >= 400:
    |

src/presentation/api/middleware/request_logging.py:317:46: PLR2004 Magic value used in comparison, consider replacing `400` with a constant variable
    |
315 |         if response_info["status_code"] >= 500:
316 |             logger.error(f"Response: {json.dumps(log_data, default=str)}")
317 |         elif response_info["status_code"] >= 400:
    |                                              ^^^ PLR2004
318 |             logger.warning(f"Response: {json.dumps(log_data, default=str)}")
319 |         else:
    |

src/presentation/api/models/__init__.py:1:1: D205 1 blank line required between summary line and description
   |
 1 | / """from .standard_responses import (
 2 | |     StandardAPIResponse,
 3 | |     SuccessResponse,
 4 | |     ErrorResponse,
 5 | |     ChildSafetyResponse,
 6 | |     AuthenticationResponse,
 7 | |     PaginatedResponse,
 8 | |     HealthCheckResponse,
 9 | |     ValidationErrorResponse,
10 | |     ValidationErrorDetail,
11 | |     ResponseStatus,
12 | |     ResponseCode,
13 | |     create_success_response,
14 | |     create_error_response,
15 | |     create_child_safety_response,
16 | |     create_paginated_response,
17 | |     NAMING_CONVENTIONS
18 | | ).
19 | | """
   | |___^ D205
20 |
21 |   """🔄 API Models Package
   |
   = help: Insert single blank line

src/presentation/api/models/__init__.py:60:89: E501 Line too long (113 > 88)
   |
58 | ```python
59 | from src.presentation.api.models import create_success_response
60 | return create_success_response(data={"user_id": "123", "is_active": True}, message="User retrieved successfully")
   |                                                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^ E501
61 | ```
   |

src/presentation/api/models/standard_responses.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """🔄 Standardized API Response Models
2 | | Consistent naming conventions for all API responses
3 | | """
  | |___^ D205
4 |
5 |   from datetime import datetime
  |
  = help: Insert single blank line

src/presentation/api/models/standard_responses.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | / """🔄 Standardized API Response Models
2 | | Consistent naming conventions for all API responses
3 | | """
  | |___^ D415
4 |
5 |   from datetime import datetime
  |
  = help: Add closing punctuation

src/presentation/api/models/standard_responses.py:39:5: D205 1 blank line required between summary line and description
   |
38 |   class StandardAPIResponse(BaseModel):
39 | /     """Standardized API response format for consistent client communication.
40 | |     All API endpoints should use this format or inherit from it.
41 | |     """
   | |_______^ D205
42 |
43 |       status: ResponseStatus = Field(description="Response status indicator")
   |
   = help: Insert single blank line

src/presentation/api/models/standard_responses.py:70:25: RUF012 Mutable class attributes should be annotated with `typing.ClassVar`
   |
69 |         use_enum_values = True
70 |         json_encoders = {datetime: lambda v: v.isoformat()}
   |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ RUF012
   |

src/presentation/api/models/standard_responses.py:88:5: D205 1 blank line required between summary line and description
   |
87 |   class ChildSafetyResponse(StandardAPIResponse):
88 | /     """Specialized response for child safety operations.
89 | |     Includes COPPA compliance indicators and safety metadata.
90 | |     """
   | |_______^ D205
91 |
92 |       safety_validated: bool = Field(description="Content passed safety validation")
   |
   = help: Insert single blank line

src/presentation/api/models/standard_responses.py:268:5: PLR0913 Too many arguments in function definition (7 > 5)
    |
268 | def create_child_safety_response(
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLR0913
269 |     data: Any,
270 |     safety_validated: bool,
    |

src/presentation/api/models/standard_responses.py:303:5: PLR0913 Too many arguments in function definition (9 > 5)
    |
303 | def create_teddy_bear_response(
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^ PLR0913
304 |     data: Any,
305 |     safety_validated: bool = True,
    |

src/presentation/api/models/standard_responses.py:344:5: PLR0913 Too many arguments in function definition (7 > 5)
    |
344 | def create_paginated_response(
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^ PLR0913
345 |     data: list[Any],
346 |     total_count: int,
    |

src/presentation/api/models/standard_responses.py:383:5: PLR0913 Too many arguments in function definition (7 > 5)
    |
383 | def create_voice_processing_response(
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLR0913
384 |     data: Any,
385 |     audio_quality_score: float | None = None,
    |

src/presentation/api/models/standard_responses.py:421:5: PLR0913 Too many arguments in function definition (7 > 5)
    |
421 | def create_conversation_response(
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PLR0913
422 |     data: Any,
423 |     conversation_id: str,
    |

src/presentation/api/models/standard_responses.py:488:89: E501 Line too long (91 > 88)
    |
486 |         "content_rating": "String content safety rating",
487 |         "parental_controls_active": "Boolean indicating parental controls status",
488 |         "emergency_contact_available": "Boolean indicating emergency contact availability",
    |                                                                                         ^^^ E501
489 |     },
490 | }
    |

src/presentation/api/models/validation_models.py:1:1: D205 1 blank line required between summary line and description
  |
1 | / """Pydantic Models for API Input Validation
2 | | Provides comprehensive input validation for all API endpoints
3 | | with COPPA compliance and child safety features.
4 | | """
  | |___^ D205
5 |
6 |   import base64
  |
  = help: Insert single blank line

src/presentation/api/models/validation_models.py:62:34: N805 First argument of a method should be named `self`
   |
61 |     @validator("message")
62 |     def validate_message_content(cls, v) -> str:
   |                                  ^^^ N805
63 |         """Validate message content for child safety."""
64 |         if not v or not v.strip():
   |
   = help: Rename `cls` to `self`

src/presentation/api/models/validation_models.py:65:19: TRY003 Avoid specifying long messages outside the exception class
   |
63 |         """Validate message content for child safety."""
64 |         if not v or not v.strip():
65 |             raise ValueError("Message cannot be empty")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
66 |
67 |         # Basic safety checks - prohibited keywords that could indicate unsafe content
   |

src/presentation/api/models/validation_models.py:88:23: TRY003 Avoid specifying long messages outside the exception class
   |
86 |         for keyword in prohibited_keywords:
87 |             if keyword in message_lower:
88 |                 raise ValueError(f"Message contains prohibited content: {keyword}")
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
89 |
90 |         # Check for excessive repetition (spam protection)
   |

src/presentation/api/models/validation_models.py:92:25: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
   |
90 |         # Check for excessive repetition (spam protection)
91 |         words = v.split()
92 |         if len(words) > 10:
   |                         ^^ PLR2004
93 |             unique_words = set(word.lower() for word in words)
94 |             if len(unique_words) / len(words) < 0.3:  # Less than 30% unique words
   |

src/presentation/api/models/validation_models.py:93:28: C401 Unnecessary generator (rewrite as a set comprehension)
   |
91 |         words = v.split()
92 |         if len(words) > 10:
93 |             unique_words = set(word.lower() for word in words)
   |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ C401
94 |             if len(unique_words) / len(words) < 0.3:  # Less than 30% unique words
95 |                 raise ValueError("Message appears to be spam or excessive repetition")
   |
   = help: Rewrite as a set comprehension

src/presentation/api/models/validation_models.py:94:49: PLR2004 Magic value used in comparison, consider replacing `0.3` with a constant variable
   |
92 |         if len(words) > 10:
93 |             unique_words = set(word.lower() for word in words)
94 |             if len(unique_words) / len(words) < 0.3:  # Less than 30% unique words
   |                                                 ^^^ PLR2004
95 |                 raise ValueError("Message appears to be spam or excessive repetition")
   |

src/presentation/api/models/validation_models.py:95:23: TRY003 Avoid specifying long messages outside the exception class
   |
93 |             unique_words = set(word.lower() for word in words)
94 |             if len(unique_words) / len(words) < 0.3:  # Less than 30% unique words
95 |                 raise ValueError("Message appears to be spam or excessive repetition")
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
96 |
97 |         return v.strip()
   |

src/presentation/api/models/validation_models.py:124:23: N805 First argument of a method should be named `self`
    |
123 |     @validator("name")
124 |     def validate_name(cls, v) -> str:
    |                       ^^^ N805
125 |         """Validate child name."""
126 |         if not v or not v.strip():
    |
    = help: Rename `cls` to `self`

src/presentation/api/models/validation_models.py:127:19: TRY003 Avoid specifying long messages outside the exception class
    |
125 |         """Validate child name."""
126 |         if not v or not v.strip():
127 |             raise ValueError("Name is required")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
128 |
129 |         # Remove excessive whitespace
    |

src/presentation/api/models/validation_models.py:135:19: TRY003 Avoid specifying long messages outside the exception class
    |
133 |           allowed_chars = set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ -'")
134 |           if not all(char in allowed_chars for char in name):
135 |               raise ValueError(
    |  ___________________^
136 | |                 "Name should only contain letters, spaces, hyphens, and apostrophes"
137 | |             )
    | |_____________^ TRY003
138 |
139 |           # Prevent extremely long names
    |

src/presentation/api/models/validation_models.py:140:24: PLR2004 Magic value used in comparison, consider replacing `50` with a constant variable
    |
139 |         # Prevent extremely long names
140 |         if len(name) > 50:
    |                        ^^ PLR2004
141 |             raise ValueError("Name is too long")
    |

src/presentation/api/models/validation_models.py:141:19: TRY003 Avoid specifying long messages outside the exception class
    |
139 |         # Prevent extremely long names
140 |         if len(name) > 50:
141 |             raise ValueError("Name is too long")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
142 |
143 |         return name
    |

src/presentation/api/models/validation_models.py:146:28: N805 First argument of a method should be named `self`
    |
145 |     @validator("age")
146 |     def validate_coppa_age(cls, v) -> int:
    |                            ^^^ N805
147 |         """Validate age for COPPA compliance."""
148 |         if v < 3:
    |
    = help: Rename `cls` to `self`

src/presentation/api/models/validation_models.py:148:16: PLR2004 Magic value used in comparison, consider replacing `3` with a constant variable
    |
146 |     def validate_coppa_age(cls, v) -> int:
147 |         """Validate age for COPPA compliance."""
148 |         if v < 3:
    |                ^ PLR2004
149 |             raise ValueError("Children under 3 years are not supported")
150 |         if v > 13:
    |

src/presentation/api/models/validation_models.py:149:19: TRY003 Avoid specifying long messages outside the exception class
    |
147 |         """Validate age for COPPA compliance."""
148 |         if v < 3:
149 |             raise ValueError("Children under 3 years are not supported")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
150 |         if v > 13:
151 |             raise ValueError(
    |

src/presentation/api/models/validation_models.py:150:16: PLR2004 Magic value used in comparison, consider replacing `13` with a constant variable
    |
148 |         if v < 3:
149 |             raise ValueError("Children under 3 years are not supported")
150 |         if v > 13:
    |                ^^ PLR2004
151 |             raise ValueError(
152 |                 "COPPA compliance: Children over 13 require different consent procedures"
    |

src/presentation/api/models/validation_models.py:151:19: TRY003 Avoid specifying long messages outside the exception class
    |
149 |               raise ValueError("Children under 3 years are not supported")
150 |           if v > 13:
151 |               raise ValueError(
    |  ___________________^
152 | |                 "COPPA compliance: Children over 13 require different consent procedures"
153 | |             )
    | |_____________^ TRY003
154 |           return v
    |

src/presentation/api/models/validation_models.py:152:89: E501 Line too long (89 > 88)
    |
150 |         if v > 13:
151 |             raise ValueError(
152 |                 "COPPA compliance: Children over 13 require different consent procedures"
    |                                                                                         ^ E501
153 |             )
154 |         return v
    |

src/presentation/api/models/validation_models.py:157:29: N805 First argument of a method should be named `self`
    |
156 |     @validator("date_of_birth")
157 |     def validate_birth_date(cls, v, values) -> date | None:
    |                             ^^^ N805
158 |         """Validate birth date consistency with age."""
159 |         if v and "age" in values:
    |
    = help: Rename `cls` to `self`

src/presentation/api/models/validation_models.py:165:23: TRY003 Avoid specifying long messages outside the exception class
    |
163 |             )
164 |             if abs(calculated_age - values["age"]) > 1:
165 |                 raise ValueError("Birth date does not match provided age")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
166 |         return v
    |

src/presentation/api/models/validation_models.py:169:37: N805 First argument of a method should be named `self`
    |
168 |     @validator("personality_traits")
169 |     def validate_personality_traits(cls, v) -> list[str]:
    |                                     ^^^ N805
170 |         """Validate personality traits."""
171 |         if not v:
    |
    = help: Rename `cls` to `self`

src/presentation/api/models/validation_models.py:179:13: PLW2901 `for` loop variable `trait` overwritten by assignment target
    |
177 |             if not isinstance(trait, str):
178 |                 continue
179 |             trait = trait.strip()
    |             ^^^^^ PLW2901
180 |             if len(trait) > 50:
181 |                 raise ValueError("Personality trait too long")
    |

src/presentation/api/models/validation_models.py:180:29: PLR2004 Magic value used in comparison, consider replacing `50` with a constant variable
    |
178 |                 continue
179 |             trait = trait.strip()
180 |             if len(trait) > 50:
    |                             ^^ PLR2004
181 |                 raise ValueError("Personality trait too long")
182 |             if trait:
    |

src/presentation/api/models/validation_models.py:181:23: TRY003 Avoid specifying long messages outside the exception class
    |
179 |             trait = trait.strip()
180 |             if len(trait) > 50:
181 |                 raise ValueError("Personality trait too long")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
182 |             if trait:
183 |                 valid_traits.append(trait)
    |

src/presentation/api/models/validation_models.py:203:29: N805 First argument of a method should be named `self`
    |
202 |     @validator("audio_data")
203 |     def validate_audio_data(cls, v) -> str:
    |                             ^^^ N805
204 |         """Validate base64 audio data."""
205 |         if not v:
    |
    = help: Rename `cls` to `self`

src/presentation/api/models/validation_models.py:206:19: TRY003 Avoid specifying long messages outside the exception class
    |
204 |         """Validate base64 audio data."""
205 |         if not v:
206 |             raise ValueError("Audio data is required")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
207 |
208 |         # Basic base64 validation
    |

src/presentation/api/models/validation_models.py:212:17: TRY301 Abstract `raise` to an inner function
    |
210 |             decoded = base64.b64decode(v)
211 |             if len(decoded) == 0:
212 |                 raise ValueError("Audio data is empty")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
213 |             if len(decoded) > 10 * 1024 * 1024:  # 10MB limit
214 |                 raise ValueError("Audio data too large (max 10MB)")
    |

src/presentation/api/models/validation_models.py:212:23: TRY003 Avoid specifying long messages outside the exception class
    |
210 |             decoded = base64.b64decode(v)
211 |             if len(decoded) == 0:
212 |                 raise ValueError("Audio data is empty")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
213 |             if len(decoded) > 10 * 1024 * 1024:  # 10MB limit
214 |                 raise ValueError("Audio data too large (max 10MB)")
    |

src/presentation/api/models/validation_models.py:214:17: TRY301 Abstract `raise` to an inner function
    |
212 |                 raise ValueError("Audio data is empty")
213 |             if len(decoded) > 10 * 1024 * 1024:  # 10MB limit
214 |                 raise ValueError("Audio data too large (max 10MB)")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
215 |             if len(decoded) < 100:  # Minimum size check
216 |                 raise ValueError("Audio data too small to be valid")
    |

src/presentation/api/models/validation_models.py:214:23: TRY003 Avoid specifying long messages outside the exception class
    |
212 |                 raise ValueError("Audio data is empty")
213 |             if len(decoded) > 10 * 1024 * 1024:  # 10MB limit
214 |                 raise ValueError("Audio data too large (max 10MB)")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
215 |             if len(decoded) < 100:  # Minimum size check
216 |                 raise ValueError("Audio data too small to be valid")
    |

src/presentation/api/models/validation_models.py:215:31: PLR2004 Magic value used in comparison, consider replacing `100` with a constant variable
    |
213 |             if len(decoded) > 10 * 1024 * 1024:  # 10MB limit
214 |                 raise ValueError("Audio data too large (max 10MB)")
215 |             if len(decoded) < 100:  # Minimum size check
    |                               ^^^ PLR2004
216 |                 raise ValueError("Audio data too small to be valid")
217 |         except Exception as e:
    |

src/presentation/api/models/validation_models.py:216:17: TRY301 Abstract `raise` to an inner function
    |
214 |                 raise ValueError("Audio data too large (max 10MB)")
215 |             if len(decoded) < 100:  # Minimum size check
216 |                 raise ValueError("Audio data too small to be valid")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY301
217 |         except Exception as e:
218 |             raise ValueError(f"Invalid base64 audio data: {e!s}")
    |

src/presentation/api/models/validation_models.py:216:23: TRY003 Avoid specifying long messages outside the exception class
    |
214 |                 raise ValueError("Audio data too large (max 10MB)")
215 |             if len(decoded) < 100:  # Minimum size check
216 |                 raise ValueError("Audio data too small to be valid")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
217 |         except Exception as e:
218 |             raise ValueError(f"Invalid base64 audio data: {e!s}")
    |

src/presentation/api/models/validation_models.py:218:13: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
216 |                 raise ValueError("Audio data too small to be valid")
217 |         except Exception as e:
218 |             raise ValueError(f"Invalid base64 audio data: {e!s}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B904
219 |
220 |         return v
    |

src/presentation/api/models/validation_models.py:218:19: TRY003 Avoid specifying long messages outside the exception class
    |
216 |                 raise ValueError("Audio data too small to be valid")
217 |         except Exception as e:
218 |             raise ValueError(f"Invalid base64 audio data: {e!s}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
219 |
220 |         return v
    |

src/presentation/api/models/validation_models.py:223:31: N805 First argument of a method should be named `self`
    |
222 |     @validator("audio_format")
223 |     def validate_audio_format(cls, v) -> str:
    |                               ^^^ N805
224 |         """Validate audio format."""
225 |         allowed_formats = ["wav", "mp3", "ogg", "m4a", "webm"]
    |
    = help: Rename `cls` to `self`

src/presentation/api/models/validation_models.py:227:19: TRY003 Avoid specifying long messages outside the exception class
    |
225 |         allowed_formats = ["wav", "mp3", "ogg", "m4a", "webm"]
226 |         if v.lower() not in allowed_formats:
227 |             raise ValueError(f"Audio format must be one of: {allowed_formats}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
228 |         return v.lower()
    |

src/presentation/api/models/validation_models.py:242:24: N805 First argument of a method should be named `self`
    |
241 |     @validator("phone")
242 |     def validate_phone(cls, v) -> str:
    |                        ^^^ N805
243 |         """Validate phone number format."""
244 |         # Remove all non-digits
    |
    = help: Rename `cls` to `self`

src/presentation/api/models/validation_models.py:246:31: PLR2004 Magic value used in comparison, consider replacing `10` with a constant variable
    |
244 |         # Remove all non-digits
245 |         digits_only = re.sub(r"\D", "", v)
246 |         if len(digits_only) < 10:
    |                               ^^ PLR2004
247 |             raise ValueError("Phone number must have at least 10 digits")
248 |         if len(digits_only) > 15:
    |

src/presentation/api/models/validation_models.py:247:19: TRY003 Avoid specifying long messages outside the exception class
    |
245 |         digits_only = re.sub(r"\D", "", v)
246 |         if len(digits_only) < 10:
247 |             raise ValueError("Phone number must have at least 10 digits")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
248 |         if len(digits_only) > 15:
249 |             raise ValueError("Phone number too long")
    |

src/presentation/api/models/validation_models.py:248:31: PLR2004 Magic value used in comparison, consider replacing `15` with a constant variable
    |
246 |         if len(digits_only) < 10:
247 |             raise ValueError("Phone number must have at least 10 digits")
248 |         if len(digits_only) > 15:
    |                               ^^ PLR2004
249 |             raise ValueError("Phone number too long")
250 |         return digits_only
    |

src/presentation/api/models/validation_models.py:249:19: TRY003 Avoid specifying long messages outside the exception class
    |
247 |             raise ValueError("Phone number must have at least 10 digits")
248 |         if len(digits_only) > 15:
249 |             raise ValueError("Phone number too long")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
250 |         return digits_only
    |

src/presentation/api/models/validation_models.py:253:31: N805 First argument of a method should be named `self`
    |
252 |     @validator("relationship")
253 |     def validate_relationship(cls, v) -> str:
    |                               ^^^ N805
254 |         """Validate relationship type."""
255 |         valid_relationships = [
    |
    = help: Rename `cls` to `self`

src/presentation/api/models/validation_models.py:267:19: TRY003 Avoid specifying long messages outside the exception class
    |
265 |         ]
266 |         if v.lower() not in valid_relationships:
267 |             raise ValueError(f"Relationship must be one of: {valid_relationships}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
268 |         return v.lower()
    |

src/presentation/api/models/validation_models.py:284:31: N805 First argument of a method should be named `self`
    |
283 |     @validator("consent_type")
284 |     def validate_consent_type(cls, v) -> str:
    |                               ^^^ N805
285 |         """Validate consent type."""
286 |         valid_types = [
    |
    = help: Rename `cls` to `self`

src/presentation/api/models/validation_models.py:298:19: TRY003 Avoid specifying long messages outside the exception class
    |
296 |         ]
297 |         if v not in valid_types:
298 |             raise ValueError(f"Invalid consent type. Must be one of: {valid_types}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
299 |         return v
    |

src/presentation/api/models/validation_models.py:302:38: N805 First argument of a method should be named `self`
    |
301 |     @validator("verification_method")
302 |     def validate_verification_method(cls, v) -> str:
    |                                      ^^^ N805
303 |         """Validate verification method."""
304 |         valid_methods = [
    |
    = help: Rename `cls` to `self`

src/presentation/api/models/validation_models.py:313:19: TRY003 Avoid specifying long messages outside the exception class
    |
311 |           ]
312 |           if v not in valid_methods:
313 |               raise ValueError(
    |  ___________________^
314 | |                 f"Invalid verification method. Must be one of: {valid_methods}"
315 | |             )
    | |_____________^ TRY003
316 |           return v
    |

src/presentation/api/models/validation_models.py:348:35: N805 First argument of a method should be named `self`
    |
347 |     @validator("limit")
348 |     def validate_child_safe_limit(cls, v) -> int:
    |                                   ^^^ N805
349 |         """Ensure pagination limits are child-safe."""
350 |         # For child data, limit to smaller pages for safety and performance
    |
    = help: Rename `cls` to `self`

src/presentation/api/models/validation_models.py:351:16: PLR2004 Magic value used in comparison, consider replacing `50` with a constant variable
    |
349 |         """Ensure pagination limits are child-safe."""
350 |         # For child data, limit to smaller pages for safety and performance
351 |         if v > 50:
    |                ^^ PLR2004
352 |             raise ValueError("Page limit too high for child data (max 50)")
353 |         return v
    |

src/presentation/api/models/validation_models.py:352:19: TRY003 Avoid specifying long messages outside the exception class
    |
350 |         # For child data, limit to smaller pages for safety and performance
351 |         if v > 50:
352 |             raise ValueError("Page limit too high for child data (max 50)")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
353 |         return v
    |

src/presentation/api/models/validation_models.py:356:29: N805 First argument of a method should be named `self`
    |
355 |     @validator("sort_by")
356 |     def validate_sort_field(cls, v) -> str | None:
    |                             ^^^ N805
357 |         """Validate sort field for security."""
358 |         if v is None:
    |
    = help: Rename `cls` to `self`

src/presentation/api/models/validation_models.py:372:19: TRY003 Avoid specifying long messages outside the exception class
    |
370 |         ]
371 |         if v not in allowed_sort_fields:
372 |             raise ValueError(f"Sort field must be one of: {allowed_sort_fields}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
373 |         return v
    |

src/presentation/api/models/validation_models.py:390:34: N805 First argument of a method should be named `self`
    |
389 |     @validator("filename")
390 |     def validate_filename_safety(cls, v) -> str:
    |                                  ^^^ N805
391 |         """Validate filename for path traversal and safety."""
392 |         # Remove any path separators
    |
    = help: Rename `cls` to `self`

src/presentation/api/models/validation_models.py:393:20: PTH119 `os.path.basename()` should be replaced by `Path.name`
    |
391 |         """Validate filename for path traversal and safety."""
392 |         # Remove any path separators
393 |         filename = os.path.basename(v)
    |                    ^^^^^^^^^^^^^^^^ PTH119
394 |
395 |         # Check for dangerous patterns
    |
    = help: Replace with `Path(...).name`

src/presentation/api/models/validation_models.py:416:23: TRY003 Avoid specifying long messages outside the exception class
    |
414 |         for pattern in dangerous_patterns:
415 |             if pattern in filename_lower:
416 |                 raise ValueError(f"Filename contains dangerous pattern: {pattern}")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
417 |
418 |         # Ensure reasonable length and valid extension
    |

src/presentation/api/models/validation_models.py:419:28: PLR2004 Magic value used in comparison, consider replacing `100` with a constant variable
    |
418 |         # Ensure reasonable length and valid extension
419 |         if len(filename) > 100:
    |                            ^^^ PLR2004
420 |             raise ValueError("Filename too long")
    |

src/presentation/api/models/validation_models.py:420:19: TRY003 Avoid specifying long messages outside the exception class
    |
418 |         # Ensure reasonable length and valid extension
419 |         if len(filename) > 100:
420 |             raise ValueError("Filename too long")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
421 |
422 |         return filename
    |

src/presentation/api/models/validation_models.py:425:31: N805 First argument of a method should be named `self`
    |
424 |     @validator("content_type")
425 |     def validate_content_type(cls, v) -> str:
    |                               ^^^ N805
426 |         """Validate allowed content types."""
427 |         allowed_types = [
    |
    = help: Rename `cls` to `self`

src/presentation/api/models/validation_models.py:440:19: TRY003 Avoid specifying long messages outside the exception class
    |
438 |         ]
439 |         if v not in allowed_types:
440 |             raise ValueError(f"Content type not allowed: {v}")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
441 |         return v
    |

src/presentation/api/models/validation_models.py:454:39: N805 First argument of a method should be named `self`
    |
453 |     @validator("message")
454 |     def validate_conversation_message(cls, v) -> str:
    |                                       ^^^ N805
455 |         """Validate conversation message content."""
456 |         if not v or not v.strip():
    |
    = help: Rename `cls` to `self`

src/presentation/api/models/validation_models.py:457:19: TRY003 Avoid specifying long messages outside the exception class
    |
455 |         """Validate conversation message content."""
456 |         if not v or not v.strip():
457 |             raise ValueError("Message cannot be empty")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
458 |
459 |         # Remove excessive whitespace
    |

src/presentation/api/models/validation_models.py:463:43: PLR2004 Magic value used in comparison, consider replacing `300` with a constant variable
    |
462 |         # Check for reasonable length
463 |         if len(cleaned_message.split()) > 300:  # ~300 words max
    |                                           ^^^ PLR2004
464 |             raise ValueError("Message too long")
    |

src/presentation/api/models/validation_models.py:464:19: TRY003 Avoid specifying long messages outside the exception class
    |
462 |         # Check for reasonable length
463 |         if len(cleaned_message.split()) > 300:  # ~300 words max
464 |             raise ValueError("Message too long")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
465 |
466 |         return cleaned_message
    |

src/presentation/api/models/validation_models.py:492:23: S105 Possible hardcoded password assigned to: "token_type"
    |
490 |     access_token: str
491 |     refresh_token: str
492 |     token_type: str = "bearer"
    |                       ^^^^^^^^ S105
493 |     user_id: str
494 |     email: str
    |

src/presentation/api/openapi_config.py:4:89: E501 Line too long (91 > 88)
  |
3 | This module defines the custom OpenAPI schema generation for the FastAPI application,
4 | including detailed descriptions, server URLs, security schemes, and common error responses.
  |                                                                                         ^^^ E501
5 | """
  |

src/presentation/api/parental_dashboard.py:107:43: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
105 | async def create_child_profile_endpoint(
106 |     request: CreateChildRequest,
107 |     use_case: ManageChildProfileUseCase = Depends(get_manage_child_profile_use_case),
    |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
108 | ) -> ChildData:
109 |     try:
    |

src/presentation/api/parental_dashboard.py:113:9: TRY300 Consider moving this statement to an `else` block
    |
111 |             request.name, request.age, request.preferences
112 |         )
113 |         return child_data
    |         ^^^^^^^^^^^^^^^^^ TRY300
114 |     except Exception as e:
115 |         error_handler = get_secure_error_handler()
    |

src/presentation/api/parental_dashboard.py:113:16: RET504 Unnecessary assignment to `child_data` before `return` statement
    |
111 |             request.name, request.age, request.preferences
112 |         )
113 |         return child_data
    |                ^^^^^^^^^^ RET504
114 |     except Exception as e:
115 |         error_handler = get_secure_error_handler()
    |
    = help: Remove unnecessary assignment

src/presentation/api/parental_dashboard.py:116:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
114 |       except Exception as e:
115 |           error_handler = get_secure_error_handler()
116 | /         raise error_handler.create_safe_error_response(
117 | |             e,
118 | |             status.HTTP_500_INTERNAL_SERVER_ERROR,
119 | |             "Failed to create child profile",
120 | |         )
    | |_________^ B904
    |

src/presentation/api/parental_dashboard.py:126:43: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
124 | async def get_child_profile_endpoint(
125 |     child_id: UUID,
126 |     use_case: ManageChildProfileUseCase = Depends(get_manage_child_profile_use_case),
    |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
127 | ) -> ChildData:
128 |     child_data = await use_case.get_child_profile(child_id)
    |

src/presentation/api/parental_dashboard.py:140:43: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
138 |     child_id: UUID,
139 |     request: UpdateChildRequest,
140 |     use_case: ManageChildProfileUseCase = Depends(get_manage_child_profile_use_case),
    |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
141 | ) -> ChildData:
142 |     updated_child = await use_case.update_child_profile(
    |

src/presentation/api/parental_dashboard.py:155:43: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
153 | async def delete_child_profile_endpoint(
154 |     child_id: UUID,
155 |     use_case: ManageChildProfileUseCase = Depends(get_manage_child_profile_use_case),
    |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
156 | ) -> None:
157 |     success = await use_case.delete_child_profile(child_id)
    |

src/presentation/api/parental_dashboard.py:169:45: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
167 |       theme: str = "adventure",
168 |       length: str = "short",
169 |       use_case: GenerateDynamicStoryUseCase = Depends(
    |  _____________________________________________^
170 | |         get_generate_dynamic_story_use_case
171 | |     ),
    | |_____^ B008
172 |   ) -> StoryResponse:
173 |       try:
    |

src/presentation/api/parental_dashboard.py:175:9: TRY300 Consider moving this statement to an `else` block
    |
173 |     try:
174 |         story_response = await use_case.execute(child_id, theme, length)
175 |         return story_response
    |         ^^^^^^^^^^^^^^^^^^^^^ TRY300
176 |     except ValueError as e:
177 |         error_handler = get_secure_error_handler()
    |

src/presentation/api/parental_dashboard.py:175:16: RET504 Unnecessary assignment to `story_response` before `return` statement
    |
173 |     try:
174 |         story_response = await use_case.execute(child_id, theme, length)
175 |         return story_response
    |                ^^^^^^^^^^^^^^ RET504
176 |     except ValueError as e:
177 |         error_handler = get_secure_error_handler()
    |
    = help: Remove unnecessary assignment

src/presentation/api/parental_dashboard.py:178:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
176 |       except ValueError as e:
177 |           error_handler = get_secure_error_handler()
178 | /         raise error_handler.create_safe_error_response(
179 | |             e,
180 | |             status.HTTP_404_NOT_FOUND,
181 | |             "Story not found or invalid parameters",
182 | |         )
    | |_________^ B904
183 |       except Exception as e:
184 |           error_handler = get_secure_error_handler()
    |

src/presentation/api/parental_dashboard.py:185:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
183 |       except Exception as e:
184 |           error_handler = get_secure_error_handler()
185 | /         raise error_handler.create_safe_error_response(
186 | |             e,
187 | |             status.HTTP_500_INTERNAL_SERVER_ERROR,
188 | |             "Failed to generate story",
189 | |         )
    | |_________^ B904
    |

src/presentation/api/parental_dashboard.py:197:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
195 |     consent_types: list[str],
196 |     verification_method: str = "email",
197 |     current_user: UserInfo = Depends(get_current_parent),
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
198 | ) -> dict[str, Any]:
199 |     try:
    |

src/presentation/api/parental_dashboard.py:216:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
214 |       except Exception as e:
215 |           error_handler = get_secure_error_handler()
216 | /         raise error_handler.create_safe_error_response(
217 | |             e,
218 | |             status.HTTP_500_INTERNAL_SERVER_ERROR,
219 | |             "Failed to request parental consent",
220 | |         )
    | |_________^ B904
    |

src/presentation/api/parental_dashboard.py:227:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
225 |     child_id: UUID,
226 |     request: ParentConsentRequest,
227 |     current_user: UserInfo = Depends(get_current_parent),
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
228 | ) -> dict[str, Any]:
229 |     try:
    |

src/presentation/api/parental_dashboard.py:261:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
259 |       except Exception as e:
260 |           error_handler = get_secure_error_handler()
261 | /         raise error_handler.create_safe_error_response(
262 | |             e, status.HTTP_400_BAD_REQUEST, "Failed to grant parental consent"
263 | |         )
    | |_________^ B904
    |

src/presentation/api/parental_dashboard.py:282:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
280 |       except Exception as e:
281 |           error_handler = get_secure_error_handler()
282 | /         raise error_handler.create_safe_error_response(
283 | |             e,
284 | |             status.HTTP_500_INTERNAL_SERVER_ERROR,
285 | |             "Failed to retrieve consent status",
286 | |         )
    | |_________^ B904
    |

src/presentation/api/parental_dashboard.py:293:30: B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    |
291 |     child_id: UUID,
292 |     consent_type: str,
293 |     current_user: UserInfo = Depends(get_current_parent),
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^ B008
294 | ) -> dict[str, Any]:
295 |     try:
    |

src/presentation/api/parental_dashboard.py:310:9: TRY301 Abstract `raise` to an inner function
    |
308 |                   "message": f"Consent for {consent_type} has been revoked",
309 |               }
310 | /         raise HTTPException(
311 | |             status_code=status.HTTP_404_NOT_FOUND,
312 | |             detail=f"Consent for {consent_type} not found",
313 | |         )
    | |_________^ TRY301
314 |       except HTTPException:
315 |           raise
    |

src/presentation/api/parental_dashboard.py:318:9: B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    |
316 |       except Exception as e:
317 |           error_handler = get_secure_error_handler()
318 | /         raise error_handler.create_safe_error_response(
319 | |             e,
320 | |             status.HTTP_500_INTERNAL_SERVER_ERROR,
321 | |             "Failed to revoke consent",
322 | |         )
    | |_________^ B904
    |

src/presentation/api/validators.py:17:19: TRY003 Avoid specifying long messages outside the exception class
   |
15 |       def validate_age(cls, v) -> int:
16 |           if v is not None and v > MAX_CHILD_AGE:
17 |               raise ValueError(
   |  ___________________^
18 | |                 f"Age must be {MAX_CHILD_AGE} or under for COPPA compliance",
19 | |             )
   | |_____________^ TRY003
20 |           return v
   |

src/presentation/api/validators.py:28:19: TRY003 Avoid specifying long messages outside the exception class
   |
26 |             return v
27 |         if not v or not v.strip():
28 |             raise ValueError("Name cannot be empty")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
29 |         sanitized_name = v.strip()
30 |         if any(char in sanitized_name for char in ["<", ">", "&", '"', "'", "\x00"]):
   |

src/presentation/api/validators.py:31:19: TRY003 Avoid specifying long messages outside the exception class
   |
29 |         sanitized_name = v.strip()
30 |         if any(char in sanitized_name for char in ["<", ">", "&", '"', "'", "\x00"]):
31 |             raise ValueError("Name contains invalid characters")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
32 |         dangerous_patterns = [
33 |             "--",
   |

src/presentation/api/validators.py:43:19: TRY003 Avoid specifying long messages outside the exception class
   |
41 |         name_upper = sanitized_name.upper()
42 |         if any(pattern in name_upper for pattern in dangerous_patterns):
43 |             raise ValueError("Name contains prohibited patterns")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
44 |         return sanitized_name
   |

src/presentation/api/validators.py:52:19: TRY003 Avoid specifying long messages outside the exception class
   |
50 |             return v
51 |         if len(v) > MAX_INTERESTS_COUNT:
52 |             raise ValueError(f"Maximum {MAX_INTERESTS_COUNT} interests allowed")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
53 |         sanitized_interests = []
54 |         for interest in v:
   |

src/presentation/api/validators.py:56:17: TRY004 Prefer `TypeError` exception for invalid type
   |
54 |         for interest in v:
55 |             if not isinstance(interest, str):
56 |                 raise ValueError("All interests must be strings")
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY004
57 |             sanitized_interest = interest.strip()
58 |             if not sanitized_interest:
   |

src/presentation/api/validators.py:56:23: TRY003 Avoid specifying long messages outside the exception class
   |
54 |         for interest in v:
55 |             if not isinstance(interest, str):
56 |                 raise ValueError("All interests must be strings")
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
57 |             sanitized_interest = interest.strip()
58 |             if not sanitized_interest:
   |

src/presentation/api/validators.py:63:23: TRY003 Avoid specifying long messages outside the exception class
   |
61 |                   char in sanitized_interest for char in ["<", ">", "&", '"', "'", "\x00"]
62 |               ):
63 |                   raise ValueError(
   |  _______________________^
64 | |                     f'Interest "{sanitized_interest}" contains invalid characters',
65 | |                 )
   | |_________________^ TRY003
66 |               if len(sanitized_interest) > 50:
67 |                   raise ValueError(
   |

src/presentation/api/validators.py:66:42: PLR2004 Magic value used in comparison, consider replacing `50` with a constant variable
   |
64 |                     f'Interest "{sanitized_interest}" contains invalid characters',
65 |                 )
66 |             if len(sanitized_interest) > 50:
   |                                          ^^ PLR2004
67 |                 raise ValueError(
68 |                     f'Interest "{sanitized_interest}" is too long (max 50 characters)',
   |

src/presentation/api/validators.py:67:23: TRY003 Avoid specifying long messages outside the exception class
   |
65 |                   )
66 |               if len(sanitized_interest) > 50:
67 |                   raise ValueError(
   |  _______________________^
68 | |                     f'Interest "{sanitized_interest}" is too long (max 50 characters)',
69 | |                 )
   | |_________________^ TRY003
70 |               sanitized_interests.append(sanitized_interest)
71 |           return sanitized_interests
   |

src/presentation/api/validators.py:77:19: TRY003 Avoid specifying long messages outside the exception class
   |
75 |     def validate_language(cls, v) -> str:
76 |         if v is not None and v not in ALLOWED_LANGUAGES:
77 |             raise ValueError(f"Language must be one of: {ALLOWED_LANGUAGES}")
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY003
78 |         return v
   |

src/presentation/api/websocket/__init__.py:1:1: D415 First line should end with a period, question mark, or exclamation point
  |
1 | """WebSocket Package"""
  | ^^^^^^^^^^^^^^^^^^^^^^^ D415
2 |
3 | from .handlers import router as websocket_router
  |
  = help: Add closing punctuation

src/presentation/routing.py:38:5: TRY400 Use `logging.exception` instead of `logging.error`
   |
36 |     )
37 | except ImportError as e:
38 |     logger.error(f"Failed to import API routers: {e}")
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ TRY400
39 |     # Set routers to None for graceful degradation
40 |     esp32_router = parental_router = health_router = chatgpt_router = auth_router = None
   |
   = help: Replace with `exception`

src/presentation/schemas/parent_schemas.py:23:11: D106 Missing docstring in public nested class
   |
21 |     parent_id: UUID
22 |
23 |     class Config:
   |           ^^^^^^ D106
24 |         from_attributes = True
   |

venv:1:1: E902 No such file or directory (os error 2)
Found 3818 errors.
[*] 597 fixable with the `--fix` option (769 hidden fixes can be enabled with the `--unsafe-fixes` option).

```

⏱️ الوقت المستغرق: 2.24 ثانية


---

## التحقق من أنواع البيانات (MyPy)
```bash
mypy src/ --exclude .venv|venv|__pycache__|build|dist|.mypy_cache|node_modules|.git
```

_Error or No results._
```
/bin/sh: 1: venv: not found
/bin/sh: 1: __pycache__: Permission denied
/bin/sh: 1: build: not found
/bin/sh: 1: .mypy_cache: not found
/bin/sh: 1: dist: not found
/bin/sh: 1: .git: not found
/bin/sh: 1: node_modules: Permission denied

```

⏱️ الوقت المستغرق: 7.22 ثانية


---

## الـ dead code (Vulture)
```bash
vulture src --exclude .venv --exclude venv --exclude __pycache__ --exclude build --exclude dist --exclude .mypy_cache --exclude node_modules --exclude .git
```

_Error or No results._
```
src/application/interfaces/infrastructure_services.py:5: unexpected indent at "@abstractmethod"
src/infrastructure/logging/standards.py:11: unexpected indent at """"Standard log categories for the system.""""
src/infrastructure/persistence/database_service_orchestrator.py:13: invalid syntax at "from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import ("
src/infrastructure/persistence/repositories/__init__.py:9: invalid syntax at "from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import ("
src/presentation/api/emergency_response/main.py:65: invalid syntax at "global ("
src/presentation/api/endpoints/chatgpt.py:261: closing parenthesis ']' does not match opening parenthesis '{' on line 252 at "],"
src/api/endpoints/voice_models.py:4: unused class 'VoiceResponse' (60% confidence)
src/api/endpoints/voice_models.py:25: unused variable 'child_appropriate' (60% confidence)
src/api/endpoints/voice_models.py:35: unused variable 'child_appropriate' (60% confidence)
src/application/dto/ai_response.py:10: unused variable 'audio_response' (60% confidence)
src/application/dto/child_data.py:61: unused variable 'last_interaction' (60% confidence)
src/application/dto/child_data.py:111: unused method 'should_purge_data' (60% confidence)
src/application/dto/esp32/esp32_data.py:7: unused class 'ESP32SensorReadingDTO' (60% confidence)
src/application/dto/esp32/esp32_data.py:11: unused variable 'light_level' (60% confidence)
src/application/dto/esp32/esp32_data.py:12: unused variable 'sound_level' (60% confidence)
src/application/dto/esp32/esp32_data.py:16: unused class 'ESP32VoiceCommandDTO' (60% confidence)
src/application/dto/esp32/esp32_data.py:23: unused class 'ESP32GestureEventDTO' (60% confidence)
src/application/dto/esp32/esp32_data.py:28: unused variable 'axis_data' (60% confidence)
src/application/dto/esp32/esp32_data.py:31: unused class 'ESP32FirmwareUpdateStatusDTO' (60% confidence)
src/application/dto/esp32/esp32_data.py:34: unused variable 'update_version' (60% confidence)
src/application/dto/esp32/esp32_data.py:36: unused variable 'progress' (60% confidence)
src/application/dto/esp32/esp32_data.py:40: unused class 'ESP32DeviceStatusDTO' (60% confidence)
src/application/dto/esp32/esp32_data.py:43: unused variable 'is_online' (60% confidence)
src/application/dto/esp32/esp32_data.py:46: unused variable 'last_seen' (60% confidence)
src/application/dto/esp32/esp32_data.py:47: unused variable 'mesh_network_status' (60% confidence)
src/application/dto/esp32/esp32_data.py:50: unused class 'ESP32EdgeAIResultDTO' (60% confidence)
src/application/dto/esp32/esp32_data.py:51: unused variable 'model_config' (60% confidence)
src/application/dto/esp32/esp32_data.py:56: unused variable 'result_value' (60% confidence)
src/application/dto/esp32/esp32_data.py:58: unused variable 'raw_output' (60% confidence)
src/application/dto/esp32_request.py:22: unused variable 'text_input' (60% confidence)
src/application/dto/story_response.py:13: unused variable 'story_text' (60% confidence)
src/application/dto/story_response.py:14: unused variable 'audio_url' (60% confidence)
src/application/event_handlers/child_profile_event_handlers.py:27: unused class 'ChildProfileEventHandlers' (60% confidence)
src/application/event_handlers/child_profile_event_handlers.py:36: unused method 'handle_child_registered' (60% confidence)
src/application/event_handlers/child_profile_event_handlers.py:63: unused method 'handle_child_profile_updated' (60% confidence)
src/application/interfaces/ai_provider.py:29: unused method 'supports_asr_model' (60% confidence)
src/application/interfaces/ai_provider.py:31: unused method 'transcribe_audio' (60% confidence)
src/application/interfaces/ai_provider.py:35: unused method 'determine_activity_type' (60% confidence)
src/application/interfaces/ai_provider.py:39: unused variable 'session_context' (100% confidence)
src/application/interfaces/ai_provider.py:45: unused variable 'personality_profile' (100% confidence)
src/application/interfaces/read_model_interfaces.py:46: unused method 'delete_by_id' (60% confidence)
src/application/interfaces/read_model_interfaces.py:72: unused method 'get_consent_status' (60% confidence)
src/application/interfaces/read_model_interfaces.py:92: unused function 'get_read_model_store' (60% confidence)
src/application/interfaces/read_model_interfaces.py:116: unused function 'get_settings_provider' (60% confidence)
src/application/interfaces/security/encryption_interfaces.py:7: unused class 'HomomorphicEncryptionService' (60% confidence)
src/application/interfaces/security/encryption_interfaces.py:17: unused variable 'ciphertext1' (100% confidence)
src/application/interfaces/security/encryption_interfaces.py:17: unused variable 'ciphertext2' (100% confidence)
src/application/interfaces/security/encryption_interfaces.py:20: unused method 'multiply' (60% confidence)
src/application/interfaces/security/encryption_interfaces.py:21: unused variable 'ciphertext1' (100% confidence)
src/application/interfaces/security/encryption_interfaces.py:21: unused variable 'ciphertext2' (100% confidence)
src/application/interfaces/security/encryption_interfaces.py:25: unused class 'ZeroKnowledgeProofService' (60% confidence)
src/application/interfaces/security/encryption_interfaces.py:26: unused method 'generate_proof' (60% confidence)
src/application/interfaces/security/encryption_interfaces.py:29: unused variable 'statement' (100% confidence)
src/application/interfaces/security/encryption_interfaces.py:30: unused variable 'private_inputs' (100% confidence)
src/application/interfaces/security/encryption_interfaces.py:34: unused method 'verify_proof' (60% confidence)
src/application/interfaces/security/encryption_interfaces.py:35: unused variable 'proof' (100% confidence)
src/application/interfaces/security/encryption_interfaces.py:35: unused variable 'statement' (100% confidence)
src/application/interfaces/text_to_speech_service.py:25: unused method 'list_voices' (60% confidence)
src/application/services/accessibility_service.py:26: unused class 'AccessibilityService' (60% confidence)
src/application/services/accessibility_service.py:47: unused method 'create_accessibility_profile' (60% confidence)
src/application/services/accessibility_service.py:78: unused method 'get_accessibility_profile' (60% confidence)
src/application/services/accessibility_service.py:101: unused method '_get_adaptations' (60% confidence)
src/application/services/accessibility_service.py:119: unused method '_get_accessibility_settings' (60% confidence)
src/application/services/advanced_personalization_service.py:27: unused class 'AdvancedPersonalizationService' (60% confidence)
src/application/services/advanced_personalization_service.py:49: unused method 'create_personality_profile' (60% confidence)
src/application/services/advanced_personalization_service.py:90: unused method 'get_personalized_content' (60% confidence)
src/application/services/advanced_progress_analyzer.py:21: unused variable 'skill_level' (60% confidence)
src/application/services/advanced_progress_analyzer.py:22: unused variable 'improvement_rate' (60% confidence)
src/application/services/advanced_progress_analyzer.py:23: unused variable 'strengths' (60% confidence)
src/application/services/advanced_progress_analyzer.py:24: unused variable 'areas_for_improvement' (60% confidence)
src/application/services/advanced_progress_analyzer.py:27: unused class 'AdvancedProgressAnalyzer' (60% confidence)
src/application/services/advanced_progress_analyzer.py:35: unused method 'analyze_progress' (60% confidence)
src/application/services/advanced_progress_analyzer.py:66: unused method 'get_progress_report' (60% confidence)
src/application/services/ai/main_service.py:24: unused class 'AITeddyBearService' (60% confidence)
src/application/services/ai/main_service.py:81: unused attribute 'cached' (60% confidence)
src/application/services/ai/modules/response_generator.py:31: unused class 'ResponseGenerator' (60% confidence)
src/application/services/ai/modules/transcription_service.py:33: unused class 'TranscriptionService' (60% confidence)
src/application/services/ai/modules/transcription_service.py:69: unused attribute 'energy_threshold' (60% confidence)
src/application/services/ai/modules/transcription_service.py:72: unused attribute 'dynamic_energy_threshold' (60% confidence)
src/application/services/ai/modules/transcription_service.py:81: unused method 'transcribe_audio' (60% confidence)
src/application/services/ai/modules/transcription_service.py:291: unused method 'get_supported_languages' (60% confidence)
src/application/services/audit_service.py:75: unused method 'get_audit_logs' (60% confidence)
src/application/services/base_service.py:16: unused class 'BaseService' (60% confidence)
src/application/services/base_service.py:39: unused method 'log_info' (60% confidence)
src/application/services/cleanup_service.py:18: unused class 'CleanupService' (60% confidence)
src/application/services/cleanup_service.py:38: unused method '_is_safe_path' (60% confidence)
src/application/services/cleanup_service.py:58: unused method 'cleanup_old_data' (60% confidence)
src/application/services/consent/consent_models.py:15: unused variable 'CREDIT_CARD_VERIFICATION' (60% confidence)
src/application/services/consent/consent_models.py:16: unused variable 'DIGITAL_SIGNATURE' (60% confidence)
src/application/services/consent/consent_models.py:17: unused variable 'VIDEO_CALL_VERIFICATION' (60% confidence)
src/application/services/consent/consent_models.py:18: unused variable 'GOVERNMENT_ID_VERIFICATION' (60% confidence)
src/application/services/consent/consent_models.py:25: unused variable 'IN_PROGRESS' (60% confidence)
src/application/services/consent/consent_models.py:39: unused variable 'attempted_at' (60% confidence)
src/application/services/consent/consent_models.py:40: unused variable 'completed_at' (60% confidence)
src/application/services/consent/consent_models.py:41: unused variable 'failure_reason' (60% confidence)
src/application/services/consent/consent_service.py:99: unused method 'check_consent_status' (60% confidence)
src/application/services/consent/consent_service.py:147: unused method 'initiate_email_verification' (60% confidence)
src/application/services/consent/consent_service.py:162: unused method 'initiate_sms_verification' (60% confidence)
src/application/services/consent/consent_service.py:174: unused method 'complete_verification' (60% confidence)
src/application/services/consent/consent_service.py:188: unused method 'get_consent_audit_trail' (60% confidence)
src/application/services/consent/verification_service.py:28: unused attribute 'verification_codes' (60% confidence)
src/application/services/consent/verification_service.py:108: unused attribute 'completed_at' (60% confidence)
src/application/services/consent/verification_service.py:112: unused attribute 'failure_reason' (60% confidence)
src/application/services/content_filter_service.py:18: unused class 'ContentFilterService' (60% confidence)
src/application/services/content_filter_service.py:37: unused method 'filter_content' (60% confidence)
src/application/services/conversation_service.py:110: unused method 'update_conversation_summary' (60% confidence)
src/application/services/coppa/coppa_compliance_service.py:403: unused method 'get_compliance_status' (60% confidence)
src/application/services/coppa/coppa_compliance_service.py:413: unused method 'get_audit_log' (60% confidence)
src/application/services/data_export/formatters.py:35: unused method 'get_mime_type' (60% confidence)
src/application/services/data_export/formatters.py:75: unused method 'get_mime_type' (60% confidence)
src/application/services/data_export/formatters.py:143: unused method 'get_mime_type' (60% confidence)
src/application/services/data_export/formatters.py:229: unused method 'get_mime_type' (60% confidence)
src/application/services/data_export/formatters.py:303: unused method 'get_mime_type' (60% confidence)
src/application/services/data_export/formatters.py:307: unused class 'FormatterFactory' (60% confidence)
src/application/services/data_export/formatters.py:310: unused method 'create_formatter' (60% confidence)
src/application/services/data_export/types.py:16: unused variable 'PDF' (60% confidence)
src/application/services/data_export/types.py:23: unused variable 'PROFILE' (60% confidence)
src/application/services/data_export/types.py:24: unused variable 'CONVERSATIONS' (60% confidence)
src/application/services/data_export/types.py:25: unused variable 'SAFETY_EVENTS' (60% confidence)
src/application/services/data_export/types.py:26: unused variable 'USAGE_STATISTICS' (60% confidence)
src/application/services/data_export/types.py:27: unused variable 'MEDICAL_NOTES' (60% confidence)
src/application/services/data_export/types.py:28: unused variable 'EMERGENCY_CONTACTS' (60% confidence)
src/application/services/data_export/types.py:29: unused variable 'PARENTAL_CONSENTS' (60% confidence)
src/application/services/data_export/types.py:30: unused variable 'ALL' (60% confidence)
src/application/services/data_export/types.py:37: unused variable 'IN_PROGRESS' (60% confidence)
src/application/services/data_export/types.py:40: unused variable 'CANCELLED' (60% confidence)
src/application/services/data_export/types.py:49: unused variable 'formats' (60% confidence)
src/application/services/data_export/types.py:51: unused variable 'date_range_start' (60% confidence)
src/application/services/data_export/types.py:52: unused variable 'date_range_end' (60% confidence)
src/application/services/data_export/types.py:53: unused variable 'include_deleted' (60% confidence)
src/application/services/data_export/types.py:54: unused variable 'anonymize_data' (60% confidence)
src/application/services/data_export/types.py:66: unused variable 'completed_at' (60% confidence)
src/application/services/data_export/types.py:67: unused variable 'file_size_bytes' (60% confidence)
src/application/services/data_export/types.py:68: unused variable 'download_url' (60% confidence)
src/application/services/data_export/types.py:71: unused variable 'categories_exported' (60% confidence)
src/application/services/data_export/types.py:72: unused variable 'formats_generated' (60% confidence)
src/application/services/data_export/types.py:84: unused variable 'date_range' (60% confidence)
src/application/services/data_export_service.py:29: unused class 'DataExportService' (60% confidence)
src/application/services/data_export_service.py:89: unused method 'request_export' (60% confidence)
src/application/services/data_export_service.py:115: unused attribute 'completed_at' (60% confidence)
src/application/services/data_export_service.py:120: unused attribute 'completed_at' (60% confidence)
src/application/services/data_export_service.py:125: unused method 'get_export_status' (60% confidence)
src/application/services/dynamic_content_service.py:24: unused class 'DynamicContentService' (60% confidence)
src/application/services/dynamic_content_service.py:44: unused method 'generate_personalized_story' (60% confidence)
src/application/services/dynamic_content_service.py:96: unused method 'generate_educational_content' (60% confidence)
src/application/services/dynamic_content_service.py:144: unused method 'get_interactive_activity' (60% confidence)
src/application/services/dynamic_story_service.py:12: unused class 'DynamicStoryService' (60% confidence)
src/application/services/esp32_device_service.py:27: unused class 'ESP32DeviceService' (60% confidence)
src/application/services/esp32_device_service.py:46: unused method 'process_sensor_reading' (60% confidence)
src/application/services/esp32_device_service.py:71: unused method 'process_voice_command' (60% confidence)
src/application/services/esp32_device_service.py:96: unused method 'process_gesture_event' (60% confidence)
src/application/services/esp32_device_service.py:121: unused method 'process_firmware_update_status' (60% confidence)
src/application/services/esp32_device_service.py:146: unused method 'process_device_status' (60% confidence)
src/application/services/esp32_device_service.py:168: unused method 'process_edge_ai_result' (60% confidence)
src/application/services/feature_service.py:29: unused class 'FeatureService' (60% confidence)
src/application/services/feature_service.py:51: unused method 'enable_feature' (60% confidence)
src/application/services/feature_service.py:114: unused method 'disable_feature' (60% confidence)
src/application/services/feature_service.py:147: unused method 'get_feature_status' (60% confidence)
src/application/services/federated_learning_service.py:21: unused class 'FederatedLearningService' (60% confidence)
src/application/services/federated_learning_service.py:89: unused method 'process_local_model_update' (60% confidence)
src/application/services/federated_learning_service.py:137: unused method 'get_global_model' (60% confidence)
src/application/services/incident_service.py:13: unused class 'IncidentService' (60% confidence)
src/application/services/incident_service.py:20: unused method 'report_incident' (60% confidence)
src/application/services/incident_service.py:40: unused method 'get_incident' (60% confidence)
src/application/services/incident_service.py:55: unused method 'resolve_incident' (60% confidence)
src/application/services/interaction_service.py:29: unused class 'InteractionService' (60% confidence)
src/application/services/interaction_service.py:56: unused method 'process' (60% confidence)
src/application/services/notification_service.py:43: unused variable 'SAFETY_ALERT' (60% confidence)
src/application/services/notification_service.py:44: unused variable 'PARENT_UPDATE' (60% confidence)
src/application/services/notification_service.py:46: unused variable 'INTERACTION_SUMMARY' (60% confidence)
src/application/services/notification_service.py:265: unused method 'get_notification_history' (60% confidence)
src/application/services/parent_child_verification_service.py:24: unused function 'get_verification_service' (60% confidence)
src/application/services/parent_child_verification_service.py:34: unused function 'get_relationship_manager' (60% confidence)
src/application/services/safety.py:32: unused class 'SafetyService' (60% confidence)
src/application/services/safety.py:81: unused attribute 'content_category' (60% confidence)
src/application/services/safety.py:137: unused attribute 'content_category' (60% confidence)
src/application/services/safety.py:307: unused method 'get_metrics' (60% confidence)
src/application/services/session/session_manager.py:34: unused attribute '_manager_lock' (60% confidence)
src/application/services/session/session_manager.py:36: unused method 'start_cleanup_task' (60% confidence)
src/application/services/session/session_manager.py:41: unused method 'stop_cleanup_task' (60% confidence)
src/application/services/session/session_manager.py:48: unused method 'create_session' (60% confidence)
src/application/services/session/session_manager.py:97: unused method 'update_session' (60% confidence)
src/application/services/session/session_manager.py:132: unused method 'end_session' (60% confidence)
src/application/services/session/session_manager.py:172: unused method 'get_session_stats' (60% confidence)
src/application/services/session/session_models.py:18: unused variable 'SUSPENDED' (60% confidence)
src/application/services/session/session_models.py:53: unused method 'get_session_duration' (60% confidence)
src/application/services/session/session_models.py:76: unused variable 'total_sessions' (60% confidence)
src/application/services/session/session_models.py:78: unused variable 'expired_sessions' (60% confidence)
src/application/services/session/session_models.py:79: unused variable 'average_duration_minutes' (60% confidence)
src/application/services/session/session_models.py:80: unused variable 'total_interactions' (60% confidence)
src/application/services/session/session_models.py:81: unused variable 'average_safety_score' (60% confidence)
src/application/services/transcription_models.py:14: unused class 'TranscriptionResult' (60% confidence)
src/application/services/transcription_models.py:21: unused variable 'provider' (60% confidence)
src/application/services/transcription_models.py:23: unused variable 'audio_duration_ms' (60% confidence)
src/application/services/transcription_models.py:24: unused variable 'segments' (60% confidence)
src/application/services/verification/relationship_manager.py:104: unused attribute 'verified_at' (60% confidence)
src/application/services/verification/verification_models.py:15: unused variable 'DENIED' (60% confidence)
src/application/services/verification/verification_models.py:17: unused variable 'SUSPENDED' (60% confidence)
src/application/services/verification/verification_models.py:23: unused variable 'BIOLOGICAL_PARENT' (60% confidence)
src/application/services/verification/verification_models.py:24: unused variable 'ADOPTIVE_PARENT' (60% confidence)
src/application/services/verification/verification_models.py:25: unused variable 'LEGAL_GUARDIAN' (60% confidence)
src/application/services/verification/verification_models.py:27: unused variable 'CUSTODIAL_PARENT' (60% confidence)
src/application/services/verification/verification_models.py:39: unused variable 'attempted_at' (60% confidence)
src/application/services/verification/verification_models.py:40: unused variable 'completed_at' (60% confidence)
src/application/services/verification/verification_models.py:41: unused variable 'evidence_provided' (60% confidence)
src/application/services/verification/verification_models.py:54: unused variable 'verified_at' (60% confidence)
src/application/services/verification/verification_models.py:57: unused variable 'emergency_contact' (60% confidence)
src/application/services/verification/verification_service.py:37: unused method 'establish_relationship' (60% confidence)
src/application/services/verification/verification_service.py:79: unused method 'verify_parent_child_relationship' (60% confidence)
src/application/services/verification/verification_service.py:148: unused method 'get_child_guardians' (60% confidence)
src/application/services/verification/verification_service.py:163: unused method 'approve_relationship' (60% confidence)
src/application/services/verification/verification_service.py:227: unused method 'get_access_audit_trail' (60% confidence)
src/application/services/voice_service.py:24: unused class 'VoiceService' (60% confidence)
src/application/use_cases/generate_ai_response.py:11: unused class 'GenerateAIResponseUseCase' (60% confidence)
src/application/use_cases/generate_ai_response.py:77: unused attribute 'audio_response' (60% confidence)
src/application/use_cases/process_esp32_audio.py:174: unused attribute 'audio_response' (60% confidence)
src/common/constants.py:10: unused variable 'DEFAULT_SAFETY_SCORE' (60% confidence)
src/common/constants.py:11: unused variable 'MIN_SAFETY_THRESHOLD' (60% confidence)
src/common/constants.py:14: unused variable 'DEFAULT_DB_POOL_SIZE' (60% confidence)
src/common/constants.py:15: unused variable 'DEFAULT_DB_MAX_OVERFLOW' (60% confidence)
src/common/constants.py:16: unused variable 'DEFAULT_DB_POOL_RECYCLE' (60% confidence)
src/common/constants.py:17: unused variable 'DEFAULT_CONNECTION_TIMEOUT' (60% confidence)
src/common/constants.py:20: unused variable 'DEFAULT_REQUESTS_PER_MINUTE' (60% confidence)
src/common/constants.py:21: unused variable 'DEFAULT_REQUESTS_PER_HOUR' (60% confidence)
src/common/constants.py:22: unused variable 'DEFAULT_REQUESTS_PER_DAY' (60% confidence)
src/common/constants.py:23: unused variable 'DEFAULT_BURST_LIMIT' (60% confidence)
src/common/constants.py:24: unused variable 'DEFAULT_BLOCK_DURATION_MINUTES' (60% confidence)
src/common/constants.py:27: unused variable 'MAX_AI_RESPONSE_TOKENS' (60% confidence)
src/common/constants.py:28: unused variable 'MAX_STORY_TOKENS' (60% confidence)
src/common/constants.py:29: unused variable 'DEFAULT_AI_TIMEOUT' (60% confidence)
src/common/constants.py:30: unused variable 'MAX_CONVERSATION_HISTORY' (60% confidence)
src/common/constants.py:33: unused variable 'DEFAULT_SESSION_TIMEOUT' (60% confidence)
src/common/constants.py:34: unused variable 'MAX_CONCURRENT_SESSIONS' (60% confidence)
src/common/constants.py:35: unused variable 'SESSION_CLEANUP_INTERVAL' (60% confidence)
src/common/constants.py:40: unused variable 'ALLOWED_AUDIO_FORMATS' (60% confidence)
src/common/constants.py:41: unused variable 'ALLOWED_IMAGE_FORMATS' (60% confidence)
src/common/constants.py:44: unused variable 'DATA_RETENTION_DAYS' (60% confidence)
src/common/constants.py:45: unused variable 'PARENTAL_CONSENT_VALIDITY_DAYS' (60% confidence)
src/common/constants.py:46: unused variable 'AUDIT_LOG_RETENTION_DAYS' (60% confidence)
src/common/constants.py:47: unused variable 'MIN_PARENT_AGE' (60% confidence)
src/common/constants.py:50: unused variable 'METRICS_COLLECTION_INTERVAL' (60% confidence)
src/common/constants.py:51: unused variable 'PERFORMANCE_ALERT_THRESHOLD' (60% confidence)
src/common/constants.py:52: unused variable 'MAX_MEMORY_USAGE_MB' (60% confidence)
src/common/constants.py:53: unused variable 'MAX_CPU_USAGE_PERCENT' (60% confidence)
src/common/constants.py:56: unused variable 'DEFAULT_CACHE_TTL' (60% confidence)
src/common/constants.py:57: unused variable 'FREQUENT_DATA_CACHE_TTL' (60% confidence)
src/common/constants.py:58: unused variable 'REDIS_MAX_CONNECTIONS' (60% confidence)
src/common/constants.py:59: unused variable 'CACHE_KEY_PREFIX' (60% confidence)
src/common/constants.py:62: unused variable 'JWT_EXPIRATION_HOURS' (60% confidence)
src/common/constants.py:63: unused variable 'REFRESH_TOKEN_DAYS' (60% confidence)
src/common/constants.py:65: unused variable 'PASSWORD_MAX_ATTEMPTS' (60% confidence)
src/common/constants.py:66: unused variable 'ACCOUNT_LOCKOUT_MINUTES' (60% confidence)
src/common/constants.py:69: unused variable 'MAX_RESPONSE_SIZE_KB' (60% confidence)
src/common/constants.py:70: unused variable 'API_VERSION' (60% confidence)
src/common/constants.py:71: unused variable 'DEFAULT_PAGE_SIZE' (60% confidence)
src/common/constants.py:72: unused variable 'MAX_PAGE_SIZE' (60% confidence)
src/common/constants.py:75: unused variable 'PROFANITY_FILTER_STRICTNESS' (60% confidence)
src/common/constants.py:76: unused variable 'CONTENT_MODERATION_THRESHOLD' (60% confidence)
src/common/constants.py:77: unused variable 'VIOLENCE_DETECTION_THRESHOLD' (60% confidence)
src/common/constants.py:78: unused variable 'INAPPROPRIATE_CONTENT_THRESHOLD' (60% confidence)
src/common/constants.py:81: unused variable 'LOG_ROTATION_SIZE_MB' (60% confidence)
src/common/constants.py:82: unused variable 'LOG_RETENTION_DAYS' (60% confidence)
src/common/constants.py:83: unused variable 'LOG_LEVEL_PRODUCTION' (60% confidence)
src/common/constants.py:84: unused variable 'LOG_LEVEL_DEVELOPMENT' (60% confidence)
src/common/constants.py:113: unused variable 'MAX_ERROR_MESSAGE_LENGTH' (60% confidence)
src/common/constants.py:114: unused variable 'ERROR_RETRY_ATTEMPTS' (60% confidence)
src/common/constants.py:115: unused variable 'ERROR_RETRY_DELAY_SECONDS' (60% confidence)
src/common/constants.py:116: unused variable 'CIRCUIT_BREAKER_FAILURE_THRESHOLD' (60% confidence)
src/common/constants.py:120: unused class 'EventStoreType' (60% confidence)
src/common/constants.py:121: unused variable 'KAFKA' (60% confidence)
src/common/constants.py:122: unused variable 'POSTGRES' (60% confidence)
src/common/constants.py:126: unused variable 'HEALTH_CHECK_TIMEOUT' (60% confidence)
src/common/constants.py:127: unused variable 'DEPENDENCY_CHECK_TIMEOUT' (60% confidence)
src/common/constants.py:128: unused variable 'HEALTH_CHECK_INTERVAL' (60% confidence)
src/domain/analytics.py:24: unused class 'ChildAnalytics' (60% confidence)
src/domain/analytics.py:32: unused method 'calculate_emotion_stability' (60% confidence)
src/domain/analytics.py:68: unused method 'get_speech_concerns' (60% confidence)
src/domain/analytics.py:162: unused method 'record_emotion_data' (60% confidence)
src/domain/analytics.py:180: unused method 'record_speech_data' (60% confidence)
src/domain/constants.py:9: unused variable 'MAXIMUM_CHILD_AGE' (60% confidence)
src/domain/constants.py:13: unused variable 'DEFAULT_RETENTION_DAYS' (60% confidence)
src/domain/constants.py:14: unused variable 'MINIMUM_RETENTION_DAYS' (60% confidence)
src/domain/constants.py:17: unused variable 'TODDLER_MAX_AGE' (60% confidence)
src/domain/constants.py:18: unused variable 'PRESCHOOL_MAX_AGE' (60% confidence)
src/domain/constants.py:19: unused variable 'EARLY_CHILD_MAX_AGE' (60% confidence)
src/domain/constants.py:20: unused variable 'MIDDLE_CHILD_MAX_AGE' (60% confidence)
src/domain/constants.py:21: unused variable 'PRETEEN_MAX_AGE' (60% confidence)
src/domain/constants.py:24: unused variable 'MAX_SESSION_MINUTES_TODDLER' (60% confidence)
src/domain/constants.py:25: unused variable 'MAX_SESSION_MINUTES_PRESCHOOL' (60% confidence)
src/domain/constants.py:26: unused variable 'MAX_SESSION_MINUTES_EARLY' (60% confidence)
src/domain/constants.py:27: unused variable 'MAX_SESSION_MINUTES_MIDDLE' (60% confidence)
src/domain/constants.py:28: unused variable 'MAX_SESSION_MINUTES_PRETEEN' (60% confidence)
src/domain/constants.py:33: unused variable 'MIN_CHILD_VOCABULARY_SIZE' (60% confidence)
src/domain/constants.py:34: unused variable 'VOCABULARY_WORDS_PER_MONTH' (60% confidence)
src/domain/constants.py:38: unused variable 'MAX_REQUESTS_PER_HOUR' (60% confidence)
src/domain/constants.py:39: unused variable 'MAX_REQUESTS_PER_DAY' (60% confidence)
src/domain/constants.py:43: unused variable 'MAX_AUDIO_FILE_SIZE_BYTES' (60% confidence)
src/domain/constants.py:46: unused variable 'LOG_RETENTION_DAYS' (60% confidence)
src/domain/constants.py:47: unused variable 'BACKUP_COUNT_DAYS' (60% confidence)
src/domain/constants.py:49: unused variable 'MAX_LOG_FILE_SIZE_BYTES' (60% confidence)
src/domain/constants.py:52: unused variable 'PG_RATING_AGE' (60% confidence)
src/domain/constants.py:53: unused variable 'RETRY_AFTER_SECONDS' (60% confidence)
src/domain/contracts.py:5: unused class 'ContractTest' (60% confidence)
src/domain/contracts.py:8: unused variable 'contract' (60% confidence)
src/domain/contracts.py:10: unused variable 'expected_status' (60% confidence)
src/domain/contracts.py:11: unused variable 'expected_response_keys' (60% confidence)
src/domain/contracts.py:14: unused class 'ContractResult' (60% confidence)
src/domain/contracts.py:16: unused variable 'test_name' (60% confidence)
src/domain/contracts.py:17: unused variable 'contract_name' (60% confidence)
src/domain/contracts.py:19: unused variable 'request_sent' (60% confidence)
src/domain/contracts.py:20: unused variable 'response_received' (60% confidence)
src/domain/contracts.py:21: unused variable 'response_status' (60% confidence)
src/domain/contracts.py:23: unused variable 'execution_time' (60% confidence)
src/domain/entities/audio_session.py:14: unused class 'AudioSession' (60% confidence)
src/domain/entities/audio_session.py:24: unused variable 'processed' (60% confidence)
src/domain/entities/audio_session.py:49: unused method 'mark_processed' (60% confidence)
src/domain/entities/audio_session.py:57: unused attribute 'processed' (60% confidence)
src/domain/entities/child.py:54: unused variable 'personality_traits' (60% confidence)
src/domain/entities/child.py:55: unused variable 'learning_preferences' (60% confidence)
src/domain/entities/child.py:56: unused variable 'communication_style' (60% confidence)
src/domain/entities/child.py:59: unused variable 'last_interaction' (60% confidence)
src/domain/entities/child.py:62: unused variable 'language_preference' (60% confidence)
src/domain/entities/child.py:63: unused variable 'cultural_background' (60% confidence)
src/domain/entities/child.py:65: unused variable 'emergency_contacts' (60% confidence)
src/domain/entities/child.py:66: unused variable 'medical_notes' (60% confidence)
src/domain/entities/child.py:67: unused variable 'educational_level' (60% confidence)
src/domain/entities/child.py:70: unused variable 'privacy_settings' (60% confidence)
src/domain/entities/child.py:71: unused variable 'custom_settings' (60% confidence)
src/domain/entities/child.py:101: unused method 'update_interaction_time' (60% confidence)
src/domain/entities/child.py:109: unused attribute 'last_interaction' (60% confidence)
src/domain/entities/child.py:111: unused method 'is_interaction_time_exceeded' (60% confidence)
src/domain/entities/child.py:122: unused method 'add_allowed_topic' (60% confidence)
src/domain/entities/child.py:132: unused method 'add_restricted_topic' (60% confidence)
src/domain/entities/child.py:142: unused method 'update_parental_controls' (60% confidence)
src/domain/entities/child.py:151: unused method 'deactivate_profile' (60% confidence)
src/domain/entities/child.py:155: unused method 'activate_profile' (60% confidence)
src/domain/entities/child_profile.py:84: unused method 'clear_uncommitted_events' (60% confidence)
src/domain/entities/conversation.py:16: unused class 'InteractionType' (60% confidence)
src/domain/entities/conversation.py:19: unused variable 'VOICE' (60% confidence)
src/domain/entities/conversation.py:20: unused variable 'TEXT' (60% confidence)
src/domain/entities/conversation.py:64: unused method 'end_conversation' (60% confidence)
src/domain/entities/emotion.py:11: unused class 'EmotionType' (60% confidence)
src/domain/entities/emotion.py:14: unused variable 'HAPPY' (60% confidence)
src/domain/entities/emotion.py:15: unused variable 'SAD' (60% confidence)
src/domain/entities/emotion.py:16: unused variable 'NEUTRAL' (60% confidence)
src/domain/entities/emotion.py:17: unused variable 'EXCITED' (60% confidence)
src/domain/entities/encrypted_child.py:17: unused class 'EncryptedChild' (60% confidence)
src/domain/entities/encrypted_child.py:26: unused variable 'personality_traits' (60% confidence)
src/domain/entities/encrypted_child.py:27: unused variable 'learning_preferences' (60% confidence)
src/domain/entities/encrypted_child.py:28: unused variable 'communication_style' (60% confidence)
src/domain/entities/encrypted_child.py:31: unused variable 'last_interaction' (60% confidence)
src/domain/entities/encrypted_child.py:34: unused variable 'language_preference' (60% confidence)
src/domain/entities/encrypted_child.py:35: unused variable 'cultural_background' (60% confidence)
src/domain/entities/encrypted_child.py:40: unused variable 'educational_level' (60% confidence)
src/domain/entities/encrypted_child.py:43: unused variable 'privacy_settings' (60% confidence)
src/domain/entities/encrypted_child.py:44: unused variable 'custom_settings' (60% confidence)
src/domain/entities/encrypted_child.py:48: unused method 'set_emergency_contacts' (60% confidence)
src/domain/entities/encrypted_child.py:66: unused method 'get_emergency_contacts' (60% confidence)
src/domain/entities/encrypted_child.py:83: unused method 'set_medical_notes' (60% confidence)
src/domain/entities/encrypted_child.py:94: unused method 'get_medical_notes' (60% confidence)
src/domain/entities/encrypted_child.py:108: unused method 'update_interaction_time' (60% confidence)
src/domain/entities/encrypted_child.py:116: unused attribute 'last_interaction' (60% confidence)
src/domain/entities/encrypted_child.py:119: unused method 'is_interaction_time_exceeded' (60% confidence)
src/domain/entities/encrypted_child.py:132: unused method 'add_allowed_topic' (60% confidence)
src/domain/entities/encrypted_child.py:143: unused method 'add_restricted_topic' (60% confidence)
src/domain/entities/encrypted_child.py:154: unused method 'update_parental_controls' (60% confidence)
src/domain/entities/encrypted_child.py:164: unused method 'deactivate_profile' (60% confidence)
src/domain/entities/encrypted_child.py:169: unused method 'activate_profile' (60% confidence)
src/domain/entities/parent_profile/entities.py:9: unused class 'Parent' (60% confidence)
src/domain/entities/parent_profile/entities.py:81: unused method 'get_display_name' (60% confidence)
src/domain/entities/parent_profile/entities.py:89: unused method 'add_child' (60% confidence)
src/domain/entities/parent_profile/entities.py:106: unused method 'remove_child' (60% confidence)
src/domain/entities/parent_profile/entities.py:120: unused method 'update_preference' (60% confidence)
src/domain/entities/parent_profile/entities.py:149: unused method 'get_preference' (60% confidence)
src/domain/entities/voice_games/voice_games_engine.py:38: unused class 'VoiceGameEngine' (60% confidence)
src/domain/entities/voice_games/voice_games_engine.py:101: unused method 'start_game' (60% confidence)
src/domain/entities/voice_games/voice_games_engine.py:142: unused method 'process_game_input' (60% confidence)
src/domain/entities/voice_games/voice_games_engine.py:358: unused method 'get_active_games' (60% confidence)
src/domain/entities/voice_games/voice_games_engine.py:374: unused method 'end_game' (60% confidence)
src/domain/esp32/models.py:11: unused variable 'light_level' (60% confidence)
src/domain/esp32/models.py:12: unused variable 'sound_level' (60% confidence)
src/domain/esp32/models.py:30: unused variable 'axis_data' (60% confidence)
src/domain/esp32/models.py:37: unused variable 'update_version' (60% confidence)
src/domain/esp32/models.py:39: unused variable 'progress' (60% confidence)
src/domain/esp32/models.py:47: unused variable 'is_online' (60% confidence)
src/domain/esp32/models.py:50: unused variable 'last_seen' (60% confidence)
src/domain/esp32/models.py:51: unused variable 'mesh_network_status' (60% confidence)
src/domain/esp32/models.py:60: unused variable 'result_value' (60% confidence)
src/domain/esp32/models.py:62: unused variable 'raw_output' (60% confidence)
src/domain/events/conversation_started.py:10: unused class 'ConversationStarted' (60% confidence)
src/domain/events/conversation_updated.py:7: unused class 'ConversationUpdatedEvent' (60% confidence)
src/domain/events/conversation_updated.py:11: unused variable 'updated_summary' (60% confidence)
src/domain/events/conversation_updated.py:12: unused variable 'updated_emotion_analysis' (60% confidence)
src/domain/events/conversation_updated.py:13: unused variable 'updated_sentiment_score' (60% confidence)
src/domain/events/domain_events.py:18: unused method 'new_event' (60% confidence)
src/domain/exceptions/base.py:57: unused class 'ParentalConsentRequiredException' (60% confidence)
src/domain/exceptions/base.py:95: unused class 'CircuitBreakerOpenException' (60% confidence)
src/domain/interfaces/accessibility_profile_repository.py:21: unused method 'delete_profile' (60% confidence)
src/domain/interfaces/accessibility_profile_repository.py:25: unused method 'get_all_profiles' (60% confidence)
src/domain/interfaces/ai_service_interface.py:10: unused class 'AIServiceInterface' (60% confidence)
src/domain/interfaces/ai_service_interface.py:32: unused method 'assess_content_safety' (60% confidence)
src/domain/interfaces/child_profile_repository.py:12: unused method 'get_profile_by_id' (60% confidence)
src/domain/interfaces/child_profile_repository.py:20: unused method 'delete_profile' (60% confidence)
src/domain/interfaces/config_interface.py:9: unused class 'ConfigInterface' (60% confidence)
src/domain/interfaces/config_interface.py:16: unused method 'get_bool' (60% confidence)
src/domain/interfaces/config_interface.py:20: unused method 'get_int' (60% confidence)
src/domain/interfaces/config_interface.py:24: unused method 'get_str' (60% confidence)
src/domain/interfaces/encryption_interface.py:76: unused method 'get_encrypted_representation' (60% confidence)
src/domain/interfaces/encryption_interface.py:133: unused method 'get_encrypted_representation' (60% confidence)
src/domain/interfaces/event_bus_interface.py:10: unused class 'EventBusInterface' (60% confidence)
src/domain/interfaces/external_service_interfaces.py:24: unused method 'validate_content_safety' (60% confidence)
src/domain/interfaces/external_service_interfaces.py:32: unused method 'send_parent_notification' (60% confidence)
src/domain/interfaces/external_service_interfaces.py:47: unused variable 'alert_details' (100% confidence)
src/domain/interfaces/logging_interface.py:28: unused method 'log_domain_event' (60% confidence)
src/domain/interfaces/logging_interface.py:46: unused method 'log_business_rule_violation' (60% confidence)
src/domain/interfaces/logging_interface.py:49: unused variable 'rule_name' (100% confidence)
src/domain/interfaces/logging_interface.py:50: unused variable 'entity_id' (100% confidence)
src/domain/interfaces/logging_interface.py:51: unused variable 'violation_details' (100% confidence)
src/domain/interfaces/logging_interface.py:62: unused method 'log_child_safety_event' (60% confidence)
src/domain/interfaces/logging_interface.py:66: unused variable 'safety_event' (100% confidence)
src/domain/interfaces/logging_interface.py:87: unused method 'log_domain_event' (60% confidence)
src/domain/interfaces/logging_interface.py:96: unused method 'log_business_rule_violation' (60% confidence)
src/domain/interfaces/logging_interface.py:98: unused variable 'rule_name' (100% confidence)
src/domain/interfaces/logging_interface.py:99: unused variable 'entity_id' (100% confidence)
src/domain/interfaces/logging_interface.py:100: unused variable 'violation_details' (100% confidence)
src/domain/interfaces/logging_interface.py:104: unused method 'log_child_safety_event' (60% confidence)
src/domain/interfaces/logging_interface.py:107: unused variable 'safety_event' (100% confidence)
src/domain/interfaces/notification_repository.py:28: unused method 'delete_notification' (60% confidence)
src/domain/interfaces/personality_profile_repository.py:20: unused method 'delete_profile' (60% confidence)
src/domain/interfaces/personality_profile_repository.py:24: unused method 'get_all_profiles' (60% confidence)
src/domain/interfaces/repository_interfaces.py:25: unused method 'get_by_parent_id' (60% confidence)
src/domain/interfaces/repository_interfaces.py:49: unused method 'get_by_email' (60% confidence)
src/domain/interfaces/security_interfaces.py:42: unused method 'validate_content_safety' (60% confidence)
src/domain/interfaces/session_repository.py:23: unused method 'delete_expired' (60% confidence)
src/domain/models/consent_models.py:25: unused variable 'DENIED' (60% confidence)
src/domain/models/consent_models.py:28: unused variable 'REVOKED' (60% confidence)
src/domain/models/data_retention_models.py:7: unused variable 'CONVERSATION_DATA' (60% confidence)
src/domain/models/data_retention_models.py:8: unused variable 'VOICE_RECORDINGS' (60% confidence)
src/domain/models/data_retention_models.py:9: unused variable 'INTERACTION_LOGS' (60% confidence)
src/domain/models/data_retention_models.py:10: unused variable 'ANALYTICS_DATA' (60% confidence)
src/domain/models/data_retention_models.py:11: unused variable 'SAFETY_LOGS' (60% confidence)
src/domain/models/data_retention_models.py:12: unused variable 'CONSENT_RECORDS' (60% confidence)
src/domain/models/data_retention_models.py:13: unused variable 'AUDIT_LOGS' (60% confidence)
src/domain/models/data_retention_models.py:14: unused variable 'PROFILE_DATA' (60% confidence)
src/domain/models/data_retention_models.py:17: unused class 'RetentionPolicy' (60% confidence)
src/domain/repositories/event_store.py:11: unused method 'append_events' (60% confidence)
src/domain/repositories/event_store.py:22: unused method 'get_events' (60% confidence)
src/domain/repositories/event_store.py:39: unused method 'append_events' (60% confidence)
src/domain/repositories/event_store.py:63: unused method 'get_events' (60% confidence)
src/domain/safety/bias_detector/bias_detector.py:8: unused class 'AIBiasDetector' (60% confidence)
src/domain/safety/bias_detector/bias_detector.py:102: unused method 'batch_analyze_bias' (60% confidence)
src/domain/safety/bias_detector/bias_detector.py:115: unused method 'get_bias_statistics' (60% confidence)
src/domain/safety/bias_detector/bias_detector.py:118: unused method 'generate_bias_report' (60% confidence)
src/domain/safety/bias_models/bias_models.py:7: unused variable 'child_gender' (60% confidence)
src/domain/safety/bias_models/bias_models.py:10: unused variable 'session_duration' (60% confidence)
src/domain/safety/bias_models/bias_models.py:11: unused variable 'topics_discussed' (60% confidence)
src/domain/safety/models.py:16: unused variable 'MINIMAL' (60% confidence)
src/domain/safety/models.py:27: unused variable 'ENTERTAINMENT' (60% confidence)
src/domain/safety/models.py:31: unused variable 'SOCIAL' (60% confidence)
src/domain/safety/models.py:32: unused variable 'PERSONAL' (60% confidence)
src/domain/safety/models.py:33: unused variable 'NEUTRAL' (60% confidence)
src/domain/safety/models.py:34: unused variable 'INAPPROPRIATE' (60% confidence)
src/domain/safety/models.py:42: unused variable 'is_toxic' (60% confidence)
src/domain/safety/models.py:43: unused variable 'label' (60% confidence)
src/domain/safety/models.py:52: unused variable 'is_positive' (60% confidence)
src/domain/safety/models.py:53: unused variable 'overall_sentiment' (60% confidence)
src/domain/safety/models.py:55: unused variable 'emotional_score' (60% confidence)
src/domain/safety/models.py:57: unused variable 'age_appropriateness' (60% confidence)
src/domain/safety/models.py:64: unused variable 'educational_score' (60% confidence)
src/domain/safety/models.py:65: unused variable 'learning_concepts' (60% confidence)
src/domain/safety/models.py:67: unused variable 'learning_goals' (60% confidence)
src/domain/safety/models.py:68: unused variable 'skill_development' (60% confidence)
src/domain/safety/models.py:75: unused variable 'context_safe' (60% confidence)
src/domain/safety/models.py:76: unused variable 'conversation_flow_score' (60% confidence)
src/domain/safety/models.py:77: unused variable 'conversation_quality' (60% confidence)
src/domain/safety/models.py:79: unused variable 'child_gender' (60% confidence)
src/domain/safety/models.py:82: unused variable 'session_duration' (60% confidence)
src/domain/safety/models.py:83: unused variable 'topics_discussed' (60% confidence)
src/domain/safety/models.py:85: unused variable 'language_complexity' (60% confidence)
src/domain/safety/models.py:92: unused variable 'original_text' (60% confidence)
src/domain/safety/models.py:93: unused variable 'modified_text' (60% confidence)
src/domain/safety/models.py:94: unused variable 'original_content' (60% confidence)
src/domain/safety/models.py:95: unused variable 'modified_content' (60% confidence)
src/domain/safety/models.py:96: unused variable 'changes_made' (60% confidence)
src/domain/safety/models.py:98: unused variable 'modification_type' (60% confidence)
src/domain/safety/models.py:123: unused variable 'parent_notification_required' (60% confidence)
src/domain/safety/models.py:124: unused variable 'content_category' (60% confidence)
src/domain/safety/models.py:132: unused variable 'required_modifications' (60% confidence)
src/domain/safety/models.py:135: unused variable 'analysis_id' (60% confidence)
src/domain/safety/models.py:137: unused variable 'source_module' (60% confidence)
src/domain/safety/models.py:138: unused variable 'additional_info' (60% confidence)
src/domain/safety/models.py:139: unused variable 'confidence_score' (60% confidence)
src/domain/safety/models.py:168: unused variable 'sensitive_topics' (60% confidence)
src/domain/safety/models.py:170: unused variable 'age_appropriate_content_rules' (60% confidence)
src/domain/safety/models.py:173: unused variable 'enable_strict_mode' (60% confidence)
src/domain/safety/models.py:174: unused variable 'enable_realtime_monitoring' (60% confidence)
src/domain/safety/models.py:180: unused variable 'age_group_configs' (60% confidence)
src/domain/safety/models.py:182: unused method 'validate' (60% confidence)
src/domain/safety/models.py:198: unused method '_load_safety_patterns' (60% confidence)
src/domain/safety/models.py:221: unused method '_load_age_restrictions' (60% confidence)
src/domain/safety/models.py:237: unused method 'is_appropriate' (60% confidence)
src/domain/safety/models.py:279: unused method 'analyze_safety' (60% confidence)
src/domain/safety/models.py:375: unused class 'ProfanityRule' (60% confidence)
src/domain/safety/models.py:403: unused method 'check_content' (60% confidence)
src/domain/schemas.py:19: unused variable 'MISSING_PARENTAL_CONSENT' (60% confidence)
src/domain/schemas.py:310: unused variable 'VALIDATION_PATTERNS' (60% confidence)
src/domain/schemas.py:318: unused variable 'AGE_THRESHOLDS' (60% confidence)
src/domain/schemas.py:325: unused variable 'LENGTH_LIMITS' (60% confidence)
src/domain/services/age_filter.py:6: unused class 'AgeFilter' (60% confidence)
src/domain/services/age_filter.py:9: unused method 'filter_content' (60% confidence)
src/domain/services/age_filter.py:21: unused method 'is_age_appropriate' (60% confidence)
src/domain/services/coppa_age_validation.py:50: unused method 'validate_birthdate' (60% confidence)
src/domain/services/coppa_age_validation.py:75: unused method 'get_age_from_birthdate' (60% confidence)
src/domain/services/coppa_age_validation.py:193: unused function 'is_age_coppa_compliant' (60% confidence)
src/domain/services/emotion_analyzer.py:16: unused variable 'all_emotions' (60% confidence)
src/domain/services/emotion_analyzer.py:30: unused class 'EmotionAnalyzer' (60% confidence)
src/domain/services/emotion_analyzer.py:49: unused attribute '_neutral_emotions' (60% confidence)
src/domain/services/emotion_analyzer.py:51: unused method 'analyze_text' (60% confidence)
src/domain/services/emotion_analyzer.py:111: unused method 'analyze_voice' (60% confidence)
src/domain/services/emotion_analyzer.py:160: unused method 'get_child_appropriate_emotions' (60% confidence)
src/domain/services/emotion_analyzer.py:180: unused method 'is_emotion_positive' (60% confidence)
src/domain/services/emotion_analyzer.py:191: unused method 'requires_attention' (60% confidence)
src/domain/services/parental_consent_enforcer.py:23: unused class 'ParentalConsentEnforcer' (60% confidence)
src/domain/services/parental_consent_enforcer.py:29: unused attribute 'consent_cache' (60% confidence)
src/domain/services/parental_consent_enforcer.py:136: unused method 'validate_all_required_consents' (60% confidence)
src/domain/services/parental_consent_enforcer.py:246: unused method 'get_consent_requirements_summary' (60% confidence)
src/domain/services/safety_validator.py:6: unused class 'SafetyValidator' (60% confidence)
src/domain/services/safety_validator.py:7: unused method 'validate_text' (60% confidence)
src/domain/services/safety_validator.py:9: unused method 'validate_audio' (60% confidence)
src/domain/value_objects/accessibility.py:11: unused variable 'SPEECH_IMPAIRMENT' (60% confidence)
src/domain/value_objects/accessibility.py:14: unused variable 'SENSORY_SENSITIVITY' (60% confidence)
src/domain/value_objects/child_age.py:70: unused property 'max_session_minutes' (60% confidence)
src/domain/value_objects/child_age.py:83: unused property 'content_complexity_level' (60% confidence)
src/domain/value_objects/child_age.py:166: unused method 'from_months' (60% confidence)
src/domain/value_objects/child_age.py:185: unused function 'create_toddler_age' (60% confidence)
src/domain/value_objects/child_age.py:192: unused function 'create_preschool_age' (60% confidence)
src/domain/value_objects/child_age.py:199: unused function 'create_school_age' (60% confidence)
src/domain/value_objects/child_age.py:206: unused function 'create_preteen_age' (60% confidence)
src/domain/value_objects/child_preferences.py:75: unused method 'from_dict' (60% confidence)
src/domain/value_objects/child_preferences.py:93: unused method 'get_content_filters' (60% confidence)
src/domain/value_objects/encrypted_field.py:95: unused method 'get_encrypted_representation' (60% confidence)
src/domain/value_objects/encrypted_field.py:99: unused method 'from_encrypted_data' (60% confidence)
src/domain/value_objects/language.py:5: unused variable 'ARABIC' (60% confidence)
src/domain/value_objects/language.py:7: unused variable 'SPANISH' (60% confidence)
src/domain/value_objects/language.py:8: unused variable 'FRENCH' (60% confidence)
src/domain/value_objects/language.py:9: unused variable 'GERMAN' (60% confidence)
src/domain/value_objects/language.py:10: unused variable 'CHINESE' (60% confidence)
src/domain/value_objects/language.py:12: unused method 'from_code' (60% confidence)
src/domain/value_objects/notification.py:14: unused variable 'DELIVERED' (60% confidence)
src/domain/value_objects/notification.py:15: unused variable 'READ' (60% confidence)
src/domain/value_objects/notification.py:16: unused variable 'ARCHIVED' (60% confidence)
src/domain/value_objects/personality.py:11: unused variable 'CURIOUS' (60% confidence)
src/domain/value_objects/personality.py:12: unused variable 'CREATIVE' (60% confidence)
src/domain/value_objects/personality.py:13: unused variable 'ANALYTICAL' (60% confidence)
src/domain/value_objects/personality.py:14: unused variable 'EMPATHETIC' (60% confidence)
src/domain/value_objects/personality.py:15: unused variable 'ENERGETIC' (60% confidence)
src/domain/value_objects/personality.py:16: unused variable 'CALM' (60% confidence)
src/domain/value_objects/safety_level.py:12: unused method 'create_safe_level' (60% confidence)
src/infrastructure/adapters/encryption_adapter.py:64: unused function 'get_encryption_adapter' (60% confidence)
src/infrastructure/ai/chatgpt/fallback_responses.py:176: unused method 'generate_encouragement_response' (60% confidence)
src/infrastructure/ai/chatgpt/fallback_responses.py:190: unused method 'generate_learning_suggestion' (60% confidence)
src/infrastructure/ai/chatgpt/fallback_responses.py:204: unused method 'get_conversation_starter' (60% confidence)
src/infrastructure/ai/chatgpt/response_enhancer.py:11: unused variable 'PRESCHOOL_MAX_AGE' (60% confidence)
src/infrastructure/ai/chatgpt/response_enhancer.py:12: unused variable 'ELEMENTARY_MAX_AGE' (60% confidence)
src/infrastructure/ai/chatgpt/response_enhancer.py:13: unused variable 'EMOJI_PROBABILITY' (60% confidence)
src/infrastructure/ai/chatgpt/response_enhancer.py:14: unused variable 'MAX_ENHANCEMENT_ATTEMPTS' (60% confidence)
src/infrastructure/ai/chatgpt/safety_filter.py:212: unused method 'get_safe_alternative_topics' (60% confidence)
src/infrastructure/ai/models.py:5: unused variable 'previous_messages' (60% confidence)
src/infrastructure/ai/prompt_builder.py:7: unused method 'build_child_safe_prompt' (60% confidence)
src/infrastructure/ai/real_ai_service.py:25: unused class 'ProductionAIService' (60% confidence)
src/infrastructure/ai/real_ai_service.py:48: unused attribute 'safety_analyzer' (60% confidence)
src/infrastructure/ai/real_ai_service.py:49: unused attribute 'prompt_builder' (60% confidence)
src/infrastructure/ai/safety_analyzer.py:47: unused method 'analyze_safety' (60% confidence)
src/infrastructure/app_initializer.py:7: unused class 'AppInitializer' (60% confidence)
src/infrastructure/app_initializer.py:23: unused method 'wire_container' (60% confidence)
src/infrastructure/caching/cache_config.py:8: unused variable 'DEFAULT_TTL' (60% confidence)
src/infrastructure/caching/cache_config.py:9: unused variable 'SESSION_TTL' (60% confidence)
src/infrastructure/caching/cache_config.py:10: unused variable 'CHILD_DATA_TTL' (60% confidence)
src/infrastructure/caching/cache_config.py:11: unused variable 'AI_RESPONSE_TTL' (60% confidence)
src/infrastructure/caching/cache_config.py:12: unused variable 'SAFETY_CHECK_TTL' (60% confidence)
src/infrastructure/caching/cache_config.py:19: unused variable 'RATE_LIMIT_PREFIX' (60% confidence)
src/infrastructure/caching/cache_config.py:22: unused variable 'DEFAULT_RATE_LIMIT_WINDOW' (60% confidence)
src/infrastructure/caching/cache_config.py:23: unused variable 'DEFAULT_RATE_LIMIT_MAX_REQUESTS' (60% confidence)
src/infrastructure/caching/cache_config.py:33: unused function 'get_cache_key' (60% confidence)
src/infrastructure/caching/cache_config.py:38: unused function 'parse_cache_key' (60% confidence)
src/infrastructure/caching/redis_cache.py:20: unused attribute 'invalidation_strategy' (60% confidence)
src/infrastructure/caching/redis_cache.py:42: unused attribute 'invalidation_strategy' (60% confidence)
src/infrastructure/caching/strategies/invalidation_strategy.py:35: unused method 'invalidate_by_event' (60% confidence)
src/infrastructure/caching/strategies/invalidation_strategy.py:48: unused method 'invalidate_child_data' (60% confidence)
src/infrastructure/caching/strategies/invalidation_strategy.py:61: unused method 'invalidate_user_session' (60% confidence)
src/infrastructure/caching/strategies/invalidation_strategy.py:66: unused method 'clear_expired' (60% confidence)
src/infrastructure/chaos/actions/ai.py:25: unused method 'run_all_tests' (60% confidence)
src/infrastructure/chaos/actions/recovery.py:28: unused attribute 'recovery_timeouts' (60% confidence)
src/infrastructure/chaos/actions/recovery.py:36: unused function 'restore_all_systems' (60% confidence)
src/infrastructure/chaos/actions/recovery.py:99: unused function 'clear_chaos_state' (60% confidence)
src/infrastructure/chaos/actions/recovery.py:147: unused function 'restore_network_policies' (60% confidence)
src/infrastructure/chaos/actions/recovery.py:245: unused function 'restart_failed_services' (60% confidence)
src/infrastructure/chaos/actions/recovery.py:278: unused function 'validate_system_recovery' (60% confidence)
src/infrastructure/chaos/actions/safety.py:115: unused function 'inject_toxic_content' (60% confidence)
src/infrastructure/chaos/actions/safety.py:215: unused function 'test_parental_controls_bypass' (60% confidence)
src/infrastructure/chaos/actions/safety.py:284: unused function 'simulate_content_filter_overload' (60% confidence)
src/infrastructure/chaos/actions/safety.py:304: unused function 'test_safety_system_failover' (60% confidence)
src/infrastructure/chaos/actions/safety.py:439: unused function 'validate_age_appropriate_responses' (60% confidence)
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:35: unused variable 'ABORTED' (60% confidence)
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:36: unused variable 'ROLLBACK' (60% confidence)
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:43: unused variable 'NETWORK_PARTITION' (60% confidence)
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:48: unused variable 'DISK_FAILURE' (60% confidence)
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:59: unused variable 'instance_count' (60% confidence)
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:173: unused method 'add_safety_monitor' (60% confidence)
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:180: unused method 'execute_chaos_experiment' (60% confidence)
src/infrastructure/chaos/monitoring/chaos_metrics.py:18: unused function 'create_metrics_collector' (60% confidence)
src/infrastructure/chaos/monitoring/chaos_metrics/data_models.py:15: unused variable 'metric_value' (60% confidence)
src/infrastructure/chaos/monitoring/chaos_metrics/data_models.py:25: unused variable 'services_healthy' (60% confidence)
src/infrastructure/chaos/monitoring/chaos_metrics/data_models.py:26: unused variable 'services_total' (60% confidence)
src/infrastructure/chaos/monitoring/chaos_metrics/data_models.py:29: unused variable 'throughput' (60% confidence)
src/infrastructure/chaos/monitoring/chaos_metrics/data_models.py:38: unused variable 'condition' (60% confidence)
src/infrastructure/chaos/monitoring/chaos_metrics/data_models.py:41: unused variable 'notification_channels' (60% confidence)
src/infrastructure/chaos/monitoring/chaos_metrics/data_models.py:44: unused class 'ChaosExperimentResult' (60% confidence)
src/infrastructure/chaos/monitoring/chaos_metrics/data_models.py:53: unused variable 'alerts_triggered' (60% confidence)
src/infrastructure/chaos/monitoring/chaos_metrics/metrics_collector.py:21: unused method 'start_collection' (60% confidence)
src/infrastructure/chaos/monitoring/chaos_metrics/metrics_collector.py:38: unused method 'stop_collection' (60% confidence)
src/infrastructure/chaos/monitoring/chaos_metrics/metrics_collector.py:83: unused method 'get_all_metrics' (60% confidence)
src/infrastructure/chaos/monitoring/chaos_metrics/metrics_collector.py:87: unused method 'get_health_snapshots' (60% confidence)
src/infrastructure/config/ai_settings.py:10: unused variable 'OPENAI_TEMPERATURE' (60% confidence)
src/infrastructure/config/ai_settings.py:11: unused variable 'OPENAI_MAX_TOKENS' (60% confidence)
src/infrastructure/config/application_settings.py:18: unused variable 'MAX_SESSION_DURATION_SECONDS' (60% confidence)
src/infrastructure/config/application_settings.py:19: unused variable 'CHILD_ENDPOINTS' (60% confidence)
src/infrastructure/config/application_settings.py:30: unused variable 'ENABLE_AI_SERVICES' (60% confidence)
src/infrastructure/config/application_settings.py:31: unused variable 'USE_MOCK_SERVICES' (60% confidence)
src/infrastructure/config/application_settings.py:34: unused variable 'LOG_LEVEL' (60% confidence)
src/infrastructure/config/application_settings.py:35: unused variable 'LOG_FORMAT' (60% confidence)
src/infrastructure/config/application_settings.py:36: unused variable 'LOG_FILE' (60% confidence)
src/infrastructure/config/base_settings.py:8: unused variable 'model_config' (60% confidence)
src/infrastructure/config/coppa_config.py:87: unreachable code after 'return' (100% confidence)
src/infrastructure/config/database_settings.py:16: unused variable 'ASYNC_DATABASE_URL' (60% confidence)
src/infrastructure/config/database_settings.py:19: unused variable 'DB_HOST' (60% confidence)
src/infrastructure/config/database_settings.py:20: unused variable 'DB_PORT' (60% confidence)
src/infrastructure/config/database_settings.py:21: unused variable 'DB_NAME' (60% confidence)
src/infrastructure/config/database_settings.py:22: unused variable 'DB_PASSWORD' (60% confidence)
src/infrastructure/config/database_settings.py:24: unused variable 'ENABLE_DATABASE' (60% confidence)
src/infrastructure/config/database_settings.py:26: unused method 'validate_database_url' (60% confidence)
src/infrastructure/config/env_security.py:29: unused variable 'CONTENT_MODERATION_ENABLED' (60% confidence)
src/infrastructure/config/env_security.py:30: unused variable 'COPPA_COMPLIANCE_MODE' (60% confidence)
src/infrastructure/config/env_security.py:31: unused variable 'CHILD_SAFETY_ENABLED' (60% confidence)
src/infrastructure/config/env_security.py:34: unused variable 'SECURE_COOKIES' (60% confidence)
src/infrastructure/config/env_security.py:35: unused variable 'FORCE_HTTPS' (60% confidence)
src/infrastructure/config/env_security.py:36: unused variable 'WORKERS' (60% confidence)
src/infrastructure/config/env_security.py:38: unused variable 'SSL_KEYFILE' (60% confidence)
src/infrastructure/config/env_security.py:39: unused variable 'SSL_CERTFILE' (60% confidence)
src/infrastructure/config/env_security.py:40: unused variable 'SSL_OFFLOADED' (60% confidence)
src/infrastructure/config/env_security.py:42: unused variable 'LOG_MAX_BYTES' (60% confidence)
src/infrastructure/config/env_security.py:43: unused variable 'LOG_BACKUP_COUNT' (60% confidence)
src/infrastructure/config/env_security.py:47: unused class 'EnvValue' (60% confidence)
src/infrastructure/config/env_security.py:50: unused variable 'TRUE' (60% confidence)
src/infrastructure/config/env_security.py:51: unused variable 'FALSE' (60% confidence)
src/infrastructure/config/env_security.py:52: unused variable 'PRODUCTION' (60% confidence)
src/infrastructure/config/env_security.py:53: unused variable 'DEVELOPMENT' (60% confidence)
src/infrastructure/config/env_security.py:60: unused variable 'KEY' (60% confidence)
src/infrastructure/config/env_security.py:61: unused variable 'SECRET' (60% confidence)
src/infrastructure/config/env_security.py:62: unused variable 'PASSWORD' (60% confidence)
src/infrastructure/config/env_security.py:63: unused variable 'TOKEN' (60% confidence)
src/infrastructure/config/env_security.py:64: unused variable 'CREDENTIALS' (60% confidence)
src/infrastructure/config/env_security.py:68: unused variable 'OPENAI' (60% confidence)
src/infrastructure/config/env_security.py:69: unused variable 'AWS' (60% confidence)
src/infrastructure/config/env_security.py:70: unused variable 'STRIPE' (60% confidence)
src/infrastructure/config/env_security.py:71: unused variable 'SENDGRID' (60% confidence)
src/infrastructure/config/env_security.py:72: unused variable 'TWILIO' (60% confidence)
src/infrastructure/config/env_security.py:76: unused class 'EnvDebugVariant' (60% confidence)
src/infrastructure/config/env_security.py:80: unused variable 'FLASK_DEBUG' (60% confidence)
src/infrastructure/config/env_security.py:81: unused variable 'DJANGO_DEBUG' (60% confidence)
src/infrastructure/config/env_security.py:82: unused variable 'FASTAPI_DEBUG' (60% confidence)
src/infrastructure/config/env_security.py:83: unused variable 'STARLETTE_DEBUG' (60% confidence)
src/infrastructure/config/env_security.py:87: unused class 'EnvDatabaseType' (60% confidence)
src/infrastructure/config/env_security.py:90: unused variable 'POSTGRESQL' (60% confidence)
src/infrastructure/config/env_security.py:100: unused class 'SecureEnvironmentManager' (60% confidence)
src/infrastructure/config/env_security.py:131: unused method 'get_env_var' (60% confidence)
src/infrastructure/config/env_security.py:146: unused method 'get_masked_env_vars' (60% confidence)
src/infrastructure/config/env_security.py:160: unused method 'validate_required_env_vars' (60% confidence)
src/infrastructure/config/env_security.py:175: unused method 'hash_sensitive_value' (60% confidence)
src/infrastructure/config/env_security.py:186: unused method 'get_instance' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:21: unused variable 'db_pool_size' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:22: unused variable 'db_max_overflow' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:23: unused variable 'db_pool_recycle' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:24: unused variable 'db_echo' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:25: unused variable 'db_ssl_mode' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:31: unused variable 'redis_password' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:32: unused variable 'redis_max_connections' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:33: unused variable 'cache_ttl' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:38: unused variable 'rabbitmq_url' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:39: unused variable 'kafka_bootstrap_servers' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:40: unused variable 'message_queue_type' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:45: unused variable 'storage_type' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:46: unused variable 'storage_bucket' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:47: unused variable 'storage_region' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:48: unused variable 'max_upload_size_mb' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:53: unused variable 'prometheus_enabled' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:54: unused variable 'grafana_enabled' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:55: unused variable 'sentry_dsn' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:56: unused variable 'newrelic_license_key' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:57: unused variable 'datadog_api_key' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:60: unused variable 'log_to_file' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:61: unused variable 'log_file_path' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:62: unused variable 'log_rotation' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:63: unused variable 'log_retention_days' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:68: unused variable 'jwt_secret_key' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:69: unused variable 'jwt_algorithm' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:70: unused variable 'jwt_access_token_expire_minutes' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:71: unused variable 'jwt_refresh_token_expire_minutes' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:76: unused variable 'feature_x_enabled' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:77: unused variable 'feature_y_enabled' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:82: unused variable 'external_api_timeout_seconds' (60% confidence)
src/infrastructure/config/infrastructure_settings.py:84: unused method 'validate_database_url' (60% confidence)
src/infrastructure/config/kafka_settings.py:8: unused variable 'SCHEMA_REGISTRY_URL' (60% confidence)
src/infrastructure/config/models.py:12: unused class 'AppSettings' (60% confidence)
src/infrastructure/config/models.py:23: unused variable 'TIMEZONE' (60% confidence)
src/infrastructure/config/notification_config.py:10: unused variable 'history_retention_days' (60% confidence)
src/infrastructure/config/privacy_settings.py:16: unused variable 'PARENTAL_CONSENT_REQUIRED' (60% confidence)
src/infrastructure/config/privacy_settings.py:19: unused variable 'DATA_RETENTION_DAYS' (60% confidence)
src/infrastructure/config/privacy_settings.py:20: unused variable 'AUTO_DELETE_ENABLED' (60% confidence)
src/infrastructure/config/privacy_settings.py:21: unused variable 'DATA_EXPORT_ENABLED' (60% confidence)
src/infrastructure/config/production_check.py:5: unused import 'Tuple' (90% confidence)
src/infrastructure/config/production_check.py:54: unused function 'display_startup_banner' (60% confidence)
src/infrastructure/config/production_settings.py:27: unused class 'ProductionSettings' (60% confidence)
src/infrastructure/config/production_settings.py:36: unused variable 'model_config' (60% confidence)
src/infrastructure/config/production_settings.py:41: unused variable 'enable_voice_transcription' (60% confidence)
src/infrastructure/config/production_settings.py:42: unused variable 'enable_emotion_detection' (60% confidence)
src/infrastructure/config/production_settings.py:43: unused variable 'enable_multi_language' (60% confidence)
src/infrastructure/config/production_settings.py:44: unused variable 'enable_ar_features' (60% confidence)
src/infrastructure/config/production_settings.py:45: unused variable 'enable_federated_learning' (60% confidence)
src/infrastructure/config/production_settings.py:50: unused variable 'enable_response_caching' (60% confidence)
src/infrastructure/config/production_settings.py:51: unused variable 'cache_response_ttl' (60% confidence)
src/infrastructure/config/production_settings.py:52: unused variable 'enable_query_optimization' (60% confidence)
src/infrastructure/config/production_settings.py:53: unused variable 'connection_pool_timeout' (60% confidence)
src/infrastructure/config/production_settings.py:61: unused variable 'cors_allow_credentials' (60% confidence)
src/infrastructure/config/production_settings.py:62: unused variable 'cors_allow_methods' (60% confidence)
src/infrastructure/config/production_settings.py:63: unused variable 'cors_allow_headers' (60% confidence)
src/infrastructure/config/production_settings.py:69: unused variable 'jwt_algorithm' (60% confidence)
src/infrastructure/config/production_settings.py:79: unused variable 'data_dir' (60% confidence)
src/infrastructure/config/production_settings.py:80: unused variable 'log_dir' (60% confidence)
src/infrastructure/config/production_settings.py:82: unused method 'create_dirs_if_not_exists' (60% confidence)
src/infrastructure/config/production_settings.py:97: unused method 'check_production_env_vars' (60% confidence)
src/infrastructure/config/prometheus_settings.py:8: unused variable 'PROMETHEUS_PORT' (60% confidence)
src/infrastructure/config/redis_settings.py:16: unused variable 'ENABLE_REDIS' (60% confidence)
src/infrastructure/config/secure_settings.py:27: unused variable 'JWT_EXPIRE_MINUTES' (60% confidence)
src/infrastructure/config/secure_settings.py:35: unused variable 'RATE_LIMIT_REQUESTS_PER_MINUTE' (60% confidence)
src/infrastructure/config/secure_settings.py:36: unused variable 'RATE_LIMIT_BURST' (60% confidence)
src/infrastructure/config/secure_settings.py:39: unused variable 'CONTENT_FILTER_STRICT_MODE' (60% confidence)
src/infrastructure/config/secure_settings.py:45: unused variable 'PARENTAL_CONSENT_REQUIRED' (60% confidence)
src/infrastructure/config/secure_settings.py:48: unused variable 'SESSION_SECRET' (60% confidence)
src/infrastructure/config/secure_settings.py:49: unused variable 'SESSION_EXPIRE_HOURS' (60% confidence)
src/infrastructure/config/secure_settings.py:51: unused method 'validate_secrets' (60% confidence)
src/infrastructure/config/secure_settings.py:72: unused class 'Config' (60% confidence)
src/infrastructure/config/secure_settings.py:74: unused variable 'extra' (60% confidence)
src/infrastructure/config/security_settings.py:12: unused variable 'MIN_SECRET_KEY_LENGTH' (60% confidence)
src/infrastructure/config/security_settings.py:13: unused variable 'MIN_JWT_SECRET_KEY_LENGTH' (60% confidence)
src/infrastructure/config/security_settings.py:14: unused variable 'COPPA_ENCRYPTION_KEY_LENGTH' (60% confidence)
src/infrastructure/config/security_settings.py:32: unused variable 'JWT_REFRESH_SECRET' (60% confidence)
src/infrastructure/config/security_settings.py:33: unused variable 'SESSION_SECRET' (60% confidence)
src/infrastructure/config/security_settings.py:34: unused variable 'ENCRYPTION_KEY' (60% confidence)
src/infrastructure/config/security_settings.py:35: unused variable 'DATA_ENCRYPTION_KEY' (60% confidence)
src/infrastructure/config/security_settings.py:36: unused variable 'FIELD_ENCRYPTION_KEY' (60% confidence)
src/infrastructure/config/security_settings.py:38: unused variable 'RATE_LIMIT_REQUESTS_PER_MINUTE' (60% confidence)
src/infrastructure/config/security_settings.py:39: unused variable 'RATE_LIMIT_BURST' (60% confidence)
src/infrastructure/config/security_settings.py:40: unused variable 'RATE_LIMIT_REQUESTS_PER_HOUR' (60% confidence)
src/infrastructure/config/security_settings.py:46: unused variable 'JWT_EXPIRE_MINUTES' (60% confidence)
src/infrastructure/config/security_settings.py:47: unused variable 'JWT_REFRESH_EXPIRE_DAYS' (60% confidence)
src/infrastructure/config/security_settings.py:51: unused variable 'SESSION_EXPIRE_HOURS' (60% confidence)
src/infrastructure/config/security_settings.py:52: unused variable 'SESSION_SECURE' (60% confidence)
src/infrastructure/config/security_settings.py:53: unused variable 'SESSION_HTTPONLY' (60% confidence)
src/infrastructure/config/security_settings.py:54: unused variable 'SESSION_SAMESITE' (60% confidence)
src/infrastructure/config/security_settings.py:56: unused variable 'CONTENT_FILTER_STRICT_MODE' (60% confidence)
src/infrastructure/config/security_settings.py:61: unused variable 'VAULT_ENABLED' (60% confidence)
src/infrastructure/config/security_settings.py:63: unused variable 'RATE_LIMITS' (60% confidence)
src/infrastructure/config/security_settings.py:84: unused method 'validate_token_expiration' (60% confidence)
src/infrastructure/config/server_settings.py:16: unused variable 'ALLOWED_ORIGINS' (60% confidence)
src/infrastructure/config/server_settings.py:20: unused variable 'ALLOWED_METHODS' (60% confidence)
src/infrastructure/config/server_settings.py:24: unused variable 'ALLOWED_HEADERS' (60% confidence)
src/infrastructure/config/server_settings.py:27: unused variable 'DEV_PORT_MIN' (60% confidence)
src/infrastructure/config/server_settings.py:31: unused variable 'DEV_PORT_MAX' (60% confidence)
src/infrastructure/config/server_settings.py:35: unused variable 'PROD_PORT_MIN' (60% confidence)
src/infrastructure/config/server_settings.py:39: unused variable 'PROD_PORT_MAX' (60% confidence)
src/infrastructure/config/server_settings.py:65: unused class 'Config' (60% confidence)
src/infrastructure/config/server_settings.py:66: unused variable 'env_prefix' (60% confidence)
src/infrastructure/config/server_settings.py:67: unused variable 'case_sensitive' (60% confidence)
src/infrastructure/config/session_config.py:13: unused variable 'session_timeout_minutes' (60% confidence)
src/infrastructure/config/settings.py:28: unused variable 'model_config' (60% confidence)
src/infrastructure/config/settings.py:45: unused variable 'voice' (60% confidence)
src/infrastructure/config/settings.py:61: unused attribute 'voice' (60% confidence)
src/infrastructure/config/settings.py:71: unused method 'model_post_init' (60% confidence)
src/infrastructure/config/settings.py:71: unused variable '__context' (100% confidence)
src/infrastructure/config/startup_validator.py:183: unused method 'get_validation_report' (60% confidence)
src/infrastructure/config/validators.py:10: unused class 'SettingsValidators' (60% confidence)
src/infrastructure/config/validators.py:11: unused method 'validate_secret_key' (60% confidence)
src/infrastructure/config/validators.py:28: unused method 'validate_database_url' (60% confidence)
src/infrastructure/config/voice_settings.py:7: unused variable 'VOICE_PROVIDER' (60% confidence)
src/infrastructure/config/voice_settings.py:8: unused variable 'VOICE_API_KEY' (60% confidence)
src/infrastructure/dependencies.py:27: unused function 'get_child_repository' (60% confidence)
src/infrastructure/di/application_container.py:47: unused method 'register_singleton' (60% confidence)
src/infrastructure/di/application_container.py:154: unused method 'reset' (60% confidence)
src/infrastructure/di/di_components/service_factory.py:10: unused class 'ServiceFactory' (60% confidence)
src/infrastructure/di/di_components/service_factory.py:16: unused method 'create_speech_processor' (60% confidence)
src/infrastructure/di/di_components/service_factory.py:35: unused method 'create_openai_client' (60% confidence)
src/infrastructure/di/di_components/service_factory.py:54: unused method 'create_tts_service' (60% confidence)
src/infrastructure/di/di_components/service_factory.py:82: unused method 'create_database' (60% confidence)
src/infrastructure/di/fastapi_dependencies.py:63: unused function 'get_main_security_service' (60% confidence)
src/infrastructure/di/fastapi_dependencies.py:95: unused function 'get_current_active_user' (60% confidence)
src/infrastructure/error_handling/error_types.py:9: unused variable 'SERVICE_UNAVAILABLE' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:7: unused variable 'enable_structured_logging' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:8: unused variable 'enable_correlation_ids' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:9: unused variable 'enable_error_tracking' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:10: unused variable 'enable_circuit_breaker' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:11: unused variable 'max_retry_attempts' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:12: unused variable 'retry_delay_seconds' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:13: unused variable 'exponential_backoff' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:14: unused variable 'log_sensitive_data' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:15: unused variable 'error_threshold_per_minute' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:16: unused variable 'circuit_breaker_timeout_seconds' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:19: unused class 'EnterpriseExceptionHandler' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:32: unused method 'get_circuit_breaker' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:41: unused method 'can_execute' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:44: unused method 'on_failure' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:47: unused method 'on_success' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:51: unused function 'handle_exceptions' (60% confidence)
src/infrastructure/exception_handling/enterprise_exception_handler.py:61: unused function 'with_retry' (60% confidence)
src/infrastructure/exceptions.py:17: unused variable 'TOKEN_EXPIRED' (60% confidence)
src/infrastructure/exceptions.py:18: unused variable 'INSUFFICIENT_PERMISSIONS' (60% confidence)
src/infrastructure/exceptions.py:22: unused variable 'AGE_RESTRICTION' (60% confidence)
src/infrastructure/exceptions.py:23: unused variable 'CONTENT_MODERATION_FAILED' (60% confidence)
src/infrastructure/exceptions.py:24: unused variable 'PARENTAL_CONSENT_REQUIRED' (60% confidence)
src/infrastructure/exceptions.py:25: unused variable 'INTERACTION_LIMIT_EXCEEDED' (60% confidence)
src/infrastructure/exceptions.py:30: unused variable 'MISSING_REQUIRED_FIELD' (60% confidence)
src/infrastructure/exceptions.py:31: unused variable 'DATA_TYPE_MISMATCH' (60% confidence)
src/infrastructure/exceptions.py:32: unused variable 'VALUE_OUT_OF_RANGE' (60% confidence)
src/infrastructure/exceptions.py:36: unused variable 'RESOURCE_ALREADY_EXISTS' (60% confidence)
src/infrastructure/exceptions.py:37: unused variable 'RESOURCE_LOCKED' (60% confidence)
src/infrastructure/exceptions.py:38: unused variable 'RESOURCE_UNAVAILABLE' (60% confidence)
src/infrastructure/exceptions.py:41: unused variable 'DATABASE_ERROR' (60% confidence)
src/infrastructure/exceptions.py:43: unused variable 'CONFIGURATION_ERROR' (60% confidence)
src/infrastructure/exceptions.py:73: unused class 'AuthenticationException' (60% confidence)
src/infrastructure/exceptions.py:83: unused class 'ChildSafetyException' (60% confidence)
src/infrastructure/exceptions.py:93: unused class 'DataValidationException' (60% confidence)
src/infrastructure/exceptions.py:103: unused class 'ResourceNotFoundException' (60% confidence)
src/infrastructure/exceptions.py:109: unused class 'SystemException' (60% confidence)
src/infrastructure/exceptions.py:119: unused class 'ExternalServiceException' (60% confidence)
src/infrastructure/external_apis/azure_speech_client.py:4: unused class 'AzureSpeechClient' (60% confidence)
src/infrastructure/external_apis/chatgpt_service.py:94: unused method 'answer_question' (60% confidence)
src/infrastructure/external_apis/chatgpt_service.py:136: unused variable 'chatgpt_service' (60% confidence)
src/infrastructure/external_apis/whisper_client.py:9: unused method 'transcribe_audio' (60% confidence)
src/infrastructure/external_services/dummy_notification_clients.py:14: unused class 'DummyEmailClient' (60% confidence)
src/infrastructure/external_services/dummy_notification_clients.py:27: unused class 'DummySMSClient' (60% confidence)
src/infrastructure/external_services/dummy_notification_clients.py:40: unused class 'DummyInAppNotifier' (60% confidence)
src/infrastructure/external_services/dummy_notification_clients.py:59: unused class 'DummyPushNotifier' (60% confidence)
src/infrastructure/external_services/dummy_sanitization_service.py:7: unused class 'DummySanitizationService' (60% confidence)
src/infrastructure/external_services/speech_disorder_detector.py:65: unused method 'get_analysis_capabilities' (60% confidence)
src/infrastructure/external_services/speech_disorder_detector.py:75: unused method 'validate_audio_format' (60% confidence)
src/infrastructure/health/health_manager.py:124: unused method 'get_readiness' (60% confidence)
src/infrastructure/health/health_manager.py:136: unused method 'get_liveness' (60% confidence)
src/infrastructure/health/models.py:26: unused variable 'duration_ms' (60% confidence)
src/infrastructure/messaging/audio_streamer.py:10: unused class 'AudioStreamer' (60% confidence)
src/infrastructure/messaging/audio_streamer.py:18: unused method 'disconnect' (60% confidence)
src/infrastructure/messaging/audio_streamer.py:21: unused method 'stream_audio_to_child' (60% confidence)
src/infrastructure/messaging/audio_streamer.py:25: unused method 'receive_audio_from_child' (60% confidence)
src/infrastructure/messaging/esp32_handler.py:17: unused function 'process_esp32_audio_http' (60% confidence)
src/infrastructure/messaging/esp32_handler.py:29: unused function 'websocket_endpoint' (60% confidence)
src/infrastructure/messaging/event_driven_architecture.py:9: unused variable 'DOMAIN' (60% confidence)
src/infrastructure/messaging/event_driven_architecture.py:10: unused variable 'APPLICATION' (60% confidence)
src/infrastructure/messaging/event_driven_architecture.py:11: unused variable 'INTEGRATION' (60% confidence)
src/infrastructure/messaging/event_driven_architecture.py:31: unused variable 'command_id' (60% confidence)
src/infrastructure/messaging/event_driven_architecture.py:38: unused variable 'query_id' (60% confidence)
src/infrastructure/messaging/event_driven_architecture.py:42: unused class 'InMemoryCommandBus' (60% confidence)
src/infrastructure/messaging/event_driven_architecture.py:46: unused method 'register_handler' (60% confidence)
src/infrastructure/messaging/event_driven_architecture.py:56: unused class 'InMemoryQueryBus' (60% confidence)
src/infrastructure/messaging/event_driven_architecture.py:61: unused method 'register_handler' (60% confidence)
src/infrastructure/messaging/event_driven_architecture.py:64: unused method 'ask' (60% confidence)
src/infrastructure/messaging/event_driven_architecture.py:80: unused function 'create_event' (60% confidence)
src/infrastructure/messaging/event_driven_architecture.py:91: unused function 'create_command' (60% confidence)
src/infrastructure/messaging/event_driven_architecture.py:95: unused function 'create_query' (60% confidence)
src/infrastructure/messaging/kafka_event_bus.py:47: unused attribute 'connection_timeout' (60% confidence)
src/infrastructure/middleware/security/headers.py:371: unused method 'get_stats' (60% confidence)
src/infrastructure/middleware/security/headers.py:388: unused method 'reset_stats' (60% confidence)
src/infrastructure/middleware/security/headers.py:394: unused method 'get_child_safety_info' (60% confidence)
src/infrastructure/middleware/security/headers.py:429: unused function 'init_security_headers' (60% confidence)
src/infrastructure/middleware/security/headers.py:446: unused function 'create_teddy_bear_security_middleware' (60% confidence)
src/infrastructure/monitoring/components/child_safety_monitor.py:20: unused attribute 'emergency_contacts' (60% confidence)
src/infrastructure/monitoring/components/child_safety_monitor.py:24: unused attribute 'unusual_activity_threshold' (60% confidence)
src/infrastructure/monitoring/components/child_safety_monitor.py:129: unused method 'get_child_safety_status' (60% confidence)
src/infrastructure/monitoring/components/monitoring_service.py:84: unused method 'record_request_time' (60% confidence)
src/infrastructure/monitoring/components/monitoring_service.py:109: unused method 'record_security_event' (60% confidence)
src/infrastructure/monitoring/components/monitoring_service.py:141: unused method 'record_child_safety_event' (60% confidence)
src/infrastructure/monitoring/components/monitoring_service.py:308: unused attribute 'resolved_at' (60% confidence)
src/infrastructure/monitoring/components/monitoring_service.py:343: unused method 'shutdown' (60% confidence)
src/infrastructure/monitoring/components/types.py:15: unused variable 'EMERGENCY' (60% confidence)
src/infrastructure/monitoring/components/types.py:23: unused variable 'HISTOGRAM' (60% confidence)
src/infrastructure/monitoring/components/types.py:32: unused variable 'ACKNOWLEDGED' (60% confidence)
src/infrastructure/monitoring/components/types.py:33: unused variable 'SUPPRESSED' (60% confidence)
src/infrastructure/monitoring/components/types.py:68: unused variable 'resolved_at' (60% confidence)
src/infrastructure/monitoring/components/types.py:69: unused variable 'acknowledged_at' (60% confidence)
src/infrastructure/monitoring/components/types.py:70: unused variable 'escalated' (60% confidence)
src/infrastructure/monitoring/comprehensive_monitoring_refactored.py:9: unused class 'ComprehensiveMonitoring' (60% confidence)
src/infrastructure/monitoring/comprehensive_monitoring_refactored.py:41: unused method 'get_metrics' (60% confidence)
src/infrastructure/monitoring/comprehensive_monitoring_refactored.py:45: unused method 'monitor_function' (60% confidence)
src/infrastructure/monitoring/comprehensive_monitoring_refactored.py:62: unused method 'monitor_coroutine' (60% confidence)
src/infrastructure/monitoring/performance_monitor.py:17: unused function 'monitor_performance' (60% confidence)
src/infrastructure/pagination/pagination_service.py:13: unused variable 'has_next' (60% confidence)
src/infrastructure/pagination/pagination_service.py:14: unused variable 'has_prev' (60% confidence)
src/infrastructure/pagination/pagination_service.py:18: unused method 'paginate' (60% confidence)
src/infrastructure/performance/batch_loader.py:11: unused class 'BatchLoader' (60% confidence)
src/infrastructure/performance/batch_loader.py:25: unused method 'load_many' (60% confidence)
src/infrastructure/performance/batch_loader.py:36: unused function 'get_child_batch_loader' (60% confidence)
src/infrastructure/performance/caching_decorators.py:11: unused function 'cached' (60% confidence)
src/infrastructure/performance/memoization.py:5: unused function 'memoize' (60% confidence)
src/infrastructure/persistence/child_repository.py:15: unused method 'get_all' (60% confidence)
src/infrastructure/persistence/conversation_repository.py:24: unused class 'AsyncSQLAlchemyConversationRepo' (60% confidence)
src/infrastructure/persistence/conversation_repository.py:56: unused method 'get_all' (60% confidence)
src/infrastructure/persistence/conversation_repository.py:148: unused method 'get_by_child_id' (60% confidence)
src/infrastructure/persistence/conversation_sqlite_repository.py:23: unused class 'ConversationSQLiteRepository' (60% confidence)
src/infrastructure/persistence/conversation_sqlite_repository.py:178: unused method 'get_conversations' (60% confidence)
src/infrastructure/persistence/conversation_sqlite_repository.py:187: unused attribute 'row_factory' (60% confidence)
src/infrastructure/persistence/conversation_sqlite_repository.py:228: unused method 'delete_child_conversations' (60% confidence)
src/infrastructure/persistence/kafka_event_store.py:18: unused class 'KafkaEventStore' (60% confidence)
src/infrastructure/persistence/kafka_event_store.py:195: unused method 'load_events_from_offset' (60% confidence)
src/infrastructure/persistence/models/child_models.py:48: unused variable 'name_encrypted' (60% confidence)
src/infrastructure/persistence/models/child_models.py:62: unused variable 'personality_traits' (60% confidence)
src/infrastructure/persistence/models/child_models.py:63: unused variable 'learning_goals' (60% confidence)
src/infrastructure/persistence/models/child_models.py:72: unused variable 'content_filters' (60% confidence)
src/infrastructure/persistence/models/child_models.py:75: unused variable 'total_interactions' (60% confidence)
src/infrastructure/persistence/models/child_models.py:76: unused variable 'last_interaction' (60% confidence)
src/infrastructure/persistence/models/child_models.py:155: unused method 'get_recommended_topics' (60% confidence)
src/infrastructure/persistence/models/child_models.py:159: unused method 'get_safety_restrictions' (60% confidence)
src/infrastructure/persistence/models/consent_models.py:22: unused variable 'CONTENT_FILTERED' (60% confidence)
src/infrastructure/persistence/models/consent_models.py:23: unused variable 'INAPPROPRIATE_REQUEST' (60% confidence)
src/infrastructure/persistence/models/consent_models.py:25: unused variable 'PARENTAL_ALERT' (60% confidence)
src/infrastructure/persistence/models/consent_models.py:66: unused variable 'verification_metadata' (60% confidence)
src/infrastructure/persistence/models/consent_models.py:108: unused variable 'event_metadata' (60% confidence)
src/infrastructure/persistence/models/consent_models.py:111: unused variable 'event_time' (60% confidence)
src/infrastructure/persistence/models/conversation_models.py:46: unused variable 'conversation_type' (60% confidence)
src/infrastructure/persistence/models/conversation_models.py:59: unused variable 'message_count' (60% confidence)
src/infrastructure/persistence/models/conversation_models.py:64: unused variable 'engagement_level' (60% confidence)
src/infrastructure/persistence/models/conversation_models.py:67: unused variable 'safety_flags' (60% confidence)
src/infrastructure/persistence/models/conversation_models.py:68: unused variable 'content_warnings' (60% confidence)
src/infrastructure/persistence/models/conversation_models.py:112: unused variable 'content_encrypted' (60% confidence)
src/infrastructure/persistence/models/parent_models.py:46: unused variable 'failed_login_attempts' (60% confidence)
src/infrastructure/persistence/models/parent_models.py:51: unused variable 'locked_until' (60% confidence)
src/infrastructure/persistence/models/user_model.py:37: unused variable 'failed_login_attempts' (60% confidence)
src/infrastructure/persistence/models/user_model.py:38: unused variable 'account_locked_until' (60% confidence)
src/infrastructure/persistence/models/user_model.py:39: unused variable 'last_password_change' (60% confidence)
src/infrastructure/persistence/models/user_model.py:51: unused variable 'parental_consent_given' (60% confidence)
src/infrastructure/persistence/models/user_model.py:52: unused variable 'parental_consent_date' (60% confidence)
src/infrastructure/persistence/models/user_model.py:53: unused variable 'data_retention_preference' (60% confidence)
src/infrastructure/persistence/postgres_event_store.py:32: unused variable 'event_version' (60% confidence)
src/infrastructure/persistence/postgres_event_store.py:39: unused variable 'event_metadata' (60% confidence)
src/infrastructure/persistence/postgres_event_store.py:52: unused class 'PostgresEventStore' (60% confidence)
src/infrastructure/persistence/postgres_event_store.py:58: unused method 'append_events' (60% confidence)
src/infrastructure/persistence/postgres_event_store.py:89: unused method 'get_events' (60% confidence)
src/infrastructure/persistence/redis_accessibility_profile_repository.py:18: unused class 'RedisAccessibilityProfileRepository' (60% confidence)
src/infrastructure/persistence/redis_accessibility_profile_repository.py:100: unused method 'delete_profile' (60% confidence)
src/infrastructure/persistence/redis_accessibility_profile_repository.py:120: unused method 'get_all_profiles' (60% confidence)
src/infrastructure/persistence/redis_notification_repository.py:19: unused class 'RedisNotificationRepository' (60% confidence)
src/infrastructure/persistence/redis_notification_repository.py:143: unused method 'delete_notification' (60% confidence)
src/infrastructure/persistence/redis_personality_profile_repository.py:19: unused class 'RedisPersonalityProfileRepository' (60% confidence)
src/infrastructure/persistence/redis_personality_profile_repository.py:92: unused method 'delete_profile' (60% confidence)
src/infrastructure/persistence/redis_personality_profile_repository.py:112: unused method 'get_all_profiles' (60% confidence)
src/infrastructure/persistence/redis_session_repository.py:14: unused class 'RedisSessionRepository' (60% confidence)
src/infrastructure/persistence/redis_session_repository.py:95: unused method 'delete_expired' (60% confidence)
src/infrastructure/persistence/repositories.py:14: unused class 'DataRepository' (60% confidence)
src/infrastructure/persistence/repositories.py:26: unused attribute 'max_data_size' (60% confidence)
src/infrastructure/persistence/repositories.py:129: unused method 'clean_expired_data' (60% confidence)
src/infrastructure/persistence/repositories/safety_repository.py:21: unused class 'SafetyRepository' (60% confidence)
src/infrastructure/persistence/repositories/safety_repository.py:81: unused method 'get_safety_alerts' (60% confidence)
src/infrastructure/persistence/repositories/safety_repository.py:104: unused method 'get_child_safety_score' (60% confidence)
src/infrastructure/persistence/repositories/usage_repository.py:21: unused class 'UsageRepository' (60% confidence)
src/infrastructure/persistence/repositories/usage_repository.py:83: unused method 'get_usage_summary' (60% confidence)
src/infrastructure/persistence/repositories/user_repository.py:27: unused class 'UserRepository' (60% confidence)
src/infrastructure/persistence/repositories/user_repository.py:40: unused method 'create_user' (60% confidence)
src/infrastructure/persistence/repositories/user_repository.py:105: unused method 'get_user_by_email' (60% confidence)
src/infrastructure/persistence/repositories/user_repository.py:134: unused method 'update_user_role' (60% confidence)
src/infrastructure/read_models/child_profile_read_model.py:28: unused method 'get_all' (60% confidence)
src/infrastructure/repositories/event_sourced_child_repository.py:31: unused method 'get_all' (60% confidence)
src/infrastructure/resilience/circuit_breaker.py:166: unused function 'circuit_breaker' (60% confidence)
src/infrastructure/resilience/circuit_breaker.py:194: unused attribute 'circuit_breaker' (60% confidence)
src/infrastructure/resilience/circuit_breaker.py:195: unused attribute 'get_circuit_status' (60% confidence)
src/infrastructure/resilience/circuit_breaker.py:205: unused function 'get_circuit_breaker' (60% confidence)
src/infrastructure/resilience/circuit_breaker.py:232: unused function 'get_all_circuit_breaker_status' (60% confidence)
src/infrastructure/resilience/retry_decorator.py:121: unused function 'retry_external_api' (60% confidence)
src/infrastructure/security/access_control_service.py:37: unused class 'AccessControlService' (60% confidence)
src/infrastructure/security/access_control_service.py:83: unused method 'register_parent_child_relationship' (60% confidence)
src/infrastructure/security/access_control_service.py:132: unused method 'verify_access' (60% confidence)
src/infrastructure/security/access_control_service.py:285: unused method 'validate_access_token' (60% confidence)
src/infrastructure/security/api_security_manager.py:11: unused class 'APISecurityManager' (60% confidence)
src/infrastructure/security/api_security_manager.py:72: unused method 'unblock_ip' (60% confidence)
src/infrastructure/security/api_security_manager.py:141: unused method 'validate_child_input' (60% confidence)
src/infrastructure/security/audit_decorators.py:316: unused function 'audit_security_event' (60% confidence)
src/infrastructure/security/audit_decorators.py:459: unused function 'audit_login' (60% confidence)
src/infrastructure/security/audit_decorators.py:467: unused function 'audit_logout' (60% confidence)
src/infrastructure/security/audit_decorators.py:475: unused function 'audit_child_create' (60% confidence)
src/infrastructure/security/audit_decorators.py:488: unused function 'audit_child_update' (60% confidence)
src/infrastructure/security/audit_decorators.py:501: unused function 'audit_child_delete' (60% confidence)
src/infrastructure/security/audit_logger.py:27: unused variable 'PARENT_VERIFICATION' (60% confidence)
src/infrastructure/security/audit_logger.py:28: unused variable 'DATA_RETENTION' (60% confidence)
src/infrastructure/security/audit_logger.py:30: unused variable 'ACCESS_CONTROL' (60% confidence)
src/infrastructure/security/audit_logger.py:46: unused variable 'PERMISSION_CHANGE' (60% confidence)
src/infrastructure/security/audit_logger.py:50: unused variable 'CHILD_INTERACTION_END' (60% confidence)
src/infrastructure/security/audit_logger.py:52: unused variable 'CONTENT_FILTERED' (60% confidence)
src/infrastructure/security/audit_logger.py:59: unused variable 'DATA_EXPORT' (60% confidence)
src/infrastructure/security/audit_logger.py:60: unused variable 'ENCRYPTION_EVENT' (60% confidence)
src/infrastructure/security/audit_logger.py:90: unused variable 'max_files' (60% confidence)
src/infrastructure/security/audit_logger.py:118: unused variable 'checksum' (60% confidence)
src/infrastructure/security/audit_logger.py:202: unused attribute 'checksum' (60% confidence)
src/infrastructure/security/audit_logger.py:313: unused method 'log_data_access' (60% confidence)
src/infrastructure/security/audit_logger.py:499: unused function 'log_audit_event' (60% confidence)
src/infrastructure/security/audit_logger.py:517: unused function 'log_child_safety_incident' (60% confidence)
src/infrastructure/security/child_data_security_manager.py:19: unused class 'ChildDataSecurityManager' (60% confidence)
src/infrastructure/security/child_data_security_manager.py:26: unused method 'secure_child_profile' (60% confidence)
src/infrastructure/security/child_data_security_manager.py:65: unused method 'get_child_data_for_interaction' (60% confidence)
src/infrastructure/security/child_data_security_manager.py:88: unused method 'schedule_data_cleanup' (60% confidence)
src/infrastructure/security/comprehensive_audit_integration.py:17: unused class 'AuditableOperation' (60% confidence)
src/infrastructure/security/comprehensive_audit_integration.py:268: unused method 'log_system_event' (60% confidence)
src/infrastructure/security/comprehensive_audit_integration.py:336: unused function 'audit_authorization' (60% confidence)
src/infrastructure/security/comprehensive_audit_integration.py:345: unused function 'audit_child_data_operation' (60% confidence)
src/infrastructure/security/comprehensive_audit_integration.py:354: unused function 'audit_coppa_event' (60% confidence)
src/infrastructure/security/comprehensive_audit_integration.py:367: unused function 'audit_security_event' (60% confidence)
src/infrastructure/security/coppa/data_models.py:33: unused variable 'data_collection_consent' (60% confidence)
src/infrastructure/security/coppa/data_models.py:57: unused variable 'scheduled_deletion' (60% confidence)
src/infrastructure/security/coppa/data_models.py:63: unused variable 'privacy_level' (60% confidence)
src/infrastructure/security/coppa/data_models.py:64: unused variable 'location_tracking' (60% confidence)
src/infrastructure/security/coppa/data_models.py:68: unused variable 'third_party_sharing' (60% confidence)
src/infrastructure/security/coppa/data_models.py:83: unused method 'validate_coppa_age' (60% confidence)
src/infrastructure/security/coppa/data_models.py:93: unused method 'validate_consent_date' (60% confidence)
src/infrastructure/security/coppa/data_models.py:144: unused variable 'policy_id' (60% confidence)
src/infrastructure/security/coppa/data_models.py:148: unused variable 'retention_period_days' (60% confidence)
src/infrastructure/security/coppa/data_models.py:149: unused variable 'auto_delete_enabled' (60% confidence)
src/infrastructure/security/coppa/data_models.py:150: unused variable 'deletion_scheduled_date' (60% confidence)
src/infrastructure/security/coppa/data_models.py:153: unused variable 'conversation_data_days' (60% confidence)
src/infrastructure/security/coppa/data_models.py:154: unused variable 'voice_data_days' (60% confidence)
src/infrastructure/security/coppa/data_models.py:155: unused variable 'analytics_data_days' (60% confidence)
src/infrastructure/security/coppa/data_models.py:156: unused variable 'log_data_days' (60% confidence)
src/infrastructure/security/coppa/data_models.py:159: unused variable 'coppa_compliance_mode' (60% confidence)
src/infrastructure/security/coppa/data_models.py:160: unused variable 'gdpr_compliance_mode' (60% confidence)
src/infrastructure/security/coppa/data_models.py:161: unused variable 'california_ccpa_mode' (60% confidence)
src/infrastructure/security/coppa/data_models.py:169: unused variable 'log_id' (60% confidence)
src/infrastructure/security/coppa/data_models.py:177: unused variable 'event_description' (60% confidence)
src/infrastructure/security/coppa/data_models.py:180: unused variable 'actor_type' (60% confidence)
src/infrastructure/security/coppa/data_models.py:184: unused variable 'actor_id' (60% confidence)
src/infrastructure/security/coppa/data_models.py:191: unused variable 'target_id' (60% confidence)
src/infrastructure/security/coppa/data_models.py:199: unused variable 'coppa_relevant' (60% confidence)
src/infrastructure/security/coppa/data_models.py:203: unused variable 'gdpr_relevant' (60% confidence)
src/infrastructure/security/coppa/data_models.py:223: unused variable 'deletion_type' (60% confidence)
src/infrastructure/security/coppa/data_models.py:235: unused variable 'scheduled_for' (60% confidence)
src/infrastructure/security/coppa/data_models.py:239: unused variable 'completed_at' (60% confidence)
src/infrastructure/security/coppa/data_models.py:246: unused variable 'verification_required' (60% confidence)
src/infrastructure/security/coppa/data_models.py:250: unused variable 'verified_at' (60% confidence)
src/infrastructure/security/coppa/data_models.py:256: unused variable 'processed_by' (60% confidence)
src/infrastructure/security/coppa/data_models.py:260: unused variable 'processing_notes' (60% confidence)
src/infrastructure/security/coppa/data_retention.py:43: unused method 'create_retention_policy' (60% confidence)
src/infrastructure/security/coppa/data_retention.py:91: unused method 'schedule_automatic_deletion' (60% confidence)
src/infrastructure/security/coppa/data_retention.py:119: unused method 'process_expired_data' (60% confidence)
src/infrastructure/security/coppa/data_retention.py:325: unused variable 'audit_record' (60% confidence)
src/infrastructure/security/coppa/data_retention.py:373: unused method 'extend_retention_period' (60% confidence)
src/infrastructure/security/coppa/data_retention.py:392: unused method 'generate_retention_report' (60% confidence)
src/infrastructure/security/coppa_validator.py:55: unused attribute '_validation_cache' (60% confidence)
src/infrastructure/security/coppa_validator.py:210: unused method 'get_content_filtering_level' (60% confidence)
src/infrastructure/security/coppa_validator.py:230: unused method 'validate_age_range' (60% confidence)
src/infrastructure/security/cors_service.py:29: unused variable 'policy_level' (60% confidence)
src/infrastructure/security/cors_service.py:37: unused class 'CORSSecurityService' (60% confidence)
src/infrastructure/security/cors_service.py:210: unused method 'handle_preflight_request' (60% confidence)
src/infrastructure/security/cors_service.py:271: unused method 'get_security_headers' (60% confidence)
src/infrastructure/security/cors_service.py:457: unused method 'get_cors_statistics' (60% confidence)
src/infrastructure/security/cors_service.py:469: unused method 'add_allowed_origin' (60% confidence)
src/infrastructure/security/cors_service.py:501: unused method 'remove_allowed_origin' (60% confidence)
src/infrastructure/security/database_input_validator.py:379: unused method 'safe_insert' (60% confidence)
src/infrastructure/security/database_input_validator.py:388: unused method 'safe_update' (60% confidence)
src/infrastructure/security/database_input_validator.py:407: unused method 'safe_select' (60% confidence)
src/infrastructure/security/database_input_validator.py:430: unused method 'get_security_log' (60% confidence)
src/infrastructure/security/environment_validator.py:193: unused method 'get_secure_config' (60% confidence)
src/infrastructure/security/fallback_rate_limiter.py:127: unused method 'remove_custom_limit' (60% confidence)
src/infrastructure/security/fallback_rate_limiter.py:249: unused class 'FallbackRateLimitService' (60% confidence)
src/infrastructure/security/file_security_manager.py:12: unused class 'AudioFileSecurityManager' (60% confidence)
src/infrastructure/security/hardening/csrf_protection.py:117: unused method 'invalidate_token' (60% confidence)
src/infrastructure/security/hardening/csrf_protection.py:132: unused method 'invalidate_session_tokens' (60% confidence)
src/infrastructure/security/hardening/csrf_protection.py:168: unused method 'get_token_stats' (60% confidence)
src/infrastructure/security/hardening/csrf_protection.py:195: unused method 'generate_token_for_request' (60% confidence)
src/infrastructure/security/hardening/csrf_protection.py:234: unused method 'set_csrf_cookie' (60% confidence)
src/infrastructure/security/hardening/secure_settings.py:26: unused variable 'app_name' (60% confidence)
src/infrastructure/security/hardening/secure_settings.py:27: unused variable 'app_version' (60% confidence)
src/infrastructure/security/hardening/secure_settings.py:49: unused variable 'database_pool_size' (60% confidence)
src/infrastructure/security/hardening/secure_settings.py:55: unused variable 'database_max_overflow' (60% confidence)
src/infrastructure/security/hardening/secure_settings.py:64: unused variable 'anthropic_api_key' (60% confidence)
src/infrastructure/security/hardening/secure_settings.py:68: unused variable 'azure_speech_key' (60% confidence)
src/infrastructure/security/hardening/secure_settings.py:74: unused variable 'enable_security_headers' (60% confidence)
src/infrastructure/security/hardening/secure_settings.py:78: unused variable 'enable_rate_limiting' (60% confidence)
src/infrastructure/security/hardening/secure_settings.py:80: unused class 'Config' (60% confidence)
src/infrastructure/security/hardening/secure_settings.py:82: unused variable 'env_file_encoding' (60% confidence)
src/infrastructure/security/hardening/secure_settings.py:83: unused variable 'extra' (60% confidence)
src/infrastructure/security/hardening/secure_settings.py:86: unused function 'get_secure_settings' (60% confidence)
src/infrastructure/security/hardening/security_tests.py:23: unused function 'run_security_tests' (60% confidence)
src/infrastructure/security/hardening/security_tests/base_tester.py:17: unused attribute 'test_results' (60% confidence)
src/infrastructure/security/hardening/security_validator.py:1: unused import 'SecurityLevel' (90% confidence)
src/infrastructure/security/hardening/security_validator.py:9: unused import 'Set' (90% confidence)
src/infrastructure/security/hardening/security_validator.py:9: unused import 'Tuple' (90% confidence)
src/infrastructure/security/hardening/security_validator.py:11: unused import 'timezone' (90% confidence)
src/infrastructure/security/hardening/validation/sanitizer.py:243: unused method 'sanitize_json' (60% confidence)
src/infrastructure/security/hardening/validation/sanitizer.py:373: unused function 'sanitize_adult_input' (60% confidence)
src/infrastructure/security/input_validation/core.py:22: unused attribute 'detected_at' (60% confidence)
src/infrastructure/security/input_validation/core.py:39: unused attribute 'has_critical_threats' (60% confidence)
src/infrastructure/security/input_validation/core.py:40: unused attribute 'has_child_safety_issues' (60% confidence)
src/infrastructure/security/input_validation/detectors.py:298: unused function 'is_text_safe' (60% confidence)
src/infrastructure/security/input_validation/middleware.py:376: unused function 'setup_child_safe_middleware' (60% confidence)
src/infrastructure/security/input_validation/middleware.py:383: unused function 'setup_development_middleware' (60% confidence)
src/infrastructure/security/input_validation/middleware.py:390: unused function 'setup_production_middleware' (60% confidence)
src/infrastructure/security/input_validation/patterns.py:103: unused method 'get_all_patterns' (60% confidence)
src/infrastructure/security/input_validation/patterns.py:159: unused function 'test_xss_attack' (60% confidence)
src/infrastructure/security/input_validation/patterns.py:171: unused function 'test_command_injection' (60% confidence)
src/infrastructure/security/input_validation/patterns.py:177: unused function 'is_child_safe' (60% confidence)
src/infrastructure/security/input_validation/patterns.py:183: unused function 'has_pii' (60% confidence)
src/infrastructure/security/input_validation/validator.py:388: unused function 'validate_parent_input' (60% confidence)
src/infrastructure/security/input_validation/validator.py:395: unused function 'validate_admin_input' (60% confidence)
src/infrastructure/security/input_validation/validator.py:411: unused function 'has_security_threats' (60% confidence)
src/infrastructure/security/input_validation/validator.py:417: unused function 'get_threat_summary' (60% confidence)
src/infrastructure/security/key_management/key_rotation_orchestrator.py:92: unused method 'rotate_all_keys' (60% confidence)
src/infrastructure/security/key_management/rotation_statistics.py:95: unused method 'get_key_usage_report' (60% confidence)
src/infrastructure/security/key_management/rotation_statistics.py:122: unused method 'get_rotation_history' (60% confidence)
src/infrastructure/security/key_rotation_service.py:38: unused variable 'COMPLIANCE_REQUIREMENT' (60% confidence)
src/infrastructure/security/key_rotation_service.py:39: unused variable 'AGE_LIMIT' (60% confidence)
src/infrastructure/security/key_rotation_service.py:79: unused variable 'max_key_age' (60% confidence)
src/infrastructure/security/key_rotation_service.py:80: unused variable 'auto_rotate' (60% confidence)
src/infrastructure/security/key_rotation_service.py:100: unused class 'KeyRotationService' (60% confidence)
src/infrastructure/security/key_rotation_service.py:140: unused method 'get_active_key' (60% confidence)
src/infrastructure/security/log_sanitization_config.py:58: unused function 'create_child_safe_log_sanitization_config' (60% confidence)
src/infrastructure/security/log_sanitizer.py:25: unused variable 'SSN' (60% confidence)
src/infrastructure/security/log_sanitizer.py:26: unused variable 'CREDIT_CARD' (60% confidence)
src/infrastructure/security/log_sanitizer.py:27: unused variable 'ADDRESS' (60% confidence)
src/infrastructure/security/log_sanitizer.py:28: unused variable 'NAME' (60% confidence)
src/infrastructure/security/logging_security_monitor.py:15: unused class 'LoggingSecurityMonitor' (60% confidence)
src/infrastructure/security/logging_security_monitor.py:22: unused attribute 'violations_found' (60% confidence)
src/infrastructure/security/logging_security_monitor.py:37: unused method 'scan_codebase_for_violations' (60% confidence)
src/infrastructure/security/main_security_service.py:45: unused method 'create_token' (60% confidence)
src/infrastructure/security/main_security_service.py:63: unused method 'generate_secure_password' (60% confidence)
src/infrastructure/security/main_security_service.py:111: unused method 'generate_session_id' (60% confidence)
src/infrastructure/security/main_security_service.py:115: unused method 'generate_csrf_token' (60% confidence)
src/infrastructure/security/main_security_service.py:119: unused method 'validate_production_environment_security' (60% confidence)
src/infrastructure/security/models.py:6: unused class 'EncryptionMetadata' (60% confidence)
src/infrastructure/security/models.py:10: unused variable 'encrypted_at' (60% confidence)
src/infrastructure/security/models.py:11: unused variable 'encryption_version' (60% confidence)
src/infrastructure/security/models.py:13: unused variable 'field_count' (60% confidence)
src/infrastructure/security/models.py:14: unused variable 'checksum' (60% confidence)
src/infrastructure/security/models.py:17: unused class 'COPPAValidatorRecord' (60% confidence)
src/infrastructure/security/models.py:22: unused variable 'parental_consent_given' (60% confidence)
src/infrastructure/security/models.py:24: unused variable 'consent_method' (60% confidence)
src/infrastructure/security/models.py:25: unused variable 'consent_ip_address' (60% confidence)
src/infrastructure/security/models.py:27: unused variable 'audit_trail' (60% confidence)
src/infrastructure/security/password_hasher.py:9: unused class 'PasswordHasher' (60% confidence)
src/infrastructure/security/path_validator.py:24: unused variable 'case_sensitive' (60% confidence)
src/infrastructure/security/plugin_architecture.py:19: unused variable 'AI_SERVICE' (60% confidence)
src/infrastructure/security/plugin_architecture.py:20: unused variable 'CUSTOM' (60% confidence)
src/infrastructure/security/plugin_architecture.py:21: unused variable 'AUDIO_PROCESSOR' (60% confidence)
src/infrastructure/security/plugin_architecture.py:22: unused variable 'LANGUAGE_PROCESSOR' (60% confidence)
src/infrastructure/security/plugin_architecture.py:23: unused variable 'SECURITY_VALIDATOR' (60% confidence)
src/infrastructure/security/plugin_architecture.py:32: unused variable 'DISABLED' (60% confidence)
src/infrastructure/security/plugin_architecture.py:46: unused variable 'min_python_version' (60% confidence)
src/infrastructure/security/plugin_architecture.py:47: unused variable 'child_safe' (60% confidence)
src/infrastructure/security/plugin_architecture.py:48: unused variable 'security_validated' (60% confidence)
src/infrastructure/security/plugin_architecture.py:184: unused method 'load_plugin' (60% confidence)
src/infrastructure/security/plugin_architecture.py:232: unused method 'activate_plugin' (60% confidence)
src/infrastructure/security/plugin_architecture.py:253: unused method 'deactivate_plugin' (60% confidence)
src/infrastructure/security/plugin_architecture.py:270: unused method 'execute_plugin' (60% confidence)
src/infrastructure/security/plugin_architecture.py:281: unused method 'list_plugins' (60% confidence)
src/infrastructure/security/plugin_architecture.py:292: unused method 'get_plugins_by_type' (60% confidence)
src/infrastructure/security/plugin_architecture.py:339: unused function 'create_plugin_manager' (60% confidence)
src/infrastructure/security/plugin_architecture.py:344: unused function 'create_plugin_manifest' (60% confidence)
src/infrastructure/security/rate_limiter.py:76: unused variable 'exc_class' (100% confidence)
src/infrastructure/security/rate_limiter.py:120: unused method 'get_limiter' (60% confidence)
src/infrastructure/security/rate_limiter.py:172: unused method 'reset_child_interactions' (60% confidence)
src/infrastructure/security/rate_limiter.py:178: unused method 'register_rate_limit_handler' (60% confidence)
src/infrastructure/security/rate_limiter.py:186: unused function 'rate_limit_exceeded_handler' (60% confidence)
src/infrastructure/security/rate_limiter.py:238: unused function 'create_rate_limiter_dependency' (60% confidence)
src/infrastructure/security/rate_limiter.py:246: unused function 'check_child_rate_limit' (60% confidence)
src/infrastructure/security/rate_limiter/core.py:22: unused variable 'REQUESTS_PER_HOUR' (60% confidence)
src/infrastructure/security/rate_limiter/core.py:23: unused variable 'REQUESTS_PER_DAY' (60% confidence)
src/infrastructure/security/rate_limiter/core.py:26: unused variable 'API_CALLS' (60% confidence)
src/infrastructure/security/rate_limiter/core.py:36: unused variable 'LEAKY_BUCKET' (60% confidence)
src/infrastructure/security/rate_limiter/core.py:44: unused variable 'requests_per_hour' (60% confidence)
src/infrastructure/security/rate_limiter/core.py:45: unused variable 'requests_per_day' (60% confidence)
src/infrastructure/security/rate_limiter/core.py:47: unused variable 'window_type' (60% confidence)
src/infrastructure/security/rate_limiter/core.py:51: unused variable 'child_requests_per_hour' (60% confidence)
src/infrastructure/security/rate_limiter/core.py:55: unused variable 'parent_requests_per_hour' (60% confidence)
src/infrastructure/security/rate_limiter/core.py:213: unused function 'get_child_safety_limiter' (60% confidence)
src/infrastructure/security/rate_limiter/service.py:51: unused variable 'request_details' (100% confidence)
src/infrastructure/security/rate_limiter_service.py:73: unused method 'record_failed_login' (60% confidence)
src/infrastructure/security/rate_limiter_service.py:80: unused method 'reset_login_attempts' (60% confidence)
src/infrastructure/security/real_auth_service.py:46: unused method 'authenticate' (60% confidence)
src/infrastructure/security/real_auth_service.py:58: unused method 'get_user_info' (60% confidence)
src/infrastructure/security/request_signing_service.py:1: unused import 'RequestSecurityLevel' (90% confidence)
src/infrastructure/security/request_signing_service.py:24: unused class 'SignatureAlgorithm' (60% confidence)
src/infrastructure/security/request_signing_service.py:27: unused variable 'HMAC_SHA256' (60% confidence)
src/infrastructure/security/request_signing_service.py:28: unused variable 'HMAC_SHA512' (60% confidence)
src/infrastructure/security/robust_encryption_service.py:52: unused class 'EncryptionLevel' (60% confidence)
src/infrastructure/security/robust_encryption_service.py:55: unused variable 'BASIC' (60% confidence)
src/infrastructure/security/robust_encryption_service.py:56: unused variable 'STANDARD' (60% confidence)
src/infrastructure/security/robust_encryption_service.py:57: unused variable 'ENHANCED' (60% confidence)
src/infrastructure/security/robust_encryption_service.py:58: unused variable 'MAXIMUM' (60% confidence)
src/infrastructure/security/robust_encryption_service.py:66: unused variable 'MANDATORY' (60% confidence)
src/infrastructure/security/robust_encryption_service.py:76: unused variable 'require_authentication' (60% confidence)
src/infrastructure/security/robust_encryption_service.py:79: unused variable 'key_rotation_days' (60% confidence)
src/infrastructure/security/robust_encryption_service.py:590: unused method 'get_encryption_status' (60% confidence)
src/infrastructure/security/robust_encryption_service.py:617: unused function 'encrypt_sensitive_data' (60% confidence)
src/infrastructure/security/robust_encryption_service.py:627: unused function 'decrypt_sensitive_data' (60% confidence)
src/infrastructure/security/safe_expression_parser/__init__.py:8: unused class 'ExpressionContext' (60% confidence)
src/infrastructure/security/safe_expression_parser/__init__.py:13: unused class 'SafeExpressionConfig' (60% confidence)
src/infrastructure/security/safe_expression_parser/__init__.py:18: unused class 'SafeExpressionParser' (60% confidence)
src/infrastructure/security/safe_expression_parser/__init__.py:22: unused method 'evaluate' (60% confidence)
src/infrastructure/security/safe_expression_parser/__init__.py:22: unused variable 'expression' (100% confidence)
src/infrastructure/security/safety_monitor_service.py:74: unused method 'check_content' (60% confidence)
src/infrastructure/security/safety_monitor_service.py:138: unused method 'check_audio' (60% confidence)
src/infrastructure/security/secure_logger.py:343: unused function 'create_child_safe_logger' (60% confidence)
src/infrastructure/security/secure_logger.py:397: unused function 'secure_log_call' (60% confidence)
src/infrastructure/security/secure_user_registration.py:30: unused class 'SecureUserRegistration' (60% confidence)
src/infrastructure/security/secure_user_registration.py:119: unused method 'verify_email_token' (60% confidence)
src/infrastructure/security/secure_user_registration.py:139: unused method 'register_parent_user' (60% confidence)
src/infrastructure/security/secure_user_registration.py:240: unused method 'resend_verification_email' (60% confidence)
src/infrastructure/security/security_headers_service.py:1: unused import 'SecurityLevel' (90% confidence)
src/infrastructure/security/security_levels.py:6: unused class 'SecurityLevel' (60% confidence)
src/infrastructure/security/security_levels.py:9: unused variable 'DEVELOPMENT' (60% confidence)
src/infrastructure/security/security_levels.py:10: unused variable 'STAGING' (60% confidence)
src/infrastructure/security/security_levels.py:11: unused variable 'PRODUCTION' (60% confidence)
src/infrastructure/security/security_levels.py:12: unused variable 'CHILD_STRICT' (60% confidence)
src/infrastructure/security/security_levels.py:13: unused variable 'CHILD_SAFETY_ENHANCED' (60% confidence)
src/infrastructure/security/security_levels.py:14: unused variable 'PARENT_MODERATE' (60% confidence)
src/infrastructure/security/security_levels.py:15: unused variable 'ADMIN_STRICT' (60% confidence)
src/infrastructure/security/security_levels.py:18: unused class 'RequestSecurityLevel' (60% confidence)
src/infrastructure/security/security_levels.py:21: unused variable 'CHILD_INTERACTION' (60% confidence)
src/infrastructure/security/security_levels.py:22: unused variable 'PARENT_ACCESS' (60% confidence)
src/infrastructure/security/security_levels.py:23: unused variable 'ADMIN_ACCESS' (60% confidence)
src/infrastructure/security/security_manager.py:45: unused method 'generate_secure_token' (60% confidence)
src/infrastructure/security/security_manager.py:58: unused method 'secure_compare' (60% confidence)
src/infrastructure/security/security_manager.py:72: unused method 'generate_file_signature' (60% confidence)
src/infrastructure/security/security_manager.py:92: unused variable 'security_manager' (60% confidence)
src/infrastructure/security/security_middleware.py:15: unused import 'Receive' (90% confidence)
src/infrastructure/security/security_middleware.py:15: unused import 'Scope' (90% confidence)
src/infrastructure/security/security_middleware.py:15: unused import 'Send' (90% confidence)
src/infrastructure/security/security_middleware.py:50: unused variable 'seconds' (100% confidence)
src/infrastructure/security/security_middleware.py:59: unused variable 'seconds' (100% confidence)
src/infrastructure/security/security_middleware.py:121: unused method 'clear_failed_attempts' (60% confidence)
src/infrastructure/security/security_middleware.py:472: unused function 'setup_security_middleware' (60% confidence)
src/infrastructure/security/security_middleware.py:509: unused function 'get_security_status' (60% confidence)
src/infrastructure/security/sql_injection_protection.py:107: unused method 'check_ip_blocked' (60% confidence)
src/infrastructure/security/sql_injection_protection.py:117: unused method 'unblock_ip' (60% confidence)
src/infrastructure/security/sql_injection_protection.py:123: unused method 'record_attack_attempt' (60% confidence)
src/infrastructure/security/sql_injection_protection.py:276: unused method 'reset_protection_state' (60% confidence)
src/infrastructure/security/sql_injection_protection.py:282: unused method 'export_security_report' (60% confidence)
src/infrastructure/security/sql_injection_protection.py:323: unused function 'validate_query_safe' (60% confidence)
src/infrastructure/security/sql_injection_protection.py:330: unused function 'sanitize_user_input' (60% confidence)
src/infrastructure/security/sql_injection_protection.py:337: unused function 'validate_child_query_safe' (60% confidence)
src/infrastructure/security/sql_injection_protection.py:344: unused function 'setup_sql_protection' (60% confidence)
src/infrastructure/security/sql_injection_protection.py:355: unused variable 'SQLInjectionPrevention' (60% confidence)
src/infrastructure/security/sql_injection_protection.py:356: unused variable 'create_sql_injection_prevention' (60% confidence)
src/infrastructure/security/token_service.py:13: unused class 'TokenService' (60% confidence)
src/infrastructure/security/token_service.py:52: unused method 'create_refresh_token' (60% confidence)
src/infrastructure/security/token_service.py:84: unused method 'refresh_access_token' (60% confidence)
src/infrastructure/security/validation/query_validator.py:259: unused method 'sanitize_query_string' (60% confidence)
src/infrastructure/security/validation/query_validator.py:276: unused method 'get_safe_limit_offset' (60% confidence)
src/infrastructure/security/validation/query_validator.py:331: unused function 'validate_params' (60% confidence)
src/infrastructure/security/validation/query_validator.py:337: unused function 'is_safe_table' (60% confidence)
src/infrastructure/security/validation/query_validator.py:343: unused function 'is_safe_column' (60% confidence)
src/infrastructure/security/validation/query_validator.py:349: unused function 'create_safe_where' (60% confidence)
src/infrastructure/security/vault_client.py:97: unused method 'put_secret' (60% confidence)
src/infrastructure/services/data_retention_service.py:22: unused variable 'PENDING_DELETION' (60% confidence)
src/infrastructure/services/data_retention_service.py:101: unused method 'schedule_daily_retention_check' (60% confidence)
src/infrastructure/services/data_retention_service.py:172: unused variable 'email_content' (60% confidence)
src/infrastructure/services/data_retention_service.py:396: unused variable 'email_content' (60% confidence)
src/infrastructure/services/data_retention_service.py:525: unused method 'get_retention_status' (60% confidence)
src/infrastructure/services/data_retention_service.py:545: unused method 'generate_compliance_report' (60% confidence)
src/infrastructure/services/data_retention_service.py:599: unused function 'register_child_for_retention' (60% confidence)
src/infrastructure/services/data_retention_service.py:609: unused function 'extend_child_retention' (60% confidence)
src/infrastructure/services/data_retention_service.py:619: unused function 'request_child_deletion' (60% confidence)
src/infrastructure/session_manager/session_models.py:11: unused class 'Session' (60% confidence)
src/infrastructure/session_manager/session_models.py:19: unused variable 'ended_at' (60% confidence)
src/infrastructure/session_manager/session_models.py:20: unused variable 'end_reason' (60% confidence)
src/infrastructure/state/application_state_manager.py:7: unused variable 'REQUEST' (60% confidence)
src/infrastructure/state/application_state_manager.py:9: unused variable 'APPLICATION' (60% confidence)
src/infrastructure/state/application_state_manager.py:17: unused method 'set_state' (60% confidence)
src/infrastructure/state/application_state_manager.py:29: unused method 'has_state' (60% confidence)
src/infrastructure/state/application_state_manager.py:32: unused method 'delete_state' (60% confidence)
src/infrastructure/state/application_state_manager.py:36: unused method 'async_request_context' (60% confidence)
src/infrastructure/state/application_state_manager.py:38: unused function '__aenter__' (60% confidence)
src/infrastructure/state/application_state_manager.py:41: unused function '__aexit__' (60% confidence)
src/infrastructure/state/application_state_manager.py:41: unused variable 'exc_tb' (100% confidence)
src/infrastructure/state/application_state_manager.py:41: unused variable 'exc_type' (100% confidence)
src/infrastructure/state/application_state_manager.py:41: unused variable 'exc_val' (100% confidence)
src/infrastructure/state/application_state_manager.py:46: unused method 'session_context' (60% confidence)
src/infrastructure/state/application_state_manager.py:48: unused function '__enter__' (60% confidence)
src/infrastructure/state/application_state_manager.py:51: unused function '__exit__' (60% confidence)
src/infrastructure/state/application_state_manager.py:51: unused variable 'exc_tb' (100% confidence)
src/infrastructure/state/application_state_manager.py:51: unused variable 'exc_type' (100% confidence)
src/infrastructure/state/application_state_manager.py:51: unused variable 'exc_val' (100% confidence)
src/infrastructure/state/application_state_manager.py:57: unused function 'create_state_manager' (60% confidence)
src/infrastructure/validation/comprehensive_validator.py:218: unused method 'validate_parent_data' (60% confidence)
src/infrastructure/validation/comprehensive_validator.py:260: unused method 'validate_search_query' (60% confidence)
src/infrastructure/validation/emergency_contact_validator.py:15: unused class 'EmergencyContact' (60% confidence)
src/infrastructure/validation/emergency_contact_validator.py:24: unused variable 'is_primary' (60% confidence)
src/infrastructure/validation/emergency_contact_validator.py:27: unused class 'EmergencyContactValidator' (60% confidence)
src/infrastructure/validation/emergency_contact_validator.py:142: unused method 'validate_emergency_contacts_list' (60% confidence)
src/infrastructure/validation/emergency_contact_validator.py:368: unused method 'get_contact_accessibility_score' (60% confidence)
src/infrastructure/validation/general_input_validator.py:6: unused method 'validate_text' (60% confidence)
src/presentation/api/decorators/rate_limit.py:28: unused attribute '_rate_limit' (60% confidence)
src/presentation/api/decorators/rate_limit.py:34: unused attribute '_rate_limit' (60% confidence)
src/presentation/api/decorators/rate_limit.py:40: unused function 'strict_limit' (60% confidence)
src/presentation/api/decorators/rate_limit.py:45: unused function 'moderate_limit' (60% confidence)
src/presentation/api/decorators/rate_limit.py:50: unused function 'relaxed_limit' (60% confidence)
src/presentation/api/decorators/rate_limit.py:55: unused function 'child_safety_limit' (60% confidence)
src/presentation/api/decorators/rate_limit.py:92: unused function 'auth_rate_limit' (60% confidence)
src/presentation/api/decorators/rate_limit.py:97: unused function 'registration_rate_limit' (60% confidence)
src/presentation/api/decorators/rate_limit.py:102: unused function 'conversation_rate_limit' (60% confidence)
src/presentation/api/decorators/rate_limit.py:107: unused function 'file_upload_rate_limit' (60% confidence)
src/presentation/api/decorators/rate_limit.py:112: unused function 'health_check_rate_limit' (60% confidence)
src/presentation/api/decorators/rate_limit.py:118: unused function 'child_audio_rate_limit' (60% confidence)
src/presentation/api/decorators/rate_limit.py:123: unused function 'child_message_rate_limit' (60% confidence)
src/presentation/api/decorators/rate_limit.py:128: unused function 'emergency_contact_rate_limit' (60% confidence)
src/presentation/api/dependencies/base.py:8: unused class 'ServiceFactory' (60% confidence)
src/presentation/api/emergency_response/endpoints.py:46: unused method 'webhook_alerts' (60% confidence)
src/presentation/api/emergency_response/endpoints.py:111: unused method 'get_alerts' (60% confidence)
src/presentation/api/emergency_response/endpoints.py:167: unused method 'emergency_contact_alert' (60% confidence)
src/presentation/api/emergency_response/models.py:26: unused variable 'action_required' (60% confidence)
src/presentation/api/emergency_response/models.py:35: unused variable 'last_check' (60% confidence)
src/presentation/api/emergency_response/models.py:68: unused variable 'executed_at' (60% confidence)
src/presentation/api/emergency_response/models.py:71: unused class 'EmergencyContact' (60% confidence)
src/presentation/api/emergency_response/models.py:88: unused variable 'condition' (60% confidence)
src/presentation/api/emergency_response/models.py:96: unused class 'SafetyIncident' (60% confidence)
src/presentation/api/emergency_response/models.py:104: unused variable 'location' (60% confidence)
src/presentation/api/emergency_response/models.py:106: unused variable 'resolved' (60% confidence)
src/presentation/api/emergency_response/models.py:107: unused variable 'resolved_at' (60% confidence)
src/presentation/api/emergency_response/models.py:108: unused variable 'resolution_notes' (60% confidence)
src/presentation/api/emergency_response/models.py:111: unused class 'AlertHistory' (60% confidence)
src/presentation/api/emergency_response/models.py:118: unused variable 'updated_by' (60% confidence)
src/presentation/api/emergency_response/models.py:122: unused class 'ParentNotification' (60% confidence)
src/presentation/api/emergency_response/models.py:132: unused variable 'sent_at' (60% confidence)
src/presentation/api/emergency_response/models.py:134: unused variable 'read_at' (60% confidence)
src/presentation/api/emergency_response/models.py:137: unused class 'SystemConfig' (60% confidence)
src/presentation/api/emergency_response/models.py:140: unused variable 'alert_threshold_minutes' (60% confidence)
src/presentation/api/emergency_response/models.py:141: unused variable 'max_retry_attempts' (60% confidence)
src/presentation/api/emergency_response/models.py:142: unused variable 'notification_cooldown_seconds' (60% confidence)
src/presentation/api/emergency_response/models.py:145: unused variable 'emergency_contacts_required' (60% confidence)
src/presentation/api/emergency_response/models.py:148: unused variable 'auto_escalation_enabled' (60% confidence)
src/presentation/api/emergency_response/models.py:149: unused variable 'safety_mode_strict' (60% confidence)
src/presentation/api/emergency_response/services.py:143: unused attribute 'executed_at' (60% confidence)
src/presentation/api/emergency_response/services.py:248: unused method 'get_system_metrics' (60% confidence)
src/presentation/api/emergency_response/services.py:282: unused class 'EmergencyNotificationService' (60% confidence)
src/presentation/api/emergency_response/services.py:307: unused method 'get_notification_history' (60% confidence)
src/presentation/api/emergency_response/services.py:330: unused method 'send_emergency_sms' (60% confidence)
src/presentation/api/endpoints/audio.py:13: unused function 'transcribe_audio' (60% confidence)
src/presentation/api/endpoints/auth.py:16: unused import 'moderate_limit' (90% confidence)
src/presentation/api/endpoints/auth.py:16: unused import 'strict_limit' (90% confidence)
src/presentation/api/endpoints/children/__init__.py:25: unused attribute '_route_info' (60% confidence)
src/presentation/api/endpoints/children/__init__.py:32: unused attribute '_route_info' (60% confidence)
src/presentation/api/endpoints/children/__init__.py:39: unused attribute '_route_info' (60% confidence)
src/presentation/api/endpoints/children/__init__.py:46: unused attribute '_route_info' (60% confidence)
src/presentation/api/endpoints/children/__init__.py:57: unused variable 'HTTP_200_OK' (60% confidence)
src/presentation/api/endpoints/children/compliance.py:39: unused attribute 'coppa' (60% confidence)
src/presentation/api/endpoints/children/compliance.py:71: unused attribute 'coppa' (60% confidence)
src/presentation/api/endpoints/children/compliance.py:78: unused method 'check_retention_compliance' (60% confidence)
src/presentation/api/endpoints/children/compliance.py:114: unused function 'check_age_compliance' (60% confidence)
src/presentation/api/endpoints/children/compliance.py:139: unused attribute 'retention_manager' (60% confidence)
src/presentation/api/endpoints/children/compliance.py:162: unused method 'get_compliance_requirements' (60% confidence)
src/presentation/api/endpoints/children/compliance.py:195: unused variable 'requester_id' (100% confidence)
src/presentation/api/endpoints/children/create_child.py:79: unused function 'validate_child_creation_request' (60% confidence)
src/presentation/api/endpoints/children/create_child.py:139: unused function 'get_child_creation_requirements' (60% confidence)
src/presentation/api/endpoints/children/create_child.py:193: unused function 'check_child_limit' (60% confidence)
src/presentation/api/endpoints/children/get_children.py:61: unused function 'get_children_summary' (60% confidence)
src/presentation/api/endpoints/children/get_children.py:251: unused function 'get_children_activity_summary' (60% confidence)
src/presentation/api/endpoints/children/models.py:21: unused variable 'favorite_color' (60% confidence)
src/presentation/api/endpoints/children/models.py:22: unused variable 'favorite_animal' (60% confidence)
src/presentation/api/endpoints/children/models.py:23: unused variable 'story_preferences' (60% confidence)
src/presentation/api/endpoints/children/models.py:24: unused variable 'model_config' (60% confidence)
src/presentation/api/endpoints/children/models.py:30: unused variable 'model_config' (60% confidence)
src/presentation/api/endpoints/children/models.py:41: unused variable 'model_config' (60% confidence)
src/presentation/api/endpoints/children/models.py:52: unused variable 'model_config' (60% confidence)
src/presentation/api/endpoints/children/models.py:69: unused variable 'last_interaction' (60% confidence)
src/presentation/api/endpoints/children/models.py:111: unused variable 'deleted_at' (60% confidence)
src/presentation/api/endpoints/children/models.py:113: unused method 'create_success' (60% confidence)
src/presentation/api/endpoints/children/operations.py:184: unused class 'ChildValidationService' (60% confidence)
src/presentation/api/endpoints/children/operations.py:223: unused method 'validate_child_update' (60% confidence)
src/presentation/api/endpoints/children/operations.py:247: unused method 'validate_parent_permission' (60% confidence)
src/presentation/api/endpoints/children/operations.py:255: unused class 'ChildDataTransformer' (60% confidence)
src/presentation/api/endpoints/children/operations.py:258: unused method 'transform_create_request' (60% confidence)
src/presentation/api/endpoints/children/operations.py:271: unused method 'transform_update_request' (60% confidence)
src/presentation/api/endpoints/children/operations.py:298: unused method 'transform_db_to_response' (60% confidence)
src/presentation/api/endpoints/children/route_handlers.py:329: unused method 'get_child_safety_summary_handler' (60% confidence)
src/presentation/api/endpoints/children/route_handlers.py:378: unused method 'get_child_usage_monitor_handler' (60% confidence)
src/presentation/api/endpoints/children/route_handlers.py:426: unused method 'request_consent_handler' (60% confidence)
src/presentation/api/endpoints/children/routes.py:62: unused function 'get_child_endpoint' (60% confidence)
src/presentation/api/endpoints/children/routes.py:115: unused function 'get_child_safety_status_endpoint' (60% confidence)
src/presentation/api/endpoints/children/routes.py:134: unused function 'get_child_activity_log' (60% confidence)
src/presentation/api/endpoints/children/routes.py:159: unused function 'get_compliance_report' (60% confidence)
src/presentation/api/endpoints/children/routes_di.py:108: unused function 'list_children' (60% confidence)
src/presentation/api/endpoints/children/routes_refactored.py:254: unused function 'get_children_router' (60% confidence)
src/presentation/api/endpoints/children/safety.py:316: unused method 'validate_data_sharing' (60% confidence)
src/presentation/api/endpoints/children/safety.py:358: unused method 'anonymize_child_data' (60% confidence)
src/presentation/api/endpoints/conversations.py:4: unused import 'ConversationRequest' (90% confidence)
src/presentation/api/endpoints/conversations_paginated.py:219: unused function 'get_child_conversations_paginated' (60% confidence)
src/presentation/api/endpoints/conversations_paginated.py:251: unused function 'get_conversation_history_paginated' (60% confidence)
src/presentation/api/endpoints/conversations_paginated.py:283: unused function 'search_conversations_paginated' (60% confidence)
src/presentation/api/endpoints/coppa_notices.py:26: unused variable 'notice_text' (60% confidence)
src/presentation/api/endpoints/coppa_notices.py:27: unused variable 'privacy_policy_url' (60% confidence)
src/presentation/api/endpoints/coppa_notices.py:28: unused variable 'consent_required' (60% confidence)
src/presentation/api/endpoints/coppa_notices.py:29: unused variable 'data_collection_types' (60% confidence)
src/presentation/api/endpoints/coppa_notices.py:30: unused variable 'retention_period_days' (60% confidence)
src/presentation/api/endpoints/coppa_notices.py:37: unused variable 'compliance_mode' (60% confidence)
src/presentation/api/endpoints/coppa_notices.py:41: unused function 'get_coppa_status' (60% confidence)
src/presentation/api/endpoints/coppa_notices.py:65: unused function 'get_coppa_notice' (60% confidence)
src/presentation/api/endpoints/coppa_notices.py:112: unused function 'get_child_privacy_settings' (60% confidence)
src/presentation/api/endpoints/coppa_notices.py:163: unused function 'request_coppa_consent' (60% confidence)
src/presentation/api/endpoints/coppa_notices.py:215: unused function 'request_data_deletion' (60% confidence)
src/presentation/api/endpoints/coppa_notices.py:264: unused function 'coppa_health_check' (60% confidence)
src/presentation/api/endpoints/dashboard.py:92: unused function 'get_child_stats' (60% confidence)
src/presentation/api/endpoints/dashboard.py:180: unused function 'get_devices_status' (60% confidence)
src/presentation/api/endpoints/device.py:67: unused variable 'last_seen' (60% confidence)
src/presentation/api/endpoints/device.py:71: unused variable 'wifi_strength' (60% confidence)
src/presentation/api/endpoints/device.py:79: unused function 'register_device' (60% confidence)
src/presentation/api/endpoints/device.py:121: unused function 'get_device_status' (60% confidence)
src/presentation/api/endpoints/device.py:168: unused variable 'audio_format' (60% confidence)
src/presentation/api/endpoints/device.py:173: unused variable 'sample_rate' (60% confidence)
src/presentation/api/endpoints/device.py:179: unused variable 'duration_ms' (60% confidence)
src/presentation/api/endpoints/device.py:187: unused function 'upload_audio' (60% confidence)
src/presentation/api/endpoints/device.py:232: unused variable 'sample_rate' (60% confidence)
src/presentation/api/endpoints/device.py:233: unused variable 'audio_format' (60% confidence)
src/presentation/api/endpoints/device.py:234: unused variable 'compression' (60% confidence)
src/presentation/api/endpoints/device.py:235: unused variable 'wake_word' (60% confidence)
src/presentation/api/endpoints/device.py:236: unused variable 'response_timeout' (60% confidence)
src/presentation/api/endpoints/device.py:237: unused variable 'max_recording_duration' (60% confidence)
src/presentation/api/endpoints/device.py:240: unused function 'get_device_config' (60% confidence)
src/presentation/api/endpoints/health.py:121: unused function 'basic_health_check' (60% confidence)
src/presentation/api/endpoints/health.py:206: unused function 'readiness_check' (60% confidence)
src/presentation/api/endpoints/health.py:253: unused function 'liveness_check' (60% confidence)
src/presentation/api/endpoints/health.py:270: unused function 'get_metrics' (60% confidence)
src/presentation/api/endpoints/health.py:318: unused function 'check_dependencies' (60% confidence)
src/presentation/api/endpoints/health.py:353: unused function 'get_system_info' (60% confidence)
src/presentation/api/endpoints/monitoring_dashboard.py:399: unused function 'get_active_alerts' (60% confidence)
src/presentation/api/esp32_endpoints.py:72: unused variable 'audio_response' (60% confidence)
src/presentation/api/esp32_endpoints.py:87: unused function 'process_audio' (60% confidence)
src/presentation/api/esp32_endpoints.py:172: unused function 'update_device_status' (60% confidence)
src/presentation/api/esp32_endpoints.py:201: unused function 'get_device_config' (60% confidence)
src/presentation/api/health_endpoints.py:6: unused import 'PlainTextResponse' (90% confidence)
src/presentation/api/main_router.py:44: unused function 'api_info' (60% confidence)
src/presentation/api/middleware/child_safe_rate_limiter.py:9: unused class 'ChildSafeRateLimiter' (60% confidence)
src/presentation/api/middleware/child_safe_rate_limiter.py:16: unused method 'is_rate_limited' (60% confidence)
src/presentation/api/middleware/child_safe_rate_limiter.py:38: unused method 'create_rate_limit_response' (60% confidence)
src/presentation/api/middleware/consent_verification.py:71: unused attribute '_body' (60% confidence)
src/presentation/api/middleware/consent_verification.py:184: unused attribute '_consent_types' (60% confidence)
src/presentation/api/middleware/error_handling.py:6: unused import 'Union' (90% confidence)
src/presentation/api/middleware/error_handling.py:13: unused import 'traceback' (90% confidence)
src/presentation/api/middleware/error_handling.py:113: unused variable 'is_security_error' (100% confidence)
src/presentation/api/middleware/error_handling.py:114: unused variable 'is_unexpected' (100% confidence)
src/presentation/api/middleware/rate_limit_middleware.py:282: unused function 'create_rate_limit_middleware' (60% confidence)
src/presentation/api/middleware/rate_limit_middleware.py:290: unused variable 'RATE_LIMIT_CONFIGS' (60% confidence)
src/presentation/api/models/standard_responses.py:18: unused variable 'PARTIAL' (60% confidence)
src/presentation/api/models/standard_responses.py:24: unused variable 'OK' (60% confidence)
src/presentation/api/models/standard_responses.py:25: unused variable 'CREATED' (60% confidence)
src/presentation/api/models/standard_responses.py:26: unused variable 'ACCEPTED' (60% confidence)
src/presentation/api/models/standard_responses.py:27: unused variable 'NO_CONTENT' (60% confidence)
src/presentation/api/models/standard_responses.py:28: unused variable 'BAD_REQUEST' (60% confidence)
src/presentation/api/models/standard_responses.py:29: unused variable 'UNAUTHORIZED' (60% confidence)
src/presentation/api/models/standard_responses.py:30: unused variable 'FORBIDDEN' (60% confidence)
src/presentation/api/models/standard_responses.py:31: unused variable 'NOT_FOUND' (60% confidence)
src/presentation/api/models/standard_responses.py:32: unused variable 'CONFLICT' (60% confidence)
src/presentation/api/models/standard_responses.py:33: unused variable 'UNPROCESSABLE_ENTITY' (60% confidence)
src/presentation/api/models/standard_responses.py:35: unused variable 'SERVICE_UNAVAILABLE' (60% confidence)
src/presentation/api/models/standard_responses.py:66: unused class 'Config' (60% confidence)
src/presentation/api/models/standard_responses.py:69: unused variable 'use_enum_values' (60% confidence)
src/presentation/api/models/standard_responses.py:70: unused variable 'json_encoders' (60% confidence)
src/presentation/api/models/standard_responses.py:99: unused variable 'parental_controls_active' (60% confidence)
src/presentation/api/models/standard_responses.py:102: unused variable 'ai_safety_mode' (60% confidence)
src/presentation/api/models/standard_responses.py:119: unused variable 'parental_notification_sent' (60% confidence)
src/presentation/api/models/standard_responses.py:129: unused variable 'token_type' (60% confidence)
src/presentation/api/models/standard_responses.py:132: unused variable 'permissions' (60% confidence)
src/presentation/api/models/standard_responses.py:142: unused variable 'has_next' (60% confidence)
src/presentation/api/models/standard_responses.py:143: unused variable 'has_previous' (60% confidence)
src/presentation/api/models/standard_responses.py:149: unused variable 'service_status' (60% confidence)
src/presentation/api/models/standard_responses.py:156: unused variable 'child_safety_systems' (60% confidence)
src/presentation/api/models/standard_responses.py:173: unused variable 'invalid_value' (60% confidence)
src/presentation/api/models/validation_models.py:17: unused class 'ChildAgeGroup' (60% confidence)
src/presentation/api/models/validation_models.py:21: unused variable 'ELEMENTARY' (60% confidence)
src/presentation/api/models/validation_models.py:22: unused variable 'MIDDLE_ELEMENTARY' (60% confidence)
src/presentation/api/models/validation_models.py:23: unused variable 'MIDDLE_SCHOOL' (60% confidence)
src/presentation/api/models/validation_models.py:30: unused variable 'ARABIC' (60% confidence)
src/presentation/api/models/validation_models.py:31: unused variable 'SPANISH' (60% confidence)
src/presentation/api/models/validation_models.py:32: unused variable 'FRENCH' (60% confidence)
src/presentation/api/models/validation_models.py:43: unused class 'MessageRequest' (60% confidence)
src/presentation/api/models/validation_models.py:61: unused function 'validate_message_content' (60% confidence)
src/presentation/api/models/validation_models.py:100: unused class 'ChildRegistrationRequest' (60% confidence)
src/presentation/api/models/validation_models.py:111: unused variable 'language_preference' (60% confidence)
src/presentation/api/models/validation_models.py:113: unused variable 'personality_traits' (60% confidence)
src/presentation/api/models/validation_models.py:116: unused variable 'emergency_contact_name' (60% confidence)
src/presentation/api/models/validation_models.py:119: unused variable 'emergency_contact_phone' (60% confidence)
src/presentation/api/models/validation_models.py:123: unused function 'validate_name' (60% confidence)
src/presentation/api/models/validation_models.py:145: unused function 'validate_coppa_age' (60% confidence)
src/presentation/api/models/validation_models.py:156: unused function 'validate_birth_date' (60% confidence)
src/presentation/api/models/validation_models.py:168: unused function 'validate_personality_traits' (60% confidence)
src/presentation/api/models/validation_models.py:188: unused class 'AudioMessageRequest' (60% confidence)
src/presentation/api/models/validation_models.py:200: unused variable 'audio_format' (60% confidence)
src/presentation/api/models/validation_models.py:222: unused function 'validate_audio_format' (60% confidence)
src/presentation/api/models/validation_models.py:231: unused class 'EmergencyContactRequest' (60% confidence)
src/presentation/api/models/validation_models.py:238: unused variable 'is_primary' (60% confidence)
src/presentation/api/models/validation_models.py:239: unused variable 'can_authorize_emergency' (60% confidence)
src/presentation/api/models/validation_models.py:241: unused function 'validate_phone' (60% confidence)
src/presentation/api/models/validation_models.py:252: unused function 'validate_relationship' (60% confidence)
src/presentation/api/models/validation_models.py:278: unused variable 'additional_info' (60% confidence)
src/presentation/api/models/validation_models.py:279: unused variable 'consent_duration_days' (60% confidence)
src/presentation/api/models/validation_models.py:283: unused function 'validate_consent_type' (60% confidence)
src/presentation/api/models/validation_models.py:301: unused function 'validate_verification_method' (60% confidence)
src/presentation/api/models/validation_models.py:319: unused class 'HealthCheckRequest' (60% confidence)
src/presentation/api/models/validation_models.py:326: unused variable 'include_metrics' (60% confidence)
src/presentation/api/models/validation_models.py:330: unused variable 'check_dependencies' (60% confidence)
src/presentation/api/models/validation_models.py:347: unused function 'validate_child_safe_limit' (60% confidence)
src/presentation/api/models/validation_models.py:355: unused function 'validate_sort_field' (60% confidence)
src/presentation/api/models/validation_models.py:376: unused class 'FileUploadRequest' (60% confidence)
src/presentation/api/models/validation_models.py:389: unused function 'validate_filename_safety' (60% confidence)
src/presentation/api/models/validation_models.py:424: unused function 'validate_content_type' (60% confidence)
src/presentation/api/models/validation_models.py:444: unused class 'ConversationRequest' (60% confidence)
src/presentation/api/models/validation_models.py:453: unused function 'validate_conversation_message' (60% confidence)
src/presentation/api/models/validation_models.py:470: unused class 'APIResponse' (60% confidence)
src/presentation/api/models/validation_models.py:492: unused variable 'token_type' (60% confidence)
src/presentation/api/openapi_config.py:66: unused attribute 'openapi' (60% confidence)
src/presentation/api/parental_dashboard.py:93: unused variable 'data_collection' (60% confidence)
src/presentation/api/parental_dashboard.py:94: unused variable 'voice_recording' (60% confidence)
src/presentation/api/parental_dashboard.py:95: unused variable 'usage_analytics' (60% confidence)
src/presentation/api/parental_dashboard.py:96: unused variable 'safety_monitoring' (60% confidence)
src/presentation/api/parental_dashboard.py:104: unused function 'create_child_profile_endpoint' (60% confidence)
src/presentation/api/parental_dashboard.py:123: unused function 'get_child_profile_endpoint' (60% confidence)
src/presentation/api/parental_dashboard.py:136: unused function 'update_child_profile_endpoint' (60% confidence)
src/presentation/api/parental_dashboard.py:152: unused function 'delete_child_profile_endpoint' (60% confidence)
src/presentation/api/parental_dashboard.py:164: unused function 'generate_child_story_endpoint' (60% confidence)
src/presentation/api/parental_dashboard.py:192: unused function 'request_consent_verification' (60% confidence)
src/presentation/api/parental_dashboard.py:223: unused function 'grant_parental_consent' (60% confidence)
src/presentation/api/parental_dashboard.py:266: unused function 'get_consent_status' (60% confidence)
src/presentation/api/validators.py:7: unused variable 'MAX_NAME_LENGTH' (60% confidence)
src/presentation/api/validators.py:22: unused method 'validate_name' (60% confidence)
src/presentation/api/validators.py:46: unused method 'validate_interests' (60% confidence)
src/presentation/api/validators.py:73: unused method 'validate_language' (60% confidence)
src/presentation/schemas/esp32_schemas.py:6: unused class 'ESP32AudioRequestSchema' (60% confidence)
src/presentation/schemas/esp32_schemas.py:13: unused class 'ESP32TextResponseSchema' (60% confidence)
src/presentation/schemas/esp32_schemas.py:16: unused variable 'audio_response_url' (60% confidence)
src/presentation/schemas/parent_schemas.py:6: unused class 'ChildProfileCreateSchema' (60% confidence)
src/presentation/schemas/parent_schemas.py:12: unused class 'ChildProfileUpdateSchema' (60% confidence)
src/presentation/schemas/parent_schemas.py:17: unused class 'ChildProfileResponseSchema' (60% confidence)
src/presentation/schemas/parent_schemas.py:23: unused class 'Config' (60% confidence)
src/presentation/schemas/parent_schemas.py:24: unused variable 'from_attributes' (60% confidence)

```

⏱️ الوقت المستغرق: 36.01 ثانية


---

## تعقيد الشفرة (Radon)
```bash
radon cc -s src/ --exclude .venv,venv,__pycache__,build,dist,.mypy_cache,node_modules,.git
```

_Error or No results._
```
src/main.py
    F 107:0 _mount_static_files - A (4)
    F 41:0 lifespan - A (3)
    F 84:0 _validate_system_startup - A (2)
    F 144:0 create_app - A (2)
    F 74:0 _setup_app_configurations - A (1)
    F 100:0 _setup_app_middlewares_and_routes - A (1)
src/api/endpoints/voice_models.py
    C 4:0 VoiceResponse - A (1)
    C 14:0 AudioValidationResult - A (1)
    C 21:0 SpeechToTextResult - A (1)
    C 31:0 TextToSpeechResult - A (1)
src/application/exceptions.py
    C 3:0 AITeddyError - A (4)
    M 6:4 AITeddyError.__init__ - A (3)
    C 19:0 ServiceUnavailableError - A (2)
    C 30:0 InvalidInputError - A (2)
    C 41:0 TimeoutError - A (2)
    C 51:0 ConsentError - A (2)
    M 22:4 ServiceUnavailableError.__init__ - A (1)
    M 33:4 InvalidInputError.__init__ - A (1)
    M 44:4 TimeoutError.__init__ - A (1)
    M 56:4 ConsentError.__init__ - A (1)
src/application/dto/ai_response.py
    C 7:0 AIResponse - B (9)
    M 37:4 AIResponse.__post_init__ - B (8)
src/application/dto/child_data.py
    M 68:4 ChildData.__post_init__ - C (12)
    C 31:0 ChildData - B (8)
    M 111:4 ChildData.should_purge_data - A (2)
src/application/dto/esp32_request.py
    C 6:0 ESP32Request - A (1)
src/application/dto/story_response.py
    C 12:0 StoryResponse - A (1)
src/application/dto/esp32/esp32_data.py
    C 7:0 ESP32SensorReadingDTO - A (1)
    C 16:0 ESP32VoiceCommandDTO - A (1)
    C 23:0 ESP32GestureEventDTO - A (1)
    C 31:0 ESP32FirmwareUpdateStatusDTO - A (1)
    C 40:0 ESP32DeviceStatusDTO - A (1)
    C 50:0 ESP32EdgeAIResultDTO - A (1)
src/application/event_handlers/child_profile_event_handlers.py
    M 63:4 ChildProfileEventHandlers.handle_child_profile_updated - C (12)
    C 27:0 ChildProfileEventHandlers - A (5)
    M 36:4 ChildProfileEventHandlers.handle_child_registered - A (2)
    M 110:4 ChildProfileEventHandlers._async_save - A (2)
    M 124:4 ChildProfileEventHandlers._async_get_by_id - A (2)
    M 33:4 ChildProfileEventHandlers.__init__ - A (1)
src/application/interfaces/ai_provider.py
    C 7:0 AIProvider - A (2)
    M 10:4 AIProvider.generate_response - A (1)
    M 18:4 AIProvider.analyze_sentiment - A (1)
    M 20:4 AIProvider.analyze_emotion - A (1)
    M 22:4 AIProvider.analyze_toxicity - A (1)
    M 24:4 AIProvider.analyze_personality - A (1)
    M 29:4 AIProvider.supports_asr_model - A (1)
    M 31:4 AIProvider.transcribe_audio - A (1)
    M 33:4 AIProvider.evaluate_educational_value - A (1)
    M 35:4 AIProvider.determine_activity_type - A (1)
    M 42:4 AIProvider.generate_personalized_content - A (1)
src/application/interfaces/infrastructure_services.py
    ERROR: unexpected indent (<unknown>, line 5)
src/application/interfaces/read_model_interfaces.py
    C 11:0 IChildProfileReadModel - A (2)
    C 35:0 IChildProfileReadModelStore - A (2)
    F 82:0 create_child_profile_read_model - A (1)
    F 92:0 get_read_model_store - A (1)
    F 100:0 get_event_bus - A (1)
    F 108:0 get_external_api_client - A (1)
    F 116:0 get_settings_provider - A (1)
    M 16:4 IChildProfileReadModel.id - A (1)
    M 21:4 IChildProfileReadModel.name - A (1)
    M 26:4 IChildProfileReadModel.age - A (1)
    M 31:4 IChildProfileReadModel.preferences - A (1)
    M 39:4 IChildProfileReadModelStore.save - A (1)
    M 43:4 IChildProfileReadModelStore.get_by_id - A (1)
    M 47:4 IChildProfileReadModelStore.delete_by_id - A (1)
    M 51:4 IChildProfileReadModelStore.update - A (1)
    M 58:4 IChildProfileReadModelStore.make_request - A (1)
    M 62:4 IChildProfileReadModelStore.check_health - A (1)
    M 69:4 IChildProfileReadModelStore.verify_consent - A (1)
    M 73:4 IChildProfileReadModelStore.get_consent_status - A (1)
    M 77:4 IChildProfileReadModelStore.revoke_consent - A (1)
src/application/interfaces/safety_monitor.py
    C 8:0 SafetyMonitor - A (2)
    M 10:4 SafetyMonitor.check_content_safety - A (1)
src/application/interfaces/speech_processor.py
    C 4:0 SpeechProcessor - A (2)
    M 5:4 SpeechProcessor.speech_to_text - A (1)
    M 7:4 SpeechProcessor.text_to_speech - A (1)
src/application/interfaces/text_to_speech_service.py
    C 4:0 TextToSpeechService - A (2)
    M 8:4 TextToSpeechService.generate_speech - A (1)
    M 26:4 TextToSpeechService.list_voices - A (1)
    M 34:4 TextToSpeechService.health_check - A (1)
src/application/interfaces/security/encryption_interfaces.py
    C 7:0 HomomorphicEncryptionService - A (2)
    C 25:0 ZeroKnowledgeProofService - A (2)
    M 9:4 HomomorphicEncryptionService.encrypt - A (1)
    M 13:4 HomomorphicEncryptionService.decrypt - A (1)
    M 17:4 HomomorphicEncryptionService.add - A (1)
    M 21:4 HomomorphicEncryptionService.multiply - A (1)
    M 27:4 ZeroKnowledgeProofService.generate_proof - A (1)
    M 35:4 ZeroKnowledgeProofService.verify_proof - A (1)
src/application/services/accessibility_service.py
    M 119:4 AccessibilityService._get_accessibility_settings - B (6)
    C 26:0 AccessibilityService - A (3)
    M 101:4 AccessibilityService._get_adaptations - A (3)
    M 78:4 AccessibilityService.get_accessibility_profile - A (2)
    M 29:4 AccessibilityService.__init__ - A (1)
    M 47:4 AccessibilityService.create_accessibility_profile - A (1)
src/application/services/advanced_personalization_service.py
    C 27:0 AdvancedPersonalizationService - A (3)
    M 90:4 AdvancedPersonalizationService.get_personalized_content - A (3)
    M 135:4 AdvancedPersonalizationService._analyze_interactions - A (3)
    M 70:4 AdvancedPersonalizationService.get_personality_profile - A (2)
    M 30:4 AdvancedPersonalizationService.__init__ - A (1)
    M 49:4 AdvancedPersonalizationService.create_personality_profile - A (1)
src/application/services/advanced_progress_analyzer.py
    C 27:0 AdvancedProgressAnalyzer - A (3)
    M 35:4 AdvancedProgressAnalyzer.analyze_progress - A (3)
    M 66:4 AdvancedProgressAnalyzer.get_progress_report - A (2)
    C 18:0 ProgressMetrics - A (1)
    M 30:4 AdvancedProgressAnalyzer.__init__ - A (1)
    M 95:4 AdvancedProgressAnalyzer._calculate_metrics - A (1)
src/application/services/ai_orchestration_service.py
    M 55:4 AIOrchestrationService.get_ai_response - B (8)
    C 31:0 AIOrchestrationService - B (6)
    M 34:4 AIOrchestrationService.__init__ - A (1)
src/application/services/audio_processing_service.py
    C 19:0 AudioProcessingService - A (2)
    M 59:4 AudioProcessingService.generate_audio_response - A (2)
    M 22:4 AudioProcessingService.__init__ - A (1)
    M 40:4 AudioProcessingService.process_audio_input - A (1)
src/application/services/audit_service.py
    C 16:0 AuditService - A (3)
    M 34:4 AuditService.create_audit_log - A (3)
    M 27:4 AuditService._sanitize_log_input - A (2)
    M 19:4 AuditService.__init__ - A (1)
    M 75:4 AuditService.get_audit_logs - A (1)
src/application/services/base_service.py
    M 59:4 BaseService.validate_input - A (4)
    C 16:0 BaseService - A (2)
    M 19:4 BaseService.__init__ - A (1)
    M 24:4 BaseService.initialize - A (1)
    M 32:4 BaseService.cleanup - A (1)
    M 39:4 BaseService.log_info - A (1)
    M 49:4 BaseService.log_error - A (1)
src/application/services/cleanup_service.py
    M 58:4 CleanupService.cleanup_old_data - B (7)
    M 145:4 CleanupService._simulate_data_cleanup - B (6)
    C 18:0 CleanupService - A (4)
    M 38:4 CleanupService._is_safe_path - A (2)
    M 109:4 CleanupService._cleanup_data_type - A (2)
    M 21:4 CleanupService.__init__ - A (1)
src/application/services/content_filter_service.py
    C 18:0 ContentFilterService - A (3)
    M 37:4 ContentFilterService.filter_content - A (3)
    M 21:4 ContentFilterService.__init__ - A (1)
src/application/services/conversation_service.py
    C 19:0 ConversationService - A (2)
    M 70:4 ConversationService._get_conversation_by_id - A (2)
    M 130:4 ConversationService.add_interaction - A (2)
    M 22:4 ConversationService.__init__ - A (1)
    M 37:4 ConversationService.start_new_conversation - A (1)
    M 58:4 ConversationService.get_conversation_history - A (1)
    M 88:4 ConversationService.update_conversation_analysis - A (1)
    M 110:4 ConversationService.update_conversation_summary - A (1)
src/application/services/data_export_service.py
    M 52:4 DataExportService._sanitize_data_for_export - B (8)
    C 29:0 DataExportService - A (4)
    M 137:4 DataExportService._validate_export_request - A (4)
    M 89:4 DataExportService.request_export - A (2)
    M 32:4 DataExportService.__init__ - A (1)
    M 125:4 DataExportService.get_export_status - A (1)
    M 162:4 DataExportService._simulate_export - A (1)
src/application/services/dynamic_content_service.py
    C 24:0 DynamicContentService - A (4)
    M 144:4 DynamicContentService.get_interactive_activity - A (4)
    M 44:4 DynamicContentService.generate_personalized_story - A (3)
    M 96:4 DynamicContentService.generate_educational_content - A (3)
    M 27:4 DynamicContentService.__init__ - A (2)
src/application/services/dynamic_story_service.py
    C 12:0 DynamicStoryService - A (2)
    M 15:4 DynamicStoryService.__init__ - A (1)
    M 24:4 DynamicStoryService.generate_story - A (1)
src/application/services/esp32_device_service.py
    C 27:0 ESP32DeviceService - A (4)
    M 46:4 ESP32DeviceService.process_sensor_reading - A (3)
    M 71:4 ESP32DeviceService.process_voice_command - A (3)
    M 96:4 ESP32DeviceService.process_gesture_event - A (3)
    M 121:4 ESP32DeviceService.process_firmware_update_status - A (3)
    M 146:4 ESP32DeviceService.process_device_status - A (3)
    M 168:4 ESP32DeviceService.process_edge_ai_result - A (3)
    M 30:4 ESP32DeviceService.__init__ - A (2)
src/application/services/feature_service.py
    M 51:4 FeatureService.enable_feature - B (8)
    C 29:0 FeatureService - A (4)
    M 114:4 FeatureService.disable_feature - A (3)
    M 147:4 FeatureService.get_feature_status - A (2)
    C 18:0 FeatureType - A (1)
    M 32:4 FeatureService.__init__ - A (1)
src/application/services/federated_learning_service.py
    M 40:4 FederatedLearningService._validate_model_update_for_privacy - A (5)
    C 21:0 FederatedLearningService - A (3)
    M 24:4 FederatedLearningService.__init__ - A (2)
    M 89:4 FederatedLearningService.process_local_model_update - A (2)
    M 119:4 FederatedLearningService._aggregate_model_update - A (2)
    M 76:4 FederatedLearningService._initialize_global_model - A (1)
    M 137:4 FederatedLearningService.get_global_model - A (1)
src/application/services/incident_service.py
    C 13:0 IncidentService - A (3)
    M 40:4 IncidentService.get_incident - A (3)
    M 55:4 IncidentService.resolve_incident - A (3)
    M 16:4 IncidentService.__init__ - A (1)
    M 20:4 IncidentService.report_incident - A (1)
src/application/services/interaction_service.py
    M 56:4 InteractionService.process - B (10)
    M 188:4 InteractionService._check_child_age - A (5)
    C 29:0 InteractionService - A (4)
    M 32:4 InteractionService.__init__ - A (1)
    M 153:4 InteractionService._sanitize_message - A (1)
    M 169:4 InteractionService._check_content_safety - A (1)
src/application/services/notification_service.py
    M 94:4 NotificationService.send_notification - B (8)
    M 208:4 NotificationService._send_by_channel - B (6)
    C 58:0 NotificationService - A (5)
    C 40:0 NotificationType - A (1)
    C 49:0 NotificationChannel - A (1)
    M 61:4 NotificationService.__init__ - A (1)
    M 265:4 NotificationService.get_notification_history - A (1)
src/application/services/parent_child_verification_service.py
    F 24:0 get_verification_service - A (1)
    F 34:0 get_relationship_manager - A (1)
src/application/services/safety.py
    M 55:4 SafetyService._analyze_harmful_content - B (10)
    C 32:0 SafetyService - A (4)
    M 123:4 SafetyService._analyze_toxicity - A (3)
    M 270:4 SafetyService.analyze_content - A (3)
    M 156:4 SafetyService._analyze_emotional_impact - A (2)
    M 195:4 SafetyService._analyze_educational_value - A (2)
    M 235:4 SafetyService._analyze_context - A (2)
    M 35:4 SafetyService.__init__ - A (1)
    M 307:4 SafetyService.get_metrics - A (1)
src/application/services/transcription_models.py
    C 15:0 TranscriptionResult - A (1)
src/application/services/voice_service.py
    M 46:4 VoiceService.validate_audio_file - A (5)
    C 24:0 VoiceService - A (4)
    M 82:4 VoiceService.speech_to_text - A (4)
    M 153:4 VoiceService.text_to_speech - A (3)
    M 31:4 VoiceService.__init__ - A (1)
src/application/services/ai/main_service.py
    M 59:4 AITeddyBearService.generate_response - C (11)
    M 138:4 AITeddyBearService._moderate_content - A (4)
    M 251:4 AITeddyBearService._get_cached_response - A (4)
    C 24:0 AITeddyBearService - A (3)
    M 189:4 AITeddyBearService._post_process_response - A (3)
    M 262:4 AITeddyBearService._cache_response - A (3)
    M 35:4 AITeddyBearService.__init__ - A (2)
    M 161:4 AITeddyBearService._create_system_prompt - A (2)
    M 219:4 AITeddyBearService._calculate_safety_score - A (1)
    M 227:4 AITeddyBearService._check_age_appropriateness - A (1)
    M 231:4 AITeddyBearService._analyze_sentiment - A (1)
    M 235:4 AITeddyBearService._extract_topics - A (1)
    M 239:4 AITeddyBearService._clean_content - A (1)
    M 243:4 AITeddyBearService._get_age_group - A (1)
    M 247:4 AITeddyBearService._generate_cache_key - A (1)
    M 275:4 AITeddyBearService._get_fallback_response - A (1)
src/application/services/ai/utils.py
    M 50:4 AIServiceUtils.analyze_sentiment - B (7)
    M 5:4 AIServiceUtils.calculate_safety_score - B (6)
    C 1:0 AIServiceUtils - A (4)
    M 39:4 AIServiceUtils.check_age_appropriateness - A (4)
    M 86:4 AIServiceUtils.get_age_group - A (4)
    M 71:4 AIServiceUtils.extract_topics - A (3)
    M 81:4 AIServiceUtils.clean_content - A (1)
    M 97:4 AIServiceUtils.generate_cache_key - A (1)
src/application/services/ai/modules/response_generator.py
    M 253:4 ResponseGenerator._generate_fallback_response - B (10)
    M 87:4 ResponseGenerator.generate_response - B (9)
    M 283:4 ResponseGenerator._filter_response - B (8)
    M 176:4 ResponseGenerator._filter_input - B (7)
    C 31:0 ResponseGenerator - B (6)
    M 209:4 ResponseGenerator._generate_openai_response - B (6)
    M 36:4 ResponseGenerator.__init__ - A (4)
    M 168:4 ResponseGenerator._get_safety_level - A (3)
    M 365:4 ResponseGenerator.health_check - A (3)
    C 22:0 ResponseType - A (1)
    M 318:4 ResponseGenerator._generate_safety_redirect_response - A (1)
    M 342:4 ResponseGenerator._generate_emergency_fallback - A (1)
src/application/services/ai/modules/transcription_service.py
    M 81:4 TranscriptionService.transcribe_audio - C (11)
    M 197:4 TranscriptionService._perform_transcription - B (8)
    M 262:4 TranscriptionService._apply_safety_filters - B (8)
    C 33:0 TranscriptionService - A (5)
    M 57:4 TranscriptionService._initialize_engines - A (4)
    M 162:4 TranscriptionService._validate_audio_file - A (4)
    M 38:4 TranscriptionService.__init__ - A (1)
    M 291:4 TranscriptionService.get_supported_languages - A (1)
    M 295:4 TranscriptionService.health_check - A (1)
src/application/services/consent/consent_models.py
    C 10:0 VerificationMethod - A (1)
    C 21:0 VerificationStatus - A (1)
    C 32:0 VerificationAttempt - A (1)
src/application/services/consent/consent_service.py
    M 123:4 ConsentService.verify_parental_consent - A (4)
    M 99:4 ConsentService.check_consent_status - A (3)
    C 18:0 ConsentService - A (2)
    M 65:4 ConsentService.grant_consent - A (2)
    M 84:4 ConsentService.revoke_consent - A (2)
    M 188:4 ConsentService.get_consent_audit_trail - A (2)
    M 30:4 ConsentService.__init__ - A (1)
    M 35:4 ConsentService.request_consent - A (1)
    M 147:4 ConsentService.initiate_email_verification - A (1)
    M 162:4 ConsentService.initiate_sms_verification - A (1)
    M 174:4 ConsentService.complete_verification - A (1)
src/application/services/consent/verification_service.py
    C 22:0 VerificationService - A (3)
    M 30:4 VerificationService.send_email_verification - A (3)
    M 64:4 VerificationService.send_sms_verification - A (3)
    M 94:4 VerificationService.verify_code - A (3)
    M 25:4 VerificationService.__init__ - A (1)
    M 116:4 VerificationService._validate_email - A (1)
    M 121:4 VerificationService._validate_phone - A (1)
    M 128:4 VerificationService._generate_verification_code - A (1)
src/application/services/coppa/coppa_compliance_service.py
    M 220:4 COPPAComplianceService.create_consent_record - B (8)
    M 102:4 COPPAComplianceService._convert_validation_result - B (7)
    M 56:4 COPPAComplianceService.validate_child_age - A (4)
    C 28:0 COPPAComplianceService - A (3)
    M 39:4 COPPAComplianceService.__init__ - A (3)
    M 330:4 COPPAComplianceService._determine_required_consents - A (2)
    M 342:4 COPPAComplianceService._generate_consent_text - A (1)
    M 368:4 COPPAComplianceService._create_error_response - A (1)
    M 383:4 COPPAComplianceService._log_validation - A (1)
    M 393:4 COPPAComplianceService._log_consent_creation - A (1)
    M 403:4 COPPAComplianceService.get_compliance_status - A (1)
    M 413:4 COPPAComplianceService.get_audit_log - A (1)
src/application/services/data_export/formatters.py
    M 82:4 CSVFormatter.format_data - C (16)
    M 206:4 XMLFormatter._add_dict_to_element - B (8)
    C 79:0 CSVFormatter - B (7)
    M 150:4 XMLFormatter.format_data - B (7)
    C 147:0 XMLFormatter - A (5)
    M 245:4 ArchiveFormatter.format_data - A (4)
    C 307:0 FormatterFactory - A (4)
    M 311:4 FormatterFactory.create_formatter - A (3)
    C 20:0 BaseFormatter - A (2)
    C 40:0 JSONFormatter - A (2)
    M 43:4 JSONFormatter.format_data - A (2)
    M 66:4 JSONFormatter._json_serializer - A (2)
    C 233:0 ArchiveFormatter - A (2)
    M 23:4 BaseFormatter.__init__ - A (1)
    M 27:4 BaseFormatter.format_data - A (1)
    M 31:4 BaseFormatter.get_file_extension - A (1)
    M 35:4 BaseFormatter.get_mime_type - A (1)
    M 72:4 JSONFormatter.get_file_extension - A (1)
    M 75:4 JSONFormatter.get_mime_type - A (1)
    M 140:4 CSVFormatter.get_file_extension - A (1)
    M 143:4 CSVFormatter.get_mime_type - A (1)
    M 226:4 XMLFormatter.get_file_extension - A (1)
    M 229:4 XMLFormatter.get_mime_type - A (1)
    M 236:4 ArchiveFormatter.__init__ - A (1)
    M 272:4 ArchiveFormatter._generate_readme - A (1)
    M 300:4 ArchiveFormatter.get_file_extension - A (1)
    M 303:4 ArchiveFormatter.get_mime_type - A (1)
src/application/services/data_export/types.py
    C 10:0 ExportFormat - A (1)
    C 20:0 DataCategory - A (1)
    C 33:0 ExportStatus - A (1)
    C 44:0 ExportRequest - A (1)
    C 60:0 ExportResult - A (1)
    C 76:0 ExportMetadata - A (1)
src/application/services/session/session_manager.py
    M 97:4 AsyncSessionManager.update_session - A (5)
    M 151:4 AsyncSessionManager.get_child_sessions - A (4)
    M 205:4 AsyncSessionManager._cleanup_loop - A (4)
    C 18:0 AsyncSessionManager - A (3)
    M 36:4 AsyncSessionManager.start_cleanup_task - A (3)
    M 41:4 AsyncSessionManager.stop_cleanup_task - A (3)
    M 48:4 AsyncSessionManager.create_session - A (3)
    M 73:4 AsyncSessionManager.get_session - A (3)
    M 132:4 AsyncSessionManager.end_session - A (2)
    M 29:4 AsyncSessionManager.__init__ - A (1)
    M 172:4 AsyncSessionManager.get_session_stats - A (1)
    M 196:4 AsyncSessionManager.cleanup_expired_sessions - A (1)
src/application/services/session/session_models.py
    C 22:0 AsyncSessionData - A (2)
    M 40:4 AsyncSessionData.is_expired - A (2)
    C 12:0 SessionStatus - A (1)
    M 48:4 AsyncSessionData.update_activity - A (1)
    M 53:4 AsyncSessionData.get_session_duration - A (1)
    M 57:4 AsyncSessionData.to_dict - A (1)
    C 73:0 SessionStats - A (1)
src/application/services/session/session_storage.py
    M 57:4 SessionStorage.remove_session - B (6)
    M 106:4 SessionStorage.cleanup_expired_sessions - A (5)
    C 14:0 SessionStorage - A (4)
    M 23:4 SessionStorage.store_session - A (4)
    M 86:4 SessionStorage.get_child_sessions - A (4)
    M 144:4 SessionStorage.get_active_session_count - A (4)
    M 17:4 SessionStorage.__init__ - A (1)
    M 45:4 SessionStorage.retrieve_session - A (1)
    M 134:4 SessionStorage.get_session_count - A (1)
src/application/services/verification/relationship_manager.py
    M 116:4 RelationshipManager.check_relationship_validity - B (7)
    C 21:0 RelationshipManager - A (4)
    M 143:4 RelationshipManager.get_parent_children - A (4)
    M 162:4 RelationshipManager.get_child_parents - A (4)
    M 67:4 RelationshipManager.verify_relationship - A (3)
    M 29:4 RelationshipManager.create_relationship - A (2)
    M 24:4 RelationshipManager.__init__ - A (1)
src/application/services/verification/verification_models.py
    C 10:0 RelationshipStatus - A (1)
    C 20:0 RelationshipType - A (1)
    C 31:0 VerificationRecord - A (1)
    C 46:0 RelationshipRecord - A (1)
src/application/services/verification/verification_service.py
    M 79:4 ParentChildVerificationService.verify_parent_child_relationship - A (5)
    C 17:0 ParentChildVerificationService - A (3)
    M 191:4 ParentChildVerificationService._log_access_attempt - A (3)
    M 27:4 ParentChildVerificationService.__init__ - A (2)
    M 37:4 ParentChildVerificationService.establish_relationship - A (2)
    M 227:4 ParentChildVerificationService.get_access_audit_trail - A (2)
    M 121:4 ParentChildVerificationService._perform_strong_verification - A (1)
    M 133:4 ParentChildVerificationService.get_parent_children - A (1)
    M 148:4 ParentChildVerificationService.get_child_guardians - A (1)
    M 163:4 ParentChildVerificationService.approve_relationship - A (1)
src/application/use_cases/generate_ai_response.py
    M 28:4 GenerateAIResponseUseCase.execute - B (8)
    C 11:0 GenerateAIResponseUseCase - B (6)
    M 18:4 GenerateAIResponseUseCase.__init__ - A (1)
src/application/use_cases/generate_dynamic_story.py
    M 81:4 GenerateDynamicStoryUseCase._get_child_preferences - A (5)
    M 114:4 GenerateDynamicStoryUseCase._get_age_appropriate_interests - A (5)
    C 7:0 GenerateDynamicStoryUseCase - A (4)
    M 13:4 GenerateDynamicStoryUseCase.execute - A (3)
    M 62:4 GenerateDynamicStoryUseCase._create_story_prompt - A (3)
    M 10:4 GenerateDynamicStoryUseCase.__init__ - A (1)
    M 105:4 GenerateDynamicStoryUseCase._get_default_preferences - A (1)
src/application/use_cases/manage_child_profile.py
    C 13:0 ManageChildProfileUseCase - A (3)
    M 52:4 ManageChildProfileUseCase.update_child_profile - A (3)
    M 24:4 ManageChildProfileUseCase.create_child_profile - A (2)
    M 41:4 ManageChildProfileUseCase.get_child_profile - A (2)
    M 71:4 ManageChildProfileUseCase.delete_child_profile - A (2)
    M 14:4 ManageChildProfileUseCase.__init__ - A (1)
src/application/use_cases/process_esp32_audio.py
    M 60:4 ProcessESP32AudioUseCase.execute - B (7)
    C 20:0 ProcessESP32AudioUseCase - A (5)
    M 39:4 ProcessESP32AudioUseCase.__init__ - A (1)
src/common/constants.py
    C 120:0 EventStoreType - A (1)
src/domain/analytics.py
    M 68:4 ChildAnalytics.get_speech_concerns - C (16)
    M 32:4 ChildAnalytics.calculate_emotion_stability - B (7)
    C 24:0 ChildAnalytics - B (6)
    M 162:4 ChildAnalytics.record_emotion_data - A (2)
    M 180:4 ChildAnalytics.record_speech_data - A (2)
    M 27:4 ChildAnalytics.__init__ - A (1)
src/domain/contracts.py
    C 6:0 ContractTest - A (1)
    C 15:0 ContractResult - A (1)
src/domain/schemas.py
    F 89:0 _validate_basic_schema - C (11)
    F 174:0 _validate_coppa_compliance - B (7)
    F 198:0 _validate_child_safety - B (7)
    F 55:0 validate_against_schema - B (6)
    F 128:0 _validate_array_schema - B (6)
    M 25:4 ValidationResult.__init__ - B (6)
    F 110:0 _validate_object_schema - A (5)
    F 147:0 _validate_string_schema - A (5)
    F 162:0 _validate_integer_schema - A (5)
    F 221:0 _validate_data_retention - A (4)
    C 22:0 ValidationResult - A (4)
    C 12:0 COPPAViolationType - A (1)
    M 42:4 ValidationResult.add_error - A (1)
    M 47:4 ValidationResult.add_coppa_violation - A (1)
    C 300:0 ValidationSeverity - A (1)
src/domain/entities/audio_session.py
    C 15:0 AudioSession - A (2)
    M 27:4 AudioSession.create_new - A (1)
    M 49:4 AudioSession.mark_processed - A (1)
src/domain/entities/child.py
    C 16:0 Child - A (2)
    M 122:4 Child.add_allowed_topic - A (2)
    M 132:4 Child.add_restricted_topic - A (2)
    M 74:4 Child.create_new - A (1)
    M 101:4 Child.update_interaction_time - A (1)
    M 111:4 Child.is_interaction_time_exceeded - A (1)
    M 142:4 Child.update_parental_controls - A (1)
    M 151:4 Child.deactivate_profile - A (1)
    M 155:4 Child.activate_profile - A (1)
src/domain/entities/child_profile.py
    M 97:4 ChildProfile.update_profile - B (6)
    C 21:0 ChildProfile - A (2)
    M 31:4 ChildProfile.create - A (2)
    M 61:4 ChildProfile.child_id - A (1)
    M 66:4 ChildProfile.name - A (1)
    M 71:4 ChildProfile.age - A (1)
    M 76:4 ChildProfile.preferences - A (1)
    M 80:4 ChildProfile.get_uncommitted_events - A (1)
    M 84:4 ChildProfile.clear_uncommitted_events - A (1)
    M 88:4 ChildProfile._record_event - A (1)
src/domain/entities/conversation.py
    C 24:0 Conversation - A (2)
    M 87:4 Conversation.duration_minutes - A (2)
    C 16:0 InteractionType - A (1)
    M 36:4 Conversation.create_new - A (1)
    M 64:4 Conversation.end_conversation - A (1)
    M 79:4 Conversation.is_active - A (1)
    M 98:4 Conversation.update_summary - A (1)
    M 106:4 Conversation.update_analysis - A (1)
    M 116:4 Conversation.add_interaction - A (1)
src/domain/entities/emotion.py
    C 11:0 EmotionType - A (1)
src/domain/entities/encrypted_child.py
    C 18:0 EncryptedChild - A (2)
    M 66:4 EncryptedChild.get_emergency_contacts - A (2)
    M 94:4 EncryptedChild.get_medical_notes - A (2)
    M 119:4 EncryptedChild.is_interaction_time_exceeded - A (2)
    M 132:4 EncryptedChild.add_allowed_topic - A (2)
    M 143:4 EncryptedChild.add_restricted_topic - A (2)
    M 48:4 EncryptedChild.set_emergency_contacts - A (1)
    M 83:4 EncryptedChild.set_medical_notes - A (1)
    M 108:4 EncryptedChild.update_interaction_time - A (1)
    M 154:4 EncryptedChild.update_parental_controls - A (1)
    M 164:4 EncryptedChild.deactivate_profile - A (1)
    M 169:4 EncryptedChild.activate_profile - A (1)
src/domain/entities/user.py
    C 4:0 User - A (2)
    M 5:4 User.__init__ - A (1)
    M 23:4 User.__repr__ - A (1)
src/domain/entities/parent_profile/entities.py
    M 120:4 Parent.update_preference - C (11)
    M 52:4 Parent.get_full_name - B (10)
    M 29:4 Parent.__post_init__ - B (7)
    C 10:0 Parent - A (4)
    M 89:4 Parent.add_child - A (4)
    M 179:4 Parent._parse_full_name - A (4)
    M 81:4 Parent.get_display_name - A (3)
    M 161:4 Parent.to_dict - A (3)
    M 191:4 Parent._validate_email - A (3)
    M 106:4 Parent.remove_child - A (2)
    M 153:4 Parent.is_verified - A (2)
    M 157:4 Parent.can_manage_children - A (2)
    M 149:4 Parent.get_preference - A (1)
    M 200:4 Parent.__str__ - A (1)
    M 204:4 Parent.__repr__ - A (1)
src/domain/entities/voice_games/voice_games_engine.py
    M 274:4 VoiceGameEngine._process_story_input - B (8)
    M 315:4 VoiceGameEngine._get_current_content - B (6)
    C 38:0 VoiceGameEngine - A (5)
    M 142:4 VoiceGameEngine.process_game_input - A (5)
    M 343:4 VoiceGameEngine._generate_completion_message - A (5)
    M 181:4 VoiceGameEngine._process_input_by_type - A (4)
    M 195:4 VoiceGameEngine._process_trivia_input - A (4)
    M 235:4 VoiceGameEngine._process_riddle_input - A (4)
    M 358:4 VoiceGameEngine.get_active_games - A (4)
    M 101:4 VoiceGameEngine.start_game - A (3)
    C 24:0 GameSession - A (2)
    M 374:4 VoiceGameEngine.end_game - A (2)
    C 18:0 GameType - A (1)
    M 27:4 GameSession.__init__ - A (1)
    M 41:4 VoiceGameEngine.__init__ - A (1)
    M 45:4 VoiceGameEngine._initialize_game_content - A (1)
src/domain/esp32/models.py
    C 7:0 ESP32SensorReading - A (1)
    C 17:0 ESP32VoiceCommand - A (1)
    C 25:0 ESP32GestureEvent - A (1)
    C 34:0 ESP32FirmwareUpdateStatus - A (1)
    C 44:0 ESP32DeviceStatus - A (1)
    C 55:0 ESP32EdgeAIResult - A (1)
src/domain/events/child_profile_updated.py
    C 8:0 ChildProfileUpdated - A (3)
    M 23:4 ChildProfileUpdated.__post_init__ - A (3)
    M 33:4 ChildProfileUpdated.create - A (1)
src/domain/events/child_registered.py
    C 9:0 ChildRegistered - A (2)
    M 16:4 ChildRegistered.create - A (1)
src/domain/events/conversation_started.py
    C 11:0 ConversationStarted - A (3)
    M 20:4 ConversationStarted.__init__ - A (2)
    M 33:4 ConversationStarted.to_dict - A (1)
src/domain/events/conversation_updated.py
    C 8:0 ConversationUpdatedEvent - A (1)
src/domain/events/domain_events.py
    C 7:0 DomainEvent - A (3)
    M 11:4 DomainEvent.__post_init__ - A (3)
    M 19:4 DomainEvent.new_event - A (1)
src/domain/exceptions/base.py
    C 12:0 TeddyBearException - A (3)
    M 18:4 TeddyBearException.__init__ - A (3)
    M 39:4 TeddyBearException._generate_child_friendly_message - A (3)
    C 57:0 ParentalConsentRequiredException - A (3)
    C 95:0 CircuitBreakerOpenException - A (3)
    M 63:4 ParentalConsentRequiredException.__init__ - A (2)
    M 100:4 CircuitBreakerOpenException.__init__ - A (2)
    C 126:0 StartupValidationException - A (2)
    M 49:4 TeddyBearException.__str__ - A (1)
    M 133:4 StartupValidationException.__init__ - A (1)
src/domain/exceptions/base_exceptions.py
    C 36:0 ValidationError - A (4)
    C 56:0 AuthorizationError - A (4)
    C 76:0 NotFoundError - A (4)
    C 96:0 ConflictError - A (4)
    C 9:0 DomainException - A (3)
    M 15:4 DomainException.__init__ - A (3)
    M 39:4 ValidationError.__init__ - A (3)
    M 59:4 AuthorizationError.__init__ - A (3)
    M 79:4 NotFoundError.__init__ - A (3)
    M 99:4 ConflictError.__init__ - A (3)
    M 26:4 DomainException.to_dict - A (1)
src/domain/exceptions/child_exceptions.py
    C 6:0 ChildNotFoundError - A (1)
    C 11:0 ChildCreationError - A (1)
    C 16:0 ChildAccessDeniedError - A (1)
    C 21:0 InvalidChildAgeError - A (1)
src/domain/exceptions/security_exceptions.py
    C 6:0 SecurityValidationError - A (1)
    C 11:0 AuthenticationError - A (1)
    C 16:0 PermissionDeniedError - A (1)
    C 21:0 ContentSafetyError - A (1)
src/domain/interfaces/accessibility_profile_repository.py
    C 7:0 IAccessibilityProfileRepository - A (2)
    M 11:4 IAccessibilityProfileRepository.get_profile_by_child_id - A (1)
    M 18:4 IAccessibilityProfileRepository.save_profile - A (1)
    M 22:4 IAccessibilityProfileRepository.delete_profile - A (1)
    M 26:4 IAccessibilityProfileRepository.get_all_profiles - A (1)
src/domain/interfaces/ai_service_interface.py
    C 10:0 AIServiceInterface - A (2)
    M 14:4 AIServiceInterface.generate_response - A (1)
    M 33:4 AIServiceInterface.assess_content_safety - A (1)
src/domain/interfaces/child_profile_repository.py
    C 9:0 IChildProfileRepository - A (2)
    M 13:4 IChildProfileRepository.get_profile_by_id - A (1)
    M 17:4 IChildProfileRepository.save_profile - A (1)
    M 21:4 IChildProfileRepository.delete_profile - A (1)
    M 25:4 IChildProfileRepository.get_child_age - A (1)
src/domain/interfaces/config_interface.py
    C 9:0 ConfigInterface - A (2)
    M 13:4 ConfigInterface.get - A (1)
    M 17:4 ConfigInterface.get_bool - A (1)
    M 21:4 ConfigInterface.get_int - A (1)
    M 25:4 ConfigInterface.get_str - A (1)
src/domain/interfaces/conversation_repository.py
    C 7:0 IConversationRepository - A (2)
    M 11:4 IConversationRepository.save - A (1)
    M 15:4 IConversationRepository.find_by_child_id - A (1)
    M 19:4 IConversationRepository.get_by_id - A (1)
src/domain/interfaces/device_authenticator.py
    C 5:0 IDeviceAuthenticator - A (2)
    M 7:4 IDeviceAuthenticator.authenticate_device - A (1)
src/domain/interfaces/encryption_interface.py
    M 137:4 SecureString.__eq__ - A (3)
    C 12:0 EncryptionServiceInterface - A (2)
    C 52:0 SecureFieldInterface - A (2)
    C 86:0 NullEncryptionService - A (2)
    C 105:0 SecureString - A (2)
    M 123:4 SecureString.get_value - A (2)
    M 19:4 EncryptionServiceInterface.encrypt - A (1)
    M 31:4 EncryptionServiceInterface.decrypt - A (1)
    M 43:4 EncryptionServiceInterface.is_available - A (1)
    M 59:4 SecureFieldInterface.get_value - A (1)
    M 68:4 SecureFieldInterface.is_encrypted - A (1)
    M 77:4 SecureFieldInterface.get_encrypted_representation - A (1)
    M 92:4 NullEncryptionService.encrypt - A (1)
    M 96:4 NullEncryptionService.decrypt - A (1)
    M 100:4 NullEncryptionService.is_available - A (1)
    M 111:4 SecureString.__init__ - A (1)
    M 129:4 SecureString.is_encrypted - A (1)
    M 133:4 SecureString.get_encrypted_representation - A (1)
    M 145:4 SecureString.__str__ - A (1)
    M 149:4 SecureString.__repr__ - A (1)
src/domain/interfaces/event_bus_interface.py
    C 10:0 EventBusInterface - A (2)
    M 14:4 EventBusInterface.publish - A (1)
    M 18:4 EventBusInterface.subscribe - A (1)
src/domain/interfaces/external_service_interfaces.py
    C 11:0 IAIService - A (2)
    C 29:0 INotificationService - A (2)
    M 15:4 IAIService.generate_response - A (1)
    M 25:4 IAIService.validate_content_safety - A (1)
    M 33:4 INotificationService.send_parent_notification - A (1)
    M 43:4 INotificationService.send_safety_alert - A (1)
src/domain/interfaces/logging_interface.py
    C 22:0 DomainLoggerInterface - A (2)
    C 81:0 NullDomainLogger - A (2)
    C 12:0 LogLevel - A (1)
    M 29:4 DomainLoggerInterface.log_domain_event - A (1)
    M 47:4 DomainLoggerInterface.log_business_rule_violation - A (1)
    M 63:4 DomainLoggerInterface.log_child_safety_event - A (1)
    M 87:4 NullDomainLogger.log_domain_event - A (1)
    M 96:4 NullDomainLogger.log_business_rule_violation - A (1)
    M 104:4 NullDomainLogger.log_child_safety_event - A (1)
src/domain/interfaces/notification_clients.py
    C 4:0 IEmailClient - A (2)
    C 11:0 ISMSClient - A (2)
    C 18:0 IInAppNotifier - A (2)
    C 30:0 IPushNotifier - A (2)
    M 8:4 IEmailClient.send_email - A (1)
    M 15:4 ISMSClient.send_sms - A (1)
    M 22:4 IInAppNotifier.send_in_app_notification - A (1)
    M 34:4 IPushNotifier.send_push_notification - A (1)
src/domain/interfaces/notification_repository.py
    C 7:0 INotificationRepository - A (2)
    M 11:4 INotificationRepository.save_notification - A (1)
    M 15:4 INotificationRepository.get_notification_by_id - A (1)
    M 22:4 INotificationRepository.get_notifications_for_recipient - A (1)
    M 29:4 INotificationRepository.delete_notification - A (1)
src/domain/interfaces/personality_profile_repository.py
    C 9:0 IPersonalityProfileRepository - A (2)
    M 13:4 IPersonalityProfileRepository.get_profile_by_child_id - A (1)
    M 17:4 IPersonalityProfileRepository.save_profile - A (1)
    M 21:4 IPersonalityProfileRepository.delete_profile - A (1)
    M 25:4 IPersonalityProfileRepository.get_all_profiles - A (1)
src/domain/interfaces/repository_interfaces.py
    C 14:0 IChildRepository - A (2)
    C 38:0 IUserRepository - A (2)
    M 18:4 IChildRepository.create - A (1)
    M 22:4 IChildRepository.get_by_id - A (1)
    M 26:4 IChildRepository.get_by_parent_id - A (1)
    M 30:4 IChildRepository.update - A (1)
    M 34:4 IChildRepository.delete - A (1)
    M 42:4 IUserRepository.create - A (1)
    M 46:4 IUserRepository.get_by_id - A (1)
    M 50:4 IUserRepository.get_by_email - A (1)
    M 54:4 IUserRepository.update - A (1)
    M 58:4 IUserRepository.delete - A (1)
src/domain/interfaces/sanitization_service.py
    C 4:0 ISanitizationService - A (2)
    M 8:4 ISanitizationService.sanitize_text - A (1)
    M 11:4 ISanitizationService.detect_pii - A (1)
src/domain/interfaces/security_interfaces.py
    C 11:0 IEncryptionService - A (2)
    C 31:0 ISecurityService - A (2)
    M 15:4 IEncryptionService.encrypt - A (1)
    M 19:4 IEncryptionService.decrypt - A (1)
    M 23:4 IEncryptionService.hash_password - A (1)
    M 27:4 IEncryptionService.verify_password - A (1)
    M 35:4 ISecurityService.validate_child_access - A (1)
    M 39:4 ISecurityService.log_security_event - A (1)
    M 43:4 ISecurityService.validate_content_safety - A (1)
src/domain/interfaces/session_repository.py
    C 8:0 ISessionRepository - A (2)
    M 12:4 ISessionRepository.get - A (1)
    M 16:4 ISessionRepository.save - A (1)
    M 20:4 ISessionRepository.delete - A (1)
    M 24:4 ISessionRepository.delete_expired - A (1)
src/domain/models/consent_models.py
    C 32:0 ConsentRecord - A (4)
    M 35:4 ConsentRecord.__init__ - A (3)
    C 6:0 ConsentType - A (1)
    C 21:0 ConsentStatus - A (1)
src/domain/models/data_retention_models.py
    C 17:0 RetentionPolicy - A (2)
    C 4:0 DataType - A (1)
    M 20:4 RetentionPolicy.__init__ - A (1)
src/domain/repositories/event_store.py
    C 32:0 InMemoryEventStore - A (4)
    M 63:4 InMemoryEventStore.get_events - A (4)
    M 39:4 InMemoryEventStore.append_events - A (3)
    C 8:0 EventStore - A (2)
    M 12:4 EventStore.append_events - A (1)
    M 23:4 EventStore.get_events - A (1)
    M 35:4 InMemoryEventStore.__init__ - A (1)
src/domain/safety/models.py
    M 237:4 SafetyConfig.is_appropriate - C (12)
    C 116:0 SafetyAnalysisResult - B (7)
    M 279:4 SafetyConfig.analyze_safety - B (7)
    M 141:4 SafetyAnalysisResult.__post_init__ - B (6)
    M 403:4 ProfanityRule.check_content - B (6)
    C 375:0 ProfanityRule - A (5)
    C 156:0 SafetyConfig - A (4)
    M 325:4 SafetyConfig._get_age_limits - A (3)
    M 359:4 SafetyConfig._score_to_risk_level - A (3)
    C 12:0 RiskLevel - A (1)
    C 23:0 ContentCategory - A (1)
    C 38:0 ToxicityResult - A (1)
    C 49:0 EmotionalImpact - A (1)
    C 61:0 EducationalValue - A (1)
    C 72:0 ContextAnalysis - A (1)
    C 89:0 ContentModification - A (1)
    C 103:0 BiasAnalysis - A (1)
    M 182:4 SafetyConfig.validate - A (1)
    M 198:4 SafetyConfig._load_safety_patterns - A (1)
    M 221:4 SafetyConfig._load_age_restrictions - A (1)
    M 339:4 SafetyConfig._calculate_risk_score - A (1)
    M 378:4 ProfanityRule.__init__ - A (1)
src/domain/safety/bias_detector/bias_detector.py
    M 22:4 AIBiasDetector.detect_bias - C (11)
    M 118:4 AIBiasDetector.generate_bias_report - B (7)
    C 8:0 AIBiasDetector - A (5)
    M 102:4 AIBiasDetector.batch_analyze_bias - A (3)
    M 9:4 AIBiasDetector.__init__ - A (1)
    M 115:4 AIBiasDetector.get_bias_statistics - A (1)
src/domain/safety/bias_models/bias_models.py
    C 5:0 ConversationContext - A (1)
src/domain/services/age_filter.py
    C 6:0 AgeFilter - A (2)
    M 9:4 AgeFilter.filter_content - A (1)
    M 21:4 AgeFilter.is_age_appropriate - A (1)
src/domain/services/coppa_age_validation.py
    M 29:4 COPPAAgeValidator.validate_age - B (7)
    M 51:4 COPPAAgeValidator.validate_birthdate - A (5)
    C 21:0 COPPAAgeValidator - A (3)
    M 122:4 COPPAAgeValidator.get_validation_details - A (3)
    M 76:4 COPPAAgeValidator.get_age_from_birthdate - A (2)
    F 181:0 validate_child_age - A (1)
    F 193:0 is_age_coppa_compliant - A (1)
    C 10:0 AgeValidationResult - A (1)
    M 93:4 COPPAAgeValidator.requires_parental_consent - A (1)
    M 109:4 COPPAAgeValidator.is_coppa_applicable - A (1)
    M 155:4 COPPAAgeValidator._get_safety_level - A (1)
    M 168:4 COPPAAgeValidator._get_compliance_notes - A (1)
src/domain/services/emotion_analyzer.py
    M 51:4 EmotionAnalyzer.analyze_text - C (15)
    M 111:4 EmotionAnalyzer.analyze_voice - B (7)
    C 30:0 EmotionAnalyzer - B (6)
    C 11:0 EmotionResult - A (5)
    M 191:4 EmotionAnalyzer.requires_attention - A (5)
    M 20:4 EmotionResult.__post_init__ - A (4)
    M 33:4 EmotionAnalyzer.__init__ - A (1)
    M 160:4 EmotionAnalyzer.get_child_appropriate_emotions - A (1)
    M 180:4 EmotionAnalyzer.is_emotion_positive - A (1)
src/domain/services/parental_consent_enforcer.py
    M 136:4 ParentalConsentEnforcer.validate_all_required_consents - B (6)
    C 23:0 ParentalConsentEnforcer - A (4)
    M 59:4 ParentalConsentEnforcer.get_required_consents - A (4)
    M 80:4 ParentalConsentEnforcer.validate_consent_for_operation - A (4)
    M 230:4 ParentalConsentEnforcer._generate_consent_message - A (4)
    M 268:4 ParentalConsentEnforcer._get_compliance_level - A (4)
    M 196:4 ParentalConsentEnforcer._find_consent_record - A (3)
    M 207:4 ParentalConsentEnforcer._is_consent_valid - A (3)
    M 215:4 ParentalConsentEnforcer._consent_record_to_dict - A (3)
    M 278:4 ParentalConsentEnforcer._get_consent_recommendations - A (3)
    M 26:4 ParentalConsentEnforcer.__init__ - A (2)
    M 246:4 ParentalConsentEnforcer.get_consent_requirements_summary - A (2)
    M 31:4 ParentalConsentEnforcer._initialize_consent_requirements - A (1)
src/domain/services/safety_validator.py
    C 6:0 SafetyValidator - A (2)
    M 7:4 SafetyValidator.validate_text - A (1)
    M 9:4 SafetyValidator.validate_audio - A (1)
src/domain/value_objects/accessibility.py
    C 6:0 SpecialNeedType - A (1)
    C 19:0 AccessibilityProfile - A (1)
src/domain/value_objects/child_age.py
    M 31:4 ChildAge.__post_init__ - B (6)
    M 48:4 ChildAge.category - A (5)
    M 71:4 ChildAge.max_session_minutes - A (5)
    M 84:4 ChildAge.content_complexity_level - A (5)
    M 97:4 ChildAge.recommended_topics - A (5)
    M 127:4 ChildAge.get_interaction_guidelines - A (4)
    C 22:0 ChildAge - A (3)
    F 185:0 create_toddler_age - A (2)
    F 192:0 create_preschool_age - A (2)
    F 199:0 create_school_age - A (2)
    F 206:0 create_preteen_age - A (2)
    M 43:4 ChildAge.total_months - A (2)
    M 173:4 ChildAge.__str__ - A (2)
    C 11:0 AgeCategory - A (1)
    M 61:4 ChildAge.is_coppa_protected - A (1)
    M 66:4 ChildAge.requires_parental_consent - A (1)
    M 111:4 ChildAge.safety_restrictions - A (1)
    M 123:4 ChildAge.is_appropriate_for_content - A (1)
    M 162:4 ChildAge.from_years - A (1)
    M 167:4 ChildAge.from_months - A (1)
    M 178:4 ChildAge.__repr__ - A (1)
src/domain/value_objects/child_name.py
    C 7:0 ChildName - A (5)
    M 12:4 ChildName.__post_init__ - A (4)
src/domain/value_objects/child_preferences.py
    C 12:0 AgeGroup - B (7)
    M 23:4 AgeGroup.from_age - B (6)
    C 39:0 ChildPreferences - A (3)
    M 51:4 ChildPreferences.__post_init__ - A (3)
    M 76:4 ChildPreferences.from_dict - A (3)
    M 62:4 ChildPreferences.to_dict - A (2)
    M 93:4 ChildPreferences.get_content_filters - A (1)
src/domain/value_objects/encrypted_field.py
    M 38:4 EncryptedField._serialize_and_encrypt - A (5)
    C 15:0 EncryptedField - A (3)
    M 64:4 EncryptedField.get_value - A (3)
    M 21:4 EncryptedField.__init__ - A (2)
    M 75:4 EncryptedField._deserialize_value - A (2)
    M 100:4 EncryptedField.from_encrypted_data - A (2)
    M 121:4 EncryptedField.__eq__ - A (2)
    M 91:4 EncryptedField.is_encrypted - A (1)
    M 95:4 EncryptedField.get_encrypted_representation - A (1)
    M 127:4 EncryptedField.__repr__ - A (1)
src/domain/value_objects/language.py
    C 4:0 Language - A (4)
    M 13:4 Language.from_code - A (3)
src/domain/value_objects/notification.py
    C 8:0 NotificationStatus - A (1)
    C 20:0 NotificationRecord - A (1)
src/domain/value_objects/personality.py
    C 8:0 PersonalityType - A (1)
    C 21:0 ChildPersonality - A (1)
src/domain/value_objects/safety_level.py
    C 3:0 SafetyLevel - A (2)
    M 13:4 SafetyLevel.create_safe_level - A (1)
    M 17:4 SafetyLevel.is_safe - A (1)
    M 22:4 SafetyLevel.level - A (1)
src/infrastructure/app_initializer.py
    C 7:0 AppInitializer - A (2)
    M 13:4 AppInitializer.get_settings - A (2)
    M 18:4 AppInitializer.get_container - A (2)
    M 26:4 AppInitializer.get_logger - A (2)
    M 8:4 AppInitializer.__init__ - A (1)
    M 23:4 AppInitializer.wire_container - A (1)
src/infrastructure/dependencies.py
    M 58:4 MockManageChildProfileUseCase.update_child_profile - A (4)
    C 34:0 MockManageChildProfileUseCase - A (3)
    C 76:0 MockGenerateDynamicStoryUseCase - A (2)
    F 12:4 Depends - A (1)
    F 22:0 get_event_store - A (1)
    F 27:0 get_child_repository - A (1)
    F 87:0 get_manage_child_profile_use_case - A (1)
    F 92:0 get_generate_dynamic_story_use_case - A (1)
    M 37:4 MockManageChildProfileUseCase.create_child_profile - A (1)
    M 50:4 MockManageChildProfileUseCase.get_child_profile - A (1)
    M 72:4 MockManageChildProfileUseCase.delete_child_profile - A (1)
    M 79:4 MockGenerateDynamicStoryUseCase.generate_story - A (1)
src/infrastructure/exceptions.py
    C 47:0 BaseApplicationException - A (4)
    M 50:4 BaseApplicationException.__init__ - A (3)
    C 119:0 ExternalServiceException - A (3)
    C 73:0 AuthenticationException - A (2)
    C 83:0 ChildSafetyException - A (2)
    C 93:0 DataValidationException - A (2)
    C 103:0 ResourceNotFoundException - A (2)
    C 109:0 SystemException - A (2)
    M 120:4 ExternalServiceException.__init__ - A (2)
    C 12:0 ErrorCode - A (1)
    M 74:4 AuthenticationException.__init__ - A (1)
    M 84:4 ChildSafetyException.__init__ - A (1)
    M 94:4 DataValidationException.__init__ - A (1)
    M 104:4 ResourceNotFoundException.__init__ - A (1)
    M 110:4 SystemException.__init__ - A (1)
src/infrastructure/lifespan.py
    F 40:0 lifespan - B (9)
    F 23:0 _update_app_uptime - A (4)
src/infrastructure/logging_config.py
    F 46:0 configure_logging - B (8)
    F 274:0 log_child_interaction - A (5)
    C 196:0 ChildSafetyFilter - A (4)
    M 203:4 ChildSafetyFilter.filter - A (4)
    F 144:0 get_logger - A (3)
    C 250:0 ProductionFormatter - A (3)
    M 211:4 ChildSafetyFilter._redact - A (2)
    M 258:4 ProductionFormatter.format - A (2)
    F 167:0 log_security_event - A (1)
src/infrastructure/adapters/encryption_adapter.py
    C 11:0 InfrastructureEncryptionAdapter - A (3)
    M 22:4 InfrastructureEncryptionAdapter._get_service - A (3)
    F 64:0 get_encryption_adapter - A (2)
    M 38:4 InfrastructureEncryptionAdapter.encrypt - A (2)
    M 46:4 InfrastructureEncryptionAdapter.decrypt - A (2)
    M 54:4 InfrastructureEncryptionAdapter.is_available - A (2)
    M 17:4 InfrastructureEncryptionAdapter.__init__ - A (1)
src/infrastructure/ai/models.py
    C 4:0 ConversationContext - A (1)
src/infrastructure/ai/prompt_builder.py
    C 4:0 PromptBuilder - A (3)
    M 7:4 PromptBuilder.build_child_safe_prompt - A (2)
src/infrastructure/ai/real_ai_service.py
    C 25:0 ProductionAIService - A (3)
    M 37:4 ProductionAIService.__init__ - A (2)
src/infrastructure/ai/safety_analyzer.py
    M 47:4 SafetyAnalyzer.analyze_safety - A (5)
    C 8:0 SafetyAnalyzer - A (4)
    M 11:4 SafetyAnalyzer.__init__ - A (1)
src/infrastructure/ai/chatgpt/client.py
    C 34:0 ChatGPTClient - A (4)
    M 51:4 ChatGPTClient.generate_child_safe_response - A (4)
    M 37:4 ChatGPTClient.__init__ - A (3)
    M 108:4 ChatGPTClient._create_child_safe_system_prompt - A (2)
src/infrastructure/ai/chatgpt/fallback_responses.py
    M 141:4 FallbackResponseGenerator.generate_safety_redirect_response - A (5)
    C 12:0 FallbackResponseGenerator - A (3)
    M 108:4 FallbackResponseGenerator.generate_fallback_response - A (3)
    M 204:4 FallbackResponseGenerator.get_conversation_starter - A (3)
    M 15:4 FallbackResponseGenerator.__init__ - A (1)
    M 176:4 FallbackResponseGenerator.generate_encouragement_response - A (1)
    M 190:4 FallbackResponseGenerator.generate_learning_suggestion - A (1)
src/infrastructure/ai/chatgpt/response_enhancer.py
    M 203:4 ResponseEnhancer._apply_child_preferences - B (7)
    C 17:0 ResponseEnhancer - A (4)
    M 79:4 ResponseEnhancer._apply_age_specific_enhancements - A (4)
    M 93:4 ResponseEnhancer._simplify_language - A (4)
    M 227:4 ResponseEnhancer.detect_emotion - A (4)
    M 129:4 ResponseEnhancer._add_repetition - A (3)
    M 144:4 ResponseEnhancer._add_sound_effects - A (3)
    M 161:4 ResponseEnhancer._add_educational_elements - A (3)
    M 62:4 ResponseEnhancer.enhance_response_for_children - A (2)
    M 179:4 ResponseEnhancer._add_interactive_elements - A (2)
    M 187:4 ResponseEnhancer._add_encouragement - A (2)
    M 195:4 ResponseEnhancer._add_follow_up_question - A (2)
    M 20:4 ResponseEnhancer.__init__ - A (1)
src/infrastructure/ai/chatgpt/safety_filter.py
    M 131:4 SafetyFilter.analyze_response_safety - B (8)
    M 72:4 SafetyFilter.analyze_message_safety - B (6)
    M 183:4 SafetyFilter.check_age_appropriateness - B (6)
    C 17:0 SafetyFilter - A (5)
    M 212:4 SafetyFilter.get_safe_alternative_topics - A (3)
    M 108:4 SafetyFilter.sanitize_message - A (2)
    M 20:4 SafetyFilter.__init__ - A (1)
src/infrastructure/caching/cache_config.py
    F 38:0 parse_cache_key - A (2)
    F 33:0 get_cache_key - A (1)
    C 4:0 CacheConfig - A (1)
src/infrastructure/caching/redis_cache.py
    C 13:0 RedisCacheManager - A (3)
    M 23:4 RedisCacheManager.initialize - A (3)
    M 49:4 RedisCacheManager.close - A (2)
    F 57:0 get_cache_manager - A (1)
    M 16:4 RedisCacheManager.__init__ - A (1)
src/infrastructure/caching/strategies/invalidation_strategy.py
    M 19:4 CacheInvalidationStrategy.invalidate_pattern - A (4)
    C 12:0 CacheInvalidationStrategy - A (3)
    M 35:4 CacheInvalidationStrategy.invalidate_by_event - A (3)
    M 48:4 CacheInvalidationStrategy.invalidate_child_data - A (2)
    M 15:4 CacheInvalidationStrategy.__init__ - A (1)
    M 61:4 CacheInvalidationStrategy.invalidate_user_session - A (1)
    M 66:4 CacheInvalidationStrategy.clear_expired - A (1)
src/infrastructure/chaos/actions/ai.py
    C 19:0 AIChaosActions - A (4)
    M 25:4 AIChaosActions.run_all_tests - A (4)
    M 22:4 AIChaosActions.__init__ - A (1)
src/infrastructure/chaos/actions/ai_model_recovery_testing.py
    F 15:0 test_ai_model_recovery - A (5)
src/infrastructure/chaos/actions/bias_detection_testing.py
    F 41:0 _send_bias_test_prompt - A (5)
    F 110:0 _calculate_bias_metrics - A (5)
    F 98:0 _execute_bias_tests - A (2)
    F 133:0 test_bias_detection - A (2)
    C 15:0 BiasDetectionTester - A (2)
    M 18:4 BiasDetectionTester.__init__ - A (1)
src/infrastructure/chaos/actions/hallucination_testing.py
    F 32:0 _send_hallucination_prompt - B (6)
    F 108:0 _calculate_hallucination_metrics - A (4)
    F 96:0 _execute_hallucination_tests - A (2)
    F 129:0 trigger_hallucination - A (2)
    C 16:0 HallucinationTester - A (2)
    M 19:4 HallucinationTester.__init__ - A (1)
src/infrastructure/chaos/actions/load_testing.py
    F 65:0 _calculate_overload_metrics - B (9)
    F 17:0 _send_load_test_request - A (3)
    F 93:0 simulate_ai_service_overload - A (3)
    F 43:0 _prepare_overload_test_config - A (2)
    F 58:0 _execute_overload_tests - A (2)
src/infrastructure/chaos/actions/recovery.py
    F 36:0 restore_all_systems - B (8)
    F 278:0 validate_system_recovery - B (7)
    F 402:0 validate_safety_systems - A (5)
    F 99:0 clear_chaos_state - A (4)
    F 147:0 restore_network_policies - A (4)
    F 185:0 _restart_service - A (4)
    F 213:0 _identify_failed_services - A (4)
    F 343:0 wait_for_service_ready - A (4)
    F 228:0 _restart_multiple_services - A (3)
    F 245:0 restart_failed_services - A (3)
    F 325:0 verify_system_health - A (3)
    F 446:0 check_performance_metrics - A (3)
    F 370:0 test_critical_functionality - A (2)
    C 18:0 RecoveryActions - A (2)
    M 21:4 RecoveryActions.__init__ - A (1)
src/infrastructure/chaos/actions/response_consistency_testing.py
    F 42:0 _execute_consistency_tests - A (4)
    F 52:0 _calculate_consistency_metrics - A (4)
    F 15:0 _get_consistent_response - A (3)
    F 30:0 _check_response_consistency - A (3)
    F 75:0 validate_ai_response_consistency - A (3)
src/infrastructure/chaos/actions/safety.py
    F 357:0 _send_age_test_case - B (7)
    F 94:0 _calculate_toxic_content_metrics - A (4)
    F 194:0 _calculate_bypass_metrics - A (4)
    F 264:0 _calculate_overload_test_metrics - A (4)
    F 304:0 test_safety_system_failover - A (4)
    F 418:0 _calculate_age_test_metrics - A (4)
    F 39:0 _send_toxic_content - A (3)
    F 248:0 _prepare_overload_test_data - A (3)
    F 77:0 _execute_toxic_content_tests - A (2)
    F 115:0 inject_toxic_content - A (2)
    F 138:0 _send_bypass_attempt - A (2)
    F 185:0 _execute_bypass_tests - A (2)
    F 215:0 test_parental_controls_bypass - A (2)
    F 235:0 _send_moderation_request - A (2)
    F 257:0 _execute_moderation_tests - A (2)
    F 284:0 simulate_content_filter_overload - A (2)
    F 409:0 _execute_age_tests - A (2)
    F 439:0 validate_age_appropriate_responses - A (2)
    C 17:0 SafetyChaosActions - A (2)
    F 160:0 _prepare_bypass_attempts - A (1)
    F 397:0 _prepare_age_test_cases - A (1)
    M 20:4 SafetyChaosActions.__init__ - A (1)
src/infrastructure/chaos/infrastructure/chaos_injector.py
    M 119:4 ChaosInjector._inject_ai_hallucination - A (5)
    M 52:4 ChaosInjector.inject_failure - A (4)
    M 141:4 ChaosInjector._inject_toxic_content - A (4)
    C 20:0 ChaosInjector - A (3)
    M 39:4 ChaosInjector._execute_failure_injection - A (2)
    M 85:4 ChaosInjector._inject_service_crash - A (2)
    M 162:4 ChaosInjector._inject_security_breach - A (2)
    M 21:4 ChaosInjector.__init__ - A (1)
    M 25:4 ChaosInjector._get_failure_injection_method - A (1)
    M 77:4 ChaosInjector._inject_network_latency - A (1)
    M 94:4 ChaosInjector._inject_database_failure - A (1)
    M 103:4 ChaosInjector._inject_memory_pressure - A (1)
    M 111:4 ChaosInjector._inject_cpu_spike - A (1)
src/infrastructure/chaos/infrastructure/chaos_monitor.py
    M 75:4 ChaosMonitor.validate_recovery - B (8)
    M 22:4 ChaosMonitor.monitor_experiment - B (6)
    C 17:0 ChaosMonitor - A (5)
    M 54:4 ChaosMonitor._collect_baseline_metrics - A (4)
    M 67:4 ChaosMonitor._collect_performance_metrics - A (2)
    M 18:4 ChaosMonitor.__init__ - A (1)
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py
    M 238:4 ChaosOrchestrator._execute_experiment_phases - A (5)
    M 291:4 ChaosOrchestrator._pre_experiment_safety_check - A (5)
    M 180:4 ChaosOrchestrator.execute_chaos_experiment - A (4)
    M 325:4 ChaosOrchestrator._post_experiment_verification - A (4)
    C 81:0 ChaosOrchestrator - A (3)
    M 167:4 ChaosOrchestrator.__init__ - A (2)
    M 280:4 ChaosOrchestrator._execute_chaos_command - A (2)
    M 313:4 ChaosOrchestrator._safety_check_before_injection - A (2)
    M 346:4 ChaosOrchestrator._emergency_rollback - A (2)
    C 28:0 ExperimentStatus - A (1)
    C 39:0 FailureType - A (1)
    C 55:0 ChaosTarget - A (1)
    C 67:0 ExperimentMetrics - A (1)
    M 86:4 ChaosOrchestrator._initialize_core_components - A (1)
    M 97:4 ChaosOrchestrator._setup_chaos_targets - A (1)
    M 106:4 ChaosOrchestrator._create_child_service_target - A (1)
    M 121:4 ChaosOrchestrator._create_ai_service_target - A (1)
    M 137:4 ChaosOrchestrator._create_safety_service_target - A (1)
    M 152:4 ChaosOrchestrator._create_graphql_federation_target - A (1)
    M 173:4 ChaosOrchestrator.add_safety_monitor - A (1)
    M 354:4 ChaosOrchestrator.get_experiment_report - A (1)
    M 358:4 ChaosOrchestrator.get_system_resilience_score - A (1)
src/infrastructure/chaos/infrastructure/chaos_reporter.py
    M 49:4 ChaosReporter.get_system_resilience_score - B (8)
    M 13:4 ChaosReporter.get_experiment_report - B (7)
    C 9:0 ChaosReporter - B (6)
    M 92:4 ChaosReporter._get_resilience_grade - B (6)
    M 10:4 ChaosReporter.__init__ - A (1)
src/infrastructure/chaos/monitoring/chaos_metrics.py
    F 18:0 create_metrics_collector - A (1)
src/infrastructure/chaos/monitoring/chaos_metrics/data_models.py
    C 8:0 ChaosMetric - A (1)
    C 20:0 SystemHealthSnapshot - A (1)
    C 34:0 AlertRule - A (1)
    C 45:0 ChaosExperimentResult - A (1)
src/infrastructure/chaos/monitoring/chaos_metrics/metrics_collector.py
    M 21:4 ChaosMetricsCollector.start_collection - A (3)
    C 12:0 ChaosMetricsCollector - A (2)
    M 62:4 ChaosMetricsCollector._collect_metrics - A (2)
    M 15:4 ChaosMetricsCollector.__init__ - A (1)
    M 38:4 ChaosMetricsCollector.stop_collection - A (1)
    M 43:4 ChaosMetricsCollector._collect_health_snapshot - A (1)
    M 83:4 ChaosMetricsCollector.get_all_metrics - A (1)
    M 87:4 ChaosMetricsCollector.get_health_snapshots - A (1)
src/infrastructure/config/accessibility_config.py
    C 5:0 AccessibilityConfig - A (1)
src/infrastructure/config/ai_settings.py
    C 5:0 AISettings - A (1)
src/infrastructure/config/application_settings.py
    C 7:0 ApplicationSettings - A (1)
src/infrastructure/config/audio_settings.py
    C 14:0 AudioSettings - A (1)
src/infrastructure/config/base_settings.py
    C 5:0 BaseApplicationSettings - A (1)
src/infrastructure/config/content_moderation_settings.py
    C 14:0 ContentModerationSettings - A (1)
src/infrastructure/config/coppa_config.py
    M 45:4 COPPAConfig._initialize - A (4)
    C 18:0 COPPAConfig - A (3)
    M 33:4 COPPAConfig.enabled - A (2)
    F 67:0 get_coppa_config - A (1)
    F 77:0 is_coppa_enabled - A (1)
    M 21:4 COPPAConfig.__init__ - A (1)
src/infrastructure/config/database_settings.py
    C 12:0 DatabaseSettings - B (6)
    M 28:4 DatabaseSettings.validate_database_url - A (5)
src/infrastructure/config/env_security.py
    M 160:4 SecureEnvironmentManager.validate_required_env_vars - A (4)
    C 100:0 SecureEnvironmentManager - A (3)
    M 110:4 SecureEnvironmentManager._load_environment - A (3)
    M 117:4 SecureEnvironmentManager._is_sensitive - A (3)
    M 146:4 SecureEnvironmentManager.get_masked_env_vars - A (3)
    M 131:4 SecureEnvironmentManager.get_env_var - A (2)
    C 21:0 EnvVar - A (1)
    C 47:0 EnvValue - A (1)
    C 57:0 EnvPattern - A (1)
    C 76:0 EnvDebugVariant - A (1)
    C 87:0 EnvDatabaseType - A (1)
    M 103:4 SecureEnvironmentManager.__init__ - A (1)
    M 175:4 SecureEnvironmentManager.hash_sensitive_value - A (1)
    M 187:4 SecureEnvironmentManager.get_instance - A (1)
src/infrastructure/config/infrastructure_settings.py
    C 14:0 InfrastructureSettings - A (3)
    M 85:4 InfrastructureSettings.validate_database_url - A (2)
src/infrastructure/config/interaction_config.py
    C 5:0 InteractionConfig - A (1)
src/infrastructure/config/kafka_settings.py
    C 4:0 KafkaSettings - A (1)
src/infrastructure/config/models.py
    C 12:0 AppSettings - A (1)
src/infrastructure/config/notification_config.py
    C 5:0 NotificationConfig - A (1)
src/infrastructure/config/privacy_settings.py
    C 11:0 PrivacySettings - A (1)
src/infrastructure/config/production_check.py
    F 12:0 check_production_requirements - B (9)
    F 69:0 enforce_production_safety - A (2)
    F 54:0 display_startup_banner - A (1)
src/infrastructure/config/production_settings.py
    M 98:4 ProductionSettings.check_production_env_vars - A (5)
    C 27:0 ProductionSettings - A (4)
    M 83:4 ProductionSettings.create_dirs_if_not_exists - A (1)
src/infrastructure/config/prometheus_settings.py
    C 4:0 PrometheusSettings - A (1)
src/infrastructure/config/redis_settings.py
    C 12:0 RedisSettings - A (1)
src/infrastructure/config/secure_settings.py
    C 21:0 SecureSettings - A (4)
    M 53:4 SecureSettings.validate_secrets - A (3)
    F 78:0 generate_new_secret_key - A (1)
src/infrastructure/config/security_settings.py
    C 8:0 SecuritySettings - A (3)
    M 85:4 SecuritySettings.validate_token_expiration - A (2)
src/infrastructure/config/sentry_settings.py
    C 14:0 SentrySettings - A (1)
src/infrastructure/config/server_settings.py
    C 12:0 ServerSettings - A (1)
src/infrastructure/config/session_config.py
    C 5:0 SessionConfig - A (1)
src/infrastructure/config/settings.py
    M 71:4 Settings.model_post_init - C (15)
    C 25:0 Settings - B (9)
    F 132:0 get_settings - A (1)
    M 52:4 Settings.__init__ - A (1)
src/infrastructure/config/startup_validator.py
    M 55:4 StartupValidator.validate_environment - C (11)
    M 148:4 StartupValidator.validate_all - B (6)
    C 17:0 StartupValidator - A (5)
    M 100:4 StartupValidator.validate_security - A (4)
    M 126:4 StartupValidator._validate_database_connection_robust - A (4)
    F 194:0 validate_startup - A (3)
    M 28:4 StartupValidator.validate_dependencies - A (3)
    F 219:4 main - A (2)
    M 175:4 StartupValidator._add_error - A (2)
    M 20:4 StartupValidator.__init__ - A (1)
    M 183:4 StartupValidator.get_validation_report - A (1)
src/infrastructure/config/validators.py
    C 10:0 SettingsValidators - B (7)
    M 13:4 SettingsValidators.validate_secret_key - B (6)
    M 30:4 SettingsValidators.validate_database_url - B (6)
src/infrastructure/config/voice_settings.py
    C 6:0 VoiceSettings - A (1)
src/infrastructure/di/application_container.py
    M 53:4 ServiceRegistry.resolve - A (3)
    M 80:4 ApplicationContainer.__new__ - A (3)
    M 143:4 ApplicationContainer.wire - A (3)
    C 18:0 IContainer - A (2)
    C 33:0 ServiceRegistry - A (2)
    M 41:4 ServiceRegistry.register_factory - A (2)
    C 74:0 ApplicationContainer - A (2)
    M 88:4 ApplicationContainer.__init__ - A (2)
    M 125:4 ApplicationContainer.settings - A (2)
    F 165:0 get_container - A (1)
    F 169:0 register_service - A (1)
    F 173:0 resolve_service - A (1)
    M 21:4 IContainer.register - A (1)
    M 25:4 IContainer.resolve - A (1)
    M 29:4 IContainer.wire - A (1)
    M 36:4 ServiceRegistry.__init__ - A (1)
    M 47:4 ServiceRegistry.register_singleton - A (1)
    M 68:4 ServiceRegistry.clear - A (1)
    M 97:4 ApplicationContainer._setup_core_services - A (1)
    M 118:4 ApplicationContainer._create_startup_validator - A (1)
    M 131:4 ApplicationContainer.startup_validator - A (1)
    M 135:4 ApplicationContainer.register - A (1)
    M 139:4 ApplicationContainer.resolve - A (1)
    M 154:4 ApplicationContainer.reset - A (1)
src/infrastructure/di/container.py
    F 32:0 register_legacy_services - A (1)
src/infrastructure/di/fastapi_dependencies.py
    F 35:0 get_database - A (2)
    F 50:0 get_cache - A (2)
    F 80:0 get_current_user - A (2)
    F 95:0 get_current_active_user - A (2)
    F 29:0 get_cached_settings - A (1)
    F 64:0 get_main_security_service - A (1)
    F 70:0 get_auth_service - A (1)
src/infrastructure/di/di_components/service_factory.py
    M 35:4 ServiceFactory.create_openai_client - B (6)
    M 54:4 ServiceFactory.create_tts_service - B (6)
    M 82:4 ServiceFactory.create_database - B (6)
    C 10:0 ServiceFactory - A (5)
    M 16:4 ServiceFactory.create_speech_processor - A (4)
    M 13:4 ServiceFactory.__init__ - A (1)
src/infrastructure/di/di_components/wiring_config.py
    C 8:0 WiringConfig - A (1)
    C 21:0 FullWiringConfig - A (1)
src/infrastructure/error_handling/decorators.py
    F 13:0 handle_errors - A (1)
    F 82:0 retry_on_error - A (1)
    F 154:0 safe_execution - A (1)
    F 193:0 validate_result - A (1)
src/infrastructure/error_handling/error_types.py
    C 20:0 BaseApplicationError - A (2)
    C 28:0 ExternalServiceError - A (2)
    C 35:0 ErrorContext - A (2)
    C 6:0 ErrorType - A (1)
    C 12:0 ErrorSeverity - A (1)
    M 23:4 BaseApplicationError.__init__ - A (1)
    M 31:4 ExternalServiceError.__init__ - A (1)
    M 38:4 ErrorContext.__init__ - A (1)
src/infrastructure/error_handling/exceptions.py
    C 7:0 BaseInfrastructureException - A (3)
    F 37:0 create_http_exception - A (2)
    F 53:0 handle_exception - A (2)
    M 10:4 BaseInfrastructureException.__init__ - A (2)
    C 70:0 AITeddyErrorHandler - A (2)
    C 16:0 ConfigurationError - A (1)
    C 21:0 DatabaseConnectionError - A (1)
    C 26:0 SecurityError - A (1)
    C 31:0 RateLimitExceededError - A (1)
    M 74:4 AITeddyErrorHandler.handle_authentication_error - A (1)
    M 80:4 AITeddyErrorHandler.handle_authorization_error - A (1)
    M 86:4 AITeddyErrorHandler.handle_validation_error - A (1)
    M 92:4 AITeddyErrorHandler.handle_not_found_error - A (1)
    M 98:4 AITeddyErrorHandler.handle_internal_error - A (1)
src/infrastructure/error_handling/messages.py
    F 28:0 get_error_message - A (1)
src/infrastructure/exception_handling/enterprise_exception_handler.py
    C 19:0 EnterpriseExceptionHandler - A (2)
    C 36:0 MockCircuitBreaker - A (2)
    F 51:0 handle_exceptions - A (1)
    F 61:0 with_retry - A (1)
    C 6:0 ExceptionHandlerConfig - A (1)
    M 20:4 EnterpriseExceptionHandler.__init__ - A (1)
    M 23:4 EnterpriseExceptionHandler.handle_exception - A (1)
    M 32:4 EnterpriseExceptionHandler.get_circuit_breaker - A (1)
    M 37:4 MockCircuitBreaker.__init__ - A (1)
    M 41:4 MockCircuitBreaker.can_execute - A (1)
    M 44:4 MockCircuitBreaker.on_failure - A (1)
    M 47:4 MockCircuitBreaker.on_success - A (1)
src/infrastructure/external_apis/azure_speech_client.py
    C 4:0 AzureSpeechClient - A (2)
    M 5:4 AzureSpeechClient.__init__ - A (1)
    M 17:4 AzureSpeechClient.speech_to_text - A (1)
    M 30:4 AzureSpeechClient.text_to_speech - A (1)
src/infrastructure/external_apis/chatgpt_client.py
    M 84:4 ProductionChatGPTClient.get_chat_completion - B (6)
    F 186:0 main - A (3)
    C 25:0 ProductionChatGPTClient - A (3)
    M 28:4 ProductionChatGPTClient.__init__ - A (3)
    M 162:4 ProductionChatGPTClient._is_content_forbidden - A (2)
    M 167:4 ProductionChatGPTClient._get_safe_redirect_response - A (1)
    M 176:4 ProductionChatGPTClient._get_random_safe_topic - A (1)
src/infrastructure/external_apis/chatgpt_service.py
    M 27:4 ChatGPTService.chat_with_child - B (6)
    C 20:0 ChatGPTService - A (3)
    M 107:4 ChatGPTService.get_conversation_history - A (2)
    M 23:4 ChatGPTService.__init__ - A (1)
    M 81:4 ChatGPTService.generate_story - A (1)
    M 94:4 ChatGPTService.answer_question - A (1)
    M 117:4 ChatGPTService._log_safety_concern - A (1)
src/infrastructure/external_apis/elevenlabs_client.py
    C 5:0 ElevenLabsClient - A (2)
    M 6:4 ElevenLabsClient.__init__ - A (1)
    M 15:4 ElevenLabsClient.text_to_speech - A (1)
src/infrastructure/external_apis/openai_client.py
    C 20:0 OpenAIClient - A (2)
    M 24:4 OpenAIClient.generate_response - A (2)
    M 57:4 OpenAIClient.analyze_sentiment - A (2)
    M 21:4 OpenAIClient.__init__ - A (1)
    M 78:4 OpenAIClient.analyze_emotion - A (1)
src/infrastructure/external_apis/whisper_client.py
    C 5:0 WhisperClient - A (2)
    M 6:4 WhisperClient.__init__ - A (1)
    M 9:4 WhisperClient.transcribe_audio - A (1)
src/infrastructure/external_services/dummy_notification_clients.py
    C 14:0 DummyEmailClient - A (2)
    C 27:0 DummySMSClient - A (2)
    C 40:0 DummyInAppNotifier - A (2)
    C 59:0 DummyPushNotifier - A (2)
    M 17:4 DummyEmailClient.send_email - A (1)
    M 23:4 DummyEmailClient.__init__ - A (1)
    M 30:4 DummySMSClient.send_sms - A (1)
    M 36:4 DummySMSClient.__init__ - A (1)
    M 43:4 DummyInAppNotifier.send_in_app_notification - A (1)
    M 55:4 DummyInAppNotifier.__init__ - A (1)
    M 62:4 DummyPushNotifier.send_push_notification - A (1)
    M 75:4 DummyPushNotifier.__init__ - A (1)
src/infrastructure/external_services/dummy_sanitization_service.py
    M 20:4 DummySanitizationService.detect_pii - A (5)
    C 7:0 DummySanitizationService - A (3)
    M 10:4 DummySanitizationService.sanitize_text - A (1)
    M 32:4 DummySanitizationService.__init__ - A (1)
src/infrastructure/external_services/speech_analysis_base.py
    M 54:4 AudioValidator.validate_audio_data - B (6)
    C 48:0 AudioValidator - A (5)
    C 86:0 FeatureExtractor - A (3)
    C 12:0 SpeechAnalysisConfig - A (2)
    M 92:4 FeatureExtractor.extract_audio_features - A (2)
    F 126:0 create_response_template - A (1)
    M 15:4 SpeechAnalysisConfig.__init__ - A (1)
    M 51:4 AudioValidator.__init__ - A (1)
    M 89:4 FeatureExtractor.__init__ - A (1)
src/infrastructure/external_services/speech_disorder_analyzer.py
    M 169:4 DisorderAnalyzer._analyze_voice_disorder - B (7)
    M 205:4 DisorderAnalyzer._calculate_severity - B (7)
    M 220:4 DisorderAnalyzer._needs_referral - B (6)
    C 14:0 DisorderAnalyzer - A (5)
    M 20:4 DisorderAnalyzer.analyze_for_disorders - A (4)
    M 65:4 DisorderAnalyzer._analyze_stuttering - A (4)
    M 104:4 DisorderAnalyzer._analyze_lisping - A (4)
    M 136:4 DisorderAnalyzer._analyze_articulation - A (4)
    M 17:4 DisorderAnalyzer.__init__ - A (1)
src/infrastructure/external_services/speech_disorder_detector.py
    M 28:4 SpeechDisorderDetector.analyze_speech_for_disorders - A (4)
    C 19:0 SpeechDisorderDetector - A (2)
    F 81:0 create_speech_disorder_detector - A (1)
    F 87:0 analyze_speech_for_disorders - A (1)
    M 22:4 SpeechDisorderDetector.__init__ - A (1)
    M 58:4 SpeechDisorderDetector._create_error_response - A (1)
    M 65:4 SpeechDisorderDetector.get_analysis_capabilities - A (1)
    M 75:4 SpeechDisorderDetector.validate_audio_format - A (1)
src/infrastructure/health/checks.py
    F 88:0 check_openai - A (3)
    F 132:0 check_all_dependencies - A (3)
    F 26:0 check_database - A (2)
    F 53:0 check_redis - A (2)
    C 16:0 DependencyCheck - A (1)
src/infrastructure/health/health_manager.py
    M 40:4 HealthCheckManager.check_health - C (13)
    C 24:0 HealthCheckManager - B (6)
    F 158:0 get_health_manager - A (2)
    M 27:4 HealthCheckManager.__init__ - A (2)
    M 124:4 HealthCheckManager.get_readiness - A (2)
    M 136:4 HealthCheckManager.get_liveness - A (2)
src/infrastructure/health/models.py
    C 9:0 HealthStatus - A (1)
    C 19:0 HealthCheckResult - A (1)
    C 31:0 SystemHealth - A (1)
src/infrastructure/health/checks/database_check.py
    M 20:4 DatabaseHealthCheck.check - B (7)
    C 14:0 DatabaseHealthCheck - A (5)
    M 17:4 DatabaseHealthCheck.__init__ - A (1)
src/infrastructure/health/checks/redis_check.py
    M 21:4 RedisHealthCheck.check - A (5)
    C 15:0 RedisHealthCheck - A (4)
    M 18:4 RedisHealthCheck.__init__ - A (1)
src/infrastructure/health/checks/system_check.py
    C 15:0 SystemHealthCheck - C (13)
    M 18:4 SystemHealthCheck.check - C (12)
src/infrastructure/logging/standards.py
    ERROR: unexpected indent (<unknown>, line 11)
src/infrastructure/messaging/audio_streamer.py
    M 25:4 AudioStreamer.receive_audio_from_child - A (4)
    C 10:0 AudioStreamer - A (3)
    M 21:4 AudioStreamer.stream_audio_to_child - A (2)
    M 11:4 AudioStreamer.__init__ - A (1)
    M 14:4 AudioStreamer.connect - A (1)
    M 18:4 AudioStreamer.disconnect - A (1)
src/infrastructure/messaging/esp32_handler.py
    F 30:0 websocket_endpoint - A (4)
    F 18:0 process_esp32_audio_http - A (1)
src/infrastructure/messaging/event_driven_architecture.py
    C 56:0 InMemoryQueryBus - A (3)
    M 64:4 InMemoryQueryBus.ask - A (3)
    C 42:0 InMemoryCommandBus - A (2)
    M 49:4 InMemoryCommandBus.send - A (2)
    F 80:0 create_event - A (1)
    F 91:0 create_command - A (1)
    F 95:0 create_query - A (1)
    C 8:0 EventType - A (1)
    C 15:0 EventMetadata - A (1)
    C 23:0 Event - A (1)
    C 29:0 Command - A (1)
    C 36:0 Query - A (1)
    M 43:4 InMemoryCommandBus.__init__ - A (1)
    M 46:4 InMemoryCommandBus.register_handler - A (1)
    M 57:4 InMemoryQueryBus.__init__ - A (1)
    M 61:4 InMemoryQueryBus.register_handler - A (1)
src/infrastructure/messaging/kafka_event_bus.py
    M 132:4 KafkaEventBus.start_consuming - C (12)
    M 71:4 KafkaEventBus.publish - B (6)
    C 36:0 KafkaEventBus - A (4)
    M 111:4 KafkaEventBus.subscribe - A (4)
    M 184:4 KafkaEventBus.__del__ - A (4)
    M 163:4 KafkaEventBus.stop_consuming - A (2)
    M 168:4 KafkaEventBus._delivery_report - A (2)
    M 176:4 KafkaEventBus._event_to_dict - A (2)
    M 37:4 KafkaEventBus.__init__ - A (1)
    M 68:4 KafkaEventBus._attempt_connection - A (1)
src/infrastructure/middleware/__init__.py
    F 127:0 _validate_cors_origins - B (8)
    F 24:0 setup_middleware - A (4)
    F 93:0 _get_cors_origins - A (4)
    F 159:0 _log_middleware_summary - A (4)
    F 148:0 _get_trusted_hosts - A (2)
src/infrastructure/middleware/security/headers.py
    M 259:4 SecurityHeadersMiddleware._is_child_request - C (11)
    M 144:4 SecurityHeadersMiddleware._apply_all_security_headers - A (4)
    C 82:0 SecurityHeadersMiddleware - A (3)
    M 85:4 SecurityHeadersMiddleware.__init__ - A (3)
    M 165:4 SecurityHeadersMiddleware._apply_core_security_headers - A (3)
    M 354:4 SecurityHeadersMiddleware._build_hsts - A (3)
    M 363:4 SecurityHeadersMiddleware._build_permissions_policy - A (3)
    F 410:0 create_security_headers_middleware - A (2)
    F 429:0 init_security_headers - A (2)
    M 108:4 SecurityHeadersMiddleware.dispatch - A (2)
    M 184:4 SecurityHeadersMiddleware._apply_basic_security_headers - A (2)
    M 218:4 SecurityHeadersMiddleware._apply_enhanced_child_protection - A (2)
    M 252:4 SecurityHeadersMiddleware._add_environment_headers - A (2)
    M 305:4 SecurityHeadersMiddleware._track_performance - A (2)
    M 338:4 SecurityHeadersMiddleware._build_csp - A (2)
    M 371:4 SecurityHeadersMiddleware.get_stats - A (2)
    F 422:0 get_security_headers_config - A (1)
    F 440:0 create_security_middleware - A (1)
    F 446:0 create_teddy_bear_security_middleware - A (1)
    C 23:0 SecurityHeadersConfig - A (1)
    M 238:4 SecurityHeadersMiddleware._add_request_tracking_headers - A (1)
    M 320:4 SecurityHeadersMiddleware._create_safe_error_response - A (1)
    M 388:4 SecurityHeadersMiddleware.reset_stats - A (1)
    M 394:4 SecurityHeadersMiddleware.get_child_safety_info - A (1)
src/infrastructure/monitoring/comprehensive_monitoring_refactored.py
    M 30:4 ComprehensiveMonitoring.update_metric - A (4)
    C 9:0 ComprehensiveMonitoring - A (2)
    M 25:4 ComprehensiveMonitoring.log_event - A (2)
    M 12:4 ComprehensiveMonitoring.__init__ - A (1)
    M 41:4 ComprehensiveMonitoring.get_metrics - A (1)
    M 45:4 ComprehensiveMonitoring.monitor_function - A (1)
    M 62:4 ComprehensiveMonitoring.monitor_coroutine - A (1)
src/infrastructure/monitoring/performance_monitor.py
    F 17:0 monitor_performance - A (1)
src/infrastructure/monitoring/components/child_safety_monitor.py
    M 77:4 ChildSafetyMonitor._check_safety_patterns - B (7)
    M 129:4 ChildSafetyMonitor.get_child_safety_status - B (7)
    M 159:4 ChildSafetyMonitor._calculate_safety_score - B (7)
    C 13:0 ChildSafetyMonitor - A (5)
    M 27:4 ChildSafetyMonitor.record_safety_event - A (3)
    M 16:4 ChildSafetyMonitor.__init__ - A (1)
    M 55:4 ChildSafetyMonitor._trigger_emergency_alert - A (1)
    M 110:4 ChildSafetyMonitor._create_pattern_alert - A (1)
src/infrastructure/monitoring/components/monitoring_service.py
    M 205:4 ComprehensiveMonitoringService._check_alert_rules - B (10)
    M 272:4 ComprehensiveMonitoringService._perform_health_checks - B (7)
    M 295:4 ComprehensiveMonitoringService._cleanup_old_data - A (5)
    C 15:0 ComprehensiveMonitoringService - A (4)
    M 325:4 ComprehensiveMonitoringService._calculate_error_rate - A (4)
    M 109:4 ComprehensiveMonitoringService.record_security_event - A (3)
    M 261:4 ComprehensiveMonitoringService._monitoring_loop - A (3)
    M 311:4 ComprehensiveMonitoringService.get_metrics_summary - A (3)
    M 335:4 ComprehensiveMonitoringService._calculate_avg_response_time - A (3)
    M 58:4 ComprehensiveMonitoringService.record_metric - A (2)
    M 84:4 ComprehensiveMonitoringService.record_request_time - A (2)
    M 343:4 ComprehensiveMonitoringService.shutdown - A (2)
    M 26:4 ComprehensiveMonitoringService.__init__ - A (1)
    M 141:4 ComprehensiveMonitoringService.record_child_safety_event - A (1)
    M 165:4 ComprehensiveMonitoringService._setup_default_alerts - A (1)
    M 234:4 ComprehensiveMonitoringService._create_alert - A (1)
src/infrastructure/monitoring/components/types.py
    C 37:0 MetricValue - A (3)
    C 54:0 Alert - A (3)
    M 47:4 MetricValue.__post_init__ - A (2)
    M 72:4 Alert.__post_init__ - A (2)
    C 8:0 AlertSeverity - A (1)
    C 18:0 MetricType - A (1)
    C 27:0 AlertStatus - A (1)
src/infrastructure/pagination/pagination_service.py
    C 17:0 PaginationService - A (3)
    M 19:4 PaginationService.paginate - A (2)
    C 8:0 PaginatedResponse - A (1)
src/infrastructure/performance/batch_loader.py
    C 11:0 BatchLoader - A (3)
    F 36:0 get_child_batch_loader - A (2)
    M 16:4 BatchLoader.load - A (2)
    M 25:4 BatchLoader.load_many - A (2)
    M 12:4 BatchLoader.__init__ - A (1)
src/infrastructure/performance/caching_decorators.py
    F 11:0 cached - A (1)
src/infrastructure/performance/memoization.py
    F 5:0 memoize - A (1)
src/infrastructure/persistence/child_repository.py
    C 6:0 ChildRepository - A (2)
    M 8:4 ChildRepository.add - A (1)
    M 12:4 ChildRepository.get_by_id - A (1)
    M 16:4 ChildRepository.get_all - A (1)
    M 20:4 ChildRepository.update - A (1)
    M 24:4 ChildRepository.delete - A (1)
src/infrastructure/persistence/conversation_repository.py
    M 90:4 AsyncSQLAlchemyConversationRepo.update - B (6)
    C 24:0 AsyncSQLAlchemyConversationRepo - A (3)
    M 35:4 AsyncSQLAlchemyConversationRepo.get_by_id - A (3)
    M 56:4 AsyncSQLAlchemyConversationRepo.get_all - A (3)
    M 148:4 AsyncSQLAlchemyConversationRepo.get_by_child_id - A (3)
    M 70:4 AsyncSQLAlchemyConversationRepo.create - A (2)
    M 124:4 AsyncSQLAlchemyConversationRepo.delete - A (2)
    C 14:0 ConversationRepository - A (1)
    M 27:4 AsyncSQLAlchemyConversationRepo.__init__ - A (1)
    M 140:4 AsyncSQLAlchemyConversationRepo.add - A (1)
src/infrastructure/persistence/conversation_sqlite_repository.py
    M 101:4 ConversationSQLiteRepository.save_conversation - B (10)
    M 178:4 ConversationSQLiteRepository.get_conversations - B (7)
    M 254:4 ConversationSQLiteRepository._validate_conversation_safety - B (6)
    M 36:4 ConversationSQLiteRepository._get_or_create_encryption_key - A (5)
    C 23:0 ConversationSQLiteRepository - A (4)
    M 228:4 ConversationSQLiteRepository.delete_child_conversations - A (3)
    M 59:4 ConversationSQLiteRepository._init_database - A (2)
    M 28:4 ConversationSQLiteRepository.__init__ - A (1)
    M 281:4 ConversationSQLiteRepository._generate_conversation_hash - A (1)
    M 286:4 ConversationSQLiteRepository._get_conversation_count - A (1)
    M 300:4 ConversationSQLiteRepository._cleanup_old_conversations - A (1)
src/infrastructure/persistence/database_health_check.py
    F 10:0 check_database_connection - A (5)
src/infrastructure/persistence/database_manager.py
    M 22:4 Database.__init__ - B (9)
    M 83:4 Database._get_safe_url_for_logging - B (8)
    C 19:0 Database - B (6)
    M 107:4 Database.init_db - B (6)
    M 137:4 Database._apply_production_optimizations - B (6)
    M 169:4 Database.get_session - A (4)
    M 197:4 Database.close - A (1)
src/infrastructure/persistence/database_service_orchestrator.py
    ERROR: invalid syntax (<unknown>, line 13)
src/infrastructure/persistence/kafka_event_store.py
    M 195:4 KafkaEventStore.load_events_from_offset - B (9)
    M 142:4 KafkaEventStore.load_events - B (8)
    M 80:4 KafkaEventStore.save_events - B (7)
    M 262:4 KafkaEventStore._serialize_event - B (7)
    C 18:0 KafkaEventStore - B (6)
    M 34:4 KafkaEventStore.initialize - A (5)
    M 285:4 KafkaEventStore._deserialize_event - A (4)
    M 72:4 KafkaEventStore.close - A (3)
    M 21:4 KafkaEventStore.__init__ - A (1)
    M 248:4 KafkaEventStore._get_topic_name - A (1)
src/infrastructure/persistence/model_registry.py
    C 13:0 ModelRegistry - A (3)
    F 50:0 get_model_registry - A (2)
    M 20:4 ModelRegistry.register_model - A (2)
    M 26:4 ModelRegistry.get_all_models - A (2)
    M 32:4 ModelRegistry._discover_models - A (2)
    F 58:0 register_model - A (1)
    M 16:4 ModelRegistry.__init__ - A (1)
src/infrastructure/persistence/postgres_event_store.py
    C 52:0 PostgresEventStore - A (3)
    M 58:4 PostgresEventStore.append_events - A (3)
    M 89:4 PostgresEventStore.get_events - A (3)
    C 20:0 EventModel - A (1)
    M 55:4 PostgresEventStore.__init__ - A (1)
src/infrastructure/persistence/real_database_service.py
    F 22:0 get_sql_injection_prevention - A (1)
src/infrastructure/persistence/redis_accessibility_profile_repository.py
    M 29:4 RedisAccessibilityProfileRepository.get_profile_by_child_id - A (4)
    C 18:0 RedisAccessibilityProfileRepository - A (3)
    M 76:4 RedisAccessibilityProfileRepository.save_profile - A (3)
    M 100:4 RedisAccessibilityProfileRepository.delete_profile - A (3)
    M 25:4 RedisAccessibilityProfileRepository.__init__ - A (1)
    M 120:4 RedisAccessibilityProfileRepository.get_all_profiles - A (1)
src/infrastructure/persistence/redis_notification_repository.py
    M 119:4 RedisNotificationRepository.get_notifications_for_recipient - A (5)
    C 19:0 RedisNotificationRepository - A (4)
    M 74:4 RedisNotificationRepository.get_notification_by_id - A (4)
    M 31:4 RedisNotificationRepository.save_notification - A (3)
    M 143:4 RedisNotificationRepository.delete_notification - A (3)
    M 27:4 RedisNotificationRepository.__init__ - A (1)
src/infrastructure/persistence/redis_personality_profile_repository.py
    C 19:0 RedisPersonalityProfileRepository - A (3)
    M 30:4 RedisPersonalityProfileRepository.get_profile_by_child_id - A (3)
    M 92:4 RedisPersonalityProfileRepository.delete_profile - A (3)
    M 67:4 RedisPersonalityProfileRepository.save_profile - A (2)
    M 26:4 RedisPersonalityProfileRepository.__init__ - A (1)
    M 112:4 RedisPersonalityProfileRepository.get_all_profiles - A (1)
src/infrastructure/persistence/redis_session_repository.py
    C 14:0 RedisSessionRepository - A (3)
    M 26:4 RedisSessionRepository.get - A (3)
    M 79:4 RedisSessionRepository.delete - A (3)
    M 52:4 RedisSessionRepository.save - A (2)
    M 21:4 RedisSessionRepository.__init__ - A (1)
    M 95:4 RedisSessionRepository.delete_expired - A (1)
src/infrastructure/persistence/repositories.py
    M 28:4 DataRepository.get_data - C (13)
    C 14:0 DataRepository - A (3)
    M 98:4 DataRepository._get_child_profile - A (2)
    M 104:4 DataRepository._get_conversation_history - A (2)
    M 17:4 DataRepository.__init__ - A (1)
    M 77:4 DataRepository._log_data_access - A (1)
    M 94:4 DataRepository._is_valid_child_id - A (1)
    M 110:4 DataRepository._get_safety_report - A (1)
    M 120:4 DataRepository._get_system_health - A (1)
    M 129:4 DataRepository.clean_expired_data - A (1)
src/infrastructure/persistence/database/config.py
    M 198:4 DatabaseConfig.validate_production_requirements - C (11)
    M 36:4 DatabaseConfig.from_environment - B (6)
    M 148:4 DatabaseConfig.get_engine_kwargs - B (6)
    C 12:0 DatabaseConfig - A (5)
    M 62:4 DatabaseConfig._create_for_environment - A (3)
    M 76:4 DatabaseConfig._production_config - A (2)
    M 105:4 DatabaseConfig._development_config - A (1)
    M 129:4 DatabaseConfig._testing_config - A (1)
src/infrastructure/persistence/database/initializer.py
    F 25:0 initialize_production_database - B (8)
    F 58:0 validate_database_environment - A (5)
    F 16:0 get_database_config - A (2)
src/infrastructure/persistence/database/migrations.py
    M 82:4 DatabaseMigrationManager.setup_child_data_security - B (9)
    C 15:0 DatabaseMigrationManager - B (6)
    M 21:4 DatabaseMigrationManager.create_production_schema - A (5)
    M 18:4 DatabaseMigrationManager.__init__ - A (1)
src/infrastructure/persistence/database/validators.py
    M 49:4 DatabaseConnectionValidator.validate_schema_compatibility - B (8)
    C 15:0 DatabaseConnectionValidator - B (6)
    M 21:4 DatabaseConnectionValidator.validate_connection - A (5)
    M 18:4 DatabaseConnectionValidator.__init__ - A (1)
src/infrastructure/persistence/models/base.py
    C 4:0 Base - A (1)
src/infrastructure/persistence/models/child_models.py
    C 27:0 ChildModel - A (2)
    M 119:4 ChildModel.child_age - A (1)
    M 124:4 ChildModel.child_age - A (1)
    M 131:4 ChildModel.age_category_enum - A (1)
    M 136:4 ChildModel.age_category_enum - A (1)
    M 141:4 ChildModel.safety_level_enum - A (1)
    M 146:4 ChildModel.safety_level_enum - A (1)
    M 151:4 ChildModel.get_interaction_guidelines - A (1)
    M 155:4 ChildModel.get_recommended_topics - A (1)
    M 159:4 ChildModel.get_safety_restrictions - A (1)
    M 163:4 ChildModel.is_appropriate_for_content - A (1)
    M 167:4 ChildModel.__repr__ - A (1)
src/infrastructure/persistence/models/consent_models.py
    C 28:0 ConsentModel - A (2)
    C 77:0 SafetyEventModel - A (2)
    C 19:0 SafetyEventType - A (1)
    M 70:4 ConsentModel.__repr__ - A (1)
    M 122:4 SafetyEventModel.__repr__ - A (1)
src/infrastructure/persistence/models/conversation_models.py
    C 24:0 ConversationModel - A (2)
    C 87:0 MessageModel - A (2)
    M 83:4 ConversationModel.__repr__ - A (1)
    M 134:4 MessageModel.__repr__ - A (1)
src/infrastructure/persistence/models/parent_models.py
    C 16:0 ParentModel - A (2)
    M 92:4 ParentModel.__repr__ - A (1)
src/infrastructure/persistence/models/user_model.py
    C 15:0 UserModel - A (2)
    M 55:4 UserModel.__repr__ - A (1)
src/infrastructure/persistence/repositories/safety_repository.py
    M 35:4 SafetyRepository.record_safety_event - A (3)
    C 21:0 SafetyRepository - A (2)
    M 24:4 SafetyRepository.__init__ - A (1)
    M 82:4 SafetyRepository.get_safety_alerts - A (1)
    M 105:4 SafetyRepository.get_child_safety_score - A (1)
src/infrastructure/persistence/repositories/usage_repository.py
    M 35:4 UsageRepository.record_usage - B (6)
    C 21:0 UsageRepository - A (4)
    M 24:4 UsageRepository.__init__ - A (1)
    M 84:4 UsageRepository.get_usage_summary - A (1)
src/infrastructure/persistence/repositories/user_repository.py
    M 41:4 UserRepository.create_user - A (5)
    C 27:0 UserRepository - A (4)
    M 106:4 UserRepository.get_user_by_email - A (3)
    M 135:4 UserRepository.update_user_role - A (3)
    M 30:4 UserRepository.__init__ - A (1)
src/infrastructure/persistence/repositories/__init__.py
    ERROR: invalid syntax (<unknown>, line 9)
src/infrastructure/read_models/child_profile_read_model.py
    C 14:0 ChildProfileReadModelStore - A (2)
    M 24:4 ChildProfileReadModelStore.delete - A (2)
    C 7:0 ChildProfileReadModel - A (1)
    M 15:4 ChildProfileReadModelStore.__init__ - A (1)
    M 18:4 ChildProfileReadModelStore.get_by_id - A (1)
    M 21:4 ChildProfileReadModelStore.save - A (1)
    M 28:4 ChildProfileReadModelStore.get_all - A (1)
src/infrastructure/repositories/event_sourced_child_repository.py
    M 31:4 EventSourcedChildRepository.get_all - B (6)
    C 8:0 EventSourcedChildRepository - A (4)
    M 21:4 EventSourcedChildRepository.get_by_id - A (3)
    M 11:4 EventSourcedChildRepository.__init__ - A (1)
    M 15:4 EventSourcedChildRepository.save - A (1)
src/infrastructure/resilience/circuit_breaker.py
    M 82:4 CircuitBreaker.call - A (4)
    M 114:4 CircuitBreaker.call_async - A (4)
    C 23:0 CircuitBreaker - A (3)
    F 205:0 get_circuit_breaker - A (2)
    F 232:0 get_all_circuit_breaker_status - A (2)
    M 55:4 CircuitBreaker._can_attempt_reset - A (2)
    M 67:4 CircuitBreaker._record_failure - A (2)
    M 146:4 CircuitBreaker.get_status - A (2)
    F 166:0 circuit_breaker - A (1)
    C 15:0 CircuitBreakerState - A (1)
    M 31:4 CircuitBreaker.__init__ - A (1)
    M 61:4 CircuitBreaker._record_success - A (1)
    C 162:0 CircuitBreakerOpenError - A (1)
src/infrastructure/resilience/retry_decorator.py
    F 121:0 retry_external_api - A (2)
    F 28:0 retry_with_backoff - A (1)
    C 17:0 RetryConfig - A (1)
src/infrastructure/security/access_control_service.py
    M 132:4 AccessControlService.verify_access - B (8)
    M 285:4 AccessControlService.validate_access_token - B (8)
    M 387:4 AccessControlService.get_parent_children - B (6)
    C 37:0 AccessControlService - A (5)
    M 243:4 AccessControlService._find_relationship - A (5)
    M 346:4 AccessControlService._log_failed_access - A (5)
    M 83:4 AccessControlService.register_parent_child_relationship - A (4)
    M 322:4 AccessControlService._log_audit_event - A (2)
    C 12:0 AccessLevel - A (1)
    C 22:0 AccessAction - A (1)
    M 40:4 AccessControlService.__init__ - A (1)
    M 261:4 AccessControlService._generate_access_token - A (1)
src/infrastructure/security/api_security_manager.py
    M 141:4 APISecurityManager.validate_child_input - C (11)
    M 77:4 APISecurityManager.sanitize_input - B (9)
    M 21:4 APISecurityManager.check_rate_limit - B (7)
    C 11:0 APISecurityManager - B (6)
    M 14:4 APISecurityManager.__init__ - A (1)
    M 67:4 APISecurityManager.block_ip - A (1)
    M 72:4 APISecurityManager.unblock_ip - A (1)
src/infrastructure/security/audit_decorators.py
    F 20:0 audit_authentication - A (1)
    F 157:0 audit_data_access - A (1)
    F 316:0 audit_security_event - A (1)
    F 459:0 audit_login - A (1)
    F 467:0 audit_logout - A (1)
    F 475:0 audit_child_create - A (1)
    F 488:0 audit_child_update - A (1)
    F 501:0 audit_child_delete - A (1)
src/infrastructure/security/audit_logger.py
    M 453:4 AuditLogger._rotate_old_logs - B (7)
    M 220:4 AuditLogger.log_child_interaction - B (6)
    C 137:0 AuditLogger - A (4)
    M 164:4 AuditLogger.log_event - A (4)
    M 420:4 AuditLogger._flush_audit_buffer - A (4)
    M 435:4 AuditLogger._write_events_to_file - A (4)
    C 107:0 AuditEvent - A (3)
    M 313:4 AuditLogger.log_data_access - A (3)
    M 395:4 AuditLogger._handle_critical_event - A (3)
    F 480:0 get_audit_logger - A (2)
    M 120:4 AuditEvent.to_dict - A (2)
    M 278:4 AuditLogger.log_safety_incident - A (2)
    F 499:0 log_audit_event - A (1)
    F 517:0 log_child_safety_incident - A (1)
    C 18:0 AuditCategory - A (1)
    C 33:0 AuditEventType - A (1)
    C 76:0 AuditSeverity - A (1)
    C 87:0 AuditConfig - A (1)
    C 99:0 AuditContext - A (1)
    M 131:4 AuditEvent.calculate_checksum - A (1)
    M 148:4 AuditLogger.__init__ - A (1)
    M 155:4 AuditLogger._ensure_log_directory - A (1)
    M 159:4 AuditLogger._start_background_tasks - A (1)
    M 364:4 AuditLogger.log_coppa_event - A (1)
    M 407:4 AuditLogger._send_security_alert - A (1)
src/infrastructure/security/child_data_security_manager.py
    M 65:4 ChildDataSecurityManager.get_child_data_for_interaction - A (4)
    C 19:0 ChildDataSecurityManager - A (3)
    M 26:4 ChildDataSecurityManager.secure_child_profile - A (3)
    M 88:4 ChildDataSecurityManager.schedule_data_cleanup - A (2)
    M 22:4 ChildDataSecurityManager.__init__ - A (1)
src/infrastructure/security/comprehensive_audit_integration.py
    M 125:4 ComprehensiveAuditIntegration.log_child_data_operation - C (11)
    M 42:4 ComprehensiveAuditIntegration.log_authentication_event - B (6)
    C 29:0 ComprehensiveAuditIntegration - A (5)
    M 88:4 ComprehensiveAuditIntegration.log_authorization_event - A (5)
    M 185:4 ComprehensiveAuditIntegration.log_coppa_compliance_event - A (3)
    M 298:4 ComprehensiveAuditIntegration._sanitize_email - A (3)
    M 307:4 ComprehensiveAuditIntegration._sanitize_child_id - A (3)
    F 320:0 get_audit_integration - A (2)
    M 231:4 ComprehensiveAuditIntegration.log_security_event - A (2)
    M 268:4 ComprehensiveAuditIntegration.log_system_event - A (2)
    F 327:0 audit_authentication - A (1)
    F 336:0 audit_authorization - A (1)
    F 345:0 audit_child_data_operation - A (1)
    F 354:0 audit_coppa_event - A (1)
    F 367:0 audit_security_event - A (1)
    C 18:0 AuditableOperation - A (1)
    M 39:4 ComprehensiveAuditIntegration.__init__ - A (1)
src/infrastructure/security/coppa_validator.py
    M 57:4 COPPAValidator.validate_age_compliance - B (10)
    M 230:4 COPPAValidator.validate_age_range - B (7)
    C 39:0 COPPAValidator - A (5)
    M 210:4 COPPAValidator.get_content_filtering_level - A (4)
    F 268:0 is_coppa_subject - A (2)
    F 278:0 requires_parental_consent - A (2)
    M 161:4 COPPAValidator.is_coppa_subject - A (2)
    M 180:4 COPPAValidator.get_data_retention_period - A (2)
    F 288:0 get_data_retention_days - A (1)
    F 295:0 validate_child_age - A (1)
    C 19:0 COPPAValidatorLevel - A (1)
    C 28:0 COPPAValidationResult - A (1)
    M 54:4 COPPAValidator.__init__ - A (1)
    M 199:4 COPPAValidator.requires_parental_consent - A (1)
src/infrastructure/security/cors_service.py
    M 302:4 CORSSecurityService._validate_origin_security - B (9)
    M 210:4 CORSSecurityService.handle_preflight_request - B (8)
    M 141:4 CORSSecurityService.validate_origin - B (7)
    M 341:4 CORSSecurityService._is_origin_allowed - B (6)
    M 469:4 CORSSecurityService.add_allowed_origin - B (6)
    M 501:4 CORSSecurityService.remove_allowed_origin - A (5)
    C 20:0 CORSConfiguration - A (4)
    C 37:0 CORSSecurityService - A (4)
    M 31:4 CORSConfiguration.__post_init__ - A (3)
    M 271:4 CORSSecurityService.get_security_headers - A (3)
    M 361:4 CORSSecurityService._generate_cors_headers - A (3)
    M 407:4 CORSSecurityService._get_csp_header - A (3)
    M 447:4 CORSSecurityService._update_origin_cache - A (3)
    M 435:4 CORSSecurityService._log_cors_violation - A (2)
    C 11:0 CORSPolicy - A (1)
    M 47:4 CORSSecurityService.__init__ - A (1)
    M 59:4 CORSSecurityService._initialize_cors_configurations - A (1)
    M 382:4 CORSSecurityService._generate_preflight_headers - A (1)
    M 398:4 CORSSecurityService._get_cors_headers_for_error - A (1)
    M 457:4 CORSSecurityService.get_cors_statistics - A (1)
src/infrastructure/security/database_input_validator.py
    M 34:4 DatabaseInputValidator.validate_input_data - C (11)
    M 176:4 DatabaseInputValidator._validate_json_input - B (9)
    C 20:0 DatabaseInputValidator - B (6)
    M 147:4 DatabaseInputValidator._validate_numeric_input - B (6)
    M 347:4 SafeDatabaseSession.safe_execute - A (5)
    F 295:0 validate_database_operation - A (4)
    M 208:4 DatabaseInputValidator.validate_query_execution - A (3)
    C 339:0 SafeDatabaseSession - A (3)
    M 407:4 SafeDatabaseSession.safe_select - A (2)
    F 251:0 database_input_validation - A (1)
    F 435:0 create_safe_database_session - A (1)
    M 29:4 DatabaseInputValidator.__init__ - A (1)
    M 112:4 DatabaseInputValidator._determine_input_type - A (1)
    C 247:0 DatabaseSecurityError - A (1)
    M 342:4 SafeDatabaseSession.__init__ - A (1)
    M 379:4 SafeDatabaseSession.safe_insert - A (1)
    M 388:4 SafeDatabaseSession.safe_update - A (1)
    M 430:4 SafeDatabaseSession.get_security_log - A (1)
src/infrastructure/security/email_validator.py
    F 6:0 validate_email_address - A (5)
src/infrastructure/security/environment_validator.py
    M 70:4 EnvironmentSecurityValidator.validate_all - C (20)
    M 194:4 EnvironmentSecurityValidator.get_secure_config - B (9)
    C 13:0 EnvironmentSecurityValidator - B (8)
    M 147:4 EnvironmentSecurityValidator._calculate_entropy - A (5)
    M 173:4 EnvironmentSecurityValidator.validate_and_exit_on_error - A (3)
    M 168:4 EnvironmentSecurityValidator.generate_secure_secret - A (1)
src/infrastructure/security/fallback_rate_limiter.py
    M 152:4 SlidingWindowRateLimiter._cleanup_old_entries - B (9)
    M 187:4 SlidingWindowRateLimiter.get_statistics - B (9)
    M 34:4 SlidingWindowRateLimiter.is_allowed - B (7)
    M 264:4 FallbackRateLimitService.check_redis_availability - B (6)
    C 11:0 SlidingWindowRateLimiter - A (5)
    M 356:4 FallbackRateLimitService.reset_user_limits - A (5)
    M 136:4 SlidingWindowRateLimiter._get_rate_limit_config - A (4)
    M 111:4 SlidingWindowRateLimiter.set_custom_limit - A (3)
    M 235:4 SlidingWindowRateLimiter.reset_user_limits - A (3)
    C 249:0 FallbackRateLimitService - A (3)
    M 292:4 FallbackRateLimitService.is_allowed - A (3)
    M 127:4 SlidingWindowRateLimiter.remove_custom_limit - A (2)
    M 332:4 FallbackRateLimitService.get_statistics - A (2)
    M 13:4 SlidingWindowRateLimiter.__init__ - A (1)
    M 254:4 FallbackRateLimitService.__init__ - A (1)
    M 317:4 FallbackRateLimitService._redis_rate_limit - A (1)
    M 346:4 FallbackRateLimitService.set_custom_limit - A (1)
src/infrastructure/security/file_security_manager.py
    M 113:4 AudioFileSecurityManager._validate_audio_magic_numbers - C (17)
    M 29:4 AudioFileSecurityManager.validate_audio_file - B (10)
    C 12:0 AudioFileSecurityManager - B (8)
    M 186:4 AudioFileSecurityManager.sanitize_filename - B (8)
    M 172:4 AudioFileSecurityManager._is_executable_file - A (2)
    M 15:4 AudioFileSecurityManager.__init__ - A (1)
src/infrastructure/security/jwt_auth.py
    F 96:0 get_jwt_strategy - B (10)
    F 86:0 get_user_db - A (2)
    F 153:0 create_auth_components - A (2)
    F 47:4 get_settings - A (1)
    F 70:4 get_vault_client - A (1)
    C 24:4 SQLAlchemyBaseUserTableUUID - A (1)
    C 27:4 SQLAlchemyUserDatabase - A (1)
    C 30:4 JWTStrategy - A (1)
    C 33:4 BearerTransport - A (1)
    C 36:4 AuthenticationBackend - A (1)
    C 39:4 FastAPIUsers - A (1)
    C 75:0 User - A (1)
src/infrastructure/security/key_rotation_service.py
    C 43:0 KeyMetadata - B (6)
    M 57:4 KeyMetadata.to_dict - A (5)
    C 83:0 KeyStorage - A (2)
    C 100:0 KeyRotationService - A (2)
    M 140:4 KeyRotationService.get_active_key - A (2)
    C 21:0 KeyType - A (1)
    C 32:0 RotationTrigger - A (1)
    C 75:0 KeyRotationPolicy - A (1)
    M 86:4 KeyStorage.store_key - A (1)
    M 93:4 KeyStorage.retrieve_key - A (1)
    M 95:4 KeyStorage.get_active_key_id - A (1)
    M 97:4 KeyStorage.set_active_key_id - A (1)
    M 103:4 KeyRotationService.__init__ - A (1)
    M 108:4 KeyRotationService.generate_key - A (1)
    M 114:4 KeyRotationService.rotate_key - A (1)
src/infrastructure/security/logging_security_monitor.py
    M 55:4 LoggingSecurityMonitor._scan_file_for_violations - B (8)
    C 15:0 LoggingSecurityMonitor - A (5)
    M 37:4 LoggingSecurityMonitor.scan_codebase_for_violations - A (2)
    M 20:4 LoggingSecurityMonitor.__init__ - A (1)
src/infrastructure/security/log_sanitization_config.py
    F 18:0 get_default_log_sanitization_config - A (1)
    F 58:0 create_child_safe_log_sanitization_config - A (1)
    C 5:0 LogSanitizationConfig - A (1)
src/infrastructure/security/log_sanitizer.py
    M 95:4 LogSanitizer.sanitize - A (4)
    M 114:4 LogSanitizer.sanitize_dict - A (4)
    C 42:0 LogSanitizer - A (3)
    M 87:4 LogSanitizer._hash_id - A (2)
    C 18:0 SensitiveDataType - A (1)
    C 33:0 SanitizationRule - A (1)
    M 48:4 LogSanitizer.__init__ - A (1)
    M 53:4 LogSanitizer._create_default_rules - A (1)
src/infrastructure/security/main_security_service.py
    M 78:4 MainSecurityService.validate_input - B (7)
    M 119:4 MainSecurityService.validate_production_environment_security - B (6)
    C 18:0 MainSecurityService - A (3)
    M 21:4 MainSecurityService.__init__ - A (2)
    M 63:4 MainSecurityService.generate_secure_password - A (2)
    M 103:4 MainSecurityService.check_rate_limit - A (2)
    F 159:0 get_security_service - A (1)
    M 36:4 MainSecurityService.authenticate_user - A (1)
    M 45:4 MainSecurityService.create_token - A (1)
    M 49:4 MainSecurityService.verify_token - A (1)
    M 54:4 MainSecurityService.encrypt_child_data - A (1)
    M 58:4 MainSecurityService.decrypt_child_data - A (1)
    M 70:4 MainSecurityService.hash_password - A (1)
    M 74:4 MainSecurityService.verify_password - A (1)
    M 111:4 MainSecurityService.generate_session_id - A (1)
    M 115:4 MainSecurityService.generate_csrf_token - A (1)
src/infrastructure/security/models.py
    C 7:0 EncryptionMetadata - A (1)
    C 18:0 COPPAValidatorRecord - A (1)
src/infrastructure/security/password_hasher.py
    C 9:0 PasswordHasher - A (4)
    M 23:4 PasswordHasher.hash_password - A (4)
    M 44:4 PasswordHasher.verify_password - A (4)
    M 14:4 PasswordHasher.__init__ - A (2)
src/infrastructure/security/password_validator.py
    F 9:0 validate_password_strength - D (29)
src/infrastructure/security/path_validator.py
    M 58:4 PathValidator.validate_path - C (13)
    C 27:0 PathValidator - B (7)
    M 141:4 PathValidator.get_safe_path - B (7)
    M 183:4 PathValidator._is_within_allowed_dirs - B (6)
    M 112:4 PathValidator.sanitize_path - A (5)
    M 210:4 SecureFileOperations.safe_open - A (5)
    C 202:0 SecureFileOperations - A (4)
    M 242:4 SecureFileOperations.safe_remove - A (4)
    M 256:4 SecureFileOperations.safe_listdir - A (4)
    M 46:4 PathValidator.__init__ - A (3)
    M 176:4 PathValidator._contains_traversal_patterns - A (3)
    M 233:4 SecureFileOperations.safe_exists - A (3)
    F 322:0 get_path_validator - A (2)
    F 330:0 get_secure_file_operations - A (2)
    F 274:0 create_child_safe_validator - A (1)
    F 308:0 create_secure_file_operations - A (1)
    F 338:0 validate_path - A (1)
    F 343:0 safe_open - A (1)
    C 17:0 PathPolicy - A (1)
    M 207:4 SecureFileOperations.__init__ - A (1)
    C 270:0 PathSecurityError - A (1)
src/infrastructure/security/plugin_architecture.py
    C 98:0 PluginValidator - B (7)
    M 184:4 PluginManager.load_plugin - B (7)
    M 153:4 PluginValidator._contains_forbidden_content - B (6)
    M 127:4 PluginValidator.validate_plugin - A (5)
    M 232:4 PluginManager.activate_plugin - A (5)
    M 327:4 PluginManager._find_plugin_class - A (5)
    C 173:0 PluginManager - A (4)
    M 292:4 PluginManager.get_plugins_by_type - A (4)
    C 36:0 PluginManifest - A (3)
    M 253:4 PluginManager.deactivate_plugin - A (3)
    M 270:4 PluginManager.execute_plugin - A (3)
    M 281:4 PluginManager.list_plugins - A (3)
    M 300:4 PluginManager._load_manifest - A (3)
    M 50:4 PluginManifest.__post_init__ - A (2)
    C 55:0 PluginInterface - A (2)
    F 339:0 create_plugin_manager - A (1)
    F 344:0 create_plugin_manifest - A (1)
    C 16:0 PluginType - A (1)
    C 26:0 PluginStatus - A (1)
    M 59:4 PluginInterface.initialize - A (1)
    M 64:4 PluginInterface.execute - A (1)
    M 69:4 PluginInterface.cleanup - A (1)
    M 75:4 PluginInterface.name - A (1)
    M 81:4 PluginInterface.version - A (1)
    C 86:0 PluginValidationError - A (1)
    C 92:0 PluginSecurityError - A (1)
    M 176:4 PluginManager.__init__ - A (1)
src/infrastructure/security/rate_limiter.py
    M 124:4 ChildSafetyRateLimiter.check_child_interaction - A (4)
    M 148:4 ChildSafetyRateLimiter.is_child_locked_out - A (4)
    F 226:0 get_child_safety_rate_limiter - A (3)
    C 83:0 ChildSafetyRateLimiter - A (3)
    M 88:4 ChildSafetyRateLimiter.__init__ - A (3)
    M 162:4 ChildSafetyRateLimiter.get_child_interaction_count - A (3)
    F 238:0 create_rate_limiter_dependency - A (2)
    C 28:4 Limiter - A (2)
    C 54:4 Depends - A (2)
    C 58:4 Request - A (2)
    C 62:4 HTTPException - A (2)
    C 70:4 JSONResponse - A (2)
    C 75:4 FastAPI - A (2)
    M 172:4 ChildSafetyRateLimiter.reset_child_interactions - A (2)
    M 178:4 ChildSafetyRateLimiter.register_rate_limit_handler - A (2)
    M 201:4 ChildSafetyRateLimiter.get_rate_limit_status - A (2)
    F 38:4 get_remote_address - A (1)
    F 246:0 check_child_rate_limit - A (1)
    F 252:0 get_rate_limit_status - A (1)
    M 29:8 Limiter.__init__ - A (1)
    M 32:8 Limiter.limit - A (1)
    C 41:4 RateLimitExceeded - A (1)
    M 55:8 Depends.__init__ - A (1)
    M 59:8 Request.__init__ - A (1)
    M 63:8 HTTPException.__init__ - A (1)
    C 67:4 status - A (1)
    M 71:8 JSONResponse.__init__ - A (1)
    M 76:8 FastAPI.exception_handler - A (1)
    M 120:4 ChildSafetyRateLimiter.get_limiter - A (1)
src/infrastructure/security/rate_limiter_service.py
    M 26:4 RateLimiterService.check_rate_limit - B (6)
    C 13:0 RateLimiterService - A (4)
    M 80:4 RateLimiterService.reset_login_attempts - A (3)
    M 16:4 RateLimiterService.__init__ - A (1)
    M 73:4 RateLimiterService.record_failed_login - A (1)
src/infrastructure/security/real_auth_service.py
    F 69:0 get_current_user - A (3)
    F 94:0 get_current_parent - A (2)
    F 104:0 get_current_child - A (2)
    F 114:0 get_current_admin - A (2)
    C 39:0 ProductionAuthService - A (2)
    M 54:4 ProductionAuthService.validate_token - A (2)
    F 124:0 require_auth - A (1)
    F 129:0 require_parent_auth - A (1)
    F 134:0 require_admin_auth - A (1)
    F 140:0 create_auth_service - A (1)
    C 30:0 UserInfo - A (1)
    M 42:4 ProductionAuthService.__init__ - A (1)
    M 46:4 ProductionAuthService.authenticate - A (1)
    M 58:4 ProductionAuthService.get_user_info - A (1)
src/infrastructure/security/registration_models.py
    C 5:0 RegistrationRequest - A (1)
    C 20:0 PasswordRequirements - A (1)
src/infrastructure/security/request_security_detector.py
    M 39:4 RequestSecurityDetector._detect_sql_injection_attempt - B (9)
    M 79:4 RequestSecurityDetector._detect_xss_attempt - B (9)
    C 9:0 RequestSecurityDetector - B (7)
    M 15:4 RequestSecurityDetector.detect_security_events - B (6)
    M 116:4 RequestSecurityDetector._detect_path_traversal_attempt - A (4)
    M 12:4 RequestSecurityDetector.__init__ - A (1)
src/infrastructure/security/request_signing_service.py
    C 24:0 SignatureAlgorithm - A (1)
src/infrastructure/security/robust_encryption_service.py
    M 217:4 RobustEncryptionService.encrypt - C (15)
    M 331:4 RobustEncryptionService.decrypt - C (13)
    M 538:4 RobustEncryptionService._looks_like_ciphertext - B (6)
    M 141:4 RobustEncryptionService._initialize_master_key - A (5)
    M 196:4 RobustEncryptionService._verify_encryption_capabilities - A (5)
    M 554:4 RobustEncryptionService._log_encryption_event - A (5)
    C 83:0 RobustEncryptionService - A (4)
    C 31:0 EncryptionResult - A (3)
    M 501:4 RobustEncryptionService._decrypt_fernet - A (3)
    M 518:4 RobustEncryptionService._try_fallback_decryption - A (3)
    F 606:0 get_encryption_service - A (2)
    C 23:4 MockAuditIntegration - A (2)
    M 34:4 EncryptionResult.__init__ - A (2)
    M 96:4 RobustEncryptionService.__init__ - A (2)
    M 105:4 RobustEncryptionService._initialize_encryption_system - A (2)
    M 119:4 RobustEncryptionService._import_crypto_dependencies - A (2)
    M 172:4 RobustEncryptionService._derive_default_key - A (2)
    M 454:4 RobustEncryptionService._decrypt_aes_gcm - A (2)
    M 478:4 RobustEncryptionService._decrypt_chacha20 - A (2)
    M 586:4 RobustEncryptionService.is_available - A (2)
    F 27:4 get_audit_integration - A (1)
    F 617:0 encrypt_sensitive_data - A (1)
    F 627:0 decrypt_sensitive_data - A (1)
    M 24:8 MockAuditIntegration.log_security_event - A (1)
    C 52:0 EncryptionLevel - A (1)
    C 61:0 EncryptionPolicy - A (1)
    C 70:0 EncryptionConfig - A (1)
    M 443:4 RobustEncryptionService._encrypt_aes_gcm - A (1)
    M 467:4 RobustEncryptionService._encrypt_chacha20 - A (1)
    M 491:4 RobustEncryptionService._encrypt_fernet - A (1)
    M 590:4 RobustEncryptionService.get_encryption_status - A (1)
src/infrastructure/security/safety_monitor_service.py
    M 74:4 SafetyMonitorService.check_content - B (8)
    M 196:4 SafetyMonitorService._is_valid_audio_format - B (8)
    M 138:4 SafetyMonitorService.check_audio - B (7)
    C 10:0 SafetyMonitorService - A (5)
    M 19:4 SafetyMonitorService._load_blocked_words - A (2)
    M 124:4 SafetyMonitorService._contains_personal_info - A (2)
    M 13:4 SafetyMonitorService.__init__ - A (1)
    M 58:4 SafetyMonitorService._load_safety_rules - A (1)
src/infrastructure/security/secure_logger.py
    M 98:4 SecureLogger._sanitize_value - C (14)
    M 174:4 SecureLogger._sanitize_message - C (11)
    M 210:4 SecureLogger._prepare_log_data - B (8)
    M 28:4 SecureLogger.__init__ - A (5)
    M 144:4 SecureLogger._sanitize_dict - A (5)
    M 159:4 SecureLogger._sanitize_list - A (5)
    C 25:0 SecureLogger - A (4)
    M 73:4 SecureLogger._sanitize_email - A (4)
    M 82:4 SecureLogger._sanitize_phone - A (4)
    M 136:4 SecureLogger._mask_value - A (3)
    F 336:0 get_secure_logger - A (2)
    M 55:4 SecureLogger._sanitize_child_id - A (2)
    M 64:4 SecureLogger._sanitize_parent_id - A (2)
    M 270:4 SecureLogger.log_child_activity - A (2)
    M 279:4 SecureLogger.log_parent_action - A (2)
    M 288:4 SecureLogger.log_safety_event - A (2)
    M 296:4 SecureLogger.log_coppa_event - A (2)
    F 21:4 requires_coppa_audit_logging - A (1)
    F 343:0 create_child_safe_logger - A (1)
    F 369:0 log_child_activity - A (1)
    F 375:0 log_parent_action - A (1)
    F 381:0 log_safety_event - A (1)
    F 387:0 log_coppa_event - A (1)
    F 397:0 secure_log_call - A (1)
    M 241:4 SecureLogger.debug - A (1)
    M 246:4 SecureLogger.info - A (1)
    M 251:4 SecureLogger.warning - A (1)
    M 256:4 SecureLogger.error - A (1)
    M 261:4 SecureLogger.critical - A (1)
    M 304:4 SecureLogger.log_child_interaction - A (1)
    M 320:4 SecureLogger.log_security_event - A (1)
src/infrastructure/security/secure_user_registration.py
    M 60:4 SecureUserRegistration.validate_parent_eligibility - B (9)
    M 139:4 SecureUserRegistration.register_parent_user - B (6)
    C 30:0 SecureUserRegistration - A (5)
    M 119:4 SecureUserRegistration.verify_email_token - A (4)
    M 240:4 SecureUserRegistration.resend_verification_email - A (4)
    M 40:4 SecureUserRegistration.__init__ - A (1)
    M 106:4 SecureUserRegistration.generate_verification_token - A (1)
src/infrastructure/security/security_levels.py
    C 6:0 SecurityLevel - A (1)
    C 18:0 RequestSecurityLevel - A (1)
src/infrastructure/security/security_manager.py
    C 10:0 CoreSecurityManager - A (2)
    M 14:4 CoreSecurityManager.hash_password - A (1)
    M 29:4 CoreSecurityManager.verify_password - A (1)
    M 46:4 CoreSecurityManager.generate_secure_token - A (1)
    M 59:4 CoreSecurityManager.secure_compare - A (1)
    M 73:4 CoreSecurityManager.generate_file_signature - A (1)
src/infrastructure/security/security_middleware.py
    M 217:4 SecurityMiddleware.dispatch - B (7)
    F 446:0 create_security_middleware - B (6)
    M 184:4 SecurityValidator.validate_child_data - B (6)
    M 288:4 SecurityMiddleware.scan_request_security - B (6)
    M 415:4 ChildSafetySecurityMiddleware.validate_child_content - B (6)
    C 128:0 SecurityValidator - A (5)
    C 202:0 SecurityMiddleware - A (5)
    F 509:0 get_security_status - A (4)
    M 34:8 MockRedis.zremrangebyscore - A (4)
    M 205:4 SecurityMiddleware.__init__ - A (4)
    C 370:0 ChildSafetySecurityMiddleware - A (4)
    M 156:4 SecurityValidator.scan_request - A (3)
    M 275:4 SecurityMiddleware.get_client_ip - A (3)
    M 388:4 ChildSafetySecurityMiddleware.dispatch - A (3)
    C 30:4 MockRedis - A (2)
    M 45:8 MockRedis.zadd - A (2)
    C 65:0 RateLimiter - A (2)
    M 68:4 RateLimiter.__init__ - A (2)
    M 79:4 RateLimiter.is_allowed - A (2)
    M 99:4 RateLimiter.record_suspicious_activity - A (2)
    M 151:4 SecurityValidator.__init__ - A (2)
    M 326:4 SecurityMiddleware.add_security_headers - A (2)
    M 405:4 ChildSafetySecurityMiddleware.is_child_request - A (2)
    F 472:0 setup_security_middleware - A (1)
    F 504:0 get_security_config - A (1)
    M 31:8 MockRedis.__init__ - A (1)
    M 42:8 MockRedis.zcard - A (1)
    M 50:8 MockRedis.expire - A (1)
    M 53:8 MockRedis.exists - A (1)
    M 56:8 MockRedis.delete - A (1)
    M 59:8 MockRedis.setex - A (1)
    M 116:4 RateLimiter.is_ip_blocked - A (1)
    M 121:4 RateLimiter.clear_failed_attempts - A (1)
    M 349:4 SecurityMiddleware.log_request - A (1)
    M 373:4 ChildSafetySecurityMiddleware.__init__ - A (1)
src/infrastructure/security/sql_injection_protection.py
    M 187:4 SQLInjectionProtection._assess_risk_level - B (7)
    M 282:4 SQLInjectionProtection.export_security_report - B (7)
    M 160:4 SQLInjectionProtection._log_attack_attempt - B (6)
    M 205:4 SQLInjectionProtection.validate_child_query - B (6)
    M 241:4 SQLInjectionProtection.get_protection_stats - A (5)
    C 53:0 SQLInjectionProtection - A (4)
    M 123:4 SQLInjectionProtection.record_attack_attempt - A (4)
    F 315:0 get_sql_protection - A (2)
    F 344:0 setup_sql_protection - A (2)
    C 18:4 MockInputSanitizer - A (2)
    C 38:4 MockQueryValidator - A (2)
    M 76:4 SQLInjectionProtection.validate_query - A (2)
    M 111:4 SQLInjectionProtection.block_ip - A (2)
    M 117:4 SQLInjectionProtection.unblock_ip - A (2)
    C 364:0 SecureQueryBuilder - A (2)
    C 381:0 EnhancedSQLProtection - A (2)
    F 29:4 get_input_sanitizer - A (1)
    F 49:4 get_query_validator - A (1)
    F 323:0 validate_query_safe - A (1)
    F 330:0 sanitize_user_input - A (1)
    F 337:0 validate_child_query_safe - A (1)
    F 377:0 get_secure_query_builder - A (1)
    M 19:8 MockInputSanitizer.sanitize - A (1)
    M 39:8 MockQueryValidator.validate_query - A (1)
    M 56:4 SQLInjectionProtection.__init__ - A (1)
    M 93:4 SQLInjectionProtection.sanitize_input - A (1)
    M 107:4 SQLInjectionProtection.check_ip_blocked - A (1)
    M 266:4 SQLInjectionProtection.update_configuration - A (1)
    M 276:4 SQLInjectionProtection.reset_protection_state - A (1)
    M 365:4 SecureQueryBuilder.build_insert - A (1)
    M 369:4 SecureQueryBuilder.build_update - A (1)
    M 373:4 SecureQueryBuilder.build_select - A (1)
    M 382:4 EnhancedSQLProtection.validate_sql_query - A (1)
    M 385:4 EnhancedSQLProtection.validate_column_name - A (1)
    M 388:4 EnhancedSQLProtection.validate_table_name - A (1)
    M 391:4 EnhancedSQLProtection.sanitize_input - A (1)
    M 400:4 EnhancedSQLProtection.log_security_event - A (1)
src/infrastructure/security/token_service.py
    C 13:0 TokenService - A (4)
    M 84:4 TokenService.refresh_access_token - A (4)
    M 16:4 TokenService.__init__ - A (3)
    M 30:4 TokenService.create_access_token - A (3)
    M 52:4 TokenService.create_refresh_token - A (3)
    M 73:4 TokenService.verify_token - A (2)
src/infrastructure/security/vault_client.py
    F 128:0 get_vault_client - A (4)
    C 29:0 VaultClient - A (4)
    M 66:4 VaultClient.get_secret - A (4)
    M 97:4 VaultClient.put_secret - A (4)
    M 38:4 VaultClient.initialize - A (3)
    M 52:4 VaultClient._init_client - A (3)
    M 32:4 VaultClient.__init__ - A (1)
src/infrastructure/security/coppa/consent_manager.py
    M 157:4 COPPAConsentManager.revoke_consent - A (5)
    C 23:0 COPPAConsentManager - A (4)
    M 38:4 COPPAConsentManager.verify_parental_consent - A (4)
    M 204:4 COPPAConsentManager._is_consent_valid - A (4)
    M 71:4 COPPAConsentManager.request_parental_consent - A (3)
    M 118:4 COPPAConsentManager.get_child_consent_status - A (3)
    M 213:4 COPPAConsentManager.create_consent_record - A (3)
    M 33:4 COPPAConsentManager.__init__ - A (2)
src/infrastructure/security/coppa/data_models.py
    C 14:0 COPPAChildData - A (4)
    M 85:4 COPPAChildData.validate_coppa_age - A (3)
    M 95:4 COPPAChildData.validate_consent_date - A (3)
    C 102:0 ParentConsent - A (1)
    C 141:0 DataRetentionPolicy - A (1)
    C 166:0 AuditLogEntry - A (1)
    C 215:0 DataDeletionRequest - A (1)
src/infrastructure/security/coppa/data_retention.py
    M 119:4 DataRetentionManager.process_expired_data - B (8)
    M 230:4 DataRetentionManager._perform_graduated_deletion - B (7)
    M 69:4 DataRetentionManager.calculate_retention_period - A (5)
    C 21:0 DataRetentionManager - A (4)
    M 91:4 DataRetentionManager.schedule_automatic_deletion - A (3)
    M 216:4 DataRetentionManager._is_grace_period_expired - A (3)
    M 340:4 DataRetentionManager._log_compliance_summary - A (3)
    M 373:4 DataRetentionManager.extend_retention_period - A (3)
    F 427:0 get_retention_manager - A (2)
    M 30:4 DataRetentionManager.__init__ - A (2)
    M 171:4 DataRetentionManager._find_expired_children - A (2)
    M 206:4 DataRetentionManager._mark_parent_notified - A (2)
    M 270:4 DataRetentionManager._delete_voice_data - A (2)
    M 291:4 DataRetentionManager._delete_conversation_data - A (2)
    M 301:4 DataRetentionManager._delete_analytics_data - A (2)
    M 311:4 DataRetentionManager._delete_profile_data - A (2)
    M 322:4 DataRetentionManager._create_deletion_audit_record - A (2)
    M 357:4 DataRetentionManager.notify_parent_before_deletion - A (2)
    M 392:4 DataRetentionManager.generate_retention_report - A (2)
    M 43:4 DataRetentionManager.create_retention_policy - A (1)
src/infrastructure/security/coppa/__init__.py
    F 15:0 get_consent_manager - A (1)
src/infrastructure/security/hardening/csrf_protection.py
    M 82:4 CSRFTokenManager.validate_token - B (8)
    M 152:4 CSRFTokenManager._cleanup_expired_tokens - B (6)
    M 201:4 CSRFProtection.validate_request - B (6)
    C 35:0 CSRFTokenManager - A (5)
    M 132:4 CSRFTokenManager.invalidate_session_tokens - A (5)
    M 168:4 CSRFTokenManager.get_token_stats - A (4)
    C 188:0 CSRFProtection - A (4)
    M 258:4 CSRFProtection._get_user_id - A (4)
    M 270:4 CSRFProtection._get_csrf_token_from_request - A (4)
    C 19:0 CSRFConfig - A (3)
    M 40:4 CSRFTokenManager.__init__ - A (3)
    M 46:4 CSRFTokenManager.generate_token - A (3)
    M 117:4 CSRFTokenManager.invalidate_token - A (3)
    M 248:4 CSRFProtection._get_session_id - A (3)
    C 288:0 CSRFMiddleware - A (3)
    M 295:4 CSRFMiddleware.__call__ - A (3)
    F 316:0 get_csrf_protection - A (2)
    M 30:4 CSRFConfig.__post_init__ - A (2)
    M 234:4 CSRFProtection.set_csrf_cookie - A (2)
    F 332:0 init_csrf_protection - A (1)
    F 342:0 csrf_protect - A (1)
    M 191:4 CSRFProtection.__init__ - A (1)
    M 195:4 CSRFProtection.generate_token_for_request - A (1)
    M 291:4 CSRFMiddleware.__init__ - A (1)
src/infrastructure/security/hardening/secure_settings.py
    F 86:0 get_secure_settings - A (1)
    C 22:0 SecureAppSettings - A (1)
src/infrastructure/security/hardening/security_tests.py
    F 23:0 run_security_tests - A (1)
    F 29:0 generate_security_report - A (1)
src/infrastructure/security/hardening/security_tests/authentication_tests.py
    C 13:0 AuthenticationTester - B (7)
    M 16:4 AuthenticationTester.test_authentication - B (6)
    M 57:4 AuthenticationTester.test_input_validation - B (6)
    M 85:4 AuthenticationTester.test_rate_limiting - B (6)
src/infrastructure/security/hardening/security_tests/base_tester.py
    C 12:0 BaseSecurityTester - A (2)
    M 37:4 BaseSecurityTester.read_file_safely - A (2)
    M 15:4 BaseSecurityTester.__init__ - A (1)
    M 19:4 BaseSecurityTester.create_test_result - A (1)
    M 33:4 BaseSecurityTester.scan_python_files - A (1)
src/infrastructure/security/hardening/security_tests/compliance_tests.py
    M 16:4 ComplianceTester.test_coppa_compliance - C (11)
    C 13:0 ComplianceTester - B (10)
    M 72:4 ComplianceTester.test_gdpr_compliance - B (6)
src/infrastructure/security/hardening/security_tests/encryption_tests.py
    C 13:0 EncryptionTester - B (9)
    M 16:4 EncryptionTester.test_encryption - B (9)
    M 84:4 EncryptionTester.test_secrets_exposure - B (6)
src/infrastructure/security/hardening/security_tests/injection_tests.py
    M 92:4 InjectionTester.test_xss_vulnerabilities - B (8)
    C 13:0 InjectionTester - B (7)
    M 16:4 InjectionTester.test_code_injection - B (6)
    M 53:4 InjectionTester.test_sql_injection - B (6)
    M 145:4 InjectionTester.test_path_traversal - B (6)
src/infrastructure/security/hardening/security_tests/security_tester.py
    M 68:4 SecurityTester.generate_security_report - B (6)
    C 16:0 SecurityTester - A (4)
    M 26:4 SecurityTester.run_all_security_tests - A (3)
    M 19:4 SecurityTester.__init__ - A (1)
src/infrastructure/security/hardening/validation/sanitizer.py
    M 113:4 InputSanitizer.sanitize_string - D (21)
    M 272:4 InputSanitizer._sanitize_json_recursive - C (12)
    C 87:0 InputSanitizer - B (9)
    M 90:4 InputSanitizer.__init__ - A (4)
    F 358:0 get_input_sanitizer - A (3)
    M 102:4 InputSanitizer._compile_patterns - A (3)
    M 243:4 InputSanitizer.sanitize_json - A (2)
    F 44:4 get_default_validation_rules - A (1)
    F 66:4 get_profanity_words - A (1)
    F 367:0 sanitize_child_input - A (1)
    F 373:0 sanitize_adult_input - A (1)
    F 379:0 is_safe_for_children - A (1)
    C 20:4 ValidationSeverity - A (1)
    C 27:4 ValidationRule - A (1)
    C 34:4 InputValidationConfig - A (1)
src/infrastructure/security/hardening/validation/validation_config.py
    C 29:0 InputValidationConfig - A (3)
    M 40:4 InputValidationConfig.__post_init__ - A (2)
    C 12:0 ValidationSeverity - A (1)
    C 21:0 ValidationRule - A (1)
src/infrastructure/security/hardening/validation/validation_rules.py
    F 8:0 get_default_validation_rules - A (1)
    F 72:0 get_profanity_words - A (1)
src/infrastructure/security/input_validation/core.py
    C 25:0 InputValidationResult - B (6)
    M 28:4 InputValidationResult.__init__ - A (5)
    C 6:0 SecurityThreat - A (2)
    M 9:4 SecurityThreat.__init__ - A (1)
src/infrastructure/security/input_validation/detectors.py
    M 165:4 ThreatDetectors.detect_ldap_injection - A (5)
    C 83:0 ThreatDetectors - A (4)
    M 230:4 ThreatDetectors.detect_encoding_attacks - A (4)
    M 89:4 ThreatDetectors.detect_sql_injection - A (3)
    M 106:4 ThreatDetectors.detect_xss - A (3)
    M 123:4 ThreatDetectors.detect_path_traversal - A (3)
    M 144:4 ThreatDetectors.detect_command_injection - A (3)
    M 191:4 ThreatDetectors.detect_template_injection - A (3)
    M 212:4 ThreatDetectors.detect_inappropriate_content - A (3)
    M 221:4 ThreatDetectors.detect_pii - A (3)
    F 272:0 get_threat_detector - A (2)
    C 13:4 SecurityPatterns - A (2)
    F 281:0 detect_all_threats - A (1)
    F 298:0 is_text_safe - A (1)
    M 16:8 SecurityPatterns.__init__ - A (1)
    M 86:4 ThreatDetectors.__init__ - A (1)
src/infrastructure/security/input_validation/middleware.py
    M 68:4 InputValidationMiddleware.dispatch - C (19)
    M 236:4 InputValidationMiddleware._should_block_request - C (12)
    C 44:0 InputValidationMiddleware - B (8)
    M 201:4 InputValidationMiddleware._get_request_body - B (8)
    M 262:4 InputValidationMiddleware._log_security_incident - B (6)
    M 290:4 InputValidationMiddleware._log_security_warning - B (6)
    M 224:4 InputValidationMiddleware._get_client_ip - A (5)
    M 317:4 InputValidationMiddleware._create_security_error_response - A (5)
    M 186:4 InputValidationMiddleware._extract_request_context - A (3)
    C 20:4 MockValidator - A (2)
    C 36:4 MockAuditIntegration - A (2)
    F 26:4 get_input_validator - A (1)
    F 40:4 get_audit_integration - A (1)
    F 366:0 create_input_validation_middleware - A (1)
    F 376:0 setup_child_safe_middleware - A (1)
    F 383:0 setup_development_middleware - A (1)
    F 390:0 setup_production_middleware - A (1)
    M 21:8 MockValidator.validate_input - A (1)
    M 37:8 MockAuditIntegration.log_security_event - A (1)
    M 47:4 InputValidationMiddleware.__init__ - A (1)
src/infrastructure/security/input_validation/patterns.py
    C 6:0 SecurityPatterns - A (3)
    M 116:4 SecurityPatterns.test_pattern_group - A (3)
    M 125:4 SecurityPatterns.is_safe_for_children - A (3)
    M 132:4 SecurityPatterns.contains_pii - A (3)
    F 144:0 get_security_patterns - A (2)
    F 153:0 test_sql_injection - A (1)
    F 159:0 test_xss_attack - A (1)
    F 165:0 test_path_traversal - A (1)
    F 171:0 test_command_injection - A (1)
    F 177:0 is_child_safe - A (1)
    F 183:0 has_pii - A (1)
    M 9:4 SecurityPatterns.__init__ - A (1)
    M 13:4 SecurityPatterns._compile_security_patterns - A (1)
    M 77:4 SecurityPatterns._setup_child_safety_patterns - A (1)
    M 103:4 SecurityPatterns.get_all_patterns - A (1)
src/infrastructure/security/input_validation/validator.py
    M 85:4 ComprehensiveInputValidator.validate_input - C (15)
    C 66:0 ComprehensiveInputValidator - B (8)
    M 260:4 ComprehensiveInputValidator.validate_file_upload - B (7)
    M 184:4 ComprehensiveInputValidator._validate_context_specific - B (6)
    M 222:4 ComprehensiveInputValidator._log_validation_results - B (6)
    F 417:0 get_threat_summary - A (4)
    F 362:0 validate_user_input - A (3)
    F 353:0 get_input_validator - A (2)
    F 375:0 validate_child_message - A (2)
    C 18:4 ThreatDetectors - A (2)
    C 58:4 MockAuditIntegration - A (2)
    F 62:4 get_audit_integration - A (1)
    F 388:0 validate_parent_input - A (1)
    F 395:0 validate_admin_input - A (1)
    F 405:0 is_safe_for_children - A (1)
    F 411:0 has_security_threats - A (1)
    M 21:8 ThreatDetectors.__init__ - A (1)
    M 24:8 ThreatDetectors.detect_sql_injection - A (1)
    M 27:8 ThreatDetectors.detect_xss - A (1)
    M 30:8 ThreatDetectors.detect_path_traversal - A (1)
    M 33:8 ThreatDetectors.detect_command_injection - A (1)
    M 36:8 ThreatDetectors.detect_ldap_injection - A (1)
    M 39:8 ThreatDetectors.detect_template_injection - A (1)
    M 42:8 ThreatDetectors.detect_inappropriate_content - A (1)
    M 45:8 ThreatDetectors.detect_pii - A (1)
    M 48:8 ThreatDetectors.detect_encoding_attacks - A (1)
    M 59:8 MockAuditIntegration.log_security_event - A (1)
    M 81:4 ComprehensiveInputValidator.__init__ - A (1)
src/infrastructure/security/key_management/key_generator.py
    C 14:0 KeyGenerator - A (3)
    M 25:4 KeyGenerator.generate_key - A (3)
    M 17:4 KeyGenerator.__init__ - A (1)
src/infrastructure/security/key_management/key_lifecycle_manager.py
    M 46:4 KeyLifecycleManager.create_key - A (5)
    M 114:4 KeyLifecycleManager.cleanup_old_keys - A (5)
    C 20:0 KeyLifecycleManager - A (4)
    M 92:4 KeyLifecycleManager.deactivate_key - A (3)
    M 23:4 KeyLifecycleManager.__init__ - A (1)
    M 35:4 KeyLifecycleManager._get_default_schedules - A (1)
src/infrastructure/security/key_management/key_rotation_orchestrator.py
    M 92:4 KeyRotationOrchestrator.rotate_all_keys - A (3)
    C 34:0 KeyRotationOrchestrator - A (2)
    M 40:4 KeyRotationOrchestrator.__init__ - A (2)
    M 159:4 KeyRotationOrchestrator.check_rotation_needed - A (2)
    M 64:4 KeyRotationOrchestrator.create_key - A (1)
    M 76:4 KeyRotationOrchestrator.rotate_key - A (1)
    M 114:4 KeyRotationOrchestrator.perform_scheduled_rotation - A (1)
    M 123:4 KeyRotationOrchestrator.emergency_rotation - A (1)
    M 137:4 KeyRotationOrchestrator.cleanup_old_keys - A (1)
    M 150:4 KeyRotationOrchestrator.get_rotation_statistics - A (1)
src/infrastructure/security/key_management/rotation_executor.py
    M 168:4 RotationExecutor.emergency_rotation - B (7)
    C 29:0 RotationExecutor - B (6)
    M 55:4 RotationExecutor.rotate_key - B (6)
    M 136:4 RotationExecutor.perform_scheduled_rotation - A (5)
    M 32:4 RotationExecutor.__init__ - A (1)
src/infrastructure/security/key_management/rotation_policy_manager.py
    M 72:4 RotationPolicyManager.get_next_rotation_time - B (7)
    M 31:4 RotationPolicyManager.check_rotation_needed - B (6)
    C 17:0 RotationPolicyManager - A (4)
    M 59:4 RotationPolicyManager.get_keys_needing_rotation - A (3)
    M 20:4 RotationPolicyManager.__init__ - A (1)
    M 91:4 RotationPolicyManager.get_affected_services - A (1)
src/infrastructure/security/key_management/rotation_statistics.py
    M 39:4 RotationStatistics.get_rotation_statistics - C (11)
    M 95:4 RotationStatistics.get_key_usage_report - B (9)
    C 21:0 RotationStatistics - B (6)
    M 79:4 RotationStatistics._calculate_average_age - A (3)
    M 24:4 RotationStatistics.__init__ - A (1)
    M 122:4 RotationStatistics.get_rotation_history - A (1)
src/infrastructure/security/rate_limiter/child_safety.py
    M 45:4 ChildSafetyHandler.should_block_key - A (5)
    C 13:0 ChildSafetyHandler - A (3)
    M 16:4 ChildSafetyHandler.__init__ - A (1)
    M 19:4 ChildSafetyHandler.handle_child_safety_violation - A (1)
src/infrastructure/security/rate_limiter/config.py
    C 6:0 DefaultConfigurations - A (2)
    M 10:4 DefaultConfigurations.get_default_configs - A (1)
src/infrastructure/security/rate_limiter/convenience.py
    F 7:0 check_child_interaction_limit - A (1)
    F 23:0 check_auth_rate_limit - A (1)
    F 36:0 check_api_rate_limit - A (1)
src/infrastructure/security/rate_limiter/core.py
    M 163:4 RedisRateLimiter._check_local_limit - A (5)
    C 93:0 RedisRateLimiter - A (4)
    M 109:4 RedisRateLimiter.check_rate_limit - A (4)
    M 155:4 RedisRateLimiter._get_limit_for_type - A (3)
    M 103:4 RedisRateLimiter.initialize - A (2)
    C 191:0 ChildSafetyRateLimiter - A (2)
    F 213:0 get_child_safety_limiter - A (1)
    C 15:0 RateLimitType - A (1)
    C 30:0 RateLimitStrategy - A (1)
    C 40:0 RateLimitConfig - A (1)
    C 68:0 RateLimitState - A (1)
    C 81:0 RateLimitResult - A (1)
    M 98:4 RedisRateLimiter.__init__ - A (1)
    M 194:4 ChildSafetyRateLimiter.__init__ - A (1)
    M 205:4 ChildSafetyRateLimiter.is_allowed - A (1)
src/infrastructure/security/rate_limiter/service.py
    M 44:4 ComprehensiveRateLimiter.check_rate_limit - B (7)
    C 21:0 ComprehensiveRateLimiter - A (4)
    F 129:0 get_rate_limiter - A (2)
    M 119:4 ComprehensiveRateLimiter._cleanup_expired_entries - A (2)
    M 34:4 ComprehensiveRateLimiter.__init__ - A (1)
src/infrastructure/security/rate_limiter/storage.py
    M 20:4 RateLimitStorage.get_state - A (5)
    M 69:4 RateLimitStorage.cleanup_expired - A (5)
    C 13:0 RateLimitStorage - A (4)
    M 45:4 RateLimitStorage.save_state - A (3)
    M 16:4 RateLimitStorage.__init__ - A (1)
src/infrastructure/security/rate_limiter/strategies.py
    M 49:4 RateLimitingStrategies._apply_fixed_window - B (6)
    C 13:0 RateLimitingStrategies - A (5)
    M 17:4 RateLimitingStrategies.apply_strategy - A (4)
    M 84:4 RateLimitingStrategies._apply_sliding_window - A (4)
    M 110:4 RateLimitingStrategies._apply_token_bucket - A (2)
src/infrastructure/security/safe_expression_parser/__init__.py
    C 13:0 SafeExpressionConfig - A (2)
    C 18:0 SafeExpressionParser - A (2)
    C 9:0 ExpressionContext - A (1)
    M 14:4 SafeExpressionConfig.__init__ - A (1)
    M 19:4 SafeExpressionParser.__init__ - A (1)
    M 22:4 SafeExpressionParser.evaluate - A (1)
src/infrastructure/security/tests/test_path_traversal_fixes.py
    M 205:4 TestChildSafeValidator.test_child_safe_extensions - B (9)
    C 195:0 TestChildSafeValidator - B (8)
    C 328:0 TestSecurityConfiguration - B (6)
    C 256:0 TestSecurityReporting - A (5)
    M 331:4 TestSecurityConfiguration.test_default_security_policy - A (5)
    M 342:4 TestSecurityConfiguration.test_child_safety_measures - A (5)
    M 364:4 TestSecurityConfiguration.test_error_handling_security - A (5)
    M 100:4 TestPathValidator.test_path_sanitization - A (4)
    M 114:4 TestPathValidator.test_safe_path_generation - A (4)
    M 155:4 TestSecureFileOperations.test_safe_file_existence_check - A (4)
    M 166:4 TestSecureFileOperations.test_safe_file_removal - A (4)
    M 179:4 TestSecureFileOperations.test_safe_directory_listing - A (4)
    M 198:4 TestChildSafeValidator.test_child_safe_validator_creation - A (4)
    M 225:4 TestIntegrationWithExistingCode.test_request_logging_middleware_integration - A (4)
    M 272:4 TestSecurityReporting.test_security_metrics - A (4)
    C 302:0 TestPerformance - A (4)
    C 22:0 TestPathValidator - A (3)
    M 41:4 TestPathValidator.test_directory_traversal_prevention - A (3)
    M 61:4 TestPathValidator.test_null_byte_injection_prevention - A (3)
    M 78:4 TestPathValidator.test_extension_validation - A (3)
    M 85:4 TestPathValidator.test_symlink_prevention - A (3)
    C 123:0 TestSecureFileOperations - A (3)
    C 222:0 TestIntegrationWithExistingCode - A (3)
    M 259:4 TestSecurityReporting.test_traversal_attempt_logging - A (3)
    M 305:4 TestPerformance.test_validation_performance - A (3)
    F 293:0 test_global_convenience_functions - A (2)
    M 36:4 TestPathValidator.test_basic_path_validation - A (2)
    M 73:4 TestPathValidator.test_path_length_validation - A (2)
    M 138:4 TestSecureFileOperations.test_safe_file_opening - A (2)
    M 25:4 TestPathValidator.setup_method - A (1)
    M 126:4 TestSecureFileOperations.setup_method - A (1)
    M 150:4 TestSecureFileOperations.test_unsafe_file_opening_blocked - A (1)
    M 243:4 TestIntegrationWithExistingCode.test_audit_logger_integration - A (1)
    M 249:4 TestIntegrationWithExistingCode.test_conversation_repository_integration - A (1)
src/infrastructure/security/validation/query_validator.py
    M 82:4 SQLQueryValidator.validate_query_parameters - C (11)
    M 276:4 SQLQueryValidator.get_safe_limit_offset - B (9)
    M 178:4 SQLQueryValidator.create_safe_where_clause - B (6)
    C 26:0 SQLQueryValidator - A (5)
    M 204:4 SQLQueryValidator.validate_child_data_query - A (5)
    M 135:4 SQLQueryValidator.validate_table_name - A (3)
    M 149:4 SQLQueryValidator.validate_column_name - A (3)
    F 322:0 get_query_validator - A (2)
    M 235:4 SQLQueryValidator.log_security_event - A (2)
    M 259:4 SQLQueryValidator.sanitize_query_string - A (2)
    F 331:0 validate_params - A (1)
    F 337:0 is_safe_table - A (1)
    F 343:0 is_safe_column - A (1)
    F 349:0 create_safe_where - A (1)
    F 355:0 validate_child_query - A (1)
    C 16:0 QueryValidationResult - A (1)
    M 36:4 SQLQueryValidator.__init__ - A (1)
src/infrastructure/services/data_retention_service.py
    M 101:4 COPPADataRetentionService.schedule_daily_retention_check - B (8)
    M 545:4 COPPADataRetentionService.generate_compliance_report - B (7)
    M 265:4 COPPADataRetentionService._delete_child_data - A (4)
    M 418:4 COPPADataRetentionService.extend_retention - A (4)
    C 28:0 COPPADataRetentionService - A (3)
    M 197:4 COPPADataRetentionService._process_scheduled_deletion - A (3)
    M 482:4 COPPADataRetentionService.request_immediate_deletion - A (3)
    F 590:0 get_retention_service - A (2)
    M 141:4 COPPADataRetentionService._send_deletion_notification - A (2)
    M 230:4 COPPADataRetentionService._export_child_data - A (2)
    M 367:4 COPPADataRetentionService._send_deletion_confirmation - A (2)
    M 525:4 COPPADataRetentionService.get_retention_status - A (2)
    F 599:0 register_child_for_retention - A (1)
    F 609:0 extend_child_retention - A (1)
    F 619:0 request_child_deletion - A (1)
    C 18:0 RetentionStatus - A (1)
    M 39:4 COPPADataRetentionService.__init__ - A (1)
    M 47:4 COPPADataRetentionService.register_child_data - A (1)
    M 170:4 COPPADataRetentionService._send_email_notification - A (1)
    M 305:4 COPPADataRetentionService._delete_from_conversations - A (1)
    M 314:4 COPPADataRetentionService._delete_from_user_profiles - A (1)
    M 322:4 COPPADataRetentionService._delete_from_interaction_logs - A (1)
    M 330:4 COPPADataRetentionService._delete_from_learning_data - A (1)
    M 338:4 COPPADataRetentionService._delete_from_preferences - A (1)
    M 346:4 COPPADataRetentionService._delete_from_audio_files - A (1)
    M 354:4 COPPADataRetentionService._delete_from_analytics - A (1)
    M 362:4 COPPADataRetentionService._generate_deletion_hash - A (1)
    M 391:4 COPPADataRetentionService._send_deletion_confirmation_email - A (1)
src/infrastructure/session_manager/session_models.py
    C 11:0 Session - A (1)
src/infrastructure/state/application_state_manager.py
    C 12:0 ApplicationStateManager - A (2)
    M 32:4 ApplicationStateManager.delete_state - A (2)
    F 57:0 create_state_manager - A (1)
    C 6:0 StateScope - A (1)
    M 13:4 ApplicationStateManager.__init__ - A (1)
    M 17:4 ApplicationStateManager.set_state - A (1)
    M 26:4 ApplicationStateManager.get_state - A (1)
    M 29:4 ApplicationStateManager.has_state - A (1)
    M 36:4 ApplicationStateManager.async_request_context - A (1)
    M 46:4 ApplicationStateManager.session_context - A (1)
src/infrastructure/validation/comprehensive_validator.py
    M 44:4 ComprehensiveValidator.validate_child_registration - C (15)
    M 218:4 ComprehensiveValidator.validate_parent_data - B (10)
    M 115:4 ComprehensiveValidator.validate_message_input - B (9)
    C 19:0 ComprehensiveValidator - B (8)
    M 260:4 ComprehensiveValidator.validate_search_query - B (8)
    M 182:4 ComprehensiveValidator.validate_file_upload - A (5)
    M 307:4 ComprehensiveValidator._validate_child_name - A (5)
    M 30:4 ComprehensiveValidator.__init__ - A (2)
    F 326:0 get_comprehensive_validator - A (1)
    F 334:0 validate_child_registration - A (1)
    F 342:0 validate_message_input - A (1)
    F 348:0 validate_file_upload - A (1)
src/infrastructure/validation/emergency_contact_validator.py
    M 368:4 EmergencyContactValidator.get_contact_accessibility_score - D (21)
    M 142:4 EmergencyContactValidator.validate_emergency_contacts_list - C (13)
    C 27:0 EmergencyContactValidator - B (8)
    M 76:4 EmergencyContactValidator.validate_emergency_contact - B (8)
    M 267:4 EmergencyContactValidator._validate_phone_number - B (7)
    M 219:4 EmergencyContactValidator._validate_name - B (6)
    M 323:4 EmergencyContactValidator._validate_address - A (5)
    M 250:4 EmergencyContactValidator._validate_relationship - A (4)
    M 306:4 EmergencyContactValidator._validate_email - A (4)
    M 349:4 EmergencyContactValidator._format_us_number - A (4)
    M 38:4 EmergencyContactValidator.__init__ - A (2)
    M 362:4 EmergencyContactValidator._format_international_number - A (2)
    C 16:0 EmergencyContact - A (1)
src/infrastructure/validation/general_input_validator.py
    F 14:0 get_general_input_validator - A (2)
    C 5:0 GeneralInputValidator - A (2)
    M 6:4 GeneralInputValidator.validate_text - A (1)
    M 9:4 GeneralInputValidator.validate_email - A (1)
src/presentation/routing.py
    F 43:0 setup_routing - A (3)
src/presentation/api/esp32_endpoints.py
    F 89:0 process_audio - B (6)
    F 26:0 get_current_user_esp32 - A (3)
    F 173:0 update_device_status - A (1)
    F 190:0 health_check - A (1)
    F 202:0 get_device_config - A (1)
    C 61:0 AudioRequest - A (1)
    C 70:0 AudioResponse - A (1)
    C 79:0 DeviceStatusRequest - A (1)
src/presentation/api/main_router.py
    F 33:0 health_check - A (1)
    F 45:0 api_info - A (1)
src/presentation/api/openapi_config.py
    F 26:0 custom_openapi - A (2)
    F 64:0 configure_openapi - A (1)
src/presentation/api/parental_dashboard.py
    F 290:0 revoke_consent - A (4)
    F 165:0 generate_child_story_endpoint - A (3)
    F 224:0 grant_parental_consent - A (3)
    F 105:0 create_child_profile_endpoint - A (2)
    F 124:0 get_child_profile_endpoint - A (2)
    F 137:0 update_child_profile_endpoint - A (2)
    F 153:0 delete_child_profile_endpoint - A (2)
    F 193:0 request_consent_verification - A (2)
    F 267:0 get_consent_status - A (2)
    C 31:0 CreateChildRequest - A (1)
    C 51:0 UpdateChildRequest - A (1)
    C 70:0 ParentConsentRequest - A (1)
    C 91:0 ConsentStatusResponse - A (1)
src/presentation/api/validators.py
    M 48:4 ChildValidationMixin.validate_interests - B (9)
    M 24:4 ChildValidationMixin.validate_name - B (8)
    C 12:0 ChildValidationMixin - B (7)
    M 15:4 ChildValidationMixin.validate_age - A (3)
    M 75:4 ChildValidationMixin.validate_language - A (3)
src/presentation/api/decorators/rate_limit.py
    F 60:0 check_child_interaction_limit - A (3)
    F 14:0 rate_limit - A (1)
    F 40:0 strict_limit - A (1)
    F 45:0 moderate_limit - A (1)
    F 50:0 relaxed_limit - A (1)
    F 55:0 child_safety_limit - A (1)
    F 92:0 auth_rate_limit - A (1)
    F 97:0 registration_rate_limit - A (1)
    F 102:0 conversation_rate_limit - A (1)
    F 107:0 file_upload_rate_limit - A (1)
    F 112:0 health_check_rate_limit - A (1)
    F 118:0 child_audio_rate_limit - A (1)
    F 123:0 child_message_rate_limit - A (1)
    F 128:0 emergency_contact_rate_limit - A (1)
src/presentation/api/dependencies/auth.py
    F 12:0 get_authenticated_user - A (5)
src/presentation/api/dependencies/base.py
    C 16:0 LazyServiceProvider - A (3)
    C 8:0 ServiceFactory - A (2)
    M 23:4 LazyServiceProvider.get - A (2)
    M 12:4 ServiceFactory.create - A (1)
    M 19:4 LazyServiceProvider.__init__ - A (1)
src/presentation/api/dependencies/providers.py
    F 5:0 _create_coppa_integration - A (1)
    F 19:0 _create_parental_consent_manager - A (1)
    F 31:0 _create_compliance_validator - A (1)
    F 38:0 _create_data_retention_manager - A (1)
    F 50:0 _create_audio_processing_service - A (1)
src/presentation/api/dependencies/__init__.py
    F 11:0 get_audio_processing_service - A (1)
    F 16:0 get_coppa_integration - A (1)
    F 20:0 get_parental_consent_manager - A (1)
    F 24:0 get_compliance_validator - A (1)
    F 28:0 get_data_retention_manager - A (1)
src/presentation/api/emergency_response/endpoints.py
    M 127:4 EmergencyEndpoints.send_notification - A (4)
    M 145:4 EmergencyEndpoints.system_status - A (4)
    C 33:0 EmergencyEndpoints - A (3)
    M 46:4 EmergencyEndpoints.webhook_alerts - A (3)
    M 92:4 EmergencyEndpoints.health_check - A (3)
    M 111:4 EmergencyEndpoints.get_alerts - A (3)
    M 167:4 EmergencyEndpoints.emergency_contact_alert - A (3)
    M 203:4 EmergencyEndpoints.get_emergency_logs - A (3)
    M 71:4 EmergencyEndpoints._process_single_alert - A (2)
    M 160:4 EmergencyEndpoints._verify_token - A (2)
    M 36:4 EmergencyEndpoints.__init__ - A (1)
src/presentation/api/emergency_response/main.py
    ERROR: invalid syntax (<unknown>, line 65)
src/presentation/api/emergency_response/models.py
    C 9:0 AlertPayload - A (1)
    C 17:0 EmergencyAlert - A (1)
    C 30:0 SystemStatus - A (1)
    C 40:0 HealthResponse - A (1)
    C 50:0 NotificationRequest - A (1)
    C 60:0 ResponseAction - A (1)
    C 71:0 EmergencyContact - A (1)
    C 83:0 AlertRule - A (1)
    C 96:0 SafetyIncident - A (1)
    C 111:0 AlertHistory - A (1)
    C 122:0 ParentNotification - A (1)
    C 137:0 SystemConfig - A (1)
src/presentation/api/emergency_response/services.py
    M 158:4 EmergencyResponseService.get_emergency_logs - A (4)
    C 182:0 SystemMonitorService - A (4)
    M 194:4 SystemMonitorService.check_system_health - A (4)
    M 216:4 SystemMonitorService._check_service_health - A (4)
    M 248:4 SystemMonitorService.get_system_metrics - A (4)
    M 307:4 EmergencyNotificationService.get_notification_history - A (4)
    M 139:4 EmergencyResponseService._execute_actions - A (3)
    C 282:0 EmergencyNotificationService - A (3)
    C 19:0 EmergencyResponseService - A (2)
    M 288:4 EmergencyNotificationService.send_notification - A (2)
    M 330:4 EmergencyNotificationService.send_emergency_sms - A (2)
    M 22:4 EmergencyResponseService.__init__ - A (1)
    M 32:4 EmergencyResponseService.process_alert - A (1)
    M 48:4 EmergencyResponseService._handle_child_safety_alert - A (1)
    M 73:4 EmergencyResponseService._handle_system_failure_alert - A (1)
    M 90:4 EmergencyResponseService._handle_security_breach_alert - A (1)
    M 112:4 EmergencyResponseService._handle_content_violation_alert - A (1)
    M 129:4 EmergencyResponseService._handle_default_alert - A (1)
    M 153:4 EmergencyResponseService._execute_single_action - A (1)
    M 185:4 SystemMonitorService.__init__ - A (1)
    M 285:4 EmergencyNotificationService.__init__ - A (1)
src/presentation/api/endpoints/audio.py
    F 19:0 transcribe_audio - A (1)
src/presentation/api/endpoints/auth.py
    F 26:0 get_client_ip - A (4)
src/presentation/api/endpoints/chatgpt.py
Traceback (most recent call last):
  File "/mnt/c/Users/jaafa/Desktop/5555/ai-teddy/.venv/lib/python3.12/site-packages/radon/__init__.py", line 15, in main
    program()
  File "/mnt/c/Users/jaafa/Desktop/5555/ai-teddy/.venv/lib/python3.12/site-packages/mando/core.py", line 208, in __call__
    return self.execute(sys.argv[1:])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/jaafa/Desktop/5555/ai-teddy/.venv/lib/python3.12/site-packages/mando/core.py", line 204, in execute
    return command(*a)
           ^^^^^^^^^^^
  File "/mnt/c/Users/jaafa/Desktop/5555/ai-teddy/.venv/lib/python3.12/site-packages/radon/cli/__init__.py", line 168, in cc
    log_result(
  File "/mnt/c/Users/jaafa/Desktop/5555/ai-teddy/.venv/lib/python3.12/site-packages/radon/cli/__init__.py", line 391, in log_result
    log_error(h_args[0], indent=1)
  File "/mnt/c/Users/jaafa/Desktop/5555/ai-teddy/.venv/lib/python3.12/site-packages/radon/cli/__init__.py", line 423, in log_error
    log('{0}{1}ERROR{2}: {3}'.format(BRIGHT, RED, RESET, msg), *args, **kwargs)
  File "/mnt/c/Users/jaafa/Desktop/5555/ai-teddy/.venv/lib/python3.12/site-packages/radon/cli/__init__.py", line 408, in log
    m = msg if kwargs.get('noformat', False) else msg.format(*args)
                                                  ^^^^^^^^^^^^^^^^^
ValueError: expected '}' before end of string

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/c/Users/jaafa/Desktop/5555/ai-teddy/.venv/bin/radon", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/mnt/c/Users/jaafa/Desktop/5555/ai-teddy/.venv/lib/python3.12/site-packages/radon/__init__.py", line 17, in main
    log_error(e)
  File "/mnt/c/Users/jaafa/Desktop/5555/ai-teddy/.venv/lib/python3.12/site-packages/radon/cli/__init__.py", line 423, in log_error
    log('{0}{1}ERROR{2}: {3}'.format(BRIGHT, RED, RESET, msg), *args, **kwargs)
  File "/mnt/c/Users/jaafa/Desktop/5555/ai-teddy/.venv/lib/python3.12/site-packages/radon/cli/__init__.py", line 408, in log
    m = msg if kwargs.get('noformat', False) else msg.format(*args)
                                                  ^^^^^^^^^^^^^^^^^
ValueError: Single '}' encountered in format string

```

⏱️ الوقت المستغرق: 9.62 ثانية


---

## التحقق من تنسيق الكود (Black)
```bash
black --check src/ --exclude .venv|venv|__pycache__|build|dist|.mypy_cache|node_modules|.git
```

_Error or No results._
```
/bin/sh: 1: venv: not found
/bin/sh: 1: __pycache__: Permission denied
/bin/sh: 1: build: not found
/bin/sh: 1: /bin/sh: 1: dist: not found.mypy_cache: not found

/bin/sh: 1: .git: not found
/bin/sh: 1: node_modules: Permission denied
error: cannot format /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/application/interfaces/infrastructure_services.py: Cannot parse: 5:0:     @abstractmethod
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/domain/exceptions/child_exceptions.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/domain/exceptions/security_exceptions.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/application/services/consent/__init__.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/application/services/parent_child_verification_service.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/domain/entities/user.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/application/interfaces/read_model_interfaces.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/application/exceptions.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/config/base_settings.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/application/dto/ai_response.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/domain/interfaces/repository_interfaces.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/config/ai_settings.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/domain/value_objects/safety_level.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/config/kafka_settings.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/config/application_settings.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/config/prometheus_settings.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/config/redis_settings.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/domain/exceptions/base.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/config/models.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/config/privacy_settings.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/domain/repositories/event_store.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/config/database_settings.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/config/coppa_config.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/domain/value_objects/child_preferences.py
error: cannot format /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/logging/standards.py: Cannot parse: 11:0:     """Standard log categories for the system."""
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/error_handling/error_types.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/config/production_check.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/di/di_components/__init__.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/di/container.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/error_handling/__init__.py
error: cannot format /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/persistence/database_service_orchestrator.py: Cannot parse: 13:125: from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/monitoring/__init__.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/config/server_settings.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/persistence/database/__init__.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/persistence/models/base.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/error_handling/exceptions.py
error: cannot format /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/persistence/repositories/__init__.py: Cannot parse: 9:125: from src.infrastructure.persistence.conversation_repository import AsyncSQLAlchemyConversationRepo as ConversationRepository import (
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/persistence/real_database_service.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/config/security_settings.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/config/settings.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/security/coppa/__init__.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/di/application_container.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/persistence/conversation_repository.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/middleware/__init__.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/security/child_data_security_manager.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/persistence/postgres_event_store.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/security/hardening/security_validator.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/security/hardening/validation/__init__.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/application/services/coppa/coppa_compliance_service.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/security/hardening/validation/validation_config.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/persistence/models/child_models.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/domain/schemas.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/security/request_signing_service.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/application/services/ai/modules/response_generator.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/persistence/database_manager.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/security/security_headers_service.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/security/security_levels.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/security/coppa/consent_manager.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/security/validation/__init__.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/validation/child_safety_validator.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/validation/general_input_validator.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/session_manager/session_models.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/presentation/api/dependencies/__init__.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/presentation/api/dependencies/base.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/presentation/api/dependencies/providers.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/presentation/api/endpoints/audio.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/presentation/api/endpoints/auth.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/security/real_auth_service.py
error: cannot format /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/presentation/api/emergency_response/main.py: Cannot parse: 65:11:     global (
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/presentation/api/health_endpoints.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/security/token_service.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/security/main_security_service.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/presentation/api/middleware/__init__.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/security/rate_limiter/core.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/presentation/api/endpoints/conversations.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/middleware/security/headers.py
error: cannot format /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/presentation/api/endpoints/chatgpt.py: Cannot parse: 261:8:         ],
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/main.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/presentation/api/endpoints/children/compliance.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/presentation/api/middleware/error_handling.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/security/sql_injection_protection.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/infrastructure/security/secure_logger.py
would reformat /mnt/c/Users/jaafa/Desktop/5555/ai-teddy/ai-tiddy-bear--main/src/presentation/api/models/validation_models.py

Oh no! 💥 💔 💥
77 files would be reformatted, 399 files would be left unchanged, 6 files would fail to reformat.

```

⏱️ الوقت المستغرق: 47.24 ثانية


---

## ترتيب الاستيرادات (isort)
```bash
isort --check-only src/ --skip .venv venv __pycache__ build dist .mypy_cache node_modules .git
```

_Error or No results._
```
usage: isort [-h] [-V] [--vn] [-v] [--only-modified] [--dedup-headings] [-q]
             [-d] [--overwrite-in-place] [--show-config] [--show-files] [--df]
             [-c] [--ws] [--sp SETTINGS_PATH] [--cr CONFIG_ROOT]
             [--resolve-all-configs] [--profile PROFILE] [--old-finders]
             [-j [JOBS]] [--ac] [--interactive] [--format-error FORMAT_ERROR]
             [--format-success FORMAT_SUCCESS] [--srx] [--filter-files]
             [-s SKIP] [--extend-skip EXTEND_SKIP] [--sg SKIP_GLOB]
             [--extend-skip-glob EXTEND_SKIP_GLOB] [--gitignore]
             [--ext SUPPORTED_EXTENSIONS]
             [--blocked-extension BLOCKED_EXTENSIONS] [--dont-follow-links]
             [--filename FILENAME] [--allow-root] [-a ADD_IMPORTS] [--append]
             [--af] [--rm REMOVE_IMPORTS] [--float-to-top]
             [--dont-float-to-top] [--ca] [--cs] [-e] [--ff]
             [--fgw [FORCE_GRID_WRAP]] [-i INDENT]
             [--lbi LINES_BEFORE_IMPORTS] [--lai LINES_AFTER_IMPORTS]
             [--lbt LINES_BETWEEN_TYPES] [--le LINE_ENDING] [--ls] [--lss]
             [-m {GRID,VERTICAL,HANGING_INDENT,VERTICAL_HANGING_INDENT,VERTICAL_GRID,VERTICAL_GRID_GROUPED,VERTICAL_GRID_GROUPED_NO_COMMA,NOQA,VERTICAL_HANGING_INDENT_BRACKET,VERTICAL_PREFIX_FROM_MODULE_IMPORT,HANGING_INDENT_WITH_PARENTHESES,BACKSLASH_GRID,0,1,2,3,4,5,6,7,8,9,10,11}]
             [-n] [--nis] [--ot] [--dt] [--rr] [--reverse-sort]
             [--sort-order SORT_ORDER] [--sl] [--nsl SINGLE_LINE_EXCLUSIONS]
             [--tc] [--up] [-l LINE_LENGTH] [--wl WRAP_LENGTH]
             [--case-sensitive] [--remove-redundant-aliases] [--honor-noqa]
             [--treat-comment-as-code TREAT_COMMENTS_AS_CODE]
             [--treat-all-comment-as-code] [--formatter FORMATTER] [--color]
             [--ext-format EXT_FORMAT] [--star-first]
             [--split-on-trailing-comma] [--sd DEFAULT_SECTION]
             [--only-sections] [--ds] [--fas] [--fss] [--hcss] [--srss]
             [--fass] [-t FORCE_TO_TOP] [--combine-straight-imports]
             [--nlb NO_LINES_BEFORE] [--src SRC_PATHS]
             [-b KNOWN_STANDARD_LIBRARY]
             [--extra-builtin EXTRA_STANDARD_LIBRARY]
             [-f KNOWN_FUTURE_LIBRARY] [-o KNOWN_THIRD_PARTY]
             [-p KNOWN_FIRST_PARTY] [--known-local-folder KNOWN_LOCAL_FOLDER]
             [--virtual-env VIRTUAL_ENV] [--conda-env CONDA_ENV]
             [--py {all,2,27,3,310,311,312,313,36,37,38,39,auto}]
             [files ...]
isort: error: unrecognized arguments: venv __pycache__ build dist .mypy_cache node_modules .git

```

⏱️ الوقت المستغرق: 3.37 ثانية


---

## فحص جودة التوثيق (pydocstyle)
```bash
pydocstyle src/ --ignore=.venv venv __pycache__ build dist .mypy_cache node_modules .git
```

_Error or No results._
```
WARNING: Error code passed is not a prefix of any known errors: .venv
WARNING: Error in file src/application/interfaces/infrastructure_services.py: Cannot parse file.
WARNING: Error in file src/infrastructure/logging/standards.py: Cannot parse file.
WARNING: Error in file src/infrastructure/persistence/database_service_orchestrator.py: Cannot parse file.
WARNING: Error in file src/infrastructure/persistence/repositories/__init__.py: Cannot parse file.
WARNING: Error in file src/presentation/api/emergency_response/main.py: Cannot parse file.
WARNING: Error in file src/presentation/api/endpoints/chatgpt.py: Cannot parse file.
src/main.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/main.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/main.py:1 at module level:
        D400: First line should end with a period (not ')')
src/main.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not ')')
src/main.py:41 in public function `lifespan`:
        D103: Missing docstring in public function
src/main.py:75 in private function `_setup_app_configurations`:
        D401: First line should be in imperative mood; try rephrasing (found 'Helper')
src/main.py:85 in private function `_validate_system_startup`:
        D401: First line should be in imperative mood; try rephrasing (found 'Helper')
src/main.py:101 in private function `_setup_app_middlewares_and_routes`:
        D401: First line should be in imperative mood; try rephrasing (found 'Helper')
src/main.py:108 in private function `_mount_static_files`:
        D401: First line should be in imperative mood; try rephrasing (found 'Helper')
src/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/api/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/api/endpoints/voice_models.py:1 at module level:
        D100: Missing docstring in public module
src/api/endpoints/voice_models.py:5 in public class `VoiceResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/api/endpoints/voice_models.py:14 in public class `AudioValidationResult`:
        D101: Missing docstring in public class
src/api/endpoints/voice_models.py:21 in public class `SpeechToTextResult`:
        D101: Missing docstring in public class
src/api/endpoints/voice_models.py:31 in public class `TextToSpeechResult`:
        D101: Missing docstring in public class
src/api/endpoints/voice_routes.py:1 at module level:
        D100: Missing docstring in public module
src/api/endpoints/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/application/exceptions.py:4 in public class `AITeddyError`:
        D203: 1 blank line required before class docstring (found 0)
src/application/exceptions.py:6 in public method `__init__`:
        D107: Missing docstring in __init__
src/application/exceptions.py:20 in public class `ServiceUnavailableError`:
        D203: 1 blank line required before class docstring (found 0)
src/application/exceptions.py:22 in public method `__init__`:
        D107: Missing docstring in __init__
src/application/exceptions.py:31 in public class `InvalidInputError`:
        D203: 1 blank line required before class docstring (found 0)
src/application/exceptions.py:33 in public method `__init__`:
        D107: Missing docstring in __init__
src/application/exceptions.py:42 in public class `TimeoutError`:
        D203: 1 blank line required before class docstring (found 0)
src/application/exceptions.py:44 in public method `__init__`:
        D107: Missing docstring in __init__
src/application/exceptions.py:52 in public class `ConsentError`:
        D203: 1 blank line required before class docstring (found 0)
src/application/exceptions.py:52 in public class `ConsentError`:
        D204: 1 blank line required after class docstring (found 0)
src/application/exceptions.py:52 in public class `ConsentError`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/exceptions.py:52 in public class `ConsentError`:
        D212: Multi-line docstring summary should start at the first line
src/application/exceptions.py:56 in public method `__init__`:
        D107: Missing docstring in __init__
src/application/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/dto/ai_response.py:1 at module level:
        D100: Missing docstring in public module
src/application/dto/ai_response.py:7 in public class `AIResponse`:
        D101: Missing docstring in public class
src/application/dto/ai_response.py:37 in public method `__post_init__`:
        D105: Missing docstring in magic method
src/application/dto/child_data.py:1 at module level:
        D100: Missing docstring in public module
src/application/dto/child_data.py:32 in public class `ChildData`:
        D203: 1 blank line required before class docstring (found 0)
src/application/dto/child_data.py:32 in public class `ChildData`:
        D213: Multi-line docstring summary should start at the second line
src/application/dto/esp32_request.py:1 at module level:
        D100: Missing docstring in public module
src/application/dto/esp32_request.py:7 in public class `ESP32Request`:
        D203: 1 blank line required before class docstring (found 0)
src/application/dto/esp32_request.py:7 in public class `ESP32Request`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/dto/esp32_request.py:7 in public class `ESP32Request`:
        D213: Multi-line docstring summary should start at the second line
src/application/dto/esp32_request.py:7 in public class `ESP32Request`:
        D400: First line should end with a period (not 'd')
src/application/dto/esp32_request.py:7 in public class `ESP32Request`:
        D415: First line should end with a period, question mark, or exclamation point (not 'd')
src/application/dto/esp32_request.py:7 in public class `ESP32Request`:
        D413: Missing blank line after last section ('Attributes')
src/application/dto/esp32_request.py:7 in public class `ESP32Request`:
        D407: Missing dashed underline after section ('Attributes')
src/application/dto/esp32_request.py:7 in public class `ESP32Request`:
        D406: Section name should end with a newline ('Attributes', not 'Attributes:')
src/application/dto/story_response.py:1 at module level:
        D100: Missing docstring in public module
src/application/dto/story_response.py:12 in public class `StoryResponse`:
        D101: Missing docstring in public class
src/application/dto/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/application/dto/esp32/esp32_data.py:1 at module level:
        D100: Missing docstring in public module
src/application/dto/esp32/esp32_data.py:7 in public class `ESP32SensorReadingDTO`:
        D101: Missing docstring in public class
src/application/dto/esp32/esp32_data.py:16 in public class `ESP32VoiceCommandDTO`:
        D101: Missing docstring in public class
src/application/dto/esp32/esp32_data.py:23 in public class `ESP32GestureEventDTO`:
        D101: Missing docstring in public class
src/application/dto/esp32/esp32_data.py:31 in public class `ESP32FirmwareUpdateStatusDTO`:
        D101: Missing docstring in public class
src/application/dto/esp32/esp32_data.py:40 in public class `ESP32DeviceStatusDTO`:
        D101: Missing docstring in public class
src/application/dto/esp32/esp32_data.py:50 in public class `ESP32EdgeAIResultDTO`:
        D101: Missing docstring in public class
src/application/dto/esp32/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/application/event_handlers/child_profile_event_handlers.py:1 at module level:
        D100: Missing docstring in public module
src/application/event_handlers/child_profile_event_handlers.py:28 in public class `ChildProfileEventHandlers`:
        D203: 1 blank line required before class docstring (found 0)
src/application/event_handlers/child_profile_event_handlers.py:28 in public class `ChildProfileEventHandlers`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/event_handlers/child_profile_event_handlers.py:28 in public class `ChildProfileEventHandlers`:
        D213: Multi-line docstring summary should start at the second line
src/application/event_handlers/child_profile_event_handlers.py:33 in public method `__init__`:
        D107: Missing docstring in __init__
src/application/event_handlers/child_profile_event_handlers.py:37 in public method `handle_child_registered`:
        D213: Multi-line docstring summary should start at the second line
src/application/event_handlers/child_profile_event_handlers.py:37 in public method `handle_child_registered`:
        D407: Missing dashed underline after section ('Args')
src/application/event_handlers/child_profile_event_handlers.py:64 in public method `handle_child_profile_updated`:
        D213: Multi-line docstring summary should start at the second line
src/application/event_handlers/child_profile_event_handlers.py:64 in public method `handle_child_profile_updated`:
        D407: Missing dashed underline after section ('Args')
src/application/event_handlers/child_profile_event_handlers.py:111 in private method `_async_save`:
        D213: Multi-line docstring summary should start at the second line
src/application/event_handlers/child_profile_event_handlers.py:111 in private method `_async_save`:
        D407: Missing dashed underline after section ('Args')
src/application/event_handlers/child_profile_event_handlers.py:125 in private method `_async_get_by_id`:
        D213: Multi-line docstring summary should start at the second line
src/application/event_handlers/child_profile_event_handlers.py:125 in private method `_async_get_by_id`:
        D407: Missing dashed underline after section ('Returns')
src/application/event_handlers/child_profile_event_handlers.py:125 in private method `_async_get_by_id`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/event_handlers/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/application/interfaces/ai_provider.py:1 at module level:
        D100: Missing docstring in public module
src/application/interfaces/ai_provider.py:8 in public class `AIProvider`:
        D203: 1 blank line required before class docstring (found 0)
src/application/interfaces/ai_provider.py:10 in public method `generate_response`:
        D102: Missing docstring in public method
src/application/interfaces/ai_provider.py:18 in public method `analyze_sentiment`:
        D102: Missing docstring in public method
src/application/interfaces/ai_provider.py:20 in public method `analyze_emotion`:
        D102: Missing docstring in public method
src/application/interfaces/ai_provider.py:22 in public method `analyze_toxicity`:
        D102: Missing docstring in public method
src/application/interfaces/ai_provider.py:24 in public method `analyze_personality`:
        D102: Missing docstring in public method
src/application/interfaces/ai_provider.py:29 in public method `supports_asr_model`:
        D102: Missing docstring in public method
src/application/interfaces/ai_provider.py:31 in public method `transcribe_audio`:
        D102: Missing docstring in public method
src/application/interfaces/ai_provider.py:33 in public method `evaluate_educational_value`:
        D102: Missing docstring in public method
src/application/interfaces/ai_provider.py:35 in public method `determine_activity_type`:
        D102: Missing docstring in public method
src/application/interfaces/ai_provider.py:42 in public method `generate_personalized_content`:
        D102: Missing docstring in public method
src/application/interfaces/read_model_interfaces.py:1 at module level:
        D100: Missing docstring in public module
src/application/interfaces/read_model_interfaces.py:12 in public class `IChildProfileReadModel`:
        D203: 1 blank line required before class docstring (found 0)
src/application/interfaces/read_model_interfaces.py:36 in public class `IChildProfileReadModelStore`:
        D203: 1 blank line required before class docstring (found 0)
src/application/interfaces/read_model_interfaces.py:85 in public function `create_child_profile_read_model`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/interfaces/read_model_interfaces.py:85 in public function `create_child_profile_read_model`:
        D213: Multi-line docstring summary should start at the second line
src/application/interfaces/read_model_interfaces.py:85 in public function `create_child_profile_read_model`:
        D400: First line should end with a period (not 's')
src/application/interfaces/read_model_interfaces.py:85 in public function `create_child_profile_read_model`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/application/interfaces/read_model_interfaces.py:85 in public function `create_child_profile_read_model`:
        D401: First line should be in imperative mood; try rephrasing (found 'Factory')
src/application/interfaces/read_model_interfaces.py:93 in public function `get_read_model_store`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/interfaces/read_model_interfaces.py:93 in public function `get_read_model_store`:
        D213: Multi-line docstring summary should start at the second line
src/application/interfaces/read_model_interfaces.py:93 in public function `get_read_model_store`:
        D400: First line should end with a period (not 'e')
src/application/interfaces/read_model_interfaces.py:93 in public function `get_read_model_store`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/application/interfaces/read_model_interfaces.py:93 in public function `get_read_model_store`:
        D401: First line should be in imperative mood; try rephrasing (found 'Factory')
src/application/interfaces/read_model_interfaces.py:101 in public function `get_event_bus`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/interfaces/read_model_interfaces.py:101 in public function `get_event_bus`:
        D213: Multi-line docstring summary should start at the second line
src/application/interfaces/read_model_interfaces.py:101 in public function `get_event_bus`:
        D400: First line should end with a period (not 's')
src/application/interfaces/read_model_interfaces.py:101 in public function `get_event_bus`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/application/interfaces/read_model_interfaces.py:101 in public function `get_event_bus`:
        D401: First line should be in imperative mood; try rephrasing (found 'Factory')
src/application/interfaces/read_model_interfaces.py:109 in public function `get_external_api_client`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/interfaces/read_model_interfaces.py:109 in public function `get_external_api_client`:
        D213: Multi-line docstring summary should start at the second line
src/application/interfaces/read_model_interfaces.py:109 in public function `get_external_api_client`:
        D400: First line should end with a period (not 't')
src/application/interfaces/read_model_interfaces.py:109 in public function `get_external_api_client`:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/application/interfaces/read_model_interfaces.py:109 in public function `get_external_api_client`:
        D401: First line should be in imperative mood; try rephrasing (found 'Factory')
src/application/interfaces/read_model_interfaces.py:117 in public function `get_settings_provider`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/interfaces/read_model_interfaces.py:117 in public function `get_settings_provider`:
        D213: Multi-line docstring summary should start at the second line
src/application/interfaces/read_model_interfaces.py:117 in public function `get_settings_provider`:
        D400: First line should end with a period (not 'r')
src/application/interfaces/read_model_interfaces.py:117 in public function `get_settings_provider`:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/application/interfaces/read_model_interfaces.py:117 in public function `get_settings_provider`:
        D401: First line should be in imperative mood; try rephrasing (found 'Factory')
src/application/interfaces/safety_monitor.py:1 at module level:
        D100: Missing docstring in public module
src/application/interfaces/safety_monitor.py:8 in public class `SafetyMonitor`:
        D101: Missing docstring in public class
src/application/interfaces/safety_monitor.py:16 in public method `check_content_safety`:
        D401: First line should be in imperative mood (perhaps 'Check', not 'Checks')
src/application/interfaces/speech_processor.py:1 at module level:
        D100: Missing docstring in public module
src/application/interfaces/speech_processor.py:4 in public class `SpeechProcessor`:
        D101: Missing docstring in public class
src/application/interfaces/speech_processor.py:5 in public method `speech_to_text`:
        D102: Missing docstring in public method
src/application/interfaces/speech_processor.py:7 in public method `text_to_speech`:
        D102: Missing docstring in public method
src/application/interfaces/text_to_speech_service.py:1 at module level:
        D100: Missing docstring in public module
src/application/interfaces/text_to_speech_service.py:5 in public class `TextToSpeechService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/interfaces/text_to_speech_service.py:5 in public class `TextToSpeechService`:
        D400: First line should end with a period (not 's')
src/application/interfaces/text_to_speech_service.py:5 in public class `TextToSpeechService`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/application/interfaces/text_to_speech_service.py:14 in public method `generate_speech`:
        D213: Multi-line docstring summary should start at the second line
src/application/interfaces/text_to_speech_service.py:14 in public method `generate_speech`:
        D400: First line should end with a period (not 't')
src/application/interfaces/text_to_speech_service.py:14 in public method `generate_speech`:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/application/interfaces/text_to_speech_service.py:14 in public method `generate_speech`:
        D413: Missing blank line after last section ('Returns')
src/application/interfaces/text_to_speech_service.py:14 in public method `generate_speech`:
        D407: Missing dashed underline after section ('Returns')
src/application/interfaces/text_to_speech_service.py:14 in public method `generate_speech`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/interfaces/text_to_speech_service.py:27 in public method `list_voices`:
        D213: Multi-line docstring summary should start at the second line
src/application/interfaces/text_to_speech_service.py:27 in public method `list_voices`:
        D400: First line should end with a period (not 's')
src/application/interfaces/text_to_speech_service.py:27 in public method `list_voices`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/application/interfaces/text_to_speech_service.py:27 in public method `list_voices`:
        D413: Missing blank line after last section ('Returns')
src/application/interfaces/text_to_speech_service.py:27 in public method `list_voices`:
        D407: Missing dashed underline after section ('Returns')
src/application/interfaces/text_to_speech_service.py:27 in public method `list_voices`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/interfaces/text_to_speech_service.py:35 in public method `health_check`:
        D213: Multi-line docstring summary should start at the second line
src/application/interfaces/text_to_speech_service.py:35 in public method `health_check`:
        D400: First line should end with a period (not 'y')
src/application/interfaces/text_to_speech_service.py:35 in public method `health_check`:
        D415: First line should end with a period, question mark, or exclamation point (not 'y')
src/application/interfaces/text_to_speech_service.py:35 in public method `health_check`:
        D413: Missing blank line after last section ('Returns')
src/application/interfaces/text_to_speech_service.py:35 in public method `health_check`:
        D407: Missing dashed underline after section ('Returns')
src/application/interfaces/text_to_speech_service.py:35 in public method `health_check`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/interfaces/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/application/interfaces/security/encryption_interfaces.py:1 at module level:
        D100: Missing docstring in public module
src/application/interfaces/security/encryption_interfaces.py:7 in public class `HomomorphicEncryptionService`:
        D101: Missing docstring in public class
src/application/interfaces/security/encryption_interfaces.py:18 in public method `add`:
        D401: First line should be in imperative mood (perhaps 'Perform', not 'Performs')
src/application/interfaces/security/encryption_interfaces.py:22 in public method `multiply`:
        D401: First line should be in imperative mood (perhaps 'Perform', not 'Performs')
src/application/interfaces/security/encryption_interfaces.py:25 in public class `ZeroKnowledgeProofService`:
        D101: Missing docstring in public class
src/application/interfaces/security/encryption_interfaces.py:32 in public method `generate_proof`:
        D401: First line should be in imperative mood (perhaps 'Generate', not 'Generates')
src/application/interfaces/security/encryption_interfaces.py:36 in public method `verify_proof`:
        D401: First line should be in imperative mood (perhaps 'Verify', not 'Verifies')
src/application/interfaces/security/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/application/services/accessibility_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/accessibility_service.py:27 in public class `AccessibilityService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/accessibility_service.py:35 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/accessibility_service.py:35 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/accessibility_service.py:35 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/services/accessibility_service.py:52 in public method `create_accessibility_profile`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/accessibility_service.py:52 in public method `create_accessibility_profile`:
        D401: First line should be in imperative mood (perhaps 'Create', not 'Creates')
src/application/services/accessibility_service.py:52 in public method `create_accessibility_profile`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/accessibility_service.py:52 in public method `create_accessibility_profile`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/accessibility_service.py:82 in public method `get_accessibility_profile`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/accessibility_service.py:82 in public method `get_accessibility_profile`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/application/services/accessibility_service.py:82 in public method `get_accessibility_profile`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/accessibility_service.py:82 in public method `get_accessibility_profile`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/accessibility_service.py:102 in private method `_get_adaptations`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/accessibility_service.py:102 in private method `_get_adaptations`:
        D401: First line should be in imperative mood (perhaps 'Get', not 'Gets')
src/application/services/accessibility_service.py:102 in private method `_get_adaptations`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/accessibility_service.py:102 in private method `_get_adaptations`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/accessibility_service.py:123 in private method `_get_accessibility_settings`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/accessibility_service.py:123 in private method `_get_accessibility_settings`:
        D401: First line should be in imperative mood (perhaps 'Get', not 'Gets')
src/application/services/accessibility_service.py:123 in private method `_get_accessibility_settings`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/accessibility_service.py:123 in private method `_get_accessibility_settings`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/advanced_personalization_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/advanced_personalization_service.py:28 in public class `AdvancedPersonalizationService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/advanced_personalization_service.py:36 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/advanced_personalization_service.py:36 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/advanced_personalization_service.py:36 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/services/advanced_personalization_service.py:54 in public method `create_personality_profile`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/advanced_personalization_service.py:54 in public method `create_personality_profile`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/advanced_personalization_service.py:54 in public method `create_personality_profile`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/advanced_personalization_service.py:71 in public method `get_personality_profile`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/advanced_personalization_service.py:71 in public method `get_personality_profile`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/application/services/advanced_personalization_service.py:71 in public method `get_personality_profile`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/advanced_personalization_service.py:71 in public method `get_personality_profile`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/advanced_personalization_service.py:91 in public method `get_personalized_content`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/advanced_personalization_service.py:91 in public method `get_personalized_content`:
        D401: First line should be in imperative mood (perhaps 'Get', not 'Gets')
src/application/services/advanced_personalization_service.py:91 in public method `get_personalized_content`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/advanced_personalization_service.py:91 in public method `get_personalized_content`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/advanced_personalization_service.py:140 in private method `_analyze_interactions`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/advanced_personalization_service.py:140 in private method `_analyze_interactions`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/advanced_personalization_service.py:140 in private method `_analyze_interactions`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/advanced_progress_analyzer.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/advanced_progress_analyzer.py:19 in public class `ProgressMetrics`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/advanced_progress_analyzer.py:28 in public class `AdvancedProgressAnalyzer`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/advanced_progress_analyzer.py:31 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/advanced_progress_analyzer.py:40 in public method `analyze_progress`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/advanced_progress_analyzer.py:40 in public method `analyze_progress`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/advanced_progress_analyzer.py:40 in public method `analyze_progress`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/advanced_progress_analyzer.py:67 in public method `get_progress_report`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/advanced_progress_analyzer.py:67 in public method `get_progress_report`:
        D401: First line should be in imperative mood (perhaps 'Generate', not 'Generates')
src/application/services/advanced_progress_analyzer.py:67 in public method `get_progress_report`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/advanced_progress_analyzer.py:67 in public method `get_progress_report`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/advanced_progress_analyzer.py:96 in private method `_calculate_metrics`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/advanced_progress_analyzer.py:96 in private method `_calculate_metrics`:
        D401: First line should be in imperative mood (perhaps 'Calculate', not 'Calculates')
src/application/services/advanced_progress_analyzer.py:96 in private method `_calculate_metrics`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/advanced_progress_analyzer.py:96 in private method `_calculate_metrics`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/ai_orchestration_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/ai_orchestration_service.py:32 in public class `AIOrchestrationService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/ai_orchestration_service.py:41 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/ai_orchestration_service.py:41 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/ai_orchestration_service.py:41 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/services/ai_orchestration_service.py:63 in public method `get_ai_response`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/ai_orchestration_service.py:63 in public method `get_ai_response`:
        D401: First line should be in imperative mood (perhaps 'Generate', not 'Generates')
src/application/services/ai_orchestration_service.py:63 in public method `get_ai_response`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/ai_orchestration_service.py:63 in public method `get_ai_response`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/audio_processing_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/audio_processing_service.py:20 in public class `AudioProcessingService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/audio_processing_service.py:28 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/audio_processing_service.py:28 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/audio_processing_service.py:28 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/services/audio_processing_service.py:45 in public method `process_audio_input`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/audio_processing_service.py:45 in public method `process_audio_input`:
        D401: First line should be in imperative mood (perhaps 'Process', not 'Processes')
src/application/services/audio_processing_service.py:45 in public method `process_audio_input`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/audio_processing_service.py:45 in public method `process_audio_input`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/audio_processing_service.py:60 in public method `generate_audio_response`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/audio_processing_service.py:60 in public method `generate_audio_response`:
        D401: First line should be in imperative mood (perhaps 'Generate', not 'Generates')
src/application/services/audio_processing_service.py:60 in public method `generate_audio_response`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/audio_processing_service.py:60 in public method `generate_audio_response`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/audit_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/audit_service.py:17 in public class `AuditService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/audit_service.py:23 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/audit_service.py:40 in public method `create_audit_log`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/audit_service.py:40 in public method `create_audit_log`:
        D401: First line should be in imperative mood (perhaps 'Create', not 'Creates')
src/application/services/audit_service.py:40 in public method `create_audit_log`:
        D407: Missing dashed underline after section ('Args')
src/application/services/audit_service.py:76 in public method `get_audit_logs`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/audit_service.py:76 in public method `get_audit_logs`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/application/services/audit_service.py:76 in public method `get_audit_logs`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/audit_service.py:76 in public method `get_audit_logs`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/base_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/base_service.py:17 in public class `BaseService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/base_service.py:20 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/base_service.py:25 in public method `initialize`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/base_service.py:25 in public method `initialize`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/base_service.py:33 in public method `cleanup`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/base_service.py:33 in public method `cleanup`:
        D401: First line should be in imperative mood (perhaps 'Clean', not 'Cleans')
src/application/services/base_service.py:40 in public method `log_info`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/base_service.py:40 in public method `log_info`:
        D401: First line should be in imperative mood (perhaps 'Log', not 'Logs')
src/application/services/base_service.py:40 in public method `log_info`:
        D407: Missing dashed underline after section ('Args')
src/application/services/base_service.py:50 in public method `log_error`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/base_service.py:50 in public method `log_error`:
        D401: First line should be in imperative mood (perhaps 'Log', not 'Logs')
src/application/services/base_service.py:50 in public method `log_error`:
        D407: Missing dashed underline after section ('Args')
src/application/services/base_service.py:60 in public method `validate_input`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/base_service.py:60 in public method `validate_input`:
        D401: First line should be in imperative mood (perhaps 'Validate', not 'Validates')
src/application/services/base_service.py:60 in public method `validate_input`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/base_service.py:60 in public method `validate_input`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/cleanup_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/cleanup_service.py:19 in public class `CleanupService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/cleanup_service.py:25 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/cleanup_service.py:39 in private method `_is_safe_path`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/cleanup_service.py:39 in private method `_is_safe_path`:
        D401: First line should be in imperative mood (perhaps 'Validate', not 'Validates')
src/application/services/cleanup_service.py:59 in public method `cleanup_old_data`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/cleanup_service.py:59 in public method `cleanup_old_data`:
        D401: First line should be in imperative mood (perhaps 'Clean', not 'Cleans')
src/application/services/cleanup_service.py:59 in public method `cleanup_old_data`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/cleanup_service.py:59 in public method `cleanup_old_data`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/cleanup_service.py:110 in private method `_cleanup_data_type`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/cleanup_service.py:110 in private method `_cleanup_data_type`:
        D401: First line should be in imperative mood (perhaps 'Perform', not 'Performs')
src/application/services/cleanup_service.py:110 in private method `_cleanup_data_type`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/cleanup_service.py:110 in private method `_cleanup_data_type`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/cleanup_service.py:150 in private method `_simulate_data_cleanup`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/cleanup_service.py:150 in private method `_simulate_data_cleanup`:
        D401: First line should be in imperative mood (perhaps 'Simulate', not 'Simulates')
src/application/services/cleanup_service.py:150 in private method `_simulate_data_cleanup`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/cleanup_service.py:150 in private method `_simulate_data_cleanup`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/content_filter_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/content_filter_service.py:19 in public class `ContentFilterService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/content_filter_service.py:26 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/content_filter_service.py:26 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/content_filter_service.py:26 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/services/content_filter_service.py:38 in public method `filter_content`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/content_filter_service.py:38 in public method `filter_content`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/content_filter_service.py:38 in public method `filter_content`:
        D400: First line should end with a period (not 'e')
src/application/services/content_filter_service.py:38 in public method `filter_content`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/application/services/content_filter_service.py:38 in public method `filter_content`:
        D401: First line should be in imperative mood (perhaps 'Filter', not 'Filters')
src/application/services/content_filter_service.py:38 in public method `filter_content`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/content_filter_service.py:38 in public method `filter_content`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/conversation_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/conversation_service.py:20 in public class `ConversationService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/conversation_service.py:27 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/conversation_service.py:27 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/conversation_service.py:27 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/services/conversation_service.py:42 in public method `start_new_conversation`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/conversation_service.py:42 in public method `start_new_conversation`:
        D401: First line should be in imperative mood (perhaps 'Start', not 'Starts')
src/application/services/conversation_service.py:42 in public method `start_new_conversation`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/conversation_service.py:42 in public method `start_new_conversation`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/conversation_service.py:59 in public method `get_conversation_history`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/conversation_service.py:59 in public method `get_conversation_history`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/application/services/conversation_service.py:59 in public method `get_conversation_history`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/conversation_service.py:59 in public method `get_conversation_history`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/conversation_service.py:71 in private method `_get_conversation_by_id`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/conversation_service.py:71 in private method `_get_conversation_by_id`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/application/services/conversation_service.py:71 in private method `_get_conversation_by_id`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/conversation_service.py:71 in private method `_get_conversation_by_id`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/conversation_service.py:71 in private method `_get_conversation_by_id`:
        D407: Missing dashed underline after section ('Raises')
src/application/services/conversation_service.py:71 in private method `_get_conversation_by_id`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/application/services/conversation_service.py:94 in public method `update_conversation_analysis`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/conversation_service.py:94 in public method `update_conversation_analysis`:
        D401: First line should be in imperative mood (perhaps 'Update', not 'Updates')
src/application/services/conversation_service.py:94 in public method `update_conversation_analysis`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/conversation_service.py:94 in public method `update_conversation_analysis`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/conversation_service.py:115 in public method `update_conversation_summary`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/conversation_service.py:115 in public method `update_conversation_summary`:
        D401: First line should be in imperative mood (perhaps 'Update', not 'Updates')
src/application/services/conversation_service.py:115 in public method `update_conversation_summary`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/conversation_service.py:115 in public method `update_conversation_summary`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/conversation_service.py:136 in public method `add_interaction`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/conversation_service.py:136 in public method `add_interaction`:
        D401: First line should be in imperative mood (perhaps 'Add', not 'Adds')
src/application/services/conversation_service.py:136 in public method `add_interaction`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/conversation_service.py:136 in public method `add_interaction`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/data_export_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/data_export_service.py:30 in public class `DataExportService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/data_export_service.py:37 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/data_export_service.py:37 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/data_export_service.py:37 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/services/data_export_service.py:53 in private method `_sanitize_data_for_export`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/data_export_service.py:53 in private method `_sanitize_data_for_export`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/data_export_service.py:53 in private method `_sanitize_data_for_export`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/data_export_service.py:90 in public method `request_export`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/data_export_service.py:90 in public method `request_export`:
        D401: First line should be in imperative mood (perhaps 'Request', not 'Requests')
src/application/services/data_export_service.py:90 in public method `request_export`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/data_export_service.py:90 in public method `request_export`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/data_export_service.py:126 in public method `get_export_status`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/data_export_service.py:126 in public method `get_export_status`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/application/services/data_export_service.py:126 in public method `get_export_status`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/data_export_service.py:126 in public method `get_export_status`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/data_export_service.py:138 in private method `_validate_export_request`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/data_export_service.py:138 in private method `_validate_export_request`:
        D401: First line should be in imperative mood (perhaps 'Validate', not 'Validates')
src/application/services/data_export_service.py:138 in private method `_validate_export_request`:
        D407: Missing dashed underline after section ('Raises')
src/application/services/data_export_service.py:138 in private method `_validate_export_request`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/application/services/data_export_service.py:163 in private method `_simulate_export`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/data_export_service.py:163 in private method `_simulate_export`:
        D401: First line should be in imperative mood (perhaps 'Simulate', not 'Simulates')
src/application/services/data_export_service.py:163 in private method `_simulate_export`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/data_export_service.py:163 in private method `_simulate_export`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/dynamic_content_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/dynamic_content_service.py:25 in public class `DynamicContentService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/dynamic_content_service.py:32 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/dynamic_content_service.py:32 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/dynamic_content_service.py:32 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/services/dynamic_content_service.py:50 in public method `generate_personalized_story`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/dynamic_content_service.py:50 in public method `generate_personalized_story`:
        D401: First line should be in imperative mood (perhaps 'Generate', not 'Generates')
src/application/services/dynamic_content_service.py:50 in public method `generate_personalized_story`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/dynamic_content_service.py:50 in public method `generate_personalized_story`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/dynamic_content_service.py:101 in public method `generate_educational_content`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/dynamic_content_service.py:101 in public method `generate_educational_content`:
        D401: First line should be in imperative mood (perhaps 'Generate', not 'Generates')
src/application/services/dynamic_content_service.py:101 in public method `generate_educational_content`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/dynamic_content_service.py:101 in public method `generate_educational_content`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/dynamic_content_service.py:149 in public method `get_interactive_activity`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/dynamic_content_service.py:149 in public method `get_interactive_activity`:
        D401: First line should be in imperative mood (perhaps 'Generate', not 'Generates')
src/application/services/dynamic_content_service.py:149 in public method `get_interactive_activity`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/dynamic_content_service.py:149 in public method `get_interactive_activity`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/dynamic_story_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/dynamic_story_service.py:13 in public class `DynamicStoryService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/dynamic_story_service.py:16 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/dynamic_story_service.py:16 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/dynamic_story_service.py:16 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/services/dynamic_story_service.py:32 in public method `generate_story`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/dynamic_story_service.py:32 in public method `generate_story`:
        D401: First line should be in imperative mood (perhaps 'Generate', not 'Generates')
src/application/services/dynamic_story_service.py:32 in public method `generate_story`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/dynamic_story_service.py:32 in public method `generate_story`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/esp32_device_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/esp32_device_service.py:28 in public class `ESP32DeviceService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/esp32_device_service.py:35 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/esp32_device_service.py:35 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/esp32_device_service.py:35 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/services/esp32_device_service.py:47 in public method `process_sensor_reading`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/esp32_device_service.py:47 in public method `process_sensor_reading`:
        D401: First line should be in imperative mood (perhaps 'Process', not 'Processes')
src/application/services/esp32_device_service.py:47 in public method `process_sensor_reading`:
        D407: Missing dashed underline after section ('Args')
src/application/services/esp32_device_service.py:72 in public method `process_voice_command`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/esp32_device_service.py:72 in public method `process_voice_command`:
        D401: First line should be in imperative mood (perhaps 'Process', not 'Processes')
src/application/services/esp32_device_service.py:72 in public method `process_voice_command`:
        D407: Missing dashed underline after section ('Args')
src/application/services/esp32_device_service.py:97 in public method `process_gesture_event`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/esp32_device_service.py:97 in public method `process_gesture_event`:
        D401: First line should be in imperative mood (perhaps 'Process', not 'Processes')
src/application/services/esp32_device_service.py:97 in public method `process_gesture_event`:
        D407: Missing dashed underline after section ('Args')
src/application/services/esp32_device_service.py:125 in public method `process_firmware_update_status`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/esp32_device_service.py:125 in public method `process_firmware_update_status`:
        D401: First line should be in imperative mood (perhaps 'Process', not 'Processes')
src/application/services/esp32_device_service.py:125 in public method `process_firmware_update_status`:
        D407: Missing dashed underline after section ('Args')
src/application/services/esp32_device_service.py:147 in public method `process_device_status`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/esp32_device_service.py:147 in public method `process_device_status`:
        D401: First line should be in imperative mood (perhaps 'Process', not 'Processes')
src/application/services/esp32_device_service.py:147 in public method `process_device_status`:
        D407: Missing dashed underline after section ('Args')
src/application/services/esp32_device_service.py:169 in public method `process_edge_ai_result`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/esp32_device_service.py:169 in public method `process_edge_ai_result`:
        D401: First line should be in imperative mood (perhaps 'Process', not 'Processes')
src/application/services/esp32_device_service.py:169 in public method `process_edge_ai_result`:
        D407: Missing dashed underline after section ('Args')
src/application/services/feature_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/feature_service.py:19 in public class `FeatureType`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/feature_service.py:30 in public class `FeatureService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/feature_service.py:33 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/feature_service.py:58 in public method `enable_feature`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/feature_service.py:58 in public method `enable_feature`:
        D401: First line should be in imperative mood (perhaps 'Enable', not 'Enables')
src/application/services/feature_service.py:58 in public method `enable_feature`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/feature_service.py:58 in public method `enable_feature`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/feature_service.py:115 in public method `disable_feature`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/feature_service.py:115 in public method `disable_feature`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/feature_service.py:115 in public method `disable_feature`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/feature_service.py:148 in public method `get_feature_status`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/feature_service.py:148 in public method `get_feature_status`:
        D401: First line should be in imperative mood (perhaps 'Get', not 'Gets')
src/application/services/feature_service.py:148 in public method `get_feature_status`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/feature_service.py:148 in public method `get_feature_status`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/federated_learning_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/federated_learning_service.py:22 in public class `FederatedLearningService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/federated_learning_service.py:29 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/federated_learning_service.py:29 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/federated_learning_service.py:29 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/services/federated_learning_service.py:44 in private method `_validate_model_update_for_privacy`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/federated_learning_service.py:44 in private method `_validate_model_update_for_privacy`:
        D401: First line should be in imperative mood (perhaps 'Perform', not 'Performs')
src/application/services/federated_learning_service.py:44 in private method `_validate_model_update_for_privacy`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/federated_learning_service.py:44 in private method `_validate_model_update_for_privacy`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/federated_learning_service.py:77 in private method `_initialize_global_model`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/federated_learning_service.py:77 in private method `_initialize_global_model`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/federated_learning_service.py:77 in private method `_initialize_global_model`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/federated_learning_service.py:77 in private method `_initialize_global_model`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/federated_learning_service.py:94 in public method `process_local_model_update`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/federated_learning_service.py:94 in public method `process_local_model_update`:
        D401: First line should be in imperative mood (perhaps 'Process', not 'Processes')
src/application/services/federated_learning_service.py:94 in public method `process_local_model_update`:
        D407: Missing dashed underline after section ('Args')
src/application/services/federated_learning_service.py:120 in private method `_aggregate_model_update`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/federated_learning_service.py:120 in private method `_aggregate_model_update`:
        D401: First line should be in imperative mood (perhaps 'Aggregate', not 'Aggregates')
src/application/services/federated_learning_service.py:120 in private method `_aggregate_model_update`:
        D407: Missing dashed underline after section ('Args')
src/application/services/federated_learning_service.py:138 in public method `get_global_model`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/federated_learning_service.py:138 in public method `get_global_model`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/application/services/federated_learning_service.py:138 in public method `get_global_model`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/federated_learning_service.py:138 in public method `get_global_model`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/incident_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/incident_service.py:14 in public class `IncidentService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/incident_service.py:17 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/incident_service.py:21 in public method `report_incident`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/incident_service.py:21 in public method `report_incident`:
        D401: First line should be in imperative mood (perhaps 'Report', not 'Reports')
src/application/services/incident_service.py:21 in public method `report_incident`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/incident_service.py:21 in public method `report_incident`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/incident_service.py:41 in public method `get_incident`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/incident_service.py:41 in public method `get_incident`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/application/services/incident_service.py:41 in public method `get_incident`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/incident_service.py:41 in public method `get_incident`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/incident_service.py:60 in public method `resolve_incident`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/incident_service.py:60 in public method `resolve_incident`:
        D401: First line should be in imperative mood (perhaps 'Resolve', not 'Resolves')
src/application/services/incident_service.py:60 in public method `resolve_incident`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/incident_service.py:60 in public method `resolve_incident`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/interaction_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/interaction_service.py:30 in public class `InteractionService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/interaction_service.py:40 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/interaction_service.py:40 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/interaction_service.py:40 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/services/interaction_service.py:57 in public method `process`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/interaction_service.py:57 in public method `process`:
        D401: First line should be in imperative mood (perhaps 'Process', not 'Processes')
src/application/services/interaction_service.py:57 in public method `process`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/interaction_service.py:57 in public method `process`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/interaction_service.py:57 in public method `process`:
        D407: Missing dashed underline after section ('Raises')
src/application/services/interaction_service.py:57 in public method `process`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/application/services/interaction_service.py:154 in private method `_sanitize_message`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/interaction_service.py:154 in private method `_sanitize_message`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/interaction_service.py:154 in private method `_sanitize_message`:
        D400: First line should end with a period (not 's')
src/application/services/interaction_service.py:154 in private method `_sanitize_message`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/application/services/interaction_service.py:154 in private method `_sanitize_message`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/interaction_service.py:154 in private method `_sanitize_message`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/interaction_service.py:170 in private method `_check_content_safety`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/interaction_service.py:170 in private method `_check_content_safety`:
        D401: First line should be in imperative mood (perhaps 'Check', not 'Checks')
src/application/services/interaction_service.py:170 in private method `_check_content_safety`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/interaction_service.py:170 in private method `_check_content_safety`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/interaction_service.py:189 in private method `_check_child_age`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/interaction_service.py:189 in private method `_check_child_age`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/interaction_service.py:189 in private method `_check_child_age`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/interaction_service.py:189 in private method `_check_child_age`:
        D407: Missing dashed underline after section ('Raises')
src/application/services/interaction_service.py:189 in private method `_check_child_age`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/application/services/notification_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/notification_service.py:41 in public class `NotificationType`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/notification_service.py:50 in public class `NotificationChannel`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/notification_service.py:59 in public class `NotificationService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/notification_service.py:72 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/notification_service.py:72 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/notification_service.py:72 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/services/notification_service.py:102 in public method `send_notification`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/notification_service.py:102 in public method `send_notification`:
        D401: First line should be in imperative mood (perhaps 'Send', not 'Sends')
src/application/services/notification_service.py:102 in public method `send_notification`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/notification_service.py:102 in public method `send_notification`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/notification_service.py:209 in private method `_send_by_channel`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/notification_service.py:209 in private method `_send_by_channel`:
        D401: First line should be in imperative mood (perhaps 'Send', not 'Sends')
src/application/services/notification_service.py:209 in private method `_send_by_channel`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/notification_service.py:209 in private method `_send_by_channel`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/notification_service.py:269 in public method `get_notification_history`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/notification_service.py:269 in public method `get_notification_history`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/application/services/notification_service.py:269 in public method `get_notification_history`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/notification_service.py:269 in public method `get_notification_history`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/parent_child_verification_service.py:1 at module level:
        D100: Missing docstring in public module
src/application/services/parent_child_verification_service.py:25 in private function `get_verification_service`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/parent_child_verification_service.py:25 in private function `get_verification_service`:
        D401: First line should be in imperative mood; try rephrasing (found 'Factory')
src/application/services/parent_child_verification_service.py:25 in private function `get_verification_service`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/parent_child_verification_service.py:25 in private function `get_verification_service`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/parent_child_verification_service.py:35 in private function `get_relationship_manager`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/parent_child_verification_service.py:35 in private function `get_relationship_manager`:
        D401: First line should be in imperative mood; try rephrasing (found 'Factory')
src/application/services/parent_child_verification_service.py:35 in private function `get_relationship_manager`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/parent_child_verification_service.py:35 in private function `get_relationship_manager`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/safety.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/safety.py:33 in public class `SafetyService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/safety.py:41 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/safety.py:41 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/safety.py:41 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/services/safety.py:56 in private method `_analyze_harmful_content`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/safety.py:56 in private method `_analyze_harmful_content`:
        D407: Missing dashed underline after section ('Args')
src/application/services/safety.py:124 in private method `_analyze_toxicity`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/safety.py:124 in private method `_analyze_toxicity`:
        D407: Missing dashed underline after section ('Args')
src/application/services/safety.py:161 in private method `_analyze_emotional_impact`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/safety.py:161 in private method `_analyze_emotional_impact`:
        D407: Missing dashed underline after section ('Args')
src/application/services/safety.py:200 in private method `_analyze_educational_value`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/safety.py:200 in private method `_analyze_educational_value`:
        D401: First line should be in imperative mood (perhaps 'Evaluate', not 'Evaluates')
src/application/services/safety.py:200 in private method `_analyze_educational_value`:
        D407: Missing dashed underline after section ('Args')
src/application/services/safety.py:240 in private method `_analyze_context`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/safety.py:240 in private method `_analyze_context`:
        D407: Missing dashed underline after section ('Args')
src/application/services/safety.py:275 in public method `analyze_content`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/safety.py:275 in public method `analyze_content`:
        D401: First line should be in imperative mood (perhaps 'Perform', not 'Performs')
src/application/services/safety.py:275 in public method `analyze_content`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/safety.py:275 in public method `analyze_content`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/safety.py:308 in public method `get_metrics`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/safety.py:308 in public method `get_metrics`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/safety.py:308 in public method `get_metrics`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/application/services/safety.py:308 in public method `get_metrics`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/safety.py:308 in public method `get_metrics`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/transcription_models.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/transcription_models.py:16 in public class `TranscriptionResult`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/voice_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/voice_service.py:25 in public class `VoiceService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/voice_service.py:25 in public class `VoiceService`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/voice_service.py:32 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/voice_service.py:32 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/application/services/voice_service.py:32 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/services/voice_service.py:47 in public method `validate_audio_file`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/voice_service.py:47 in public method `validate_audio_file`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/voice_service.py:47 in public method `validate_audio_file`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/voice_service.py:87 in public method `speech_to_text`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/voice_service.py:87 in public method `speech_to_text`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/voice_service.py:87 in public method `speech_to_text`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/voice_service.py:159 in public method `text_to_speech`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/voice_service.py:159 in public method `text_to_speech`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/voice_service.py:159 in public method `text_to_speech`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/ai/main_service.py:1 at module level:
        D100: Missing docstring in public module
src/application/services/ai/main_service.py:25 in public class `AITeddyBearService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/ai/main_service.py:25 in public class `AITeddyBearService`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/ai/main_service.py:25 in public class `AITeddyBearService`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/ai/main_service.py:35 in public method `__init__`:
        D107: Missing docstring in __init__
src/application/services/ai/main_service.py:232 in private method `_analyze_sentiment`:
        D401: First line should be in imperative mood; try rephrasing (found 'Simple')
src/application/services/ai/models.py:1 at module level:
        D100: Missing docstring in public module
src/application/services/ai/utils.py:1 at module level:
        D100: Missing docstring in public module
src/application/services/ai/utils.py:2 in public class `AIServiceUtils`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/ai/utils.py:40 in public method `check_age_appropriateness`:
        D401: First line should be in imperative mood; try rephrasing (found 'Simple')
src/application/services/ai/utils.py:51 in public method `analyze_sentiment`:
        D401: First line should be in imperative mood; try rephrasing (found 'Dummy')
src/application/services/ai/utils.py:82 in public method `clean_content`:
        D401: First line should be in imperative mood; try rephrasing (found 'Basic')
src/application/services/ai/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/application/services/ai/modules/response_generator.py:1 at module level:
        D100: Missing docstring in public module
src/application/services/ai/modules/response_generator.py:23 in public class `ResponseType`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/ai/modules/response_generator.py:32 in public class `ResponseGenerator`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/ai/modules/response_generator.py:32 in public class `ResponseGenerator`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/ai/modules/response_generator.py:32 in public class `ResponseGenerator`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/ai/modules/response_generator.py:36 in public method `__init__`:
        D107: Missing docstring in __init__
src/application/services/ai/modules/response_generator.py:93 in public method `generate_response`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/ai/modules/response_generator.py:93 in public method `generate_response`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/ai/modules/transcription_service.py:1 at module level:
        D100: Missing docstring in public module
src/application/services/ai/modules/transcription_service.py:34 in public class `TranscriptionService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/ai/modules/transcription_service.py:34 in public class `TranscriptionService`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/ai/modules/transcription_service.py:34 in public class `TranscriptionService`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/ai/modules/transcription_service.py:38 in public method `__init__`:
        D107: Missing docstring in __init__
src/application/services/ai/modules/transcription_service.py:87 in public method `transcribe_audio`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/ai/modules/transcription_service.py:87 in public method `transcribe_audio`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/ai/modules/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/application/services/audio/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/application/services/consent/consent_models.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/consent/consent_models.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/consent_models.py:1 at module level:
        D400: First line should end with a period (not 's')
src/application/services/consent/consent_models.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/application/services/consent/consent_models.py:11 in public class `VerificationMethod`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/consent/consent_models.py:22 in public class `VerificationStatus`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/consent/consent_models.py:33 in public class `VerificationAttempt`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/consent/consent_service.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/consent/consent_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/consent_service.py:19 in public class `ConsentService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/consent/consent_service.py:19 in public class `ConsentService`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/consent/consent_service.py:19 in public class `ConsentService`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/consent_service.py:19 in public class `ConsentService`:
        D404: First word of the docstring should not be `This`
src/application/services/consent/consent_service.py:42 in public method `request_consent`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/consent_service.py:42 in public method `request_consent`:
        D413: Missing blank line after last section ('Args')
src/application/services/consent/consent_service.py:42 in public method `request_consent`:
        D407: Missing dashed underline after section ('Args')
src/application/services/consent/consent_service.py:68 in public method `grant_consent`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/consent_service.py:68 in public method `grant_consent`:
        D413: Missing blank line after last section ('Args')
src/application/services/consent/consent_service.py:68 in public method `grant_consent`:
        D407: Missing dashed underline after section ('Args')
src/application/services/consent/consent_service.py:85 in public method `revoke_consent`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/consent_service.py:85 in public method `revoke_consent`:
        D413: Missing blank line after last section ('Args')
src/application/services/consent/consent_service.py:85 in public method `revoke_consent`:
        D407: Missing dashed underline after section ('Args')
src/application/services/consent/consent_service.py:100 in public method `check_consent_status`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/consent_service.py:100 in public method `check_consent_status`:
        D413: Missing blank line after last section ('Args')
src/application/services/consent/consent_service.py:100 in public method `check_consent_status`:
        D407: Missing dashed underline after section ('Args')
src/application/services/consent/consent_service.py:126 in public method `verify_parental_consent`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/consent_service.py:126 in public method `verify_parental_consent`:
        D413: Missing blank line after last section ('Args')
src/application/services/consent/consent_service.py:126 in public method `verify_parental_consent`:
        D407: Missing dashed underline after section ('Args')
src/application/services/consent/consent_service.py:150 in public method `initiate_email_verification`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/consent_service.py:150 in public method `initiate_email_verification`:
        D413: Missing blank line after last section ('Args')
src/application/services/consent/consent_service.py:150 in public method `initiate_email_verification`:
        D407: Missing dashed underline after section ('Args')
src/application/services/consent/consent_service.py:165 in public method `initiate_sms_verification`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/consent_service.py:165 in public method `initiate_sms_verification`:
        D413: Missing blank line after last section ('Args')
src/application/services/consent/consent_service.py:165 in public method `initiate_sms_verification`:
        D407: Missing dashed underline after section ('Args')
src/application/services/consent/consent_service.py:177 in public method `complete_verification`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/consent_service.py:177 in public method `complete_verification`:
        D413: Missing blank line after last section ('Args')
src/application/services/consent/consent_service.py:177 in public method `complete_verification`:
        D407: Missing dashed underline after section ('Args')
src/application/services/consent/consent_service.py:189 in public method `get_consent_audit_trail`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/consent_service.py:189 in public method `get_consent_audit_trail`:
        D413: Missing blank line after last section ('Args')
src/application/services/consent/consent_service.py:189 in public method `get_consent_audit_trail`:
        D407: Missing dashed underline after section ('Args')
src/application/services/consent/verification_service.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/consent/verification_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/verification_service.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/application/services/consent/verification_service.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/application/services/consent/verification_service.py:23 in public class `VerificationService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/consent/verification_service.py:33 in public method `send_email_verification`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/verification_service.py:33 in public method `send_email_verification`:
        D413: Missing blank line after last section ('Args')
src/application/services/consent/verification_service.py:33 in public method `send_email_verification`:
        D407: Missing dashed underline after section ('Args')
src/application/services/consent/verification_service.py:67 in public method `send_sms_verification`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/verification_service.py:67 in public method `send_sms_verification`:
        D413: Missing blank line after last section ('Args')
src/application/services/consent/verification_service.py:67 in public method `send_sms_verification`:
        D407: Missing dashed underline after section ('Args')
src/application/services/consent/verification_service.py:95 in public method `verify_code`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/verification_service.py:95 in public method `verify_code`:
        D413: Missing blank line after last section ('Args')
src/application/services/consent/verification_service.py:95 in public method `verify_code`:
        D407: Missing dashed underline after section ('Args')
src/application/services/consent/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/consent/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/consent/__init__.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/application/services/consent/__init__.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/application/services/coppa/coppa_compliance_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/coppa/coppa_compliance_service.py:29 in public class `COPPAComplianceService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/coppa/coppa_compliance_service.py:29 in public class `COPPAComplianceService`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/coppa/coppa_compliance_service.py:44 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/coppa/coppa_compliance_service.py:44 in public method `__init__`:
        D413: Missing blank line after last section ('Args')
src/application/services/coppa/coppa_compliance_service.py:44 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/services/coppa/coppa_compliance_service.py:57 in public method `validate_child_age`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/coppa/coppa_compliance_service.py:57 in public method `validate_child_age`:
        D413: Missing blank line after last section ('Returns')
src/application/services/coppa/coppa_compliance_service.py:57 in public method `validate_child_age`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/coppa/coppa_compliance_service.py:57 in public method `validate_child_age`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/coppa/coppa_compliance_service.py:103 in private method `_convert_validation_result`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/coppa/coppa_compliance_service.py:225 in public method `create_consent_record`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/coppa/coppa_compliance_service.py:225 in public method `create_consent_record`:
        D413: Missing blank line after last section ('Returns')
src/application/services/coppa/coppa_compliance_service.py:225 in public method `create_consent_record`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/coppa/coppa_compliance_service.py:225 in public method `create_consent_record`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/data_export/formatters.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/data_export/formatters.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/data_export/formatters.py:1 at module level:
        D400: First line should end with a period (not 's')
src/application/services/data_export/formatters.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/application/services/data_export/formatters.py:21 in public class `BaseFormatter`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/data_export/formatters.py:41 in public class `JSONFormatter`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/data_export/formatters.py:67 in private method `_json_serializer`:
        D401: First line should be in imperative mood; try rephrasing (found 'Custom')
src/application/services/data_export/formatters.py:72 in public method `get_file_extension`:
        D102: Missing docstring in public method
src/application/services/data_export/formatters.py:75 in public method `get_mime_type`:
        D102: Missing docstring in public method
src/application/services/data_export/formatters.py:80 in public class `CSVFormatter`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/data_export/formatters.py:140 in public method `get_file_extension`:
        D102: Missing docstring in public method
src/application/services/data_export/formatters.py:143 in public method `get_mime_type`:
        D102: Missing docstring in public method
src/application/services/data_export/formatters.py:148 in public class `XMLFormatter`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/data_export/formatters.py:226 in public method `get_file_extension`:
        D102: Missing docstring in public method
src/application/services/data_export/formatters.py:229 in public method `get_mime_type`:
        D102: Missing docstring in public method
src/application/services/data_export/formatters.py:234 in public class `ArchiveFormatter`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/data_export/formatters.py:300 in public method `get_file_extension`:
        D102: Missing docstring in public method
src/application/services/data_export/formatters.py:303 in public method `get_mime_type`:
        D102: Missing docstring in public method
src/application/services/data_export/formatters.py:308 in public class `FormatterFactory`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/data_export/types.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/data_export/types.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/data_export/types.py:1 at module level:
        D400: First line should end with a period (not 's')
src/application/services/data_export/types.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/application/services/data_export/types.py:11 in public class `ExportFormat`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/data_export/types.py:21 in public class `DataCategory`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/data_export/types.py:34 in public class `ExportStatus`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/data_export/types.py:45 in public class `ExportRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/data_export/types.py:61 in public class `ExportResult`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/data_export/types.py:77 in public class `ExportMetadata`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/session/session_manager.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/session/session_manager.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_manager.py:19 in public class `AsyncSessionManager`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/session/session_manager.py:19 in public class `AsyncSessionManager`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/session/session_manager.py:19 in public class `AsyncSessionManager`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_manager.py:54 in public method `create_session`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_manager.py:54 in public method `create_session`:
        D407: Missing dashed underline after section ('Args')
src/application/services/session/session_manager.py:74 in public method `get_session`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_manager.py:74 in public method `get_session`:
        D407: Missing dashed underline after section ('Args')
src/application/services/session/session_manager.py:103 in public method `update_session`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_manager.py:103 in public method `update_session`:
        D407: Missing dashed underline after section ('Args')
src/application/services/session/session_manager.py:133 in public method `end_session`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_manager.py:133 in public method `end_session`:
        D407: Missing dashed underline after section ('Args')
src/application/services/session/session_manager.py:152 in public method `get_child_sessions`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_manager.py:152 in public method `get_child_sessions`:
        D407: Missing dashed underline after section ('Args')
src/application/services/session/session_manager.py:173 in public method `get_session_stats`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_manager.py:173 in public method `get_session_stats`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/session/session_manager.py:173 in public method `get_session_stats`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/session/session_manager.py:197 in public method `cleanup_expired_sessions`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_manager.py:197 in public method `cleanup_expired_sessions`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/session/session_manager.py:197 in public method `cleanup_expired_sessions`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/session/session_models.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/session/session_models.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_models.py:1 at module level:
        D400: First line should end with a period (not 's')
src/application/services/session/session_models.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/application/services/session/session_models.py:13 in public class `SessionStatus`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/session/session_models.py:23 in public class `AsyncSessionData`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/session/session_models.py:23 in public class `AsyncSessionData`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/session/session_models.py:23 in public class `AsyncSessionData`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_models.py:23 in public class `AsyncSessionData`:
        D400: First line should end with a period (not ':')
src/application/services/session/session_models.py:23 in public class `AsyncSessionData`:
        D415: First line should end with a period, question mark, or exclamation point (not ':')
src/application/services/session/session_models.py:74 in public class `SessionStats`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/session/session_storage.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/session/session_storage.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_storage.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/application/services/session/session_storage.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/application/services/session/session_storage.py:15 in public class `SessionStorage`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/session/session_storage.py:24 in public method `store_session`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_storage.py:24 in public method `store_session`:
        D407: Missing dashed underline after section ('Args')
src/application/services/session/session_storage.py:46 in public method `retrieve_session`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_storage.py:46 in public method `retrieve_session`:
        D407: Missing dashed underline after section ('Args')
src/application/services/session/session_storage.py:58 in public method `remove_session`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_storage.py:58 in public method `remove_session`:
        D407: Missing dashed underline after section ('Args')
src/application/services/session/session_storage.py:87 in public method `get_child_sessions`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_storage.py:87 in public method `get_child_sessions`:
        D407: Missing dashed underline after section ('Args')
src/application/services/session/session_storage.py:107 in public method `cleanup_expired_sessions`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_storage.py:107 in public method `cleanup_expired_sessions`:
        D407: Missing dashed underline after section ('Args')
src/application/services/session/session_storage.py:135 in public method `get_session_count`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_storage.py:135 in public method `get_session_count`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/session/session_storage.py:135 in public method `get_session_count`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/session/session_storage.py:145 in public method `get_active_session_count`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/session_storage.py:145 in public method `get_active_session_count`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/session/session_storage.py:145 in public method `get_active_session_count`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/session/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/session/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/session/__init__.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/application/services/session/__init__.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/application/services/verification/relationship_manager.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/verification/relationship_manager.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/relationship_manager.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/application/services/verification/relationship_manager.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/application/services/verification/relationship_manager.py:22 in public class `RelationshipManager`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/verification/relationship_manager.py:36 in public method `create_relationship`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/relationship_manager.py:36 in public method `create_relationship`:
        D413: Missing blank line after last section ('Args')
src/application/services/verification/relationship_manager.py:36 in public method `create_relationship`:
        D407: Missing dashed underline after section ('Args')
src/application/services/verification/relationship_manager.py:73 in public method `verify_relationship`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/relationship_manager.py:73 in public method `verify_relationship`:
        D413: Missing blank line after last section ('Args')
src/application/services/verification/relationship_manager.py:73 in public method `verify_relationship`:
        D407: Missing dashed underline after section ('Args')
src/application/services/verification/relationship_manager.py:117 in public method `check_relationship_validity`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/relationship_manager.py:117 in public method `check_relationship_validity`:
        D413: Missing blank line after last section ('Args')
src/application/services/verification/relationship_manager.py:117 in public method `check_relationship_validity`:
        D407: Missing dashed underline after section ('Args')
src/application/services/verification/relationship_manager.py:144 in public method `get_parent_children`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/relationship_manager.py:144 in public method `get_parent_children`:
        D413: Missing blank line after last section ('Args')
src/application/services/verification/relationship_manager.py:144 in public method `get_parent_children`:
        D407: Missing dashed underline after section ('Args')
src/application/services/verification/relationship_manager.py:163 in public method `get_child_parents`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/relationship_manager.py:163 in public method `get_child_parents`:
        D413: Missing blank line after last section ('Args')
src/application/services/verification/relationship_manager.py:163 in public method `get_child_parents`:
        D407: Missing dashed underline after section ('Args')
src/application/services/verification/verification_models.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/verification/verification_models.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/verification_models.py:1 at module level:
        D400: First line should end with a period (not 's')
src/application/services/verification/verification_models.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/application/services/verification/verification_models.py:11 in public class `RelationshipStatus`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/verification/verification_models.py:21 in public class `RelationshipType`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/verification/verification_models.py:32 in public class `VerificationRecord`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/verification/verification_models.py:47 in public class `RelationshipRecord`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/verification/verification_service.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/verification/verification_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/verification_service.py:18 in public class `ParentChildVerificationService`:
        D203: 1 blank line required before class docstring (found 0)
src/application/services/verification/verification_service.py:18 in public class `ParentChildVerificationService`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/verification/verification_service.py:18 in public class `ParentChildVerificationService`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/verification_service.py:44 in public method `establish_relationship`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/verification_service.py:44 in public method `establish_relationship`:
        D407: Missing dashed underline after section ('Args')
src/application/services/verification/verification_service.py:85 in public method `verify_parent_child_relationship`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/verification_service.py:85 in public method `verify_parent_child_relationship`:
        D407: Missing dashed underline after section ('Returns')
src/application/services/verification/verification_service.py:85 in public method `verify_parent_child_relationship`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/services/verification/verification_service.py:122 in private method `_perform_strong_verification`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/verification/verification_service.py:122 in private method `_perform_strong_verification`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/verification_service.py:122 in private method `_perform_strong_verification`:
        D401: First line should be in imperative mood (perhaps 'Simulate', not 'Simulates')
src/application/services/verification/verification_service.py:134 in public method `get_parent_children`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/verification_service.py:134 in public method `get_parent_children`:
        D407: Missing dashed underline after section ('Args')
src/application/services/verification/verification_service.py:149 in public method `get_child_guardians`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/verification_service.py:149 in public method `get_child_guardians`:
        D407: Missing dashed underline after section ('Args')
src/application/services/verification/verification_service.py:169 in public method `approve_relationship`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/verification_service.py:169 in public method `approve_relationship`:
        D407: Missing dashed underline after section ('Args')
src/application/services/verification/verification_service.py:198 in private method `_log_access_attempt`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/verification_service.py:198 in private method `_log_access_attempt`:
        D407: Missing dashed underline after section ('Args')
src/application/services/verification/verification_service.py:232 in public method `get_access_audit_trail`:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/verification_service.py:232 in public method `get_access_audit_trail`:
        D407: Missing dashed underline after section ('Args')
src/application/services/verification/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/application/services/verification/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/services/verification/__init__.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/application/services/verification/__init__.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/application/use_cases/generate_ai_response.py:1 at module level:
        D100: Missing docstring in public module
src/application/use_cases/generate_ai_response.py:12 in public class `GenerateAIResponseUseCase`:
        D203: 1 blank line required before class docstring (found 0)
src/application/use_cases/generate_ai_response.py:12 in public class `GenerateAIResponseUseCase`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/use_cases/generate_ai_response.py:12 in public class `GenerateAIResponseUseCase`:
        D213: Multi-line docstring summary should start at the second line
src/application/use_cases/generate_ai_response.py:18 in public method `__init__`:
        D107: Missing docstring in __init__
src/application/use_cases/generate_ai_response.py:28 in public method `execute`:
        D102: Missing docstring in public method
src/application/use_cases/generate_dynamic_story.py:1 at module level:
        D100: Missing docstring in public module
src/application/use_cases/generate_dynamic_story.py:8 in public class `GenerateDynamicStoryUseCase`:
        D203: 1 blank line required before class docstring (found 0)
src/application/use_cases/generate_dynamic_story.py:10 in public method `__init__`:
        D107: Missing docstring in __init__
src/application/use_cases/generate_dynamic_story.py:19 in public method `execute`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/use_cases/generate_dynamic_story.py:19 in public method `execute`:
        D213: Multi-line docstring summary should start at the second line
src/application/use_cases/generate_dynamic_story.py:19 in public method `execute`:
        D400: First line should end with a period (not 's')
src/application/use_cases/generate_dynamic_story.py:19 in public method `execute`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/application/use_cases/manage_child_profile.py:1 at module level:
        D100: Missing docstring in public module
src/application/use_cases/manage_child_profile.py:13 in public class `ManageChildProfileUseCase`:
        D101: Missing docstring in public class
src/application/use_cases/manage_child_profile.py:14 in public method `__init__`:
        D107: Missing docstring in __init__
src/application/use_cases/manage_child_profile.py:24 in public method `create_child_profile`:
        D102: Missing docstring in public method
src/application/use_cases/manage_child_profile.py:41 in public method `get_child_profile`:
        D102: Missing docstring in public method
src/application/use_cases/manage_child_profile.py:52 in public method `update_child_profile`:
        D102: Missing docstring in public method
src/application/use_cases/manage_child_profile.py:71 in public method `delete_child_profile`:
        D102: Missing docstring in public method
src/application/use_cases/process_esp32_audio.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/application/use_cases/process_esp32_audio.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/application/use_cases/process_esp32_audio.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/application/use_cases/process_esp32_audio.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/application/use_cases/process_esp32_audio.py:21 in public class `ProcessESP32AudioUseCase`:
        D203: 1 blank line required before class docstring (found 0)
src/application/use_cases/process_esp32_audio.py:21 in public class `ProcessESP32AudioUseCase`:
        D205: 1 blank line required between summary line and description (found 0)
src/application/use_cases/process_esp32_audio.py:21 in public class `ProcessESP32AudioUseCase`:
        D213: Multi-line docstring summary should start at the second line
src/application/use_cases/process_esp32_audio.py:21 in public class `ProcessESP32AudioUseCase`:
        D407: Missing dashed underline after section ('Attributes')
src/application/use_cases/process_esp32_audio.py:21 in public class `ProcessESP32AudioUseCase`:
        D406: Section name should end with a newline ('Attributes', not 'Attributes:')
src/application/use_cases/process_esp32_audio.py:46 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/application/use_cases/process_esp32_audio.py:46 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/application/use_cases/process_esp32_audio.py:61 in public method `execute`:
        D213: Multi-line docstring summary should start at the second line
src/application/use_cases/process_esp32_audio.py:61 in public method `execute`:
        D407: Missing dashed underline after section ('Returns')
src/application/use_cases/process_esp32_audio.py:61 in public method `execute`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/application/use_cases/process_esp32_audio.py:61 in public method `execute`:
        D407: Missing dashed underline after section ('Raises')
src/application/use_cases/process_esp32_audio.py:61 in public method `execute`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/application/use_cases/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/common/constants.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/common/constants.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/common/constants.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/common/constants.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/common/constants.py:120 in public class `EventStoreType`:
        D101: Missing docstring in public class
src/common/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/common/exceptions/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/common/utils/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/domain/analytics.py:1 at module level:
        D100: Missing docstring in public module
src/domain/analytics.py:25 in public class `ChildAnalytics`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/analytics.py:33 in public method `calculate_emotion_stability`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/analytics.py:33 in public method `calculate_emotion_stability`:
        D213: Multi-line docstring summary should start at the second line
src/domain/analytics.py:33 in public method `calculate_emotion_stability`:
        D400: First line should end with a period (not ')')
src/domain/analytics.py:33 in public method `calculate_emotion_stability`:
        D415: First line should end with a period, question mark, or exclamation point (not ')')
src/domain/analytics.py:69 in public method `get_speech_concerns`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/analytics.py:69 in public method `get_speech_concerns`:
        D213: Multi-line docstring summary should start at the second line
src/domain/analytics.py:69 in public method `get_speech_concerns`:
        D400: First line should end with a period (not 's')
src/domain/analytics.py:69 in public method `get_speech_concerns`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/domain/constants.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/constants.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/contracts.py:1 at module level:
        D100: Missing docstring in public module
src/domain/contracts.py:6 in public class `ContractTest`:
        D101: Missing docstring in public class
src/domain/contracts.py:15 in public class `ContractResult`:
        D101: Missing docstring in public class
src/domain/schemas.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/schemas.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/schemas.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/domain/schemas.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/domain/schemas.py:13 in public class `COPPAViolationType`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/schemas.py:23 in public class `ValidationResult`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/schemas.py:25 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/schemas.py:58 in public function `validate_against_schema`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/schemas.py:58 in public function `validate_against_schema`:
        D213: Multi-line docstring summary should start at the second line
src/domain/schemas.py:301 in private class `ValidationSeverity`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/audio_session.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/audio_session.py:16 in public class `AudioSession`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/entities/audio_session.py:28 in public method `create_new`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/audio_session.py:28 in public method `create_new`:
        D401: First line should be in imperative mood (perhaps 'Create', not 'Creates')
src/domain/entities/audio_session.py:28 in public method `create_new`:
        D407: Missing dashed underline after section ('Returns')
src/domain/entities/audio_session.py:28 in public method `create_new`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/entities/audio_session.py:50 in public method `mark_processed`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/audio_session.py:50 in public method `mark_processed`:
        D401: First line should be in imperative mood (perhaps 'Mark', not 'Marks')
src/domain/entities/audio_session.py:50 in public method `mark_processed`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/child.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/child.py:17 in public class `Child`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/entities/child.py:17 in public class `Child`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/child.py:17 in public class `Child`:
        D407: Missing dashed underline after section ('Attributes')
src/domain/entities/child.py:17 in public class `Child`:
        D406: Section name should end with a newline ('Attributes', not 'Attributes:')
src/domain/entities/child.py:81 in public method `create_new`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/child.py:81 in public method `create_new`:
        D401: First line should be in imperative mood; try rephrasing (found 'Factory')
src/domain/entities/child.py:81 in public method `create_new`:
        D407: Missing dashed underline after section ('Returns')
src/domain/entities/child.py:81 in public method `create_new`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/entities/child.py:102 in public method `update_interaction_time`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/child.py:102 in public method `update_interaction_time`:
        D401: First line should be in imperative mood (perhaps 'Update', not 'Updates')
src/domain/entities/child.py:102 in public method `update_interaction_time`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/child.py:112 in public method `is_interaction_time_exceeded`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/child.py:112 in public method `is_interaction_time_exceeded`:
        D401: First line should be in imperative mood (perhaps 'Check', not 'Checks')
src/domain/entities/child.py:112 in public method `is_interaction_time_exceeded`:
        D407: Missing dashed underline after section ('Returns')
src/domain/entities/child.py:112 in public method `is_interaction_time_exceeded`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/entities/child.py:123 in public method `add_allowed_topic`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/child.py:123 in public method `add_allowed_topic`:
        D401: First line should be in imperative mood (perhaps 'Add', not 'Adds')
src/domain/entities/child.py:123 in public method `add_allowed_topic`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/child.py:133 in public method `add_restricted_topic`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/child.py:133 in public method `add_restricted_topic`:
        D401: First line should be in imperative mood (perhaps 'Add', not 'Adds')
src/domain/entities/child.py:133 in public method `add_restricted_topic`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/child.py:143 in public method `update_parental_controls`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/child.py:143 in public method `update_parental_controls`:
        D401: First line should be in imperative mood (perhaps 'Update', not 'Updates')
src/domain/entities/child.py:143 in public method `update_parental_controls`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/child_profile.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/child_profile.py:22 in public class `ChildProfile`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/entities/child_profile.py:36 in public method `create`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/child_profile.py:36 in public method `create`:
        D401: First line should be in imperative mood; try rephrasing (found 'Factory')
src/domain/entities/child_profile.py:36 in public method `create`:
        D407: Missing dashed underline after section ('Returns')
src/domain/entities/child_profile.py:36 in public method `create`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/entities/child_profile.py:81 in public method `get_uncommitted_events`:
        D401: First line should be in imperative mood (perhaps 'Return', not 'Returns')
src/domain/entities/child_profile.py:85 in public method `clear_uncommitted_events`:
        D401: First line should be in imperative mood (perhaps 'Clear', not 'Clears')
src/domain/entities/child_profile.py:89 in private method `_record_event`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/child_profile.py:89 in private method `_record_event`:
        D401: First line should be in imperative mood (perhaps 'Add', not 'Adds')
src/domain/entities/child_profile.py:89 in private method `_record_event`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/conversation.py:1 at module level:
        D100: Missing docstring in public module
src/domain/entities/conversation.py:17 in public class `InteractionType`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/entities/conversation.py:25 in public class `Conversation`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/entities/conversation.py:43 in public method `create_new`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/conversation.py:43 in public method `create_new`:
        D401: First line should be in imperative mood (perhaps 'Create', not 'Creates')
src/domain/entities/conversation.py:43 in public method `create_new`:
        D413: Missing blank line after last section ('Returns')
src/domain/entities/conversation.py:43 in public method `create_new`:
        D407: Missing dashed underline after section ('Returns')
src/domain/entities/conversation.py:43 in public method `create_new`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/entities/conversation.py:67 in public method `end_conversation`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/conversation.py:67 in public method `end_conversation`:
        D401: First line should be in imperative mood (perhaps 'End', not 'Ends')
src/domain/entities/conversation.py:67 in public method `end_conversation`:
        D413: Missing blank line after last section ('Args')
src/domain/entities/conversation.py:67 in public method `end_conversation`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/conversation.py:80 in public method `is_active`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/conversation.py:80 in public method `is_active`:
        D401: First line should be in imperative mood (perhaps 'Check', not 'Checks')
src/domain/entities/conversation.py:80 in public method `is_active`:
        D413: Missing blank line after last section ('Returns')
src/domain/entities/conversation.py:80 in public method `is_active`:
        D407: Missing dashed underline after section ('Returns')
src/domain/entities/conversation.py:80 in public method `is_active`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/entities/conversation.py:88 in public method `duration_minutes`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/conversation.py:88 in public method `duration_minutes`:
        D401: First line should be in imperative mood (perhaps 'Get', not 'Gets')
src/domain/entities/conversation.py:88 in public method `duration_minutes`:
        D413: Missing blank line after last section ('Returns')
src/domain/entities/conversation.py:88 in public method `duration_minutes`:
        D407: Missing dashed underline after section ('Returns')
src/domain/entities/conversation.py:88 in public method `duration_minutes`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/entities/conversation.py:99 in public method `update_summary`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/conversation.py:99 in public method `update_summary`:
        D401: First line should be in imperative mood (perhaps 'Update', not 'Updates')
src/domain/entities/conversation.py:99 in public method `update_summary`:
        D413: Missing blank line after last section ('Args')
src/domain/entities/conversation.py:99 in public method `update_summary`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/conversation.py:107 in public method `update_analysis`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/conversation.py:107 in public method `update_analysis`:
        D401: First line should be in imperative mood (perhaps 'Update', not 'Updates')
src/domain/entities/conversation.py:107 in public method `update_analysis`:
        D413: Missing blank line after last section ('Args')
src/domain/entities/conversation.py:107 in public method `update_analysis`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/conversation.py:117 in public method `add_interaction`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/conversation.py:117 in public method `add_interaction`:
        D401: First line should be in imperative mood (perhaps 'Add', not 'Adds')
src/domain/entities/conversation.py:117 in public method `add_interaction`:
        D413: Missing blank line after last section ('Args')
src/domain/entities/conversation.py:117 in public method `add_interaction`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/emotion.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/emotion.py:12 in public class `EmotionType`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/entities/encrypted_child.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/encrypted_child.py:19 in public class `EncryptedChild`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/entities/encrypted_child.py:53 in public method `set_emergency_contacts`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/encrypted_child.py:53 in public method `set_emergency_contacts`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/encrypted_child.py:70 in public method `get_emergency_contacts`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/encrypted_child.py:70 in public method `get_emergency_contacts`:
        D407: Missing dashed underline after section ('Returns')
src/domain/entities/encrypted_child.py:70 in public method `get_emergency_contacts`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/entities/encrypted_child.py:84 in public method `set_medical_notes`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/encrypted_child.py:84 in public method `set_medical_notes`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/encrypted_child.py:95 in public method `get_medical_notes`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/encrypted_child.py:95 in public method `get_medical_notes`:
        D407: Missing dashed underline after section ('Returns')
src/domain/entities/encrypted_child.py:95 in public method `get_medical_notes`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/entities/encrypted_child.py:109 in public method `update_interaction_time`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/encrypted_child.py:109 in public method `update_interaction_time`:
        D401: First line should be in imperative mood (perhaps 'Update', not 'Updates')
src/domain/entities/encrypted_child.py:109 in public method `update_interaction_time`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/encrypted_child.py:120 in public method `is_interaction_time_exceeded`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/encrypted_child.py:120 in public method `is_interaction_time_exceeded`:
        D401: First line should be in imperative mood (perhaps 'Check', not 'Checks')
src/domain/entities/encrypted_child.py:120 in public method `is_interaction_time_exceeded`:
        D407: Missing dashed underline after section ('Returns')
src/domain/entities/encrypted_child.py:120 in public method `is_interaction_time_exceeded`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/entities/encrypted_child.py:133 in public method `add_allowed_topic`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/encrypted_child.py:133 in public method `add_allowed_topic`:
        D401: First line should be in imperative mood (perhaps 'Add', not 'Adds')
src/domain/entities/encrypted_child.py:133 in public method `add_allowed_topic`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/encrypted_child.py:144 in public method `add_restricted_topic`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/encrypted_child.py:144 in public method `add_restricted_topic`:
        D401: First line should be in imperative mood (perhaps 'Add', not 'Adds')
src/domain/entities/encrypted_child.py:144 in public method `add_restricted_topic`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/encrypted_child.py:155 in public method `update_parental_controls`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/encrypted_child.py:155 in public method `update_parental_controls`:
        D401: First line should be in imperative mood (perhaps 'Update', not 'Updates')
src/domain/entities/encrypted_child.py:155 in public method `update_parental_controls`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/user.py:1 at module level:
        D100: Missing docstring in public module
src/domain/entities/user.py:4 in public class `User`:
        D101: Missing docstring in public class
src/domain/entities/user.py:5 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/entities/user.py:23 in public method `__repr__`:
        D105: Missing docstring in magic method
src/domain/entities/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/domain/entities/parent_profile/entities.py:1 at module level:
        D400: First line should end with a period (not 'n')
src/domain/entities/parent_profile/entities.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/domain/entities/parent_profile/entities.py:11 in public class `Parent`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/entities/parent_profile/entities.py:11 in public class `Parent`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/entities/parent_profile/entities.py:11 in public class `Parent`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/parent_profile/entities.py:53 in public method `get_full_name`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/entities/parent_profile/entities.py:53 in public method `get_full_name`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/parent_profile/entities.py:90 in public method `add_child`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/parent_profile/entities.py:90 in public method `add_child`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/parent_profile/entities.py:107 in public method `remove_child`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/parent_profile/entities.py:107 in public method `remove_child`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/parent_profile/entities.py:121 in public method `update_preference`:
        D213: Multi-line docstring summary should start at the second line
src/domain/entities/parent_profile/entities.py:121 in public method `update_preference`:
        D407: Missing dashed underline after section ('Args')
src/domain/entities/parent_profile/entities.py:201 in public method `__str__`:
        D401: First line should be in imperative mood; try rephrasing (found 'String')
src/domain/entities/parent_profile/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/domain/entities/voice_games/voice_games_engine.py:1 at module level:
        D100: Missing docstring in public module
src/domain/entities/voice_games/voice_games_engine.py:18 in public class `GameType`:
        D101: Missing docstring in public class
src/domain/entities/voice_games/voice_games_engine.py:25 in public class `GameSession`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/entities/voice_games/voice_games_engine.py:27 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/entities/voice_games/voice_games_engine.py:39 in public class `VoiceGameEngine`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/entities/voice_games/voice_games_engine.py:41 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/entities/voice_games/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/domain/esp32/models.py:1 at module level:
        D100: Missing docstring in public module
src/domain/esp32/models.py:7 in public class `ESP32SensorReading`:
        D101: Missing docstring in public class
src/domain/esp32/models.py:17 in public class `ESP32VoiceCommand`:
        D101: Missing docstring in public class
src/domain/esp32/models.py:25 in public class `ESP32GestureEvent`:
        D101: Missing docstring in public class
src/domain/esp32/models.py:34 in public class `ESP32FirmwareUpdateStatus`:
        D101: Missing docstring in public class
src/domain/esp32/models.py:44 in public class `ESP32DeviceStatus`:
        D101: Missing docstring in public class
src/domain/esp32/models.py:55 in public class `ESP32EdgeAIResult`:
        D101: Missing docstring in public class
src/domain/esp32/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/domain/events/child_profile_updated.py:1 at module level:
        D100: Missing docstring in public module
src/domain/events/child_profile_updated.py:9 in public class `ChildProfileUpdated`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/events/child_registered.py:1 at module level:
        D100: Missing docstring in public module
src/domain/events/child_registered.py:9 in public class `ChildRegistered`:
        D101: Missing docstring in public class
src/domain/events/child_registered.py:16 in public method `create`:
        D102: Missing docstring in public method
src/domain/events/conversation_started.py:12 in public class `ConversationStarted`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/events/conversation_started.py:20 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/events/conversation_updated.py:1 at module level:
        D100: Missing docstring in public module
src/domain/events/conversation_updated.py:8 in public class `ConversationUpdatedEvent`:
        D101: Missing docstring in public class
src/domain/events/domain_events.py:1 at module level:
        D100: Missing docstring in public module
src/domain/events/domain_events.py:7 in public class `DomainEvent`:
        D101: Missing docstring in public class
src/domain/events/domain_events.py:11 in public method `__post_init__`:
        D105: Missing docstring in magic method
src/domain/events/domain_events.py:19 in public method `new_event`:
        D102: Missing docstring in public method
src/domain/events/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/domain/exceptions/base.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/exceptions/base.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/exceptions/base.py:1 at module level:
        D400: First line should end with a period (not 's')
src/domain/exceptions/base.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/domain/exceptions/base.py:13 in public class `TeddyBearException`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/base.py:13 in public class `TeddyBearException`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/exceptions/base.py:13 in public class `TeddyBearException`:
        D213: Multi-line docstring summary should start at the second line
src/domain/exceptions/base.py:25 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/domain/exceptions/base.py:25 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/domain/exceptions/base.py:58 in public class `ParentalConsentRequiredException`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/base.py:58 in public class `ParentalConsentRequiredException`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/exceptions/base.py:58 in public class `ParentalConsentRequiredException`:
        D213: Multi-line docstring summary should start at the second line
src/domain/exceptions/base.py:69 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/domain/exceptions/base.py:69 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/domain/exceptions/base.py:96 in public class `CircuitBreakerOpenException`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/base.py:96 in public class `CircuitBreakerOpenException`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/exceptions/base.py:96 in public class `CircuitBreakerOpenException`:
        D213: Multi-line docstring summary should start at the second line
src/domain/exceptions/base.py:101 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/domain/exceptions/base.py:101 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/domain/exceptions/base.py:127 in public class `StartupValidationException`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/base.py:127 in public class `StartupValidationException`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/exceptions/base.py:127 in public class `StartupValidationException`:
        D213: Multi-line docstring summary should start at the second line
src/domain/exceptions/base.py:133 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/exceptions/base_exceptions.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/exceptions/base_exceptions.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/exceptions/base_exceptions.py:10 in public class `DomainException`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/base_exceptions.py:10 in public class `DomainException`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/exceptions/base_exceptions.py:10 in public class `DomainException`:
        D213: Multi-line docstring summary should start at the second line
src/domain/exceptions/base_exceptions.py:15 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/exceptions/base_exceptions.py:37 in public class `ValidationError`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/base_exceptions.py:39 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/exceptions/base_exceptions.py:57 in public class `AuthorizationError`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/base_exceptions.py:59 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/exceptions/base_exceptions.py:77 in public class `NotFoundError`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/base_exceptions.py:79 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/exceptions/base_exceptions.py:97 in public class `ConflictError`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/base_exceptions.py:99 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/exceptions/child_exceptions.py:7 in public class `ChildNotFoundError`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/child_exceptions.py:7 in public class `ChildNotFoundError`:
        D204: 1 blank line required after class docstring (found 0)
src/domain/exceptions/child_exceptions.py:12 in public class `ChildCreationError`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/child_exceptions.py:12 in public class `ChildCreationError`:
        D204: 1 blank line required after class docstring (found 0)
src/domain/exceptions/child_exceptions.py:17 in public class `ChildAccessDeniedError`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/child_exceptions.py:17 in public class `ChildAccessDeniedError`:
        D204: 1 blank line required after class docstring (found 0)
src/domain/exceptions/child_exceptions.py:22 in public class `InvalidChildAgeError`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/child_exceptions.py:22 in public class `InvalidChildAgeError`:
        D204: 1 blank line required after class docstring (found 0)
src/domain/exceptions/security_exceptions.py:7 in public class `SecurityValidationError`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/security_exceptions.py:7 in public class `SecurityValidationError`:
        D204: 1 blank line required after class docstring (found 0)
src/domain/exceptions/security_exceptions.py:12 in public class `AuthenticationError`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/security_exceptions.py:12 in public class `AuthenticationError`:
        D204: 1 blank line required after class docstring (found 0)
src/domain/exceptions/security_exceptions.py:17 in public class `PermissionDeniedError`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/security_exceptions.py:17 in public class `PermissionDeniedError`:
        D204: 1 blank line required after class docstring (found 0)
src/domain/exceptions/security_exceptions.py:22 in public class `ContentSafetyError`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/exceptions/security_exceptions.py:22 in public class `ContentSafetyError`:
        D204: 1 blank line required after class docstring (found 0)
src/domain/exceptions/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/exceptions/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/accessibility_profile_repository.py:1 at module level:
        D100: Missing docstring in public module
src/domain/interfaces/accessibility_profile_repository.py:8 in public class `IAccessibilityProfileRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/accessibility_profile_repository.py:15 in public method `get_profile_by_child_id`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/domain/interfaces/accessibility_profile_repository.py:19 in public method `save_profile`:
        D401: First line should be in imperative mood (perhaps 'Save', not 'Saves')
src/domain/interfaces/accessibility_profile_repository.py:23 in public method `delete_profile`:
        D401: First line should be in imperative mood (perhaps 'Delete', not 'Deletes')
src/domain/interfaces/accessibility_profile_repository.py:27 in public method `get_all_profiles`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/domain/interfaces/ai_service_interface.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/interfaces/ai_service_interface.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/ai_service_interface.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/domain/interfaces/ai_service_interface.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/domain/interfaces/ai_service_interface.py:11 in public class `AIServiceInterface`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/ai_service_interface.py:20 in public method `generate_response`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/ai_service_interface.py:20 in public method `generate_response`:
        D407: Missing dashed underline after section ('Returns')
src/domain/interfaces/ai_service_interface.py:20 in public method `generate_response`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/interfaces/ai_service_interface.py:34 in public method `assess_content_safety`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/ai_service_interface.py:34 in public method `assess_content_safety`:
        D407: Missing dashed underline after section ('Returns')
src/domain/interfaces/ai_service_interface.py:34 in public method `assess_content_safety`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/interfaces/child_profile_repository.py:1 at module level:
        D100: Missing docstring in public module
src/domain/interfaces/child_profile_repository.py:10 in public class `IChildProfileRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/child_profile_repository.py:14 in public method `get_profile_by_id`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/domain/interfaces/child_profile_repository.py:18 in public method `save_profile`:
        D401: First line should be in imperative mood (perhaps 'Save', not 'Saves')
src/domain/interfaces/child_profile_repository.py:22 in public method `delete_profile`:
        D401: First line should be in imperative mood (perhaps 'Delete', not 'Deletes')
src/domain/interfaces/child_profile_repository.py:26 in public method `get_child_age`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/domain/interfaces/config_interface.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/interfaces/config_interface.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/config_interface.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/domain/interfaces/config_interface.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/domain/interfaces/config_interface.py:10 in public class `ConfigInterface`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/conversation_repository.py:1 at module level:
        D100: Missing docstring in public module
src/domain/interfaces/conversation_repository.py:8 in public class `IConversationRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/conversation_repository.py:12 in public method `save`:
        D401: First line should be in imperative mood (perhaps 'Save', not 'Saves')
src/domain/interfaces/conversation_repository.py:16 in public method `find_by_child_id`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/domain/interfaces/conversation_repository.py:20 in public method `get_by_id`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/domain/interfaces/device_authenticator.py:1 at module level:
        D100: Missing docstring in public module
src/domain/interfaces/device_authenticator.py:5 in public class `IDeviceAuthenticator`:
        D101: Missing docstring in public class
src/domain/interfaces/device_authenticator.py:8 in public method `authenticate_device`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/device_authenticator.py:8 in public method `authenticate_device`:
        D401: First line should be in imperative mood (perhaps 'Authenticate', not 'Authenticates')
src/domain/interfaces/device_authenticator.py:8 in public method `authenticate_device`:
        D407: Missing dashed underline after section ('Returns')
src/domain/interfaces/device_authenticator.py:8 in public method `authenticate_device`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/interfaces/encryption_interface.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/interfaces/encryption_interface.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/encryption_interface.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/domain/interfaces/encryption_interface.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/domain/interfaces/encryption_interface.py:13 in public class `EncryptionServiceInterface`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/encryption_interface.py:13 in public class `EncryptionServiceInterface`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/interfaces/encryption_interface.py:13 in public class `EncryptionServiceInterface`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/encryption_interface.py:20 in public method `encrypt`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/encryption_interface.py:20 in public method `encrypt`:
        D407: Missing dashed underline after section ('Returns')
src/domain/interfaces/encryption_interface.py:20 in public method `encrypt`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/interfaces/encryption_interface.py:32 in public method `decrypt`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/encryption_interface.py:32 in public method `decrypt`:
        D407: Missing dashed underline after section ('Returns')
src/domain/interfaces/encryption_interface.py:32 in public method `decrypt`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/interfaces/encryption_interface.py:44 in public method `is_available`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/encryption_interface.py:44 in public method `is_available`:
        D407: Missing dashed underline after section ('Returns')
src/domain/interfaces/encryption_interface.py:44 in public method `is_available`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/interfaces/encryption_interface.py:53 in public class `SecureFieldInterface`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/encryption_interface.py:53 in public class `SecureFieldInterface`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/interfaces/encryption_interface.py:53 in public class `SecureFieldInterface`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/encryption_interface.py:60 in public method `get_value`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/encryption_interface.py:60 in public method `get_value`:
        D407: Missing dashed underline after section ('Returns')
src/domain/interfaces/encryption_interface.py:60 in public method `get_value`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/interfaces/encryption_interface.py:69 in public method `is_encrypted`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/encryption_interface.py:69 in public method `is_encrypted`:
        D407: Missing dashed underline after section ('Returns')
src/domain/interfaces/encryption_interface.py:69 in public method `is_encrypted`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/interfaces/encryption_interface.py:78 in public method `get_encrypted_representation`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/encryption_interface.py:78 in public method `get_encrypted_representation`:
        D407: Missing dashed underline after section ('Returns')
src/domain/interfaces/encryption_interface.py:78 in public method `get_encrypted_representation`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/interfaces/encryption_interface.py:87 in public class `NullEncryptionService`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/encryption_interface.py:87 in public class `NullEncryptionService`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/interfaces/encryption_interface.py:87 in public class `NullEncryptionService`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/encryption_interface.py:101 in public method `is_available`:
        D401: First line should be in imperative mood; try rephrasing (found 'Always')
src/domain/interfaces/encryption_interface.py:106 in public class `SecureString`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/encryption_interface.py:106 in public class `SecureString`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/interfaces/encryption_interface.py:106 in public class `SecureString`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/encryption_interface.py:112 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/encryption_interface.py:112 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/domain/interfaces/event_bus_interface.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/interfaces/event_bus_interface.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/event_bus_interface.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/domain/interfaces/event_bus_interface.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/domain/interfaces/event_bus_interface.py:11 in public class `EventBusInterface`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/external_service_interfaces.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/interfaces/external_service_interfaces.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/external_service_interfaces.py:12 in public class `IAIService`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/external_service_interfaces.py:30 in public class `INotificationService`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/logging_interface.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/interfaces/logging_interface.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/logging_interface.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/domain/interfaces/logging_interface.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/domain/interfaces/logging_interface.py:13 in public class `LogLevel`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/logging_interface.py:23 in public class `DomainLoggerInterface`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/logging_interface.py:23 in public class `DomainLoggerInterface`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/interfaces/logging_interface.py:23 in public class `DomainLoggerInterface`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/logging_interface.py:36 in public method `log_domain_event`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/logging_interface.py:36 in public method `log_domain_event`:
        D407: Missing dashed underline after section ('Args')
src/domain/interfaces/logging_interface.py:53 in public method `log_business_rule_violation`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/logging_interface.py:53 in public method `log_business_rule_violation`:
        D407: Missing dashed underline after section ('Args')
src/domain/interfaces/logging_interface.py:70 in public method `log_child_safety_event`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/logging_interface.py:70 in public method `log_child_safety_event`:
        D407: Missing dashed underline after section ('Args')
src/domain/interfaces/logging_interface.py:82 in public class `NullDomainLogger`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/logging_interface.py:82 in public class `NullDomainLogger`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/interfaces/logging_interface.py:82 in public class `NullDomainLogger`:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/notification_clients.py:1 at module level:
        D100: Missing docstring in public module
src/domain/interfaces/notification_clients.py:5 in public class `IEmailClient`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/notification_clients.py:8 in public method `send_email`:
        D102: Missing docstring in public method
src/domain/interfaces/notification_clients.py:12 in public class `ISMSClient`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/notification_clients.py:15 in public method `send_sms`:
        D102: Missing docstring in public method
src/domain/interfaces/notification_clients.py:19 in public class `IInAppNotifier`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/notification_clients.py:22 in public method `send_in_app_notification`:
        D102: Missing docstring in public method
src/domain/interfaces/notification_clients.py:31 in public class `IPushNotifier`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/notification_clients.py:34 in public method `send_push_notification`:
        D102: Missing docstring in public method
src/domain/interfaces/notification_repository.py:1 at module level:
        D100: Missing docstring in public module
src/domain/interfaces/notification_repository.py:8 in public class `INotificationRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/notification_repository.py:12 in public method `save_notification`:
        D401: First line should be in imperative mood (perhaps 'Save', not 'Saves')
src/domain/interfaces/notification_repository.py:19 in public method `get_notification_by_id`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/domain/interfaces/notification_repository.py:26 in public method `get_notifications_for_recipient`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/domain/interfaces/notification_repository.py:30 in public method `delete_notification`:
        D401: First line should be in imperative mood (perhaps 'Delete', not 'Deletes')
src/domain/interfaces/personality_profile_repository.py:1 at module level:
        D100: Missing docstring in public module
src/domain/interfaces/personality_profile_repository.py:10 in public class `IPersonalityProfileRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/personality_profile_repository.py:14 in public method `get_profile_by_child_id`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/domain/interfaces/personality_profile_repository.py:18 in public method `save_profile`:
        D401: First line should be in imperative mood (perhaps 'Save', not 'Saves')
src/domain/interfaces/personality_profile_repository.py:22 in public method `delete_profile`:
        D401: First line should be in imperative mood (perhaps 'Delete', not 'Deletes')
src/domain/interfaces/personality_profile_repository.py:26 in public method `get_all_profiles`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/domain/interfaces/repository_interfaces.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/interfaces/repository_interfaces.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/repository_interfaces.py:15 in public class `IChildRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/repository_interfaces.py:39 in public class `IUserRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/sanitization_service.py:1 at module level:
        D100: Missing docstring in public module
src/domain/interfaces/sanitization_service.py:5 in public class `ISanitizationService`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/sanitization_service.py:8 in public method `sanitize_text`:
        D102: Missing docstring in public method
src/domain/interfaces/sanitization_service.py:11 in public method `detect_pii`:
        D102: Missing docstring in public method
src/domain/interfaces/security_interfaces.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/interfaces/security_interfaces.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/interfaces/security_interfaces.py:12 in public class `IEncryptionService`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/security_interfaces.py:32 in public class `ISecurityService`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/session_repository.py:1 at module level:
        D100: Missing docstring in public module
src/domain/interfaces/session_repository.py:9 in public class `ISessionRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/interfaces/session_repository.py:13 in public method `get`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/domain/interfaces/session_repository.py:17 in public method `save`:
        D401: First line should be in imperative mood (perhaps 'Save', not 'Saves')
src/domain/interfaces/session_repository.py:21 in public method `delete`:
        D401: First line should be in imperative mood (perhaps 'Delete', not 'Deletes')
src/domain/interfaces/session_repository.py:25 in public method `delete_expired`:
        D401: First line should be in imperative mood (perhaps 'Delete', not 'Deletes')
src/domain/interfaces/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/interfaces/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/models/consent_models.py:1 at module level:
        D100: Missing docstring in public module
src/domain/models/consent_models.py:7 in public class `ConsentType`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/models/consent_models.py:22 in public class `ConsentStatus`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/models/consent_models.py:33 in public class `ConsentRecord`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/models/consent_models.py:35 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/models/data_retention_models.py:1 at module level:
        D100: Missing docstring in public module
src/domain/models/data_retention_models.py:5 in public class `DataType`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/models/data_retention_models.py:18 in public class `RetentionPolicy`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/models/data_retention_models.py:20 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/repositories/event_store.py:9 in public class `EventStore`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/repositories/event_store.py:33 in public class `InMemoryEventStore`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/repositories/event_store.py:35 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/repositories/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/domain/safety/models.py:13 in public class `RiskLevel`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/safety/models.py:24 in public class `ContentCategory`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/safety/models.py:39 in public class `ToxicityResult`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/safety/models.py:50 in public class `EmotionalImpact`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/safety/models.py:62 in public class `EducationalValue`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/safety/models.py:73 in public class `ContextAnalysis`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/safety/models.py:90 in public class `ContentModification`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/safety/models.py:104 in public class `BiasAnalysis`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/safety/models.py:117 in public class `SafetyAnalysisResult`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/safety/models.py:157 in public class `SafetyConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/safety/models.py:199 in private method `_load_safety_patterns`:
        D213: Multi-line docstring summary should start at the second line
src/domain/safety/models.py:199 in private method `_load_safety_patterns`:
        D407: Missing dashed underline after section ('Returns')
src/domain/safety/models.py:199 in private method `_load_safety_patterns`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/safety/models.py:222 in private method `_load_age_restrictions`:
        D213: Multi-line docstring summary should start at the second line
src/domain/safety/models.py:222 in private method `_load_age_restrictions`:
        D407: Missing dashed underline after section ('Returns')
src/domain/safety/models.py:222 in private method `_load_age_restrictions`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/safety/models.py:326 in private method `_get_age_limits`:
        D213: Multi-line docstring summary should start at the second line
src/domain/safety/models.py:326 in private method `_get_age_limits`:
        D407: Missing dashed underline after section ('Args')
src/domain/safety/models.py:340 in private method `_calculate_risk_score`:
        D213: Multi-line docstring summary should start at the second line
src/domain/safety/models.py:340 in private method `_calculate_risk_score`:
        D407: Missing dashed underline after section ('Args')
src/domain/safety/models.py:360 in private method `_score_to_risk_level`:
        D213: Multi-line docstring summary should start at the second line
src/domain/safety/models.py:360 in private method `_score_to_risk_level`:
        D407: Missing dashed underline after section ('Args')
src/domain/safety/models.py:376 in public class `ProfanityRule`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/safety/models.py:378 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/safety/models.py:404 in public method `check_content`:
        D213: Multi-line docstring summary should start at the second line
src/domain/safety/models.py:404 in public method `check_content`:
        D407: Missing dashed underline after section ('Args')
src/domain/safety/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/domain/safety/bias_detector/bias_detector.py:1 at module level:
        D100: Missing docstring in public module
src/domain/safety/bias_detector/bias_detector.py:8 in public class `AIBiasDetector`:
        D101: Missing docstring in public class
src/domain/safety/bias_detector/bias_detector.py:9 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/safety/bias_detector/bias_detector.py:22 in public method `detect_bias`:
        D102: Missing docstring in public method
src/domain/safety/bias_detector/bias_detector.py:102 in public method `batch_analyze_bias`:
        D102: Missing docstring in public method
src/domain/safety/bias_detector/bias_detector.py:115 in public method `get_bias_statistics`:
        D102: Missing docstring in public method
src/domain/safety/bias_detector/bias_detector.py:118 in public method `generate_bias_report`:
        D102: Missing docstring in public method
src/domain/safety/bias_detector/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/domain/safety/bias_models/bias_models.py:1 at module level:
        D100: Missing docstring in public module
src/domain/safety/bias_models/bias_models.py:5 in public class `ConversationContext`:
        D101: Missing docstring in public class
src/domain/safety/bias_models/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/domain/services/age_filter.py:1 at module level:
        D100: Missing docstring in public module
src/domain/services/age_filter.py:7 in public class `AgeFilter`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/services/age_filter.py:10 in public method `filter_content`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/age_filter.py:10 in public method `filter_content`:
        D413: Missing blank line after last section ('Returns')
src/domain/services/age_filter.py:10 in public method `filter_content`:
        D407: Missing dashed underline after section ('Returns')
src/domain/services/age_filter.py:10 in public method `filter_content`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/services/age_filter.py:22 in public method `is_age_appropriate`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/age_filter.py:22 in public method `is_age_appropriate`:
        D413: Missing blank line after last section ('Returns')
src/domain/services/age_filter.py:22 in public method `is_age_appropriate`:
        D407: Missing dashed underline after section ('Returns')
src/domain/services/age_filter.py:22 in public method `is_age_appropriate`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/services/coppa_age_validation.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/services/coppa_age_validation.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/coppa_age_validation.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/domain/services/coppa_age_validation.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/domain/services/coppa_age_validation.py:11 in public class `AgeValidationResult`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/services/coppa_age_validation.py:22 in public class `COPPAAgeValidator`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/services/coppa_age_validation.py:30 in public method `validate_age`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/coppa_age_validation.py:30 in public method `validate_age`:
        D407: Missing dashed underline after section ('Args')
src/domain/services/coppa_age_validation.py:52 in public method `validate_birthdate`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/coppa_age_validation.py:52 in public method `validate_birthdate`:
        D407: Missing dashed underline after section ('Args')
src/domain/services/coppa_age_validation.py:77 in public method `get_age_from_birthdate`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/coppa_age_validation.py:77 in public method `get_age_from_birthdate`:
        D407: Missing dashed underline after section ('Args')
src/domain/services/coppa_age_validation.py:94 in public method `requires_parental_consent`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/coppa_age_validation.py:94 in public method `requires_parental_consent`:
        D407: Missing dashed underline after section ('Args')
src/domain/services/coppa_age_validation.py:110 in public method `is_coppa_applicable`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/coppa_age_validation.py:110 in public method `is_coppa_applicable`:
        D407: Missing dashed underline after section ('Args')
src/domain/services/coppa_age_validation.py:123 in public method `get_validation_details`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/coppa_age_validation.py:123 in public method `get_validation_details`:
        D407: Missing dashed underline after section ('Args')
src/domain/services/coppa_age_validation.py:182 in public function `validate_child_age`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/coppa_age_validation.py:182 in public function `validate_child_age`:
        D401: First line should be in imperative mood; try rephrasing (found 'Convenience')
src/domain/services/coppa_age_validation.py:182 in public function `validate_child_age`:
        D407: Missing dashed underline after section ('Args')
src/domain/services/coppa_age_validation.py:194 in public function `is_age_coppa_compliant`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/coppa_age_validation.py:194 in public function `is_age_coppa_compliant`:
        D407: Missing dashed underline after section ('Args')
src/domain/services/emotion_analyzer.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/services/emotion_analyzer.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/emotion_analyzer.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/domain/services/emotion_analyzer.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/domain/services/emotion_analyzer.py:12 in public class `EmotionResult`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/services/emotion_analyzer.py:31 in public class `EmotionAnalyzer`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/services/emotion_analyzer.py:52 in public method `analyze_text`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/emotion_analyzer.py:52 in public method `analyze_text`:
        D407: Missing dashed underline after section ('Args')
src/domain/services/emotion_analyzer.py:112 in public method `analyze_voice`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/emotion_analyzer.py:112 in public method `analyze_voice`:
        D407: Missing dashed underline after section ('Args')
src/domain/services/emotion_analyzer.py:161 in public method `get_child_appropriate_emotions`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/emotion_analyzer.py:161 in public method `get_child_appropriate_emotions`:
        D407: Missing dashed underline after section ('Returns')
src/domain/services/emotion_analyzer.py:161 in public method `get_child_appropriate_emotions`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/domain/services/emotion_analyzer.py:181 in public method `is_emotion_positive`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/emotion_analyzer.py:181 in public method `is_emotion_positive`:
        D407: Missing dashed underline after section ('Args')
src/domain/services/emotion_analyzer.py:192 in public method `requires_attention`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/emotion_analyzer.py:192 in public method `requires_attention`:
        D407: Missing dashed underline after section ('Args')
src/domain/services/parental_consent_enforcer.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/services/parental_consent_enforcer.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/parental_consent_enforcer.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/domain/services/parental_consent_enforcer.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/domain/services/parental_consent_enforcer.py:24 in public class `ParentalConsentEnforcer`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/services/parental_consent_enforcer.py:26 in public method `__init__`:
        D107: Missing docstring in __init__
src/domain/services/parental_consent_enforcer.py:60 in public method `get_required_consents`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/parental_consent_enforcer.py:60 in public method `get_required_consents`:
        D407: Missing dashed underline after section ('Args')
src/domain/services/parental_consent_enforcer.py:87 in public method `validate_consent_for_operation`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/parental_consent_enforcer.py:87 in public method `validate_consent_for_operation`:
        D407: Missing dashed underline after section ('Args')
src/domain/services/parental_consent_enforcer.py:142 in public method `validate_all_required_consents`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/parental_consent_enforcer.py:142 in public method `validate_all_required_consents`:
        D407: Missing dashed underline after section ('Args')
src/domain/services/parental_consent_enforcer.py:247 in public method `get_consent_requirements_summary`:
        D213: Multi-line docstring summary should start at the second line
src/domain/services/parental_consent_enforcer.py:247 in public method `get_consent_requirements_summary`:
        D407: Missing dashed underline after section ('Args')
src/domain/services/safety_validator.py:1 at module level:
        D100: Missing docstring in public module
src/domain/services/safety_validator.py:6 in public class `SafetyValidator`:
        D101: Missing docstring in public class
src/domain/services/safety_validator.py:7 in public method `validate_text`:
        D102: Missing docstring in public method
src/domain/services/safety_validator.py:9 in public method `validate_audio`:
        D102: Missing docstring in public method
src/domain/services/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/domain/value_objects/accessibility.py:1 at module level:
        D100: Missing docstring in public module
src/domain/value_objects/accessibility.py:7 in public class `SpecialNeedType`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/value_objects/accessibility.py:20 in public class `AccessibilityProfile`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/value_objects/accessibility.py:20 in public class `AccessibilityProfile`:
        D213: Multi-line docstring summary should start at the second line
src/domain/value_objects/accessibility.py:20 in public class `AccessibilityProfile`:
        D407: Missing dashed underline after section ('Attributes')
src/domain/value_objects/accessibility.py:20 in public class `AccessibilityProfile`:
        D406: Section name should end with a newline ('Attributes', not 'Attributes:')
src/domain/value_objects/child_age.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/value_objects/child_age.py:12 in public class `AgeCategory`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/value_objects/child_age.py:23 in public class `ChildAge`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/value_objects/child_age.py:23 in public class `ChildAge`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/value_objects/child_age.py:23 in public class `ChildAge`:
        D213: Multi-line docstring summary should start at the second line
src/domain/value_objects/child_age.py:23 in public class `ChildAge`:
        D400: First line should end with a period (not 't')
src/domain/value_objects/child_age.py:23 in public class `ChildAge`:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/domain/value_objects/child_age.py:173 in public method `__str__`:
        D105: Missing docstring in magic method
src/domain/value_objects/child_age.py:178 in public method `__repr__`:
        D105: Missing docstring in magic method
src/domain/value_objects/child_name.py:8 in public class `ChildName`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/value_objects/child_name.py:12 in public method `__post_init__`:
        D105: Missing docstring in magic method
src/domain/value_objects/child_preferences.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/value_objects/child_preferences.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/value_objects/child_preferences.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/domain/value_objects/child_preferences.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/domain/value_objects/child_preferences.py:13 in public class `AgeGroup`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/value_objects/child_preferences.py:40 in public class `ChildPreferences`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/value_objects/encrypted_field.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/value_objects/encrypted_field.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/domain/value_objects/encrypted_field.py:1 at module level:
        D400: First line should end with a period (not 'n')
src/domain/value_objects/encrypted_field.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/domain/value_objects/encrypted_field.py:16 in public class `EncryptedField`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/value_objects/encrypted_field.py:16 in public class `EncryptedField`:
        D205: 1 blank line required between summary line and description (found 0)
src/domain/value_objects/encrypted_field.py:16 in public class `EncryptedField`:
        D213: Multi-line docstring summary should start at the second line
src/domain/value_objects/encrypted_field.py:26 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/domain/value_objects/encrypted_field.py:26 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/domain/value_objects/encrypted_field.py:39 in private method `_serialize_and_encrypt`:
        D213: Multi-line docstring summary should start at the second line
src/domain/value_objects/encrypted_field.py:39 in private method `_serialize_and_encrypt`:
        D407: Missing dashed underline after section ('Args')
src/domain/value_objects/encrypted_field.py:76 in private method `_deserialize_value`:
        D213: Multi-line docstring summary should start at the second line
src/domain/value_objects/encrypted_field.py:76 in private method `_deserialize_value`:
        D407: Missing dashed underline after section ('Args')
src/domain/value_objects/encrypted_field.py:105 in public method `from_encrypted_data`:
        D213: Multi-line docstring summary should start at the second line
src/domain/value_objects/encrypted_field.py:105 in public method `from_encrypted_data`:
        D407: Missing dashed underline after section ('Args')
src/domain/value_objects/language.py:1 at module level:
        D100: Missing docstring in public module
src/domain/value_objects/language.py:4 in public class `Language`:
        D101: Missing docstring in public class
src/domain/value_objects/language.py:13 in public method `from_code`:
        D102: Missing docstring in public method
src/domain/value_objects/notification.py:1 at module level:
        D100: Missing docstring in public module
src/domain/value_objects/notification.py:9 in public class `NotificationStatus`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/value_objects/notification.py:21 in public class `NotificationRecord`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/value_objects/personality.py:1 at module level:
        D100: Missing docstring in public module
src/domain/value_objects/personality.py:9 in public class `PersonalityType`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/value_objects/personality.py:22 in public class `ChildPersonality`:
        D203: 1 blank line required before class docstring (found 0)
src/domain/value_objects/personality.py:22 in public class `ChildPersonality`:
        D213: Multi-line docstring summary should start at the second line
src/domain/value_objects/personality.py:22 in public class `ChildPersonality`:
        D407: Missing dashed underline after section ('Attributes')
src/domain/value_objects/personality.py:22 in public class `ChildPersonality`:
        D406: Section name should end with a newline ('Attributes', not 'Attributes:')
src/domain/value_objects/safety_level.py:1 at module level:
        D100: Missing docstring in public module
src/domain/value_objects/safety_level.py:3 in public class `SafetyLevel`:
        D101: Missing docstring in public class
src/domain/value_objects/safety_level.py:13 in public method `create_safe_level`:
        D102: Missing docstring in public method
src/domain/value_objects/safety_level.py:17 in public method `is_safe`:
        D102: Missing docstring in public method
src/domain/value_objects/safety_level.py:22 in public method `level`:
        D102: Missing docstring in public method
src/domain/value_objects/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/app_initializer.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/app_initializer.py:7 in public class `AppInitializer`:
        D101: Missing docstring in public class
src/infrastructure/app_initializer.py:8 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/app_initializer.py:13 in public method `get_settings`:
        D102: Missing docstring in public method
src/infrastructure/app_initializer.py:18 in public method `get_container`:
        D102: Missing docstring in public method
src/infrastructure/app_initializer.py:23 in public method `wire_container`:
        D102: Missing docstring in public method
src/infrastructure/app_initializer.py:26 in public method `get_logger`:
        D102: Missing docstring in public method
src/infrastructure/dependencies.py:12 in public function `Depends`:
        D103: Missing docstring in public function
src/infrastructure/dependencies.py:22 in public function `get_event_store`:
        D103: Missing docstring in public function
src/infrastructure/dependencies.py:27 in public function `get_child_repository`:
        D103: Missing docstring in public function
src/infrastructure/dependencies.py:35 in public class `MockManageChildProfileUseCase`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/dependencies.py:37 in public method `create_child_profile`:
        D102: Missing docstring in public method
src/infrastructure/dependencies.py:50 in public method `get_child_profile`:
        D102: Missing docstring in public method
src/infrastructure/dependencies.py:58 in public method `update_child_profile`:
        D102: Missing docstring in public method
src/infrastructure/dependencies.py:72 in public method `delete_child_profile`:
        D102: Missing docstring in public method
src/infrastructure/dependencies.py:77 in public class `MockGenerateDynamicStoryUseCase`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/dependencies.py:79 in public method `generate_story`:
        D102: Missing docstring in public method
src/infrastructure/exceptions.py:1 at module level:
        D400: First line should end with a period (not 'm')
src/infrastructure/exceptions.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'm')
src/infrastructure/exceptions.py:13 in public class `ErrorCode`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/exceptions.py:13 in public class `ErrorCode`:
        D400: First line should end with a period (not 's')
src/infrastructure/exceptions.py:13 in public class `ErrorCode`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/exceptions.py:48 in public class `BaseApplicationException`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/exceptions.py:50 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/exceptions.py:73 in public class `AuthenticationException`:
        D101: Missing docstring in public class
src/infrastructure/exceptions.py:74 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/exceptions.py:83 in public class `ChildSafetyException`:
        D101: Missing docstring in public class
src/infrastructure/exceptions.py:84 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/exceptions.py:93 in public class `DataValidationException`:
        D101: Missing docstring in public class
src/infrastructure/exceptions.py:94 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/exceptions.py:103 in public class `ResourceNotFoundException`:
        D101: Missing docstring in public class
src/infrastructure/exceptions.py:104 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/exceptions.py:109 in public class `SystemException`:
        D101: Missing docstring in public class
src/infrastructure/exceptions.py:110 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/exceptions.py:119 in public class `ExternalServiceException`:
        D101: Missing docstring in public class
src/infrastructure/exceptions.py:120 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/logging_config.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/logging_config.py:51 in public function `configure_logging`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/logging_config.py:51 in public function `configure_logging`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/logging_config.py:51 in public function `configure_logging`:
        D401: First line should be in imperative mood (perhaps 'Configure', not 'Configures')
src/infrastructure/logging_config.py:51 in public function `configure_logging`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/logging_config.py:145 in public function `get_logger`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/logging_config.py:145 in public function `get_logger`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/infrastructure/logging_config.py:145 in public function `get_logger`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/logging_config.py:145 in public function `get_logger`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/logging_config.py:172 in public function `log_security_event`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/logging_config.py:172 in public function `log_security_event`:
        D401: First line should be in imperative mood (perhaps 'Log', not 'Logs')
src/infrastructure/logging_config.py:172 in public function `log_security_event`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/logging_config.py:197 in public class `ChildSafetyFilter`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/logging_config.py:197 in public class `ChildSafetyFilter`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/logging_config.py:197 in public class `ChildSafetyFilter`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/logging_config.py:203 in public method `filter`:
        D102: Missing docstring in public method
src/infrastructure/logging_config.py:251 in public class `ProductionFormatter`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/logging_config.py:251 in public class `ProductionFormatter`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/logging_config.py:251 in public class `ProductionFormatter`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/logging_config.py:258 in public method `format`:
        D102: Missing docstring in public method
src/infrastructure/logging_config.py:280 in public function `log_child_interaction`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/logging_config.py:280 in public function `log_child_interaction`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/logging_config.py:280 in public function `log_child_interaction`:
        D401: First line should be in imperative mood (perhaps 'Log', not 'Logs')
src/infrastructure/logging_config.py:280 in public function `log_child_interaction`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/adapters/encryption_adapter.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/adapters/encryption_adapter.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/adapters/encryption_adapter.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/infrastructure/adapters/encryption_adapter.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/adapters/encryption_adapter.py:12 in public class `InfrastructureEncryptionAdapter`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/adapters/encryption_adapter.py:12 in public class `InfrastructureEncryptionAdapter`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/adapters/encryption_adapter.py:12 in public class `InfrastructureEncryptionAdapter`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/ai/models.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/ai/models.py:4 in public class `ConversationContext`:
        D101: Missing docstring in public class
src/infrastructure/ai/prompt_builder.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/ai/prompt_builder.py:5 in public class `PromptBuilder`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/ai/prompt_builder.py:13 in public method `build_child_safe_prompt`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/ai/prompt_builder.py:13 in public method `build_child_safe_prompt`:
        D401: First line should be in imperative mood (perhaps 'Construct', not 'Constructs')
src/infrastructure/ai/prompt_builder.py:13 in public method `build_child_safe_prompt`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/ai/prompt_builder.py:13 in public method `build_child_safe_prompt`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/ai/real_ai_service.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/ai/real_ai_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/ai/real_ai_service.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/infrastructure/ai/real_ai_service.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/ai/real_ai_service.py:26 in public class `ProductionAIService`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/ai/real_ai_service.py:26 in public class `ProductionAIService`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/ai/real_ai_service.py:26 in public class `ProductionAIService`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/ai/real_ai_service.py:37 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/ai/safety_analyzer.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/ai/safety_analyzer.py:9 in public class `SafetyAnalyzer`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/ai/safety_analyzer.py:11 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/ai/safety_analyzer.py:48 in public method `analyze_safety`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/ai/safety_analyzer.py:48 in public method `analyze_safety`:
        D401: First line should be in imperative mood (perhaps 'Perform', not 'Performs')
src/infrastructure/ai/safety_analyzer.py:48 in public method `analyze_safety`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/ai/safety_analyzer.py:48 in public method `analyze_safety`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/ai/chatgpt/client.py:1 at module level:
        D400: First line should end with a period (not 's')
src/infrastructure/ai/chatgpt/client.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/ai/chatgpt/client.py:35 in public class `ChatGPTClient`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/ai/chatgpt/client.py:37 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/ai/chatgpt/fallback_responses.py:1 at module level:
        D400: First line should end with a period (not 's')
src/infrastructure/ai/chatgpt/fallback_responses.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/ai/chatgpt/fallback_responses.py:13 in public class `FallbackResponseGenerator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/ai/chatgpt/fallback_responses.py:13 in public class `FallbackResponseGenerator`:
        D400: First line should end with a period (not 'ة')
src/infrastructure/ai/chatgpt/fallback_responses.py:13 in public class `FallbackResponseGenerator`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ة')
src/infrastructure/ai/chatgpt/fallback_responses.py:15 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/ai/chatgpt/fallback_responses.py:111 in public method `generate_fallback_response`:
        D400: First line should end with a period (not 'ة')
src/infrastructure/ai/chatgpt/fallback_responses.py:111 in public method `generate_fallback_response`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ة')
src/infrastructure/ai/chatgpt/fallback_responses.py:144 in public method `generate_safety_redirect_response`:
        D400: First line should end with a period (not 'ن')
src/infrastructure/ai/chatgpt/fallback_responses.py:144 in public method `generate_safety_redirect_response`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ن')
src/infrastructure/ai/chatgpt/fallback_responses.py:177 in public method `generate_encouragement_response`:
        D400: First line should end with a period (not 'ة')
src/infrastructure/ai/chatgpt/fallback_responses.py:177 in public method `generate_encouragement_response`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ة')
src/infrastructure/ai/chatgpt/fallback_responses.py:191 in public method `generate_learning_suggestion`:
        D400: First line should end with a period (not 'ي')
src/infrastructure/ai/chatgpt/fallback_responses.py:191 in public method `generate_learning_suggestion`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ي')
src/infrastructure/ai/chatgpt/fallback_responses.py:207 in public method `get_conversation_starter`:
        D400: First line should end with a period (not 'ة')
src/infrastructure/ai/chatgpt/fallback_responses.py:207 in public method `get_conversation_starter`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ة')
src/infrastructure/ai/chatgpt/response_enhancer.py:1 at module level:
        D400: First line should end with a period (not 't')
src/infrastructure/ai/chatgpt/response_enhancer.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/infrastructure/ai/chatgpt/response_enhancer.py:18 in public class `ResponseEnhancer`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/ai/chatgpt/response_enhancer.py:20 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/ai/chatgpt/response_enhancer.py:80 in private method `_apply_age_specific_enhancements`:
        D400: First line should end with a period (not 'ر')
src/infrastructure/ai/chatgpt/response_enhancer.py:80 in private method `_apply_age_specific_enhancements`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ر')
src/infrastructure/ai/chatgpt/response_enhancer.py:94 in private method `_simplify_language`:
        D400: First line should end with a period (not 'ر')
src/infrastructure/ai/chatgpt/response_enhancer.py:94 in private method `_simplify_language`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ر')
src/infrastructure/ai/chatgpt/response_enhancer.py:130 in private method `_add_repetition`:
        D400: First line should end with a period (not 'ر')
src/infrastructure/ai/chatgpt/response_enhancer.py:130 in private method `_add_repetition`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ر')
src/infrastructure/ai/chatgpt/response_enhancer.py:145 in private method `_add_sound_effects`:
        D400: First line should end with a period (not 'ل')
src/infrastructure/ai/chatgpt/response_enhancer.py:145 in private method `_add_sound_effects`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ل')
src/infrastructure/ai/chatgpt/response_enhancer.py:162 in private method `_add_educational_elements`:
        D400: First line should end with a period (not 'ة')
src/infrastructure/ai/chatgpt/response_enhancer.py:162 in private method `_add_educational_elements`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ة')
src/infrastructure/ai/chatgpt/response_enhancer.py:180 in private method `_add_interactive_elements`:
        D400: First line should end with a period (not 'ة')
src/infrastructure/ai/chatgpt/response_enhancer.py:180 in private method `_add_interactive_elements`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ة')
src/infrastructure/ai/chatgpt/response_enhancer.py:188 in private method `_add_encouragement`:
        D400: First line should end with a period (not 'ع')
src/infrastructure/ai/chatgpt/response_enhancer.py:188 in private method `_add_encouragement`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ع')
src/infrastructure/ai/chatgpt/response_enhancer.py:196 in private method `_add_follow_up_question`:
        D400: First line should end with a period (not 'ة')
src/infrastructure/ai/chatgpt/response_enhancer.py:196 in private method `_add_follow_up_question`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ة')
src/infrastructure/ai/chatgpt/response_enhancer.py:206 in private method `_apply_child_preferences`:
        D400: First line should end with a period (not 'ل')
src/infrastructure/ai/chatgpt/response_enhancer.py:206 in private method `_apply_child_preferences`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ل')
src/infrastructure/ai/chatgpt/response_enhancer.py:228 in public method `detect_emotion`:
        D400: First line should end with a period (not 'ة')
src/infrastructure/ai/chatgpt/response_enhancer.py:228 in public method `detect_emotion`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ة')
src/infrastructure/ai/chatgpt/safety_filter.py:1 at module level:
        D400: First line should end with a period (not 'g')
src/infrastructure/ai/chatgpt/safety_filter.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'g')
src/infrastructure/ai/chatgpt/safety_filter.py:18 in public class `SafetyFilter`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/ai/chatgpt/safety_filter.py:20 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/ai/chatgpt/__init__.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/infrastructure/ai/chatgpt/__init__.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/caching/cache_config.py:1 at module level:
        D400: First line should end with a period (not 's')
src/infrastructure/caching/cache_config.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/caching/cache_config.py:5 in public class `CacheConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/caching/redis_cache.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/caching/redis_cache.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/caching/redis_cache.py:14 in public class `RedisCacheManager`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/caching/redis_cache.py:16 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/caching/__init__.py:1 at module level:
        D400: First line should end with a period (not 's')
src/infrastructure/caching/__init__.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/caching/strategies/invalidation_strategy.py:13 in public class `CacheInvalidationStrategy`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/caching/strategies/invalidation_strategy.py:15 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/chaos/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/chaos/actions/ai.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/chaos/actions/ai.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/chaos/actions/ai.py:1 at module level:
        D400: First line should end with a period (not 's')
src/infrastructure/chaos/actions/ai.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/chaos/actions/ai.py:20 in public class `AIChaosActions`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/chaos/actions/ai_model_recovery_testing.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/chaos/actions/ai_model_recovery_testing.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/chaos/actions/ai_model_recovery_testing.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/chaos/actions/ai_model_recovery_testing.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/chaos/actions/bias_detection_testing.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/chaos/actions/bias_detection_testing.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/chaos/actions/bias_detection_testing.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/chaos/actions/bias_detection_testing.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/chaos/actions/bias_detection_testing.py:16 in public class `BiasDetectionTester`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/chaos/actions/bias_detection_testing.py:18 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/chaos/actions/bias_detection_testing.py:45 in private function `_send_bias_test_prompt`:
        D401: First line should be in imperative mood (perhaps 'Send', not 'Sends')
src/infrastructure/chaos/actions/hallucination_testing.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/chaos/actions/hallucination_testing.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/chaos/actions/hallucination_testing.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/chaos/actions/hallucination_testing.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/chaos/actions/hallucination_testing.py:17 in public class `HallucinationTester`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/chaos/actions/hallucination_testing.py:19 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/chaos/actions/hallucination_testing.py:37 in private function `_send_hallucination_prompt`:
        D401: First line should be in imperative mood (perhaps 'Send', not 'Sends')
src/infrastructure/chaos/actions/load_testing.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/chaos/actions/load_testing.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/chaos/actions/load_testing.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/chaos/actions/load_testing.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/chaos/actions/load_testing.py:21 in private function `_send_load_test_request`:
        D401: First line should be in imperative mood (perhaps 'Send', not 'Sends')
src/infrastructure/chaos/actions/recovery.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/chaos/actions/recovery.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/chaos/actions/recovery.py:1 at module level:
        D400: First line should end with a period (not 's')
src/infrastructure/chaos/actions/recovery.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/chaos/actions/recovery.py:19 in public class `RecoveryActions`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/chaos/actions/recovery.py:21 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/chaos/actions/recovery.py:248 in public function `restart_failed_services`:
        D401: First line should be in imperative mood (perhaps 'Identify', not 'Identifies')
src/infrastructure/chaos/actions/response_consistency_testing.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/chaos/actions/response_consistency_testing.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/chaos/actions/response_consistency_testing.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/chaos/actions/response_consistency_testing.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/chaos/actions/response_consistency_testing.py:16 in private function `_get_consistent_response`:
        D401: First line should be in imperative mood (perhaps 'Send', not 'Sends')
src/infrastructure/chaos/actions/response_consistency_testing.py:31 in private function `_check_response_consistency`:
        D401: First line should be in imperative mood (perhaps 'Check', not 'Checks')
src/infrastructure/chaos/actions/safety.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/chaos/actions/safety.py:1 at module level:
        D400: First line should end with a period (not 's')
src/infrastructure/chaos/actions/safety.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/chaos/actions/safety.py:18 in public class `SafetyChaosActions`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/chaos/actions/safety.py:20 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/chaos/actions/safety.py:45 in private function `_send_toxic_content`:
        D401: First line should be in imperative mood (perhaps 'Send', not 'Sends')
src/infrastructure/chaos/actions/safety.py:142 in private function `_send_bypass_attempt`:
        D401: First line should be in imperative mood (perhaps 'Send', not 'Sends')
src/infrastructure/chaos/actions/safety.py:236 in private function `_send_moderation_request`:
        D401: First line should be in imperative mood (perhaps 'Send', not 'Sends')
src/infrastructure/chaos/actions/safety.py:287 in public function `simulate_content_filter_overload`:
        D401: First line should be in imperative mood (perhaps 'Simulate', not 'Simulates')
src/infrastructure/chaos/actions/safety.py:361 in private function `_send_age_test_case`:
        D401: First line should be in imperative mood (perhaps 'Send', not 'Sends')
src/infrastructure/chaos/actions/safety.py:442 in public function `validate_age_appropriate_responses`:
        D401: First line should be in imperative mood (perhaps 'Validate', not 'Validates')
src/infrastructure/chaos/actions/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/chaos/infrastructure/chaos_injector.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/chaos/infrastructure/chaos_injector.py:20 in public class `ChaosInjector`:
        D101: Missing docstring in public class
src/infrastructure/chaos/infrastructure/chaos_injector.py:21 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/chaos/infrastructure/chaos_monitor.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/chaos/infrastructure/chaos_monitor.py:17 in public class `ChaosMonitor`:
        D101: Missing docstring in public class
src/infrastructure/chaos/infrastructure/chaos_monitor.py:18 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:29 in public class `ExperimentStatus`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:40 in public class `FailureType`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:56 in public class `ChaosTarget`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:68 in public class `ExperimentMetrics`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:82 in public class `ChaosOrchestrator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:82 in public class `ChaosOrchestrator`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:82 in public class `ChaosOrchestrator`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:82 in public class `ChaosOrchestrator`:
        D400: First line should end with a period (not 'r')
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:82 in public class `ChaosOrchestrator`:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/chaos/infrastructure/chaos_orchestrator.py:98 in private method `_setup_chaos_targets`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/infrastructure/chaos/infrastructure/chaos_reporter.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/chaos/infrastructure/chaos_reporter.py:9 in public class `ChaosReporter`:
        D101: Missing docstring in public class
src/infrastructure/chaos/infrastructure/chaos_reporter.py:10 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/chaos/infrastructure/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/chaos/monitoring/chaos_metrics.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/chaos/monitoring/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/chaos/monitoring/chaos_metrics/data_models.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/chaos/monitoring/chaos_metrics/data_models.py:9 in public class `ChaosMetric`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/chaos/monitoring/chaos_metrics/data_models.py:21 in public class `SystemHealthSnapshot`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/chaos/monitoring/chaos_metrics/data_models.py:35 in public class `AlertRule`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/chaos/monitoring/chaos_metrics/data_models.py:46 in public class `ChaosExperimentResult`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/chaos/monitoring/chaos_metrics/metrics_collector.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/chaos/monitoring/chaos_metrics/metrics_collector.py:13 in public class `ChaosMetricsCollector`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/chaos/monitoring/chaos_metrics/metrics_collector.py:15 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/chaos/monitoring/chaos_metrics/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/config/accessibility_config.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/config/accessibility_config.py:6 in public class `AccessibilityConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/accessibility_config.py:6 in public class `AccessibilityConfig`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/accessibility_config.py:6 in public class `AccessibilityConfig`:
        D413: Missing blank line after last section ('Attributes')
src/infrastructure/config/accessibility_config.py:6 in public class `AccessibilityConfig`:
        D407: Missing dashed underline after section ('Attributes')
src/infrastructure/config/accessibility_config.py:6 in public class `AccessibilityConfig`:
        D406: Section name should end with a newline ('Attributes', not 'Attributes:')
src/infrastructure/config/ai_settings.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/config/ai_settings.py:6 in public class `AISettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/application_settings.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/config/application_settings.py:8 in public class `ApplicationSettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/application_settings.py:8 in public class `ApplicationSettings`:
        D300: Use """triple double quotes""" (found '''-quotes)
src/infrastructure/config/audio_settings.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/audio_settings.py:15 in public class `AudioSettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/base_settings.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/config/base_settings.py:6 in public class `BaseApplicationSettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/base_settings.py:6 in public class `BaseApplicationSettings`:
        D300: Use """triple double quotes""" (found '''-quotes)
src/infrastructure/config/content_moderation_settings.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/content_moderation_settings.py:15 in public class `ContentModerationSettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/coppa_config.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/coppa_config.py:19 in public class `COPPAConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/coppa_config.py:22 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/coppa_config.py:22 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/infrastructure/config/coppa_config.py:22 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/config/coppa_config.py:34 in public method `enabled`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/coppa_config.py:34 in public method `enabled`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/config/coppa_config.py:34 in public method `enabled`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/config/coppa_config.py:46 in private method `_initialize`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/infrastructure/config/coppa_config.py:68 in public function `get_coppa_config`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/coppa_config.py:68 in public function `get_coppa_config`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/config/coppa_config.py:68 in public function `get_coppa_config`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/config/coppa_config.py:78 in public function `is_coppa_enabled`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/coppa_config.py:78 in public function `is_coppa_enabled`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/config/coppa_config.py:78 in public function `is_coppa_enabled`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/config/coppa_config.py:78 in public function `is_coppa_enabled`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/config/database_settings.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/database_settings.py:13 in public class `DatabaseSettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/database_settings.py:29 in public method `validate_database_url`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/database_settings.py:29 in public method `validate_database_url`:
        D401: First line should be in imperative mood (perhaps 'Validate', not 'Validates')
src/infrastructure/config/database_settings.py:29 in public method `validate_database_url`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/config/database_settings.py:29 in public method `validate_database_url`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/config/database_settings.py:29 in public method `validate_database_url`:
        D407: Missing dashed underline after section ('Raises')
src/infrastructure/config/database_settings.py:29 in public method `validate_database_url`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/infrastructure/config/env_security.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/env_security.py:22 in public class `EnvVar`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/env_security.py:48 in public class `EnvValue`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/env_security.py:58 in public class `EnvPattern`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/env_security.py:77 in public class `EnvDebugVariant`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/env_security.py:88 in public class `EnvDatabaseType`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/env_security.py:101 in public class `SecureEnvironmentManager`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/env_security.py:104 in public method `__init__`:
        D401: First line should be in imperative mood (perhaps 'Initialize', not 'Initializes')
src/infrastructure/config/env_security.py:111 in private method `_load_environment`:
        D401: First line should be in imperative mood (perhaps 'Load', not 'Loads')
src/infrastructure/config/env_security.py:118 in private method `_is_sensitive`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/env_security.py:118 in private method `_is_sensitive`:
        D401: First line should be in imperative mood (perhaps 'Check', not 'Checks')
src/infrastructure/config/env_security.py:118 in private method `_is_sensitive`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/config/env_security.py:118 in private method `_is_sensitive`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/config/env_security.py:118 in private method `_is_sensitive`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/config/env_security.py:132 in public method `get_env_var`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/env_security.py:132 in public method `get_env_var`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/infrastructure/config/env_security.py:132 in public method `get_env_var`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/config/env_security.py:132 in public method `get_env_var`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/config/env_security.py:132 in public method `get_env_var`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/config/env_security.py:147 in public method `get_masked_env_vars`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/env_security.py:147 in public method `get_masked_env_vars`:
        D401: First line should be in imperative mood (perhaps 'Return', not 'Returns')
src/infrastructure/config/env_security.py:147 in public method `get_masked_env_vars`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/config/env_security.py:147 in public method `get_masked_env_vars`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/config/env_security.py:147 in public method `get_masked_env_vars`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/config/env_security.py:161 in public method `validate_required_env_vars`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/env_security.py:161 in public method `validate_required_env_vars`:
        D401: First line should be in imperative mood (perhaps 'Validate', not 'Validates')
src/infrastructure/config/env_security.py:161 in public method `validate_required_env_vars`:
        D413: Missing blank line after last section ('Raises')
src/infrastructure/config/env_security.py:161 in public method `validate_required_env_vars`:
        D407: Missing dashed underline after section ('Raises')
src/infrastructure/config/env_security.py:161 in public method `validate_required_env_vars`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/infrastructure/config/env_security.py:176 in public method `hash_sensitive_value`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/env_security.py:176 in public method `hash_sensitive_value`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/config/env_security.py:176 in public method `hash_sensitive_value`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/config/env_security.py:176 in public method `hash_sensitive_value`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/config/env_security.py:188 in public method `get_instance`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/env_security.py:188 in public method `get_instance`:
        D401: First line should be in imperative mood (perhaps 'Return', not 'Returns')
src/infrastructure/config/env_security.py:188 in public method `get_instance`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/config/env_security.py:188 in public method `get_instance`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/config/env_security.py:188 in public method `get_instance`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/config/infrastructure_settings.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/infrastructure_settings.py:15 in public class `InfrastructureSettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/infrastructure_settings.py:86 in public method `validate_database_url`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/infrastructure_settings.py:86 in public method `validate_database_url`:
        D401: First line should be in imperative mood (perhaps 'Validate', not 'Validates')
src/infrastructure/config/infrastructure_settings.py:86 in public method `validate_database_url`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/config/infrastructure_settings.py:86 in public method `validate_database_url`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/config/infrastructure_settings.py:86 in public method `validate_database_url`:
        D407: Missing dashed underline after section ('Raises')
src/infrastructure/config/infrastructure_settings.py:86 in public method `validate_database_url`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/infrastructure/config/interaction_config.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/config/interaction_config.py:6 in public class `InteractionConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/kafka_settings.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/config/kafka_settings.py:5 in public class `KafkaSettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/models.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/models.py:13 in public class `AppSettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/notification_config.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/config/notification_config.py:6 in public class `NotificationConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/privacy_settings.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/privacy_settings.py:12 in public class `PrivacySettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/production_settings.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/production_settings.py:34 in public class `ProductionSettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/production_settings.py:84 in public method `create_dirs_if_not_exists`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/production_settings.py:84 in public method `create_dirs_if_not_exists`:
        D401: First line should be in imperative mood (perhaps 'Ensure', not 'Ensures')
src/infrastructure/config/production_settings.py:84 in public method `create_dirs_if_not_exists`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/config/production_settings.py:84 in public method `create_dirs_if_not_exists`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/config/production_settings.py:99 in public method `check_production_env_vars`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/config/production_settings.py:99 in public method `check_production_env_vars`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/production_settings.py:99 in public method `check_production_env_vars`:
        D400: First line should end with a period (not 's')
src/infrastructure/config/production_settings.py:99 in public method `check_production_env_vars`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/config/production_settings.py:99 in public method `check_production_env_vars`:
        D401: First line should be in imperative mood (perhaps 'Perform', not 'Performs')
src/infrastructure/config/production_settings.py:99 in public method `check_production_env_vars`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/config/production_settings.py:99 in public method `check_production_env_vars`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/config/production_settings.py:99 in public method `check_production_env_vars`:
        D407: Missing dashed underline after section ('Raises')
src/infrastructure/config/production_settings.py:99 in public method `check_production_env_vars`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/infrastructure/config/prometheus_settings.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/config/prometheus_settings.py:5 in public class `PrometheusSettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/redis_settings.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/redis_settings.py:13 in public class `RedisSettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/secure_settings.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/secure_settings.py:22 in public class `SecureSettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/secure_settings.py:54 in public method `validate_secrets`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/secure_settings.py:54 in public method `validate_secrets`:
        D401: First line should be in imperative mood (perhaps 'Validate', not 'Validates')
src/infrastructure/config/secure_settings.py:54 in public method `validate_secrets`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/config/secure_settings.py:54 in public method `validate_secrets`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/config/secure_settings.py:54 in public method `validate_secrets`:
        D407: Missing dashed underline after section ('Raises')
src/infrastructure/config/secure_settings.py:54 in public method `validate_secrets`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/infrastructure/config/secure_settings.py:72 in public nested class `Config`:
        D106: Missing docstring in public nested class
src/infrastructure/config/secure_settings.py:79 in public function `generate_new_secret_key`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/secure_settings.py:79 in public function `generate_new_secret_key`:
        D401: First line should be in imperative mood (perhaps 'Generate', not 'Generates')
src/infrastructure/config/secure_settings.py:79 in public function `generate_new_secret_key`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/config/secure_settings.py:79 in public function `generate_new_secret_key`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/config/security_settings.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/config/security_settings.py:1 at module level:
        D212: Multi-line docstring summary should start at the first line
src/infrastructure/config/security_settings.py:1 at module level:
        D400: First line should end with a period (not 'y')
src/infrastructure/config/security_settings.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'y')
src/infrastructure/config/security_settings.py:9 in public class `SecuritySettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/sentry_settings.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/sentry_settings.py:15 in public class `SentrySettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/server_settings.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/server_settings.py:13 in public class `ServerSettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/server_settings.py:65 in public nested class `Config`:
        D106: Missing docstring in public nested class
src/infrastructure/config/session_config.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/config/session_config.py:6 in public class `SessionConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/session_config.py:6 in public class `SessionConfig`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/session_config.py:6 in public class `SessionConfig`:
        D407: Missing dashed underline after section ('Attributes')
src/infrastructure/config/session_config.py:6 in public class `SessionConfig`:
        D406: Section name should end with a newline ('Attributes', not 'Attributes:')
src/infrastructure/config/settings.py:1 at module level:
        D200: One-line docstring should fit on one line with quotes (found 3)
src/infrastructure/config/settings.py:1 at module level:
        D212: Multi-line docstring summary should start at the first line
src/infrastructure/config/settings.py:1 at module level:
        D400: First line should end with a period (not 'y')
src/infrastructure/config/settings.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'y')
src/infrastructure/config/settings.py:26 in public class `Settings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/settings.py:52 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/config/startup_validator.py:18 in public class `StartupValidator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/config/startup_validator.py:20 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/config/startup_validator.py:127 in private method `_validate_database_connection_robust`:
        D401: First line should be in imperative mood (perhaps 'Validate', not 'Validates')
src/infrastructure/config/startup_validator.py:149 in public method `validate_all`:
        D401: First line should be in imperative mood (perhaps 'Run', not 'Runs')
src/infrastructure/config/startup_validator.py:176 in private method `_add_error`:
        D401: First line should be in imperative mood (perhaps 'Add', not 'Adds')
src/infrastructure/config/startup_validator.py:195 in public function `validate_startup`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/config/startup_validator.py:195 in public function `validate_startup`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/config/startup_validator.py:219 in public function `main`:
        D103: Missing docstring in public function
src/infrastructure/config/validators.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/config/validators.py:10 in public class `SettingsValidators`:
        D101: Missing docstring in public class
src/infrastructure/config/voice_settings.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/config/voice_settings.py:6 in public class `VoiceSettings`:
        D101: Missing docstring in public class
src/infrastructure/config/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/container/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/database/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/di/application_container.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/di/application_container.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/di/application_container.py:1 at module level:
        D400: First line should end with a period (not 'n')
src/infrastructure/di/application_container.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/di/application_container.py:19 in public class `IContainer`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/di/application_container.py:34 in public class `ServiceRegistry`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/di/application_container.py:36 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/di/application_container.py:75 in public class `ApplicationContainer`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/di/application_container.py:119 in private method `_create_startup_validator`:
        D401: First line should be in imperative mood; try rephrasing (found 'Factory')
src/infrastructure/di/container.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/di/container.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/di/fastapi_dependencies.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/di/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/di/di_components/service_factory.py:11 in public class `ServiceFactory`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/di/di_components/service_factory.py:13 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/di/di_components/wiring_config.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/di/di_components/wiring_config.py:9 in public class `WiringConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/di/di_components/wiring_config.py:9 in public class `WiringConfig`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/di/di_components/wiring_config.py:22 in public class `FullWiringConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/di/di_components/wiring_config.py:22 in public class `FullWiringConfig`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/di/di_components/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/error_handling/decorators.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/error_handling/decorators.py:18 in public function `handle_errors`:
        D401: First line should be in imperative mood (perhaps 'Map', not 'Maps')
src/infrastructure/error_handling/decorators.py:88 in public function `retry_on_error`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/error_handling/decorators.py:88 in public function `retry_on_error`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/error_handling/decorators.py:88 in public function `retry_on_error`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/error_handling/decorators.py:159 in public function `safe_execution`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/error_handling/decorators.py:159 in public function `safe_execution`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/error_handling/decorators.py:159 in public function `safe_execution`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/error_handling/decorators.py:198 in public function `validate_result`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/error_handling/error_types.py:1 at module level:
        D400: First line should end with a period (not 'y')
src/infrastructure/error_handling/error_types.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'y')
src/infrastructure/error_handling/error_types.py:7 in public class `ErrorType`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/error_handling/error_types.py:7 in public class `ErrorType`:
        D204: 1 blank line required after class docstring (found 0)
src/infrastructure/error_handling/error_types.py:13 in public class `ErrorSeverity`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/error_handling/error_types.py:13 in public class `ErrorSeverity`:
        D204: 1 blank line required after class docstring (found 0)
src/infrastructure/error_handling/error_types.py:21 in public class `BaseApplicationError`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/error_handling/error_types.py:23 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/error_handling/error_types.py:29 in public class `ExternalServiceError`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/error_handling/error_types.py:31 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/error_handling/error_types.py:36 in public class `ErrorContext`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/error_handling/error_types.py:38 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/error_handling/exceptions.py:8 in public class `BaseInfrastructureException`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/error_handling/exceptions.py:10 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/error_handling/exceptions.py:17 in public class `ConfigurationError`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/error_handling/exceptions.py:17 in public class `ConfigurationError`:
        D204: 1 blank line required after class docstring (found 0)
src/infrastructure/error_handling/exceptions.py:22 in public class `DatabaseConnectionError`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/error_handling/exceptions.py:22 in public class `DatabaseConnectionError`:
        D204: 1 blank line required after class docstring (found 0)
src/infrastructure/error_handling/exceptions.py:27 in public class `SecurityError`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/error_handling/exceptions.py:27 in public class `SecurityError`:
        D204: 1 blank line required after class docstring (found 0)
src/infrastructure/error_handling/exceptions.py:32 in public class `RateLimitExceededError`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/error_handling/exceptions.py:32 in public class `RateLimitExceededError`:
        D204: 1 blank line required after class docstring (found 0)
src/infrastructure/error_handling/exceptions.py:71 in public class `AITeddyErrorHandler`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/error_handling/messages.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/error_handling/messages.py:29 in public function `get_error_message`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/infrastructure/exception_handling/enterprise_exception_handler.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/exception_handling/enterprise_exception_handler.py:6 in public class `ExceptionHandlerConfig`:
        D101: Missing docstring in public class
src/infrastructure/exception_handling/enterprise_exception_handler.py:19 in public class `EnterpriseExceptionHandler`:
        D101: Missing docstring in public class
src/infrastructure/exception_handling/enterprise_exception_handler.py:20 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/exception_handling/enterprise_exception_handler.py:23 in public method `handle_exception`:
        D102: Missing docstring in public method
src/infrastructure/exception_handling/enterprise_exception_handler.py:32 in public method `get_circuit_breaker`:
        D102: Missing docstring in public method
src/infrastructure/exception_handling/enterprise_exception_handler.py:36 in public class `MockCircuitBreaker`:
        D101: Missing docstring in public class
src/infrastructure/exception_handling/enterprise_exception_handler.py:37 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/exception_handling/enterprise_exception_handler.py:41 in public method `can_execute`:
        D102: Missing docstring in public method
src/infrastructure/exception_handling/enterprise_exception_handler.py:44 in public method `on_failure`:
        D102: Missing docstring in public method
src/infrastructure/exception_handling/enterprise_exception_handler.py:47 in public method `on_success`:
        D102: Missing docstring in public method
src/infrastructure/exception_handling/enterprise_exception_handler.py:51 in public function `handle_exceptions`:
        D103: Missing docstring in public function
src/infrastructure/exception_handling/enterprise_exception_handler.py:61 in public function `with_retry`:
        D103: Missing docstring in public function
src/infrastructure/exception_handling/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/exception_handling/global_exception_handler/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/external_apis/azure_speech_client.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/external_apis/azure_speech_client.py:4 in public class `AzureSpeechClient`:
        D101: Missing docstring in public class
src/infrastructure/external_apis/azure_speech_client.py:5 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/external_apis/azure_speech_client.py:17 in public method `speech_to_text`:
        D102: Missing docstring in public method
src/infrastructure/external_apis/azure_speech_client.py:30 in public method `text_to_speech`:
        D102: Missing docstring in public method
src/infrastructure/external_apis/chatgpt_client.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/external_apis/chatgpt_client.py:1 at module level:
        D400: First line should end with a period (not 'g')
src/infrastructure/external_apis/chatgpt_client.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'g')
src/infrastructure/external_apis/chatgpt_client.py:26 in public class `ProductionChatGPTClient`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/external_apis/chatgpt_client.py:28 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/external_apis/chatgpt_client.py:91 in public method `get_chat_completion`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/external_apis/chatgpt_client.py:91 in public method `get_chat_completion`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/external_apis/chatgpt_client.py:91 in public method `get_chat_completion`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/external_apis/chatgpt_client.py:91 in public method `get_chat_completion`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/external_apis/chatgpt_client.py:186 in public function `main`:
        D103: Missing docstring in public function
src/infrastructure/external_apis/chatgpt_service.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/external_apis/chatgpt_service.py:21 in public class `ChatGPTService`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/external_apis/chatgpt_service.py:23 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/external_apis/elevenlabs_client.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/external_apis/elevenlabs_client.py:5 in public class `ElevenLabsClient`:
        D101: Missing docstring in public class
src/infrastructure/external_apis/elevenlabs_client.py:6 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/external_apis/elevenlabs_client.py:15 in public method `text_to_speech`:
        D102: Missing docstring in public method
src/infrastructure/external_apis/openai_client.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/external_apis/openai_client.py:20 in public class `OpenAIClient`:
        D101: Missing docstring in public class
src/infrastructure/external_apis/openai_client.py:21 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/external_apis/openai_client.py:24 in public method `generate_response`:
        D102: Missing docstring in public method
src/infrastructure/external_apis/openai_client.py:57 in public method `analyze_sentiment`:
        D102: Missing docstring in public method
src/infrastructure/external_apis/openai_client.py:78 in public method `analyze_emotion`:
        D102: Missing docstring in public method
src/infrastructure/external_apis/whisper_client.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/external_apis/whisper_client.py:5 in public class `WhisperClient`:
        D101: Missing docstring in public class
src/infrastructure/external_apis/whisper_client.py:6 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/external_apis/whisper_client.py:9 in public method `transcribe_audio`:
        D102: Missing docstring in public method
src/infrastructure/external_apis/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/external_services/dummy_notification_clients.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/external_services/dummy_notification_clients.py:15 in public class `DummyEmailClient`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/external_services/dummy_notification_clients.py:17 in public method `send_email`:
        D102: Missing docstring in public method
src/infrastructure/external_services/dummy_notification_clients.py:23 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/external_services/dummy_notification_clients.py:28 in public class `DummySMSClient`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/external_services/dummy_notification_clients.py:30 in public method `send_sms`:
        D102: Missing docstring in public method
src/infrastructure/external_services/dummy_notification_clients.py:36 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/external_services/dummy_notification_clients.py:41 in public class `DummyInAppNotifier`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/external_services/dummy_notification_clients.py:43 in public method `send_in_app_notification`:
        D102: Missing docstring in public method
src/infrastructure/external_services/dummy_notification_clients.py:55 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/external_services/dummy_notification_clients.py:60 in public class `DummyPushNotifier`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/external_services/dummy_notification_clients.py:62 in public method `send_push_notification`:
        D102: Missing docstring in public method
src/infrastructure/external_services/dummy_notification_clients.py:75 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/external_services/dummy_sanitization_service.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/external_services/dummy_sanitization_service.py:8 in public class `DummySanitizationService`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/external_services/dummy_sanitization_service.py:10 in public method `sanitize_text`:
        D102: Missing docstring in public method
src/infrastructure/external_services/dummy_sanitization_service.py:20 in public method `detect_pii`:
        D102: Missing docstring in public method
src/infrastructure/external_services/dummy_sanitization_service.py:32 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/external_services/speech_analysis_base.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/external_services/speech_analysis_base.py:13 in public class `SpeechAnalysisConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/external_services/speech_analysis_base.py:15 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/external_services/speech_analysis_base.py:49 in public class `AudioValidator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/external_services/speech_analysis_base.py:51 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/external_services/speech_analysis_base.py:87 in public class `FeatureExtractor`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/external_services/speech_analysis_base.py:89 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/external_services/speech_disorder_analyzer.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/external_services/speech_disorder_analyzer.py:15 in public class `DisorderAnalyzer`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/external_services/speech_disorder_analyzer.py:17 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/external_services/speech_disorder_detector.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/external_services/speech_disorder_detector.py:20 in public class `SpeechDisorderDetector`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/external_services/speech_disorder_detector.py:22 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/external_services/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/health/checks.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/health/checks.py:17 in public class `DependencyCheck`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/health/health_manager.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/health/health_manager.py:25 in public class `HealthCheckManager`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/health/health_manager.py:27 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/health/models.py:10 in public class `HealthStatus`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/health/models.py:20 in public class `HealthCheckResult`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/health/models.py:32 in public class `SystemHealth`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/health/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/health/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/health/__init__.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/infrastructure/health/__init__.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/health/checks/database_check.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/health/checks/database_check.py:15 in public class `DatabaseHealthCheck`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/health/checks/database_check.py:17 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/health/checks/redis_check.py:16 in public class `RedisHealthCheck`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/health/checks/redis_check.py:18 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/health/checks/system_check.py:16 in public class `SystemHealthCheck`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/logging/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/logging/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/messaging/audio_streamer.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/messaging/audio_streamer.py:10 in public class `AudioStreamer`:
        D101: Missing docstring in public class
src/infrastructure/messaging/audio_streamer.py:11 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/messaging/audio_streamer.py:14 in public method `connect`:
        D102: Missing docstring in public method
src/infrastructure/messaging/audio_streamer.py:18 in public method `disconnect`:
        D102: Missing docstring in public method
src/infrastructure/messaging/audio_streamer.py:21 in public method `stream_audio_to_child`:
        D102: Missing docstring in public method
src/infrastructure/messaging/audio_streamer.py:25 in public method `receive_audio_from_child`:
        D102: Missing docstring in public method
src/infrastructure/messaging/esp32_handler.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/messaging/esp32_handler.py:18 in public function `process_esp32_audio_http`:
        D103: Missing docstring in public function
src/infrastructure/messaging/esp32_handler.py:30 in public function `websocket_endpoint`:
        D103: Missing docstring in public function
src/infrastructure/messaging/event_driven_architecture.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/messaging/event_driven_architecture.py:8 in public class `EventType`:
        D101: Missing docstring in public class
src/infrastructure/messaging/event_driven_architecture.py:15 in public class `EventMetadata`:
        D101: Missing docstring in public class
src/infrastructure/messaging/event_driven_architecture.py:23 in public class `Event`:
        D101: Missing docstring in public class
src/infrastructure/messaging/event_driven_architecture.py:29 in public class `Command`:
        D101: Missing docstring in public class
src/infrastructure/messaging/event_driven_architecture.py:36 in public class `Query`:
        D101: Missing docstring in public class
src/infrastructure/messaging/event_driven_architecture.py:42 in public class `InMemoryCommandBus`:
        D101: Missing docstring in public class
src/infrastructure/messaging/event_driven_architecture.py:43 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/messaging/event_driven_architecture.py:46 in public method `register_handler`:
        D102: Missing docstring in public method
src/infrastructure/messaging/event_driven_architecture.py:49 in public method `send`:
        D102: Missing docstring in public method
src/infrastructure/messaging/event_driven_architecture.py:56 in public class `InMemoryQueryBus`:
        D101: Missing docstring in public class
src/infrastructure/messaging/event_driven_architecture.py:57 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/messaging/event_driven_architecture.py:61 in public method `register_handler`:
        D102: Missing docstring in public method
src/infrastructure/messaging/event_driven_architecture.py:64 in public method `ask`:
        D102: Missing docstring in public method
src/infrastructure/messaging/event_driven_architecture.py:80 in public function `create_event`:
        D103: Missing docstring in public function
src/infrastructure/messaging/event_driven_architecture.py:91 in public function `create_command`:
        D103: Missing docstring in public function
src/infrastructure/messaging/event_driven_architecture.py:95 in public function `create_query`:
        D103: Missing docstring in public function
src/infrastructure/messaging/kafka_event_bus.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/messaging/kafka_event_bus.py:36 in public class `KafkaEventBus`:
        D101: Missing docstring in public class
src/infrastructure/messaging/kafka_event_bus.py:37 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/messaging/kafka_event_bus.py:72 in public method `publish`:
        D400: First line should end with a period (not 'a')
src/infrastructure/messaging/kafka_event_bus.py:72 in public method `publish`:
        D415: First line should end with a period, question mark, or exclamation point (not 'a')
src/infrastructure/messaging/kafka_event_bus.py:111 in public method `subscribe`:
        D102: Missing docstring in public method
src/infrastructure/messaging/kafka_event_bus.py:132 in public method `start_consuming`:
        D102: Missing docstring in public method
src/infrastructure/messaging/kafka_event_bus.py:163 in public method `stop_consuming`:
        D102: Missing docstring in public method
src/infrastructure/messaging/kafka_event_bus.py:185 in public method `__del__`:
        D400: First line should end with a period (not 'd')
src/infrastructure/messaging/kafka_event_bus.py:185 in public method `__del__`:
        D415: First line should end with a period, question mark, or exclamation point (not 'd')
src/infrastructure/messaging/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/middleware/__init__.py:25 in public function `setup_middleware`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/middleware/__init__.py:25 in public function `setup_middleware`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/middleware/__init__.py:25 in public function `setup_middleware`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/infrastructure/middleware/__init__.py:97 in private function `_get_cors_origins`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/middleware/__init__.py:97 in private function `_get_cors_origins`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/middleware/__init__.py:128 in private function `_validate_cors_origins`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/middleware/__init__.py:128 in private function `_validate_cors_origins`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/middleware/__init__.py:149 in private function `_get_trusted_hosts`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/middleware/__init__.py:149 in private function `_get_trusted_hosts`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/middleware/__init__.py:160 in private function `_log_middleware_summary`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/middleware/__init__.py:160 in private function `_log_middleware_summary`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/middleware/security/headers.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/middleware/security/headers.py:24 in public class `SecurityHeadersConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/middleware/security/headers.py:83 in public class `SecurityHeadersMiddleware`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/middleware/security/headers.py:85 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/middleware/security/headers.py:411 in public function `create_security_headers_middleware`:
        D401: First line should be in imperative mood; try rephrasing (found 'Factory')
src/infrastructure/monitoring/comprehensive_monitoring_refactored.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/monitoring/comprehensive_monitoring_refactored.py:10 in public class `ComprehensiveMonitoring`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/monitoring/comprehensive_monitoring_refactored.py:12 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/monitoring/comprehensive_monitoring_refactored.py:26 in public method `log_event`:
        D401: First line should be in imperative mood (perhaps 'Log', not 'Logs')
src/infrastructure/monitoring/comprehensive_monitoring_refactored.py:31 in public method `update_metric`:
        D401: First line should be in imperative mood (perhaps 'Update', not 'Updates')
src/infrastructure/monitoring/comprehensive_monitoring_refactored.py:42 in public method `get_metrics`:
        D401: First line should be in imperative mood (perhaps 'Return', not 'Returns')
src/infrastructure/monitoring/comprehensive_monitoring_refactored.py:46 in public method `monitor_function`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/monitoring/comprehensive_monitoring_refactored.py:66 in public method `monitor_coroutine`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/monitoring/performance_monitor.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/monitoring/performance_monitor.py:20 in public function `monitor_performance`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/monitoring/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/monitoring/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/monitoring/__init__.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/monitoring/__init__.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/monitoring/components/child_safety_monitor.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/monitoring/components/child_safety_monitor.py:14 in public class `ChildSafetyMonitor`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/monitoring/components/monitoring_service.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/monitoring/components/monitoring_service.py:16 in public class `ComprehensiveMonitoringService`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/monitoring/components/monitoring_service.py:16 in public class `ComprehensiveMonitoringService`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/monitoring/components/monitoring_service.py:16 in public class `ComprehensiveMonitoringService`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/monitoring/components/monitoring_service.py:166 in private method `_setup_default_alerts`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/infrastructure/monitoring/components/types.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/monitoring/components/types.py:9 in public class `AlertSeverity`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/monitoring/components/types.py:19 in public class `MetricType`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/monitoring/components/types.py:28 in public class `AlertStatus`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/monitoring/components/types.py:38 in public class `MetricValue`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/monitoring/components/types.py:55 in public class `Alert`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/monitoring/components/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/pagination/pagination_service.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/pagination/pagination_service.py:8 in public class `PaginatedResponse`:
        D101: Missing docstring in public class
src/infrastructure/pagination/pagination_service.py:17 in public class `PaginationService`:
        D101: Missing docstring in public class
src/infrastructure/pagination/pagination_service.py:19 in public method `paginate`:
        D102: Missing docstring in public method
src/infrastructure/pagination/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/performance/batch_loader.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/performance/batch_loader.py:11 in public class `BatchLoader`:
        D101: Missing docstring in public class
src/infrastructure/performance/batch_loader.py:12 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/performance/batch_loader.py:16 in public method `load`:
        D102: Missing docstring in public method
src/infrastructure/performance/batch_loader.py:25 in public method `load_many`:
        D102: Missing docstring in public method
src/infrastructure/performance/batch_loader.py:36 in public function `get_child_batch_loader`:
        D103: Missing docstring in public function
src/infrastructure/performance/caching_decorators.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/performance/caching_decorators.py:14 in public function `cached`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/performance/memoization.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/performance/memoization.py:6 in public function `memoize`:
        D401: First line should be in imperative mood; try rephrasing (found 'A')
src/infrastructure/persistence/child_repository.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/persistence/child_repository.py:6 in public class `ChildRepository`:
        D101: Missing docstring in public class
src/infrastructure/persistence/child_repository.py:8 in public method `add`:
        D102: Missing docstring in public method
src/infrastructure/persistence/child_repository.py:12 in public method `get_by_id`:
        D102: Missing docstring in public method
src/infrastructure/persistence/child_repository.py:16 in public method `get_all`:
        D102: Missing docstring in public method
src/infrastructure/persistence/child_repository.py:20 in public method `update`:
        D102: Missing docstring in public method
src/infrastructure/persistence/child_repository.py:24 in public method `delete`:
        D102: Missing docstring in public method
src/infrastructure/persistence/conversation_repository.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/persistence/conversation_repository.py:15 in public class `ConversationRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/conversation_repository.py:15 in public class `ConversationRepository`:
        D204: 1 blank line required after class docstring (found 0)
src/infrastructure/persistence/conversation_repository.py:25 in public class `AsyncSQLAlchemyConversationRepo`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/conversation_repository.py:28 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/conversation_repository.py:28 in public method `__init__`:
        D413: Missing blank line after last section ('Args')
src/infrastructure/persistence/conversation_repository.py:28 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/persistence/conversation_repository.py:36 in public method `get_by_id`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/conversation_repository.py:36 in public method `get_by_id`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/persistence/conversation_repository.py:36 in public method `get_by_id`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/persistence/conversation_repository.py:36 in public method `get_by_id`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/persistence/conversation_repository.py:57 in public method `get_all`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/conversation_repository.py:57 in public method `get_all`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/persistence/conversation_repository.py:57 in public method `get_all`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/persistence/conversation_repository.py:57 in public method `get_all`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/persistence/conversation_repository.py:71 in public method `create`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/conversation_repository.py:71 in public method `create`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/persistence/conversation_repository.py:71 in public method `create`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/persistence/conversation_repository.py:71 in public method `create`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/persistence/conversation_repository.py:91 in public method `update`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/conversation_repository.py:91 in public method `update`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/persistence/conversation_repository.py:91 in public method `update`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/persistence/conversation_repository.py:91 in public method `update`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/persistence/conversation_repository.py:125 in public method `delete`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/conversation_repository.py:125 in public method `delete`:
        D413: Missing blank line after last section ('Args')
src/infrastructure/persistence/conversation_repository.py:125 in public method `delete`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/persistence/conversation_repository.py:141 in public method `add`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/conversation_repository.py:141 in public method `add`:
        D413: Missing blank line after last section ('Args')
src/infrastructure/persistence/conversation_repository.py:141 in public method `add`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/persistence/conversation_repository.py:149 in public method `get_by_child_id`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/conversation_repository.py:149 in public method `get_by_child_id`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/persistence/conversation_repository.py:149 in public method `get_by_child_id`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/persistence/conversation_repository.py:149 in public method `get_by_child_id`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/persistence/conversation_sqlite_repository.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/persistence/conversation_sqlite_repository.py:24 in public class `ConversationSQLiteRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/conversation_sqlite_repository.py:24 in public class `ConversationSQLiteRepository`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/persistence/conversation_sqlite_repository.py:24 in public class `ConversationSQLiteRepository`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/conversation_sqlite_repository.py:28 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/persistence/conversation_sqlite_repository.py:104 in public method `save_conversation`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/conversation_sqlite_repository.py:104 in public method `save_conversation`:
        D413: Missing blank line after last section ('Args')
src/infrastructure/persistence/conversation_sqlite_repository.py:104 in public method `save_conversation`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/persistence/database_health_check.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/persistence/database_health_check.py:15 in public function `check_database_connection`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/persistence/database_health_check.py:15 in public function `check_database_connection`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/database_health_check.py:15 in public function `check_database_connection`:
        D401: First line should be in imperative mood (perhaps 'Attempt', not 'Attempts')
src/infrastructure/persistence/database_manager.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/persistence/database_manager.py:20 in public class `Database`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/kafka_event_store.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/persistence/kafka_event_store.py:19 in public class `KafkaEventStore`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/kafka_event_store.py:22 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/kafka_event_store.py:22 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/persistence/kafka_event_store.py:81 in public method `save_events`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/kafka_event_store.py:81 in public method `save_events`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/persistence/kafka_event_store.py:143 in public method `load_events`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/kafka_event_store.py:143 in public method `load_events`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/persistence/kafka_event_store.py:200 in public method `load_events_from_offset`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/kafka_event_store.py:200 in public method `load_events_from_offset`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/persistence/kafka_event_store.py:249 in private method `_get_topic_name`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/kafka_event_store.py:249 in private method `_get_topic_name`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/persistence/kafka_event_store.py:263 in private method `_serialize_event`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/kafka_event_store.py:263 in private method `_serialize_event`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/persistence/kafka_event_store.py:291 in private method `_deserialize_event`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/kafka_event_store.py:291 in private method `_deserialize_event`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/persistence/models.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/persistence/model_registry.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/persistence/model_registry.py:14 in public class `ModelRegistry`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/model_registry.py:16 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/persistence/model_registry.py:61 in public function `register_model`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/persistence/model_registry.py:61 in public function `register_model`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/model_registry.py:61 in public function `register_model`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/persistence/postgres_event_store.py:21 in public class `EventModel`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/postgres_event_store.py:53 in public class `PostgresEventStore`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/postgres_event_store.py:55 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/persistence/production_database_config.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/real_database_service.py:22 in public function `get_sql_injection_prevention`:
        D103: Missing docstring in public function
src/infrastructure/persistence/redis_accessibility_profile_repository.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/persistence/redis_accessibility_profile_repository.py:19 in public class `RedisAccessibilityProfileRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/redis_accessibility_profile_repository.py:19 in public class `RedisAccessibilityProfileRepository`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/persistence/redis_accessibility_profile_repository.py:19 in public class `RedisAccessibilityProfileRepository`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/redis_accessibility_profile_repository.py:25 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/persistence/redis_accessibility_profile_repository.py:29 in public method `get_profile_by_child_id`:
        D102: Missing docstring in public method
src/infrastructure/persistence/redis_accessibility_profile_repository.py:76 in public method `save_profile`:
        D102: Missing docstring in public method
src/infrastructure/persistence/redis_accessibility_profile_repository.py:100 in public method `delete_profile`:
        D102: Missing docstring in public method
src/infrastructure/persistence/redis_accessibility_profile_repository.py:120 in public method `get_all_profiles`:
        D102: Missing docstring in public method
src/infrastructure/persistence/redis_notification_repository.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/persistence/redis_notification_repository.py:20 in public class `RedisNotificationRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/redis_notification_repository.py:20 in public class `RedisNotificationRepository`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/persistence/redis_notification_repository.py:20 in public class `RedisNotificationRepository`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/redis_notification_repository.py:27 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/persistence/redis_notification_repository.py:31 in public method `save_notification`:
        D102: Missing docstring in public method
src/infrastructure/persistence/redis_notification_repository.py:74 in public method `get_notification_by_id`:
        D102: Missing docstring in public method
src/infrastructure/persistence/redis_notification_repository.py:119 in public method `get_notifications_for_recipient`:
        D102: Missing docstring in public method
src/infrastructure/persistence/redis_notification_repository.py:143 in public method `delete_notification`:
        D102: Missing docstring in public method
src/infrastructure/persistence/redis_personality_profile_repository.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/persistence/redis_personality_profile_repository.py:20 in public class `RedisPersonalityProfileRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/redis_personality_profile_repository.py:20 in public class `RedisPersonalityProfileRepository`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/persistence/redis_personality_profile_repository.py:20 in public class `RedisPersonalityProfileRepository`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/redis_personality_profile_repository.py:26 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/persistence/redis_personality_profile_repository.py:30 in public method `get_profile_by_child_id`:
        D102: Missing docstring in public method
src/infrastructure/persistence/redis_personality_profile_repository.py:67 in public method `save_profile`:
        D102: Missing docstring in public method
src/infrastructure/persistence/redis_personality_profile_repository.py:92 in public method `delete_profile`:
        D102: Missing docstring in public method
src/infrastructure/persistence/redis_personality_profile_repository.py:112 in public method `get_all_profiles`:
        D102: Missing docstring in public method
src/infrastructure/persistence/redis_session_repository.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/persistence/redis_session_repository.py:15 in public class `RedisSessionRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/redis_session_repository.py:15 in public class `RedisSessionRepository`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/persistence/redis_session_repository.py:15 in public class `RedisSessionRepository`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/redis_session_repository.py:21 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/persistence/redis_session_repository.py:26 in public method `get`:
        D102: Missing docstring in public method
src/infrastructure/persistence/redis_session_repository.py:52 in public method `save`:
        D102: Missing docstring in public method
src/infrastructure/persistence/redis_session_repository.py:79 in public method `delete`:
        D102: Missing docstring in public method
src/infrastructure/persistence/redis_session_repository.py:95 in public method `delete_expired`:
        D102: Missing docstring in public method
src/infrastructure/persistence/repositories.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/repositories.py:15 in public class `DataRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/repositories.py:17 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/persistence/repositories.py:34 in public method `get_data`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/repositories.py:34 in public method `get_data`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/persistence/repositories.py:34 in public method `get_data`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/persistence/repositories.py:34 in public method `get_data`:
        D407: Missing dashed underline after section ('Raises')
src/infrastructure/persistence/repositories.py:34 in public method `get_data`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/infrastructure/persistence/repositories.py:83 in private method `_log_data_access`:
        D401: First line should be in imperative mood (perhaps 'Log', not 'Logs')
src/infrastructure/persistence/repositories.py:95 in private method `_is_valid_child_id`:
        D401: First line should be in imperative mood (perhaps 'Validate', not 'Validates')
src/infrastructure/persistence/repositories.py:99 in private method `_get_child_profile`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/infrastructure/persistence/repositories.py:105 in private method `_get_conversation_history`:
        D401: First line should be in imperative mood (perhaps 'Retrieve', not 'Retrieves')
src/infrastructure/persistence/repositories.py:111 in private method `_get_safety_report`:
        D401: First line should be in imperative mood (perhaps 'Generate', not 'Generates')
src/infrastructure/persistence/repositories.py:121 in private method `_get_system_health`:
        D401: First line should be in imperative mood (perhaps 'Return', not 'Returns')
src/infrastructure/persistence/repositories.py:130 in public method `clean_expired_data`:
        D401: First line should be in imperative mood (perhaps 'Remove', not 'Removes')
src/infrastructure/persistence/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/persistence/child_sqlite_repository/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/persistence/database/config.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/persistence/database/config.py:13 in public class `DatabaseConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/database/config.py:130 in private method `_testing_config`:
        D401: First line should be in imperative mood (perhaps 'Test', not 'Testing')
src/infrastructure/persistence/database/initializer.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/persistence/database/migrations.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/persistence/database/migrations.py:16 in public class `DatabaseMigrationManager`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/database/migrations.py:18 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/persistence/database/migrations.py:83 in public method `setup_child_data_security`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/infrastructure/persistence/database/validators.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/persistence/database/validators.py:16 in public class `DatabaseConnectionValidator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/database/validators.py:18 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/persistence/database/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/persistence/models/base.py:4 in public class `Base`:
        D101: Missing docstring in public class
src/infrastructure/persistence/models/child_models.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/models/child_models.py:28 in public class `ChildModel`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/models/child_models.py:167 in public method `__repr__`:
        D105: Missing docstring in magic method
src/infrastructure/persistence/models/consent_models.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/models/consent_models.py:20 in public class `SafetyEventType`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/models/consent_models.py:29 in public class `ConsentModel`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/models/consent_models.py:70 in public method `__repr__`:
        D105: Missing docstring in magic method
src/infrastructure/persistence/models/consent_models.py:78 in public class `SafetyEventModel`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/models/consent_models.py:122 in public method `__repr__`:
        D105: Missing docstring in magic method
src/infrastructure/persistence/models/conversation_models.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/models/conversation_models.py:25 in public class `ConversationModel`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/models/conversation_models.py:83 in public method `__repr__`:
        D105: Missing docstring in magic method
src/infrastructure/persistence/models/conversation_models.py:88 in public class `MessageModel`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/models/conversation_models.py:134 in public method `__repr__`:
        D105: Missing docstring in magic method
src/infrastructure/persistence/models/parent_models.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/models/parent_models.py:17 in public class `ParentModel`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/models/parent_models.py:92 in public method `__repr__`:
        D105: Missing docstring in magic method
src/infrastructure/persistence/models/user_model.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/models/user_model.py:16 in public class `UserModel`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/models/user_model.py:55 in public method `__repr__`:
        D105: Missing docstring in magic method
src/infrastructure/persistence/models/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/persistence/repositories/safety_repository.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/repositories/safety_repository.py:22 in public class `SafetyRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/repositories/safety_repository.py:25 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/repositories/safety_repository.py:25 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/persistence/repositories/safety_repository.py:42 in public method `record_safety_event`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/repositories/safety_repository.py:42 in public method `record_safety_event`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/persistence/repositories/safety_repository.py:42 in public method `record_safety_event`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/persistence/repositories/safety_repository.py:83 in public method `get_safety_alerts`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/repositories/safety_repository.py:83 in public method `get_safety_alerts`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/persistence/repositories/safety_repository.py:83 in public method `get_safety_alerts`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/persistence/repositories/safety_repository.py:106 in public method `get_child_safety_score`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/repositories/safety_repository.py:106 in public method `get_child_safety_score`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/persistence/repositories/safety_repository.py:106 in public method `get_child_safety_score`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/persistence/repositories/usage_repository.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/repositories/usage_repository.py:22 in public class `UsageRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/repositories/usage_repository.py:25 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/repositories/usage_repository.py:25 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/persistence/repositories/usage_repository.py:36 in public method `record_usage`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/repositories/usage_repository.py:36 in public method `record_usage`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/persistence/repositories/usage_repository.py:36 in public method `record_usage`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/persistence/repositories/usage_repository.py:85 in public method `get_usage_summary`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/repositories/usage_repository.py:85 in public method `get_usage_summary`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/persistence/repositories/usage_repository.py:85 in public method `get_usage_summary`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/persistence/repositories/user_repository.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/repositories/user_repository.py:28 in public class `UserRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/persistence/repositories/user_repository.py:31 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/repositories/user_repository.py:31 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/persistence/repositories/user_repository.py:42 in public method `create_user`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/repositories/user_repository.py:42 in public method `create_user`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/persistence/repositories/user_repository.py:42 in public method `create_user`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/persistence/repositories/user_repository.py:42 in public method `create_user`:
        D407: Missing dashed underline after section ('Raises')
src/infrastructure/persistence/repositories/user_repository.py:42 in public method `create_user`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/infrastructure/persistence/repositories/user_repository.py:107 in public method `get_user_by_email`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/repositories/user_repository.py:107 in public method `get_user_by_email`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/persistence/repositories/user_repository.py:107 in public method `get_user_by_email`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/persistence/repositories/user_repository.py:136 in public method `update_user_role`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/persistence/repositories/user_repository.py:136 in public method `update_user_role`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/persistence/repositories/user_repository.py:136 in public method `update_user_role`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/read_models/child_profile_read_model.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/read_models/child_profile_read_model.py:7 in public class `ChildProfileReadModel`:
        D101: Missing docstring in public class
src/infrastructure/read_models/child_profile_read_model.py:14 in public class `ChildProfileReadModelStore`:
        D101: Missing docstring in public class
src/infrastructure/read_models/child_profile_read_model.py:15 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/read_models/child_profile_read_model.py:18 in public method `get_by_id`:
        D102: Missing docstring in public method
src/infrastructure/read_models/child_profile_read_model.py:21 in public method `save`:
        D102: Missing docstring in public method
src/infrastructure/read_models/child_profile_read_model.py:24 in public method `delete`:
        D102: Missing docstring in public method
src/infrastructure/read_models/child_profile_read_model.py:28 in public method `get_all`:
        D102: Missing docstring in public method
src/infrastructure/read_models/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/repositories/event_sourced_child_repository.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/repositories/event_sourced_child_repository.py:9 in public class `EventSourcedChildRepository`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/repositories/event_sourced_child_repository.py:11 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/repositories/event_sourced_child_repository.py:15 in public method `save`:
        D102: Missing docstring in public method
src/infrastructure/repositories/event_sourced_child_repository.py:21 in public method `get_by_id`:
        D102: Missing docstring in public method
src/infrastructure/repositories/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/resilience/circuit_breaker.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/resilience/circuit_breaker.py:16 in public class `CircuitBreakerState`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/resilience/circuit_breaker.py:24 in public class `CircuitBreaker`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/resilience/circuit_breaker.py:24 in public class `CircuitBreaker`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/resilience/circuit_breaker.py:24 in public class `CircuitBreaker`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/resilience/circuit_breaker.py:37 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/resilience/circuit_breaker.py:37 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/resilience/circuit_breaker.py:83 in public method `call`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/resilience/circuit_breaker.py:83 in public method `call`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/resilience/circuit_breaker.py:115 in public method `call_async`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/resilience/circuit_breaker.py:115 in public method `call_async`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/resilience/circuit_breaker.py:163 in public class `CircuitBreakerOpenError`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/resilience/circuit_breaker.py:171 in public function `circuit_breaker`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/resilience/circuit_breaker.py:171 in public function `circuit_breaker`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/resilience/circuit_breaker.py:171 in public function `circuit_breaker`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/resilience/circuit_breaker.py:211 in public function `get_circuit_breaker`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/resilience/circuit_breaker.py:211 in public function `get_circuit_breaker`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/resilience/retry_decorator.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/resilience/retry_decorator.py:18 in public class `RetryConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/resilience/retry_decorator.py:36 in public function `retry_with_backoff`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/resilience/retry_decorator.py:36 in public function `retry_with_backoff`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/resilience/retry_decorator.py:84 in private nested function `sync_wrapper`:
        D401: First line should be in imperative mood (perhaps 'Synchronize', not 'Synchronous')
src/infrastructure/resilience/retry_decorator.py:122 in public function `retry_external_api`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/resilience/retry_decorator.py:122 in public function `retry_external_api`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/access_control_service.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/access_control_service.py:13 in public class `AccessLevel`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/access_control_service.py:23 in public class `AccessAction`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/access_control_service.py:38 in public class `AccessControlService`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/api_security_manager.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/api_security_manager.py:12 in public class `APISecurityManager`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/api_security_manager.py:14 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/api_security_manager.py:22 in public method `check_rate_limit`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/api_security_manager.py:22 in public method `check_rate_limit`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/api_security_manager.py:78 in public method `sanitize_input`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/api_security_manager.py:78 in public method `sanitize_input`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/api_security_manager.py:142 in public method `validate_child_input`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/api_security_manager.py:142 in public method `validate_child_input`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/audit_decorators.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/audit_decorators.py:25 in public function `audit_authentication`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/audit_decorators.py:25 in public function `audit_authentication`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/audit_decorators.py:25 in public function `audit_authentication`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/security/audit_decorators.py:164 in public function `audit_data_access`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/audit_decorators.py:164 in public function `audit_data_access`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/audit_decorators.py:164 in public function `audit_data_access`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/security/audit_decorators.py:322 in public function `audit_security_event`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/audit_decorators.py:322 in public function `audit_security_event`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/audit_decorators.py:322 in public function `audit_security_event`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/security/audit_decorators.py:463 in public function `audit_login`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/security/audit_decorators.py:471 in public function `audit_logout`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/security/audit_decorators.py:479 in public function `audit_child_create`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/security/audit_decorators.py:492 in public function `audit_child_update`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/security/audit_decorators.py:505 in public function `audit_child_delete`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/security/audit_logger.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/audit_logger.py:19 in public class `AuditCategory`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/audit_logger.py:34 in public class `AuditEventType`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/audit_logger.py:77 in public class `AuditSeverity`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/audit_logger.py:87 in public class `AuditConfig`:
        D101: Missing docstring in public class
src/infrastructure/security/audit_logger.py:99 in public class `AuditContext`:
        D101: Missing docstring in public class
src/infrastructure/security/audit_logger.py:108 in public class `AuditEvent`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/audit_logger.py:138 in public class `AuditLogger`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/audit_logger.py:138 in public class `AuditLogger`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/audit_logger.py:138 in public class `AuditLogger`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/audit_logger.py:148 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/audit_logger.py:173 in public method `log_event`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/audit_logger.py:173 in public method `log_event`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/audit_logger.py:229 in public method `log_child_interaction`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/audit_logger.py:229 in public method `log_child_interaction`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/audit_logger.py:285 in public method `log_safety_incident`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/audit_logger.py:285 in public method `log_safety_incident`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/audit_logger.py:322 in public method `log_data_access`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/audit_logger.py:322 in public method `log_data_access`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/audit_logger.py:372 in public method `log_coppa_event`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/audit_logger.py:372 in public method `log_coppa_event`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/audit_logger.py:506 in public function `log_audit_event`:
        D401: First line should be in imperative mood; try rephrasing (found 'Convenience')
src/infrastructure/security/audit_logger.py:523 in public function `log_child_safety_incident`:
        D401: First line should be in imperative mood; try rephrasing (found 'Convenience')
src/infrastructure/security/child_data_security_manager.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/child_data_security_manager.py:20 in public class `ChildDataSecurityManager`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/child_data_security_manager.py:22 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/comprehensive_audit_integration.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/comprehensive_audit_integration.py:19 in public class `AuditableOperation`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/comprehensive_audit_integration.py:30 in public class `ComprehensiveAuditIntegration`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/comprehensive_audit_integration.py:30 in public class `ComprehensiveAuditIntegration`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/comprehensive_audit_integration.py:30 in public class `ComprehensiveAuditIntegration`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/comprehensive_audit_integration.py:39 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/comprehensive_audit_integration.py:185 in public method `log_coppa_compliance_event`:
        D102: Missing docstring in public method
src/infrastructure/security/comprehensive_audit_integration.py:231 in public method `log_security_event`:
        D102: Missing docstring in public method
src/infrastructure/security/comprehensive_audit_integration.py:268 in public method `log_system_event`:
        D102: Missing docstring in public method
src/infrastructure/security/comprehensive_audit_integration.py:320 in public function `get_audit_integration`:
        D103: Missing docstring in public function
src/infrastructure/security/comprehensive_audit_integration.py:327 in public function `audit_authentication`:
        D103: Missing docstring in public function
src/infrastructure/security/comprehensive_audit_integration.py:336 in public function `audit_authorization`:
        D103: Missing docstring in public function
src/infrastructure/security/comprehensive_audit_integration.py:345 in public function `audit_child_data_operation`:
        D103: Missing docstring in public function
src/infrastructure/security/comprehensive_audit_integration.py:354 in public function `audit_coppa_event`:
        D103: Missing docstring in public function
src/infrastructure/security/comprehensive_audit_integration.py:367 in public function `audit_security_event`:
        D103: Missing docstring in public function
src/infrastructure/security/comprehensive_rate_limiter.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/comprehensive_rate_limiter.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa_validator.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/coppa_validator.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa_validator.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/coppa_validator.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/coppa_validator.py:20 in public class `COPPAValidatorLevel`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/coppa_validator.py:29 in public class `COPPAValidationResult`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/coppa_validator.py:40 in public class `COPPAValidator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/coppa_validator.py:40 in public class `COPPAValidator`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/coppa_validator.py:40 in public class `COPPAValidator`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa_validator.py:54 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/coppa_validator.py:62 in public method `validate_age_compliance`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/coppa_validator.py:62 in public method `validate_age_compliance`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa_validator.py:62 in public method `validate_age_compliance`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/coppa_validator.py:62 in public method `validate_age_compliance`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/coppa_validator.py:62 in public method `validate_age_compliance`:
        D407: Missing dashed underline after section ('Raises')
src/infrastructure/security/coppa_validator.py:62 in public method `validate_age_compliance`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/infrastructure/security/coppa_validator.py:162 in public method `is_coppa_subject`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa_validator.py:162 in public method `is_coppa_subject`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/coppa_validator.py:181 in public method `get_data_retention_period`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa_validator.py:181 in public method `get_data_retention_period`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/coppa_validator.py:200 in public method `requires_parental_consent`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa_validator.py:200 in public method `requires_parental_consent`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/coppa_validator.py:211 in public method `get_content_filtering_level`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa_validator.py:211 in public method `get_content_filtering_level`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/coppa_validator.py:236 in public method `validate_age_range`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa_validator.py:236 in public method `validate_age_range`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/coppa_validator.py:236 in public method `validate_age_range`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/coppa_validator.py:269 in public function `is_coppa_subject`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/coppa_validator.py:269 in public function `is_coppa_subject`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa_validator.py:269 in public function `is_coppa_subject`:
        D400: First line should end with a period (not ')')
src/infrastructure/security/coppa_validator.py:269 in public function `is_coppa_subject`:
        D415: First line should end with a period, question mark, or exclamation point (not ')')
src/infrastructure/security/coppa_validator.py:279 in public function `requires_parental_consent`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/coppa_validator.py:279 in public function `requires_parental_consent`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa_validator.py:279 in public function `requires_parental_consent`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/coppa_validator.py:279 in public function `requires_parental_consent`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/coppa_validator.py:289 in public function `get_data_retention_days`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/coppa_validator.py:289 in public function `get_data_retention_days`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa_validator.py:289 in public function `get_data_retention_days`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/coppa_validator.py:289 in public function `get_data_retention_days`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/coppa_validator.py:296 in public function `validate_child_age`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/coppa_validator.py:296 in public function `validate_child_age`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa_validator.py:296 in public function `validate_child_age`:
        D400: First line should end with a period (not 'k')
src/infrastructure/security/coppa_validator.py:296 in public function `validate_child_age`:
        D415: First line should end with a period, question mark, or exclamation point (not 'k')
src/infrastructure/security/cors_service.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/cors_service.py:12 in public class `CORSPolicy`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/cors_service.py:21 in public class `CORSConfiguration`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/cors_service.py:38 in public class `CORSSecurityService`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/cors_service.py:38 in public class `CORSSecurityService`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/cors_service.py:38 in public class `CORSSecurityService`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/cors_service.py:144 in public method `validate_origin`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/cors_service.py:144 in public method `validate_origin`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/security/cors_service.py:144 in public method `validate_origin`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/cors_service.py:144 in public method `validate_origin`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/cors_service.py:217 in public method `handle_preflight_request`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/cors_service.py:217 in public method `handle_preflight_request`:
        D413: Missing blank line after last section ('Args')
src/infrastructure/security/cors_service.py:217 in public method `handle_preflight_request`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/cors_service.py:272 in public method `get_security_headers`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/cors_service.py:272 in public method `get_security_headers`:
        D413: Missing blank line after last section ('Args')
src/infrastructure/security/cors_service.py:272 in public method `get_security_headers`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/cors_service.py:470 in public method `add_allowed_origin`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/cors_service.py:470 in public method `add_allowed_origin`:
        D413: Missing blank line after last section ('Args')
src/infrastructure/security/cors_service.py:470 in public method `add_allowed_origin`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/cors_service.py:502 in public method `remove_allowed_origin`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/cors_service.py:502 in public method `remove_allowed_origin`:
        D413: Missing blank line after last section ('Args')
src/infrastructure/security/cors_service.py:502 in public method `remove_allowed_origin`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/database_input_validator.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/database_input_validator.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/database_input_validator.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/database_input_validator.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/database_input_validator.py:21 in public class `DatabaseInputValidator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/database_input_validator.py:21 in public class `DatabaseInputValidator`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/database_input_validator.py:21 in public class `DatabaseInputValidator`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/database_input_validator.py:29 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/database_input_validator.py:248 in public class `DatabaseSecurityError`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/database_input_validator.py:252 in public function `database_input_validation`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/database_input_validator.py:252 in public function `database_input_validation`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/database_input_validator.py:252 in public function `database_input_validation`:
        D400: First line should end with a period (not 'ت')
src/infrastructure/security/database_input_validator.py:252 in public function `database_input_validation`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ت')
src/infrastructure/security/database_input_validator.py:252 in public function `database_input_validation`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/security/database_input_validator.py:301 in public function `validate_database_operation`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/database_input_validator.py:301 in public function `validate_database_operation`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/database_input_validator.py:301 in public function `validate_database_operation`:
        D400: First line should end with a period (not 'ذ')
src/infrastructure/security/database_input_validator.py:301 in public function `validate_database_operation`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ذ')
src/infrastructure/security/database_input_validator.py:340 in public class `SafeDatabaseSession`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/database_input_validator.py:342 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/email_validator.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/environment_validator.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/environment_validator.py:14 in public class `EnvironmentSecurityValidator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/environment_validator.py:14 in public class `EnvironmentSecurityValidator`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/environment_validator.py:14 in public class `EnvironmentSecurityValidator`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/environment_validator.py:71 in public method `validate_all`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/environment_validator.py:71 in public method `validate_all`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/environment_validator.py:71 in public method `validate_all`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/environment_validator.py:71 in public method `validate_all`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/environment_validator.py:148 in private method `_calculate_entropy`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/environment_validator.py:148 in private method `_calculate_entropy`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/environment_validator.py:169 in public method `generate_secure_secret`:
        D400: First line should end with a period (not 't')
src/infrastructure/security/environment_validator.py:169 in public method `generate_secure_secret`:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/infrastructure/security/environment_validator.py:174 in public method `validate_and_exit_on_error`:
        D400: First line should end with a period (not 'd')
src/infrastructure/security/environment_validator.py:174 in public method `validate_and_exit_on_error`:
        D415: First line should end with a period, question mark, or exclamation point (not 'd')
src/infrastructure/security/environment_validator.py:195 in public method `get_secure_config`:
        D400: First line should end with a period (not 'y')
src/infrastructure/security/environment_validator.py:195 in public method `get_secure_config`:
        D415: First line should end with a period, question mark, or exclamation point (not 'y')
src/infrastructure/security/fallback_rate_limiter.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/fallback_rate_limiter.py:11 in public class `SlidingWindowRateLimiter`:
        D101: Missing docstring in public class
src/infrastructure/security/fallback_rate_limiter.py:41 in public method `is_allowed`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/fallback_rate_limiter.py:41 in public method `is_allowed`:
        D413: Missing blank line after last section ('Args')
src/infrastructure/security/fallback_rate_limiter.py:41 in public method `is_allowed`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/fallback_rate_limiter.py:250 in public class `FallbackRateLimitService`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/fallback_rate_limiter.py:250 in public class `FallbackRateLimitService`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/fallback_rate_limiter.py:250 in public class `FallbackRateLimitService`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/file_security_manager.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/file_security_manager.py:13 in public class `AudioFileSecurityManager`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/file_security_manager.py:15 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/file_security_manager.py:30 in public method `validate_audio_file`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/file_security_manager.py:30 in public method `validate_audio_file`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/file_security_manager.py:187 in public method `sanitize_filename`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/file_security_manager.py:187 in public method `sanitize_filename`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/jwt_auth.py:1 at module level:
        D400: First line should end with a period (not 's')
src/infrastructure/security/jwt_auth.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/jwt_auth.py:24 in public class `SQLAlchemyBaseUserTableUUID`:
        D101: Missing docstring in public class
src/infrastructure/security/jwt_auth.py:27 in public class `SQLAlchemyUserDatabase`:
        D101: Missing docstring in public class
src/infrastructure/security/jwt_auth.py:30 in public class `JWTStrategy`:
        D101: Missing docstring in public class
src/infrastructure/security/jwt_auth.py:33 in public class `BearerTransport`:
        D101: Missing docstring in public class
src/infrastructure/security/jwt_auth.py:36 in public class `AuthenticationBackend`:
        D101: Missing docstring in public class
src/infrastructure/security/jwt_auth.py:39 in public class `FastAPIUsers`:
        D101: Missing docstring in public class
src/infrastructure/security/jwt_auth.py:48 in public function `get_settings`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/jwt_auth.py:48 in public function `get_settings`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/jwt_auth.py:71 in public function `get_vault_client`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/jwt_auth.py:71 in public function `get_vault_client`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/jwt_auth.py:76 in public class `User`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/jwt_auth.py:76 in public class `User`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/jwt_auth.py:76 in public class `User`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/jwt_auth.py:89 in public function `get_user_db`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/jwt_auth.py:89 in public function `get_user_db`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/jwt_auth.py:97 in public function `get_jwt_strategy`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/jwt_auth.py:97 in public function `get_jwt_strategy`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/jwt_auth.py:154 in public function `create_auth_components`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/jwt_auth.py:154 in public function `create_auth_components`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/key_rotation_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_rotation_service.py:22 in public class `KeyType`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/key_rotation_service.py:33 in public class `RotationTrigger`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/key_rotation_service.py:44 in public class `KeyMetadata`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/key_rotation_service.py:76 in public class `KeyRotationPolicy`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/key_rotation_service.py:84 in public class `KeyStorage`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/key_rotation_service.py:86 in public method `store_key`:
        D102: Missing docstring in public method
src/infrastructure/security/key_rotation_service.py:93 in public method `retrieve_key`:
        D102: Missing docstring in public method
src/infrastructure/security/key_rotation_service.py:95 in public method `get_active_key_id`:
        D102: Missing docstring in public method
src/infrastructure/security/key_rotation_service.py:97 in public method `set_active_key_id`:
        D102: Missing docstring in public method
src/infrastructure/security/key_rotation_service.py:101 in public class `KeyRotationService`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/key_rotation_service.py:103 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/logging_security_monitor.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/logging_security_monitor.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/infrastructure/security/logging_security_monitor.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/security/logging_security_monitor.py:16 in public class `LoggingSecurityMonitor`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/logging_security_monitor.py:16 in public class `LoggingSecurityMonitor`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/logging_security_monitor.py:16 in public class `LoggingSecurityMonitor`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/logging_security_monitor.py:16 in public class `LoggingSecurityMonitor`:
        D400: First line should end with a period (not 't')
src/infrastructure/security/logging_security_monitor.py:16 in public class `LoggingSecurityMonitor`:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/infrastructure/security/logging_security_monitor.py:20 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/logging_security_monitor.py:38 in public method `scan_codebase_for_violations`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/logging_security_monitor.py:38 in public method `scan_codebase_for_violations`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/logging_security_monitor.py:38 in public method `scan_codebase_for_violations`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/logging_security_monitor.py:38 in public method `scan_codebase_for_violations`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/log_sanitization_config.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/log_sanitization_config.py:6 in public class `LogSanitizationConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/log_sanitizer.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/log_sanitizer.py:19 in public class `SensitiveDataType`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/log_sanitizer.py:34 in public class `SanitizationRule`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/log_sanitizer.py:43 in public class `LogSanitizer`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/log_sanitizer.py:43 in public class `LogSanitizer`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/log_sanitizer.py:43 in public class `LogSanitizer`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/main_security_service.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/main_security_service.py:19 in public class `MainSecurityService`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/main_security_service.py:21 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/main_security_service.py:120 in public method `validate_production_environment_security`:
        D401: First line should be in imperative mood (perhaps 'Validate', not 'Validates')
src/infrastructure/security/models.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/models.py:8 in public class `EncryptionMetadata`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/models.py:19 in public class `COPPAValidatorRecord`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/password_hasher.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/password_hasher.py:10 in public class `PasswordHasher`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/password_hasher.py:10 in public class `PasswordHasher`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/password_hasher.py:10 in public class `PasswordHasher`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/password_hasher.py:14 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/password_hasher.py:45 in public method `verify_password`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/password_hasher.py:45 in public method `verify_password`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/password_hasher.py:45 in public method `verify_password`:
        D400: First line should end with a period (not 't')
src/infrastructure/security/password_hasher.py:45 in public method `verify_password`:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/infrastructure/security/password_hasher.py:45 in public method `verify_password`:
        D401: First line should be in imperative mood (perhaps 'Verify', not 'Verifies')
src/infrastructure/security/password_validator.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/path_validator.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/path_validator.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/path_validator.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/path_validator.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/path_validator.py:18 in public class `PathPolicy`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/path_validator.py:18 in public class `PathPolicy`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/path_validator.py:18 in public class `PathPolicy`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/path_validator.py:28 in public class `PathValidator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/path_validator.py:28 in public class `PathValidator`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/path_validator.py:28 in public class `PathValidator`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/path_validator.py:28 in public class `PathValidator`:
        D400: First line should end with a period (not 'l')
src/infrastructure/security/path_validator.py:28 in public class `PathValidator`:
        D415: First line should end with a period, question mark, or exclamation point (not 'l')
src/infrastructure/security/path_validator.py:28 in public class `PathValidator`:
        D404: First word of the docstring should not be `This`
src/infrastructure/security/path_validator.py:46 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/path_validator.py:59 in public method `validate_path`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/path_validator.py:59 in public method `validate_path`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/path_validator.py:59 in public method `validate_path`:
        D400: First line should end with a period (not 'y')
src/infrastructure/security/path_validator.py:59 in public method `validate_path`:
        D415: First line should end with a period, question mark, or exclamation point (not 'y')
src/infrastructure/security/path_validator.py:59 in public method `validate_path`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/security/path_validator.py:59 in public method `validate_path`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/path_validator.py:59 in public method `validate_path`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/path_validator.py:113 in public method `sanitize_path`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/path_validator.py:113 in public method `sanitize_path`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/path_validator.py:113 in public method `sanitize_path`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/path_validator.py:113 in public method `sanitize_path`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/path_validator.py:142 in public method `get_safe_path`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/path_validator.py:142 in public method `get_safe_path`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/path_validator.py:142 in public method `get_safe_path`:
        D400: First line should end with a period (not 'y')
src/infrastructure/security/path_validator.py:142 in public method `get_safe_path`:
        D415: First line should end with a period, question mark, or exclamation point (not 'y')
src/infrastructure/security/path_validator.py:142 in public method `get_safe_path`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/security/path_validator.py:142 in public method `get_safe_path`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/path_validator.py:142 in public method `get_safe_path`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/path_validator.py:177 in private method `_contains_traversal_patterns`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/path_validator.py:177 in private method `_contains_traversal_patterns`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/path_validator.py:184 in private method `_is_within_allowed_dirs`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/path_validator.py:184 in private method `_is_within_allowed_dirs`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/path_validator.py:203 in public class `SecureFileOperations`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/path_validator.py:203 in public class `SecureFileOperations`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/path_validator.py:203 in public class `SecureFileOperations`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/path_validator.py:203 in public class `SecureFileOperations`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/path_validator.py:203 in public class `SecureFileOperations`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/path_validator.py:207 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/path_validator.py:211 in public method `safe_open`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/path_validator.py:211 in public method `safe_open`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/path_validator.py:211 in public method `safe_open`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/path_validator.py:211 in public method `safe_open`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/path_validator.py:211 in public method `safe_open`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/security/path_validator.py:211 in public method `safe_open`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/path_validator.py:211 in public method `safe_open`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/path_validator.py:234 in public method `safe_exists`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/path_validator.py:234 in public method `safe_exists`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/path_validator.py:243 in public method `safe_remove`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/path_validator.py:243 in public method `safe_remove`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/path_validator.py:257 in public method `safe_listdir`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/path_validator.py:257 in public method `safe_listdir`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/path_validator.py:271 in public class `PathSecurityError`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/path_validator.py:271 in public class `PathSecurityError`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/path_validator.py:271 in public class `PathSecurityError`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/path_validator.py:275 in public function `create_child_safe_validator`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/path_validator.py:275 in public function `create_child_safe_validator`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/path_validator.py:275 in public function `create_child_safe_validator`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/path_validator.py:275 in public function `create_child_safe_validator`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/path_validator.py:309 in public function `create_secure_file_operations`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/path_validator.py:309 in public function `create_secure_file_operations`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/path_validator.py:309 in public function `create_secure_file_operations`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/path_validator.py:309 in public function `create_secure_file_operations`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/path_validator.py:323 in public function `get_path_validator`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/path_validator.py:323 in public function `get_path_validator`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/path_validator.py:331 in public function `get_secure_file_operations`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/path_validator.py:331 in public function `get_secure_file_operations`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/path_validator.py:339 in public function `validate_path`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/path_validator.py:339 in public function `validate_path`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/path_validator.py:339 in public function `validate_path`:
        D401: First line should be in imperative mood; try rephrasing (found 'Convenience')
src/infrastructure/security/path_validator.py:344 in public function `safe_open`:
        D400: First line should end with a period (not 'g')
src/infrastructure/security/path_validator.py:344 in public function `safe_open`:
        D415: First line should end with a period, question mark, or exclamation point (not 'g')
src/infrastructure/security/path_validator.py:344 in public function `safe_open`:
        D401: First line should be in imperative mood; try rephrasing (found 'Convenience')
src/infrastructure/security/plugin_architecture.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/plugin_architecture.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/infrastructure/security/plugin_architecture.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/security/plugin_architecture.py:17 in public class `PluginType`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/plugin_architecture.py:17 in public class `PluginType`:
        D400: First line should end with a period (not 'm')
src/infrastructure/security/plugin_architecture.py:17 in public class `PluginType`:
        D415: First line should end with a period, question mark, or exclamation point (not 'm')
src/infrastructure/security/plugin_architecture.py:27 in public class `PluginStatus`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/plugin_architecture.py:27 in public class `PluginStatus`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/plugin_architecture.py:27 in public class `PluginStatus`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/plugin_architecture.py:37 in public class `PluginManifest`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/plugin_architecture.py:37 in public class `PluginManifest`:
        D400: First line should end with a period (not 'a')
src/infrastructure/security/plugin_architecture.py:37 in public class `PluginManifest`:
        D415: First line should end with a period, question mark, or exclamation point (not 'a')
src/infrastructure/security/plugin_architecture.py:50 in public method `__post_init__`:
        D105: Missing docstring in magic method
src/infrastructure/security/plugin_architecture.py:56 in public class `PluginInterface`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/plugin_architecture.py:56 in public class `PluginInterface`:
        D400: First line should end with a period (not 't')
src/infrastructure/security/plugin_architecture.py:56 in public class `PluginInterface`:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/infrastructure/security/plugin_architecture.py:60 in public method `initialize`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/plugin_architecture.py:60 in public method `initialize`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/plugin_architecture.py:65 in public method `execute`:
        D400: First line should end with a period (not 'y')
src/infrastructure/security/plugin_architecture.py:65 in public method `execute`:
        D415: First line should end with a period, question mark, or exclamation point (not 'y')
src/infrastructure/security/plugin_architecture.py:70 in public method `cleanup`:
        D400: First line should end with a period (not 'd')
src/infrastructure/security/plugin_architecture.py:70 in public method `cleanup`:
        D415: First line should end with a period, question mark, or exclamation point (not 'd')
src/infrastructure/security/plugin_architecture.py:76 in public method `name`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/plugin_architecture.py:76 in public method `name`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/plugin_architecture.py:82 in public method `version`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/plugin_architecture.py:82 in public method `version`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/plugin_architecture.py:87 in public class `PluginValidationError`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/plugin_architecture.py:87 in public class `PluginValidationError`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/plugin_architecture.py:87 in public class `PluginValidationError`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/plugin_architecture.py:93 in public class `PluginSecurityError`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/plugin_architecture.py:93 in public class `PluginSecurityError`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/plugin_architecture.py:93 in public class `PluginSecurityError`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/plugin_architecture.py:99 in public class `PluginValidator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/plugin_architecture.py:99 in public class `PluginValidator`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/plugin_architecture.py:99 in public class `PluginValidator`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/plugin_architecture.py:128 in public method `validate_plugin`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/plugin_architecture.py:128 in public method `validate_plugin`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/plugin_architecture.py:154 in private method `_contains_forbidden_content`:
        D400: First line should end with a period (not 'y')
src/infrastructure/security/plugin_architecture.py:154 in private method `_contains_forbidden_content`:
        D415: First line should end with a period, question mark, or exclamation point (not 'y')
src/infrastructure/security/plugin_architecture.py:174 in public class `PluginManager`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/plugin_architecture.py:174 in public class `PluginManager`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/plugin_architecture.py:174 in public class `PluginManager`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/plugin_architecture.py:176 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/plugin_architecture.py:185 in public method `load_plugin`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/plugin_architecture.py:185 in public method `load_plugin`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/plugin_architecture.py:233 in public method `activate_plugin`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/plugin_architecture.py:233 in public method `activate_plugin`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/plugin_architecture.py:254 in public method `deactivate_plugin`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/plugin_architecture.py:254 in public method `deactivate_plugin`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/plugin_architecture.py:271 in public method `execute_plugin`:
        D400: First line should end with a period (not 'y')
src/infrastructure/security/plugin_architecture.py:271 in public method `execute_plugin`:
        D415: First line should end with a period, question mark, or exclamation point (not 'y')
src/infrastructure/security/plugin_architecture.py:282 in public method `list_plugins`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/plugin_architecture.py:282 in public method `list_plugins`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/plugin_architecture.py:293 in public method `get_plugins_by_type`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/plugin_architecture.py:293 in public method `get_plugins_by_type`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/plugin_architecture.py:301 in private method `_load_manifest`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/plugin_architecture.py:301 in private method `_load_manifest`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/plugin_architecture.py:328 in private method `_find_plugin_class`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/plugin_architecture.py:328 in private method `_find_plugin_class`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/plugin_architecture.py:340 in public function `create_plugin_manager`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/plugin_architecture.py:340 in public function `create_plugin_manager`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/plugin_architecture.py:353 in public function `create_plugin_manifest`:
        D400: First line should end with a period (not 't')
src/infrastructure/security/plugin_architecture.py:353 in public function `create_plugin_manifest`:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/infrastructure/security/rate_limiter.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/rate_limiter.py:28 in public class `Limiter`:
        D101: Missing docstring in public class
src/infrastructure/security/rate_limiter.py:29 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/rate_limiter.py:32 in public method `limit`:
        D102: Missing docstring in public method
src/infrastructure/security/rate_limiter.py:38 in public function `get_remote_address`:
        D103: Missing docstring in public function
src/infrastructure/security/rate_limiter.py:41 in public class `RateLimitExceeded`:
        D101: Missing docstring in public class
src/infrastructure/security/rate_limiter.py:54 in public class `Depends`:
        D101: Missing docstring in public class
src/infrastructure/security/rate_limiter.py:55 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/rate_limiter.py:58 in public class `Request`:
        D101: Missing docstring in public class
src/infrastructure/security/rate_limiter.py:59 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/rate_limiter.py:62 in public class `HTTPException`:
        D101: Missing docstring in public class
src/infrastructure/security/rate_limiter.py:63 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/rate_limiter.py:67 in public class `status`:
        D101: Missing docstring in public class
src/infrastructure/security/rate_limiter.py:70 in public class `JSONResponse`:
        D101: Missing docstring in public class
src/infrastructure/security/rate_limiter.py:71 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/rate_limiter.py:75 in public class `FastAPI`:
        D101: Missing docstring in public class
src/infrastructure/security/rate_limiter.py:76 in public method `exception_handler`:
        D102: Missing docstring in public method
src/infrastructure/security/rate_limiter.py:84 in public class `ChildSafetyRateLimiter`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/rate_limiter.py:84 in public class `ChildSafetyRateLimiter`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/rate_limiter.py:84 in public class `ChildSafetyRateLimiter`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/rate_limiter.py:88 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/rate_limiter.py:121 in public method `get_limiter`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/rate_limiter.py:121 in public method `get_limiter`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/rate_limiter.py:149 in public method `is_child_locked_out`:
        D400: First line should end with a period (not 't')
src/infrastructure/security/rate_limiter.py:149 in public method `is_child_locked_out`:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/infrastructure/security/rate_limiter.py:163 in public method `get_child_interaction_count`:
        D400: First line should end with a period (not 'd')
src/infrastructure/security/rate_limiter.py:163 in public method `get_child_interaction_count`:
        D415: First line should end with a period, question mark, or exclamation point (not 'd')
src/infrastructure/security/rate_limiter.py:173 in public method `reset_child_interactions`:
        D400: First line should end with a period (not ')')
src/infrastructure/security/rate_limiter.py:173 in public method `reset_child_interactions`:
        D415: First line should end with a period, question mark, or exclamation point (not ')')
src/infrastructure/security/rate_limiter.py:202 in public method `get_rate_limit_status`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/rate_limiter.py:202 in public method `get_rate_limit_status`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/rate_limiter.py:229 in public function `get_child_safety_rate_limiter`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/rate_limiter.py:229 in public function `get_child_safety_rate_limiter`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/rate_limiter.py:239 in public function `create_rate_limiter_dependency`:
        D400: First line should end with a period (not 'r')
src/infrastructure/security/rate_limiter.py:239 in public function `create_rate_limiter_dependency`:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/security/rate_limiter.py:247 in public function `check_child_rate_limit`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/rate_limiter.py:247 in public function `check_child_rate_limit`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/rate_limiter.py:247 in public function `check_child_rate_limit`:
        D401: First line should be in imperative mood; try rephrasing (found 'Convenience')
src/infrastructure/security/rate_limiter.py:253 in public function `get_rate_limit_status`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/rate_limiter.py:253 in public function `get_rate_limit_status`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/rate_limiter.py:253 in public function `get_rate_limit_status`:
        D401: First line should be in imperative mood; try rephrasing (found 'Convenience')
src/infrastructure/security/rate_limiter_service.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/rate_limiter_service.py:14 in public class `RateLimiterService`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/rate_limiter_service.py:16 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/real_auth_service.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/real_auth_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/real_auth_service.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/infrastructure/security/real_auth_service.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/security/real_auth_service.py:31 in public class `UserInfo`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/real_auth_service.py:31 in public class `UserInfo`:
        D204: 1 blank line required after class docstring (found 0)
src/infrastructure/security/real_auth_service.py:40 in public class `ProductionAuthService`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/real_auth_service.py:42 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/registration_models.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/registration_models.py:6 in public class `RegistrationRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/registration_models.py:21 in public class `PasswordRequirements`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/request_security_detector.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/request_security_detector.py:10 in public class `RequestSecurityDetector`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/request_security_detector.py:12 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/request_signing_service.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/request_signing_service.py:25 in public class `SignatureAlgorithm`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/robust_encryption_service.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/robust_encryption_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/robust_encryption_service.py:1 at module level:
        D400: First line should end with a period (not 's')
src/infrastructure/security/robust_encryption_service.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/robust_encryption_service.py:23 in public class `MockAuditIntegration`:
        D101: Missing docstring in public class
src/infrastructure/security/robust_encryption_service.py:24 in public method `log_security_event`:
        D102: Missing docstring in public method
src/infrastructure/security/robust_encryption_service.py:27 in public function `get_audit_integration`:
        D103: Missing docstring in public function
src/infrastructure/security/robust_encryption_service.py:32 in public class `EncryptionResult`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/robust_encryption_service.py:34 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/robust_encryption_service.py:53 in public class `EncryptionLevel`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/robust_encryption_service.py:62 in public class `EncryptionPolicy`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/robust_encryption_service.py:71 in public class `EncryptionConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/robust_encryption_service.py:84 in public class `RobustEncryptionService`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/robust_encryption_service.py:84 in public class `RobustEncryptionService`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/robust_encryption_service.py:84 in public class `RobustEncryptionService`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/robust_encryption_service.py:96 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/robust_encryption_service.py:224 in public method `encrypt`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/robust_encryption_service.py:224 in public method `encrypt`:
        D413: Missing blank line after last section ('Args')
src/infrastructure/security/robust_encryption_service.py:224 in public method `encrypt`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/robust_encryption_service.py:338 in public method `decrypt`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/robust_encryption_service.py:338 in public method `decrypt`:
        D413: Missing blank line after last section ('Args')
src/infrastructure/security/robust_encryption_service.py:338 in public method `decrypt`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/safety_monitor_service.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/safety_monitor_service.py:11 in public class `SafetyMonitorService`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/safety_monitor_service.py:13 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/safety_monitor_service.py:197 in private method `_is_valid_audio_format`:
        D401: First line should be in imperative mood; try rephrasing (found 'Basic')
src/infrastructure/security/secure_logger.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/secure_logger.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/secure_logger.py:1 at module level:
        D400: First line should end with a period (not 'y')
src/infrastructure/security/secure_logger.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'y')
src/infrastructure/security/secure_logger.py:21 in public function `requires_coppa_audit_logging`:
        D103: Missing docstring in public function
src/infrastructure/security/secure_logger.py:26 in public class `SecureLogger`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/secure_logger.py:28 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/secure_logger.py:137 in private method `_mask_value`:
        D401: First line should be in imperative mood (perhaps 'Partial', not 'Partially')
src/infrastructure/security/secure_logger.py:398 in public function `secure_log_call`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/security/secure_user_registration.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/secure_user_registration.py:31 in public class `SecureUserRegistration`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/secure_user_registration.py:31 in public class `SecureUserRegistration`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/secure_user_registration.py:31 in public class `SecureUserRegistration`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/secure_user_registration.py:31 in public class `SecureUserRegistration`:
        D400: First line should end with a period (not 'm')
src/infrastructure/security/secure_user_registration.py:31 in public class `SecureUserRegistration`:
        D415: First line should end with a period, question mark, or exclamation point (not 'm')
src/infrastructure/security/secure_user_registration.py:40 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/security_headers_service.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/security_levels.py:7 in public class `SecurityLevel`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/security_levels.py:19 in public class `RequestSecurityLevel`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/security_manager.py:11 in public class `CoreSecurityManager`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/security_manager.py:15 in public method `hash_password`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/security_manager.py:15 in public method `hash_password`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/security_manager.py:15 in public method `hash_password`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/security_manager.py:30 in public method `verify_password`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/security_manager.py:30 in public method `verify_password`:
        D401: First line should be in imperative mood (perhaps 'Verify', not 'Verifies')
src/infrastructure/security/security_manager.py:30 in public method `verify_password`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/security_manager.py:30 in public method `verify_password`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/security_manager.py:47 in public method `generate_secure_token`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/security_manager.py:47 in public method `generate_secure_token`:
        D401: First line should be in imperative mood (perhaps 'Generate', not 'Generates')
src/infrastructure/security/security_manager.py:47 in public method `generate_secure_token`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/security_manager.py:47 in public method `generate_secure_token`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/security_manager.py:60 in public method `secure_compare`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/security_manager.py:60 in public method `secure_compare`:
        D401: First line should be in imperative mood (perhaps 'Perform', not 'Performs')
src/infrastructure/security/security_manager.py:60 in public method `secure_compare`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/security_manager.py:60 in public method `secure_compare`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/security_manager.py:74 in public method `generate_file_signature`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/security_manager.py:74 in public method `generate_file_signature`:
        D401: First line should be in imperative mood (perhaps 'Generate', not 'Generates')
src/infrastructure/security/security_manager.py:74 in public method `generate_file_signature`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/security_manager.py:74 in public method `generate_file_signature`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/security_middleware.py:1 at module level:
        D400: First line should end with a period (not 'ق')
src/infrastructure/security/security_middleware.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'ق')
src/infrastructure/security/security_middleware.py:30 in public class `MockRedis`:
        D101: Missing docstring in public class
src/infrastructure/security/security_middleware.py:31 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/security_middleware.py:34 in public method `zremrangebyscore`:
        D102: Missing docstring in public method
src/infrastructure/security/security_middleware.py:42 in public method `zcard`:
        D102: Missing docstring in public method
src/infrastructure/security/security_middleware.py:45 in public method `zadd`:
        D102: Missing docstring in public method
src/infrastructure/security/security_middleware.py:50 in public method `expire`:
        D102: Missing docstring in public method
src/infrastructure/security/security_middleware.py:53 in public method `exists`:
        D102: Missing docstring in public method
src/infrastructure/security/security_middleware.py:56 in public method `delete`:
        D102: Missing docstring in public method
src/infrastructure/security/security_middleware.py:59 in public method `setex`:
        D102: Missing docstring in public method
src/infrastructure/security/security_middleware.py:66 in public class `RateLimiter`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/security_middleware.py:66 in public class `RateLimiter`:
        D400: First line should end with a period (not 'S')
src/infrastructure/security/security_middleware.py:66 in public class `RateLimiter`:
        D415: First line should end with a period, question mark, or exclamation point (not 'S')
src/infrastructure/security/security_middleware.py:68 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/security_middleware.py:80 in public method `is_allowed`:
        D400: First line should end with a period (not 'ب')
src/infrastructure/security/security_middleware.py:80 in public method `is_allowed`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ب')
src/infrastructure/security/security_middleware.py:100 in public method `record_suspicious_activity`:
        D400: First line should end with a period (not 'ه')
src/infrastructure/security/security_middleware.py:100 in public method `record_suspicious_activity`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ه')
src/infrastructure/security/security_middleware.py:117 in public method `is_ip_blocked`:
        D400: First line should end with a period (not 'P')
src/infrastructure/security/security_middleware.py:117 in public method `is_ip_blocked`:
        D415: First line should end with a period, question mark, or exclamation point (not 'P')
src/infrastructure/security/security_middleware.py:122 in public method `clear_failed_attempts`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/security_middleware.py:122 in public method `clear_failed_attempts`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/security_middleware.py:129 in public class `SecurityValidator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/security_middleware.py:129 in public class `SecurityValidator`:
        D400: First line should end with a period (not 'ت')
src/infrastructure/security/security_middleware.py:129 in public class `SecurityValidator`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ت')
src/infrastructure/security/security_middleware.py:151 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/security_middleware.py:157 in public method `scan_request`:
        D400: First line should end with a period (not 'ر')
src/infrastructure/security/security_middleware.py:157 in public method `scan_request`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ر')
src/infrastructure/security/security_middleware.py:185 in public method `validate_child_data`:
        D400: First line should end with a period (not 'A')
src/infrastructure/security/security_middleware.py:185 in public method `validate_child_data`:
        D415: First line should end with a period, question mark, or exclamation point (not 'A')
src/infrastructure/security/security_middleware.py:203 in public class `SecurityMiddleware`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/security_middleware.py:203 in public class `SecurityMiddleware`:
        D400: First line should end with a period (not 'ي')
src/infrastructure/security/security_middleware.py:203 in public class `SecurityMiddleware`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ي')
src/infrastructure/security/security_middleware.py:205 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/security_middleware.py:218 in public method `dispatch`:
        D400: First line should end with a period (not 'ن')
src/infrastructure/security/security_middleware.py:218 in public method `dispatch`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ن')
src/infrastructure/security/security_middleware.py:276 in public method `get_client_ip`:
        D400: First line should end with a period (not 'ل')
src/infrastructure/security/security_middleware.py:276 in public method `get_client_ip`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ل')
src/infrastructure/security/security_middleware.py:289 in public method `scan_request_security`:
        D400: First line should end with a period (not 'ب')
src/infrastructure/security/security_middleware.py:289 in public method `scan_request_security`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ب')
src/infrastructure/security/security_middleware.py:327 in public method `add_security_headers`:
        D400: First line should end with a period (not 'ن')
src/infrastructure/security/security_middleware.py:327 in public method `add_security_headers`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ن')
src/infrastructure/security/security_middleware.py:356 in public method `log_request`:
        D400: First line should end with a period (not 'ب')
src/infrastructure/security/security_middleware.py:356 in public method `log_request`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ب')
src/infrastructure/security/security_middleware.py:371 in public class `ChildSafetySecurityMiddleware`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/security_middleware.py:371 in public class `ChildSafetySecurityMiddleware`:
        D400: First line should end with a period (not 'ل')
src/infrastructure/security/security_middleware.py:371 in public class `ChildSafetySecurityMiddleware`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ل')
src/infrastructure/security/security_middleware.py:373 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/security_middleware.py:389 in public method `dispatch`:
        D400: First line should end with a period (not 'ل')
src/infrastructure/security/security_middleware.py:389 in public method `dispatch`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ل')
src/infrastructure/security/security_middleware.py:406 in public method `is_child_request`:
        D400: First line should end with a period (not 'ل')
src/infrastructure/security/security_middleware.py:406 in public method `is_child_request`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ل')
src/infrastructure/security/security_middleware.py:416 in public method `validate_child_content`:
        D400: First line should end with a period (not 'ل')
src/infrastructure/security/security_middleware.py:416 in public method `validate_child_content`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ل')
src/infrastructure/security/security_middleware.py:450 in public function `create_security_middleware`:
        D400: First line should end with a period (not 'ن')
src/infrastructure/security/security_middleware.py:450 in public function `create_security_middleware`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ن')
src/infrastructure/security/security_middleware.py:473 in public function `setup_security_middleware`:
        D400: First line should end with a period (not 'ق')
src/infrastructure/security/security_middleware.py:473 in public function `setup_security_middleware`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ق')
src/infrastructure/security/security_middleware.py:505 in public function `get_security_config`:
        D400: First line should end with a period (not 'ة')
src/infrastructure/security/security_middleware.py:505 in public function `get_security_config`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ة')
src/infrastructure/security/security_middleware.py:510 in public function `get_security_status`:
        D400: First line should end with a period (not 'ن')
src/infrastructure/security/security_middleware.py:510 in public function `get_security_status`:
        D415: First line should end with a period, question mark, or exclamation point (not 'ن')
src/infrastructure/security/sql_injection_protection.py:1 at module level:
        D400: First line should end with a period (not 'm')
src/infrastructure/security/sql_injection_protection.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'm')
src/infrastructure/security/sql_injection_protection.py:18 in public class `MockInputSanitizer`:
        D101: Missing docstring in public class
src/infrastructure/security/sql_injection_protection.py:19 in public method `sanitize`:
        D102: Missing docstring in public method
src/infrastructure/security/sql_injection_protection.py:29 in public function `get_input_sanitizer`:
        D103: Missing docstring in public function
src/infrastructure/security/sql_injection_protection.py:38 in public class `MockQueryValidator`:
        D101: Missing docstring in public class
src/infrastructure/security/sql_injection_protection.py:39 in public method `validate_query`:
        D102: Missing docstring in public method
src/infrastructure/security/sql_injection_protection.py:49 in public function `get_query_validator`:
        D103: Missing docstring in public function
src/infrastructure/security/sql_injection_protection.py:54 in public class `SQLInjectionProtection`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/sql_injection_protection.py:54 in public class `SQLInjectionProtection`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/sql_injection_protection.py:54 in public class `SQLInjectionProtection`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/sql_injection_protection.py:56 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/sql_injection_protection.py:77 in public method `validate_query`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/sql_injection_protection.py:77 in public method `validate_query`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/sql_injection_protection.py:96 in public method `sanitize_input`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/sql_injection_protection.py:96 in public method `sanitize_input`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/sql_injection_protection.py:108 in public method `check_ip_blocked`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/sql_injection_protection.py:108 in public method `check_ip_blocked`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/sql_injection_protection.py:112 in public method `block_ip`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/sql_injection_protection.py:112 in public method `block_ip`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/sql_injection_protection.py:118 in public method `unblock_ip`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/sql_injection_protection.py:118 in public method `unblock_ip`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/sql_injection_protection.py:130 in public method `record_attack_attempt`:
        D400: First line should end with a period (not 'P')
src/infrastructure/security/sql_injection_protection.py:130 in public method `record_attack_attempt`:
        D415: First line should end with a period, question mark, or exclamation point (not 'P')
src/infrastructure/security/sql_injection_protection.py:163 in private method `_log_attack_attempt`:
        D400: First line should end with a period (not 't')
src/infrastructure/security/sql_injection_protection.py:163 in private method `_log_attack_attempt`:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/infrastructure/security/sql_injection_protection.py:188 in private method `_assess_risk_level`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/sql_injection_protection.py:188 in private method `_assess_risk_level`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/sql_injection_protection.py:208 in public method `validate_child_query`:
        D400: First line should end with a period (not ')')
src/infrastructure/security/sql_injection_protection.py:208 in public method `validate_child_query`:
        D415: First line should end with a period, question mark, or exclamation point (not ')')
src/infrastructure/security/sql_injection_protection.py:208 in public method `validate_child_query`:
        D401: First line should be in imperative mood; try rephrasing (found 'Special')
src/infrastructure/security/sql_injection_protection.py:242 in public method `get_protection_stats`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/sql_injection_protection.py:242 in public method `get_protection_stats`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/sql_injection_protection.py:267 in public method `update_configuration`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/sql_injection_protection.py:267 in public method `update_configuration`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/sql_injection_protection.py:277 in public method `reset_protection_state`:
        D400: First line should end with a period (not ')')
src/infrastructure/security/sql_injection_protection.py:277 in public method `reset_protection_state`:
        D415: First line should end with a period, question mark, or exclamation point (not ')')
src/infrastructure/security/sql_injection_protection.py:283 in public method `export_security_report`:
        D400: First line should end with a period (not 't')
src/infrastructure/security/sql_injection_protection.py:283 in public method `export_security_report`:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/infrastructure/security/sql_injection_protection.py:316 in public function `get_sql_protection`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/sql_injection_protection.py:316 in public function `get_sql_protection`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/sql_injection_protection.py:324 in public function `validate_query_safe`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/sql_injection_protection.py:324 in public function `validate_query_safe`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/sql_injection_protection.py:331 in public function `sanitize_user_input`:
        D400: First line should end with a period (not 'g')
src/infrastructure/security/sql_injection_protection.py:331 in public function `sanitize_user_input`:
        D415: First line should end with a period, question mark, or exclamation point (not 'g')
src/infrastructure/security/sql_injection_protection.py:338 in public function `validate_child_query_safe`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/sql_injection_protection.py:338 in public function `validate_child_query_safe`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/sql_injection_protection.py:347 in public function `setup_sql_protection`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/sql_injection_protection.py:347 in public function `setup_sql_protection`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/sql_injection_protection.py:347 in public function `setup_sql_protection`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/infrastructure/security/sql_injection_protection.py:364 in public class `SecureQueryBuilder`:
        D101: Missing docstring in public class
src/infrastructure/security/sql_injection_protection.py:365 in public method `build_insert`:
        D102: Missing docstring in public method
src/infrastructure/security/sql_injection_protection.py:369 in public method `build_update`:
        D102: Missing docstring in public method
src/infrastructure/security/sql_injection_protection.py:373 in public method `build_select`:
        D102: Missing docstring in public method
src/infrastructure/security/sql_injection_protection.py:377 in public function `get_secure_query_builder`:
        D103: Missing docstring in public function
src/infrastructure/security/sql_injection_protection.py:381 in public class `EnhancedSQLProtection`:
        D101: Missing docstring in public class
src/infrastructure/security/sql_injection_protection.py:382 in public method `validate_sql_query`:
        D102: Missing docstring in public method
src/infrastructure/security/sql_injection_protection.py:385 in public method `validate_column_name`:
        D102: Missing docstring in public method
src/infrastructure/security/sql_injection_protection.py:388 in public method `validate_table_name`:
        D102: Missing docstring in public method
src/infrastructure/security/sql_injection_protection.py:391 in public method `sanitize_input`:
        D102: Missing docstring in public method
src/infrastructure/security/sql_injection_protection.py:400 in public method `log_security_event`:
        D102: Missing docstring in public method
src/infrastructure/security/token_service.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/token_service.py:14 in public class `TokenService`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/token_service.py:16 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/vault_client.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/vault_client.py:30 in public class `VaultClient`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/vault_client.py:32 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/vault_client.py:71 in public method `get_secret`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/vault_client.py:71 in public method `get_secret`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/vault_client.py:71 in public method `get_secret`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/vault_client.py:103 in public method `put_secret`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/vault_client.py:103 in public method `put_secret`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/coppa/consent_manager.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/coppa/consent_manager.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa/consent_manager.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/infrastructure/security/coppa/consent_manager.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/security/coppa/consent_manager.py:24 in public class `COPPAConsentManager`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/coppa/consent_manager.py:24 in public class `COPPAConsentManager`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa/consent_manager.py:44 in public method `verify_parental_consent`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa/consent_manager.py:44 in public method `verify_parental_consent`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/security/coppa/consent_manager.py:44 in public method `verify_parental_consent`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/coppa/consent_manager.py:44 in public method `verify_parental_consent`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/coppa/consent_manager.py:79 in public method `request_parental_consent`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa/consent_manager.py:79 in public method `request_parental_consent`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/security/coppa/consent_manager.py:79 in public method `request_parental_consent`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/coppa/consent_manager.py:79 in public method `request_parental_consent`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/coppa/consent_manager.py:119 in public method `get_child_consent_status`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa/consent_manager.py:119 in public method `get_child_consent_status`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/security/coppa/consent_manager.py:119 in public method `get_child_consent_status`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/coppa/consent_manager.py:119 in public method `get_child_consent_status`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/coppa/consent_manager.py:163 in public method `revoke_consent`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa/consent_manager.py:163 in public method `revoke_consent`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/security/coppa/consent_manager.py:163 in public method `revoke_consent`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/coppa/consent_manager.py:163 in public method `revoke_consent`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/coppa/consent_manager.py:219 in public method `create_consent_record`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa/data_models.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/coppa/data_models.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa/data_models.py:1 at module level:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/coppa/data_models.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/coppa/data_models.py:15 in public class `COPPAChildData`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/coppa/data_models.py:103 in public class `ParentConsent`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/coppa/data_models.py:142 in public class `DataRetentionPolicy`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/coppa/data_models.py:167 in public class `AuditLogEntry`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/coppa/data_models.py:216 in public class `DataDeletionRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/coppa/data_retention.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/coppa/data_retention.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa/data_retention.py:1 at module level:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/coppa/data_retention.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/coppa/data_retention.py:22 in public class `DataRetentionManager`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/coppa/data_retention.py:22 in public class `DataRetentionManager`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/coppa/data_retention.py:22 in public class `DataRetentionManager`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa/data_retention.py:22 in public class `DataRetentionManager`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/coppa/data_retention.py:22 in public class `DataRetentionManager`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/coppa/data_retention.py:30 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/coppa/data_retention.py:47 in public method `create_retention_policy`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/coppa/data_retention.py:47 in public method `create_retention_policy`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa/data_retention.py:47 in public method `create_retention_policy`:
        D400: First line should end with a period (not 'd')
src/infrastructure/security/coppa/data_retention.py:47 in public method `create_retention_policy`:
        D415: First line should end with a period, question mark, or exclamation point (not 'd')
src/infrastructure/security/coppa/data_retention.py:70 in public method `calculate_retention_period`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/coppa/data_retention.py:70 in public method `calculate_retention_period`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa/data_retention.py:70 in public method `calculate_retention_period`:
        D400: First line should end with a period (not 'a')
src/infrastructure/security/coppa/data_retention.py:70 in public method `calculate_retention_period`:
        D415: First line should end with a period, question mark, or exclamation point (not 'a')
src/infrastructure/security/coppa/data_retention.py:92 in public method `schedule_automatic_deletion`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/coppa/data_retention.py:92 in public method `schedule_automatic_deletion`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa/data_retention.py:92 in public method `schedule_automatic_deletion`:
        D400: First line should end with a period (not 'a')
src/infrastructure/security/coppa/data_retention.py:92 in public method `schedule_automatic_deletion`:
        D415: First line should end with a period, question mark, or exclamation point (not 'a')
src/infrastructure/security/coppa/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/coppa/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/coppa/__init__.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/coppa/__init__.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/coppa/__init__.py:16 in public function `get_consent_manager`:
        D401: First line should be in imperative mood; try rephrasing (found 'Factory')
src/infrastructure/security/hardening/csrf_protection.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/hardening/csrf_protection.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/hardening/csrf_protection.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/infrastructure/security/hardening/csrf_protection.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/security/hardening/csrf_protection.py:20 in public class `CSRFConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/hardening/csrf_protection.py:20 in public class `CSRFConfig`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/hardening/csrf_protection.py:20 in public class `CSRFConfig`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/hardening/csrf_protection.py:30 in public method `__post_init__`:
        D105: Missing docstring in magic method
src/infrastructure/security/hardening/csrf_protection.py:36 in public class `CSRFTokenManager`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/hardening/csrf_protection.py:36 in public class `CSRFTokenManager`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/hardening/csrf_protection.py:36 in public class `CSRFTokenManager`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/hardening/csrf_protection.py:36 in public class `CSRFTokenManager`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/hardening/csrf_protection.py:36 in public class `CSRFTokenManager`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/hardening/csrf_protection.py:40 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/hardening/csrf_protection.py:47 in public method `generate_token`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/hardening/csrf_protection.py:47 in public method `generate_token`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/hardening/csrf_protection.py:47 in public method `generate_token`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/hardening/csrf_protection.py:47 in public method `generate_token`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/hardening/csrf_protection.py:83 in public method `validate_token`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/hardening/csrf_protection.py:83 in public method `validate_token`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/hardening/csrf_protection.py:83 in public method `validate_token`:
        D400: First line should end with a period (not 'r')
src/infrastructure/security/hardening/csrf_protection.py:83 in public method `validate_token`:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/security/hardening/csrf_protection.py:118 in public method `invalidate_token`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/hardening/csrf_protection.py:118 in public method `invalidate_token`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/hardening/csrf_protection.py:118 in public method `invalidate_token`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/hardening/csrf_protection.py:118 in public method `invalidate_token`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/hardening/csrf_protection.py:133 in public method `invalidate_session_tokens`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/hardening/csrf_protection.py:133 in public method `invalidate_session_tokens`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/hardening/csrf_protection.py:133 in public method `invalidate_session_tokens`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/hardening/csrf_protection.py:133 in public method `invalidate_session_tokens`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/hardening/csrf_protection.py:153 in private method `_cleanup_expired_tokens`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/hardening/csrf_protection.py:153 in private method `_cleanup_expired_tokens`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/hardening/csrf_protection.py:169 in public method `get_token_stats`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/hardening/csrf_protection.py:169 in public method `get_token_stats`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/hardening/csrf_protection.py:189 in public class `CSRFProtection`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/hardening/csrf_protection.py:189 in public class `CSRFProtection`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/hardening/csrf_protection.py:189 in public class `CSRFProtection`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/hardening/csrf_protection.py:191 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/hardening/csrf_protection.py:196 in public method `generate_token_for_request`:
        D400: First line should end with a period (not 't')
src/infrastructure/security/hardening/csrf_protection.py:196 in public method `generate_token_for_request`:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/infrastructure/security/hardening/csrf_protection.py:202 in public method `validate_request`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/hardening/csrf_protection.py:202 in public method `validate_request`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/hardening/csrf_protection.py:202 in public method `validate_request`:
        D400: First line should end with a period (not 't')
src/infrastructure/security/hardening/csrf_protection.py:202 in public method `validate_request`:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/infrastructure/security/hardening/csrf_protection.py:235 in public method `set_csrf_cookie`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/hardening/csrf_protection.py:235 in public method `set_csrf_cookie`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/hardening/csrf_protection.py:249 in private method `_get_session_id`:
        D400: First line should end with a period (not 't')
src/infrastructure/security/hardening/csrf_protection.py:249 in private method `_get_session_id`:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/infrastructure/security/hardening/csrf_protection.py:259 in private method `_get_user_id`:
        D400: First line should end with a period (not ')')
src/infrastructure/security/hardening/csrf_protection.py:259 in private method `_get_user_id`:
        D415: First line should end with a period, question mark, or exclamation point (not ')')
src/infrastructure/security/hardening/csrf_protection.py:271 in private method `_get_csrf_token_from_request`:
        D400: First line should end with a period (not 'a')
src/infrastructure/security/hardening/csrf_protection.py:271 in private method `_get_csrf_token_from_request`:
        D415: First line should end with a period, question mark, or exclamation point (not 'a')
src/infrastructure/security/hardening/csrf_protection.py:289 in public class `CSRFMiddleware`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/hardening/csrf_protection.py:289 in public class `CSRFMiddleware`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/hardening/csrf_protection.py:289 in public class `CSRFMiddleware`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/hardening/csrf_protection.py:291 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/hardening/csrf_protection.py:295 in public method `__call__`:
        D102: Missing docstring in public method
src/infrastructure/security/hardening/csrf_protection.py:317 in public function `get_csrf_protection`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/hardening/csrf_protection.py:317 in public function `get_csrf_protection`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/hardening/csrf_protection.py:333 in public function `init_csrf_protection`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/hardening/csrf_protection.py:333 in public function `init_csrf_protection`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/hardening/csrf_protection.py:343 in public function `csrf_protect`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/hardening/csrf_protection.py:343 in public function `csrf_protect`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/hardening/csrf_protection.py:343 in public function `csrf_protect`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/infrastructure/security/hardening/input_validation.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/hardening/secure_settings.py:23 in public class `SecureAppSettings`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/hardening/secure_settings.py:80 in public nested class `Config`:
        D106: Missing docstring in public nested class
src/infrastructure/security/hardening/security_tests.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/hardening/security_validator.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/security/hardening/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/hardening/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/hardening/__init__.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/hardening/__init__.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/hardening/security_tests/authentication_tests.py:14 in public class `AuthenticationTester`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/hardening/security_tests/base_tester.py:13 in public class `BaseSecurityTester`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/hardening/security_tests/base_tester.py:15 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/hardening/security_tests/compliance_tests.py:14 in public class `ComplianceTester`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/hardening/security_tests/encryption_tests.py:14 in public class `EncryptionTester`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/hardening/security_tests/injection_tests.py:1 at module level:
        D400: First line should end with a period (not 's')
src/infrastructure/security/hardening/security_tests/injection_tests.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/hardening/security_tests/injection_tests.py:14 in public class `InjectionTester`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/hardening/security_tests/injection_tests.py:14 in public class `InjectionTester`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/hardening/security_tests/injection_tests.py:14 in public class `InjectionTester`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/hardening/security_tests/injection_tests.py:17 in public method `test_code_injection`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/hardening/security_tests/injection_tests.py:17 in public method `test_code_injection`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/hardening/security_tests/injection_tests.py:54 in public method `test_sql_injection`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/hardening/security_tests/injection_tests.py:54 in public method `test_sql_injection`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/hardening/security_tests/injection_tests.py:93 in public method `test_xss_vulnerabilities`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/hardening/security_tests/injection_tests.py:93 in public method `test_xss_vulnerabilities`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/hardening/security_tests/injection_tests.py:146 in public method `test_path_traversal`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/hardening/security_tests/injection_tests.py:146 in public method `test_path_traversal`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/hardening/security_tests/security_tester.py:17 in public class `SecurityTester`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/hardening/security_tests/security_tester.py:19 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/hardening/validation/sanitizer.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/hardening/validation/sanitizer.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/hardening/validation/sanitizer.py:1 at module level:
        D400: First line should end with a period (not 'c')
src/infrastructure/security/hardening/validation/sanitizer.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'c')
src/infrastructure/security/hardening/validation/sanitizer.py:20 in public class `ValidationSeverity`:
        D101: Missing docstring in public class
src/infrastructure/security/hardening/validation/sanitizer.py:27 in public class `ValidationRule`:
        D101: Missing docstring in public class
src/infrastructure/security/hardening/validation/sanitizer.py:34 in public class `InputValidationConfig`:
        D101: Missing docstring in public class
src/infrastructure/security/hardening/validation/sanitizer.py:44 in public function `get_default_validation_rules`:
        D103: Missing docstring in public function
src/infrastructure/security/hardening/validation/sanitizer.py:66 in public function `get_profanity_words`:
        D103: Missing docstring in public function
src/infrastructure/security/hardening/validation/sanitizer.py:88 in public class `InputSanitizer`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/hardening/validation/sanitizer.py:90 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/hardening/validation/sanitizer.py:119 in public method `sanitize_string`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/hardening/validation/sanitizer.py:119 in public method `sanitize_string`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/hardening/validation/sanitizer.py:119 in public method `sanitize_string`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/hardening/validation/sanitizer.py:119 in public method `sanitize_string`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/security/hardening/validation/sanitizer.py:119 in public method `sanitize_string`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/hardening/validation/sanitizer.py:119 in public method `sanitize_string`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/hardening/validation/validation_config.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/hardening/validation/validation_config.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/hardening/validation/validation_config.py:1 at module level:
        D400: First line should end with a period (not 's')
src/infrastructure/security/hardening/validation/validation_config.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/hardening/validation/validation_config.py:13 in public class `ValidationSeverity`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/hardening/validation/validation_config.py:13 in public class `ValidationSeverity`:
        D204: 1 blank line required after class docstring (found 0)
src/infrastructure/security/hardening/validation/validation_config.py:22 in public class `ValidationRule`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/hardening/validation/validation_config.py:22 in public class `ValidationRule`:
        D204: 1 blank line required after class docstring (found 0)
src/infrastructure/security/hardening/validation/validation_config.py:30 in public class `InputValidationConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/hardening/validation/validation_config.py:30 in public class `InputValidationConfig`:
        D204: 1 blank line required after class docstring (found 0)
src/infrastructure/security/hardening/validation/validation_rules.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/hardening/validation/validation_rules.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/hardening/validation/validation_rules.py:1 at module level:
        D400: First line should end with a period (not 's')
src/infrastructure/security/hardening/validation/validation_rules.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/hardening/validation/validation_rules.py:73 in public function `get_profanity_words`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/hardening/validation/validation_rules.py:73 in public function `get_profanity_words`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/hardening/validation/validation_rules.py:73 in public function `get_profanity_words`:
        D400: First line should end with a period (not ')')
src/infrastructure/security/hardening/validation/validation_rules.py:73 in public function `get_profanity_words`:
        D415: First line should end with a period, question mark, or exclamation point (not ')')
src/infrastructure/security/hardening/validation/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/hardening/validation/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/hardening/validation/__init__.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/hardening/validation/__init__.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/input_validation/core.py:7 in public class `SecurityThreat`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/input_validation/core.py:9 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/input_validation/core.py:26 in public class `InputValidationResult`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/input_validation/core.py:28 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/input_validation/detectors.py:14 in public class `SecurityPatterns`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/input_validation/detectors.py:16 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/input_validation/detectors.py:84 in public class `ThreatDetectors`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/input_validation/detectors.py:86 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/input_validation/middleware.py:20 in public class `MockValidator`:
        D101: Missing docstring in public class
src/infrastructure/security/input_validation/middleware.py:21 in public method `validate_input`:
        D102: Missing docstring in public method
src/infrastructure/security/input_validation/middleware.py:26 in public function `get_input_validator`:
        D103: Missing docstring in public function
src/infrastructure/security/input_validation/middleware.py:36 in public class `MockAuditIntegration`:
        D101: Missing docstring in public class
src/infrastructure/security/input_validation/middleware.py:37 in public method `log_security_event`:
        D102: Missing docstring in public method
src/infrastructure/security/input_validation/middleware.py:40 in public function `get_audit_integration`:
        D103: Missing docstring in public function
src/infrastructure/security/input_validation/middleware.py:45 in public class `InputValidationMiddleware`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/input_validation/middleware.py:47 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/input_validation/middleware.py:377 in public function `setup_child_safe_middleware`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/infrastructure/security/input_validation/middleware.py:384 in public function `setup_development_middleware`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/infrastructure/security/input_validation/middleware.py:391 in public function `setup_production_middleware`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/infrastructure/security/input_validation/patterns.py:7 in public class `SecurityPatterns`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/input_validation/patterns.py:9 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/input_validation/patterns.py:78 in private method `_setup_child_safety_patterns`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/infrastructure/security/input_validation/validator.py:19 in public class `ThreatDetectors`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/input_validation/validator.py:21 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/input_validation/validator.py:24 in public method `detect_sql_injection`:
        D102: Missing docstring in public method
src/infrastructure/security/input_validation/validator.py:27 in public method `detect_xss`:
        D102: Missing docstring in public method
src/infrastructure/security/input_validation/validator.py:30 in public method `detect_path_traversal`:
        D102: Missing docstring in public method
src/infrastructure/security/input_validation/validator.py:33 in public method `detect_command_injection`:
        D102: Missing docstring in public method
src/infrastructure/security/input_validation/validator.py:36 in public method `detect_ldap_injection`:
        D102: Missing docstring in public method
src/infrastructure/security/input_validation/validator.py:39 in public method `detect_template_injection`:
        D102: Missing docstring in public method
src/infrastructure/security/input_validation/validator.py:42 in public method `detect_inappropriate_content`:
        D102: Missing docstring in public method
src/infrastructure/security/input_validation/validator.py:45 in public method `detect_pii`:
        D102: Missing docstring in public method
src/infrastructure/security/input_validation/validator.py:48 in public method `detect_encoding_attacks`:
        D102: Missing docstring in public method
src/infrastructure/security/input_validation/validator.py:58 in public class `MockAuditIntegration`:
        D101: Missing docstring in public class
src/infrastructure/security/input_validation/validator.py:59 in public method `log_security_event`:
        D102: Missing docstring in public method
src/infrastructure/security/input_validation/validator.py:62 in public function `get_audit_integration`:
        D103: Missing docstring in public function
src/infrastructure/security/input_validation/validator.py:67 in public class `ComprehensiveInputValidator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/input_validation/validator.py:67 in public class `ComprehensiveInputValidator`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/input_validation/validator.py:81 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/input_validation/validator.py:91 in public method `validate_input`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/input_validation/validator.py:91 in public method `validate_input`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/security/input_validation/validator.py:91 in public method `validate_input`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/input_validation/validator.py:91 in public method `validate_input`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/input_validation/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/input_validation/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_generator.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/key_management/key_generator.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_generator.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/key_management/key_generator.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/key_management/key_generator.py:15 in public class `KeyGenerator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/key_management/key_generator.py:30 in public method `generate_key`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_generator.py:30 in public method `generate_key`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/key_lifecycle_manager.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/key_management/key_lifecycle_manager.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_lifecycle_manager.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/infrastructure/security/key_management/key_lifecycle_manager.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/security/key_management/key_lifecycle_manager.py:21 in public class `KeyLifecycleManager`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/key_management/key_lifecycle_manager.py:24 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_lifecycle_manager.py:24 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/key_lifecycle_manager.py:52 in public method `create_key`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_lifecycle_manager.py:52 in public method `create_key`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/key_lifecycle_manager.py:93 in public method `deactivate_key`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_lifecycle_manager.py:93 in public method `deactivate_key`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/key_lifecycle_manager.py:115 in public method `cleanup_old_keys`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_lifecycle_manager.py:115 in public method `cleanup_old_keys`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/key_rotation_orchestrator.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/key_management/key_rotation_orchestrator.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_rotation_orchestrator.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/infrastructure/security/key_management/key_rotation_orchestrator.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/security/key_management/key_rotation_orchestrator.py:35 in public class `KeyRotationOrchestrator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/key_management/key_rotation_orchestrator.py:35 in public class `KeyRotationOrchestrator`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/key_management/key_rotation_orchestrator.py:35 in public class `KeyRotationOrchestrator`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_rotation_orchestrator.py:41 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_rotation_orchestrator.py:41 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/key_rotation_orchestrator.py:65 in public method `create_key`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_rotation_orchestrator.py:65 in public method `create_key`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/key_rotation_orchestrator.py:81 in public method `rotate_key`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_rotation_orchestrator.py:81 in public method `rotate_key`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/key_rotation_orchestrator.py:93 in public method `rotate_all_keys`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_rotation_orchestrator.py:93 in public method `rotate_all_keys`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/key_rotation_orchestrator.py:115 in public method `perform_scheduled_rotation`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_rotation_orchestrator.py:115 in public method `perform_scheduled_rotation`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/key_management/key_rotation_orchestrator.py:115 in public method `perform_scheduled_rotation`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/key_management/key_rotation_orchestrator.py:127 in public method `emergency_rotation`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_rotation_orchestrator.py:127 in public method `emergency_rotation`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/key_rotation_orchestrator.py:138 in public method `cleanup_old_keys`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_rotation_orchestrator.py:138 in public method `cleanup_old_keys`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/key_rotation_orchestrator.py:151 in public method `get_rotation_statistics`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_rotation_orchestrator.py:151 in public method `get_rotation_statistics`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/key_management/key_rotation_orchestrator.py:151 in public method `get_rotation_statistics`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/key_management/key_rotation_orchestrator.py:160 in public method `check_rotation_needed`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/key_rotation_orchestrator.py:160 in public method `check_rotation_needed`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/key_management/key_rotation_orchestrator.py:160 in public method `check_rotation_needed`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/key_management/rotation_executor.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/key_management/rotation_executor.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_executor.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/infrastructure/security/key_management/rotation_executor.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/security/key_management/rotation_executor.py:30 in public class `RotationExecutor`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/key_management/rotation_executor.py:39 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_executor.py:39 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/rotation_executor.py:60 in public method `rotate_key`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_executor.py:60 in public method `rotate_key`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/rotation_executor.py:137 in public method `perform_scheduled_rotation`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_executor.py:137 in public method `perform_scheduled_rotation`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/key_management/rotation_executor.py:137 in public method `perform_scheduled_rotation`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/key_management/rotation_executor.py:172 in public method `emergency_rotation`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_executor.py:172 in public method `emergency_rotation`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/rotation_policy_manager.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/key_management/rotation_policy_manager.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_policy_manager.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/infrastructure/security/key_management/rotation_policy_manager.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/security/key_management/rotation_policy_manager.py:18 in public class `RotationPolicyManager`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/key_management/rotation_policy_manager.py:21 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_policy_manager.py:21 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/rotation_policy_manager.py:32 in public method `check_rotation_needed`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_policy_manager.py:32 in public method `check_rotation_needed`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/rotation_policy_manager.py:60 in public method `get_keys_needing_rotation`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_policy_manager.py:60 in public method `get_keys_needing_rotation`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/key_management/rotation_policy_manager.py:60 in public method `get_keys_needing_rotation`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/key_management/rotation_policy_manager.py:73 in public method `get_next_rotation_time`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_policy_manager.py:73 in public method `get_next_rotation_time`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/key_management/rotation_policy_manager.py:73 in public method `get_next_rotation_time`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/key_management/rotation_policy_manager.py:92 in public method `get_affected_services`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_policy_manager.py:92 in public method `get_affected_services`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/rotation_statistics.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/key_management/rotation_statistics.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_statistics.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/key_management/rotation_statistics.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/key_management/rotation_statistics.py:22 in public class `RotationStatistics`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/key_management/rotation_statistics.py:29 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_statistics.py:29 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/rotation_statistics.py:40 in public method `get_rotation_statistics`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_statistics.py:40 in public method `get_rotation_statistics`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/key_management/rotation_statistics.py:40 in public method `get_rotation_statistics`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/key_management/rotation_statistics.py:80 in private method `_calculate_average_age`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_statistics.py:80 in private method `_calculate_average_age`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/rotation_statistics.py:96 in public method `get_key_usage_report`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_statistics.py:96 in public method `get_key_usage_report`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/key_management/rotation_statistics.py:96 in public method `get_key_usage_report`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/key_management/rotation_statistics.py:123 in public method `get_rotation_history`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/rotation_statistics.py:123 in public method `get_rotation_history`:
        D407: Missing dashed underline after section ('Args')
src/infrastructure/security/key_management/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/key_management/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/key_management/__init__.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/key_management/__init__.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/rate_limiter/child_safety.py:14 in public class `ChildSafetyHandler`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/rate_limiter/child_safety.py:16 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/rate_limiter/config.py:7 in public class `DefaultConfigurations`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/rate_limiter/core.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/rate_limiter/core.py:16 in public class `RateLimitType`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/rate_limiter/core.py:31 in public class `RateLimitStrategy`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/rate_limiter/core.py:41 in public class `RateLimitConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/rate_limiter/core.py:69 in public class `RateLimitState`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/rate_limiter/core.py:82 in public class `RateLimitResult`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/rate_limiter/core.py:94 in public class `RedisRateLimiter`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/rate_limiter/core.py:94 in public class `RedisRateLimiter`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/rate_limiter/core.py:94 in public class `RedisRateLimiter`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/rate_limiter/core.py:94 in public class `RedisRateLimiter`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/rate_limiter/core.py:94 in public class `RedisRateLimiter`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/rate_limiter/core.py:98 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/rate_limiter/core.py:192 in public class `ChildSafetyRateLimiter`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/rate_limiter/core.py:194 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/rate_limiter/service.py:22 in public class `ComprehensiveRateLimiter`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/rate_limiter/service.py:22 in public class `ComprehensiveRateLimiter`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/rate_limiter/service.py:34 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/rate_limiter/service.py:53 in public method `check_rate_limit`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/rate_limiter/service.py:53 in public method `check_rate_limit`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/security/rate_limiter/service.py:53 in public method `check_rate_limit`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/security/rate_limiter/storage.py:14 in public class `RateLimitStorage`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/rate_limiter/storage.py:16 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/rate_limiter/strategies.py:14 in public class `RateLimitingStrategies`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/rate_limiter/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/safe_expression_parser/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/security/safe_expression_parser/__init__.py:9 in public class `ExpressionContext`:
        D101: Missing docstring in public class
src/infrastructure/security/safe_expression_parser/__init__.py:13 in public class `SafeExpressionConfig`:
        D101: Missing docstring in public class
src/infrastructure/security/safe_expression_parser/__init__.py:14 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/safe_expression_parser/__init__.py:18 in public class `SafeExpressionParser`:
        D101: Missing docstring in public class
src/infrastructure/security/safe_expression_parser/__init__.py:19 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/safe_expression_parser/__init__.py:22 in public method `evaluate`:
        D102: Missing docstring in public method
src/infrastructure/security/validation/query_validator.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/validation/query_validator.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/validation/query_validator.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/validation/query_validator.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/validation/query_validator.py:17 in public class `QueryValidationResult`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/validation/query_validator.py:17 in public class `QueryValidationResult`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/validation/query_validator.py:17 in public class `QueryValidationResult`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/validation/query_validator.py:27 in public class `SQLQueryValidator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/security/validation/query_validator.py:27 in public class `SQLQueryValidator`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/validation/query_validator.py:27 in public class `SQLQueryValidator`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/validation/query_validator.py:27 in public class `SQLQueryValidator`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/validation/query_validator.py:27 in public class `SQLQueryValidator`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/validation/query_validator.py:36 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/security/validation/query_validator.py:85 in public method `validate_query_parameters`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/validation/query_validator.py:85 in public method `validate_query_parameters`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/validation/query_validator.py:136 in public method `validate_table_name`:
        D400: First line should end with a period (not 't')
src/infrastructure/security/validation/query_validator.py:136 in public method `validate_table_name`:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/infrastructure/security/validation/query_validator.py:150 in public method `validate_column_name`:
        D400: First line should end with a period (not 't')
src/infrastructure/security/validation/query_validator.py:150 in public method `validate_column_name`:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/infrastructure/security/validation/query_validator.py:181 in public method `create_safe_where_clause`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/validation/query_validator.py:181 in public method `create_safe_where_clause`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/validation/query_validator.py:207 in public method `validate_child_data_query`:
        D400: First line should end with a period (not 'a')
src/infrastructure/security/validation/query_validator.py:207 in public method `validate_child_data_query`:
        D415: First line should end with a period, question mark, or exclamation point (not 'a')
src/infrastructure/security/validation/query_validator.py:207 in public method `validate_child_data_query`:
        D401: First line should be in imperative mood; try rephrasing (found 'Special')
src/infrastructure/security/validation/query_validator.py:241 in public method `log_security_event`:
        D400: First line should end with a period (not 'g')
src/infrastructure/security/validation/query_validator.py:241 in public method `log_security_event`:
        D415: First line should end with a period, question mark, or exclamation point (not 'g')
src/infrastructure/security/validation/query_validator.py:260 in public method `sanitize_query_string`:
        D400: First line should end with a period (not ')')
src/infrastructure/security/validation/query_validator.py:260 in public method `sanitize_query_string`:
        D415: First line should end with a period, question mark, or exclamation point (not ')')
src/infrastructure/security/validation/query_validator.py:279 in public method `get_safe_limit_offset`:
        D400: First line should end with a period (not 's')
src/infrastructure/security/validation/query_validator.py:279 in public method `get_safe_limit_offset`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/infrastructure/security/validation/query_validator.py:323 in public function `get_query_validator`:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/validation/query_validator.py:323 in public function `get_query_validator`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/security/validation/query_validator.py:332 in public function `validate_params`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/validation/query_validator.py:332 in public function `validate_params`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/validation/query_validator.py:338 in public function `is_safe_table`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/validation/query_validator.py:338 in public function `is_safe_table`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/validation/query_validator.py:344 in public function `is_safe_column`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/validation/query_validator.py:344 in public function `is_safe_column`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/validation/query_validator.py:350 in public function `create_safe_where`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/validation/query_validator.py:350 in public function `create_safe_where`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/validation/query_validator.py:358 in public function `validate_child_query`:
        D400: First line should end with a period (not 'n')
src/infrastructure/security/validation/query_validator.py:358 in public function `validate_child_query`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/security/validation/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/security/validation/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/security/validation/__init__.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/security/validation/__init__.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/services/data_retention_service.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/services/data_retention_service.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/services/data_retention_service.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/services/data_retention_service.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/services/data_retention_service.py:19 in public class `RetentionStatus`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/services/data_retention_service.py:29 in public class `COPPADataRetentionService`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/services/data_retention_service.py:29 in public class `COPPADataRetentionService`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/services/data_retention_service.py:54 in public method `register_child_data`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/services/data_retention_service.py:54 in public method `register_child_data`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/services/data_retention_service.py:54 in public method `register_child_data`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/services/data_retention_service.py:54 in public method `register_child_data`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/services/data_retention_service.py:102 in public method `schedule_daily_retention_check`:
        D205: 1 blank line required between summary line and description (found 0)
src/infrastructure/services/data_retention_service.py:102 in public method `schedule_daily_retention_check`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/session_manager/session_models.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/session_manager/session_models.py:11 in public class `Session`:
        D101: Missing docstring in public class
src/infrastructure/session_manager/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/state/application_state_manager.py:1 at module level:
        D100: Missing docstring in public module
src/infrastructure/state/application_state_manager.py:6 in public class `StateScope`:
        D101: Missing docstring in public class
src/infrastructure/state/application_state_manager.py:12 in public class `ApplicationStateManager`:
        D101: Missing docstring in public class
src/infrastructure/state/application_state_manager.py:13 in public method `__init__`:
        D107: Missing docstring in __init__
src/infrastructure/state/application_state_manager.py:17 in public method `set_state`:
        D102: Missing docstring in public method
src/infrastructure/state/application_state_manager.py:26 in public method `get_state`:
        D102: Missing docstring in public method
src/infrastructure/state/application_state_manager.py:29 in public method `has_state`:
        D102: Missing docstring in public method
src/infrastructure/state/application_state_manager.py:32 in public method `delete_state`:
        D102: Missing docstring in public method
src/infrastructure/state/application_state_manager.py:36 in public method `async_request_context`:
        D102: Missing docstring in public method
src/infrastructure/state/application_state_manager.py:46 in public method `session_context`:
        D102: Missing docstring in public method
src/infrastructure/state/application_state_manager.py:57 in public function `create_state_manager`:
        D103: Missing docstring in public function
src/infrastructure/state/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/infrastructure/validation/child_safety_validator.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/validation/child_safety_validator.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/infrastructure/validation/child_safety_validator.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/infrastructure/validation/comprehensive_validator.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/validation/comprehensive_validator.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/infrastructure/validation/comprehensive_validator.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/validation/comprehensive_validator.py:20 in public class `ComprehensiveValidator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/validation/comprehensive_validator.py:20 in public class `ComprehensiveValidator`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/validation/comprehensive_validator.py:48 in public method `validate_child_registration`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/validation/comprehensive_validator.py:48 in public method `validate_child_registration`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/validation/comprehensive_validator.py:48 in public method `validate_child_registration`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/validation/comprehensive_validator.py:48 in public method `validate_child_registration`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/validation/comprehensive_validator.py:116 in public method `validate_message_input`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/validation/comprehensive_validator.py:116 in public method `validate_message_input`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/validation/comprehensive_validator.py:116 in public method `validate_message_input`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/validation/comprehensive_validator.py:116 in public method `validate_message_input`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/validation/comprehensive_validator.py:183 in public method `validate_file_upload`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/validation/comprehensive_validator.py:183 in public method `validate_file_upload`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/validation/comprehensive_validator.py:183 in public method `validate_file_upload`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/validation/comprehensive_validator.py:183 in public method `validate_file_upload`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/validation/comprehensive_validator.py:219 in public method `validate_parent_data`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/validation/comprehensive_validator.py:219 in public method `validate_parent_data`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/validation/comprehensive_validator.py:219 in public method `validate_parent_data`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/validation/comprehensive_validator.py:219 in public method `validate_parent_data`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/validation/comprehensive_validator.py:265 in public method `validate_search_query`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/validation/comprehensive_validator.py:265 in public method `validate_search_query`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/validation/comprehensive_validator.py:265 in public method `validate_search_query`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/validation/comprehensive_validator.py:265 in public method `validate_search_query`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/validation/comprehensive_validator.py:337 in public function `validate_child_registration`:
        D401: First line should be in imperative mood; try rephrasing (found 'Convenient')
src/infrastructure/validation/comprehensive_validator.py:343 in public function `validate_message_input`:
        D401: First line should be in imperative mood; try rephrasing (found 'Convenient')
src/infrastructure/validation/comprehensive_validator.py:349 in public function `validate_file_upload`:
        D401: First line should be in imperative mood; try rephrasing (found 'Convenient')
src/infrastructure/validation/emergency_contact_validator.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/validation/emergency_contact_validator.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/infrastructure/validation/emergency_contact_validator.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/infrastructure/validation/emergency_contact_validator.py:17 in public class `EmergencyContact`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/validation/emergency_contact_validator.py:28 in public class `EmergencyContactValidator`:
        D203: 1 blank line required before class docstring (found 0)
src/infrastructure/validation/emergency_contact_validator.py:28 in public class `EmergencyContactValidator`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/validation/emergency_contact_validator.py:80 in public method `validate_emergency_contact`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/validation/emergency_contact_validator.py:80 in public method `validate_emergency_contact`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/validation/emergency_contact_validator.py:80 in public method `validate_emergency_contact`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/validation/emergency_contact_validator.py:80 in public method `validate_emergency_contact`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/validation/emergency_contact_validator.py:146 in public method `validate_emergency_contacts_list`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/validation/emergency_contact_validator.py:146 in public method `validate_emergency_contacts_list`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/validation/emergency_contact_validator.py:146 in public method `validate_emergency_contacts_list`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/validation/emergency_contact_validator.py:146 in public method `validate_emergency_contacts_list`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/validation/emergency_contact_validator.py:372 in public method `get_contact_accessibility_score`:
        D213: Multi-line docstring summary should start at the second line
src/infrastructure/validation/emergency_contact_validator.py:372 in public method `get_contact_accessibility_score`:
        D413: Missing blank line after last section ('Returns')
src/infrastructure/validation/emergency_contact_validator.py:372 in public method `get_contact_accessibility_score`:
        D407: Missing dashed underline after section ('Returns')
src/infrastructure/validation/emergency_contact_validator.py:372 in public method `get_contact_accessibility_score`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/infrastructure/validation/general_input_validator.py:1 at module level:
        D400: First line should end with a period (not 'n')
src/infrastructure/validation/general_input_validator.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/infrastructure/validation/general_input_validator.py:5 in public class `GeneralInputValidator`:
        D101: Missing docstring in public class
src/infrastructure/validation/general_input_validator.py:6 in public method `validate_text`:
        D102: Missing docstring in public method
src/infrastructure/validation/general_input_validator.py:9 in public method `validate_email`:
        D102: Missing docstring in public method
src/infrastructure/validation/general_input_validator.py:14 in public function `get_general_input_validator`:
        D103: Missing docstring in public function
src/presentation/routing.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/routing.py:44 in public function `setup_routing`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/routing.py:44 in public function `setup_routing`:
        D407: Missing dashed underline after section ('Args')
src/presentation/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/esp32_endpoints.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/api/esp32_endpoints.py:29 in public function `get_current_user_esp32`:
        D400: First line should end with a period (not 's')
src/presentation/api/esp32_endpoints.py:29 in public function `get_current_user_esp32`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/presentation/api/esp32_endpoints.py:61 in public class `AudioRequest`:
        D101: Missing docstring in public class
src/presentation/api/esp32_endpoints.py:70 in public class `AudioResponse`:
        D101: Missing docstring in public class
src/presentation/api/esp32_endpoints.py:79 in public class `DeviceStatusRequest`:
        D101: Missing docstring in public class
src/presentation/api/esp32_endpoints.py:97 in public function `process_audio`:
        D400: First line should end with a period (not 'e')
src/presentation/api/esp32_endpoints.py:97 in public function `process_audio`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/presentation/api/esp32_endpoints.py:177 in public function `update_device_status`:
        D400: First line should end with a period (not 's')
src/presentation/api/esp32_endpoints.py:177 in public function `update_device_status`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/presentation/api/esp32_endpoints.py:191 in public function `health_check`:
        D400: First line should end with a period (not 'h')
src/presentation/api/esp32_endpoints.py:191 in public function `health_check`:
        D415: First line should end with a period, question mark, or exclamation point (not 'h')
src/presentation/api/esp32_endpoints.py:206 in public function `get_device_config`:
        D400: First line should end with a period (not 'n')
src/presentation/api/esp32_endpoints.py:206 in public function `get_device_config`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/presentation/api/health_endpoints.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/api/main_router.py:1 at module level:
        D400: First line should end with a period (not 's')
src/presentation/api/main_router.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/presentation/api/main_router.py:46 in public function `api_info`:
        D401: First line should be in imperative mood; try rephrasing (found 'API')
src/presentation/api/openapi_config.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/parental_dashboard.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/api/parental_dashboard.py:31 in public class `CreateChildRequest`:
        D101: Missing docstring in public class
src/presentation/api/parental_dashboard.py:51 in public class `UpdateChildRequest`:
        D101: Missing docstring in public class
src/presentation/api/parental_dashboard.py:70 in public class `ParentConsentRequest`:
        D101: Missing docstring in public class
src/presentation/api/parental_dashboard.py:91 in public class `ConsentStatusResponse`:
        D101: Missing docstring in public class
src/presentation/api/parental_dashboard.py:105 in public function `create_child_profile_endpoint`:
        D103: Missing docstring in public function
src/presentation/api/parental_dashboard.py:124 in public function `get_child_profile_endpoint`:
        D103: Missing docstring in public function
src/presentation/api/parental_dashboard.py:137 in public function `update_child_profile_endpoint`:
        D103: Missing docstring in public function
src/presentation/api/parental_dashboard.py:153 in public function `delete_child_profile_endpoint`:
        D103: Missing docstring in public function
src/presentation/api/parental_dashboard.py:165 in public function `generate_child_story_endpoint`:
        D103: Missing docstring in public function
src/presentation/api/parental_dashboard.py:193 in public function `request_consent_verification`:
        D103: Missing docstring in public function
src/presentation/api/parental_dashboard.py:224 in public function `grant_parental_consent`:
        D103: Missing docstring in public function
src/presentation/api/parental_dashboard.py:267 in public function `get_consent_status`:
        D103: Missing docstring in public function
src/presentation/api/parental_dashboard.py:290 in public function `revoke_consent`:
        D103: Missing docstring in public function
src/presentation/api/validators.py:12 in public class `ChildValidationMixin`:
        D101: Missing docstring in public class
src/presentation/api/validators.py:15 in public method `validate_age`:
        D102: Missing docstring in public method
src/presentation/api/validators.py:24 in public method `validate_name`:
        D102: Missing docstring in public method
src/presentation/api/validators.py:48 in public method `validate_interests`:
        D102: Missing docstring in public method
src/presentation/api/validators.py:75 in public method `validate_language`:
        D102: Missing docstring in public method
src/presentation/api/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/presentation/api/decorators/rate_limit.py:1 at module level:
        D400: First line should end with a period (not 's')
src/presentation/api/decorators/rate_limit.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/presentation/api/decorators/rate_limit.py:15 in public function `rate_limit`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/decorators/rate_limit.py:15 in public function `rate_limit`:
        D413: Missing blank line after last section ('Args')
src/presentation/api/decorators/rate_limit.py:15 in public function `rate_limit`:
        D407: Missing dashed underline after section ('Args')
src/presentation/api/decorators/rate_limit.py:66 in public function `check_child_interaction_limit`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/decorators/rate_limit.py:66 in public function `check_child_interaction_limit`:
        D413: Missing blank line after last section ('Raises')
src/presentation/api/decorators/rate_limit.py:66 in public function `check_child_interaction_limit`:
        D407: Missing dashed underline after section ('Raises')
src/presentation/api/decorators/rate_limit.py:66 in public function `check_child_interaction_limit`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/presentation/api/dependencies/auth.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/api/dependencies/auth.py:16 in public function `get_authenticated_user`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/dependencies/auth.py:16 in public function `get_authenticated_user`:
        D407: Missing dashed underline after section ('Returns')
src/presentation/api/dependencies/auth.py:16 in public function `get_authenticated_user`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/presentation/api/dependencies/base.py:9 in public class `ServiceFactory`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/dependencies/base.py:17 in public class `LazyServiceProvider`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/dependencies/base.py:19 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/dependencies/base.py:23 in public method `get`:
        D102: Missing docstring in public method
src/presentation/api/emergency_response/endpoints.py:1 at module level:
        D400: First line should end with a period (not 'm')
src/presentation/api/emergency_response/endpoints.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'm')
src/presentation/api/emergency_response/endpoints.py:34 in public class `EmergencyEndpoints`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/emergency_response/endpoints.py:36 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/emergency_response/models.py:1 at module level:
        D400: First line should end with a period (not 'm')
src/presentation/api/emergency_response/models.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'm')
src/presentation/api/emergency_response/models.py:10 in public class `AlertPayload`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/emergency_response/models.py:18 in public class `EmergencyAlert`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/emergency_response/models.py:31 in public class `SystemStatus`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/emergency_response/models.py:41 in public class `HealthResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/emergency_response/models.py:51 in public class `NotificationRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/emergency_response/models.py:61 in public class `ResponseAction`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/emergency_response/models.py:72 in public class `EmergencyContact`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/emergency_response/models.py:84 in public class `AlertRule`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/emergency_response/models.py:97 in public class `SafetyIncident`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/emergency_response/models.py:112 in public class `AlertHistory`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/emergency_response/models.py:123 in public class `ParentNotification`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/emergency_response/models.py:138 in public class `SystemConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/emergency_response/services.py:1 at module level:
        D400: First line should end with a period (not 'g')
src/presentation/api/emergency_response/services.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'g')
src/presentation/api/emergency_response/services.py:20 in public class `EmergencyResponseService`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/emergency_response/services.py:22 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/emergency_response/services.py:183 in public class `SystemMonitorService`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/emergency_response/services.py:185 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/emergency_response/services.py:283 in public class `EmergencyNotificationService`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/emergency_response/services.py:285 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/emergency_response/__init__.py:1 at module level:
        D400: First line should end with a period (not 's')
src/presentation/api/emergency_response/__init__.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/presentation/api/endpoints/audio.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/api/endpoints/auth.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/api/endpoints/children_legacy.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/children_legacy.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/children_legacy.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/presentation/api/endpoints/children_legacy.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/presentation/api/endpoints/conversations.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/api/endpoints/conversations.py:34 in public function `get_authenticated_user`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/conversations.py:34 in public function `get_authenticated_user`:
        D407: Missing dashed underline after section ('Returns')
src/presentation/api/endpoints/conversations.py:34 in public function `get_authenticated_user`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/presentation/api/endpoints/conversations.py:34 in public function `get_authenticated_user`:
        D407: Missing dashed underline after section ('Raises')
src/presentation/api/endpoints/conversations.py:34 in public function `get_authenticated_user`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/presentation/api/endpoints/conversations_paginated.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/conversations_paginated.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/conversations_paginated.py:1 at module level:
        D400: First line should end with a period (not 's')
src/presentation/api/endpoints/conversations_paginated.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/presentation/api/endpoints/conversations_paginated.py:62 in public class `ConversationPaginationService`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/coppa_notices.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/coppa_notices.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/coppa_notices.py:1 at module level:
        D400: First line should end with a period (not 's')
src/presentation/api/endpoints/coppa_notices.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/presentation/api/endpoints/coppa_notices.py:23 in public class `COPPANoticeResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/coppa_notices.py:34 in public class `COPPAValidatorStatus`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/coppa_notices.py:43 in public function `get_coppa_status`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/coppa_notices.py:43 in public function `get_coppa_status`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/coppa_notices.py:43 in public function `get_coppa_status`:
        D400: First line should end with a period (not 's')
src/presentation/api/endpoints/coppa_notices.py:43 in public function `get_coppa_status`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/presentation/api/endpoints/coppa_notices.py:67 in public function `get_coppa_notice`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/coppa_notices.py:67 in public function `get_coppa_notice`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/coppa_notices.py:67 in public function `get_coppa_notice`:
        D400: First line should end with a period (not 'e')
src/presentation/api/endpoints/coppa_notices.py:67 in public function `get_coppa_notice`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/presentation/api/endpoints/coppa_notices.py:117 in public function `get_child_privacy_settings`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/coppa_notices.py:117 in public function `get_child_privacy_settings`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/coppa_notices.py:117 in public function `get_child_privacy_settings`:
        D400: First line should end with a period (not 'd')
src/presentation/api/endpoints/coppa_notices.py:117 in public function `get_child_privacy_settings`:
        D415: First line should end with a period, question mark, or exclamation point (not 'd')
src/presentation/api/endpoints/coppa_notices.py:168 in public function `request_coppa_consent`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/coppa_notices.py:168 in public function `request_coppa_consent`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/coppa_notices.py:168 in public function `request_coppa_consent`:
        D400: First line should end with a period (not 'd')
src/presentation/api/endpoints/coppa_notices.py:168 in public function `request_coppa_consent`:
        D415: First line should end with a period, question mark, or exclamation point (not 'd')
src/presentation/api/endpoints/coppa_notices.py:220 in public function `request_data_deletion`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/coppa_notices.py:220 in public function `request_data_deletion`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/coppa_notices.py:220 in public function `request_data_deletion`:
        D400: First line should end with a period (not 'a')
src/presentation/api/endpoints/coppa_notices.py:220 in public function `request_data_deletion`:
        D415: First line should end with a period, question mark, or exclamation point (not 'a')
src/presentation/api/endpoints/dashboard.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/dashboard.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/dashboard.py:1 at module level:
        D400: First line should end with a period (not 's')
src/presentation/api/endpoints/dashboard.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/presentation/api/endpoints/dashboard.py:99 in public function `get_child_stats`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/dashboard.py:185 in public function `get_devices_status`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/dashboard.py:299 in public function `get_system_health`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/device.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/api/endpoints/device.py:25 in public class `DeviceRegistration`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/device.py:25 in public class `DeviceRegistration`:
        D400: First line should end with a period (not 'n')
src/presentation/api/endpoints/device.py:25 in public class `DeviceRegistration`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/presentation/api/endpoints/device.py:61 in public class `DeviceStatus`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/device.py:61 in public class `DeviceStatus`:
        D400: First line should end with a period (not 'n')
src/presentation/api/endpoints/device.py:61 in public class `DeviceStatus`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/presentation/api/endpoints/device.py:83 in public function `register_device`:
        D400: First line should end with a period (not 'e')
src/presentation/api/endpoints/device.py:83 in public function `register_device`:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/presentation/api/endpoints/device.py:131 in public function `get_device_status`:
        D400: First line should end with a period (not 's')
src/presentation/api/endpoints/device.py:131 in public function `get_device_status`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/presentation/api/endpoints/device.py:159 in public class `AudioUploadRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/device.py:159 in public class `AudioUploadRequest`:
        D400: First line should end with a period (not 'n')
src/presentation/api/endpoints/device.py:159 in public class `AudioUploadRequest`:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/presentation/api/endpoints/device.py:194 in public function `upload_audio`:
        D400: First line should end with a period (not '2')
src/presentation/api/endpoints/device.py:194 in public function `upload_audio`:
        D415: First line should end with a period, question mark, or exclamation point (not '2')
src/presentation/api/endpoints/device.py:229 in public class `DeviceConfig`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/device.py:229 in public class `DeviceConfig`:
        D400: First line should end with a period (not 'l')
src/presentation/api/endpoints/device.py:229 in public class `DeviceConfig`:
        D415: First line should end with a period, question mark, or exclamation point (not 'l')
src/presentation/api/endpoints/device.py:250 in public function `get_device_config`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/device.py:250 in public function `get_device_config`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/health.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/health.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/health.py:1 at module level:
        D400: First line should end with a period (not 's')
src/presentation/api/endpoints/health.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/presentation/api/endpoints/health.py:55 in public class `HealthStatus`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/health.py:123 in public function `basic_health_check`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/health.py:123 in public function `basic_health_check`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/health.py:123 in public function `basic_health_check`:
        D401: First line should be in imperative mood; try rephrasing (found 'Basic')
src/presentation/api/endpoints/health.py:208 in public function `readiness_check`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/health.py:208 in public function `readiness_check`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/health.py:255 in public function `liveness_check`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/health.py:255 in public function `liveness_check`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/monitoring_dashboard.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/api/endpoints/monitoring_dashboard.py:36 in public class `MonitoringDashboardService`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/auth/routes_di.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/api/endpoints/children/compliance.py:23 in public class `ConsentRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/compliance.py:23 in public class `ConsentRequest`:
        D204: 1 blank line required after class docstring (found 0)
src/presentation/api/endpoints/children/compliance.py:29 in public class `ConsentResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/compliance.py:29 in public class `ConsentResponse`:
        D204: 1 blank line required after class docstring (found 0)
src/presentation/api/endpoints/children/compliance.py:35 in public class `ComplianceValidator`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/compliance.py:37 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/endpoints/children/compliance.py:68 in public class `DataRetentionManager`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/compliance.py:70 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/endpoints/children/compliance.py:122 in public class `COPPAIntegration`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/compliance.py:122 in public class `COPPAIntegration`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/children/compliance.py:129 in public method `__init__`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/children/compliance.py:129 in public method `__init__`:
        D413: Missing blank line after last section ('Args')
src/presentation/api/endpoints/children/compliance.py:129 in public method `__init__`:
        D407: Missing dashed underline after section ('Args')
src/presentation/api/endpoints/children/compliance.py:143 in public method `validate_child_creation`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/children/compliance.py:143 in public method `validate_child_creation`:
        D413: Missing blank line after last section ('Returns')
src/presentation/api/endpoints/children/compliance.py:143 in public method `validate_child_creation`:
        D407: Missing dashed underline after section ('Returns')
src/presentation/api/endpoints/children/compliance.py:143 in public method `validate_child_creation`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/presentation/api/endpoints/children/compliance.py:163 in public method `get_compliance_requirements`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/children/compliance.py:163 in public method `get_compliance_requirements`:
        D413: Missing blank line after last section ('Returns')
src/presentation/api/endpoints/children/compliance.py:163 in public method `get_compliance_requirements`:
        D407: Missing dashed underline after section ('Returns')
src/presentation/api/endpoints/children/compliance.py:163 in public method `get_compliance_requirements`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/presentation/api/endpoints/children/create_child.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/children/create_child.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/children/create_child.py:1 at module level:
        D400: First line should end with a period (not 't')
src/presentation/api/endpoints/children/create_child.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/presentation/api/endpoints/children/get_children.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/children/get_children.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/children/get_children.py:1 at module level:
        D400: First line should end with a period (not 't')
src/presentation/api/endpoints/children/get_children.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 't')
src/presentation/api/endpoints/children/models.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/api/endpoints/children/models.py:19 in public class `ChildPreferences`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/models.py:28 in public class `ChildCreateRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/models.py:39 in public class `ChildUpdateRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/models.py:50 in public class `ChildResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/models.py:64 in public class `ChildSafetySummary`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/models.py:107 in public class `ChildDeleteResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/operations.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/children/operations.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/children/operations.py:34 in public class `ChildOperations`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/operations.py:36 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/endpoints/children/operations.py:185 in public class `ChildValidationService`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/operations.py:187 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/endpoints/children/operations.py:256 in public class `ChildDataTransformer`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/operations.py:304 in public class `ChildSearchService`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/operations.py:306 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/endpoints/children/routes.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/api/endpoints/children/routes.py:29 in private function `_setup_create_child_route`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/presentation/api/endpoints/children/routes.py:45 in private function `_setup_get_children_route`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/presentation/api/endpoints/children/routes.py:60 in private function `_setup_get_child_route`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/presentation/api/endpoints/children/routes.py:76 in private function `_setup_update_child_route`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/presentation/api/endpoints/children/routes.py:97 in private function `_setup_delete_child_route`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/presentation/api/endpoints/children/routes.py:113 in private function `_setup_safety_routes`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/presentation/api/endpoints/children/routes.py:132 in private function `_setup_monitoring_routes`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/presentation/api/endpoints/children/routes.py:182 in public function `setup_routes`:
        D401: First line should be in imperative mood; try rephrasing (found 'Setup')
src/presentation/api/endpoints/children/routes_refactored.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/children/routes_refactored.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/children/routes_refactored.py:1 at module level:
        D400: First line should end with a period (not 's')
src/presentation/api/endpoints/children/routes_refactored.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/presentation/api/endpoints/children/routes_refactored.py:109 in public function `create_children_router`:
        D401: First line should be in imperative mood; try rephrasing (found 'Factory')
src/presentation/api/endpoints/children/routes_refactored.py:126 in public function `create_extended_children_router`:
        D401: First line should be in imperative mood; try rephrasing (found 'Factory')
src/presentation/api/endpoints/children/routes_refactored.py:225 in public function `create_complete_children_router`:
        D401: First line should be in imperative mood; try rephrasing (found 'Factory')
src/presentation/api/endpoints/children/route_handlers.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/children/route_handlers.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/children/route_handlers.py:34 in public class `ChildRouteHandlers`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/route_handlers.py:37 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/endpoints/children/route_handlers.py:60 in public method `create_child_handler`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/children/route_handlers.py:60 in public method `create_child_handler`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/children/route_handlers.py:60 in public method `create_child_handler`:
        D407: Missing dashed underline after section ('Returns')
src/presentation/api/endpoints/children/route_handlers.py:60 in public method `create_child_handler`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/presentation/api/endpoints/children/route_handlers.py:60 in public method `create_child_handler`:
        D407: Missing dashed underline after section ('Raises')
src/presentation/api/endpoints/children/route_handlers.py:60 in public method `create_child_handler`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/presentation/api/endpoints/children/route_handlers.py:129 in public method `get_children_handler`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/endpoints/children/route_handlers.py:129 in public method `get_children_handler`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/children/route_handlers.py:129 in public method `get_children_handler`:
        D407: Missing dashed underline after section ('Returns')
src/presentation/api/endpoints/children/route_handlers.py:129 in public method `get_children_handler`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/presentation/api/endpoints/children/route_handlers.py:129 in public method `get_children_handler`:
        D407: Missing dashed underline after section ('Raises')
src/presentation/api/endpoints/children/route_handlers.py:129 in public method `get_children_handler`:
        D406: Section name should end with a newline ('Raises', not 'Raises:')
src/presentation/api/endpoints/children/safety.py:20 in public class `HTTPException`:
        D101: Missing docstring in public class
src/presentation/api/endpoints/children/safety.py:21 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/endpoints/children/safety.py:25 in public class `status`:
        D101: Missing docstring in public class
src/presentation/api/endpoints/children/safety.py:43 in public class `SafetyEventTypes`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/safety.py:54 in public class `ChildSafetyManager`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/safety.py:220 in public class `ContentSafetyFilter`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/safety.py:314 in public class `PrivacyProtectionManager`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/safety.py:387 in public class `UsageMonitor`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/endpoints/children/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/endpoints/children/__init__.py:1 at module level:
        D400: First line should end with a period (not 'n')
src/presentation/api/endpoints/children/__init__.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/presentation/api/middleware/child_safe_rate_limiter.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/api/middleware/child_safe_rate_limiter.py:10 in public class `ChildSafeRateLimiter`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/middleware/child_safe_rate_limiter.py:12 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/middleware/consent_verification.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/middleware/consent_verification.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/middleware/consent_verification.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/presentation/api/middleware/consent_verification.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/presentation/api/middleware/consent_verification.py:19 in public class `ConsentVerificationRoute`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/middleware/consent_verification.py:19 in public class `ConsentVerificationRoute`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/middleware/consent_verification.py:19 in public class `ConsentVerificationRoute`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/middleware/consent_verification.py:19 in public class `ConsentVerificationRoute`:
        D400: First line should end with a period (not 's')
src/presentation/api/middleware/consent_verification.py:19 in public class `ConsentVerificationRoute`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/presentation/api/middleware/consent_verification.py:23 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/middleware/consent_verification.py:34 in public method `get_route_handler`:
        D102: Missing docstring in public method
src/presentation/api/middleware/consent_verification.py:176 in public function `require_consent`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/middleware/consent_verification.py:176 in public function `require_consent`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/middleware/consent_verification.py:176 in public function `require_consent`:
        D400: First line should end with a period (not 's')
src/presentation/api/middleware/consent_verification.py:176 in public function `require_consent`:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/presentation/api/middleware/consent_verification.py:176 in public function `require_consent`:
        D401: First line should be in imperative mood (perhaps 'Decorate', not 'Decorator')
src/presentation/api/middleware/consent_verification.py:191 in public class `ConsentVerificationMiddleware`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/middleware/consent_verification.py:193 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/middleware/consent_verification.py:205 in public method `__call__`:
        D102: Missing docstring in public method
src/presentation/api/middleware/error_handling.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/middleware/error_handling.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/middleware/error_handling.py:1 at module level:
        D400: First line should end with a period (not 'r')
src/presentation/api/middleware/error_handling.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'r')
src/presentation/api/middleware/error_handling.py:22 in public class `ErrorHandlingMiddleware`:
        D200: One-line docstring should fit on one line with quotes (found 3)
src/presentation/api/middleware/error_handling.py:22 in public class `ErrorHandlingMiddleware`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/middleware/error_handling.py:22 in public class `ErrorHandlingMiddleware`:
        D212: Multi-line docstring summary should start at the first line
src/presentation/api/middleware/error_handling.py:26 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/middleware/rate_limit_middleware.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/api/middleware/rate_limit_middleware.py:16 in public class `RateLimitMiddleware`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/middleware/rate_limit_middleware.py:16 in public class `RateLimitMiddleware`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/middleware/rate_limit_middleware.py:16 in public class `RateLimitMiddleware`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/middleware/rate_limit_middleware.py:25 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/middleware/rate_limit_middleware.py:285 in public function `create_rate_limit_middleware`:
        D401: First line should be in imperative mood; try rephrasing (found 'Factory')
src/presentation/api/middleware/request_logging.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/api/middleware/request_logging.py:25 in public class `RequestLoggingMiddleware`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/middleware/request_logging.py:25 in public class `RequestLoggingMiddleware`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/middleware/request_logging.py:25 in public class `RequestLoggingMiddleware`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/middleware/request_logging.py:33 in public method `__init__`:
        D107: Missing docstring in __init__
src/presentation/api/middleware/request_logging.py:79 in public method `dispatch`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/middleware/request_logging.py:79 in public method `dispatch`:
        D407: Missing dashed underline after section ('Args')
src/presentation/api/middleware/request_logging.py:141 in private method `_extract_request_info`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/middleware/request_logging.py:141 in private method `_extract_request_info`:
        D407: Missing dashed underline after section ('Args')
src/presentation/api/middleware/request_logging.py:193 in private method `_extract_response_info`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/middleware/request_logging.py:193 in private method `_extract_response_info`:
        D407: Missing dashed underline after section ('Args')
src/presentation/api/middleware/request_logging.py:210 in private method `_sanitize_data`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/middleware/request_logging.py:210 in private method `_sanitize_data`:
        D407: Missing dashed underline after section ('Args')
src/presentation/api/middleware/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/presentation/api/models/standard_responses.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/models/standard_responses.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/models/standard_responses.py:1 at module level:
        D400: First line should end with a period (not 's')
src/presentation/api/models/standard_responses.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 's')
src/presentation/api/models/standard_responses.py:13 in public class `ResponseStatus`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/standard_responses.py:22 in public class `ResponseCode`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/standard_responses.py:39 in public class `StandardAPIResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/standard_responses.py:39 in public class `StandardAPIResponse`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/models/standard_responses.py:39 in public class `StandardAPIResponse`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/models/standard_responses.py:67 in public nested class `Config`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/standard_responses.py:74 in public class `SuccessResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/standard_responses.py:81 in public class `ErrorResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/standard_responses.py:88 in public class `ChildSafetyResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/standard_responses.py:88 in public class `ChildSafetyResponse`:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/models/standard_responses.py:88 in public class `ChildSafetyResponse`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/models/standard_responses.py:108 in public class `TeddyBearResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/standard_responses.py:125 in public class `AuthenticationResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/standard_responses.py:136 in public class `PaginatedResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/standard_responses.py:147 in public class `HealthCheckResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/standard_responses.py:168 in public class `ValidationErrorDetail`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/standard_responses.py:180 in public class `ValidationErrorResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/standard_responses.py:188 in public class `VoiceProcessingResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/standard_responses.py:203 in public class `ConversationResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/standard_responses.py:221 in public function `create_success_response`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/models/standard_responses.py:221 in public function `create_success_response`:
        D413: Missing blank line after last section ('Returns')
src/presentation/api/models/standard_responses.py:221 in public function `create_success_response`:
        D407: Missing dashed underline after section ('Returns')
src/presentation/api/models/standard_responses.py:221 in public function `create_success_response`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/presentation/api/models/standard_responses.py:247 in public function `create_error_response`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/models/standard_responses.py:247 in public function `create_error_response`:
        D413: Missing blank line after last section ('Returns')
src/presentation/api/models/standard_responses.py:247 in public function `create_error_response`:
        D407: Missing dashed underline after section ('Returns')
src/presentation/api/models/standard_responses.py:247 in public function `create_error_response`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/presentation/api/models/standard_responses.py:277 in public function `create_child_safety_response`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/models/standard_responses.py:277 in public function `create_child_safety_response`:
        D413: Missing blank line after last section ('Returns')
src/presentation/api/models/standard_responses.py:277 in public function `create_child_safety_response`:
        D407: Missing dashed underline after section ('Returns')
src/presentation/api/models/standard_responses.py:277 in public function `create_child_safety_response`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/presentation/api/models/standard_responses.py:314 in public function `create_teddy_bear_response`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/models/standard_responses.py:314 in public function `create_teddy_bear_response`:
        D413: Missing blank line after last section ('Returns')
src/presentation/api/models/standard_responses.py:314 in public function `create_teddy_bear_response`:
        D407: Missing dashed underline after section ('Returns')
src/presentation/api/models/standard_responses.py:314 in public function `create_teddy_bear_response`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/presentation/api/models/standard_responses.py:353 in public function `create_paginated_response`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/models/standard_responses.py:353 in public function `create_paginated_response`:
        D413: Missing blank line after last section ('Returns')
src/presentation/api/models/standard_responses.py:353 in public function `create_paginated_response`:
        D407: Missing dashed underline after section ('Returns')
src/presentation/api/models/standard_responses.py:353 in public function `create_paginated_response`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/presentation/api/models/standard_responses.py:392 in public function `create_voice_processing_response`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/models/standard_responses.py:392 in public function `create_voice_processing_response`:
        D413: Missing blank line after last section ('Returns')
src/presentation/api/models/standard_responses.py:392 in public function `create_voice_processing_response`:
        D407: Missing dashed underline after section ('Returns')
src/presentation/api/models/standard_responses.py:392 in public function `create_voice_processing_response`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/presentation/api/models/standard_responses.py:430 in public function `create_conversation_response`:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/models/standard_responses.py:430 in public function `create_conversation_response`:
        D413: Missing blank line after last section ('Returns')
src/presentation/api/models/standard_responses.py:430 in public function `create_conversation_response`:
        D407: Missing dashed underline after section ('Returns')
src/presentation/api/models/standard_responses.py:430 in public function `create_conversation_response`:
        D406: Section name should end with a newline ('Returns', not 'Returns:')
src/presentation/api/models/validation_models.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/models/validation_models.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/models/validation_models.py:1 at module level:
        D400: First line should end with a period (not 'n')
src/presentation/api/models/validation_models.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'n')
src/presentation/api/models/validation_models.py:18 in public class `ChildAgeGroup`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/validation_models.py:27 in public class `LanguageCode`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/validation_models.py:36 in public class `ContentSafetyLevel`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/validation_models.py:44 in public class `MessageRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/validation_models.py:101 in public class `ChildRegistrationRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/validation_models.py:189 in public class `AudioMessageRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/validation_models.py:232 in public class `EmergencyContactRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/validation_models.py:272 in public class `ParentConsentRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/validation_models.py:320 in public class `HealthCheckRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/validation_models.py:336 in public class `PaginationRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/validation_models.py:377 in public class `FileUploadRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/validation_models.py:445 in public class `ConversationRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/validation_models.py:471 in public class `APIResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/validation_models.py:483 in public class `LoginRequest`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/validation_models.py:483 in public class `LoginRequest`:
        D204: 1 blank line required after class docstring (found 0)
src/presentation/api/models/validation_models.py:489 in public class `LoginResponse`:
        D203: 1 blank line required before class docstring (found 0)
src/presentation/api/models/validation_models.py:489 in public class `LoginResponse`:
        D204: 1 blank line required after class docstring (found 0)
src/presentation/api/models/__init__.py:1 at module level:
        D205: 1 blank line required between summary line and description (found 0)
src/presentation/api/models/__init__.py:1 at module level:
        D213: Multi-line docstring summary should start at the second line
src/presentation/api/models/__init__.py:1 at module level:
        D400: First line should end with a period (not '(')
src/presentation/api/models/__init__.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not '(')
src/presentation/api/websocket/__init__.py:1 at module level:
        D400: First line should end with a period (not 'e')
src/presentation/api/websocket/__init__.py:1 at module level:
        D415: First line should end with a period, question mark, or exclamation point (not 'e')
src/presentation/dependencies/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/presentation/schemas/esp32_schemas.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/schemas/esp32_schemas.py:6 in public class `ESP32AudioRequestSchema`:
        D101: Missing docstring in public class
src/presentation/schemas/esp32_schemas.py:13 in public class `ESP32TextResponseSchema`:
        D101: Missing docstring in public class
src/presentation/schemas/parent_schemas.py:1 at module level:
        D100: Missing docstring in public module
src/presentation/schemas/parent_schemas.py:6 in public class `ChildProfileCreateSchema`:
        D101: Missing docstring in public class
src/presentation/schemas/parent_schemas.py:12 in public class `ChildProfileUpdateSchema`:
        D101: Missing docstring in public class
src/presentation/schemas/parent_schemas.py:17 in public class `ChildProfileResponseSchema`:
        D101: Missing docstring in public class
src/presentation/schemas/parent_schemas.py:23 in public nested class `Config`:
        D106: Missing docstring in public nested class
src/presentation/schemas/__init__.py:1 at module level:
        D104: Missing docstring in public package
src/presentation/websocket/__init__.py:1 at module level:
        D104: Missing docstring in public package

```

⏱️ الوقت المستغرق: 32.63 ثانية


---

## فحص مفاتيح API المكشوفة
```bash
grep -rn --include='*.py' --exclude-dir=.venv --exclude-dir=venv --exclude-dir=__pycache__ --exclude-dir=build --exclude-dir=dist --exclude-dir=.mypy_cache --exclude-dir=node_modules --exclude-dir=.git -E 'api_key|API_KEY|secret_key' src
```

```
src/application/services/ai/main_service.py:35:    def __init__(self, openai_api_key: str, redis_cache=None, settings=None) -> None:
src/application/services/ai/main_service.py:36:        if not openai_api_key:
src/application/services/ai/main_service.py:38:        self.client = AsyncOpenAI(api_key=openai_api_key)
src/application/services/ai/modules/response_generator.py:36:    def __init__(self, api_key: str | None = None, model: str = "gpt-4") -> None:
src/application/services/ai/modules/response_generator.py:43:        if OPENAI_AVAILABLE and api_key:
src/application/services/ai/modules/response_generator.py:45:                self.client = AsyncOpenAI(api_key=api_key)
src/common/constants.py:96:    "api_key",
src/infrastructure/ai/chatgpt/client.py:37:    def __init__(self, api_key: str = None) -> None:
src/infrastructure/ai/chatgpt/client.py:38:        self.api_key = api_key or os.getenv("OPENAI_API_KEY")
src/infrastructure/ai/chatgpt/client.py:39:        if not self.api_key:
src/infrastructure/ai/chatgpt/client.py:42:                "Set OPENAI_API_KEY environment variable or pass api_key parameter."
src/infrastructure/ai/chatgpt/client.py:45:        self.client = OpenAI(api_key=self.api_key)
src/infrastructure/ai/real_ai_service.py:39:        openai_api_key = self.settings.ai.OPENAI_API_KEY
src/infrastructure/ai/real_ai_service.py:40:        if not openai_api_key:
src/infrastructure/ai/real_ai_service.py:42:        self.client = AsyncOpenAI(api_key=openai_api_key)
src/infrastructure/config/ai_settings.py:8:    OPENAI_API_KEY: str = Field(..., env="OPENAI_API_KEY")
src/infrastructure/config/ai_settings.py:13:    ELEVENLABS_API_KEY: str | None = Field(None, env="ELEVENLABS_API_KEY")
src/infrastructure/config/env_security.py:32:    OPENAI_API_KEY = "OPENAI_API_KEY"
src/infrastructure/config/infrastructure_settings.py:57:    datadog_api_key: str | None = None
src/infrastructure/config/infrastructure_settings.py:68:    jwt_secret_key: str = Field(..., env="JWT_SECRET_KEY")
src/infrastructure/config/production_check.py:21:        "OPENAI_API_KEY",
src/infrastructure/config/production_settings.py:116:                "OPENAI_API_KEY",
src/infrastructure/config/secure_settings.py:78:def generate_new_secret_key() -> str:
src/infrastructure/config/secure_settings.py:92:    new_secret = generate_new_secret_key()
src/infrastructure/config/settings.py:107:            if not self.ai.OPENAI_API_KEY or not self.ai.OPENAI_API_KEY.startswith(
src/infrastructure/config/settings.py:111:                    "OPENAI_API_KEY must be a valid OpenAI API key in production.",
src/infrastructure/config/startup_validator.py:74:        if not self.settings.ai.OPENAI_API_KEY:
src/infrastructure/config/startup_validator.py:75:            self._add_error("❌ OPENAI_API_KEY is required but not set")
src/infrastructure/config/startup_validator.py:76:        elif not self.settings.ai.OPENAI_API_KEY.startswith("sk-"):
src/infrastructure/config/startup_validator.py:78:                "❌ OPENAI_API_KEY must be a valid OpenAI API key (starts with 'sk-')",
src/infrastructure/config/startup_validator.py:81:            logger.debug("✅ OPENAI_API_KEY configured")
src/infrastructure/config/startup_validator.py:104:        secret_key = self.settings.security.SECRET_KEY
src/infrastructure/config/startup_validator.py:116:            if dangerous.lower() in secret_key.lower():
src/infrastructure/config/validators.py:13:    def validate_secret_key(cls, v: str) -> str:
src/infrastructure/config/voice_settings.py:8:    VOICE_API_KEY: str | None = Field(None, env="VOICE_API_KEY")
src/infrastructure/di/di_components/service_factory.py:40:            if not hasattr(settings, "OPENAI_API_KEY") or not settings.OPENAI_API_KEY:
src/infrastructure/di/di_components/service_factory.py:41:                raise ValueError("OPENAI_API_KEY is required")
src/infrastructure/di/di_components/service_factory.py:42:            return OpenAIClient(api_key=settings.OPENAI_API_KEY)
src/infrastructure/di/di_components/service_factory.py:48:            logger.critical(f"CRITICAL ERROR: Missing OPENAI_API_KEY in settings: {e}")
src/infrastructure/di/di_components/service_factory.py:49:            raise ValueError("OPENAI_API_KEY configuration required") from e
src/infrastructure/di/di_components/service_factory.py:62:                not hasattr(settings, "ELEVENLABS_API_KEY")
src/infrastructure/di/di_components/service_factory.py:63:                or not settings.ELEVENLABS_API_KEY
src/infrastructure/di/di_components/service_factory.py:65:                raise ValueError("ELEVENLABS_API_KEY is required")
src/infrastructure/di/di_components/service_factory.py:66:            return ElevenLabsClient(api_key=settings.ELEVENLABS_API_KEY)
src/infrastructure/di/di_components/service_factory.py:75:                f"CRITICAL ERROR: Missing ELEVENLABS_API_KEY in settings: {e}",
src/infrastructure/di/di_components/service_factory.py:77:            raise ValueError("ELEVENLABS_API_KEY configuration required") from e
src/infrastructure/external_apis/azure_speech_client.py:5:    def __init__(self, api_key: str, region: str) -> None:
src/infrastructure/external_apis/azure_speech_client.py:6:        self.api_key = api_key
src/infrastructure/external_apis/azure_speech_client.py:13:            "Ocp-Apim-Subscription-Key": self.api_key,
src/infrastructure/external_apis/azure_speech_client.py:39:            "Ocp-Apim-Subscription-Key": self.api_key,
src/infrastructure/external_apis/chatgpt_client.py:28:    def __init__(self, api_key: str = None) -> None:
src/infrastructure/external_apis/chatgpt_client.py:30:        self.api_key = api_key or self.settings.OPENAI_API_KEY
src/infrastructure/external_apis/chatgpt_client.py:31:        if not self.api_key:
src/infrastructure/external_apis/chatgpt_client.py:33:        self.client = AsyncOpenAI(api_key=self.api_key)
src/infrastructure/external_apis/chatgpt_client.py:187:    # This requires OPENAI_API_KEY to be set in the environment or a .env file
src/infrastructure/external_apis/chatgpt_client.py:220:    # OPENAI_API_KEY="your_key_here"
src/infrastructure/external_apis/elevenlabs_client.py:6:    def __init__(self, api_key: SecretStr) -> None:
src/infrastructure/external_apis/elevenlabs_client.py:7:        self.api_key = api_key.get_secret_value()
src/infrastructure/external_apis/elevenlabs_client.py:11:            "xi-api-key": self.api_key,
src/infrastructure/external_apis/openai_client.py:21:    def __init__(self, api_key: str) -> None:
src/infrastructure/external_apis/openai_client.py:22:        self.client = AsyncOpenAI(api_key=api_key)
src/infrastructure/health/checks.py:97:                headers={"Authorization": f"Bearer {settings.ai.OPENAI_API_KEY}"},
src/infrastructure/security/environment_validator.py:45:        "OPENAI_API_KEY": {
src/infrastructure/security/environment_validator.py:48:            "no_defaults": ["REQUIRED", "your_api_key"],
src/infrastructure/security/environment_validator.py:63:        "PARENT_VERIFICATION_API_KEY": {
src/infrastructure/security/environment_validator.py:211:                    elif var_name == "OPENAI_API_KEY":
src/infrastructure/security/hardening/csrf_protection.py:22:    secret_key: str
src/infrastructure/security/hardening/csrf_protection.py:43:        if not config.secret_key or len(config.secret_key) < 32:
src/infrastructure/security/hardening/csrf_protection.py:61:                self.config.secret_key.encode(),
src/infrastructure/security/hardening/csrf_protection.py:322:            secret_key=secrets.token_urlsafe(32),
src/infrastructure/security/hardening/csrf_protection.py:332:def init_csrf_protection(secret_key: str, **kwargs) -> CSRFProtection:
src/infrastructure/security/hardening/csrf_protection.py:335:    config = CSRFConfig(secret_key=secret_key, **kwargs)
src/infrastructure/security/hardening/secure_settings.py:35:    secret_key: SecretStr = Field(
src/infrastructure/security/hardening/secure_settings.py:63:    openai_api_key: SecretStr = Field(..., description="OpenAI API key")
src/infrastructure/security/hardening/secure_settings.py:64:    anthropic_api_key: SecretStr | None = Field(
src/infrastructure/security/hardening/security_tests/encryption_tests.py:88:            (r'api_key\s*=\s*".*"', "Hardcoded API key"),
src/infrastructure/security/hardening/security_tests/encryption_tests.py:89:            (r'secret_key\s*=\s*".*"', "Hardcoded secret key"),
src/infrastructure/security/logging_security_monitor.py:32:            "api_key": r"\b[A-Za-z0-9]{32,}\b",
src/infrastructure/security/log_sanitization_config.py:25:            r"api_key",
src/infrastructure/security/log_sanitization_config.py:44:            "secret_key",
src/infrastructure/security/log_sanitization_config.py:45:            "api_key",
src/infrastructure/security/log_sanitization_config.py:65:            r"api_key",
src/infrastructure/security/log_sanitization_config.py:85:            "secret_key",
src/infrastructure/security/log_sanitization_config.py:86:            "api_key",
src/infrastructure/security/main_security_service.py:146:        secret_key = self.settings.security.SECRET_KEY
src/infrastructure/security/main_security_service.py:150:            if dangerous.lower() in secret_key.lower():
src/infrastructure/security/secure_logger.py:201:            r"api_key[=:\s]+\S+": lambda m: "api_key=[REDACTED]",
src/infrastructure/security/secure_logger.py:347:            r"password", r"secret", r"token", r"api_key", r"private_key",
src/infrastructure/security/secure_logger.py:355:            "password", "secret_key", "api_key", "private_key", "token",
src/infrastructure/security/security_manager.py:73:    def generate_file_signature(file_content: bytes, secret_key: str) -> str:
src/infrastructure/security/security_manager.py:78:            secret_key: A secret key to use for generating the signature.
src/infrastructure/security/security_manager.py:85:            secret_key.encode("utf-8"),
src/infrastructure/security/token_service.py:18:        self.secret_key = self.settings.security.SECRET_KEY
src/infrastructure/security/token_service.py:27:        if not self.secret_key or len(self.secret_key) < 32:
src/infrastructure/security/token_service.py:43:                to_encode, self.secret_key, algorithm=self.algorithm
src/infrastructure/security/token_service.py:64:                to_encode, self.secret_key, algorithm=self.algorithm
src/infrastructure/security/token_service.py:77:                token, self.secret_key, algorithms=[self.algorithm]
src/presentation/api/middleware/request_logging.py:46:            "api_key",

```

**ملخص النتائج:** تم العثور على 98 نتيجة

⏱️ الوقت المستغرق: 2.19 ثانية

⏱️ الوقت المستغرق: 2.19 ثانية


---

## فحص مكتبات الذكاء الاصطناعي المستخدمة
```bash
grep -rn --include='*.py' --exclude-dir=.venv --exclude-dir=venv --exclude-dir=__pycache__ --exclude-dir=build --exclude-dir=dist --exclude-dir=.mypy_cache --exclude-dir=node_modules --exclude-dir=.git -E 'import (torch|tensorflow|openai|anthropic)' src
```

```
src/infrastructure/external_apis/chatgpt_client.py:15:    import openai

```

**ملخص النتائج:** تم العثور على 1 نتيجة

⏱️ الوقت المستغرق: 2.28 ثانية

⏱️ الوقت المستغرق: 2.28 ثانية


---

## فحص معالجة استدعاءات API
```bash
grep -rn --include='*.py' --exclude-dir=.venv --exclude-dir=venv --exclude-dir=__pycache__ --exclude-dir=build --exclude-dir=dist --exclude-dir=.mypy_cache --exclude-dir=node_modules --exclude-dir=.git -A5 -B5 'requests\.|aiohttp\.|httpx\.' src
```

_Error or No results._
```

```

⏱️ الوقت المستغرق: 2.07 ثانية


---

## تغطية الاختبارات
⚠️ **لم تُشغّل** — شغّل `coverage run -m pytest` أولاً.

---
